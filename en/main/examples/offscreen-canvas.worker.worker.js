!function(){var t={303:function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,f=r?i-1:0,h=r?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+t[e+f],f+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+t[e+f],f+=h,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=l}return(p?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,f=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,y=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=c?(s=0,a=c):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[r+p]=255&s,p+=y,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;t[r+p]=255&a,p+=y,a/=256,l-=8);t[r+p-y]|=128*d}},20:function(t,e){function r(t,e){var r=[],n=[];return null==e&&(e=function(t,e){return r[0]===e?"[Circular ~]":"[Circular ~."+n.slice(0,r.indexOf(e)).join(".")+"]"}),function(i,o){if(r.length>0){var a=r.indexOf(this);~a?r.splice(a+1):r.push(this),~a?n.splice(a,1/0,i):n.push(i),~r.indexOf(o)&&(o=e.call(this,i,o))}else r.push(o);return null==t?o:t.call(this,i,o)}}(t.exports=function(t,e,n,i){return JSON.stringify(t,r(e,i),n)}).getSerialize=r},443:function(t,e,r){"use strict";t.exports=i;var n=r(303);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,a=1/o,s="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function u(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function l(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function c(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function f(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function h(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function p(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function y(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function d(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function v(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function g(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function m(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function b(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function _(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function w(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=_(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=_(this.buf,this.pos)+_(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=_(this.buf,this.pos)+x(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,o=r.buf;if(i=o[r.pos++],n=(112&i)>>4,i<128)return l(t,n,e);if(i=o[r.pos++],n|=(127&i)<<3,i<128)return l(t,n,e);if(i=o[r.pos++],n|=(127&i)<<10,i<128)return l(t,n,e);if(i=o[r.pos++],n|=(127&i)<<17,i<128)return l(t,n,e);if(i=o[r.pos++],n|=(127&i)<<24,i<128)return l(t,n,e);if(i=o[r.pos++],n|=(1&i)<<31,i<128)return l(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&s?function(t,e,r){return s.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){var n="",i=e;for(;i<r;){var o,a,s,u=t[i],l=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c>r)break;1===c?u<128&&(l=u):2===c?128==(192&(o=t[i+1]))&&(l=(31&u)<<6|63&o)<=127&&(l=null):3===c?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((l=(15&u)<<12|(63&o)<<6|63&a)<=2047||l>=55296&&l<=57343)&&(l=null)):4===c&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,c=1):l>65535&&(l-=65536,n+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),n+=String.fromCharCode(l),i+=c}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var r=u(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),w(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),w(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),w(this.buf,-1&t,this.pos),w(this.buf,Math.floor(t*a),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),w(this.buf,-1&t,this.pos),w(this.buf,Math.floor(t*a),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;if(e.buf[e.pos++]|=r|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&c(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&c(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,i.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,b,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},925:function(t,e,r){var n,i,o;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o=function(){"use strict";function t(t,n,i,o,a){!function t(r,n,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=n-i+1,l=Math.log(s),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(s-c)/s)*(u-s/2<0?-1:1);t(r,n,Math.max(i,Math.floor(n-u*c/s+f)),Math.min(o,Math.floor(n+(s-u)*c/s+f)),a)}var h=r[n],p=i,y=o;for(e(r,i,n),a(r[o],h)>0&&e(r,i,o);p<y;){for(e(r,p,y),p++,y--;a(r[p],h)<0;)p++;for(;a(r[y],h)>0;)y--}0===a(r[i],h)?e(r,i,y):e(r,++y,o),y<=n&&(i=y+1),n<=y&&(o=y-1)}}(t,n,i||0,o||t.length-1,a||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,r,n,i){i||(i=y(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var a=t.children[o];s(i,t.leaf?n(a):a)}return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(e,r,n,i,o){for(var a=[r,n];a.length;)if(!((n=a.pop())-(r=a.pop())<=i)){var s=r+Math.ceil((n-r)/i/2)*i;t(e,s,r,n,o),a.push(r,s,s,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!p(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?n(a):a;p(t,s)&&(e.leaf?r.push(a):h(t,s)?this._all(a,r):i.push(a))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||h(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=y([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,a=this.data,s=this.toBBox(t),u=[],l=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],r=l.pop(),o=!0),a.leaf){var c=i(t,a.children,e);if(-1!==c)return a.children.splice(c,1),u.push(a),this._condense(u),this}o||a.leaf||!h(a,s)?n?(r++,a=n.children[r],o=!1):a=null:(u.push(a),l.push(r),r=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,a=r-e+1,s=this._maxEntries;if(a<=s)return o(i=y(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(i=y([])).leaf=!1,i.height=n;var u=Math.ceil(a/s),l=u*Math.ceil(Math.sqrt(s));d(t,e,r,l,this.compareMinX);for(var c=e;c<=r;c+=l){var f=Math.min(c+l-1,r);d(t,c,f,u,this.compareMinY);for(var h=c;h<=f;h+=u){var p=Math.min(h+u-1,f);i.children.push(this._build(t,h,p,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],l=c(u),f=(h=t,p=u,(Math.max(p.maxX,h.maxX)-Math.min(p.minX,h.minX))*(Math.max(p.maxY,h.maxY)-Math.min(p.minY,h.minY))-l);f<o?(o=f,i=l<i?l:i,a=u):f===o&&l<i&&(i=l,a=u)}e=a||e.children[0]}var h,p;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),s(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n),s=y(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,o(r,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(r,s)},n.prototype._splitRoot=function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,s,u,l,f,h=1/0,p=1/0,y=e;y<=r-e;y++){var d=a(t,0,y,this.toBBox),v=a(t,y,r,this.toBBox),g=(i=d,o=v,s=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),l=Math.min(i.maxX,o.maxX),f=Math.min(i.maxY,o.maxY),Math.max(0,l-s)*Math.max(0,f-u)),m=c(d)+c(v);g<h?(h=g,n=y,p=m<p?m:p):g===h&&m<p&&(p=m,n=y)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=a(t,0,e,i),u=a(t,r-e,r,i),l=f(o)+f(u),c=e;c<r-e;c++){var h=t.children[c];s(o,t.leaf?i(h):h),l+=f(o)}for(var p=r-e-1;p>=e;p--){var y=t.children[p];s(u,t.leaf?i(y):y),l+=f(u)}return l},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)s(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n},"object"==a(e)?t.exports=o():void 0===(i="function"==typeof(n=o)?n.call(e,r,e,t):n)||(t.exports=i)}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}!function(){"use strict";var t={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};var e={};e[t.RADIANS]=6370997/(2*Math.PI),e[t.DEGREES]=2*Math.PI*6370997/360,e[t.FEET]=.3048,e[t.METERS]=1,e[t.USFEET]=1200/3937;var n=t;function i(){return function(){throw new Error("Unimplemented abstract method.")}()}var o=0;function a(t){return t.ol_uid||(t.ol_uid=String(++o))}var s="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1,i=arguments.length;n<i;++n){var o=arguments[n];if(null!=o)for(var a in o)o.hasOwnProperty(a)&&(r[a]=o[a])}return r};function u(t){for(var e in t)delete t[e]}var l="function"==typeof Object.values?Object.values:function(t){var e=[];for(var r in t)e.push(t[r]);return e};function c(t){var e;for(e in t)return!1;return!e}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}var r,n,i;return r=t,(n=[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||e[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])&&f(r.prototype,n),i&&f(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();function p(t,e,r){return Math.min(Math.max(t,e),r)}var y="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2},d="log2"in Math?Math.log2:function(t){return Math.log(t)*Math.LOG2E};function v(t,e,r,n,i,o){var a=i-r,s=o-n;if(0!==a||0!==s){var u=((t-r)*a+(e-n)*s)/(a*a+s*s);u>1?(r=i,n=o):u>0&&(r+=a*u,n+=s*u)}return g(t,e,r,n)}function g(t,e,r,n){var i=r-t,o=n-e;return i*i+o*o}function m(t){return t*Math.PI/180}function b(t,e){var r=t%e;return r*e<0?r+e:r}function _(t,e,r){return t+r*(e-t)}function w(t,e){var r=Math.pow(10,e);return Math.round(t*r)/r}function x(t,e){return Math.floor(w(t,e))}function k(t,e){return Math.ceil(w(t,e))}function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=E(t);if(e){var i=E(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return P(this,r)}}function P(t,e){if(e&&("object"===S(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var T=6378137,j=Math.PI*T,M=[-j,-j,j,j],I=[-180,-85,180,85],F=T*Math.log(Math.tan(Math.PI/2)),D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(a,t);var e,r,i,o=C(a);function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,{code:t,units:n.METERS,extent:M,global:!0,worldExtent:I,getPointResolution:function(t,e){return t/y(e[1]/T)}})}return e=a,r&&O(e.prototype,r),i&&O(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}(h),A=[new D("EPSG:3857"),new D("EPSG:102100"),new D("EPSG:102113"),new D("EPSG:900913"),new D("http://www.opengis.net/def/crs/EPSG/0/3857"),new D("http://www.opengis.net/gml/srs/epsg.xml#3857")];function L(t,e,r){var n=t.length,i=r>1?r:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(n));for(var a=0;a<n;a+=i){o[a]=j*t[a]/180;var s=T*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));s>F?s=F:s<-F&&(s=-F),o[a+1]=s}return o}function z(t,e,r){var n=t.length,i=r>1?r:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(n));for(var a=0;a<n;a+=i)o[a]=180*t[a]/j,o[a+1]=360*Math.atan(Math.exp(t[a+1]/T))/Math.PI-90;return o}function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function W(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=q(t);if(e){var i=q(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return X(this,r)}}function X(t,e){if(e&&("object"===B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var V=[-180,-90,180,90],K=6378137*Math.PI/180,Y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N(t,e)}(a,t);var e,r,i,o=W(a);function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,{code:t,units:n.DEGREES,extent:V,axisOrientation:e,global:!0,metersPerUnit:K,worldExtent:V})}return e=a,r&&G(e.prototype,r),i&&G(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}(h),Z=[new Y("CRS:84"),new Y("EPSG:4326","neu"),new Y("urn:ogc:def:crs:OGC:1.3:CRS84"),new Y("urn:ogc:def:crs:OGC:2:84"),new Y("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Y("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Y("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],U={};var H={};function J(t,e,r){var n=t.getCode(),i=e.getCode();n in H||(H[n]={}),H[n][i]=r}var Q="bottom-left",$="bottom-right",tt="top-left",et="top-right",rt=0,nt=1,it=2,ot=4,at=8,st=16;function ut(t){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ct(t,e){if(e&&("object"===ut(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ft(t){var e="function"==typeof Map?new Map:void 0;return(ft=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return ht(t,arguments,dt(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),yt(n,t)})(t)}function ht(t,e,r){return(ht=pt()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&yt(i,r.prototype),i}).apply(null,arguments)}function pt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yt(t,e)}(s,t);var e,r,n,i,o,a=(e=s,r=pt(),function(){var t,n=dt(e);if(r){var i=dt(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return ct(this,t)});function s(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var r="Assertion failed. See https://openlayers.org/en/latest/doc/errors/#"+t+" for details.";return(e=a.call(this,r)).code=t,e.name="AssertionError",e.message=r,e}return n=s,i&&lt(n.prototype,i),o&&lt(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(ft(Error));function gt(t,e){if(!t)throw new vt(e)}function mt(t){for(var e=Rt(),r=0,n=t.length;r<n;++r)It(e,t[r]);return e}function bt(t,e,r){return r?(r[0]=t[0]-e,r[1]=t[1]-e,r[2]=t[2]+e,r[3]=t[3]+e,r):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function _t(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function wt(t,e,r){var n,i;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(i=r<t[1]?t[1]-r:t[3]<r?r-t[3]:0)*i}function xt(t,e){return St(t,e[0],e[1])}function kt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function St(t,e,r){return t[0]<=e&&e<=t[2]&&t[1]<=r&&r<=t[3]}function Ot(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=rt;return a<r?u|=st:a>i&&(u|=ot),s<n?u|=at:s>o&&(u|=it),u===rt&&(u=nt),u}function Rt(){return[1/0,1/0,-1/0,-1/0]}function Ct(t,e,r,n,i){return i?(i[0]=t,i[1]=e,i[2]=r,i[3]=n,i):[t,e,r,n]}function Pt(t){return Ct(1/0,1/0,-1/0,-1/0,t)}function Et(t,e){var r=t[0],n=t[1];return Ct(r,n,r,n,e)}function Tt(t,e,r,n,i){return Ft(Pt(i),t,e,r,n)}function jt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Mt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function It(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Ft(t,e,r,n,i){for(;r<n;r+=i)Dt(t,e[r],e[r+1]);return t}function Dt(t,e,r){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],r)}function At(t,e){var r;return(r=e(zt(t)))||(r=e(Bt(t)))||(r=e(Kt(t)))?r:(r=e(Vt(t)))||!1}function Lt(t){var e=0;return Ut(t)||(e=Yt(t)*Xt(t)),e}function zt(t){return[t[0],t[1]]}function Bt(t){return[t[2],t[1]]}function Gt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Nt(t,e){var r;return e===Q?r=zt(t):e===$?r=Bt(t):e===tt?r=Vt(t):e===et?r=Kt(t):gt(!1,13),r}function Wt(t,e,r,n,i){var o=e*n[0]/2,a=e*n[1]/2,s=Math.cos(r),u=Math.sin(r),l=o*s,c=o*u,f=a*s,h=a*u,p=t[0],y=t[1],d=p-l+h,v=p-l-h,g=p+l-h,m=p+l+h,b=y-c-f,_=y-c+f,w=y+c+f,x=y+c-f;return Ct(Math.min(d,v,g,m),Math.min(b,_,w,x),Math.max(d,v,g,m),Math.max(b,_,w,x),i)}function Xt(t){return t[3]-t[1]}function qt(t,e,r){var n=r||[1/0,1/0,-1/0,-1/0];return Zt(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Pt(n),n}function Vt(t){return[t[0],t[3]]}function Kt(t){return[t[2],t[3]]}function Yt(t){return t[2]-t[0]}function Zt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Ut(t){return t[2]<t[0]||t[3]<t[1]}function Ht(t,e,r,n){var i=[];if(n>1)for(var o=t[2]-t[0],a=t[3]-t[1],s=0;s<n;++s)i.push(t[0]+o*s/n,t[1],t[2],t[1]+a*s/n,t[2]-o*s/n,t[3],t[0],t[3]-a*s/n);else i=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(i,i,2);for(var u=[],l=[],c=0,f=i.length;c<f;c+=2)u.push(i[c]),l.push(i[c+1]);return function(t,e,r){return Ct(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),r)}(u,l,r)}function Jt(t,e){for(var r=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r}function Qt(t,e){var r=Math.cos(e),n=Math.sin(e),i=t[0]*r-t[1]*n,o=t[1]*r+t[0]*n;return t[0]=i,t[1]=o,t}function $t(t,e){if(e.canWrapX()){var r=Yt(e.getExtent()),n=function(t,e,r){var n=e.getExtent(),i=0;if(e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])){var o=r||Yt(n);i=Math.floor((t[0]-n[0])/o)}return i}(t,e,r);n&&(t[0]-=n*r)}return t}var te=6371008.8;function ee(t,e,r){var n=r||te,i=m(t[1]),o=m(e[1]),a=(o-i)/2,s=m(e[0]-t[0])/2,u=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(i)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}var re=!0;function ne(t){re=!(void 0===t||t)}function ie(t,e,r){var n;if(void 0!==e){for(var i=0,o=t.length;i<o;++i)e[i]=t[i];n=e}else n=t.slice();return n}function oe(t,e,r){if(void 0!==e&&t!==e){for(var n=0,i=t.length;n<i;++n)e[n]=t[n];t=e}return t}function ae(t){!function(t,e){U[t]=e}(t.getCode(),t),J(t,t,ie)}function se(t){return"string"==typeof t?U[e=t]||U[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function ue(t,r,i,o){var a,s=(t=se(t)).getPointResolutionFunc();if(s){if(a=s(r,i),o&&o!==t.getUnits()){var u=t.getMetersPerUnit();u&&(a=a*u/e[o])}}else{var l=t.getUnits();if(l==n.DEGREES&&!o||o==n.DEGREES)a=r;else{var c=pe(t,se("EPSG:4326"));if(c===oe&&l!==n.DEGREES)a=r*t.getMetersPerUnit();else{var f=[i[0]-r/2,i[1],i[0]+r/2,i[1],i[0],i[1]-r/2,i[0],i[1]+r/2];a=(ee((f=c(f,f,2)).slice(0,2),f.slice(2,4))+ee(f.slice(4,6),f.slice(6,8)))/2}var h=o?e[o]:t.getMetersPerUnit();void 0!==h&&(a/=h)}}return a}function le(t){!function(t){t.forEach(ae)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&J(e,t,ie)}))}))}function ce(t,e){return t?"string"==typeof t?se(t):t:se(e)}function fe(t,e){return ne(),de(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function he(t,e){if(t===e)return!0;var r=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||pe(t,e)===ie)&&r}function pe(t,e){var r=function(t,e){var r;return t in H&&e in H[t]&&(r=H[t][e]),r}(t.getCode(),e.getCode());return r||(r=oe),r}function ye(t,e){return pe(se(t),se(e))}function de(t,e,r){return ye(e,r)(t,void 0,t.length)}function ve(t,e,r,n){return Ht(t,ye(e,r),void 0,n)}var ge,me,be,_e=null;function we(){return _e}function xe(t,e){return _e?de(t,e,_e):t}function ke(t,e){return _e?de(t,_e,e):(re&&!Jt(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(re=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function Se(t,e){return _e?ve(t,e,_e):t}function Oe(t,e){return _e?ve(t,_e,e):t}function Re(t,r){if(!_e)return t;var n=se(r).getUnits(),i=_e.getUnits();return n&&i?t*e[n]/e[i]:t}function Ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}le(A),le(Z),ge=A,me=L,be=z,Z.forEach((function(t){ge.forEach((function(e){J(t,e,me),J(e,t,be)}))}));var Pe=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}var e,r,o;return e=t,(r=[{key:"getReadOptions",value:function(t,e){var r;if(e){var i=e.dataProjection?se(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()===n.TILE_PIXELS&&(i=se(i)).setWorldExtent(e.extent),r={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(r)}},{key:"adaptOptions",value:function(t){return s({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)}},{key:"getType",value:function(){return i()}},{key:"readFeature",value:function(t,e){return i()}},{key:"readFeatures",value:function(t,e){return i()}},{key:"readGeometry",value:function(t,e){return i()}},{key:"readProjection",value:function(t){return i()}},{key:"writeFeature",value:function(t,e){return i()}},{key:"writeFeatures",value:function(t,e){return i()}},{key:"writeGeometry",value:function(t,e){return i()}}])&&Ce(e.prototype,r),o&&Ce(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ee(t,e,r){var n,i=r?se(r.featureProjection):null,o=r?se(r.dataProjection):null;if(n=i&&o&&!he(i,o)?(e?t.clone():t).transform(e?i:o,e?o:i):t,e&&r&&void 0!==r.decimals){var a=Math.pow(10,r.decimals);n===t&&(n=t.clone()),n.applyTransform((function(t){for(var e=0,r=t.length;e<r;++e)t[e]=Math.round(t[e]*a)/a;return t}))}return n}var Te="arraybuffer",je="json",Me="text",Ie="xml",Fe="XY",De="XYZ",Ae="XYM",Le="XYZM",ze="Point",Be="LineString",Ge="LinearRing",Ne="Polygon",We="MultiPoint",Xe="MultiLineString",qe="MultiPolygon",Ve="GeometryCollection",Ke="Circle";function Ye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Ze=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}var e,r,n;return e=t,(r=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&Ye(e.prototype,r),n&&Ye(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ue="propertychange";function He(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Je=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.disposed=!1}var e,r,n;return e=t,(r=[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])&&He(e.prototype,r),n&&He(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Qe(t,e){return t>e?1:t<e?-1:0}function $e(t,e,r){var n,i=t.length;if(t[0]<=e)return 0;if(e<=t[i-1])return i-1;if(r>0){for(n=1;n<i;++n)if(t[n]<e)return n-1}else if(r<0){for(n=1;n<i;++n)if(t[n]<=e)return n}else for(n=1;n<i;++n){if(t[n]==e)return n;if(t[n]<e)return"function"==typeof r?r(e,t[n-1],t[n])>0?n-1:n:t[n-1]-e<e-t[n]?n-1:n}return i-1}function tr(t,e,r){for(;e<r;){var n=t[e];t[e]=t[r],t[r]=n,++e,--r}}function er(t,e){for(var r=Array.isArray(e)?e:[e],n=r.length,i=0;i<n;i++)t[t.length]=r[i]}function rr(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function nr(){return!0}function ir(){return!1}function or(){}function ar(t){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ur(t,e){return(ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fr(t);if(e){var i=fr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return cr(this,r)}}function cr(t,e){if(e&&("object"===ar(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fr(t){return(fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ur(t,e)}(o,t);var e,r,n,i=lr(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).eventTarget_=t,e.pendingRemovals_=null,e.dispatching_=null,e.listeners_=null,e}return e=o,(r=[{key:"addEventListener",value:function(t,e){if(t&&e){var r=this.listeners_||(this.listeners_={}),n=r[t]||(r[t]=[]);-1===n.indexOf(e)&&n.push(e)}}},{key:"dispatchEvent",value:function(t){var e="string"==typeof t,r=e?t:t.type,n=this.listeners_&&this.listeners_[r];if(n){var i=e?new Ze(t):t;i.target||(i.target=this.eventTarget_||this);var o,a=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});r in a||(a[r]=0,s[r]=0),++a[r];for(var u=0,l=n.length;u<l;++u)if(!1===(o="handleEvent"in n[u]?n[u].handleEvent(i):n[u].call(this,i))||i.propagationStopped){o=!1;break}if(0==--a[r]){var c=s[r];for(delete s[r];c--;)this.removeEventListener(r,or);delete a[r]}return o}}},{key:"disposeInternal",value:function(){this.listeners_&&u(this.listeners_)}},{key:"getListeners",value:function(t){return this.listeners_&&this.listeners_[t]||void 0}},{key:"hasListener",value:function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}},{key:"removeEventListener",value:function(t,e){var r=this.listeners_&&this.listeners_[t];if(r){var n=r.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(r[n]=or,++this.pendingRemovals_[t]):(r.splice(n,1),0===r.length&&delete this.listeners_[t]))}}}])&&sr(e.prototype,r),n&&sr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Je),pr="change",yr="error",dr="contextmenu",vr="click",gr="dblclick",mr="keydown",br="keypress",_r="load",wr="resize",xr="touchmove",kr="wheel";function Sr(t,e,r,n,i){if(n&&n!==t&&(r=r.bind(n)),i){var o=r;r=function(){t.removeEventListener(e,r),o.apply(this,arguments)}}var a={target:t,type:e,listener:r};return t.addEventListener(e,r),a}function Or(t,e,r,n){return Sr(t,e,r,n,!0)}function Rr(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),u(t))}function Cr(t){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Er(t,e){return(Er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Mr(t);if(e){var i=Mr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return jr(this,r)}}function jr(t,e){if(e&&("object"===Cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Mr(t){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ir=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Er(t,e)}(o,t);var e,r,n,i=Tr(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e=o,(r=[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(pr)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(t,e){if(Array.isArray(t)){for(var r=t.length,n=new Array(r),i=0;i<r;++i)n[i]=Sr(this,t[i],e);return n}return Sr(this,t,e)}},{key:"onceInternal",value:function(t,e){var r;if(Array.isArray(t)){var n=t.length;r=new Array(n);for(var i=0;i<n;++i)r[i]=Or(this,t[i],e)}else r=Or(this,t,e);return e.ol_key=r,r}},{key:"unInternal",value:function(t,e){var r=e.ol_key;if(r)!function(t){if(Array.isArray(t))for(var e=0,r=t.length;e<r;++e)Rr(t[e]);else Rr(t)}(r);else if(Array.isArray(t))for(var n=0,i=t.length;n<i;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}])&&Pr(e.prototype,r),n&&Pr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(hr);Ir.prototype.on,Ir.prototype.once,Ir.prototype.un;var Fr=Ir;function Dr(t){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ar(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lr(t,e,r){return e&&Ar(t.prototype,e),r&&Ar(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Br(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gr(t,e)}function Gr(t,e){return(Gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=qr(t);if(e){var i=qr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Wr(this,r)}}function Wr(t,e){if(e&&("object"===Dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Xr(t)}function Xr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qr(t){return(qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vr,Kr=function(t){Br(r,t);var e=Nr(r);function r(t,n,i){var o;return zr(this,r),(o=e.call(this,t)).key=n,o.oldValue=i,o}return Lr(r)}(Ze),Yr=function(t){Br(r,t);var e=Nr(r);function r(t){var n;return zr(this,r),(n=e.call(this)).on,n.once,n.un,a(Xr(n)),n.values_=null,void 0!==t&&n.setProperties(t),n}return Lr(r,[{key:"get",value:function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&s({},this.values_)||{}}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(t,e){var r;r="change:".concat(t),this.hasListener(r)&&this.dispatchEvent(new Kr(r,t,e)),r=Ue,this.hasListener(r)&&this.dispatchEvent(new Kr(r,t,e))}},{key:"addChangeListener",value:function(t,e){this.addEventListener("change:".concat(t),e)}},{key:"removeChangeListener",value:function(t,e){this.removeEventListener("change:".concat(t),e)}},{key:"set",value:function(t,e,r){var n=this.values_||(this.values_={});if(r)n[t]=e;else{var i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}},{key:"setProperties",value:function(t,e){for(var r in t)this.set(r,t[r],e)}},{key:"applyProperties",value:function(t){t.values_&&s(this.values_||(this.values_={}),t.values_)}},{key:"unset",value:function(t,e){if(this.values_&&t in this.values_){var r=this.values_[t];delete this.values_[t],c(this.values_)&&(this.values_=null),e||this.notify(t,r)}}}]),r}(Fr),Zr="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Ur=-1!==Zr.indexOf("firefox"),Hr=(-1!==Zr.indexOf("safari")&&-1==Zr.indexOf("chrom")&&(Zr.indexOf("version/15.4")>=0||Zr.match(/cpu (os|iphone os) 15_4 like mac os x/)),-1!==Zr.indexOf("webkit")&&-1==Zr.indexOf("edge")),Jr=-1!==Zr.indexOf("macintosh"),Qr="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,$r="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,tn="undefined"!=typeof Image&&Image.prototype.decode,en=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}(),rn=new Array(6);function nn(t){return an(t,1,0,0,1,0,0)}function on(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=e[0],l=e[1],c=e[2],f=e[3],h=e[4],p=e[5];return t[0]=r*u+i*l,t[1]=n*u+o*l,t[2]=r*c+i*f,t[3]=n*c+o*f,t[4]=r*h+i*p+a,t[5]=n*h+o*p+s,t}function an(t,e,r,n,i,o,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t}function sn(t,e){var r=e[0],n=e[1];return e[0]=t[0]*r+t[2]*n+t[4],e[1]=t[1]*r+t[3]*n+t[5],e}function un(t,e,r){return on(t,an(rn,e,0,0,r,0,0))}function ln(t,e,r,n,i,o,a,s){var u=Math.sin(o),l=Math.cos(o);return t[0]=n*l,t[1]=i*u,t[2]=-n*u,t[3]=i*l,t[4]=a*n*l-s*n*u+e,t[5]=a*i*u+s*i*l+r,t}function cn(t,e){var r,n=(r=e)[0]*r[3]-r[1]*r[2];gt(0!==n,32);var i=e[0],o=e[1],a=e[2],s=e[3],u=e[4],l=e[5];return t[0]=s/n,t[1]=-o/n,t[2]=-a/n,t[3]=i/n,t[4]=(a*l-s*u)/n,t[5]=-(i*l-o*u)/n,t}function fn(t){var e="matrix("+t.join(", ")+")";if($r)return e;var r=Vr||(Vr=document.createElement("div"));return r.style.transform=e,r.style.transform}function hn(t,e,r,n,i,o){for(var a=o||[],s=0,u=e;u<r;u+=n){var l=t[u],c=t[u+1];a[s++]=i[0]*l+i[2]*c+i[4],a[s++]=i[1]*l+i[3]*c+i[5]}return o&&a.length!=s&&(a.length=s),a}function pn(t,e,r,n,i,o,a){for(var s=a||[],u=Math.cos(i),l=Math.sin(i),c=o[0],f=o[1],h=0,p=e;p<r;p+=n){var y=t[p]-c,d=t[p+1]-f;s[h++]=c+y*u-d*l,s[h++]=f+y*l+d*u;for(var v=p+2;v<p+n;++v)s[h++]=t[v]}return a&&s.length!=h&&(s.length=h),s}function yn(t){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vn(t,e){return(vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bn(t);if(e){var i=bn(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return mn(this,r)}}function mn(t,e){if(e&&("object"===yn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bn(t){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _n=[1,0,0,1,0,0],wn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vn(t,e)}(s,t);var e,r,o,a=gn(s);function s(){var t,e,r,n,i,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this)).extent_=[1/0,1/0,-1/0,-1/0],t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(e=function(t,e,r){if(!r)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(r),n.getSimplifiedGeometry(e)},o=!1,function(){var t=Array.prototype.slice.call(arguments);return o&&this===i&&rr(t,n)||(o=!0,i=this,n=t,r=e.apply(this,arguments)),r}),t}return e=s,(r=[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return i()}},{key:"closestPointXY",value:function(t,e,r,n){return i()}},{key:"containsXY",value:function(t,e){var r=this.getClosestPoint([t,e]);return r[0]===t&&r[1]===e}},{key:"getClosestPoint",value:function(t,e){var r=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],r,1/0),r}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return i()}},{key:"getExtent",value:function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Pt(e),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}},{key:"rotate",value:function(t,e){i()}},{key:"scale",value:function(t,e,r){i()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return i()}},{key:"getType",value:function(){return i()}},{key:"applyTransform",value:function(t){i()}},{key:"intersectsExtent",value:function(t){return i()}},{key:"translate",value:function(t,e){i()}},{key:"transform",value:function(t,e){var r=se(t),i=r.getUnits()==n.TILE_PIXELS?function(t,n,i){var o=r.getExtent(),a=r.getWorldExtent(),s=Xt(a)/Xt(o);return ln(_n,a[0],a[3],s,-s,0,0,0),hn(t,0,t.length,i,_n,n),ye(r,e)(t,n,i)}:ye(r,e);return this.applyTransform(i),this}}])&&dn(e.prototype,r),o&&dn(e,o),Object.defineProperty(e,"prototype",{writable:!1}),s}(Yr);function xn(t){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sn(t,e){return(Sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function On(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Cn(t);if(e){var i=Cn(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Rn(this,r)}}function Rn(t,e){if(e&&("object"===xn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Cn(t){return(Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pn(t){var e;return t==Fe?e=2:t==De||t==Ae?e=3:t==Le&&(e=4),e}var En=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sn(t,e)}(a,t);var e,r,n,o=On(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this)).layout=Fe,t.stride=2,t.flatCoordinates=null,t}return e=a,(r=[{key:"computeExtent",value:function(t){return Tt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinates",value:function(){return i()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=Pn(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){i()}},{key:"setLayout",value:function(t,e,r){var n;if(t)n=Pn(t);else{for(var i=0;i<r;++i){if(0===e.length)return this.layout=Fe,void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e=Fe:3==t?e=De:4==t&&(e=Le),e}(n=e.length)}this.layout=t,this.stride=n}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var r=this.getFlatCoordinates();if(r){var n=this.getStride();pn(r,0,r.length,n,t,e,r),this.changed()}}},{key:"scale",value:function(t,e,r){var n=e;void 0===n&&(n=t);var i=r;i||(i=Gt(this.getExtent()));var o=this.getFlatCoordinates();if(o){var a=this.getStride();!function(t,e,r,n,i,o,a,s){for(var u=s||[],l=a[0],c=a[1],f=0,h=e;h<r;h+=n){var p=t[h]-l,y=t[h+1]-c;u[f++]=l+i*p,u[f++]=c+o*y;for(var d=h+2;d<h+n;++d)u[f++]=t[d]}s&&u.length!=f&&(u.length=f)}(o,0,o.length,a,t,n,i,o),this.changed()}}},{key:"translate",value:function(t,e){var r=this.getFlatCoordinates();if(r){var n=this.getStride();!function(t,e,r,n,i,o,a){for(var s=a||[],u=0,l=e;l<r;l+=n){s[u++]=t[l]+i,s[u++]=t[l+1]+o;for(var c=l+2;c<l+n;++c)s[u++]=t[c]}a&&s.length!=u&&(s.length=u)}(r,0,r.length,n,t,e,r),this.changed()}}}])&&kn(e.prototype,r),n&&kn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(wn);function Tn(t,e,r,n,i,o,a){var s,u=t[e],l=t[e+1],c=t[r]-u,f=t[r+1]-l;if(0===c&&0===f)s=e;else{var h=((i-u)*c+(o-l)*f)/(c*c+f*f);if(h>1)s=r;else{if(h>0){for(var p=0;p<n;++p)a[p]=_(t[e+p],t[r+p],h);return void(a.length=n)}s=e}}for(var y=0;y<n;++y)a[y]=t[s+y];a.length=n}function jn(t,e,r,n,i){var o=t[e],a=t[e+1];for(e+=n;e<r;e+=n){var s=t[e],u=t[e+1],l=g(o,a,s,u);l>i&&(i=l),o=s,a=u}return i}function Mn(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];i=jn(t,e,s,n,i),e=s}return i}function In(t,e,r,n,i,o,a,s,u,l,c){if(e==r)return l;var f,h;if(0===i){if((h=g(a,s,t[e],t[e+1]))<l){for(f=0;f<n;++f)u[f]=t[e+f];return u.length=n,h}return l}for(var p=c||[NaN,NaN],y=e+n;y<r;)if(Tn(t,y-n,y,n,a,s,p),(h=g(a,s,p[0],p[1]))<l){for(l=h,f=0;f<n;++f)u[f]=p[f];u.length=n,y+=n}else y+=n*Math.max((Math.sqrt(h)-Math.sqrt(l))/i|0,1);if(o&&(Tn(t,r-n,e,n,a,s,p),(h=g(a,s,p[0],p[1]))<l)){for(l=h,f=0;f<n;++f)u[f]=p[f];u.length=n}return l}function Fn(t,e,r,n,i,o,a,s,u,l,c){for(var f=c||[NaN,NaN],h=0,p=r.length;h<p;++h){var y=r[h];l=In(t,e,y,n,i,o,a,s,u,l,f),e=y}return l}function Dn(t,e,r,n){for(var i=0,o=r.length;i<o;++i)for(var a=r[i],s=0;s<n;++s)t[e++]=a[s];return e}function An(t,e,r,n,i){for(var o=i||[],a=0,s=0,u=r.length;s<u;++s){var l=Dn(t,e,r[s],n);o[a++]=l,e=l}return o.length=a,o}function Ln(t,e,r,n,i,o,a){var s=(r-e)/n;if(s<3){for(;e<r;e+=n)o[a++]=t[e],o[a++]=t[e+1];return a}var u=new Array(s);u[0]=1,u[s-1]=1;for(var l=[e,r-n],c=0;l.length>0;){for(var f=l.pop(),h=l.pop(),p=0,y=t[h],d=t[h+1],g=t[f],m=t[f+1],b=h+n;b<f;b+=n){var _=v(t[b],t[b+1],y,d,g,m);_>p&&(c=b,p=_)}p>i&&(u[(c-e)/n]=1,h+n<c&&l.push(h,c),c+n<f&&l.push(c,f))}for(var w=0;w<s;++w)u[w]&&(o[a++]=t[e+w*n],o[a++]=t[e+w*n+1]);return a}function zn(t,e,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var c=r[u];a=Ln(t,e,c,n,i,o,a),s.push(a),e=c}return a}function Bn(t,e){return e*Math.round(t/e)}function Gn(t,e,r,n,i,o,a){if(e==r)return a;var s,u,l=Bn(t[e],i),c=Bn(t[e+1],i);e+=n,o[a++]=l,o[a++]=c;do{if(s=Bn(t[e],i),u=Bn(t[e+1],i),(e+=n)==r)return o[a++]=s,o[a++]=u,a}while(s==l&&u==c);for(;e<r;){var f=Bn(t[e],i),h=Bn(t[e+1],i);if(e+=n,f!=s||h!=u){var p=s-l,y=u-c,d=f-l,v=h-c;p*v==y*d&&(p<0&&d<p||p==d||p>0&&d>p)&&(y<0&&v<y||y==v||y>0&&v>y)?(s=f,u=h):(o[a++]=s,o[a++]=u,l=s,c=u,s=f,u=h)}}return o[a++]=s,o[a++]=u,a}function Nn(t,e,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var c=r[u];a=Gn(t,e,c,n,i,o,a),s.push(a),e=c}return a}function Wn(t,e,r,n,i){var o;for(e+=n;e<r;e+=n)if(o=i(t.slice(e-n,e),t.slice(e,e+n)))return o;return!1}function Xn(t,e,r,n,i){for(var o=void 0!==i?i:[],a=0,s=e;s<r;s+=n)o[a++]=t.slice(s,s+n);return o.length=a,o}function qn(t,e,r,n,i){for(var o=void 0!==i?i:[],a=0,s=0,u=r.length;s<u;++s){var l=r[s];o[a++]=Xn(t,e,l,n,o[a]),e=l}return o.length=a,o}function Vn(t,e,r,n,i){for(var o=void 0!==i?i:[],a=0,s=0,u=r.length;s<u;++s){var l=r[s];o[a++]=qn(t,e,l,n,o[a]),e=l[l.length-1]}return o.length=a,o}function Kn(t,e,r,n,i,o,a){var s,u,l=(r-e)/n;if(1===l)s=e;else if(2===l)s=e,u=i;else if(0!==l){for(var c=t[e],f=t[e+1],h=0,p=[0],y=e+n;y<r;y+=n){var d=t[y],v=t[y+1];h+=Math.sqrt((d-c)*(d-c)+(v-f)*(v-f)),p.push(h),c=d,f=v}var g=i*h,m=function(t,e,r){for(var n,i,o=r||Qe,a=0,s=t.length,u=!1;a<s;)(i=+o(t[n=a+(s-a>>1)],e))<0?a=n+1:(s=n,u=!i);return u?a:~a}(p,g);m<0?(u=(g-p[-m-2])/(p[-m-1]-p[-m-2]),s=e+(-m-2)*n):s=e+m*n}for(var b=a>1?a:2,w=o||new Array(b),x=0;x<b;++x)w[x]=void 0===s?NaN:void 0===u?t[s+x]:_(t[s+x],t[s+n+x],u);return w}function Yn(t,e,r,n,i,o){if(r==e)return null;var a;if(i<t[e+n-1])return o?((a=t.slice(e,e+n))[n-1]=i,a):null;if(t[r-1]<i)return o?((a=t.slice(r-n,r))[n-1]=i,a):null;if(i==t[e+n-1])return t.slice(e,e+n);for(var s=e/n,u=r/n;s<u;){var l=s+u>>1;i<t[(l+1)*n-1]?u=l:s=l+1}var c=t[s*n-1];if(i==c)return t.slice((s-1)*n,(s-1)*n+n);var f=(i-c)/(t[(s+1)*n-1]-c);a=[];for(var h=0;h<n-1;++h)a.push(_(t[(s-1)*n+h],t[s*n+h],f));return a.push(i),a}function Zn(t,e,r,n,i){return!At(i,(function(i){return!Un(t,e,r,n,i[0],i[1])}))}function Un(t,e,r,n,i,o){for(var a=0,s=t[r-n],u=t[r-n+1];e<r;e+=n){var l=t[e],c=t[e+1];u<=o?c>o&&(l-s)*(o-u)-(i-s)*(c-u)>0&&a++:c<=o&&(l-s)*(o-u)-(i-s)*(c-u)<0&&a--,s=l,u=c}return 0!==a}function Hn(t,e,r,n,i,o){if(0===r.length)return!1;if(!Un(t,e,r[0],n,i,o))return!1;for(var a=1,s=r.length;a<s;++a)if(Un(t,r[a-1],r[a],n,i,o))return!1;return!0}function Jn(t,e,r,n,i){var o=Ft([1/0,1/0,-1/0,-1/0],t,e,r,n);return!!Zt(i,o)&&(!!kt(i,o)||(o[0]>=i[0]&&o[2]<=i[2]||(o[1]>=i[1]&&o[3]<=i[3]||Wn(t,e,r,n,(function(t,e){return function(t,e,r){var n=!1,i=Ot(t,e),o=Ot(t,r);if(i===nt||o===nt)n=!0;else{var a,s,u=t[0],l=t[1],c=t[2],f=t[3],h=e[0],p=e[1],y=r[0],d=r[1],v=(d-p)/(y-h);o&it&&!(i&it)&&(n=(a=y-(d-f)/v)>=u&&a<=c),n||!(o&ot)||i&ot||(n=(s=d-(y-c)*v)>=l&&s<=f),n||!(o&at)||i&at||(n=(a=y-(d-l)/v)>=u&&a<=c),n||!(o&st)||i&st||(n=(s=d-(y-u)*v)>=l&&s<=f)}return n}(i,t,e)})))))}function Qn(t,e,r,n,i){if(!function(t,e,r,n,i){return!!(Jn(t,e,r,n,i)||Un(t,e,r,n,i[0],i[1])||Un(t,e,r,n,i[0],i[3])||Un(t,e,r,n,i[2],i[1])||Un(t,e,r,n,i[2],i[3]))}(t,e,r[0],n,i))return!1;if(1===r.length)return!0;for(var o=1,a=r.length;o<a;++o)if(Zn(t,r[o-1],r[o],n,i)&&!Jn(t,r[o-1],r[o],n,i))return!1;return!0}function $n(t,e,r,n){for(var i=t[e],o=t[e+1],a=0,s=e+n;s<r;s+=n){var u=t[s],l=t[s+1];a+=Math.sqrt((u-i)*(u-i)+(l-o)*(l-o)),i=u,o=l}return a}function ti(t){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ei(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ri(t,e){return(ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ni(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oi(t);if(e){var i=oi(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ii(this,r)}}function ii(t,e){if(e&&("object"===ti(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oi(t){return(oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ai=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ri(t,e)}(o,t);var e,r,n,i=ni(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this)).flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?r.setCoordinates(t,e):r.setFlatCoordinates(e,t),r}return e=o,(r=[{key:"appendCoordinate",value:function(t){this.flatCoordinates?er(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}},{key:"clone",value:function(){var t=new o(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,n){return n<wt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),In(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,r,n))}},{key:"forEachSegment",value:function(t){return Wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinateAtM",value:function(t,e){if(this.layout!=Ae&&this.layout!=Le)return null;var r=void 0!==e&&e;return Yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r)}},{key:"getCoordinates",value:function(){return Xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinateAt",value:function(t,e){return Kn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}},{key:"getLength",value:function(){return $n(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getFlatMidpoint",value:function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=Ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new o(e,Fe)}},{key:"getType",value:function(){return Be}},{key:"intersectsExtent",value:function(t){return Jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dn(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&ei(e.prototype,r),n&&ei(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(En);function si(t){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ui(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function li(t,e){return(li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ci(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=hi(t);if(e){var i=hi(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return fi(this,r)}}function fi(t,e){if(e&&("object"===si(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function hi(t){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&li(t,e)}(o,t);var e,r,n,i=ci(o);function o(t,e,r){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).ends_=[],n.maxDelta_=-1,n.maxDeltaRevision_=-1,Array.isArray(t[0]))n.setCoordinates(t,e);else if(void 0!==e&&r)n.setFlatCoordinates(e,t),n.ends_=r;else{for(var a=n.getLayout(),s=t,u=[],l=[],c=0,f=s.length;c<f;++c){var h=s[c];0===c&&(a=h.getLayout()),er(u,h.getFlatCoordinates()),l.push(u.length)}n.setFlatCoordinates(a,u),n.ends_=l}return n}return e=o,(r=[{key:"appendLineString",value:function(t){this.flatCoordinates?er(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new o(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,n){return n<wt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Mn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,r,n))}},{key:"getCoordinateAtM",value:function(t,e,r){if(this.layout!=Ae&&this.layout!=Le||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,i=void 0!==r&&r;return function(t,e,r,n,i,o,a){if(a)return Yn(t,e,r[r.length-1],n,i,o);var s;if(i<t[n-1])return o?((s=t.slice(0,n))[n-1]=i,s):null;if(t[t.length-1]<i)return o?((s=t.slice(t.length-n))[n-1]=i,s):null;for(var u=0,l=r.length;u<l;++u){var c=r[u];if(e!=c){if(i<t[e+n-1])return null;if(i<=t[c-1])return Yn(t,e,c,n,i,!1);e=c}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,i)}},{key:"getCoordinates",value:function(){return qn(this.flatCoordinates,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getLineString",value:function(t){return t<0||this.ends_.length<=t?null:new ai(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLineStrings",value:function(){for(var t=this.flatCoordinates,e=this.ends_,r=this.layout,n=[],i=0,o=0,a=e.length;o<a;++o){var s=e[o],u=new ai(t.slice(i,s),r);n.push(u),i=s}return n}},{key:"getFlatMidpoints",value:function(){for(var t=[],e=this.flatCoordinates,r=0,n=this.ends_,i=this.stride,o=0,a=n.length;o<a;++o){var s=n[o];er(t,Kn(e,r,s,i,.5)),r=s}return t}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],r=[];return e.length=zn(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,r),new o(e,Fe,r)}},{key:"getType",value:function(){return Xe}},{key:"intersectsExtent",value:function(t){return function(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){if(Jn(t,e,r[o],n,i))return!0;e=r[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=An(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()}}])&&ui(e.prototype,r),n&&ui(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(En);function yi(t){return(yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function di(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vi(t,e){return(vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bi(t);if(e){var i=bi(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return mi(this,r)}}function mi(t,e){if(e&&("object"===yi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bi(t){return(bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _i=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vi(t,e)}(o,t);var e,r,n,i=gi(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this)).setCoordinates(t,e),r}return e=o,(r=[{key:"clone",value:function(){var t=new o(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,n){var i=this.flatCoordinates,o=g(t,e,i[0],i[1]);if(o<n){for(var a=this.stride,s=0;s<a;++s)r[s]=i[s];return r.length=a,o}return n}},{key:"getCoordinates",value:function(){return this.flatCoordinates?this.flatCoordinates.slice():[]}},{key:"computeExtent",value:function(t){return Et(this.flatCoordinates,t)}},{key:"getType",value:function(){return ze}},{key:"intersectsExtent",value:function(t){return St(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,r,n){for(var i=0,o=r.length;i<o;++i)t[e++]=r[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&di(e.prototype,r),n&&di(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(En);function wi(t){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ki(t,e){return(ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Si(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ri(t);if(e){var i=Ri(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Oi(this,r)}}function Oi(t,e){if(e&&("object"===wi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ri(t){return(Ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ci=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ki(t,e)}(o,t);var e,r,n,i=Si(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r=i.call(this),e&&!Array.isArray(t[0])?r.setFlatCoordinates(e,t):r.setCoordinates(t,e),r}return e=o,(r=[{key:"appendPoint",value:function(t){this.flatCoordinates?er(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}},{key:"clone",value:function(){var t=new o(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,n){if(n<wt(this.getExtent(),t,e))return n;for(var i=this.flatCoordinates,o=this.stride,a=0,s=i.length;a<s;a+=o){var u=g(t,e,i[a],i[a+1]);if(u<n){n=u;for(var l=0;l<o;++l)r[l]=i[a+l];r.length=o}}return n}},{key:"getCoordinates",value:function(){return Xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getPoint",value:function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new _i(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}},{key:"getPoints",value:function(){for(var t=this.flatCoordinates,e=this.layout,r=this.stride,n=[],i=0,o=t.length;i<o;i+=r){var a=new _i(t.slice(i,i+r),e);n.push(a)}return n}},{key:"getType",value:function(){return We}},{key:"intersectsExtent",value:function(t){for(var e=this.flatCoordinates,r=this.stride,n=0,i=e.length;n<i;n+=r)if(St(t,e[n],e[n+1]))return!0;return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dn(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&xi(e.prototype,r),n&&xi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(En);function Pi(t,e,r,n){for(var i=0,o=t[r-n],a=t[r-n+1];e<r;e+=n){var s=t[e],u=t[e+1];i+=a*s-o*u,o=s,a=u}return i/2}function Ei(t,e,r,n){for(var i=0,o=0,a=r.length;o<a;++o){var s=r[o];i+=Pi(t,e,s,n),e=s}return i}function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mi(t,e){return(Mi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ii(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Di(t);if(e){var i=Di(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Fi(this,r)}}function Fi(t,e){if(e&&("object"===Ti(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ai=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mi(t,e)}(o,t);var e,r,n,i=Ii(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this)).maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?r.setCoordinates(t,e):r.setFlatCoordinates(e,t),r}return e=o,(r=[{key:"clone",value:function(){return new o(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,r,n){return n<wt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),In(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,r,n))}},{key:"getArea",value:function(){return Pi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return Xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=Ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new o(e,Fe)}},{key:"getType",value:function(){return Ge}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dn(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&ji(e.prototype,r),n&&ji(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(En);function Li(t,e,r,n,i,o,a){for(var s,u,l,c,f,h,p,y=i[o+1],d=[],v=0,g=r.length;v<g;++v){var m=r[v];for(c=t[m-n],h=t[m-n+1],s=e;s<m;s+=n)f=t[s],p=t[s+1],(y<=h&&p<=y||h<=y&&y<=p)&&(l=(y-h)/(p-h)*(f-c)+c,d.push(l)),c=f,h=p}var b=NaN,_=-1/0;for(d.sort(Qe),c=d[0],s=1,u=d.length;s<u;++s){f=d[s];var w=Math.abs(f-c);w>_&&Hn(t,e,r,n,l=(c+f)/2,y)&&(b=l,_=w),c=f}return isNaN(b)&&(b=i[o]),a?(a.push(b,y,_),a):[b,y,_]}function zi(t,e,r,n,i){for(var o=[],a=0,s=r.length;a<s;++a){var u=r[a];o=Li(t,e,u,n,i,2*a,o),e=u[u.length-1]}return o}function Bi(t,e,r,n){for(;e<r-n;){for(var i=0;i<n;++i){var o=t[e+i];t[e+i]=t[r-n+i],t[r-n+i]=o}e+=n,r-=n}}function Gi(t,e,r,n){for(var i=0,o=t[r-n],a=t[r-n+1];e<r;e+=n){var s=t[e],u=t[e+1];i+=(s-o)*(u+a),o=s,a=u}return 0===i?void 0:i>0}function Ni(t,e,r,n,i){for(var o=void 0!==i&&i,a=0,s=r.length;a<s;++a){var u=r[a],l=Gi(t,e,u,n);if(0===a){if(o&&l||!o&&!l)return!1}else if(o&&!l||!o&&l)return!1;e=u}return!0}function Wi(t,e,r,n,i){for(var o=void 0!==i&&i,a=0,s=r.length;a<s;++a){var u=r[a],l=Gi(t,e,u,n);(0===a?o&&l||!o&&!l:o&&!l||!o&&l)&&Bi(t,e,u,n),e=u}return e}function Xi(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o)e=Wi(t,e,r[o],n,i);return e}function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ki(t,e){return(Ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ui(t);if(e){var i=Ui(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Zi(this,r)}}function Zi(t,e){if(e&&("object"===qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ui(t){return(Ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Hi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ki(t,e)}(o,t);var e,r,n,i=Yi(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).ends_=[],n.flatInteriorPointRevision_=-1,n.flatInteriorPoint_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,void 0!==e&&r?(n.setFlatCoordinates(e,t),n.ends_=r):n.setCoordinates(t,e),n}return e=o,(r=[{key:"appendLinearRing",value:function(t){this.flatCoordinates?er(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new o(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,n){return n<wt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Mn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,n))}},{key:"containsXY",value:function(t,e){return Hn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return Ei(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?Wi(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,qn(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Gt(this.getExtent());this.flatInteriorPoint_=Li(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new _i(this.getFlatInteriorPoint(),Ae)}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new Ai(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,r=this.ends_,n=[],i=0,o=0,a=r.length;o<a;++o){var s=r[o],u=new Ai(e.slice(i,s),t);n.push(u),i=s}return n}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Ni(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Wi(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],r=[];return e.length=Nn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,r),new o(e,Fe,r)}},{key:"getType",value:function(){return Ne}},{key:"intersectsExtent",value:function(t){return Qn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=An(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()}}])&&Vi(e.prototype,r),n&&Vi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(En),Ji=Hi;function Qi(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=[e,r,e,i,n,i,n,r,e,r];return new Hi(o,Fe,[o.length])}function $i(t,e,r,n){for(var i=[],o=[1/0,1/0,-1/0,-1/0],a=0,s=r.length;a<s;++a){var u=r[a];o=Tt(t,e,u[0],n),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=u[u.length-1]}return i}function to(t){return(to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ro(t,e){return(ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function no(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oo(t);if(e){var i=oo(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return io(this,r)}}function io(t,e){if(e&&("object"===to(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oo(t){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ao=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ro(t,e)}(o,t);var e,r,n,i=no(o);function o(t,e,r){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).endss_=[],n.flatInteriorPointsRevision_=-1,n.flatInteriorPoints_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var a=n.getLayout(),s=t,u=[],l=[],c=0,f=s.length;c<f;++c){var h=s[c];0===c&&(a=h.getLayout());for(var p=u.length,y=h.getEnds(),d=0,v=y.length;d<v;++d)y[d]+=p;er(u,h.getFlatCoordinates()),l.push(y)}e=a,t=u,r=l}return void 0!==e&&r?(n.setFlatCoordinates(e,t),n.endss_=r):n.setCoordinates(t,e),n}return e=o,(r=[{key:"appendPolygon",value:function(t){var e;if(this.flatCoordinates){var r=this.flatCoordinates.length;er(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,i=(e=t.getEnds().slice()).length;n<i;++n)e[n]+=r}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}},{key:"clone",value:function(){for(var t=this.endss_.length,e=new Array(t),r=0;r<t;++r)e[r]=this.endss_[r].slice();var n=new o(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}},{key:"closestPointXY",value:function(t,e,r,n){return n<wt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];i=Mn(t,e,s,n,i),e=s[s.length-1]}return i}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,r,n,i,o,a,s,u,l,c){for(var f=c||[NaN,NaN],h=0,p=r.length;h<p;++h){var y=r[h];l=Fn(t,e,y,n,i,o,a,s,u,l,f),e=y[y.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,r,n))}},{key:"containsXY",value:function(t,e){return function(t,e,r,n,i,o){if(0===r.length)return!1;for(var a=0,s=r.length;a<s;++a){var u=r[a];if(Hn(t,e,u,n,i,o))return!0;e=u[u.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}},{key:"getArea",value:function(){return function(t,e,r,n){for(var i=0,o=0,a=r.length;o<a;++o){var s=r[o];i+=Ei(t,e,s,n),e=s[s.length-1]}return i}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?Xi(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,Vn(e,0,this.endss_,this.stride)}},{key:"getEndss",value:function(){return this.endss_}},{key:"getFlatInteriorPoints",value:function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=$i(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=zi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}},{key:"getInteriorPoints",value:function(){return new Ci(this.getFlatInteriorPoints().slice(),Ae)}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];if(!Ni(t,e,s,n,i))return!1;s.length&&(e=s[s.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Xi(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],r=[];return e.length=function(t,e,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var c=r[u],f=[];a=Nn(t,e,c,n,i,o,a,f),s.push(f),e=c[c.length-1]}return a}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,r),new o(e,Fe,r)}},{key:"getPolygon",value:function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var r=this.endss_[t-1];e=r[r.length-1]}var n=this.endss_[t].slice(),i=n[n.length-1];if(0!==e)for(var o=0,a=n.length;o<a;++o)n[o]-=e;return new Ji(this.flatCoordinates.slice(e,i),this.layout,n)}},{key:"getPolygons",value:function(){for(var t=this.layout,e=this.flatCoordinates,r=this.endss_,n=[],i=0,o=0,a=r.length;o<a;++o){var s=r[o].slice(),u=s[s.length-1];if(0!==i)for(var l=0,c=s.length;l<c;++l)s[l]-=i;var f=new Ji(e.slice(i,u),t,s);n.push(f),i=u}return n}},{key:"getType",value:function(){return qe}},{key:"intersectsExtent",value:function(t){return function(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];if(Qn(t,e,s,n,i))return!0;e=s[s.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var r=function(t,e,r,n,i){for(var o=i||[],a=0,s=0,u=r.length;s<u;++s){var l=An(t,e,r[s],n,o[a]);o[a++]=l,e=l[l.length-1]}return o.length=a,o}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===r.length)this.flatCoordinates.length=0;else{var n=r[r.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()}}])&&eo(e.prototype,r),n&&eo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(En),so=r(443);function uo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var lo=[1,0,0,1,0,0],co=function(){function t(e,r,n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=r,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n,this.properties_=i}var e,r,n;return e=t,(r=[{key:"get",value:function(t){return this.properties_[t]}},{key:"getExtent",value:function(){return this.extent_||(this.extent_=this.type_===ze?Et(this.flatCoordinates_):Tt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}},{key:"getFlatInteriorPoint",value:function(){if(!this.flatInteriorPoints_){var t=Gt(this.getExtent());this.flatInteriorPoints_=Li(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}},{key:"getFlatInteriorPoints",value:function(){if(!this.flatInteriorPoints_){var t=$i(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=zi(this.flatCoordinates_,0,this.ends_,2,t)}return this.flatInteriorPoints_}},{key:"getFlatMidpoint",value:function(){return this.flatMidpoints_||(this.flatMidpoints_=Kn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}},{key:"getFlatMidpoints",value:function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,r=this.ends_,n=0,i=r.length;n<i;++n){var o=r[n],a=Kn(t,e,o,2,.5);er(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}},{key:"getId",value:function(){return this.id_}},{key:"getOrientedFlatCoordinates",value:function(){return this.flatCoordinates_}},{key:"getGeometry",value:function(){return this}},{key:"getSimplifiedGeometry",value:function(t){return this}},{key:"simplifyTransformed",value:function(t,e){return this}},{key:"getProperties",value:function(){return this.properties_}},{key:"getStride",value:function(){return 2}},{key:"getStyleFunction",value:function(){return this.styleFunction}},{key:"getType",value:function(){return this.type_}},{key:"transform",value:function(t){var e=(t=se(t)).getExtent(),r=t.getWorldExtent();if(e&&r){var n=Xt(r)/Xt(e);ln(lo,r[0],r[3],n,-n,0,0,0),hn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,lo,this.flatCoordinates_)}}},{key:"getEnds",value:function(){return this.ends_}}])&&uo(e.prototype,r),n&&uo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();co.prototype.getEndss=co.prototype.getEnds,co.prototype.getFlatCoordinates=co.prototype.getOrientedFlatCoordinates;var fo=co;function ho(t){return(ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function po(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yo(t,e){return(yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mo(t);if(e){var i=mo(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return go(this,r)}}function go(t,e){if(e&&("object"===ho(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function mo(t){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bo(t,e,r){if(3===t){var n={keys:[],values:[],features:[]},i=r.readVarint()+r.pos;r.readFields(_o,n,i),n.length=n.features.length,n.length&&(e[n.name]=n)}}function _o(t,e,r){if(15===t)e.version=r.readVarint();else if(1===t)e.name=r.readString();else if(5===t)e.extent=r.readVarint();else if(2===t)e.features.push(r.pos);else if(3===t)e.keys.push(r.readString());else if(4===t){for(var n=null,i=r.readVarint()+r.pos;r.pos<i;)n=1===(t=r.readVarint()>>3)?r.readString():2===t?r.readFloat():3===t?r.readDouble():4===t?r.readVarint64():5===t?r.readVarint():6===t?r.readSVarint():7===t?r.readBoolean():null;e.values.push(n)}}function wo(t,e,r){if(1==t)e.id=r.readVarint();else if(2==t)for(var n=r.readVarint()+r.pos;r.pos<n;){var i=e.layer.keys[r.readVarint()],o=e.layer.values[r.readVarint()];e.properties[i]=o}else 3==t?e.type=r.readVarint():4==t&&(e.geometry=r.pos)}function xo(t,e,r){t.pos=e.features[r];var n=t.readVarint()+t.pos,i={layer:e,type:0,properties:{}};return t.readFields(wo,i,n),i}var ko=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yo(t,e)}(a,t);var e,r,i,o=vo(a);function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var r=t||{};return(e=o.call(this)).dataProjection=new h({code:"",units:n.TILE_PIXELS}),e.featureClass_=r.featureClass?r.featureClass:fo,e.geometryName_=r.geometryName,e.layerName_=r.layerName?r.layerName:"layer",e.layers_=r.layers?r.layers:null,e.idProperty_=r.idProperty,e.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"],e}return e=a,(r=[{key:"readRawGeometry_",value:function(t,e,r,n){t.pos=e.geometry;for(var i=t.readVarint()+t.pos,o=1,a=0,s=0,u=0,l=0,c=0;t.pos<i;){if(!a){var f=t.readVarint();o=7&f,a=f>>3}a--,1===o||2===o?(s+=t.readSVarint(),u+=t.readSVarint(),1===o&&l>c&&(n.push(l),c=l),r.push(s,u),l+=2):7===o?l>c&&(r.push(r[c],r[c+1]),l+=2):gt(!1,59)}l>c&&(n.push(l),c=l)}},{key:"createFeature_",value:function(t,e,r){var n,i=e.type;if(0===i)return null;var o,a=e.properties;this.idProperty_?(o=a[this.idProperty_],delete a[this.idProperty_]):o=e.id,a[this.layerName_]=e.layer.name;var s=[],u=[];this.readRawGeometry_(t,e,s,u);var l=function(t,e){var r;return 1===t?r=1===e?ze:We:2===t?r=1===e?Be:Xe:3===t&&(r=Ne),r}(i,u.length);if(this.featureClass_===fo)(n=new this.featureClass_(l,s,u,a,o)).transform(r.dataProjection);else{var c;if(l==Ne){var f=function(t,e){for(var r=[],n=0,i=0,o=0,a=e.length;o<a;++o){var s=e[o];if(Gi(t,n,s,2)){if(0===r.length)continue;r[r.length-1].push(e[i])}else r.push(e.slice(i,o+1));i=o+1,n=s}return r}(s,u);c=f.length>1?new ao(s,Fe,f):new Ji(s,Fe,u)}else c=l===ze?new _i(s,Fe):l===Be?new ai(s,Fe):l===Ne?new Ji(s,Fe,u):l===We?new Ci(s,Fe):l===Xe?new pi(s,Fe,u):null;n=new(0,this.featureClass_),this.geometryName_&&n.setGeometryName(this.geometryName_);var h=Ee(c,!1,r);n.setGeometry(h),void 0!==o&&n.setId(o),n.setProperties(a,!0)}return n}},{key:"getType",value:function(){return Te}},{key:"readFeatures",value:function(t,e){var r=this.layers_,n=this.adaptOptions(e),i=se(n.dataProjection);i.setWorldExtent(n.extent),n.dataProjection=i;var o=new so(t),a=o.readFields(bo,{}),s=[];for(var u in a)if(!r||-1!=r.indexOf(u)){var l=a[u],c=l?[0,0,l.extent,l.extent]:null;i.setExtent(c);for(var f=0,h=l.length;f<h;++f){var p=xo(o,l,f),y=this.createFeature_(o,p,n);null!==y&&s.push(y)}}return s}},{key:"readProjection",value:function(t){return this.dataProjection}},{key:"setLayers",value:function(t){this.layers_=t}}])&&po(e.prototype,r),i&&po(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a}(Pe);function So(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Oo=1/0,Ro=0,Co=1,Po=2,Eo=3,To=4;function jo(t){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Io(){return(Io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Fo(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Fo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bo(t)););return t}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ao(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Bo(t);if(e){var i=Bo(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Lo(this,r)}}function Lo(t,e){if(e&&("object"===jo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return zo(t)}function zo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Go=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Do(t,e)}(o,t);var e,r,n,i=Ao(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,(function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()}))).boundHandleTileChange_=r.handleTileChange.bind(zo(r)),r.tileChangeCallback_=e,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return e=o,(r=[{key:"enqueue",value:function(t){var e=Io(Bo(o.prototype),"enqueue",this).call(this,t);return e&&t[0].addEventListener(pr,this.boundHandleTileChange_),e}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(t){var e=t.target,r=e.getState();if(r===Po||r===Eo||r===To){e.removeEventListener(pr,this.boundHandleTileChange_);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}},{key:"loadMoreTiles",value:function(t,e){for(var r,n,i=0;this.tilesLoading_<t&&i<e&&this.getCount()>0;)n=(r=this.dequeue()[0]).getKey(),r.getState()!==Ro||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++i,r.load())}}])&&Mo(e.prototype,r),n&&Mo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.priorityFunction_=e,this.keyFunction_=r,this.elements_=[],this.priorities_=[],this.queuedElements_={}}var e,r,n;return e=t,(r=[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,u(this.queuedElements_)}},{key:"dequeue",value:function(){var t=this.elements_,e=this.priorities_,r=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(r);return delete this.queuedElements_[n],r}},{key:"enqueue",value:function(t){gt(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=Oo&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(t){return 2*t+1}},{key:"getRightChildIndex_",value:function(t){return 2*t+2}},{key:"getParentIndex_",value:function(t){return t-1>>1}},{key:"heapify_",value:function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(t){return t in this.queuedElements_}},{key:"isQueued",value:function(t){return this.isKeyQueued(this.keyFunction_(t))}},{key:"siftUp_",value:function(t){for(var e=this.elements_,r=this.priorities_,n=e.length,i=e[t],o=r[t],a=t;t<n>>1;){var s=this.getLeftChildIndex_(t),u=this.getRightChildIndex_(t),l=u<n&&r[u]<r[s]?u:s;e[t]=e[l],r[t]=r[l],t=l}e[t]=i,r[t]=o,this.siftDown_(a,t)}},{key:"siftDown_",value:function(t,e){for(var r=this.elements_,n=this.priorities_,i=r[e],o=n[e];e>t;){var a=this.getParentIndex_(e);if(!(n[a]>o))break;r[e]=r[a],n[e]=n[a],e=a}r[e]=i,n[e]=o}},{key:"reprioritize",value:function(){var t,e,r,n=this.priorityFunction_,i=this.elements_,o=this.priorities_,a=0,s=i.length;for(e=0;e<s;++e)(r=n(t=i[e]))==Oo?delete this.queuedElements_[this.keyFunction_(t)]:(o[a]=r,i[a++]=t);i.length=a,o.length=a,this.heapify_()}}])&&So(e.prototype,r),n&&So(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function No(t,e,r,n,i){if(!t||!(r in t.wantedTiles))return Oo;if(!t.wantedTiles[r][e.getKey()])return Oo;var o=t.viewState.center,a=n[0]-o[0],s=n[1]-o[1];return 65536*Math.log(i)+Math.sqrt(a*a+s*s)/i}var Wo="opacity",Xo="visible",qo="extent",Vo="zIndex",Ko="maxResolution",Yo="minResolution",Zo="maxZoom",Uo="minZoom",Ho="source",Jo="map";function Qo(t){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ta(){return(ta="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=ea(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function ea(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oa(t)););return t}function ra(t,e){return(ra=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function na(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oa(t);if(e){var i=oa(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ia(this,r)}}function ia(t,e){if(e&&("object"===Qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oa(t){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ra(t,e)}(a,t);var e,r,n,o=na(a);function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).on,e.once,e.un,e.background_=t.background;var r=s({},t);return"object"===Qo(t.properties)&&(delete r.properties,s(r,t.properties)),r[Wo]=void 0!==t.opacity?t.opacity:1,gt("number"==typeof r[Wo],64),r[Xo]=void 0===t.visible||t.visible,r[Vo]=t.zIndex,r[Ko]=void 0!==t.maxResolution?t.maxResolution:1/0,r[Yo]=void 0!==t.minResolution?t.minResolution:0,r[Uo]=void 0!==t.minZoom?t.minZoom:-1/0,r[Zo]=void 0!==t.maxZoom?t.maxZoom:1/0,e.className_=void 0!==r.className?r.className:"ol-layer",delete r.className,e.setProperties(r),e.state_=null,e}return e=a,(r=[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(t){var e=this.state_||{layer:this,managed:void 0===t||t},r=this.getZIndex();return e.opacity=p(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==r||e.managed?r:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}},{key:"getLayersArray",value:function(t){return i()}},{key:"getLayerStatesArray",value:function(t){return i()}},{key:"getExtent",value:function(){return this.get(qo)}},{key:"getMaxResolution",value:function(){return this.get(Ko)}},{key:"getMinResolution",value:function(){return this.get(Yo)}},{key:"getMinZoom",value:function(){return this.get(Uo)}},{key:"getMaxZoom",value:function(){return this.get(Zo)}},{key:"getOpacity",value:function(){return this.get(Wo)}},{key:"getSourceState",value:function(){return i()}},{key:"getVisible",value:function(){return this.get(Xo)}},{key:"getZIndex",value:function(){return this.get(Vo)}},{key:"setBackground",value:function(t){this.background_=t,this.changed()}},{key:"setExtent",value:function(t){this.set(qo,t)}},{key:"setMaxResolution",value:function(t){this.set(Ko,t)}},{key:"setMinResolution",value:function(t){this.set(Yo,t)}},{key:"setMaxZoom",value:function(t){this.set(Zo,t)}},{key:"setMinZoom",value:function(t){this.set(Uo,t)}},{key:"setOpacity",value:function(t){gt("number"==typeof t,64),this.set(Wo,t)}},{key:"setVisible",value:function(t){this.set(Xo,t)}},{key:"setZIndex",value:function(t){this.set(Vo,t)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),ta(oa(a.prototype),"disposeInternal",this).call(this)}}])&&$o(e.prototype,r),n&&$o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Yr),sa="prerender",ua="postrender",la="precompose",ca="postcompose",fa="rendercomplete",ha="undefined",pa="loading",ya="ready",da="error";function va(t){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ga(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ma(){return(ma="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=ba(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function ba(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ka(t)););return t}function _a(t,e){return(_a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ka(t);if(e){var i=ka(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return xa(this,r)}}function xa(t,e){if(e&&("object"===va(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ka(t){return(ka=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sa(t,e){if(!t.visible)return!1;var r=e.resolution;if(r<t.minResolution||r>=t.maxResolution)return!1;var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}var Oa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_a(t,e)}(o,t);var e,r,n,i=wa(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=s({},t);delete r.source,(e=i.call(this,r)).on,e.once,e.un,e.mapPrecomposeKey_=null,e.mapRenderKey_=null,e.sourceChangeKey_=null,e.renderer_=null,e.rendered=!1,t.render&&(e.render=t.render),t.map&&e.setMap(t.map),e.addChangeListener(Ho,e.handleSourcePropertyChange_);var n=t.source?t.source:null;return e.setSource(n),e}return e=o,(r=[{key:"getLayersArray",value:function(t){var e=t||[];return e.push(this),e}},{key:"getLayerStatesArray",value:function(t){var e=t||[];return e.push(this.getLayerState()),e}},{key:"getSource",value:function(){return this.get(Ho)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var t=this.getSource();return t?t.getState():ha}},{key:"handleSourceChange_",value:function(){this.changed()}},{key:"handleSourcePropertyChange_",value:function(){this.sourceChangeKey_&&(Rr(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Sr(t,pr,this.handleSourceChange_,this)),this.changed()}},{key:"getFeatures",value:function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise((function(t){return t([])}))}},{key:"getData",value:function(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}},{key:"render",value:function(t,e){var r=this.getRenderer();if(r.prepareFrame(t))return this.rendered=!0,r.renderFrame(t,e)}},{key:"unrender",value:function(){this.rendered=!1}},{key:"setMapInternal",value:function(t){t||this.unrender(),this.set(Jo,t)}},{key:"getMapInternal",value:function(){return this.get(Jo)}},{key:"setMap",value:function(t){this.mapPrecomposeKey_&&(Rr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Rr(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Sr(t,la,(function(t){var e=t.frameState.layerStatesArray,r=this.getLayerState(!1);gt(!e.some((function(t){return t.layer===r.layer})),67),e.push(r)}),this),this.mapRenderKey_=Sr(this,pr,t.render,t),this.changed())}},{key:"setSource",value:function(t){this.set(Ho,t)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),ma(ka(o.prototype),"disposeInternal",this).call(this)}}])&&ga(e.prototype,r),n&&ga(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(aa),Ra=r(925),Ca=0,Pa=1,Ea=2,Ta=3;function ja(t){return t[0]>0&&t[1]>0}function Ma(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function Ia(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Fa=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ma(e.scale),this.displacement_=e.displacement}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getAnchor",value:function(){return i()}},{key:"getImage",value:function(t){return i()}},{key:"getHitDetectionImage",value:function(){return i()}},{key:"getPixelRatio",value:function(t){return 1}},{key:"getImageState",value:function(){return i()}},{key:"getImageSize",value:function(){return i()}},{key:"getOrigin",value:function(){return i()}},{key:"getSize",value:function(){return i()}},{key:"setDisplacement",value:function(t){this.displacement_=t}},{key:"setOpacity",value:function(t){this.opacity_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=Ma(t)}},{key:"listenImageChange",value:function(t){i()}},{key:"load",value:function(){i()}},{key:"unlistenImageChange",value:function(t){i()}}])&&Ia(e.prototype,r),n&&Ia(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Da=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Aa=/^([a-z]*)$|^hsla?\(.*\)$/i;function La(t){return"string"==typeof t?t:Wa(t)}function za(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var r=getComputedStyle(e).color;return document.body.removeChild(e),r}return""}var Ba=function(){var t={},e=0;return function(r){var n;if(t.hasOwnProperty(r))n=t[r];else{if(e>=1024){var i=0;for(var o in t)0==(3&i++)&&(delete t[o],--e)}n=function(t){var e,r,n,i,o;Aa.exec(t)&&(t=za(t));if(Da.exec(t)){var a,s=t.length-1;a=s<=4?1:2;var u=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),r=parseInt(t.substr(1+1*a,a),16),n=parseInt(t.substr(1+2*a,a),16),i=u?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,r=(r<<4)+r,n=(n<<4)+n,u&&(i=(i<<4)+i)),o=[e,r,n,i/255]}else 0==t.indexOf("rgba(")?Na(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),Na(o)):gt(!1,14);return o}(r),t[r]=n,++e}return n}}();function Ga(t){return Array.isArray(t)?t:Ba(t)}function Na(t){return t[0]=p(t[0]+.5|0,0,255),t[1]=p(t[1]+.5|0,0,255),t[2]=p(t[2]+.5|0,0,255),t[3]=p(t[3],0,1),t}function Wa(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var r=t[1];r!=(0|r)&&(r=r+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+r+","+n+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function Xa(t){return Array.isArray(t)?Wa(t):t}function qa(t,e,r,n){var i;return i=r&&r.length?r.shift():$r?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",n)}function Va(t,e){var r=e.parentNode;r&&r.replaceChild(t,e)}function Ka(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var Ya="ol-hidden",Za="ol-control",Ua="ol-collapsed",Ha=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),Ja=["style","variant","weight","size","lineHeight","family"],Qa=function(t){var e=t.match(Ha);if(!e)return null;for(var r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,i=Ja.length;n<i;++n){var o=e[n+1];void 0!==o&&(r[Ja[n]]=o)}return r.families=r.family.split(/,\s?/),r};function $a(t){return 1===t?"":String(Math.round(100*t)/100)}var ts="10px sans-serif",es="#000",rs="round",ns=[],is="round",os="#000",as="center",ss="middle",us=[0,0,0,0],ls=new Yr;(new hr).setSize=function(){console.warn("labelCache is deprecated.")};var cs,fs,hs=null,ps={},ys=function(){var t,e,r="32px ",n=["monospace","serif"],i=n.length,o="wmytzilWMYTZIL@#/&?$%10";function a(t,a,s){for(var u=!0,l=0;l<i;++l){var c=n[l];if(e=gs(t+" "+a+" "+r+c,o),s!=c){var f=gs(t+" "+a+" "+r+s+","+c,o);u=u&&f!=e}}return!!u}function s(){for(var e=!0,r=ls.getKeys(),n=0,i=r.length;n<i;++n){var o=r[n];ls.get(o)<100&&(a.apply(this,o.split("\n"))?(u(ps),hs=null,cs=void 0,ls.set(o,100)):(ls.set(o,ls.get(o)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var r=Qa(e);if(r)for(var n=r.families,i=0,o=n.length;i<o;++i){var u=n[i],l=r.style+"\n"+r.weight+"\n"+u;void 0===ls.get(l)&&(ls.set(l,100,!0),a(r.style,r.weight,u)||(ls.set(l,0,!0),void 0===t&&(t=setInterval(s,32))))}}}(),ds=function(t){var e=ps[t];if(null==e){if($r){var r=Qa(t),n=vs(t,"Žg");e=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else fs||((fs=document.createElement("div")).innerHTML="M",fs.style.minHeight="0",fs.style.maxHeight="none",fs.style.height="auto",fs.style.padding="0",fs.style.border="none",fs.style.position="absolute",fs.style.display="block",fs.style.left="-99999px"),fs.style.font=t,document.body.appendChild(fs),e=fs.offsetHeight,document.body.removeChild(fs);ps[t]=e}return e};function vs(t,e){return hs||(hs=qa(1,1)),t!=cs&&(hs.font=t,cs=hs.font),hs.measureText(e)}function gs(t,e){return vs(t,e).width}function ms(t,e,r){if(e in r)return r[e];var n=gs(t,e);return r[e]=n,n}function bs(t,e,r,n,i,o,a,s,u,l,c){t.save(),1!==r&&(t.globalAlpha*=r),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(u,l),t.scale(c[0],c[1]),function(t,e){for(var r=t.contextInstructions,n=0,i=r.length;n<i;n+=2)Array.isArray(r[n+1])?e[r[n]].apply(e,r[n+1]):e[r[n]]=r[n+1]}(n,t)):c[0]<0||c[1]<0?(t.translate(u,l),t.scale(c[0],c[1]),t.drawImage(n,i,o,a,s,0,0,a,s)):t.drawImage(n,i,o,a,s,u,l,a*c[0],s*c[1]),t.restore()}function _s(t){return(_s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ws(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xs(t,e){return(xs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ks(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Os(t);if(e){var i=Os(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ss(this,r)}}function Ss(t,e){if(e&&("object"===_s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Os(t){return(Os=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rs(t){return(Rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ps(t,e){return(Ps=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Es(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=js(t);if(e){var i=js(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ts(this,r)}}function Ts(t,e){if(e&&("object"===Rs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function js(t){return(js=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ms=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ps(t,e)}(o,t);var e,r,n,i=Es(o);function o(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=t||{};return i.call(this,{points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:void 0!==e.scale?e.scale:1,rotation:void 0!==e.rotation?e.rotation:0,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView,displacement:void 0!==e.displacement?e.displacement:[0,0]})}return e=o,(r=[{key:"clone",value:function(){var t=this.getScale(),e=new o({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return e.setOpacity(this.getOpacity()),e}},{key:"setRadius",value:function(t){this.radius_=t,this.render()}}])&&Cs(e.prototype,r),n&&Cs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xs(t,e)}(o,t);var e,r,n,i=ks(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=void 0!==t.rotateWithView&&t.rotateWithView;return(e=i.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0]})).canvas_=void 0,e.hitDetectionCanvas_=null,e.fill_=void 0!==t.fill?t.fill:null,e.origin_=[0,0],e.points_=t.points,e.radius_=void 0!==t.radius?t.radius:t.radius1,e.radius2_=t.radius2,e.angle_=void 0!==t.angle?t.angle:0,e.stroke_=void 0!==t.stroke?t.stroke:null,e.size_=null,e.renderOptions_=null,e.render(),e}return e=o,(r=[{key:"clone",value:function(){var t=this.getScale(),e=new o({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return e.setOpacity(this.getOpacity()),e}},{key:"getAnchor",value:function(){var t=this.size_;if(!t)return null;var e=this.getDisplacement();return[t[0]/2-e[0],t[1]/2+e[1]]}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"getHitDetectionImage",value:function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}},{key:"getImage",value:function(t){var e=this.canvas_[t];if(!e){var r=this.renderOptions_,n=qa(r.size*t,r.size*t);this.draw_(r,n,t),e=n.canvas,this.canvas_[t]=e}return e}},{key:"getPixelRatio",value:function(t){return t}},{key:"getImageSize",value:function(){return this.size_}},{key:"getImageState",value:function(){return Ea}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius_}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"listenImageChange",value:function(t){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(t){}},{key:"calculateLineJoinSize_",value:function(t,e,r){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;var n=this.radius_,i=void 0===this.radius2_?n:this.radius2_;if(n<i){var o=n;n=i,i=o}var a=void 0===this.radius2_?this.points_:2*this.points_,s=2*Math.PI/a,u=i*Math.sin(s),l=n-Math.sqrt(i*i-u*u),c=Math.sqrt(u*u+l*l),f=c/u;if("miter"===t&&f<=r)return f*e;var h=e/2/f,p=e/2*(l/c),y=Math.sqrt((n+h)*(n+h)+p*p)-n;if(void 0===this.radius2_||"bevel"===t)return 2*y;var d=n*Math.sin(s),v=i-Math.sqrt(n*n-d*d),g=Math.sqrt(d*d+v*v)/d;if(g<=r){var m=g*e/2-i-n;return 2*Math.max(y,m)}return 2*y}},{key:"createRenderOptions",value:function(){var t,e=is,r=0,n=null,i=0,o=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=os),t=Xa(t),void 0===(o=this.stroke_.getWidth())&&(o=1),n=this.stroke_.getLineDash(),i=this.stroke_.getLineDashOffset(),void 0===(e=this.stroke_.getLineJoin())&&(e=is),void 0===(r=this.stroke_.getMiterLimit())&&(r=10));var a=this.calculateLineJoinSize_(e,o,r),s=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*s+a),lineDash:n,lineDashOffset:i,lineJoin:e,miterLimit:r}}},{key:"render",value:function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]}},{key:"draw_",value:function(t,e,r){if(e.scale(r,r),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){var n=this.fill_.getColor();null===n&&(n=es),e.fillStyle=Xa(n),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}},{key:"createHitDetectionCanvas_",value:function(t){if(this.fill_){var e=this.fill_.getColor(),r=0;if("string"==typeof e&&(e=Ga(e)),null===e?r=1:Array.isArray(e)&&(r=4===e.length?e[3]:1),0===r){var n=qa(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}},{key:"createPath_",value:function(t){var e=this.points_,r=this.radius_;if(e===1/0)t.arc(0,0,r,0,2*Math.PI);else{var n=void 0===this.radius2_?r:this.radius2_;void 0!==this.radius2_&&(e*=2);for(var i=this.angle_-Math.PI/2,o=2*Math.PI/e,a=0;a<e;a++){var s=i+a*o,u=a%2==0?r:n;t.lineTo(u*Math.cos(s),u*Math.sin(s))}t.closePath()}}},{key:"drawHitDetectionCanvas_",value:function(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=es,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}])&&ws(e.prototype,r),n&&ws(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Fa));function Is(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Fs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e||{};this.color_=void 0!==r.color?r.color:null}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(t){this.color_=t}}])&&Is(e.prototype,r),n&&Is(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ds(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var As=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e||{};this.color_=void 0!==r.color?r.color:null,this.lineCap_=r.lineCap,this.lineDash_=void 0!==r.lineDash?r.lineDash:null,this.lineDashOffset_=r.lineDashOffset,this.lineJoin_=r.lineJoin,this.miterLimit_=r.miterLimit,this.width_=r.width}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(t){this.color_=t}},{key:"setLineCap",value:function(t){this.lineCap_=t}},{key:"setLineDash",value:function(t){this.lineDash_=t}},{key:"setLineDashOffset",value:function(t){this.lineDashOffset_=t}},{key:"setLineJoin",value:function(t){this.lineJoin_=t}},{key:"setMiterLimit",value:function(t){this.miterLimit_=t}},{key:"setWidth",value:function(t){this.width_=t}}])&&Ds(e.prototype,r),n&&Ds(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ls(t){return(Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Bs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e||{};this.geometry_=null,this.geometryFunction_=Ws,void 0!==r.geometry&&this.setGeometry(r.geometry),this.fill_=void 0!==r.fill?r.fill:null,this.image_=void 0!==r.image?r.image:null,this.renderer_=void 0!==r.renderer?r.renderer:null,this.hitDetectionRenderer_=void 0!==r.hitDetectionRenderer?r.hitDetectionRenderer:null,this.stroke_=void 0!==r.stroke?r.stroke:null,this.text_=void 0!==r.text?r.text:null,this.zIndex_=r.zIndex}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getGeometry();return e&&"object"===Ls(e)&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(t){this.renderer_=t}},{key:"setHitDetectionRenderer",value:function(t){this.hitDetectionRenderer_=t}},{key:"getHitDetectionRenderer",value:function(){return this.hitDetectionRenderer_}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(t){this.text_=t}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Ws,this.geometry_=t}},{key:"setZIndex",value:function(t){this.zIndex_=t}}])&&zs(e.prototype,r),n&&zs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Gs=null;function Ns(t,e){if(!Gs){var r=new Fs({color:"rgba(255,255,255,0.4)"}),n=new As({color:"#3399CC",width:1.25});Gs=[new Bs({image:new Ms({fill:r,stroke:n,radius:5}),fill:r,stroke:n})]}return Gs}function Ws(t){return t.getGeometry()}var Xs=Bs;function qs(t){return(qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ks(){return(Ks="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Ys(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Ys(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Js(t)););return t}function Zs(t,e){return(Zs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Us(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Js(t);if(e){var i=Js(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Hs(this,r)}}function Hs(t,e){if(e&&("object"===qs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Js(t){return(Js=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qs="renderOrder",$s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zs(t,e)}(o,t);var e,r,n,i=Us(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{},n=s({},r);return delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,(e=i.call(this,n)).declutter_=void 0!==r.declutter&&r.declutter,e.renderBuffer_=void 0!==r.renderBuffer?r.renderBuffer:100,e.style_=null,e.styleFunction_=void 0,e.setStyle(r.style),e.updateWhileAnimating_=void 0!==r.updateWhileAnimating&&r.updateWhileAnimating,e.updateWhileInteracting_=void 0!==r.updateWhileInteracting&&r.updateWhileInteracting,e}return e=o,(r=[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(t){return Ks(Js(o.prototype),"getFeatures",this).call(this,t)}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(Qs)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"renderDeclutter",value:function(t){t.declutterTree||(t.declutterTree=new Ra(9)),this.getRenderer().renderDeclutter(t)}},{key:"setRenderOrder",value:function(t){this.set(Qs,t)}},{key:"setStyle",value:function(t){this.style_=void 0!==t?t:Ns,this.styleFunction_=null===t?void 0:function(t){var e,r;"function"==typeof t?e=t:(Array.isArray(t)?r=t:(gt("function"==typeof t.getZIndex,41),r=[t]),e=function(){return r});return e}(this.style_),this.changed()}}])&&Vs(e.prototype,r),n&&Vs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Oa),tu={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},eu=[tu.FILL],ru=[tu.STROKE],nu=[tu.BEGIN_PATH],iu=[tu.CLOSE_PATH],ou=tu;function au(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var su=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"drawCustom",value:function(t,e,r,n){}},{key:"drawGeometry",value:function(t){}},{key:"setStyle",value:function(t){}},{key:"drawCircle",value:function(t,e){}},{key:"drawFeature",value:function(t,e){}},{key:"drawGeometryCollection",value:function(t,e){}},{key:"drawLineString",value:function(t,e){}},{key:"drawMultiLineString",value:function(t,e){}},{key:"drawMultiPoint",value:function(t,e){}},{key:"drawMultiPolygon",value:function(t,e){}},{key:"drawPoint",value:function(t,e){}},{key:"drawPolygon",value:function(t,e){}},{key:"drawText",value:function(t,e){}},{key:"setFillStrokeStyle",value:function(t,e){}},{key:"setImageStyle",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}}])&&au(e.prototype,r),n&&au(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function uu(t){return(uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cu(t,e){return(cu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pu(t);if(e){var i=pu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return hu(this,r)}}function hu(t,e){if(e&&("object"===uu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pu(t){return(pu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var yu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cu(t,e)}(o,t);var e,r,n,i=fu(o);function o(t,e,r,n){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this)).tolerance=t,a.maxExtent=e,a.pixelRatio=n,a.maxLineWidth=0,a.resolution=r,a.beginGeometryInstruction1_=null,a.beginGeometryInstruction2_=null,a.bufferedMaxExtent_=null,a.instructions=[],a.coordinates=[],a.tmpCoordinate_=[],a.hitDetectionInstructions=[],a.state={},a}return e=o,(r=[{key:"applyPixelRatio",value:function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}},{key:"appendFlatPointCoordinates",value:function(t,e){for(var r=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,i=this.coordinates,o=i.length,a=0,s=t.length;a<s;a+=e)n[0]=t[a],n[1]=t[a+1],xt(r,n)&&(i[o++]=n[0],i[o++]=n[1]);return o}},{key:"appendFlatLineCoordinates",value:function(t,e,r,n,i,o){var a=this.coordinates,s=a.length,u=this.getBufferedMaxExtent();o&&(e+=n);var l,c,f,h=t[e],p=t[e+1],y=this.tmpCoordinate_,d=!0;for(l=e+n;l<r;l+=n)y[0]=t[l],y[1]=t[l+1],(f=Ot(u,y))!==c?(d&&(a[s++]=h,a[s++]=p,d=!1),a[s++]=y[0],a[s++]=y[1]):f===nt?(a[s++]=y[0],a[s++]=y[1],d=!1):d=!0,h=y[0],p=y[1],c=f;return(i&&d||l===e+n)&&(a[s++]=h,a[s++]=p),s}},{key:"drawCustomCoordinates_",value:function(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o],u=this.appendFlatLineCoordinates(t,e,s,n,!1,!1);i.push(u),e=s}return e}},{key:"drawCustom",value:function(t,e,r,n){this.beginGeometry(t,e);var i,o,a,s,u,l=t.getType(),c=t.getStride(),f=this.coordinates.length;switch(l){case qe:i=t.getOrientedFlatCoordinates(),s=[];var h=t.getEndss();u=0;for(var p=0,y=h.length;p<y;++p){var d=[];u=this.drawCustomCoordinates_(i,u,h[p],c,d),s.push(d)}this.instructions.push([ou.CUSTOM,f,s,t,r,Vn]),this.hitDetectionInstructions.push([ou.CUSTOM,f,s,t,n||r,Vn]);break;case Ne:case Xe:a=[],i=l==Ne?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),u=this.drawCustomCoordinates_(i,0,t.getEnds(),c,a),this.instructions.push([ou.CUSTOM,f,a,t,r,qn]),this.hitDetectionInstructions.push([ou.CUSTOM,f,a,t,n||r,qn]);break;case Be:case Ke:i=t.getFlatCoordinates(),o=this.appendFlatLineCoordinates(i,0,i.length,c,!1,!1),this.instructions.push([ou.CUSTOM,f,o,t,r,Xn]),this.hitDetectionInstructions.push([ou.CUSTOM,f,o,t,n||r,Xn]);break;case We:i=t.getFlatCoordinates(),(o=this.appendFlatPointCoordinates(i,c))>f&&(this.instructions.push([ou.CUSTOM,f,o,t,r,Xn]),this.hitDetectionInstructions.push([ou.CUSTOM,f,o,t,n||r,Xn]));break;case ze:i=t.getFlatCoordinates(),this.coordinates.push(i[0],i[1]),o=this.coordinates.length,this.instructions.push([ou.CUSTOM,f,o,t,r]),this.hitDetectionInstructions.push([ou.CUSTOM,f,o,t,n||r])}this.endGeometry(e)}},{key:"beginGeometry",value:function(t,e){this.beginGeometryInstruction1_=[ou.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ou.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){var t,e=this.hitDetectionInstructions;e.reverse();var r,n,i=e.length,o=-1;for(t=0;t<i;++t)(n=(r=e[t])[0])==ou.END_GEOMETRY?o=t:n==ou.BEGIN_GEOMETRY&&(r[2]=t,tr(this.hitDetectionInstructions,o,t),o=-1)}},{key:"setFillStrokeStyle",value:function(t,e){var r=this.state;if(t){var n=t.getColor();r.fillStyle=Xa(n||es)}else r.fillStyle=void 0;if(e){var i=e.getColor();r.strokeStyle=Xa(i||os);var o=e.getLineCap();r.lineCap=void 0!==o?o:rs;var a=e.getLineDash();r.lineDash=a?a.slice():ns;var s=e.getLineDashOffset();r.lineDashOffset=s||0;var u=e.getLineJoin();r.lineJoin=void 0!==u?u:is;var l=e.getWidth();r.lineWidth=void 0!==l?l:1;var c=e.getMiterLimit();r.miterLimit=void 0!==c?c:10,r.lineWidth>this.maxLineWidth&&(this.maxLineWidth=r.lineWidth,this.bufferedMaxExtent_=null)}else r.strokeStyle=void 0,r.lineCap=void 0,r.lineDash=null,r.lineDashOffset=void 0,r.lineJoin=void 0,r.lineWidth=void 0,r.miterLimit=void 0}},{key:"createFill",value:function(t){var e=t.fillStyle,r=[ou.SET_FILL_STYLE,e];return"string"!=typeof e&&r.push(!0),r}},{key:"applyStroke",value:function(t){this.instructions.push(this.createStroke(t))}},{key:"createStroke",value:function(t){return[ou.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(t,e){var r=t.fillStyle;"string"==typeof r&&t.currentFillStyle==r||(void 0!==r&&this.instructions.push(e.call(this,t)),t.currentFillStyle=r)}},{key:"updateStrokeStyle",value:function(t,e){var r=t.strokeStyle,n=t.lineCap,i=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,s=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=r||t.currentLineCap!=n||i!=t.currentLineDash&&!rr(t.currentLineDash,i)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=s||t.currentMiterLimit!=u)&&(void 0!==r&&e.call(this,t),t.currentStrokeStyle=r,t.currentLineCap=n,t.currentLineDash=i,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=s,t.currentMiterLimit=u)}},{key:"endGeometry",value:function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[ou.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=_t(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;bt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}])&&lu(e.prototype,r),n&&lu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(su);function du(t){return(du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gu(){return(gu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=mu(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function mu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xu(t)););return t}function bu(t,e){return(bu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xu(t);if(e){var i=xu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wu(this,r)}}function wu(t,e){if(e&&("object"===du(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xu(t){return(xu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ku=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bu(t,e)}(o,t);var e,r,n,i=_u(o);function o(t,e,r,n){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,t,e,r,n)).hitDetectionImage_=null,a.image_=null,a.imagePixelRatio_=void 0,a.anchorX_=void 0,a.anchorY_=void 0,a.height_=void 0,a.opacity_=void 0,a.originX_=void 0,a.originY_=void 0,a.rotateWithView_=void 0,a.rotation_=void 0,a.scale_=void 0,a.width_=void 0,a.declutterImageWithText_=void 0,a}return e=o,(r=[{key:"drawPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var r=t.getFlatCoordinates(),n=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(r,n);this.instructions.push([ou.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ou.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"drawMultiPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var r=t.getFlatCoordinates(),n=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(r,n);this.instructions.push([ou.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ou.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,gu(xu(o.prototype),"finish",this).call(this)}},{key:"setImageStyle",value:function(t,e){var r=t.getAnchor(),n=t.getSize(),i=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),a=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=i,this.image_=o,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=a[0]*this.imagePixelRatio_,this.originY_=a[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterImageWithText_=e}}])&&vu(e.prototype,r),n&&vu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(yu);function Su(t){return(Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ou(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ru(){return(Ru="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Cu(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Cu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ju(t)););return t}function Pu(t,e){return(Pu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Eu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ju(t);if(e){var i=ju(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Tu(this,r)}}function Tu(t,e){if(e&&("object"===Su(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ju(t){return(ju=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pu(t,e)}(o,t);var e,r,n,i=Eu(o);function o(t,e,r,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,t,e,r,n)}return e=o,(r=[{key:"drawFlatCoordinates_",value:function(t,e,r,n){var i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,r,n,!1,!1),a=[ou.MOVE_TO_LINE_TO,i,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),r}},{key:"drawLineString",value:function(t,e){var r=this.state,n=r.strokeStyle,i=r.lineWidth;if(void 0!==n&&void 0!==i){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([ou.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ns,0],nu);var o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(ru),this.endGeometry(e)}}},{key:"drawMultiLineString",value:function(t,e){var r=this.state,n=r.strokeStyle,i=r.lineWidth;if(void 0!==n&&void 0!==i){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([ou.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],nu);for(var o=t.getEnds(),a=t.getFlatCoordinates(),s=t.getStride(),u=0,l=0,c=o.length;l<c;++l)u=this.drawFlatCoordinates_(a,u,o[l],s);this.hitDetectionInstructions.push(ru),this.endGeometry(e)}}},{key:"finish",value:function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ru),this.reverseHitDetectionInstructions(),this.state=null,Ru(ju(o.prototype),"finish",this).call(this)}},{key:"applyStroke",value:function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ru),t.lastStroke=this.coordinates.length),t.lastStroke=0,Ru(ju(o.prototype),"applyStroke",this).call(this,t),this.instructions.push(nu)}}])&&Ou(e.prototype,r),n&&Ou(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(yu);function Iu(t){return(Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Du(){return(Du="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Au(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Au(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gu(t)););return t}function Lu(t,e){return(Lu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Gu(t);if(e){var i=Gu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Bu(this,r)}}function Bu(t,e){if(e&&("object"===Iu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Gu(t){return(Gu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lu(t,e)}(o,t);var e,r,n,i=zu(o);function o(t,e,r,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,t,e,r,n)}return e=o,(r=[{key:"drawFlatCoordinatess_",value:function(t,e,r,n){var i=this.state,o=void 0!==i.fillStyle,a=void 0!==i.strokeStyle,s=r.length;this.instructions.push(nu),this.hitDetectionInstructions.push(nu);for(var u=0;u<s;++u){var l=r[u],c=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,l,n,!0,!a),h=[ou.MOVE_TO_LINE_TO,c,f];this.instructions.push(h),this.hitDetectionInstructions.push(h),a&&(this.instructions.push(iu),this.hitDetectionInstructions.push(iu)),e=l}return o&&(this.instructions.push(eu),this.hitDetectionInstructions.push(eu)),a&&(this.instructions.push(ru),this.hitDetectionInstructions.push(ru)),e}},{key:"drawCircle",value:function(t,e){var r=this.state,n=r.fillStyle,i=r.strokeStyle;if(void 0!==n||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([ou.SET_FILL_STYLE,es]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([ou.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);var u=[ou.CIRCLE,s];this.instructions.push(nu,u),this.hitDetectionInstructions.push(nu,u),void 0!==r.fillStyle&&(this.instructions.push(eu),this.hitDetectionInstructions.push(eu)),void 0!==r.strokeStyle&&(this.instructions.push(ru),this.hitDetectionInstructions.push(ru)),this.endGeometry(e)}}},{key:"drawPolygon",value:function(t,e){var r=this.state,n=r.fillStyle,i=r.strokeStyle;if(void 0!==n||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([ou.SET_FILL_STYLE,es]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([ou.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getEnds(),a=t.getOrientedFlatCoordinates(),s=t.getStride();this.drawFlatCoordinatess_(a,0,o,s),this.endGeometry(e)}}},{key:"drawMultiPolygon",value:function(t,e){var r=this.state,n=r.fillStyle,i=r.strokeStyle;if(void 0!==n||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([ou.SET_FILL_STYLE,es]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([ou.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);for(var o=t.getEndss(),a=t.getOrientedFlatCoordinates(),s=t.getStride(),u=0,l=0,c=o.length;l<c;++l)u=this.drawFlatCoordinatess_(a,u,o[l],s);this.endGeometry(e)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,r=0,n=e.length;r<n;++r)e[r]=Bn(e[r],t);return Du(Gu(o.prototype),"finish",this).call(this)}},{key:"setFillStrokeStyles_",value:function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}])&&Fu(e.prototype,r),n&&Fu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(yu),Wu="point",Xu="line";function qu(t,e,r,n,i){var o,a,s,u,l,c,f,h,p,y=r,d=r,v=0,g=0,m=r;for(o=r;o<n;o+=i){var b=e[o],_=e[o+1];void 0!==u&&(h=b-u,p=_-l,s=Math.sqrt(h*h+p*p),void 0!==c&&(g+=a,Math.acos((c*h+f*p)/(a*s))>t&&(g>v&&(v=g,y=m,d=o),g=0,m=o-i)),a=s,c=h,f=p),u=b,l=_}return(g+=s)>v?[m,o]:[y,d]}function Vu(t){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ku(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yu(){return(Yu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Zu(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Zu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qu(t)););return t}function Uu(t,e){return(Uu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Hu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Qu(t);if(e){var i=Qu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ju(this,r)}}function Ju(t,e){if(e&&("object"===Vu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Qu(t){return(Qu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $u={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};function tl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var el={Circle:Nu,Default:yu,Image:ku,LineString:Mu,Polygon:Nu,Text:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uu(t,e)}(o,t);var e,r,n,i=Hu(o);function o(t,e,r,n){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,t,e,r,n)).labels_=null,a.text_="",a.textOffsetX_=0,a.textOffsetY_=0,a.textRotateWithView_=void 0,a.textRotation_=0,a.textFillState_=null,a.fillStates={},a.textStrokeState_=null,a.strokeStates={},a.textState_={},a.textStates={},a.textKey_="",a.fillKey_="",a.strokeKey_="",a.declutterImageWithText_=void 0,a}return e=o,(r=[{key:"finish",value:function(){var t=Yu(Qu(o.prototype),"finish",this).call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}},{key:"drawText",value:function(t,e){var r=this.textFillState_,n=this.textStrokeState_,i=this.textState_;if(""!==this.text_&&i&&(r||n)){var o=this.coordinates,a=o.length,s=t.getType(),u=null,l=t.getStride();if(i.placement!==Xu||s!=Be&&s!=Xe&&s!=Ne&&s!=qe){var c=i.overflow?null:[];switch(s){case ze:case We:u=t.getFlatCoordinates();break;case Be:u=t.getFlatMidpoint();break;case Ke:u=t.getCenter();break;case Xe:u=t.getFlatMidpoints(),l=2;break;case Ne:u=t.getFlatInteriorPoint(),i.overflow||c.push(u[2]/this.resolution),l=3;break;case qe:var f=t.getFlatInteriorPoints();u=[];for(var h=0,p=f.length;h<p;h+=3)i.overflow||c.push(f[h+2]/this.resolution),u.push(f[h],f[h+1]);if(0===u.length)return;l=2}var y=this.appendFlatPointCoordinates(u,l);if(y===a)return;if(c&&(y-a)/2!=u.length/l){var d=a/2;c=c.filter((function(t,e){var r=o[2*(d+e)]===u[e*l]&&o[2*(d+e)+1]===u[e*l+1];return r||--d,r}))}this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var v=i.padding;if(v!=us&&(i.scale[0]<0||i.scale[1]<0)){var g=i.padding[0],m=i.padding[1],b=i.padding[2],_=i.padding[3];i.scale[0]<0&&(m=-m,_=-_),i.scale[1]<0&&(g=-g,b=-b),v=[g,m,b,_]}var w=this.pixelRatio;this.instructions.push([ou.DRAW_IMAGE,a,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,v==us?us:v.map((function(t){return t*w})),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]);var x=1/w;this.hitDetectionInstructions.push([ou.DRAW_IMAGE,a,y,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[x,x],NaN,this.declutterImageWithText_,v,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]),this.endGeometry(e)}else{if(!Zt(this.getBufferedMaxExtent(),t.getExtent()))return;var k;if(u=t.getFlatCoordinates(),s==Be)k=[u.length];else if(s==Xe)k=t.getEnds();else if(s==Ne)k=t.getEnds().slice(0,1);else if(s==qe){var S=t.getEndss();k=[];for(var O=0,R=S.length;O<R;++O)k.push(S[O][0])}this.beginGeometry(t,e);for(var C,P=i.textAlign,E=0,T=0,j=k.length;T<j;++T){if(null==P){var M=qu(i.maxAngle,u,E,k[T],l);E=M[0],C=M[1]}else C=k[T];for(var I=E;I<C;I+=l)o.push(u[I],u[I+1]);var F=o.length;E=k[T],this.drawChars_(a,F),a=F}this.endGeometry(e)}}}},{key:"saveTextStates_",value:function(){var t=this.textStrokeState_,e=this.textState_,r=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var i=this.textKey_;i in this.textStates||(this.textStates[i]={font:e.font,textAlign:e.textAlign||as,justify:e.justify,textBaseline:e.textBaseline||ss,scale:e.scale});var o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))}},{key:"drawChars_",value:function(t,e){var r=this.textStrokeState_,n=this.textState_,i=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();var s=this.pixelRatio,u=$u[n.textBaseline],l=this.textOffsetY_*s,c=this.text_,f=r?r.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([ou.DRAW_CHARS,t,e,u,n.overflow,a,n.maxAngle,s,l,i,f*s,c,o,1]),this.hitDetectionInstructions.push([ou.DRAW_CHARS,t,e,u,n.overflow,a,n.maxAngle,1,l,i,f,c,o,1/s])}},{key:"setTextStyle",value:function(t,e){var r,n,i;if(t){var o=t.getFill();o?((n=this.textFillState_)||(n={},this.textFillState_=n),n.fillStyle=Xa(o.getColor()||es)):(n=null,this.textFillState_=n);var s=t.getStroke();if(s){(i=this.textStrokeState_)||(i={},this.textStrokeState_=i);var u=s.getLineDash(),l=s.getLineDashOffset(),c=s.getWidth(),f=s.getMiterLimit();i.lineCap=s.getLineCap()||rs,i.lineDash=u?u.slice():ns,i.lineDashOffset=void 0===l?0:l,i.lineJoin=s.getLineJoin()||is,i.lineWidth=void 0===c?1:c,i.miterLimit=void 0===f?10:f,i.strokeStyle=Xa(s.getColor()||os)}else i=null,this.textStrokeState_=i;r=this.textState_;var h=t.getFont()||ts;ys(h);var p=t.getScaleArray();r.overflow=t.getOverflow(),r.font=h,r.maxAngle=t.getMaxAngle(),r.placement=t.getPlacement(),r.textAlign=t.getTextAlign(),r.justify=t.getJustify(),r.textBaseline=t.getTextBaseline()||ss,r.backgroundFill=t.getBackgroundFill(),r.backgroundStroke=t.getBackgroundStroke(),r.padding=t.getPadding()||us,r.scale=void 0===p?[1,1]:p;var y=t.getOffsetX(),d=t.getOffsetY(),v=t.getRotateWithView(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===y?0:y,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==v&&v,this.textRotation_=void 0===g?0:g,this.strokeKey_=i?("string"==typeof i.strokeStyle?i.strokeStyle:a(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+a(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}])&&Ku(e.prototype,r),n&&Ku(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(yu)},rl=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tolerance_=e,this.maxExtent_=r,this.pixelRatio_=i,this.resolution_=n,this.buildersByZIndex_={}}var e,r,n;return e=t,(r=[{key:"finish",value:function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var r=this.buildersByZIndex_[e];for(var n in r){var i=r[n].finish();t[e][n]=i}}return t}},{key:"getBuilder",value:function(t,e){var r=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[r];void 0===n&&(n={},this.buildersByZIndex_[r]=n);var i=n[e];return void 0===i&&(i=new(0,el[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=i),i}}])&&tl(e.prototype,r),n&&tl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),nl="Circle",il="Default",ol="Image",al="LineString",sl="Polygon",ul="Text";function ll(t,e,r,n,i,o,a,s,u,l,c,f){var h=t[e],p=t[e+1],y=0,d=0,v=0,g=0;function m(){y=h,d=p,h=t[e+=n],p=t[e+1],g+=v,v=Math.sqrt((h-y)*(h-y)+(p-d)*(p-d))}do{m()}while(e<r-n&&g+v<o);for(var b=0===v?0:(o-g)/v,w=_(y,h,b),x=_(d,p,b),k=e-n,S=g,O=o+s*u(l,i,c);e<r-n&&g+v<O;)m();var R,C=_(y,h,b=0===v?0:(O-g)/v),P=_(d,p,b);if(f){var E=[w,x,C,P];pn(E,0,4,2,f,E,E),R=E[0]>E[2]}else R=w>C;var T,j=Math.PI,M=[],I=k+n===e;if(v=0,g=S,h=t[e=k],p=t[e+1],I){m(),T=Math.atan2(p-d,h-y),R&&(T+=T>0?-j:j);var F=(C+w)/2,D=(P+x)/2;return M[0]=[F,D,(O-o)/2,T,i],M}for(var A=0,L=i.length;A<L;){m();var z=Math.atan2(p-d,h-y);if(R&&(z+=z>0?-j:j),void 0!==T){var B=z-T;if(B+=B>j?-2*j:B<-j?2*j:0,Math.abs(B)>a)return null}T=z;for(var G=A,N=0;A<L;++A){var W=s*u(l,i[R?L-A-1:A],c);if(e+n<r&&g+v<o+N+W/2)break;N+=W}if(A!==G){var X=R?i.substring(L-G,L-A):i.substring(G,A),q=_(y,h,b=0===v?0:(o+N/2-g)/v),V=_(d,p,b);M.push([q,V,N/2,z,X]),o+=N}}return M}function cl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var fl=[1/0,1/0,-1/0,-1/0],hl=[],pl=[],yl=[],dl=[];function vl(t){return t[3].declutterBox}var gl=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function ml(t,e){return"start"!==e&&"end"!==e||gl.test(t)||(e="start"===e?"left":"right"),$u[e]}function bl(t,e,r){return r>0&&t.push("\n",""),t.push(e,""),t}var _l=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.overlaps=n,this.pixelRatio=r,this.resolution=e,this.alignFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={}}var e,r,n;return e=t,(r=[{key:"createLabel",value:function(t,e,r,n){var i=t+e+r+n;if(this.labels_[i])return this.labels_[i];var o=n?this.strokeStates[n]:null,a=r?this.fillStates[r]:null,s=this.textStates[e],u=this.pixelRatio,l=[s.scale[0]*u,s.scale[1]*u],c=Array.isArray(t),f=s.justify?$u[s.justify]:ml(Array.isArray(t)?t[0]:t,s.textAlign||as),h=n&&o.lineWidth?o.lineWidth:0,p=c?t:t.split("\n").reduce(bl,[]),y=function(t,e){for(var r=[],n=[],i=[],o=0,a=0,s=0,u=0,l=0,c=e.length;l<=c;l+=2){var f=e[l];if("\n"!==f&&l!==c){var h=e[l+1]||t.font,p=gs(h,f);r.push(p),a+=p;var y=ds(h);n.push(y),u=Math.max(u,y)}else o=Math.max(o,a),i.push(a),a=0,s+=u}return{width:o,height:s,widths:r,heights:n,lineWidths:i}}(s,p),d=y.width,v=y.height,g=y.widths,m=y.heights,b=y.lineWidths,_=d+h,w=[],x=(_+2)*l[0],k=(v+h)*l[1],S={width:x<0?Math.floor(x):Math.ceil(x),height:k<0?Math.floor(k):Math.ceil(k),contextInstructions:w};1==l[0]&&1==l[1]||w.push("scale",l),n&&(w.push("strokeStyle",o.strokeStyle),w.push("lineWidth",h),w.push("lineCap",o.lineCap),w.push("lineJoin",o.lineJoin),w.push("miterLimit",o.miterLimit),($r?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(w.push("setLineDash",[o.lineDash]),w.push("lineDashOffset",o.lineDashOffset))),r&&w.push("fillStyle",a.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");for(var O,R=.5-f,C=f*_+R*h,P=[],E=[],T=0,j=0,M=0,I=0,F=0,D=p.length;F<D;F+=2){var A=p[F];if("\n"!==A){var L=p[F+1]||s.font;L!==O&&(n&&P.push("font",L),r&&E.push("font",L),O=L),T=Math.max(T,m[M]);var z=[A,C+R*g[M]+f*(g[M]-b[I]),.5*(h+T)+j];C+=g[M],n&&P.push("strokeText",z),r&&E.push("fillText",z),++M}else j+=T,T=0,C=f*_+R*h,++I}return Array.prototype.push.apply(w,P),Array.prototype.push.apply(w,E),this.labels_[i]=S,S}},{key:"replayTextBackground_",value:function(t,e,r,n,i,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,r),t.lineTo.apply(t,n),t.lineTo.apply(t,i),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}},{key:"calculateImageOrLabelDimensions_",value:function(t,e,r,n,i,o,a,s,u,l,c,f,h,p,y,d){var v,g=r-(a*=f[0]),m=n-(s*=f[1]),b=i+u>t?t-u:i,_=o+l>e?e-l:o,w=p[3]+b*f[0]+p[1],x=p[0]+_*f[1]+p[2],k=g-p[3],S=m-p[0];return(y||0!==c)&&(hl[0]=k,dl[0]=k,hl[1]=S,pl[1]=S,pl[0]=k+w,yl[0]=pl[0],yl[1]=S+x,dl[1]=yl[1]),0!==c?(sn(v=ln([1,0,0,1,0,0],r,n,1,1,c,-r,-n),hl),sn(v,pl),sn(v,yl),sn(v,dl),Ct(Math.min(hl[0],pl[0],yl[0],dl[0]),Math.min(hl[1],pl[1],yl[1],dl[1]),Math.max(hl[0],pl[0],yl[0],dl[0]),Math.max(hl[1],pl[1],yl[1],dl[1]),fl)):Ct(Math.min(k,k+w),Math.min(S,S+x),Math.max(k,k+w),Math.max(S,S+x),fl),h&&(g=Math.round(g),m=Math.round(m)),{drawImageX:g,drawImageY:m,drawImageW:b,drawImageH:_,originX:u,originY:l,declutterBox:{minX:fl[0],minY:fl[1],maxX:fl[2],maxY:fl[3],value:d},canvasTransform:v,scale:f}}},{key:"replayImageOrLabel_",value:function(t,e,r,n,i,o,a){var s=!(!o&&!a),u=n.declutterBox,l=t.canvas,c=a?a[2]*n.scale[0]/2:0;return u.minX-c<=l.width/e&&u.maxX+c>=0&&u.minY-c<=l.height/e&&u.maxY+c>=0&&(s&&this.replayTextBackground_(t,hl,pl,yl,dl,o,a),bs(t,n.canvasTransform,i,r,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}},{key:"fill_",value:function(t){if(this.alignFill_){var e=sn(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(e[0]%r,e[1]%r),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}},{key:"setStrokeStyle_",value:function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))}},{key:"drawLabelWithPointPlacement_",value:function(t,e,r,n){var i=this.textStates[e],o=this.createLabel(t,e,n,r),a=this.strokeStates[r],s=this.pixelRatio,u=ml(Array.isArray(t)?t[0]:t,i.textAlign||as),l=$u[i.textBaseline||ss],c=a&&a.lineWidth?a.lineWidth:0;return{label:o,anchorX:u*(o.width/s-2*i.scale[0])+2*(.5-u)*c,anchorY:l*o.height/s+2*(.5-l)*c}}},{key:"execute_",value:function(t,e,r,n,i,o,a,s){var u,l,c;this.pixelCoordinates_&&rr(r,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=hn(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),l=this.renderedTransform_,c=r,l[0]=c[0],l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5]);for(var f,h,p,y,d,v,g,m,b,_,w,x,k,S,O,R,C=0,P=n.length,E=0,T=0,j=0,M=null,I=null,F=this.coordinateCache_,D=this.viewRotation_,A=Math.round(1e12*Math.atan2(-r[1],r[0]))/1e12,L={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:D},z=this.instructions!=n||this.overlaps?0:200;C<P;){var B=n[C];switch(B[0]){case ou.BEGIN_GEOMETRY:k=B[1],R=B[3],k.getGeometry()?void 0===a||Zt(a,R.getExtent())?++C:C=B[2]+1:C=B[2];break;case ou.BEGIN_PATH:T>z&&(this.fill_(t),T=0),j>z&&(t.stroke(),j=0),T||j||(t.beginPath(),y=NaN,d=NaN),++C;break;case ou.CIRCLE:var G=u[E=B[1]],N=u[E+1],W=u[E+2]-G,X=u[E+3]-N,q=Math.sqrt(W*W+X*X);t.moveTo(G+q,N),t.arc(G,N,q,0,2*Math.PI,!0),++C;break;case ou.CLOSE_PATH:t.closePath(),++C;break;case ou.CUSTOM:E=B[1],f=B[2];var V=B[3],K=B[4],Y=6==B.length?B[5]:void 0;L.geometry=V,L.feature=k,C in F||(F[C]=[]);var Z=F[C];Y?Y(u,E,f,2,Z):(Z[0]=u[E],Z[1]=u[E+1],Z.length=2),K(Z,L),++C;break;case ou.DRAW_IMAGE:E=B[1],f=B[2],m=B[3],h=B[4],p=B[5];var U=B[6],H=B[7],J=B[8],Q=B[9],$=B[10],tt=B[11],et=B[12],rt=B[13],nt=B[14];if(!m&&B.length>=19){b=B[18],_=B[19],w=B[20],x=B[21];var it=this.drawLabelWithPointPlacement_(b,_,w,x);m=it.label,B[3]=m;var ot=B[22];h=(it.anchorX-ot)*this.pixelRatio,B[4]=h;var at=B[23];p=(it.anchorY-at)*this.pixelRatio,B[5]=p,U=m.height,B[6]=U,rt=m.width,B[13]=rt}var st=void 0;B.length>24&&(st=B[24]);var ut=void 0,lt=void 0,ct=void 0;B.length>16?(ut=B[15],lt=B[16],ct=B[17]):(ut=us,lt=!1,ct=!1),$&&A?tt+=D:$||A||(tt-=D);for(var ft=0;E<f;E+=2)if(!(st&&st[ft++]<rt/this.pixelRatio)){var ht=this.calculateImageOrLabelDimensions_(m.width,m.height,u[E],u[E+1],rt,U,h,p,J,Q,tt,et,i,ut,lt||ct,k),pt=[t,e,m,ht,H,lt?M:null,ct?I:null],yt=void 0,dt=void 0;if(s&&nt){var vt=f-E;if(!nt[vt]){nt[vt]=pt;continue}if(yt=nt[vt],delete nt[vt],dt=vl(yt),s.collides(dt))continue}s&&s.collides(ht.declutterBox)||(yt&&(s&&s.insert(dt),this.replayImageOrLabel_.apply(this,yt)),s&&s.insert(ht.declutterBox),this.replayImageOrLabel_.apply(this,pt))}++C;break;case ou.DRAW_CHARS:var gt=B[1],mt=B[2],bt=B[3],_t=B[4];x=B[5];var wt=B[6],xt=B[7],kt=B[8];w=B[9];var St=B[10];b=B[11],_=B[12];var Ot=[B[13],B[13]],Rt=this.textStates[_],Ct=Rt.font,Pt=[Rt.scale[0]*xt,Rt.scale[1]*xt],Et=void 0;Ct in this.widths_?Et=this.widths_[Ct]:(Et={},this.widths_[Ct]=Et);var Tt=$n(u,gt,mt,2),jt=Math.abs(Pt[0])*ms(Ct,b,Et);if(_t||jt<=Tt){var Mt=this.textStates[_].textAlign,It=ll(u,gt,mt,2,b,(Tt-jt)*$u[Mt],wt,Math.abs(Pt[0]),ms,Ct,Et,A?0:this.viewRotation_);t:if(It){var Ft=[],Dt=void 0,At=void 0,Lt=void 0,zt=void 0,Bt=void 0;if(w)for(Dt=0,At=It.length;Dt<At;++Dt){Lt=(Bt=It[Dt])[4],zt=this.createLabel(Lt,_,"",w),h=Bt[2]+(Pt[0]<0?-St:St),p=bt*zt.height+2*(.5-bt)*St*Pt[1]/Pt[0]-kt;var Gt=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Bt[0],Bt[1],zt.width,zt.height,h,p,0,0,Bt[3],Ot,!1,us,!1,k);if(s&&s.collides(Gt.declutterBox))break t;Ft.push([t,e,zt,Gt,1,null,null])}if(x)for(Dt=0,At=It.length;Dt<At;++Dt){Lt=(Bt=It[Dt])[4],zt=this.createLabel(Lt,_,x,""),h=Bt[2],p=bt*zt.height-kt;var Nt=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Bt[0],Bt[1],zt.width,zt.height,h,p,0,0,Bt[3],Ot,!1,us,!1,k);if(s&&s.collides(Nt.declutterBox))break t;Ft.push([t,e,zt,Nt,1,null,null])}s&&s.load(Ft.map(vl));for(var Wt=0,Xt=Ft.length;Wt<Xt;++Wt)this.replayImageOrLabel_.apply(this,Ft[Wt])}}++C;break;case ou.END_GEOMETRY:if(void 0!==o){var qt=o(k=B[1],R);if(qt)return qt}++C;break;case ou.FILL:z?T++:this.fill_(t),++C;break;case ou.MOVE_TO_LINE_TO:for(E=B[1],f=B[2],S=u[E],g=(O=u[E+1])+.5|0,(v=S+.5|0)===y&&g===d||(t.moveTo(S,O),y=v,d=g),E+=2;E<f;E+=2)v=(S=u[E])+.5|0,g=(O=u[E+1])+.5|0,E!=f-2&&v===y&&g===d||(t.lineTo(S,O),y=v,d=g);++C;break;case ou.SET_FILL_STYLE:M=B,this.alignFill_=B[2],T&&(this.fill_(t),T=0,j&&(t.stroke(),j=0)),t.fillStyle=B[1],++C;break;case ou.SET_STROKE_STYLE:I=B,j&&(t.stroke(),j=0),this.setStrokeStyle_(t,B),++C;break;case ou.STROKE:z?j++:t.stroke(),++C;break;default:++C}}T&&this.fill_(t),j&&t.stroke()}},{key:"execute",value:function(t,e,r,n,i,o){this.viewRotation_=n,this.execute_(t,e,r,this.instructions,i,void 0,void 0,o)}},{key:"executeHitDetection",value:function(t,e,r,n,i){return this.viewRotation_=r,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,i)}}])&&cl(e.prototype,r),n&&cl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function wl(t){return function(t){if(Array.isArray(t))return xl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return xl(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xl(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xl(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Sl=[sl,nl,al,ol,ul,il],Ol=function(){function t(e,r,n,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=n,this.resolution_=r,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(o)}var e,r,n;return e=t,(r=[{key:"clip",value:function(t,e){var r=this.getClipCoords(e);t.beginPath(),t.moveTo(r[0],r[1]),t.lineTo(r[2],r[3]),t.lineTo(r[4],r[5]),t.lineTo(r[6],r[7]),t.clip()}},{key:"createExecutors_",value:function(t){for(var e in t){var r=this.executorsByZIndex_[e];void 0===r&&(r={},this.executorsByZIndex_[e]=r);var n=t[e];for(var i in n){var o=n[i];r[i]=new _l(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}},{key:"hasExecutors",value:function(t){for(var e in this.executorsByZIndex_)for(var r=this.executorsByZIndex_[e],n=0,i=t.length;n<i;++n)if(t[n]in r)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(t,e,r,n,i,o){var a=2*(n=Math.round(n))+1,s=ln(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-r,-t[0],-t[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=qa(a,a));var l,c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):u||c.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(It(l=[1/0,1/0,-1/0,-1/0],t),bt(l,e*(this.renderBuffer_+n),l));var f,h=function(t){if(void 0!==Rl[t])return Rl[t];for(var e=2*t+1,r=t*t,n=new Array(r+1),i=0;i<=t;++i)for(var o=0;o<=t;++o){var a=i*i+o*o;if(a>r)break;var s=n[a];s||(s=[],n[a]=s),s.push(4*((t+i)*e+(t+o))+3),i>0&&s.push(4*((t-i)*e+(t+o))+3),o>0&&(s.push(4*((t+i)*e+(t-o))+3),i>0&&s.push(4*((t-i)*e+(t-o))+3))}for(var u=[],l=0,c=n.length;l<c;++l)n[l]&&u.push.apply(u,wl(n[l]));return Rl[t]=u,u}(n);function p(t,e){for(var r=c.getImageData(0,0,a,a).data,s=0,u=h.length;s<u;s++)if(r[h[s]]>0){if(!o||f!==ol&&f!==ul||-1!==o.indexOf(t)){var l=(h[s]-3)/4,p=n-l%a,y=n-(l/a|0),d=i(t,e,p*p+y*y);if(d)return d}c.clearRect(0,0,a,a);break}}var y,d,v,g,m,b=Object.keys(this.executorsByZIndex_).map(Number);for(b.sort(Qe),y=b.length-1;y>=0;--y){var _=b[y].toString();for(v=this.executorsByZIndex_[_],d=Sl.length-1;d>=0;--d)if(void 0!==(g=v[f=Sl[d]])&&(m=g.executeHitDetection(c,s,r,p,l)))return m}}},{key:"getClipCoords",value:function(t){var e=this.maxExtent_;if(!e)return null;var r=e[0],n=e[1],i=e[2],o=e[3],a=[r,n,r,o,i,o,i,n];return hn(a,0,8,2,t,a),a}},{key:"isEmpty",value:function(){return c(this.executorsByZIndex_)}},{key:"execute",value:function(t,e,r,n,i,o,a){var s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(Qe),this.maxExtent_&&(t.save(),this.clip(t,r));var u,l,c,f,h,p,y=o||Sl;for(a&&s.reverse(),u=0,l=s.length;u<l;++u){var d=s[u].toString();for(h=this.executorsByZIndex_[d],c=0,f=y.length;c<f;++c)void 0!==(p=h[y[c]])&&p.execute(t,e,r,n,i,a)}this.maxExtent_&&t.restore()}}])&&kl(e.prototype,r),n&&kl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Rl={};var Cl=Ol;function Pl(t){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function El(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tl(){return(Tl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=jl(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function jl(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Al(t)););return t}function Ml(t,e){return(Ml=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Il(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Al(t);if(e){var i=Al(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Fl(this,r)}}function Fl(t,e){if(e&&("object"===Pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Dl(t)}function Dl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Al(t){return(Al=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ll=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ml(t,e)}(a,t);var e,r,n,o=Il(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).ready=!0,e.boundHandleImageChange_=e.handleImageChange_.bind(Dl(e)),e.layer_=t,e.declutterExecutorGroup=null,e}return e=a,(r=[{key:"getFeatures",value:function(t){return i()}},{key:"getData",value:function(t){return null}},{key:"prepareFrame",value:function(t){return i()}},{key:"renderFrame",value:function(t,e){return i()}},{key:"loadedTileCallback",value:function(t,e,r){t[e]||(t[e]={}),t[e][r.tileCoord.toString()]=r}},{key:"createLoadedTileFinder",value:function(t,e,r){return function(n,i){var o=this.loadedTileCallback.bind(this,r,n);return t.forEachLoadedTile(e,n,i,o)}.bind(this)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,r,n,i){}},{key:"getDataAtPixel",value:function(t,e,r){return null}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(t){t.target.getState()===Ea&&this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(t){var e=t.getState();return e!=Ea&&e!=Ta&&t.addEventListener(pr,this.boundHandleImageChange_),e==Ca&&(t.load(),e=t.getState()),e==Ea}},{key:"renderIfReadyAndVisible",value:function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==ya&&t.changed()}},{key:"disposeInternal",value:function(){delete this.layer_,Tl(Al(a.prototype),"disposeInternal",this).call(this)}}])&&El(e.prototype,r),n&&El(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Fr);function zl(t){return(zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Gl(t,e){return(Gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Xl(t);if(e){var i=Xl(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Wl(this,r)}}function Wl(t,e){if(e&&("object"===zl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Xl(t){return(Xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ql=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gl(t,e)}(o,t);var e,r,n,i=Nl(o);function o(t,e,r,n){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,t)).inversePixelTransform=e,a.frameState=r,a.context=n,a}return e=o,r&&Bl(e.prototype,r),n&&Bl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ze);function Vl(t){return(Vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yl(){return(Yl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Zl(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Zl(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ql(t)););return t}function Ul(t,e){return(Ul=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Hl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ql(t);if(e){var i=Ql(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Jl(this,r)}}function Jl(t,e){if(e&&("object"===Vl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ql(t){return(Ql=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $l=null;var tc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ul(t,e)}(o,t);var e,r,n,i=Hl(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).container=null,e.renderedResolution,e.tempTransform=[1,0,0,1,0,0],e.pixelTransform=[1,0,0,1,0,0],e.inversePixelTransform=[1,0,0,1,0,0],e.context=null,e.containerReused=!1,e.pixelContext_=null,e.frameState=null,e}return e=o,(r=[{key:"getImageData",value:function(t,e,r){var n;$l||function(){var t=document.createElement("canvas");t.width=1,t.height=1,$l=t.getContext("2d")}(),$l.clearRect(0,0,1,1);try{$l.drawImage(t,e,r,1,1,0,0,1,1),n=$l.getImageData(0,0,1,1).data}catch(t){return $l=null,null}return n}},{key:"getBackground",value:function(t){var e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}},{key:"useContainer",value:function(t,e,r,n){var i,o,a=this.getLayer().getClassName();if(t&&t.className===a&&""===t.style.opacity&&1===r&&(!n||t&&t.style.backgroundColor&&rr(Ga(t.style.backgroundColor),Ga(n)))){var s=t.firstElementChild;s instanceof HTMLCanvasElement&&(o=s.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(i=document.createElement("div")).className=a;var u=i.style;u.position="absolute",u.width="100%",u.height="100%";var l=(o=qa()).canvas;i.appendChild(l),(u=l.style).position="absolute",u.left="0",u.transformOrigin="top left",this.container=i,this.context=o}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}},{key:"clipUnrotated",value:function(t,e,r){var n=Vt(r),i=Kt(r),o=Bt(r),a=zt(r);sn(e.coordinateToPixelTransform,n),sn(e.coordinateToPixelTransform,i),sn(e.coordinateToPixelTransform,o),sn(e.coordinateToPixelTransform,a);var s=this.inversePixelTransform;sn(s,n),sn(s,i),sn(s,o),sn(s,a),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}},{key:"dispatchRenderEvent_",value:function(t,e,r){var n=this.getLayer();if(n.hasListener(t)){var i=new ql(t,this.inversePixelTransform,r,e);n.dispatchEvent(i)}}},{key:"preRender",value:function(t,e){this.frameState=e,this.dispatchRenderEvent_(sa,t,e)}},{key:"postRender",value:function(t,e){this.dispatchRenderEvent_(ua,t,e)}},{key:"getRenderTransform",value:function(t,e,r,n,i,o,a){var s=i/2,u=o/2,l=n/e,c=-l,f=-t[0]+a,h=-t[1];return ln(this.tempTransform,s,u,l,c,-r,f,h)}},{key:"getDataAtPixel",value:function(t,e,r){var n=sn(this.inversePixelTransform,t.slice()),i=this.context,o=this.getLayer().getExtent();if(o&&!xt(o,sn(e.pixelToCoordinateTransform,t.slice())))return null;var a,s=Math.round(n[0]),u=Math.round(n[1]),l=this.pixelContext_;if(!l){var c=document.createElement("canvas");c.width=1,c.height=1,l=c.getContext("2d"),this.pixelContext_=l}l.clearRect(0,0,1,1);try{l.drawImage(i.canvas,s,u,1,1,0,0,1,1),a=l.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?(this.pixelContext_=null,new Uint8Array):a}return 0===a[3]?null:a}},{key:"disposeInternal",value:function(){delete this.frameState,Yl(Ql(o.prototype),"disposeInternal",this).call(this)}}])&&Kl(e.prototype,r),n&&Kl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Ll);function ec(t){return Math.pow(t,3)}function rc(t){return 1-ec(1-t)}function nc(t){return 3*t*t-2*t*t*t}function ic(t){return t}function oc(t){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ac(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function sc(t,e){return(sc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=cc(t);if(e){var i=cc(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return lc(this,r)}}function lc(t,e){if(e&&("object"===oc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function cc(t){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sc(t,e)}(a,t);var e,r,n,o=uc(a);function a(t,e,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var i=r||{};return(n=o.call(this)).tileCoord=t,n.state=e,n.interimTile=null,n.key="",n.transition_=void 0===i.transition?250:i.transition,n.transitionStarts_={},n.interpolate=!!i.interpolate,n}return e=a,(r=[{key:"changed",value:function(){this.dispatchEvent(pr)}},{key:"release",value:function(){}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getInterimTile",value:function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==Po)return this.transition_=0,t;t=t.interimTile}while(t);return this}},{key:"refreshInterimChain",value:function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==Po){t.interimTile=null;break}t.getState()==Co?e=t:t.getState()==Ro?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(this.state!==Eo&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){i()}},{key:"getAlpha",value:function(t,e){if(!this.transition_)return 1;var r=this.transitionStarts_[t];if(r){if(-1===r)return 1}else r=e,this.transitionStarts_[t]=r;var n=e-r+1e3/60;return n>=this.transition_?1:ec(n/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}])&&ac(e.prototype,r),n&&ac(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(hr);function hc(t,e,r){var n=t,i=!0,o=!1,a=!1,s=[Or(n,_r,(function(){a=!0,o||e()}))];return n.src&&tn?(o=!0,n.decode().then((function(){i&&e()})).catch((function(t){i&&(a?e():r())}))):s.push(Or(n,yr,r)),function(){i=!1,s.forEach(Rr)}}function pc(t){return(pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dc(t,e){return(dc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mc(t);if(e){var i=mc(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return gc(this,r)}}function gc(t,e){if(e&&("object"===pc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function mc(t){return(mc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dc(t,e)}(o,t);var e,r,n,i=vc(o);function o(t,e,r,n,a,s){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(u=i.call(this,t,e,s)).crossOrigin_=n,u.src_=r,u.key=r,u.image_=new Image,null!==n&&(u.image_.crossOrigin=n),u.unlisten_=null,u.tileLoadFunction_=a,u}return e=o,(r=[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t,this.state=Po,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){var t;this.state=Eo,this.unlistenImage_(),this.image_=((t=qa(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()}},{key:"handleImageLoad_",value:function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Po:this.state=To,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){this.state==Eo&&(this.state=Ro,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ro&&(this.state=Co,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=hc(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&yc(e.prototype,r),n&&yc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(fc);function _c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var wc,xc=function(){function t(e,r,n,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourceProj_=e,this.targetProj_=r;var s={},u=ye(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=u(t)),s[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Yt(i)==Yt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Yt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Yt(this.targetProj_.getExtent()):null;var l=Vt(n),c=Kt(n),f=Bt(n),h=zt(n),p=this.transformInv_(l),y=this.transformInv_(c),v=this.transformInv_(f),g=this.transformInv_(h),m=10+(a?Math.max(0,Math.ceil(d(Lt(n)/(a*a*256*256)))):0);if(this.addQuad_(l,c,f,h,p,y,v,g,m),this.wrapsXInSource_){var b=1/0;this.triangles_.forEach((function(t,e,r){b=Math.min(b,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-b>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-b>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-b>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-b>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var r=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-r<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}s={}}var e,r,n;return e=t,(r=[{key:"addTriangle_",value:function(t,e,r,n,i,o){this.triangles_.push({source:[n,i,o],target:[t,e,r]})}},{key:"addQuad_",value:function(t,e,r,n,i,o,a,s,u){var l=mt([i,o,a,s]),c=this.sourceWorldWidth_?Yt(l)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,h=this.sourceProj_.canWrapX()&&c>.5&&c<1,p=!1;if(u>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(p=Yt(mt([t,e,r,n]))/this.targetWorldWidth_>.25||p),!h&&this.sourceProj_.isGlobal()&&c&&(p=c>.25||p)),!(!p&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3]))||Zt(l,this.maxSourceExtent_)){var y=0;if(!(p||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(s[0])&&isFinite(s[1])))if(u>0)p=!0;else if(1!=(y=(isFinite(i[0])&&isFinite(i[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(s[0])&&isFinite(s[1])?0:1))&&2!=y&&4!=y&&8!=y)return;if(u>0){if(!p){var d,v=[(t[0]+r[0])/2,(t[1]+r[1])/2],g=this.transformInv_(v);d=h?(b(i[0],f)+b(a[0],f))/2-b(g[0],f):(i[0]+a[0])/2-g[0];var m=(i[1]+a[1])/2-g[1];p=d*d+m*m>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-r[0])<=Math.abs(t[1]-r[1])){var _=[(e[0]+r[0])/2,(e[1]+r[1])/2],w=this.transformInv_(_),x=[(n[0]+t[0])/2,(n[1]+t[1])/2],k=this.transformInv_(x);this.addQuad_(t,e,_,x,i,o,w,k,u-1),this.addQuad_(x,_,r,n,k,w,a,s,u-1)}else{var S=[(t[0]+e[0])/2,(t[1]+e[1])/2],O=this.transformInv_(S),R=[(r[0]+n[0])/2,(r[1]+n[1])/2],C=this.transformInv_(R);this.addQuad_(t,S,R,n,i,O,C,s,u-1),this.addQuad_(S,e,r,R,O,o,a,C,u-1)}return}}if(h){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&y)&&this.addTriangle_(t,r,n,i,a,s),0==(14&y)&&this.addTriangle_(t,r,e,i,a,o),y&&(0==(13&y)&&this.addTriangle_(e,n,t,o,s,i),0==(7&y)&&this.addTriangle_(e,n,r,o,s,a))}}},{key:"calculateSourceExtent",value:function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,r,n){var i=e.source;It(t,i[0]),It(t,i[1]),It(t,i[2])})),t}},{key:"getTriangles",value:function(){return this.triangles_}}])&&_c(e.prototype,r),n&&_c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),kc={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},Sc={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0};function Oc(t,e,r,n,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,r),t.lineTo(n,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(r,i)),t.restore()}function Rc(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function Cc(t,e,r,n){var i=de(r,e,t),o=ue(e,n,r),a=e.getMetersPerUnit();void 0!==a&&(o*=a);var s=t.getMetersPerUnit();void 0!==s&&(o/=s);var u=t.getExtent();if(!u||xt(u,i)){var l=ue(t,o,i)/o;isFinite(l)&&l>0&&(o/=l)}return o}function Pc(t,e,r,n,i,o,a,u,l,c,f,h){var p=qa(Math.round(r*t),Math.round(r*e));if(h||s(p,kc),0===l.length)return p.canvas;function y(t){return Math.round(t*r)/r}p.scale(r,r),p.globalCompositeOperation="lighter";var d=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,r){Mt(d,t.extent)}));var v=Yt(d),g=Xt(d),m=qa(Math.round(r*v/n),Math.round(r*g/n));h||s(m,kc);var b=r/n;l.forEach((function(t,e,r){var n=t.extent[0]-d[0],i=-(t.extent[3]-d[3]),o=Yt(t.extent),a=Xt(t.extent);t.image.width>0&&t.image.height>0&&m.drawImage(t.image,c,c,t.image.width-2*c,t.image.height-2*c,n*b,i*b,o*b,a*b)}));var _=Vt(a);return u.getTriangles().forEach((function(t,e,i){var a=t.source,s=t.target,u=a[0][0],l=a[0][1],c=a[1][0],f=a[1][1],v=a[2][0],g=a[2][1],b=y((s[0][0]-_[0])/o),w=y(-(s[0][1]-_[1])/o),x=y((s[1][0]-_[0])/o),k=y(-(s[1][1]-_[1])/o),S=y((s[2][0]-_[0])/o),O=y(-(s[2][1]-_[1])/o),R=u,C=l;u=0,l=0;var P=function(t){for(var e=t.length,r=0;r<e;r++){for(var n=r,i=Math.abs(t[r][r]),o=r+1;o<e;o++){var a=Math.abs(t[o][r]);a>i&&(i=a,n=o)}if(0===i)return null;var s=t[n];t[n]=t[r],t[r]=s;for(var u=r+1;u<e;u++)for(var l=-t[u][r]/t[r][r],c=r;c<e+1;c++)r==c?t[u][c]=0:t[u][c]+=l*t[r][c]}for(var f=new Array(e),h=e-1;h>=0;h--){f[h]=t[h][e]/t[h][h];for(var p=h-1;p>=0;p--)t[p][e]-=t[p][h]*f[h]}return f}([[c-=R,f-=C,0,0,x-b],[v-=R,g-=C,0,0,S-b],[0,0,c,f,k-w],[0,0,v,g,O-w]]);if(P){if(p.save(),p.beginPath(),function(){if(void 0===wc){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Oc(t,4,5,4,0),Oc(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;wc=Rc(e,0)||Rc(e,4)||Rc(e,8)}return wc}()||!h){p.moveTo(x,k);for(var E=b-x,T=w-k,j=0;j<4;j++)p.lineTo(x+y((j+1)*E/4),k+y(j*T/3)),3!=j&&p.lineTo(x+y((j+1)*E/4),k+y((j+1)*T/3));p.lineTo(S,O)}else p.moveTo(x,k),p.lineTo(b,w),p.lineTo(S,O);p.clip(),p.transform(P[0],P[2],P[1],P[3],b,w),p.translate(d[0]-R,d[3]-C),p.scale(n/r,-n/r),p.drawImage(m.canvas,0,0),p.restore()}})),f&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,u.getTriangles().forEach((function(t,e,r){var n=t.target,i=(n[0][0]-_[0])/o,a=-(n[0][1]-_[1])/o,s=(n[1][0]-_[0])/o,u=-(n[1][1]-_[1])/o,l=(n[2][0]-_[0])/o,c=-(n[2][1]-_[1])/o;p.beginPath(),p.moveTo(s,u),p.lineTo(i,a),p.lineTo(l,c),p.closePath(),p.stroke()})),p.restore()),p.canvas}function Ec(t){return(Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jc(t,e){return(jc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Fc(t);if(e){var i=Fc(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ic(this,r)}}function Ic(t,e){if(e&&("object"===Ec(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Fc(t){return(Fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jc(t,e)}(o,t);var e,r,n,i=Mc(o);function o(t,e,r,n,a,s,u,l,c,f,h,y){var d;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(d=i.call(this,a,Ro,{interpolate:!!y})).renderEdges_=void 0!==h&&h,d.pixelRatio_=u,d.gutter_=l,d.canvas_=null,d.sourceTileGrid_=e,d.targetTileGrid_=n,d.wrappedTileCoord_=s||a,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var v=n.getTileCoordExtent(d.wrappedTileCoord_),g=d.targetTileGrid_.getExtent(),m=d.sourceTileGrid_.getExtent(),b=g?qt(v,g):v;if(0===Lt(b))return d.state=To,Ic(d);var _=t.getExtent();_&&(m=m?qt(m,_):_);var w=n.getResolution(d.wrappedTileCoord_[0]),x=function(t,e,r,n){var i=Gt(r),o=Cc(t,e,i,n);return(!isFinite(o)||o<=0)&&At(r,(function(r){return o=Cc(t,e,r,n),isFinite(o)&&o>0})),o}(t,r,b,w);if(!isFinite(x)||x<=0)return d.state=To,Ic(d);var k=void 0!==f?f:.5;if(d.triangulation_=new xc(t,r,b,m,x*k,w),0===d.triangulation_.getTriangles().length)return d.state=To,Ic(d);d.sourceZ_=e.getZForResolution(x);var S=d.triangulation_.calculateSourceExtent();if(m&&(t.canWrapX()?(S[1]=p(S[1],m[1],m[3]),S[3]=p(S[3],m[1],m[3])):S=qt(S,m)),Lt(S)){for(var O=e.getTileRangeForExtentAndZ(S,d.sourceZ_),R=O.minX;R<=O.maxX;R++)for(var C=O.minY;C<=O.maxY;C++){var P=c(d.sourceZ_,R,C,u);P&&d.sourceTiles_.push(P)}0===d.sourceTiles_.length&&(d.state=To)}else d.state=To;return d}return e=o,(r=[{key:"getImage",value:function(){return this.canvas_}},{key:"reproject_",value:function(){var t=[];if(this.sourceTiles_.forEach(function(e,r,n){e&&e.getState()==Po&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=Eo;else{var e=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(e),n="number"==typeof r?r:r[0],i="number"==typeof r?r:r[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Pc(n,i,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,s,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=Po}this.changed()}},{key:"load",value:function(){if(this.state==Ro){this.state=Co,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,r,n){var i=e.getState();if(i==Ro||i==Co){t++;var o=Sr(e,pr,(function(r){var n=e.getState();n!=Po&&n!=Eo&&n!=To||(Rr(o),0==--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,r){t.getState()==Ro&&t.load()}))}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(Rr),this.sourcesListenerKeys_=null}}])&&Tc(e.prototype,r),n&&Tc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(fc);function Ac(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Lc=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minX=e,this.maxX=r,this.minY=n,this.maxY=i}var e,r,n;return e=t,(r=[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}])&&Ac(e.prototype,r),n&&Ac(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function zc(t,e,r,n,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=r,i.maxY=n,i):new Lc(t,e,r,n)}var Bc=Lc;function Gc(t){return(Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wc(){return(Wc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Xc(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Xc(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yc(t)););return t}function qc(t,e){return(qc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Yc(t);if(e){var i=Yc(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Kc(this,r)}}function Kc(t,e){if(e&&("object"===Gc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Yc(t){return(Yc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qc(t,e)}(o,t);var e,r,n,i=Vc(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).extentChanged=!0,e.renderedExtent_=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.newTiles_=!1,e.tmpExtent=[1/0,1/0,-1/0,-1/0],e.tmpTileRange_=new Bc(0,0,0,0),e}return e=o,(r=[{key:"isDrawableTile",value:function(t){var e=this.getLayer(),r=t.getState(),n=e.getUseInterimTilesOnError();return r==Po||r==To||r==Eo&&!n}},{key:"getTile",value:function(t,e,r,n){var i=n.pixelRatio,o=n.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(t,e,r,i,o);return s.getState()==Eo&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState(Po)),this.isDrawableTile(s)||(s=s.getInterimTile()),s}},{key:"getData",value:function(t){var e=this.frameState;if(!e)return null;var r=this.getLayer(),n=sn(e.pixelToCoordinateTransform,t.slice()),i=r.getExtent();if(i&&!xt(i,n))return null;for(var o=e.pixelRatio,a=e.viewState.projection,s=e.viewState,u=r.getRenderSource(),l=u.getTileGridForProjection(s.projection),c=u.getTilePixelRatio(e.pixelRatio),f=l.getZForResolution(s.resolution);f>=l.getMinZoom();--f){var h=l.getTileCoordForCoordAndZ(n,f),p=u.getTile(f,h[1],h[2],o,a);if(!(p instanceof bc||p instanceof Dc))return null;if(p.getState()===Po){var y=l.getOrigin(f),d=Ma(l.getTileSize(f)),v=l.getResolution(f),g=Math.floor(c*((n[0]-y[0])/v-h[1]*d[0])),m=Math.floor(c*((y[1]-n[1])/v-h[2]*d[1])),b=Math.round(c*u.getGutterForProjection(s.projection));return this.getImageData(p.getImage(),g+b,m+b)}}return null}},{key:"loadedTileCallback",value:function(t,e,r){return!!this.isDrawableTile(r)&&Wc(Yc(o.prototype),"loadedTileCallback",this).call(this,t,e,r)}},{key:"prepareFrame",value:function(t){return!!this.getLayer().getSource()}},{key:"renderFrame",value:function(t,e){var r=t.layerStatesArray[t.layerIndex],n=t.viewState,i=n.projection,o=n.resolution,u=n.center,l=n.rotation,c=t.pixelRatio,f=this.getLayer(),h=f.getSource(),p=h.getRevision(),y=h.getTileGridForProjection(i),d=y.getZForResolution(o,h.zDirection),v=y.getResolution(d),g=t.extent,m=r.extent&&Oe(r.extent,i);m&&(g=qt(g,Oe(r.extent,i)));var b=h.getTilePixelRatio(c),_=Math.round(t.size[0]*b),w=Math.round(t.size[1]*b);if(l){var x=Math.round(Math.sqrt(_*_+w*w));_=x,w=x}var k=v*_/2/b,S=v*w/2/b,O=[u[0]-k,u[1]-S,u[0]+k,u[1]+S],R=y.getTileRangeForExtentAndZ(g,d),C={};C[d]={};var P=this.createLoadedTileFinder(h,i,C),E=this.tmpExtent,T=this.tmpTileRange_;this.newTiles_=!1;for(var j=R.minX;j<=R.maxX;++j)for(var M=R.minY;M<=R.maxY;++M){var I=this.getTile(d,j,M,t);if(this.isDrawableTile(I)){var F=a(this);if(I.getState()==Po){C[d][I.tileCoord.toString()]=I;var D=I.inTransition(F);this.newTiles_||!D&&-1!==this.renderedTiles.indexOf(I)||(this.newTiles_=!0)}if(1===I.getAlpha(F,t.time))continue}var A=y.getTileCoordChildTileRange(I.tileCoord,T,E),L=!1;A&&(L=P(d+1,A)),L||y.forEachTileCoordParentTileRange(I.tileCoord,P,T,E)}var z=v/o;ln(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/b,1/b,l,-_/2,-w/2);var B=fn(this.pixelTransform);this.useContainer(e,B,r.opacity,this.getBackground(t));var G=this.context,N=G.canvas;cn(this.inversePixelTransform,this.pixelTransform),ln(this.tempTransform,_/2,w/2,z,z,0,-_/2,-w/2),N.width!=_||N.height!=w?(N.width=_,N.height=w):this.containerReused||G.clearRect(0,0,_,w),m&&this.clipUnrotated(G,t,m),h.getInterpolate()||s(G,kc),this.preRender(G,t),this.renderedTiles.length=0;var W,X,q,V=Object.keys(C).map(Number);V.sort(Qe),1!==r.opacity||this.containerReused&&!h.getOpaque(t.viewState.projection)?(W=[],X=[]):V=V.reverse();for(var K=V.length-1;K>=0;--K){var Y=V[K],Z=h.getTilePixelSize(Y,c,i),U=y.getResolution(Y)/v,H=Z[0]*U*z,J=Z[1]*U*z,Q=y.getTileCoordForCoordAndZ(Vt(O),Y),$=y.getTileCoordExtent(Q),tt=sn(this.tempTransform,[b*($[0]-O[0])/v,b*(O[3]-$[3])/v]),et=b*h.getGutterForProjection(i),rt=C[Y];for(var nt in rt){var it=rt[nt],ot=it.tileCoord,at=Q[1]-ot[1],st=Math.round(tt[0]-(at-1)*H),ut=Q[2]-ot[2],lt=Math.round(tt[1]-(ut-1)*J),ct=Math.round(tt[0]-at*H),ft=Math.round(tt[1]-ut*J),ht=st-ct,pt=lt-ft,yt=d===Y,dt=yt&&1!==it.getAlpha(a(this),t.time),vt=!1;if(!dt)if(W){q=[ct,ft,ct+ht,ft,ct+ht,ft+pt,ct,ft+pt];for(var gt=0,mt=W.length;gt<mt;++gt)if(d!==Y&&Y<X[gt]){var bt=W[gt];Zt([ct,ft,ct+ht,ft+pt],[bt[0],bt[3],bt[4],bt[7]])&&(vt||(G.save(),vt=!0),G.beginPath(),G.moveTo(q[0],q[1]),G.lineTo(q[2],q[3]),G.lineTo(q[4],q[5]),G.lineTo(q[6],q[7]),G.moveTo(bt[6],bt[7]),G.lineTo(bt[4],bt[5]),G.lineTo(bt[2],bt[3]),G.lineTo(bt[0],bt[1]),G.clip())}W.push(q),X.push(Y)}else G.clearRect(ct,ft,ht,pt);this.drawTileImage(it,t,ct,ft,ht,pt,et,yt),W&&!dt?(vt&&G.restore(),this.renderedTiles.unshift(it)):this.renderedTiles.push(it),this.updateUsedTiles(t.usedTiles,h,it)}}this.renderedRevision=p,this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!jt(this.renderedExtent_,O),this.renderedExtent_=O,this.renderedPixelRatio=c,this.renderedProjection=i,this.manageTilePyramid(t,h,y,c,i,g,d,f.getPreload()),this.scheduleExpireCache(t,h),this.postRender(G,t),r.extent&&G.restore(),s(G,Sc),B!==N.style.transform&&(N.style.transform=B);var _t=$a(r.opacity),wt=this.container;return _t!==wt.style.opacity&&(wt.style.opacity=_t),this.container}},{key:"drawTileImage",value:function(t,e,r,n,i,o,s,u){var l=this.getTileImage(t);if(l){var c=a(this),f=u?t.getAlpha(c,e.time):1,h=f!==this.context.globalAlpha;h&&(this.context.save(),this.context.globalAlpha=f),this.context.drawImage(l,s,s,l.width-2*s,l.height-2*s,r,n,i,o),h&&this.context.restore(),1!==f?e.animate=!0:u&&t.endTransition(c)}}},{key:"getImage",value:function(){var t=this.context;return t?t.canvas:null}},{key:"getTileImage",value:function(t){return t.getImage()}},{key:"scheduleExpireCache",value:function(t,e){if(e.canExpireCache()){var r=function(t,e,r){var n=a(t);n in r.usedTiles&&t.expireCache(r.viewState.projection,r.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(r)}}},{key:"updateUsedTiles",value:function(t,e,r){var n=a(e);n in t||(t[n]={}),t[n][r.getKey()]=!0}},{key:"manageTilePyramid",value:function(t,e,r,n,i,o,s,u,l){var c=a(e);c in t.wantedTiles||(t.wantedTiles[c]={});var f,h,p,y,d,v,g=t.wantedTiles[c],m=t.tileQueue,b=0;for(v=r.getMinZoom();v<=s;++v)for(h=r.getTileRangeForExtentAndZ(o,v,h),p=r.getResolution(v),y=h.minX;y<=h.maxX;++y)for(d=h.minY;d<=h.maxY;++d)s-v<=u?(++b,(f=e.getTile(v,y,d,n,i)).getState()==Ro&&(g[f.getKey()]=!0,m.isKeyQueued(f.getKey())||m.enqueue([f,c,r.getTileCoordCenter(f.tileCoord),p])),void 0!==l&&l(f)):e.useTile(v,y,d,i);e.updateCacheSize(b,i)}}])&&Nc(e.prototype,r),n&&Nc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(tc),Uc="image",Hc="hybrid",Jc="vector",Qc=0,$c=1;function tf(t){return(tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ef(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rf(t,e){return(rf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=af(t);if(e){var i=af(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return of(this,r)}}function of(t,e){if(e&&("object"===tf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function af(t){return(af=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rf(t,e)}(o,t);var e,r,n,i=nf(o);function o(t,e,r,n,a,s,u){var l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(l=i.call(this)).context_=t,l.pixelRatio_=e,l.extent_=r,l.transform_=n,l.viewRotation_=a,l.squaredTolerance_=s,l.userTransform_=u,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=[1,0,0,1,0,0],l}return e=o,(r=[{key:"drawImages_",value:function(t,e,r,n){if(this.image_){var i=hn(t,e,r,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,s=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=s*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var l=0,c=i.length;l<c;l+=2){var f=i[l]-this.imageAnchorX_,h=i[l+1]-this.imageAnchorY_;if(0!==u||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var p=f+this.imageAnchorX_,y=h+this.imageAnchorY_;ln(a,p,y,1,1,u,-p,-y),o.setTransform.apply(o,a),o.translate(p,y),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,h,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=s)}}},{key:"drawText_",value:function(t,e,r,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var i=hn(t,e,r,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<r;e+=n){var s=i[e]+this.textOffsetX_,u=i[e+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_[0]||1!=this.textScale_[1]){var l=ln(this.tmpLocalTransform_,s,u,1,1,a,-s,-u);o.setTransform.apply(o,l),o.translate(s,u),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&o.strokeText(this.text_,s,u),this.textFillState_&&o.fillText(this.text_,s,u)}}}},{key:"moveToLineTo_",value:function(t,e,r,n,i){var o=this.context_,a=hn(t,e,r,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);var s=a.length;i&&(s-=2);for(var u=2;u<s;u+=2)o.lineTo(a[u],a[u+1]);return i&&o.closePath(),r}},{key:"drawRings_",value:function(t,e,r,n){for(var i=0,o=r.length;i<o;++i)e=this.moveToLineTo_(t,e,r[i],n,!0);return e}},{key:"drawCircle",value:function(t){if(Zt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,r){var n=t.getFlatCoordinates();if(n){var i=t.getStride();return hn(n,0,n.length,i,e,r)}return null}(t,this.transform_,this.pixelCoordinates_),r=e[2]-e[0],n=e[3]-e[1],i=Math.sqrt(r*r+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],i,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}},{key:"setStyle",value:function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}},{key:"setTransform",value:function(t){this.transform_=t}},{key:"drawGeometry",value:function(t){switch(t.getType()){case ze:this.drawPoint(t);break;case Be:this.drawLineString(t);break;case Ne:this.drawPolygon(t);break;case We:this.drawMultiPoint(t);break;case Xe:this.drawMultiLineString(t);break;case qe:this.drawMultiPolygon(t);break;case Ve:this.drawGeometryCollection(t);break;case Ke:this.drawCircle(t)}}},{key:"drawFeature",value:function(t,e){var r=e.getGeometryFunction()(t);r&&Zt(this.extent_,r.getExtent())&&(this.setStyle(e),this.drawGeometry(r))}},{key:"drawGeometryCollection",value:function(t){for(var e=t.getGeometriesArray(),r=0,n=e.length;r<n;++r)this.drawGeometry(e[r])}},{key:"drawPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(e,0,e.length,r),""!==this.text_&&this.drawText_(e,0,e.length,r)}},{key:"drawMultiPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(e,0,e.length,r),""!==this.text_&&this.drawText_(e,0,e.length,r)}},{key:"drawLineString",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Zt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,r=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(r,0,r.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}}},{key:"drawMultiLineString",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(Zt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var r=this.context_,n=t.getFlatCoordinates(),i=0,o=t.getEnds(),a=t.getStride();r.beginPath();for(var s=0,u=o.length;s<u;++s)i=this.moveToLineTo_(n,i,o[s],a,!1);r.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}}},{key:"drawPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Zt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var r=t.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}}},{key:"drawMultiPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Zt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,r=t.getOrientedFlatCoordinates(),n=0,i=t.getEndss(),o=t.getStride();e.beginPath();for(var a=0,s=i.length;a<s;++a){var u=i[a];n=this.drawRings_(r,n,u,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}}},{key:"setContextFillState_",value:function(t){var e=this.context_,r=this.contextFillState_;r?r.fillStyle!=t.fillStyle&&(r.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}},{key:"setContextStrokeState_",value:function(t){var e=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=t.lineCap&&(r.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(rr(r.lineDash,t.lineDash)||e.setLineDash(r.lineDash=t.lineDash),r.lineDashOffset!=t.lineDashOffset&&(r.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),r.lineJoin!=t.lineJoin&&(r.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),r.lineWidth!=t.lineWidth&&(r.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),r.miterLimit!=t.miterLimit&&(r.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),r.strokeStyle!=t.strokeStyle&&(r.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}},{key:"setContextTextState_",value:function(t){var e=this.context_,r=this.contextTextState_,n=t.textAlign?t.textAlign:as;r?(r.font!=t.font&&(r.font=t.font,e.font=t.font),r.textAlign!=n&&(r.textAlign=n,e.textAlign=n),r.textBaseline!=t.textBaseline&&(r.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}},{key:"setFillStrokeStyle",value:function(t,e){var r=this;if(t){var n=t.getColor();this.fillState_={fillStyle:Xa(n||es)}}else this.fillState_=null;if(e){var i=e.getColor(),o=e.getLineCap(),a=e.getLineDash(),s=e.getLineDashOffset(),u=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),f=a||ns;this.strokeState_={lineCap:void 0!==o?o:rs,lineDash:1===this.pixelRatio_?f:f.map((function(t){return t*r.pixelRatio_})),lineDashOffset:(s||0)*this.pixelRatio_,lineJoin:void 0!==u?u:is,lineWidth:(void 0!==l?l:1)*this.pixelRatio_,miterLimit:void 0!==c?c:10,strokeStyle:Xa(i||os)}}else this.strokeState_=null}},{key:"setImageStyle",value:function(t){var e;if(t&&(e=t.getSize())){var r=t.getAnchor(),n=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*this.pixelRatio_,this.imageAnchorY_=r[1]*this.pixelRatio_,this.imageHeight_=e[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=e[0]*this.pixelRatio_}else this.image_=null}},{key:"setTextStyle",value:function(t){if(t){var e=t.getFill();if(e){var r=e.getColor();this.textFillState_={fillStyle:Xa(r||es)}}else this.textFillState_=null;var n=t.getStroke();if(n){var i=n.getColor(),o=n.getLineCap(),a=n.getLineDash(),s=n.getLineDashOffset(),u=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:rs,lineDash:a||ns,lineDashOffset:s||0,lineJoin:void 0!==u?u:is,lineWidth:void 0!==l?l:1,miterLimit:void 0!==c?c:10,strokeStyle:Xa(i||os)}}else this.textStrokeState_=null;var f=t.getFont(),h=t.getOffsetX(),p=t.getOffsetY(),y=t.getRotateWithView(),d=t.getRotation(),v=t.getScaleArray(),g=t.getText(),m=t.getTextAlign(),b=t.getTextBaseline();this.textState_={font:void 0!==f?f:ts,textAlign:void 0!==m?m:as,textBaseline:void 0!==b?b:ss},this.text_=void 0!==g?Array.isArray(g)?g.reduce((function(t,e,r){return t+(r%2?" ":e)}),""):g:"",this.textOffsetX_=void 0!==h?this.pixelRatio_*h:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==y&&y,this.textRotation_=void 0!==d?d:0,this.textScale_=[this.pixelRatio_*v[0],this.pixelRatio_*v[1]]}else this.text_=""}}])&&ef(e.prototype,r),n&&ef(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(su),uf="fraction",lf="pixels",cf="bottom-left",ff="bottom-right",hf="top-left",pf="top-right";function yf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var df=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}var e,r,n;return e=t,(r=[{key:"clear",value:function(){this.cache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var r=this.cache_[e];0!=(3&t++)||r.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}},{key:"get",value:function(t,e,r){var n=vf(t,e,r);return n in this.cache_?this.cache_[n]:null}},{key:"set",value:function(t,e,r,n){var i=vf(t,e,r);this.cache_[i]=n,++this.cacheSize_}},{key:"setSize",value:function(t){this.maxCacheSize_=t,this.expire()}}])&&yf(e.prototype,r),n&&yf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function vf(t,e,r){return e+":"+t+":"+(r?La(r):"null")}var gf=new df;function mf(t){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _f(t,e){return(_f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=kf(t);if(e){var i=kf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return xf(this,r)}}function xf(t,e){if(e&&("object"===mf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function kf(t){return(kf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Sf=null,Of=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_f(t,e)}(o,t);var e,r,n,i=wf(o);function o(t,e,r,n,a,s){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(u=i.call(this)).hitDetectionImage_=null,u.image_=t||new Image,null!==n&&(u.image_.crossOrigin=n),u.canvas_={},u.color_=s,u.unlisten_=null,u.imageState_=a,u.size_=r,u.src_=e,u.tainted_,u}return e=o,(r=[{key:"isTainted_",value:function(){if(void 0===this.tainted_&&this.imageState_===Ea){Sf||(Sf=qa(1,1)),Sf.drawImage(this.image_,0,0);try{Sf.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Sf=null,this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(pr)}},{key:"handleImageError_",value:function(){this.imageState_=Ta,this.unlistenImage_(),this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=Ea,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}},{key:"getImage",value:function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}},{key:"getPixelRatio",value:function(t){return this.replaceColor_(t),this.canvas_[t]?t:1}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],r=qa(t,e);r.fillRect(0,0,t,e),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){if(this.imageState_==Ca){this.imageState_=Pa;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=hc(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(t){if(this.color_&&!this.canvas_[t]&&this.imageState_===Ea){var e=document.createElement("canvas");this.canvas_[t]=e,e.width=Math.ceil(this.image_.width*t),e.height=Math.ceil(this.image_.height*t);var r=e.getContext("2d");if(r.scale(t,t),r.drawImage(this.image_,0,0),r.globalCompositeOperation="multiply","multiply"===r.globalCompositeOperation||this.isTainted_())r.fillStyle=La(this.color_),r.fillRect(0,0,e.width/t,e.height/t),r.globalCompositeOperation="destination-in",r.drawImage(this.image_,0,0);else{for(var n=r.getImageData(0,0,e.width,e.height),i=n.data,o=this.color_[0]/255,a=this.color_[1]/255,s=this.color_[2]/255,u=this.color_[3],l=0,c=i.length;l<c;l+=4)i[l]*=o,i[l+1]*=a,i[l+2]*=s,i[l+3]*=u;r.putImageData(n,0,0)}}}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&bf(e.prototype,r),n&&bf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(hr);function Rf(t){return(Rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pf(t,e){return(Pf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ef(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=jf(t);if(e){var i=jf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Tf(this,r)}}function Tf(t,e){if(e&&("object"===Rf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function jf(t){return(jf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pf(t,e)}(o,t);var e,r,n,i=Ef(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{},n=void 0!==r.opacity?r.opacity:1,s=void 0!==r.rotation?r.rotation:0,u=void 0!==r.scale?r.scale:1,l=void 0!==r.rotateWithView&&r.rotateWithView;(e=i.call(this,{opacity:n,rotation:s,scale:u,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:l})).anchor_=void 0!==r.anchor?r.anchor:[.5,.5],e.normalizedAnchor_=null,e.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:hf,e.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:uf,e.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:uf,e.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;var c=void 0!==r.img?r.img:null;e.imgSize_=r.imgSize;var f=r.src;gt(!(void 0!==f&&c),4),gt(!c||c&&e.imgSize_,5),void 0!==f&&0!==f.length||!c||(f=c.src||a(c)),gt(void 0!==f&&f.length>0,6);var h=void 0!==r.src?Ca:Ea;return e.color_=void 0!==r.color?Ga(r.color):null,e.iconImage_=function(t,e,r,n,i,o){var a=gf.get(e,n,o);return a||(a=new Of(t,e,r,n,i,o),gf.set(e,n,o,a)),a}(c,f,void 0!==e.imgSize_?e.imgSize_:null,e.crossOrigin_,h,e.color_),e.offset_=void 0!==r.offset?r.offset:[0,0],e.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:hf,e.origin_=null,e.size_=void 0!==r.size?r.size:null,e}return e=o,(r=[{key:"clone",value:function(){var t=this.getScale();return new o({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc()})}},{key:"getAnchor",value:function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if(this.anchorXUnits_==uf||this.anchorYUnits_==uf){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==uf&&(t[0]*=e[0]),this.anchorYUnits_==uf&&(t[1]*=e[1])}if(this.anchorOrigin_!=hf){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=pf&&this.anchorOrigin_!=ff||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=cf&&this.anchorOrigin_!=ff||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}var r=this.getDisplacement();return[t[0]-r[0],t[1]+r[1]]}},{key:"setAnchor",value:function(t){this.anchor_=t,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(t){return this.iconImage_.getImage(t)}},{key:"getPixelRatio",value:function(t){return this.iconImage_.getPixelRatio(t)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(){return this.iconImage_.getHitDetectionImage()}},{key:"getOrigin",value:function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=hf){var e=this.getSize(),r=this.iconImage_.getSize();if(!e||!r)return null;t=t.slice(),this.offsetOrigin_!=pf&&this.offsetOrigin_!=ff||(t[0]=r[0]-e[0]-t[0]),this.offsetOrigin_!=cf&&this.offsetOrigin_!=ff||(t[1]=r[1]-e[1]-t[1])}return this.origin_=t,this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_?this.size_:this.iconImage_.getSize()}},{key:"listenImageChange",value:function(t){this.iconImage_.addEventListener(pr,t)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(t){this.iconImage_.removeEventListener(pr,t)}}])&&Cf(e.prototype,r),n&&Cf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Fa),If=.5;function Ff(t,e,r,n,i,o,a){var s=qa(t[0]*If,t[1]*If);s.imageSmoothingEnabled=!1;for(var u=s.canvas,l=new sf(s,If,i,null,a),c=r.length,f=Math.floor(16777215/c),h={},p=1;p<=c;++p){var y=r[p-1],d=y.getStyleFunction()||n;if(n){var v=d(y,o);if(v){Array.isArray(v)||(v=[v]);for(var g="#"+("000000"+(p*f).toString(16)).slice(-6),m=0,b=v.length;m<b;++m){var _=v[m],w=_.getGeometryFunction()(y);if(w&&Zt(i,w.getExtent())){var x=_.clone(),k=x.getFill();k&&k.setColor(g);var S=x.getStroke();S&&(S.setColor(g),S.setLineDash(null)),x.setText(void 0);var O=_.getImage();if(O&&0!==O.getOpacity()){var R=O.getImageSize();if(!R)continue;var C=qa(R[0],R[1],void 0,{alpha:!1}),P=C.canvas;C.fillStyle=g,C.fillRect(0,0,P.width,P.height),x.setImage(new Mf({img:P,imgSize:R,anchor:O.getAnchor(),anchorXUnits:lf,anchorYUnits:lf,offset:O.getOrigin(),opacity:1,size:O.getSize(),scale:O.getScale(),rotation:O.getRotation(),rotateWithView:O.getRotateWithView()}))}var E=x.getZIndex()||0,T=h[E];T||(T={},h[E]=T,T[Ne]=[],T[Ke]=[],T[Be]=[],T[ze]=[]),T[w.getType().replace("Multi","")].push(w,x)}}}}}for(var j=Object.keys(h).map(Number).sort(Qe),M=0,I=j.length;M<I;++M){var F=h[j[M]];for(var D in F)for(var A=F[D],L=0,z=A.length;L<z;L+=2){l.setStyle(A[L+1]);for(var B=0,G=e.length;B<G;++B)l.setTransform(e[B]),l.drawGeometry(A[L])}}return s.getImageData(0,0,u.width,u.height)}function Df(t,e,r){var n=[];if(r){var i=Math.floor(Math.round(t[0])*If),o=Math.floor(Math.round(t[1])*If),a=4*(p(i,0,r.width-1)+p(o,0,r.height-1)*r.width),s=r.data[a],u=r.data[a+1],l=r.data[a+2]+256*(u+256*s),c=Math.floor(16777215/e.length);l&&l%c==0&&n.push(e[l/c-1])}return n}var Af={Point:function(t,e,r,n,i){var o,a=r.getImage(),s=r.getText();i&&(t=i,o=a&&s&&s.getText()?{}:void 0);if(a){if(a.getImageState()!=Ea)return;var u=t.getBuilder(r.getZIndex(),ol);u.setImageStyle(a,o),u.drawPoint(e,n)}if(s&&s.getText()){var l=t.getBuilder(r.getZIndex(),ul);l.setTextStyle(s,o),l.drawText(e,n)}},LineString:function(t,e,r,n,i){var o=r.getStroke();if(o){var a=t.getBuilder(r.getZIndex(),al);a.setFillStrokeStyle(null,o),a.drawLineString(e,n)}var s=r.getText();if(s&&s.getText()){var u=(i||t).getBuilder(r.getZIndex(),ul);u.setTextStyle(s),u.drawText(e,n)}},Polygon:function(t,e,r,n,i){var o=r.getFill(),a=r.getStroke();if(o||a){var s=t.getBuilder(r.getZIndex(),sl);s.setFillStrokeStyle(o,a),s.drawPolygon(e,n)}var u=r.getText();if(u&&u.getText()){var l=(i||t).getBuilder(r.getZIndex(),ul);l.setTextStyle(u),l.drawText(e,n)}},MultiPoint:function(t,e,r,n,i){var o,a=r.getImage(),s=r.getText();i&&(t=i,o=a&&s&&s.getText()?{}:void 0);if(a){if(a.getImageState()!=Ea)return;var u=t.getBuilder(r.getZIndex(),ol);u.setImageStyle(a,o),u.drawMultiPoint(e,n)}if(s&&s.getText()){var l=(i||t).getBuilder(r.getZIndex(),ul);l.setTextStyle(s,o),l.drawText(e,n)}},MultiLineString:function(t,e,r,n,i){var o=r.getStroke();if(o){var a=t.getBuilder(r.getZIndex(),al);a.setFillStrokeStyle(null,o),a.drawMultiLineString(e,n)}var s=r.getText();if(s&&s.getText()){var u=(i||t).getBuilder(r.getZIndex(),ul);u.setTextStyle(s),u.drawText(e,n)}},MultiPolygon:function(t,e,r,n,i){var o=r.getFill(),a=r.getStroke();if(a||o){var s=t.getBuilder(r.getZIndex(),sl);s.setFillStrokeStyle(o,a),s.drawMultiPolygon(e,n)}var u=r.getText();if(u&&u.getText()){var l=(i||t).getBuilder(r.getZIndex(),ul);l.setTextStyle(u),l.drawText(e,n)}},GeometryCollection:function(t,e,r,n,i){var o,a,s=e.getGeometriesArray();for(o=0,a=s.length;o<a;++o){(0,Af[s[o].getType()])(t,s[o],r,n,i)}},Circle:function(t,e,r,n,i){var o=r.getFill(),a=r.getStroke();if(o||a){var s=t.getBuilder(r.getZIndex(),nl);s.setFillStrokeStyle(o,a),s.drawCircle(e,n)}var u=r.getText();if(u&&u.getText()){var l=(i||t).getBuilder(r.getZIndex(),ul);l.setTextStyle(u),l.drawText(e,n)}}};function Lf(t,e){return parseInt(a(t),10)-parseInt(a(e),10)}function zf(t,e){var r=Bf(t,e);return r*r}function Bf(t,e){return.5*t/e}function Gf(t,e,r,n,i,o,a){var s=!1,u=r.getImage();if(u){var l=u.getImageState();l==Ea||l==Ta?u.unlistenImageChange(i):(l==Ca&&u.load(),l=u.getImageState(),u.listenImageChange(i),s=!0)}return function(t,e,r,n,i,o){var a=r.getGeometryFunction()(e);if(!a)return;var s=a.simplifyTransformed(n,i);if(r.getRenderer())Nf(t,s,r,e);else{(0,Af[s.getType()])(t,s,r,e,o)}}(t,e,r,n,o,a),s}function Nf(t,e,r,n){if(e.getType()!=Ve)t.getBuilder(r.getZIndex(),il).drawCustom(e,n,r.getRenderer(),r.getHitDetectionRenderer());else for(var i=e.getGeometries(),o=0,a=i.length;o<a;++o)Nf(t,i[o],r,n)}function Wf(t){return(Wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qf(){return(qf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Vf(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Vf(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hf(t)););return t}function Kf(t,e){return(Kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Hf(t);if(e){var i=Hf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Zf(this,r)}}function Zf(t,e){if(e&&("object"===Wf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Uf(t)}function Uf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hf(t){return(Hf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jf={image:[sl,nl,al,ol,ul],hybrid:[sl,al],vector:[]},Qf={hybrid:[ol,ul,il],vector:[sl,nl,al,ol,ul,il]},$f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kf(t,e)}(o,t);var e,r,n,i=Yf(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(Uf(e)),e.dirty_=!1,e.renderedLayerRevision_,e.renderedPixelToCoordinateTransform_=null,e.renderedRotation_,e.tmpTransform_=[1,0,0,1,0,0],e}return e=o,(r=[{key:"prepareTile",value:function(t,e,r){var n,i=t.getState();return i!==Po&&i!==Eo||(this.updateExecutorGroup_(t,e,r),this.tileImageNeedsRender_(t)&&(n=!0)),n}},{key:"getTile",value:function(t,e,r,n){var i=n.pixelRatio,a=n.viewState,s=a.resolution,u=a.projection,l=this.getLayer(),c=l.getSource().getTile(t,e,r,i,u),f=n.viewHints,h=!(f[Qc]||f[$c]);return!h&&c.wantedResolution||(c.wantedResolution=s),this.prepareTile(c,i,u)&&(h||Date.now()-n.time<8)&&l.getRenderMode()!==Jc&&this.renderTileImage_(c,n),qf(Hf(o.prototype),"getTile",this).call(this,t,e,r,n)}},{key:"isDrawableTile",value:function(t){var e=this.getLayer();return qf(Hf(o.prototype),"isDrawableTile",this).call(this,t)&&(e.getRenderMode()===Jc?a(e)in t.executorGroups:t.hasContext(e))}},{key:"getTileImage",value:function(t){return t.getImage(this.getLayer())}},{key:"prepareFrame",value:function(t){var e=this.getLayer().getRevision();return this.renderedLayerRevision_!=e&&(this.renderedTiles.length=0),this.renderedLayerRevision_=e,qf(Hf(o.prototype),"prepareFrame",this).call(this,t)}},{key:"updateExecutorGroup_",value:function(t,e,r){var n=this,i=this.getLayer(),o=i.getRevision(),s=i.getRenderOrder()||null,u=t.wantedResolution,l=t.getReplayState(i);if(l.dirty||l.renderedResolution!==u||l.renderedRevision!=o||l.renderedRenderOrder!=s){var c=i.getSource(),f=i.getDeclutter(),h=c.getTileGrid(),p=c.getTileGridForProjection(r).getTileCoordExtent(t.wrappedTileCoord),y=c.getSourceTiles(e,r,t),d=a(i);delete t.hitDetectionImageData[d],t.executorGroups[d]=[],f&&(t.declutterExecutorGroups[d]=[]);for(var v=function(r,o){var a=y[r];if(a.getState()!=Po)return"continue";var v=a.tileCoord,g=h.getTileCoordExtent(v),m=qt(p,g),b=bt(m,i.getRenderBuffer()*u,n.tmpExtent),_=jt(g,m)?null:b;l.dirty=!1;var w=new rl(0,b,u,e),x=f?new rl(0,m,u,e):void 0,k=zf(u,e),S=function(t){var e,r=t.getStyleFunction()||i.getStyleFunction();if(r&&(e=r(t,u)),e){var n=this.renderFeature(t,k,e,w,x);this.dirty_=this.dirty_||n,l.dirty=l.dirty||n}},O=a.getFeatures();s&&s!==l.renderedRenderOrder&&O.sort(s);for(var R=0,C=O.length;R<C;++R){var P=O[R];_&&!Zt(_,P.getGeometry().getExtent())||S.call(n,P)}var E=w.finish(),T=i.getRenderMode()!==Jc&&f&&1===y.length?null:m,j=new Cl(T,u,e,c.getOverlaps(),E,i.getRenderBuffer());if(t.executorGroups[d].push(j),x){var M=new Cl(null,u,e,c.getOverlaps(),x.finish(),i.getRenderBuffer());t.declutterExecutorGroups[d].push(M)}},g=0,m=y.length;g<m;++g)v(g);l.renderedRevision=o,l.renderedRenderOrder=s,l.renderedResolution=u}}},{key:"forEachFeatureAtCoordinate",value:function(t,e,r,n,i){var o=e.viewState.resolution,s=e.viewState.rotation;r=null==r?0:r;var u=this.getLayer(),l=u.getSource().getTileGridForProjection(e.viewState.projection),c=mt([t]);bt(c,o*r,c);for(var f,h={},p=function(t,e,r){var o=t.getId();void 0===o&&(o=a(t));var s=h[o];if(s){if(!0!==s&&r<s.distanceSq){if(0===r)return h[o]=!0,i.splice(i.lastIndexOf(s),1),n(t,u,e);s.geometry=e,s.distanceSq=r}}else{if(0===r)return h[o]=!0,n(t,u,e);i.push(h[o]={feature:t,layer:u,geometry:e,distanceSq:r,callback:n})}},y=this.renderedTiles,d=function(n,i){var h=y[n];if(!Zt(l.getTileCoordExtent(h.wrappedTileCoord),c))return"continue";var d=a(u),v=[h.executorGroups[d]],g=h.declutterExecutorGroups[d];g&&v.push(g),v.some((function(n){for(var i=n===g?e.declutterTree.all().map((function(t){return t.value})):null,a=0,u=n.length;a<u;++a){var l=n[a];if(f=l.forEachFeatureAtCoordinate(t,o,s,r,p,i))return!0}}))},v=0,g=y.length;!f&&v<g;++v)d(v);return f}},{key:"getFeatures",value:function(t){return new Promise(function(e,r){for(var n,i=this.getLayer(),o=a(i),s=i.getSource(),u=this.renderedProjection,l=u.getExtent(),c=this.renderedResolution,f=s.getTileGridForProjection(u),h=sn(this.renderedPixelToCoordinateTransform_,t.slice()),p=f.getTileCoordForCoordAndResolution(h,c),y=0,d=this.renderedTiles.length;y<d;++y)if(p.toString()===this.renderedTiles[y].tileCoord.toString()){if((n=this.renderedTiles[y]).getState()===Po){var v=f.getTileCoordExtent(n.tileCoord);s.getWrapX()&&u.canWrapX()&&!kt(l,v)&&$t(h,u);break}n=void 0}if(!n||n.loadingSourceTiles>0)e([]);else{var g=Vt(f.getTileCoordExtent(n.wrappedTileCoord)),m=[(h[0]-g[0])/c,(g[1]-h[1])/c],b=n.getSourceTiles().reduce((function(t,e){return t.concat(e.getFeatures())}),[]),_=n.hitDetectionImageData[o];if(!_&&!this.animatingOrInteracting_){var w=Ma(f.getTileSize(f.getZForResolution(c))),x=this.renderedRotation_;_=Ff(w,[this.getRenderTransform(f.getTileCoordCenter(n.wrappedTileCoord),c,0,If,w[0]*If,w[1]*If,0)],b,i.getStyleFunction(),f.getTileCoordExtent(n.wrappedTileCoord),n.getReplayState(i).renderedResolution,x),n.hitDetectionImageData[o]=_}e(Df(m,b,_))}}.bind(this))}},{key:"handleFontsChanged",value:function(){var t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()}},{key:"handleStyleImageChange_",value:function(t){this.renderIfReadyAndVisible()}},{key:"renderDeclutter",value:function(t){var e=this.context,r=e.globalAlpha;e.globalAlpha=this.getLayer().getOpacity();for(var n=t.viewHints,i=!(n[Qc]||n[$c]),o=this.renderedTiles,s=0,u=o.length;s<u;++s){var l=o[s],c=l.declutterExecutorGroups[a(this.getLayer())];if(c)for(var f=c.length-1;f>=0;--f)c[f].execute(this.context,1,this.getTileRenderTransform(l,t),t.viewState.rotation,i,void 0,t.declutterTree)}e.globalAlpha=r}},{key:"getTileRenderTransform",value:function(t,e){var r=e.pixelRatio,n=e.viewState,i=n.center,o=n.resolution,a=n.rotation,s=e.size,u=Math.round(s[0]*r),l=Math.round(s[1]*r),c=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),f=t.tileCoord,h=c.getTileCoordExtent(t.wrappedTileCoord),p=c.getTileCoordExtent(f,this.tmpExtent)[0]-h[0];return on(un(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(i,o,a,r,u,l,p))}},{key:"renderFrame",value:function(t,e){var r=t.viewHints,n=!(r[Qc]||r[$c]);qf(Hf(o.prototype),"renderFrame",this).call(this,t,e),this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;var i=this.getLayer(),s=i.getRenderMode(),u=this.context,l=u.globalAlpha;u.globalAlpha=i.getOpacity();for(var c=Qf[s],f=t.viewState,h=f.rotation,p=i.getSource(),y=p.getTileGridForProjection(f.projection).getZForResolution(f.resolution,p.zDirection),d=this.renderedTiles,v=[],g=[],m=d.length-1;m>=0;--m){var b=d[m],_=b.executorGroups[a(i)].filter((function(t){return t.hasExecutors(c)}));if(0!==_.length){for(var w=this.getTileRenderTransform(b,t),x=b.tileCoord[0],k=!1,S=_[0].getClipCoords(w),O=0,R=v.length;O<R;++O)if(y!==x&&x<g[O]){var C=v[O];Zt([S[0],S[3],S[4],S[7]],[C[0],C[3],C[4],C[7]])&&(k||(u.save(),k=!0),u.beginPath(),u.moveTo(S[0],S[1]),u.lineTo(S[2],S[3]),u.lineTo(S[4],S[5]),u.lineTo(S[6],S[7]),u.moveTo(C[6],C[7]),u.lineTo(C[4],C[5]),u.lineTo(C[2],C[3]),u.lineTo(C[0],C[1]),u.clip())}v.push(S),g.push(x);for(var P=0,E=_.length;P<E;++P)_[P].execute(u,1,w,h,n,c);k&&u.restore()}}return u.globalAlpha=l,this.container}},{key:"renderFeature",value:function(t,e,r,n,i){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var a=0,s=r.length;a<s;++a)o=Gf(n,t,r[a],e,this.boundHandleStyleImageChange_,void 0,i)||o;else o=Gf(n,t,r,e,this.boundHandleStyleImageChange_,void 0,i);return o}},{key:"tileImageNeedsRender_",value:function(t){var e=this.getLayer();if(e.getRenderMode()===Jc)return!1;var r=t.getReplayState(e),n=e.getRevision(),i=t.wantedResolution;return r.renderedTileResolution!==i||r.renderedTileRevision!==n}},{key:"renderTileImage_",value:function(t,e){var r=this.getLayer(),n=t.getReplayState(r),i=r.getRevision(),o=t.executorGroups[a(r)];n.renderedTileRevision=i;var s=t.wrappedTileCoord,u=s[0],l=r.getSource(),c=e.pixelRatio,f=e.viewState.projection,h=l.getTileGridForProjection(f),p=h.getResolution(t.tileCoord[0]),y=e.pixelRatio/t.wantedResolution*p,d=h.getResolution(u),v=t.getContext(r);c=Math.round(Math.max(c,y/c));var g=l.getTilePixelSize(u,c,f);v.canvas.width=g[0],v.canvas.height=g[1];var m=c/y;if(1!==m){var b=nn(this.tmpTransform_);un(b,m,m),v.setTransform.apply(v,b)}var _=h.getTileCoordExtent(s,this.tmpExtent),w=y/d,x=nn(this.tmpTransform_);un(x,w,-w),function(t,e,r){on(t,an(rn,1,0,0,1,e,r))}(x,-_[0],-_[3]);for(var k=0,S=o.length;k<S;++k)o[k].execute(v,m,x,0,!0,Jf[r.getRenderMode()]);n.renderedTileResolution=t.wantedResolution}}])&&Xf(e.prototype,r),n&&Xf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Zc),th="preload",eh="useInterimTilesOnError";function rh(t){return(rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ih(){return(ih="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=oh(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function oh(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lh(t)););return t}function ah(t,e){return(ah=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=lh(t);if(e){var i=lh(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uh(this,r)}}function uh(t,e){if(e&&("object"===rh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function lh(t){return(lh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ch=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ah(t,e)}(o,t);var e,r,n,i=sh(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{},n=s({},r);delete n.preload,delete n.useInterimTilesOnError,(e=i.call(this,n)).on,e.once,e.un,r.renderMode===Uc&&(console.warn('renderMode: "image" is deprecated. Option ignored.'),r.renderMode=void 0);var a=r.renderMode||Hc;return gt(a==Hc||a==Jc,28),e.renderMode_=a,e.setPreload(r.preload?r.preload:0),e.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),e.getBackground,e.setBackground,e}return e=o,(r=[{key:"createRenderer",value:function(){return new $f(this)}},{key:"getFeatures",value:function(t){return ih(lh(o.prototype),"getFeatures",this).call(this,t)}},{key:"getRenderMode",value:function(){return this.renderMode_}},{key:"getPreload",value:function(){return this.get(th)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(eh)}},{key:"setPreload",value:function(t){this.set(th,t)}},{key:"setUseInterimTilesOnError",value:function(t){this.set(eh,t)}}])&&nh(e.prototype,r),n&&nh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}($s);function fh(t){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ph(t,e){return(ph=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=vh(t);if(e){var i=vh(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return dh(this,r)}}function dh(t,e){if(e&&("object"===fh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function vh(t){return(vh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var gh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ph(t,e)}(o,t);var e,r,n,i=yh(o);function o(t,e,r,n,a,s){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(u=i.call(this,t,e,s)).extent=null,u.format_=n,u.features_=null,u.loader_,u.projection=null,u.resolution,u.tileLoadFunction_=a,u.url_=r,u.key=r,u}return e=o,(r=[{key:"getFormat",value:function(){return this.format_}},{key:"getFeatures",value:function(){return this.features_}},{key:"load",value:function(){this.state==Ro&&(this.setState(Co),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}},{key:"onLoad",value:function(t,e){this.setFeatures(t)}},{key:"onError",value:function(){this.setState(Eo)}},{key:"setFeatures",value:function(t){this.features_=t,this.setState(Po)}},{key:"setLoader",value:function(t){this.loader_=t}}])&&hh(e.prototype,r),n&&hh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(fc);function mh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return _h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _h(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wh(t,e,r,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=r,n):[t,e,r]}function xh(t,e,r){return t+"/"+e+"/"+r}function kh(t){return xh(t[0],t[1],t[2])}function Sh(t){return t.split("/").map(Number)}function Oh(t){return(Oh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ch(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ph(t,e){return(Ph=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Eh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=jh(t);if(e){var i=jh(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Th(this,r)}}function Th(t,e){if(e&&("object"===Oh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function jh(t){return(jh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ph(t,e)}(o,t);var e,r,n,i=Eh(o);function o(){return Rh(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"expireCache",value:function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}},{key:"pruneExceptNewestZ",value:function(){if(0!==this.getCount()){var t=Sh(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(kh(e.tileCoord)),e.release())}.bind(this))}}}])&&Ch(e.prototype,r),n&&Ch(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}var e,r,n;return e=t,(r=[{key:"canExpireCache",value:function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(t){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(t){return this.entries_.hasOwnProperty(t)}},{key:"forEach",value:function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer}},{key:"get",value:function(t,e){var r=this.entries_[t];return gt(void 0!==r,15),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}},{key:"remove",value:function(t){var e=this.entries_[t];return gt(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){var t,e=new Array(this.count_),r=0;for(t=this.newest_;t;t=t.older)e[r++]=t.key_;return e}},{key:"getValues",value:function(){var t,e=new Array(this.count_),r=0;for(t=this.newest_;t;t=t.older)e[r++]=t.value_;return e}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"pop",value:function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}},{key:"replace",value:function(t,e){this.get(t),this.entries_[t].value_=e}},{key:"set",value:function(t,e){gt(!(t in this.entries_),16);var r={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[t]=r,++this.count_}},{key:"setSize",value:function(t){this.highWaterMark=t}}])&&mh(e.prototype,r),n&&mh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()),Ih="tileloadstart",Fh="tileloadend",Dh="tileloaderror";function Ah(t){return(Ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zh(t,e){return(zh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Wh(t);if(e){var i=Wh(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Gh(this,r)}}function Gh(t,e){if(e&&("object"===Ah(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Nh(t)}function Nh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wh(t){return(Wh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xh(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var qh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zh(t,e)}(a,t);var e,r,n,o=Bh(a);function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).projection=se(t.projection),e.attributions_=Xh(t.attributions),e.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,e.loading=!1,e.state_=void 0!==t.state?t.state:ya,e.wrapX_=void 0!==t.wrapX&&t.wrapX,e.interpolate_=!!t.interpolate,e.viewResolver=null,e.viewRejector=null;var r=Nh(e);return e.viewPromise_=new Promise((function(t,e){r.viewResolver=t,r.viewRejector=e})),e}return e=a,(r=[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(){return i()}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=Xh(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}])&&Lh(e.prototype,r),n&&Lh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Yr),Vh=256;function Kh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Yh=[0,0,0],Zh=function(){function t(e){var r,n,i,o;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minZoom=void 0!==e.minZoom?e.minZoom:0,this.resolutions_=e.resolutions,gt((r=this.resolutions_,n=!0,i=function(t,e){return e-t}||Qe,r.every((function(t,e){if(0===e)return!0;var o=i(r[e-1],t);return!(o>0||n&&0===o)}))),17),!e.origins)for(var a=0,s=this.resolutions_.length-1;a<s;++a)if(o){if(this.resolutions_[a]/this.resolutions_[a+1]!==o){o=void 0;break}}else o=this.resolutions_[a]/this.resolutions_[a+1];this.zoomFactor_=o,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==e.origin?e.origin:null,this.origins_=null,void 0!==e.origins&&(this.origins_=e.origins,gt(this.origins_.length==this.resolutions_.length,20));var u=e.extent;void 0===u||this.origin_||this.origins_||(this.origin_=Vt(u)),gt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==e.tileSizes&&(this.tileSizes_=e.tileSizes,gt(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:256,gt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==u?u:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==e.sizes?this.fullTileRanges_=e.sizes.map((function(t,e){var r=new Bc(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(u){var n=this.getTileRangeForExtentAndZ(u,e);r.minX=Math.max(n.minX,r.minX),r.maxX=Math.min(n.maxX,r.maxX),r.minY=Math.max(n.minY,r.minY),r.maxY=Math.min(n.maxY,r.maxY)}return r}),this):u&&this.calculateTileRanges_(u)}var e,r,n;return e=t,(r=[{key:"forEachTileCoord",value:function(t,e,r){for(var n=this.getTileRangeForExtentAndZ(t,e),i=n.minX,o=n.maxX;i<=o;++i)for(var a=n.minY,s=n.maxY;a<=s;++a)r([e,i,a])}},{key:"forEachTileCoordParentTileRange",value:function(t,e,r,n){var i,o,a=null,s=t[0]-1;for(2===this.zoomFactor_?(i=t[1],o=t[2]):a=this.getTileCoordExtent(t,n);s>=this.minZoom;){if(e(s,2===this.zoomFactor_?zc(i=Math.floor(i/2),i,o=Math.floor(o/2),o,r):this.getTileRangeForExtentAndZ(a,s,r)))return!0;--s}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(t){return this.origin_?this.origin_:this.origins_[t]}},{key:"getResolution",value:function(t){return this.resolutions_[t]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(t,e,r){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],i=2*t[2];return zc(n,n+1,i,i+1,e)}var o=this.getTileCoordExtent(t,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null}},{key:"getTileRangeForTileCoordAndZ",value:function(t,e,r){if(e>this.maxZoom||e<this.minZoom)return null;var n=t[0],i=t[1],o=t[2];if(e===n)return zc(i,o,i,o,r);if(this.zoomFactor_){var a=Math.pow(this.zoomFactor_,e-n),s=Math.floor(i*a),u=Math.floor(o*a);return e<n?zc(s,s,u,u,r):zc(s,Math.floor(a*(i+1))-1,u,Math.floor(a*(o+1))-1,r)}var l=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,e,r)}},{key:"getTileRangeExtent",value:function(t,e,r){var n=this.getOrigin(t),i=this.getResolution(t),o=Ma(this.getTileSize(t),this.tmpSize_),a=n[0]+e.minX*o[0]*i,s=n[0]+(e.maxX+1)*o[0]*i;return Ct(a,n[1]+e.minY*o[1]*i,s,n[1]+(e.maxY+1)*o[1]*i,r)}},{key:"getTileRangeForExtentAndZ",value:function(t,e,r){var n=Yh;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var i=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),zc(i,n[1],o,n[2],r)}},{key:"getTileCoordCenter",value:function(t){var e=this.getOrigin(t[0]),r=this.getResolution(t[0]),n=Ma(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*r,e[1]-(t[2]+.5)*n[1]*r]}},{key:"getTileCoordExtent",value:function(t,e){var r=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=Ma(this.getTileSize(t[0]),this.tmpSize_),o=r[0]+t[1]*i[0]*n,a=r[1]-(t[2]+1)*i[1]*n;return Ct(o,a,o+i[0]*n,a+i[1]*n,e)}},{key:"getTileCoordForCoordAndResolution",value:function(t,e,r){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,r)}},{key:"getTileCoordForXYAndResolution_",value:function(t,e,r,n,i){var o=this.getZForResolution(r),a=r/this.getResolution(o),s=this.getOrigin(o),u=Ma(this.getTileSize(o),this.tmpSize_),l=a*(t-s[0])/r/u[0],c=a*(s[1]-e)/r/u[1];return n?(l=k(l,5)-1,c=k(c,5)-1):(l=x(l,5),c=x(c,5)),wh(o,l,c,i)}},{key:"getTileCoordForXYAndZ_",value:function(t,e,r,n,i){var o=this.getOrigin(r),a=this.getResolution(r),s=Ma(this.getTileSize(r),this.tmpSize_),u=(t-o[0])/a/s[0],l=(o[1]-e)/a/s[1];return n?(u=k(u,5)-1,l=k(l,5)-1):(u=x(u,5),l=x(l,5)),wh(r,u,l,i)}},{key:"getTileCoordForCoordAndZ",value:function(t,e,r){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,r)}},{key:"getTileCoordResolution",value:function(t){return this.resolutions_[t[0]]}},{key:"getTileSize",value:function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}},{key:"getFullTileRange",value:function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}},{key:"getZForResolution",value:function(t,e){return p($e(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}},{key:"calculateTileRanges_",value:function(t){for(var e=this.resolutions_.length,r=new Array(e),n=this.minZoom;n<e;++n)r[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=r}}])&&Kh(e.prototype,r),n&&Kh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Uh(t){var e=t.getDefaultTileGrid();return e||(e=Qh(t),t.setDefaultTileGrid(e)),e}function Hh(t){var e=t||{},r=e.extent||se("EPSG:3857").getExtent(),n={extent:r,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Jh(r,e.maxZoom,e.tileSize,e.maxResolution)};return new Zh(n)}function Jh(t,e,r,n){for(var i=void 0!==e?e:42,o=Xt(t),a=Yt(t),s=Ma(void 0!==r?r:256),u=n>0?n:Math.max(a/s[0],o/s[1]),l=i+1,c=new Array(l),f=0;f<l;++f)c[f]=u/Math.pow(2,f);return c}function Qh(t,e,r,n){return function(t,e,r,n){var i=void 0!==n?n:tt,o=Jh(t,e,r);return new Zh({extent:t,origin:Nt(t,i),resolutions:o,tileSize:r})}($h(t),e,r,n)}function $h(t){var r=(t=se(t)).getExtent();if(!r){var i=180*e[n.DEGREES]/t.getMetersPerUnit();r=Ct(-i,-i,i,i)}return r}function tp(t){return(tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ep(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function np(t,e,r){return e&&rp(t.prototype,e),r&&rp(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ip(){return(ip="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=op(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function op(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cp(t)););return t}function ap(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sp(t,e)}function sp(t,e){return(sp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function up(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=cp(t);if(e){var i=cp(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return lp(this,r)}}function lp(t,e){if(e&&("object"===tp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function cp(t){return(cp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fp=function(t){ap(r,t);var e=up(r);function r(t){var n;ep(this,r),(n=e.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})).on,n.once,n.un,n.opaque_=void 0!==t.opaque&&t.opaque,n.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,n.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;return n.tileGrid&&Ma(n.tileGrid.getTileSize(n.tileGrid.getMinZoom()),[256,256]),n.tileCache=new Mh(t.cacheSize||0),n.tmpSize=[0,0],n.key_=t.key||"",n.tileOptions={transition:t.transition,interpolate:t.interpolate},n.zDirection=t.zDirection?t.zDirection:0,n}return np(r,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(t,e){var r=this.getTileCacheForProjection(t);r&&r.expireCache(e)}},{key:"forEachLoadedTile",value:function(t,e,r,n){var i=this.getTileCacheForProjection(t);if(!i)return!1;for(var o,a,s,u=!0,l=r.minX;l<=r.maxX;++l)for(var c=r.minY;c<=r.maxY;++c)a=xh(e,l,c),s=!1,i.containsKey(a)&&(s=(o=i.get(a)).getState()===Po)&&(s=!1!==n(o)),s||(u=!1);return u}},{key:"getGutterForProjection",value:function(t){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(t){this.key_!==t&&(this.key_=t,this.changed())}},{key:"getOpaque",value:function(t){return this.opaque_}},{key:"getResolutions",value:function(){return this.tileGrid?this.tileGrid.getResolutions():null}},{key:"getTile",value:function(t,e,r,n,o){return i()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(t){return this.tileGrid?this.tileGrid:Uh(t)}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();return gt(null===e||he(e,t),68),this.tileCache}},{key:"getTilePixelRatio",value:function(t){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(t,e,r){var n,i,o,a=this.getTileGridForProjection(r),s=this.getTilePixelRatio(e),u=Ma(a.getTileSize(t),this.tmpSize);return 1==s?u:(n=u,i=s,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=n[0]*i+.5|0,o[1]=n[1]*i+.5|0,o)}},{key:"getTileCoordForTileUrlFunction",value:function(t,e){var r=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(t=function(t,e,r){var n=e[0],i=t.getTileCoordCenter(e),o=$h(r);if(xt(o,i))return e;var a=Yt(o),s=Math.ceil((o[0]-i[0])/a);return i[0]+=a*s,t.getTileCoordForCoordAndZ(i,n)}(n,t,r)),function(t,e){var r=t[0],n=t[1],i=t[2];if(e.getMinZoom()>r||r>e.getMaxZoom())return!1;var o=e.getFullTileRange(r);return!o||o.containsXY(n,i)}(t,n)?t:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),ip(cp(r.prototype),"refresh",this).call(this)}},{key:"updateCacheSize",value:function(t,e){var r=this.getTileCacheForProjection(e);t>r.highWaterMark&&(r.highWaterMark=t)}},{key:"useTile",value:function(t,e,r,n){}}]),r}(qh),hp=function(t){ap(r,t);var e=up(r);function r(t,n){var i;return ep(this,r),(i=e.call(this,t)).tile=n,i}return np(r)}(Ze);function pp(t,e){var r=/\{z\}/g,n=/\{x\}/g,i=/\{y\}/g,o=/\{-y\}/g;return function(a,s,u){return a?t.replace(r,a[0].toString()).replace(n,a[1].toString()).replace(i,a[2].toString()).replace(o,(function(){var t=a[0],r=e.getFullTileRange(t);return gt(r,55),(r.getHeight()-a[2]-1).toString()})):void 0}}function yp(t,e){for(var r=t.length,n=new Array(r),i=0;i<r;++i)n[i]=pp(t[i],e);return function(t){if(1===t.length)return t[0];return function(e,r,n){if(e){var i=b(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[i](e,r,n)}}}(n)}function dp(t){return(dp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gp(t,e){return(gp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=_p(t);if(e){var i=_p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return bp(this,r)}}function bp(t,e){if(e&&("object"===dp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _p(t){return(_p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gp(t,e)}(o,t);var e,r,n,i=mp(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).generateTileUrlFunction_=e.tileUrlFunction===o.prototype.tileUrlFunction,e.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(e.tileUrlFunction=t.tileUrlFunction),e.urls=null,t.urls?e.setUrls(t.urls):t.url&&e.setUrl(t.url),e.tileLoadingKeys_={},e}return e=o,(r=[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(t){var e,r=t.target,n=a(r),i=r.getState();i==Co?(this.tileLoadingKeys_[n]=!0,e=Ih):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=i==Eo?Dh:i==Po?Fh:void 0),null!=e&&this.dispatchEvent(new hp(e,r))}},{key:"setTileLoadFunction",value:function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}},{key:"setTileUrlFunction",value:function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}},{key:"setUrl",value:function(t){var e=function(t){var e=[],r=/\{([a-z])-([a-z])\}/.exec(t);if(r){var n,i=r[1].charCodeAt(0),o=r[2].charCodeAt(0);for(n=i;n<=o;++n)e.push(t.replace(r[0],String.fromCharCode(n)));return e}if(r=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(r[2],10),s=parseInt(r[1],10);s<=a;s++)e.push(t.replace(r[0],s.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}},{key:"setUrls",value:function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(yp(t,this.tileGrid),e):this.setKey(e)}},{key:"tileUrlFunction",value:function(t,e,r){}},{key:"useTile",value:function(t,e,r){var n=xh(t,e,r);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}])&&vp(e.prototype,r),n&&vp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(fp);function xp(t){return(xp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sp(){return(Sp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Op(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Op(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tp(t)););return t}function Rp(t,e){return(Rp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Tp(t);if(e){var i=Tp(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Pp(this,r)}}function Pp(t,e){if(e&&("object"===xp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ep(t)}function Ep(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tp(t){return(Tp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jp=[],Mp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rp(t,e)}(o,t);var e,r,n,i=Cp(o);function o(t,e,r,n){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,t,e,{transition:0})).context_={},a.executorGroups={},a.declutterExecutorGroups={},a.loadingSourceTiles=0,a.hitDetectionImageData={},a.replayState_={},a.sourceTiles=[],a.errorTileKeys={},a.wantedResolution,a.getSourceTiles=n.bind(void 0,Ep(a)),a.wrappedTileCoord=r,a}return e=o,(r=[{key:"getContext",value:function(t){var e=a(t);return e in this.context_||(this.context_[e]=qa(1,1,jp)),this.context_[e]}},{key:"hasContext",value:function(t){return a(t)in this.context_}},{key:"getImage",value:function(t){return this.hasContext(t)?this.getContext(t).canvas:null}},{key:"getReplayState",value:function(t){var e=a(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}},{key:"load",value:function(){this.getSourceTiles()}},{key:"release",value:function(){for(var t in this.context_)jp.push(this.context_[t].canvas),delete this.context_[t];Sp(Tp(o.prototype),"release",this).call(this)}}])&&kp(e.prototype,r),n&&kp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(fc),Ip=!1;function Fp(t,e,r,n,i,o,a){var s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(r,n,i):t,!0),e.getType()==Te&&(s.responseType="arraybuffer"),s.withCredentials=Ip,s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var n,u=e.getType();u==je||u==Me?n=s.responseText:u==Ie?(n=s.responseXML)||(n=(new DOMParser).parseFromString(s.responseText,"application/xml")):u==Te&&(n=s.response),n?o(e.readFeatures(n,{extent:r,featureProjection:i}),e.readProjection(n)):a()}else a()},s.onerror=a,s.send()}function Dp(t,e){return function(r,n,i,o,a){var s=this;Fp(t,e,r,n,i,(function(t,e){s.addFeatures(t),void 0!==o&&o(t)}),a||or)}}function Ap(t){return(Ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zp(){return(zp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Bp(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Bp(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xp(t)););return t}function Gp(t,e){return(Gp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Np(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Xp(t);if(e){var i=Xp(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Wp(this,r)}}function Wp(t,e){if(e&&("object"===Ap(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Xp(t){return(Xp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gp(t,e)}(o,t);var e,r,n,i=Np(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t.projection||"EPSG:3857",n=t.extent||$h(r),a=t.tileGrid||Hh({extent:n,maxResolution:t.maxResolution,maxZoom:void 0!==t.maxZoom?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});return(e=i.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,opaque:!1,projection:r,state:t.state,tileGrid:a,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Vp,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:void 0===t.zDirection?1:t.zDirection})).format_=t.format?t.format:null,e.sourceTileCache=new Mh(e.tileCache.highWaterMark),e.overlaps_=null==t.overlaps||t.overlaps,e.tileClass=t.tileClass?t.tileClass:gh,e.tileGrids_={},e}return e=o,(r=[{key:"getFeaturesInExtent",value:function(t){var e=[],r=this.tileCache;if(0===r.getCount())return e;var n=Sh(r.peekFirstKey())[0],i=this.tileGrid;return r.forEach((function(r){if(r.tileCoord[0]===n&&r.getState()===Po)for(var o=r.getSourceTiles(),a=0,s=o.length;a<s;++a){var u=o[a],l=u.tileCoord;if(Zt(t,i.getTileCoordExtent(l))){var c=u.getFeatures();if(c)for(var f=0,h=c.length;f<h;++f){var p=c[f],y=p.getGeometry();Zt(t,y.getExtent())&&e.push(p)}}}})),e}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"clear",value:function(){this.tileCache.clear(),this.sourceTileCache.clear()}},{key:"expireCache",value:function(t,e){var r=this.getTileCacheForProjection(t),n=Object.keys(e).reduce((function(t,e){var n,i,o=xh((i=bh((n=e).substring(n.lastIndexOf("/")+1,n.length).split(",").map(Number),3))[0],i[1],i[2]);if(r.containsKey(o))for(var a=r.get(o).sourceTiles,s=0,u=a.length;s<u;++s)t[a[s].getKey()]=!0;return t}),{});zp(Xp(o.prototype),"expireCache",this).call(this,t,e),this.sourceTileCache.expireCache(n)}},{key:"getSourceTiles",value:function(t,e,r){var n=this;if(r.getState()===Ro){r.setState(Co);var i=r.wrappedTileCoord,o=this.getTileGridForProjection(e),a=o.getTileCoordExtent(i),s=i[0],u=o.getResolution(s);bt(a,-u,a);var l=this.tileGrid,f=l.getExtent();f&&qt(a,f,a);var h=l.getZForResolution(u,1);l.forEachTileCoord(a,h,(function(i){var o=n.tileUrlFunction(i,t,e),a=n.sourceTileCache.containsKey(o)?n.sourceTileCache.get(o):new n.tileClass(i,o?Ro:To,o,n.format_,n.tileLoadFunction);r.sourceTiles.push(a);var s=a.getState();s<Po&&(a.addEventListener(pr,(function t(e){n.handleTileChange(e);var i=a.getState();if(i===Po||i===Eo){var o=a.getKey();o in r.errorTileKeys?a.getState()===Po&&delete r.errorTileKeys[o]:r.loadingSourceTiles--,i===Eo?r.errorTileKeys[o]=!0:a.removeEventListener(pr,t),0===r.loadingSourceTiles&&r.setState(c(r.errorTileKeys)?Po:Eo)}})),r.loadingSourceTiles++),s===Ro&&(a.extent=l.getTileCoordExtent(i),a.projection=e,a.resolution=l.getResolution(i[0]),n.sourceTileCache.set(o,a),a.load())})),r.loadingSourceTiles||r.setState(r.sourceTiles.some((function(t){return t.getState()===Eo}))?Eo:Po)}return r.sourceTiles}},{key:"getTile",value:function(t,e,r,n,i){var o,a=xh(t,e,r),s=this.getKey();if(this.tileCache.containsKey(a)&&(o=this.tileCache.get(a)).key===s)return o;var u=[t,e,r],l=this.getTileCoordForTileUrlFunction(u,i),c=this.getTileGrid().getExtent(),f=this.getTileGridForProjection(i);if(l&&c){var h=f.getTileCoordExtent(l);bt(h,-f.getResolution(t),h),Zt(c,h)||(l=null)}var p=!0;if(null!==l){var y=this.tileGrid,d=f.getResolution(t),v=y.getZForResolution(d,1),g=f.getTileCoordExtent(l);bt(g,-d,g),y.forEachTileCoord(g,v,function(t){p=p&&!this.tileUrlFunction(t,n,i)}.bind(this))}var m=new Mp(u,p?To:Ro,l,this.getSourceTiles.bind(this,n,i));return m.key=s,o?(m.interimTile=o,m.refreshInterimChain(),this.tileCache.replace(a,m)):this.tileCache.set(a,m),m}},{key:"getTileGridForProjection",value:function(t){var e=t.getCode(),r=this.tileGrids_[e];if(!r){var n=this.tileGrid;r=Qh(t,void 0,n?n.getTileSize(n.getMinZoom()):void 0),this.tileGrids_[e]=r}return r}},{key:"getTilePixelRatio",value:function(t){return t}},{key:"getTilePixelSize",value:function(t,e,r){var n=Ma(this.getTileGridForProjection(r).getTileSize(t),this.tmpSize);return[Math.round(n[0]*e),Math.round(n[1]*e)]}},{key:"updateCacheSize",value:function(t,e){zp(Xp(o.prototype),"updateCacheSize",this).call(this,2*t,e),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(e).highWaterMark}}])&&Lp(e.prototype,r),n&&Lp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(wp);function Vp(t,e){t.setLoader((function(r,n,i){Fp(e,t.getFormat(),r,n,i,t.onLoad.bind(t),t.onError.bind(t))}))}var Kp=r(20);function Yp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Zp=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e||{};this.font_=r.font,this.rotation_=r.rotation,this.rotateWithView_=r.rotateWithView,this.scale_=r.scale,this.scaleArray_=Ma(void 0!==r.scale?r.scale:1),this.text_=r.text,this.textAlign_=r.textAlign,this.justify_=r.justify,this.textBaseline_=r.textBaseline,this.fill_=void 0!==r.fill?r.fill:new Fs({color:"#333"}),this.maxAngle_=void 0!==r.maxAngle?r.maxAngle:Math.PI/4,this.placement_=void 0!==r.placement?r.placement:Wu,this.overflow_=!!r.overflow,this.stroke_=void 0!==r.stroke?r.stroke:null,this.offsetX_=void 0!==r.offsetX?r.offsetX:0,this.offsetY_=void 0!==r.offsetY?r.offsetY:0,this.backgroundFill_=r.backgroundFill?r.backgroundFill:null,this.backgroundStroke_=r.backgroundStroke?r.backgroundStroke:null,this.padding_=void 0===r.padding?null:r.padding}var e,r,n;return e=t,(r=[{key:"clone",value:function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}},{key:"getOverflow",value:function(){return this.overflow_}},{key:"getFont",value:function(){return this.font_}},{key:"getMaxAngle",value:function(){return this.maxAngle_}},{key:"getPlacement",value:function(){return this.placement_}},{key:"getOffsetX",value:function(){return this.offsetX_}},{key:"getOffsetY",value:function(){return this.offsetY_}},{key:"getFill",value:function(){return this.fill_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getText",value:function(){return this.text_}},{key:"getTextAlign",value:function(){return this.textAlign_}},{key:"getJustify",value:function(){return this.justify_}},{key:"getTextBaseline",value:function(){return this.textBaseline_}},{key:"getBackgroundFill",value:function(){return this.backgroundFill_}},{key:"getBackgroundStroke",value:function(){return this.backgroundStroke_}},{key:"getPadding",value:function(){return this.padding_}},{key:"setOverflow",value:function(t){this.overflow_=t}},{key:"setFont",value:function(t){this.font_=t}},{key:"setMaxAngle",value:function(t){this.maxAngle_=t}},{key:"setOffsetX",value:function(t){this.offsetX_=t}},{key:"setOffsetY",value:function(t){this.offsetY_=t}},{key:"setPlacement",value:function(t){this.placement_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setFill",value:function(t){this.fill_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=Ma(void 0!==t?t:1)}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"setText",value:function(t){this.text_=t}},{key:"setTextAlign",value:function(t){this.textAlign_=t}},{key:"setJustify",value:function(t){this.justify_=t}},{key:"setTextBaseline",value:function(t){this.textBaseline_=t}},{key:"setBackgroundFill",value:function(t){this.backgroundFill_=t}},{key:"setBackgroundStroke",value:function(t){this.backgroundStroke_=t}},{key:"setPadding",value:function(t){this.padding_=t}}])&&Yp(e.prototype,r),n&&Yp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Up(t){return(Up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jp(t,e){return(Jp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ty(t);if(e){var i=ty(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $p(this,r)}}function $p(t,e){if(e&&("object"===Up(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ty(t){return(ty=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ey=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jp(t,e)}(o,t);var e,r,n,i=Qp(o);function o(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).on,e.once,e.un,e.id_=void 0,e.geometryName_="geometry",e.style_=null,e.styleFunction_=void 0,e.geometryChangeKey_=null,e.addChangeListener(e.geometryName_,e.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){var r=t;e.setGeometry(r)}else{var n=t;e.setProperties(n)}return e}return e=o,(r=[{key:"clone",value:function(){var t=new o(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var e=this.getGeometry();e&&t.setGeometry(e.clone());var r=this.getStyle();return r&&t.setStyle(r),t}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&(Rr(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Sr(t,pr,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(t){this.set(this.geometryName_,t)}},{key:"setStyle",value:function(t){var e,r;this.style_=t,this.styleFunction_=t?"function"==typeof(e=t)?e:(Array.isArray(e)?r=e:(gt("function"==typeof e.getZIndex,41),r=[e]),function(){return r}):void 0,this.changed()}},{key:"setId",value:function(t){this.id_=t,this.changed()}},{key:"setGeometryName",value:function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}])&&Hp(e.prototype,r),n&&Hp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Yr);function ry(t){return(ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ny(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function iy(){return(iy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=oy(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function oy(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ly(t)););return t}function ay(t,e){return(ay=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ly(t);if(e){var i=ly(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uy(this,r)}}function uy(t,e){if(e&&("object"===ry(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ly(t){return(ly=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cy(t){for(var e=[],r=0,n=t.length;r<n;++r)e.push(t[r].clone());return e}var fy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ay(t,e)}(o,t);var e,r,n,i=sy(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).geometries_=t||null,e.changeEventsKeys_=[],e.listenGeometriesChange_(),e}return e=o,(r=[{key:"unlistenGeometriesChange_",value:function(){this.changeEventsKeys_.forEach(Rr),this.changeEventsKeys_.length=0}},{key:"listenGeometriesChange_",value:function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(Sr(this.geometries_[t],pr,this.changed,this))}},{key:"clone",value:function(){var t=new o(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,r,n){if(n<wt(this.getExtent(),t,e))return n;for(var i=this.geometries_,o=0,a=i.length;o<a;++o)n=i[o].closestPointXY(t,e,r,n);return n}},{key:"containsXY",value:function(t,e){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)if(r[n].containsXY(t,e))return!0;return!1}},{key:"computeExtent",value:function(t){Pt(t);for(var e=this.geometries_,r=0,n=e.length;r<n;++r)Mt(t,e[r].getExtent());return t}},{key:"getGeometries",value:function(){return cy(this.geometries_)}},{key:"getGeometriesArray",value:function(){return this.geometries_}},{key:"getGeometriesArrayRecursive",value:function(){for(var t=[],e=this.geometries_,r=0,n=e.length;r<n;++r)e[r].getType()===this.getType()?t=t.concat(e[r].getGeometriesArrayRecursive()):t.push(e[r]);return t}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var e=[],r=this.geometries_,n=!1,i=0,a=r.length;i<a;++i){var s=r[i],u=s.getSimplifiedGeometry(t);e.push(u),u!==s&&(n=!0)}if(n){var l=new o(null);return l.setGeometriesArray(e),l}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}},{key:"getType",value:function(){return Ve}},{key:"intersectsExtent",value:function(t){for(var e=this.geometries_,r=0,n=e.length;r<n;++r)if(e[r].intersectsExtent(t))return!0;return!1}},{key:"isEmpty",value:function(){return 0===this.geometries_.length}},{key:"rotate",value:function(t,e){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)r[n].rotate(t,e);this.changed()}},{key:"scale",value:function(t,e,r){var n=r;n||(n=Gt(this.getExtent()));for(var i=this.geometries_,o=0,a=i.length;o<a;++o)i[o].scale(t,e,n);this.changed()}},{key:"setGeometries",value:function(t){this.setGeometriesArray(cy(t))}},{key:"setGeometriesArray",value:function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}},{key:"applyTransform",value:function(t){for(var e=this.geometries_,r=0,n=e.length;r<n;++r)e[r].applyTransform(t);this.changed()}},{key:"translate",value:function(t,e){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)r[n].translate(t,e);this.changed()}},{key:"disposeInternal",value:function(){this.unlistenGeometriesChange_(),iy(ly(o.prototype),"disposeInternal",this).call(this)}}])&&ny(e.prototype,r),n&&ny(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(wn);function hy(t){return(hy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function py(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yy(t,e){return(yy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=gy(t);if(e){var i=gy(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return vy(this,r)}}function vy(t,e){if(e&&("object"===hy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function gy(t){return(gy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function my(t){if("string"==typeof t){var e=JSON.parse(t);return e||null}return null!==t?t:null}function by(t){return(by="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wy(t,e){return(wy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Sy(t);if(e){var i=Sy(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ky(this,r)}}function ky(t,e){if(e&&("object"===by(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Sy(t){return(Sy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oy(t,e){if(!t)return null;var r;switch(t.type){case ze:r=function(t){return new _i(t.coordinates)}(t);break;case Be:r=function(t){return new ai(t.coordinates)}(t);break;case Ne:r=function(t){return new Ji(t.coordinates)}(t);break;case We:r=function(t){return new Ci(t.coordinates)}(t);break;case Xe:r=function(t){return new pi(t.coordinates)}(t);break;case qe:r=function(t){return new ao(t.coordinates)}(t);break;case Ve:r=function(t,e){var r=t.geometries.map((function(t){return Oy(t,e)}));return new fy(r)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return Ee(r,!1,e)}function Ry(t,e){var r,n=(t=Ee(t,!0,e)).getType();switch(n){case ze:r=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case Be:r=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case Ne:r=function(t,e){var r;e&&(r=e.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(r)}}(t,e);break;case We:r=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case Xe:r=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case qe:r=function(t,e){var r;e&&(r=e.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(r)}}(t,e);break;case Ve:r=function(t,e){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){var r=s({},e);return delete r.featureProjection,Ry(t,r)}))}}(t,e);break;case Ke:r={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return r}var Cy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wy(t,e)}(o,t);var e,r,n,i=xy(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};return(e=i.call(this)).dataProjection=se(r.dataProjection?r.dataProjection:"EPSG:4326"),r.featureProjection&&(e.defaultFeatureProjection=se(r.featureProjection)),e.geometryName_=r.geometryName,e.extractGeometryName_=r.extractGeometryName,e.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],e}return e=o,(r=[{key:"readFeatureFromObject",value:function(t,e){var r=null,n=Oy((r="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),i=new ey;return this.geometryName_?i.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in r!==void 0&&i.setGeometryName(r.geometry_name),i.setGeometry(n),"id"in r&&i.setId(r.id),r.properties&&i.setProperties(r.properties,!0),i}},{key:"readFeaturesFromObject",value:function(t,e){var r=null;if("FeatureCollection"===t.type){r=[];for(var n=t.features,i=0,o=n.length;i<o;++i)r.push(this.readFeatureFromObject(n[i],e))}else r=[this.readFeatureFromObject(t,e)];return r}},{key:"readGeometryFromObject",value:function(t,e){return Oy(t,e)}},{key:"readProjectionFromObject",value:function(t){var e,r=t.crs;return r?"name"==r.type?e=se(r.properties.name):"EPSG"===r.type?e=se("EPSG:"+r.properties.code):gt(!1,36):e=this.dataProjection,e}},{key:"writeFeatureObject",value:function(t,e){e=this.adaptOptions(e);var r={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(r.id=n),!t.hasProperties())return r;var i=t.getProperties(),o=t.getGeometry();return o&&(r.geometry=Ry(o,e),delete i[t.getGeometryName()]),c(i)||(r.properties=i),r}},{key:"writeFeaturesObject",value:function(t,e){e=this.adaptOptions(e);for(var r=[],n=0,i=t.length;n<i;++n)r.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:r}}},{key:"writeGeometryObject",value:function(t,e){return Ry(t,this.adaptOptions(e))}}])&&_y(e.prototype,r),n&&_y(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yy(t,e)}(a,t);var e,r,n,o=dy(a);function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this)}return e=a,(r=[{key:"getType",value:function(){return je}},{key:"readFeature",value:function(t,e){return this.readFeatureFromObject(my(t),this.getReadOptions(t,e))}},{key:"readFeatures",value:function(t,e){return this.readFeaturesFromObject(my(t),this.getReadOptions(t,e))}},{key:"readFeatureFromObject",value:function(t,e){return i()}},{key:"readFeaturesFromObject",value:function(t,e){return i()}},{key:"readGeometry",value:function(t,e){return this.readGeometryFromObject(my(t),this.getReadOptions(t,e))}},{key:"readGeometryFromObject",value:function(t,e){return i()}},{key:"readProjection",value:function(t){return this.readProjectionFromObject(my(t))}},{key:"readProjectionFromObject",value:function(t){return i()}},{key:"writeFeature",value:function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}},{key:"writeFeatureObject",value:function(t,e){return i()}},{key:"writeFeatures",value:function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}},{key:"writeFeaturesObject",value:function(t,e){return i()}},{key:"writeGeometry",value:function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}},{key:"writeGeometryObject",value:function(t,e){return i()}}])&&py(e.prototype,r),n&&py(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Pe));function Py(t){return(Py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ey(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ty(t,e){return(Ty=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Iy(t);if(e){var i=Iy(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return My(this,r)}}function My(t,e){if(e&&("object"===Py(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Iy(t){return(Iy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fy(t,e){gf.expire()}function Dy(t){return(Dy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ay(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ly(){return(Ly="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=zy(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function zy(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Wy(t)););return t}function By(t,e){return(By=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Wy(t);if(e){var i=Wy(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ny(this,r)}}function Ny(t,e){if(e&&("object"===Dy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Wy(t){return(Wy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&By(t,e)}(o,t);var e,r,n,i=Gy(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).fontChangeListenerKey_=Sr(ls,Ue,t.redrawText.bind(t)),e.element_=document.createElement("div");var r=e.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",e.element_.className="ol-unselectable ol-layers";var n=t.getViewport();return n.insertBefore(e.element_,n.firstChild||null),e.children_=[],e.renderedVisible_=!0,e}return e=o,(r=[{key:"dispatchRenderEvent",value:function(t,e){var r=this.getMap();if(r.hasListener(t)){var n=new ql(t,void 0,e);r.dispatchEvent(n)}}},{key:"disposeInternal",value:function(){Rr(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),Ly(Wy(o.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(la,t);var e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),r=t.viewState;this.children_.length=0;for(var n=[],i=null,o=0,a=e.length;o<a;++o){var s=e[o];t.layerIndex=o;var u=s.layer,l=u.getSourceState();if(!Sa(s,r)||l!=ya&&l!=ha)u.unrender();else{var c=u.render(t,i);c&&(c!==i&&(this.children_.push(c),i=c),"getDeclutter"in u&&n.push(u))}}for(var f=n.length-1;f>=0;--f)n[f].renderDeclutter(t);!function(t,e){for(var r=t.childNodes,n=0;;++n){var i=r[n],o=e[n];if(!i&&!o)break;i!==o&&(i?o?t.insertBefore(o,i):(t.removeChild(i),--n):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent(ca,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}},{key:"forEachLayerAtPixel",value:function(t,e,r,n,i){for(var o=e.viewState,a=e.layerStatesArray,s=a.length-1;s>=0;--s){var u=a[s],l=u.layer;if(l.hasRenderer()&&Sa(u,o)&&i(l)){var c=l.getRenderer().getDataAtPixel(t,e,r);if(c){var f=n(l,c);if(f)return f}}}}}])&&Ay(e.prototype,r),n&&Ay(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ty(t,e)}(a,t);var e,r,n,o=jy(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).map_=t,e}return e=a,(r=[{key:"dispatchRenderEvent",value:function(t,e){i()}},{key:"calculateMatrices2D",value:function(t){var e=t.viewState,r=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;ln(r,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),cn(n,r)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,r,n,i,o,a,s){var u,l=e.viewState;function c(t,e,r,n){return i.call(o,e,t?r:null,n)}var f=l.projection,h=$t(t.slice(),f),p=[[0,0]];if(f.canWrapX()&&n){var y=Yt(f.getExtent());p.push([-y,0],[y,0])}for(var d=e.layerStatesArray,v=d.length,g=[],m=[],b=0;b<p.length;b++)for(var _=v-1;_>=0;--_){var w=d[_],x=w.layer;if(x.hasRenderer()&&Sa(w,l)&&a.call(s,x)){var k=x.getRenderer(),S=x.getSource();if(k&&S){var O=S.getWrapX()?h:t,R=c.bind(null,w.managed);m[0]=O[0]+p[b][0],m[1]=O[1]+p[b][1],u=k.forEachFeatureAtCoordinate(m,e,r,R,g)}if(u)return u}}if(0!==g.length){var C=1/g.length;return g.forEach((function(t,e){return t.distanceSq+=e*C})),g.sort((function(t,e){return t.distanceSq-e.distanceSq})),g.some((function(t){return u=t.callback(t.feature,t.layer,t.geometry)})),u}}},{key:"forEachLayerAtPixel",value:function(t,e,r,n,o){return i()}},{key:"hasFeatureAtCoordinate",value:function(t,e,r,n,i,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,r,n,nr,this,i,o)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(t){i()}},{key:"scheduleExpireIconCache",value:function(t){gf.canExpireCache()&&t.postRenderFunctions.push(Fy)}}])&&Ey(e.prototype,r),n&&Ey(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Je)),qy="add",Vy="remove";function Ky(t){return(Ky="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yy(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Zy(t,e,r){return e&&Yy(t.prototype,e),r&&Yy(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Uy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hy(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jy(t,e)}function Jy(t,e){return(Jy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=td(t);if(e){var i=td(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $y(this,r)}}function $y(t,e){if(e&&("object"===Ky(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function td(t){return(td=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ed="length",rd=function(t){Hy(r,t);var e=Qy(r);function r(t,n,i){var o;return Uy(this,r),(o=e.call(this,t)).element=n,o.index=i,o}return Zy(r)}(Ze),nd=function(t){Hy(r,t);var e=Qy(r);function r(t,n){var i;Uy(this,r),(i=e.call(this)).on,i.once,i.un;var o=n||{};if(i.unique_=!!o.unique,i.array_=t||[],i.unique_)for(var a=0,s=i.array_.length;a<s;++a)i.assertUnique_(i.array_[a],a);return i.updateLength_(),i}return Zy(r,[{key:"clear",value:function(){for(;this.getLength()>0;)this.pop()}},{key:"extend",value:function(t){for(var e=0,r=t.length;e<r;++e)this.push(t[e]);return this}},{key:"forEach",value:function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)t(e[r],r,e)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(t){return this.array_[t]}},{key:"getLength",value:function(){return this.get(ed)}},{key:"insertAt",value:function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new rd(qy,e,t))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()}},{key:"remove",value:function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)if(e[r]===t)return this.removeAt(r)}},{key:"removeAt",value:function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new rd(Vy,e,t)),e}},{key:"setAt",value:function(t,e){var r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new rd(Vy,n,t)),this.dispatchEvent(new rd(qy,e,t))}else{for(var i=r;i<t;++i)this.insertAt(i,void 0);this.insertAt(t,e)}}},{key:"updateLength_",value:function(){this.set(ed,this.array_.length)}},{key:"assertUnique_",value:function(t,e){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===t&&r!==e)throw new vt(58)}}]),r}(Yr);function id(t){return(id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function od(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ad(t,e,r){return e&&od(t.prototype,e),r&&od(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ud(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ld(t,e)}function ld(t,e){return(ld=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=hd(t);if(e){var i=hd(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return fd(this,r)}}function fd(t,e){if(e&&("object"===id(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function hd(t){return(hd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pd=function(t){ud(r,t);var e=cd(r);function r(t,n){var i;return sd(this,r),(i=e.call(this,t)).layer=n,i}return ad(r)}(Ze),yd="layers",dd=function(t){ud(r,t);var e=cd(r);function r(t){var n;sd(this,r);var i=t||{},o=s({},i);delete o.layers;var a=i.layers;return(n=e.call(this,o)).on,n.once,n.un,n.layersListenerKeys_=[],n.listenerKeys_={},n.addChangeListener(yd,n.handleLayersChanged_),a?Array.isArray(a)?a=new nd(a.slice(),{unique:!0}):gt("function"==typeof a.getArray,43):a=new nd(void 0,{unique:!0}),n.setLayers(a),n}return ad(r,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(Rr),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(Sr(t,qy,this.handleLayersAdd_,this),Sr(t,Vy,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(Rr);u(this.listenerKeys_);for(var r=t.getArray(),n=0,i=r.length;n<i;n++){var o=r[n];this.registerLayerListeners_(o),this.dispatchEvent(new pd("addlayer",o))}this.changed()}},{key:"registerLayerListeners_",value:function(t){var e=[Sr(t,Ue,this.handleLayerChange_,this),Sr(t,pr,this.handleLayerChange_,this)];t instanceof r&&e.push(Sr(t,"addlayer",this.handleLayerGroupAdd_,this),Sr(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[a(t)]=e}},{key:"handleLayerGroupAdd_",value:function(t){this.dispatchEvent(new pd("addlayer",t.layer))}},{key:"handleLayerGroupRemove_",value:function(t){this.dispatchEvent(new pd("removelayer",t.layer))}},{key:"handleLayersAdd_",value:function(t){var e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new pd("addlayer",e)),this.changed()}},{key:"handleLayersRemove_",value:function(t){var e=t.element,r=a(e);this.listenerKeys_[r].forEach(Rr),delete this.listenerKeys_[r],this.dispatchEvent(new pd("removelayer",e)),this.changed()}},{key:"getLayers",value:function(){return this.get(yd)}},{key:"setLayers",value:function(t){var e=this.getLayers();if(e)for(var r=e.getArray(),n=0,i=r.length;n<i;++n)this.dispatchEvent(new pd("removelayer",r[n]));this.set(yd,t)}},{key:"getLayersArray",value:function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e}},{key:"getLayerStatesArray",value:function(t){var e=void 0!==t?t:[],r=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));var n=this.getLayerState(),i=n.zIndex;t||void 0!==n.zIndex||(i=0);for(var o=r,a=e.length;o<a;o++){var s=e[o];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),s.minZoom=Math.max(s.minZoom,n.minZoom),s.maxZoom=Math.min(s.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==s.extent?s.extent=qt(s.extent,n.extent):s.extent=n.extent),void 0===s.zIndex&&(s.zIndex=i)}return e}},{key:"getSourceState",value:function(){return ya}}]),r}(aa);function vd(t){return(vd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gd(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function md(t,e){return(md=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=wd(t);if(e){var i=wd(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _d(this,r)}}function _d(t,e){if(e&&("object"===vd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function wd(t){return(wd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&md(t,e)}(o,t);var e,r,n,i=bd(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this,t)).map=e,n.frameState=void 0!==r?r:null,n}return e=o,r&&gd(e.prototype,r),n&&gd(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ze);function kd(t){return(kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sd(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Od(){return(Od="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Rd(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Rd(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Td(t)););return t}function Cd(t,e){return(Cd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Td(t);if(e){var i=Td(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ed(this,r)}}function Ed(t,e){if(e&&("object"===kd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Td(t){return(Td=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cd(t,e)}(o,t);var e,r,n,i=Pd(o);function o(t,e,r,n,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(s=i.call(this,t,e,a)).originalEvent=r,s.pixel_=null,s.coordinate_=null,s.dragging=void 0!==n&&n,s}return e=o,(r=[{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t}},{key:"preventDefault",value:function(){Od(Td(o.prototype),"preventDefault",this).call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){Od(Td(o.prototype),"stopPropagation",this).call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}])&&Sd(e.prototype,r),n&&Sd(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(xd),Md={SINGLECLICK:"singleclick",CLICK:vr,DBLCLICK:gr,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Id="pointermove",Fd="pointerdown";function Dd(t){return(Dd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ad(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ld(){return(Ld="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=zd(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function zd(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xd(t)););return t}function Bd(t,e){return(Bd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Xd(t);if(e){var i=Xd(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Nd(this,r)}}function Nd(t,e){if(e&&("object"===Dd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wd(t)}function Wd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xd(t){return(Xd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bd(t,e)}(o,t);var e,r,n,i=Gd(o);function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,t)).map_=t,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=void 0===e?1:e,r.down_=null;var n=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=n,r.pointerdownListenerKey_=Sr(n,Fd,r.handlePointerDown_,Wd(r)),r.originalPointerMoveEvent_,r.relayedListenerKey_=Sr(n,Id,r.relayEvent_,Wd(r)),r.boundHandleTouchMove_=r.handleTouchMove_.bind(Wd(r)),r.element_.addEventListener(xr,r.boundHandleTouchMove_,!!en&&{passive:!1}),r}return e=o,(r=[{key:"emulateClick_",value:function(t){var e=new jd(Md.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new jd(Md.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new jd(Md.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)}},{key:"updateActivePointers_",value:function(t){var e=t;e.type==Md.POINTERUP||e.type==Md.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Md.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length}},{key:"handlePointerUp_",value:function(t){this.updateActivePointers_(t);var e=new jd(Md.POINTERUP,this.map_,t);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(Rr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(t){return 0===t.button}},{key:"handlePointerDown_",value:function(t){this.emulateClicks_=0===this.activePointers_,this.updateActivePointers_(t);var e=new jd(Md.POINTERDOWN,this.map_,t);for(var r in this.dispatchEvent(e),this.down_={},t){var n=t[r];this.down_[r]="function"==typeof n?or:n}if(0===this.dragListenerKeys_.length){var i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Sr(i,Md.POINTERMOVE,this.handlePointerMove_,this),Sr(i,Md.POINTERUP,this.handlePointerUp_,this),Sr(this.element_,Md.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(Sr(this.element_.getRootNode(),Md.POINTERUP,this.handlePointerUp_,this))}}},{key:"handlePointerMove_",value:function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new jd(Md.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}}},{key:"relayEvent_",value:function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new jd(t.type,this.map_,t,e))}},{key:"handleTouchMove_",value:function(t){var e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}},{key:"isMoving_",value:function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){this.relayedListenerKey_&&(Rr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(xr,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Rr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Rr),this.dragListenerKeys_.length=0,this.element_=null,Ld(Xd(o.prototype),"disposeInternal",this).call(this)}}])&&Ad(e.prototype,r),n&&Ad(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(hr),Vd="postrender",Kd="movestart",Yd="moveend",Zd="loadstart",Ud="loadend",Hd="layergroup",Jd="size",Qd="target",$d="view",tv={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function ev(t,e,r){return function(n,i,o,a,s){if(n){if(!i&&!e)return n;var u=e?0:o[0]*i,l=e?0:o[1]*i,c=s?s[0]:0,f=s?s[1]:0,h=t[0]+u/2+c,y=t[2]-u/2+c,d=t[1]+l/2+f,v=t[3]-l/2+f;h>y&&(y=h=(y+h)/2),d>v&&(v=d=(v+d)/2);var g=p(n[0],h,y),m=p(n[1],d,v);if(a&&r&&i){var b=30*i;g+=-b*Math.log(1+Math.max(0,h-n[0])/b)+b*Math.log(1+Math.max(0,n[0]-y)/b),m+=-b*Math.log(1+Math.max(0,d-n[1])/b)+b*Math.log(1+Math.max(0,n[1]-v)/b)}return[g,m]}}}function rv(t){return t}function nv(t,e,r,n){var i=Yt(e)/r[0],o=Xt(e)/r[1];return n?Math.min(t,Math.max(i,o)):Math.min(t,Math.min(i,o))}function iv(t,e,r){var n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,r&&(n=Math.max(n,r),n/=Math.log(1+50*Math.max(0,r/t-1))/50+1),p(n,r/2,2*e)}function ov(t,e,r,n,i){return function(o,a,s,u){if(void 0!==o){var l=n?nv(t,n,s,i):t;return(void 0===r||r)&&u?iv(o,l,e):p(o,e,l)}}}function av(t){return void 0!==t?0:void 0}function sv(t){return void 0!==t?t:void 0}function uv(t){return(uv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lv(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cv(t,e){return(cv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pv(t);if(e){var i=pv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return hv(this,r)}}function hv(t,e){if(e&&("object"===uv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pv(t){return(pv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yv(t,e){setTimeout((function(){t(e)}),0)}function dv(t){return!(t.sourceCenter&&t.targetCenter&&!Jt(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function vv(t,e,r,n,i){var o=Math.cos(-i),a=Math.sin(-i),s=t[0]*o-t[1]*a,u=t[1]*o+t[0]*a;return[(s+=(e[0]/2-r[0])*n)*o-(u+=(r[1]-e[1]/2)*n)*(a=-a),u*o+s*a]}var gv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cv(t,e)}(u,t);var r,i,o,a=fv(u);function u(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=a.call(this)).on,e.once,e.un;var r=s({},t);return e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=ce(r.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.nextCenter_=null,e.nextResolution_,e.nextRotation_,e.cancelAnchor_=void 0,r.projection&&ne(),r.center&&(r.center=ke(r.center,e.projection_)),r.extent&&(r.extent=Oe(r.extent,e.projection_)),e.applyOptions_(r),e}return r=u,(i=[{key:"applyOptions_",value:function(t){var r=s({},t);for(var i in tv)delete r[i];this.setProperties(r,!0);var o=function(t){var r,i,o,a=28,s=2,u=void 0!==t.minZoom?t.minZoom:0,l=void 0!==t.maxZoom?t.maxZoom:a,c=void 0!==t.zoomFactor?t.zoomFactor:s,f=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,y=void 0!==t.showFullExtent&&t.showFullExtent,d=ce(t.projection,"EPSG:3857"),v=d.getExtent(),g=t.constrainOnlyCenter,m=t.extent;if(f||m||!d.isGlobal()||(g=!1,m=v),void 0!==t.resolutions){var b=t.resolutions;i=b[u],o=void 0!==b[l]?b[l]:b[b.length-1],r=t.constrainResolution?function(t,e,r,n){return function(i,o,a,s){if(void 0!==i){var u=t[0],l=t[t.length-1],c=r?nv(u,r,a,n):u;if(s)return void 0===e||e?iv(i,c,l):p(i,l,c);var f=Math.min(c,i),h=Math.floor($e(t,f,o));return t[h]>c&&h<t.length-1?t[h+1]:t[h]}}}(b,h,!g&&m,y):ov(i,o,h,!g&&m,y)}else{var _=(v?Math.max(Yt(v),Xt(v)):360*e[n.DEGREES]/d.getMetersPerUnit())/Vh/Math.pow(s,0),w=_/Math.pow(s,a-0);void 0!==(i=t.maxResolution)?u=0:i=_/Math.pow(c,u),void 0===(o=t.minResolution)&&(o=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(c,l):_/Math.pow(c,l):w),l=u+Math.floor(Math.log(i/o)/Math.log(c)),o=i/Math.pow(c,l-u),r=t.constrainResolution?function(t,e,r,n,i,o){return function(a,s,u,l){if(void 0!==a){var c=i?nv(e,i,u,o):e,f=void 0!==r?r:0;if(l)return void 0===n||n?iv(a,c,f):p(a,f,c);var h=Math.ceil(Math.log(e/c)/Math.log(t)-1e-9),y=-s*(.5-1e-9)+.5,d=Math.min(c,a),v=Math.floor(Math.log(e/d)/Math.log(t)+y),g=Math.max(h,v);return p(e/Math.pow(t,g),f,c)}}}(c,i,o,h,!g&&m,y):ov(i,o,h,!g&&m,y)}return{constraint:r,maxResolution:i,minResolution:o,minZoom:u,zoomFactor:c}}(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=o.minZoom;var a=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return ev(t.extent,t.constrainOnlyCenter,e)}var r=ce(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&r.isGlobal()){var n=r.getExtent().slice();return n[0]=-1/0,n[2]=1/0,ev(n,!1,!1)}return rv}(t),u=o.constraint,l=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(o=i||m(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=o?0:t:void 0}):!1===e?sv:"number"==typeof e?(r=e,n=2*Math.PI/r,function(t,e){return e?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0}):sv}return av;var r,n,i,o}(t);this.constraints_={center:a,resolution:u,rotation:l},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var r=this.getCenter();if(r){var n=t||[0,0,0,0];e=e||[0,0,0,0];var i=this.getResolution(),o=i/2*(n[3]-e[3]+e[1]-n[1]),a=i/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([r[0]+o,r[1]-a])}}},{key:"getUpdatedOptions_",value:function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),s({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),r=0;r<e.length;++r){var n=arguments[r];n.center&&((n=s({},n)).center=ke(n.center,this.getProjection())),n.anchor&&((n=s({},n)).anchor=ke(n.anchor,this.getProjection())),e[r]=n}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){var e,r=arguments.length;r>1&&"function"==typeof arguments[r-1]&&(e=arguments[r-1],--r);for(var n=0;n<r&&!this.isDef();++n){var i=arguments[n];i.center&&this.setCenterInternal(i.center),void 0!==i.zoom?this.setZoom(i.zoom):i.resolution&&this.setResolution(i.resolution),void 0!==i.rotation&&this.setRotation(i.rotation)}if(n!==r){for(var o=Date.now(),a=this.targetCenter_.slice(),s=this.targetResolution_,u=this.targetRotation_,l=[];n<r;++n){var c=arguments[n],f={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||nc,callback:e};if(c.center&&(f.sourceCenter=a,f.targetCenter=c.center.slice(),a=f.targetCenter),void 0!==c.zoom?(f.sourceResolution=s,f.targetResolution=this.getResolutionForZoom(c.zoom),s=f.targetResolution):c.resolution&&(f.sourceResolution=s,f.targetResolution=c.resolution,s=f.targetResolution),void 0!==c.rotation){f.sourceRotation=u;var h=b(c.rotation-u+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=u+h,u=f.targetRotation}dv(f)?f.complete=!0:o+=f.duration,l.push(f)}this.animations_.push(l),this.setHint(Qc,1),this.updateAnimations_()}else e&&yv(e,!0)}},{key:"getAnimating",value:function(){return this.hints_[Qc]>0}},{key:"getInteracting",value:function(){return this.hints_[$c]>0}},{key:"cancelAnimations",value:function(){var t;this.setHint(Qc,-this.hints_[Qc]);for(var e=0,r=this.animations_.length;e<r;++e){var n=this.animations_[e];if(n[0].callback&&yv(n[0].callback,!1),!t)for(var i=0,o=n.length;i<o;++i){var a=n[i];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,r=this.animations_.length-1;r>=0;--r){for(var n=this.animations_[r],i=!0,o=0,a=n.length;o<a;++o){var s=n[o];if(!s.complete){var u=t-s.start,l=s.duration>0?u/s.duration:1;l>=1?(s.complete=!0,l=1):i=!1;var c=s.easing(l);if(s.sourceCenter){var f=s.sourceCenter[0],h=s.sourceCenter[1],p=s.targetCenter[0],y=s.targetCenter[1];this.nextCenter_=s.targetCenter;var d=f+c*(p-f),v=h+c*(y-h);this.targetCenter_=[d,v]}if(s.sourceResolution&&s.targetResolution){var g=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);if(s.anchor){var m=this.getViewportSize_(this.getRotation()),_=this.constraints_.resolution(g,0,m,!0);this.targetCenter_=this.calculateCenterZoom(_,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var w=1===c?b(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);if(s.anchor){var x=this.constraints_.rotation(w,!0);this.targetCenter_=this.calculateCenterRotate(x,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=w}if(this.applyTargetState_(!0),e=!0,!s.complete)break}}if(i){this.animations_[r]=null,this.setHint(Qc,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var k=n[0].callback;k&&yv(k,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var r,n,i,o=this.getCenterInternal();return void 0!==o&&(Qt(r=[o[0]-e[0],o[1]-e[1]],t-this.getRotation()),i=e,(n=r)[0]+=+i[0],n[1]+=+i[1]),r}},{key:"calculateCenterZoom",value:function(t,e){var r,n=this.getCenterInternal(),i=this.getResolution();return void 0!==n&&void 0!==i&&(r=[e[0]-t*(e[0]-n[0])/i,e[1]-t*(e[1]-n[1])/i]),r}},{key:"getViewportSize_",value:function(t){var e=this.viewportSize_;if(t){var r=e[0],n=e[1];return[Math.abs(r*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(r*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t?xe(t,this.getProjection()):t}},{key:"getCenterInternal",value:function(){return this.get(tv.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){return Se(this.calculateExtentInternal(t),this.getProjection())}},{key:"calculateExtentInternal",value:function(t){var e=t||this.getViewportSizeMinusPadding_(),r=this.getCenterInternal();gt(r,1);var n=this.getResolution();gt(void 0!==n,2);var i=this.getRotation();return gt(void 0!==i,3),Wt(r,n,i,e)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(tv.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal(Oe(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){var r=e||this.getViewportSizeMinusPadding_(),n=Yt(t)/r[0],i=Xt(t)/r[1];return Math.max(n,i)}},{key:"getResolutionForValueFunction",value:function(t){var e=t||2,r=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(r/n)/Math.log(e);return function(t){return r/Math.pow(e,t*i)}}},{key:"getRotation",value:function(){return this.get(tv.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),r=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(r/n)/e;return function(t){return Math.log(r/t)/e/i}}},{key:"getViewportSizeMinusPadding_",value:function(t){var e=this.getViewportSize_(t),r=this.padding_;return r&&(e=[e[0]-r[1]-r[3],e[1]-r[0]-r[2]]),e}},{key:"getState",value:function(){var t=this.getProjection(),e=this.getResolution(),r=this.getRotation(),n=this.getCenterInternal(),i=this.padding_;if(i){var o=this.getViewportSizeMinusPadding_();n=vv(n,this.getViewportSize_(),[o[0]/2+i[3],o[1]/2+i[0]],e,r)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}},{key:"getZoomForResolution",value:function(t){var e,r,n=this.minZoom_||0;if(this.resolutions_){var i=$e(this.resolutions_,t,1);n=i,e=this.resolutions_[i],r=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,r=this.zoomFactor_;return n+Math.log(e/t)/Math.log(r)}},{key:"getResolutionForZoom",value:function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=p(Math.floor(t),0,this.resolutions_.length-2),r=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(r,p(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){var r;if(gt(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))gt(!Ut(t),25),r=Qi(Oe(t,this.getProjection()));else if(t.getType()===Ke){var n=Oe(t.getExtent(),this.getProjection());(r=Qi(n)).rotate(this.getRotation(),Gt(n))}else{var i=we();r=i?t.clone().transform(i,this.getProjection()):t}this.fitInternal(r,e)}},{key:"rotatedExtentForGeometry",value:function(t){for(var e=this.getRotation(),r=Math.cos(e),n=Math.sin(-e),i=t.getFlatCoordinates(),o=t.getStride(),a=1/0,s=1/0,u=-1/0,l=-1/0,c=0,f=i.length;c<f;c+=o){var h=i[c]*r-i[c+1]*n,p=i[c]*n+i[c+1]*r;a=Math.min(a,h),s=Math.min(s,p),u=Math.max(u,h),l=Math.max(l,p)}return[a,s,u,l]}},{key:"fitInternal",value:function(t,e){var r=e||{},n=r.size;n||(n=this.getViewportSizeMinusPadding_());var i,o=void 0!==r.padding?r.padding:[0,0,0,0],a=void 0!==r.nearest&&r.nearest;i=void 0!==r.minResolution?r.minResolution:void 0!==r.maxZoom?this.getResolutionForZoom(r.maxZoom):0;var s=this.rotatedExtentForGeometry(t),u=this.getResolutionForExtentInternal(s,[n[0]-o[1]-o[3],n[1]-o[0]-o[2]]);u=isNaN(u)?i:Math.max(u,i),u=this.getConstrainedResolution(u,a?0:1);var l=this.getRotation(),c=Math.sin(l),f=Math.cos(l),h=Gt(s);h[0]+=(o[1]-o[3])/2*u,h[1]+=(o[0]-o[2])/2*u;var p=h[0]*f-h[1]*c,y=h[1]*f+h[0]*c,d=this.getConstrainedCenter([p,y],u),v=r.callback?r.callback:or;void 0!==r.duration?this.animateInternal({resolution:u,center:d,duration:r.duration,easing:r.easing},v):(this.targetResolution_=u,this.targetCenter_=d,this.applyTargetState_(!1,!0),yv(v,!0))}},{key:"centerOn",value:function(t,e,r){this.centerOnInternal(ke(t,this.getProjection()),e,r)}},{key:"centerOnInternal",value:function(t,e,r){this.setCenterInternal(vv(t,e,r,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,e,r,n){var i,o=this.padding_;if(o&&t){var a=this.getViewportSizeMinusPadding_(-r),s=vv(t,n,[a[0]/2+o[3],a[1]/2+o[0]],e,r);i=[t[0]-s[0],t[1]-s[1]]}return i}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=xe(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){var r=e&&ke(e,this.getProjection());this.adjustResolutionInternal(t,r)}},{key:"adjustResolutionInternal",value:function(t,e){var r=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,n,r);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e&&(e=ke(e,this.getProjection())),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var r=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,r);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t?ke(t,this.getProjection()):t)}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){var r=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,r),i=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,i,r),a=this.constraints_.center(this.targetCenter_,o,i,r,this.calculateCenterShift(this.targetCenter_,o,n,i));this.get(tv.ROTATION)!==n&&this.set(tv.ROTATION,n),this.get(tv.RESOLUTION)!==o&&(this.set(tv.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),a&&this.get(tv.CENTER)&&Jt(this.get(tv.CENTER),a)||this.set(tv.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,r){var n=void 0!==t?t:200,i=e||0,o=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(o),s=this.constraints_.resolution(this.targetResolution_,i,a),u=this.constraints_.center(this.targetCenter_,s,a,!1,this.calculateCenterShift(this.targetCenter_,s,o,a));if(0===n&&!this.cancelAnchor_)return this.targetResolution_=s,this.targetRotation_=o,this.targetCenter_=u,void this.applyTargetState_();var l=r||(0===n?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===s&&this.getRotation()===o&&this.getCenterInternal()&&Jt(this.getCenterInternal(),u)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:u,resolution:s,duration:n,easing:rc,anchor:l}))}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint($c,1)}},{key:"endInteraction",value:function(t,e,r){var n=r&&ke(r,this.getProjection());this.endInteractionInternal(t,e,n)}},{key:"endInteractionInternal",value:function(t,e,r){this.setHint($c,-1),this.resolveConstraints(t,e,r)}},{key:"getConstrainedCenter",value:function(t,e){var r=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),r)}},{key:"getConstrainedZoom",value:function(t,e){var r=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(r,e))}},{key:"getConstrainedResolution",value:function(t,e){var r=e||0,n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,r,n)}}])&&lv(r.prototype,i),o&&lv(r,o),Object.defineProperty(r,"prototype",{writable:!1}),u}(Yr);function mv(t){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bv(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _v(){return(_v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=wv(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function wv(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rv(t)););return t}function xv(t,e){return(xv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Rv(t);if(e){var i=Rv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Sv(this,r)}}function Sv(t,e){if(e&&("object"===mv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ov(t)}function Ov(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rv(t){return(Rv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cv(t){t instanceof Oa?t.setMapInternal(null):t instanceof dd&&t.getLayers().forEach(Cv)}function Pv(t,e){if(t instanceof Oa)t.setMapInternal(e);else if(t instanceof dd)for(var r=t.getLayers().getArray(),n=0,i=r.length;n<i;++n)Pv(r[n],e)}var Ev=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xv(t,e)}(o,t);var e,r,n,i=kv(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).on,e.once,e.un;var r=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var r,n,i,o={},a=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new dd({layers:t.layers});o[Hd]=a,o[Qd]=t.target,o[$d]=t.view instanceof gv?t.view:new gv,void 0!==t.controls&&(Array.isArray(t.controls)?r=new nd(t.controls.slice()):(gt("function"==typeof t.controls.getArray,47),r=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new nd(t.interactions.slice()):(gt("function"==typeof t.interactions.getArray,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?i=new nd(t.overlays.slice()):(gt("function"==typeof t.overlays.getArray,49),i=t.overlays):i=new nd;return{controls:r,interactions:n,keyboardEventTarget:e,overlays:i,values:o}}(t);e.renderComplete_,e.loaded_=!0,e.boundHandleBrowserEvent_=e.handleBrowserEvent.bind(Ov(e)),e.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,e.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Qr,e.postRenderTimeoutHandle_,e.animationDelayKey_,e.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(Ov(e)),e.coordinateToPixelTransform_=[1,0,0,1,0,0],e.pixelToCoordinateTransform_=[1,0,0,1,0,0],e.frameIndex_=0,e.frameState_=null,e.previousExtent_=null,e.viewPropertyListenerKey_=null,e.viewChangeListenerKey_=null,e.layerGroupPropertyListenerKeys_=null,e.viewport_=document.createElement("div"),e.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),e.viewport_.style.position="relative",e.viewport_.style.overflow="hidden",e.viewport_.style.width="100%",e.viewport_.style.height="100%",e.overlayContainer_=document.createElement("div"),e.overlayContainer_.style.position="absolute",e.overlayContainer_.style.zIndex="0",e.overlayContainer_.style.width="100%",e.overlayContainer_.style.height="100%",e.overlayContainer_.style.pointerEvents="none",e.overlayContainer_.className="ol-overlaycontainer",e.viewport_.appendChild(e.overlayContainer_),e.overlayContainerStopEvent_=document.createElement("div"),e.overlayContainerStopEvent_.style.position="absolute",e.overlayContainerStopEvent_.style.zIndex="0",e.overlayContainerStopEvent_.style.width="100%",e.overlayContainerStopEvent_.style.height="100%",e.overlayContainerStopEvent_.style.pointerEvents="none",e.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",e.viewport_.appendChild(e.overlayContainerStopEvent_),e.mapBrowserEventHandler_=null,e.moveTolerance_=t.moveTolerance,e.keyboardEventTarget_=r.keyboardEventTarget,e.targetChangeHandlerKeys_=null,e.controls=r.controls||new nd,e.interactions=r.interactions||new nd,e.overlays_=r.overlays,e.overlayIdIndex_={},e.renderer_=null,e.postRenderFunctions_=[],e.tileQueue_=new Go(e.getTilePriority.bind(Ov(e)),e.handleTileChange_.bind(Ov(e))),e.addChangeListener(Hd,e.handleLayerGroupChanged_),e.addChangeListener($d,e.handleViewChanged_),e.addChangeListener(Jd,e.handleSizeChanged_),e.addChangeListener(Qd,e.handleTargetChanged_),e.setProperties(r.values);var n=Ov(e);return!t.view||t.view instanceof gv||t.view.then((function(t){n.setView(new gv(t))})),e.controls.addEventListener(qy,function(t){t.element.setMap(this)}.bind(Ov(e))),e.controls.addEventListener(Vy,function(t){t.element.setMap(null)}.bind(Ov(e))),e.interactions.addEventListener(qy,function(t){t.element.setMap(this)}.bind(Ov(e))),e.interactions.addEventListener(Vy,function(t){t.element.setMap(null)}.bind(Ov(e))),e.overlays_.addEventListener(qy,function(t){this.addOverlayInternal_(t.element)}.bind(Ov(e))),e.overlays_.addEventListener(Vy,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(Ov(e))),e.controls.forEach(function(t){t.setMap(this)}.bind(Ov(e))),e.interactions.forEach(function(t){t.setMap(this)}.bind(Ov(e))),e.overlays_.forEach(e.addOverlayInternal_.bind(Ov(e))),e}return e=o,(r=[{key:"createRenderer",value:function(){throw new Error("Use a map type that has a createRenderer method")}},{key:"addControl",value:function(t){this.getControls().push(t)}},{key:"addInteraction",value:function(t){this.getInteractions().push(t)}},{key:"addLayer",value:function(t){this.getLayerGroup().getLayers().push(t)}},{key:"handleLayerAdd_",value:function(t){Pv(t.layer,this)}},{key:"addOverlay",value:function(t){this.getOverlays().push(t)}},{key:"addOverlayInternal_",value:function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}},{key:"disposeInternal",value:function(){this.setTarget(null),_v(Rv(o.prototype),"disposeInternal",this).call(this)}},{key:"forEachFeatureAtPixel",value:function(t,e,r){if(this.frameState_&&this.renderer_){var n=this.getCoordinateFromPixelInternal(t),i=void 0!==(r=void 0!==r?r:{}).hitTolerance?r.hitTolerance:0,o=void 0!==r.layerFilter?r.layerFilter:nr,a=!1!==r.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,i,a,e,null,o,null)}}},{key:"getFeaturesAtPixel",value:function(t,e){var r=[];return this.forEachFeatureAtPixel(t,(function(t){r.push(t)}),e),r}},{key:"getAllLayers",value:function(){var t=[];return function e(r){r.forEach((function(r){r instanceof dd?e(r.getLayers()):t.push(r)}))}(this.getLayers()),t}},{key:"forEachLayerAtPixel",value:function(t,e,r){if(this.frameState_&&this.renderer_){var n=r||{},i=void 0!==n.hitTolerance?n.hitTolerance:0,o=n.layerFilter||nr;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,i,e,o)}}},{key:"hasFeatureAtPixel",value:function(t,e){if(!this.frameState_||!this.renderer_)return!1;var r=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:nr,i=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,i,o,n,null)}},{key:"getEventCoordinate",value:function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}},{key:"getEventCoordinateInternal",value:function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}},{key:"getEventPixel",value:function(t){var e=this.viewport_.getBoundingClientRect(),r="changedTouches"in t?t.changedTouches[0]:t;return[r.clientX-e.left,r.clientY-e.top]}},{key:"getTarget",value:function(){return this.get(Qd)}},{key:"getTargetElement",value:function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null}},{key:"getCoordinateFromPixel",value:function(t){return xe(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(t){var e=this.frameState_;return e?sn(e.pixelToCoordinateTransform,t.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(Hd)}},{key:"setLayers",value:function(t){var e=this.getLayerGroup();if(t instanceof nd)e.setLayers(t);else{var r=e.getLayers();r.clear(),r.extend(t)}}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,r=t.length;e<r;++e){var n=t[e];if(n.visible){var i=n.layer.getRenderer();if(i&&!i.ready)return!0;var o=n.layer.getSource();if(o&&o.loading)return!0}}return!1}},{key:"getPixelFromCoordinate",value:function(t){var e=ke(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}},{key:"getPixelFromCoordinateInternal",value:function(t){var e=this.frameState_;return e?sn(e.coordinateToPixelTransform,t.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(Jd)}},{key:"getView",value:function(){return this.get($d)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getOwnerDocument",value:function(){var t=this.getTargetElement();return t?t.ownerDocument:document}},{key:"getTilePriority",value:function(t,e,r,n){return No(this.frameState_,t,e,r,n)}},{key:"handleBrowserEvent",value:function(t,e){var r=e||t.type,n=new jd(r,this,t);this.handleMapBrowserEvent(n)}},{key:"handleMapBrowserEvent",value:function(t){if(this.frameState_){var e=t.originalEvent,r=e.type;if(r===Fd||r===kr||r===mr){var n=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():n,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(i===n?n.documentElement:i).contains(o))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t))for(var a=this.getInteractions().getArray().slice(),s=a.length-1;s>=0;s--){var u=a[s];if(u.getMap()===this&&u.getActive()&&this.getTargetElement()&&(!u.handleEvent(t)||t.propagationStopped))break}}}},{key:"handlePostRender",value:function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var r=this.maxTilesLoading_,n=r;if(t){var i=t.viewHints;if(i[Qc]||i[$c]){var o=Date.now()-t.time>8;r=o?0:8,n=o?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,n))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(fa)&&this.renderer_.dispatchRenderEvent(fa,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new xd(Ud,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new xd(Zd,this,t))));for(var a=this.postRenderFunctions_,s=0,u=a.length;s<u;++s)a[s](this,t);a.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){if(this.mapBrowserEventHandler_){for(var t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)Rr(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(dr,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(kr,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Ka(this.viewport_)}var r=this.getTargetElement();if(r){for(var n in r.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new qd(this,this.moveTolerance_),Md)this.mapBrowserEventHandler_.addEventListener(Md[n],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(dr,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(kr,this.boundHandleBrowserEvent_,!!en&&{passive:!1});var i=this.getOwnerDocument().defaultView,o=this.keyboardEventTarget_?this.keyboardEventTarget_:r;this.targetChangeHandlerKeys_=[Sr(o,mr,this.handleBrowserEvent,this),Sr(o,br,this.handleBrowserEvent,this),Sr(i,wr,this.updateSize,this)]}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&(Rr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Rr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Sr(t,Ue,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Sr(t,pr,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Rr),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new pd("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Sr(t,Ue,this.render,this),Sr(t,pr,this.render,this),Sr(t,"addlayer",this.handleLayerAdd_,this),Sr(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,r=t.length;e<r;++e){var n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeControl",value:function(t){return this.getControls().remove(t)}},{key:"removeInteraction",value:function(t){return this.getInteractions().remove(t)}},{key:"removeLayer",value:function(t){return this.getLayerGroup().getLayers().remove(t)}},{key:"handleLayerRemove_",value:function(t){Cv(t.layer)}},{key:"removeOverlay",value:function(t){return this.getOverlays().remove(t)}},{key:"renderFrame_",value:function(t){var e=this,r=this.getSize(),n=this.getView(),i=this.frameState_,o=null;if(void 0!==r&&ja(r)&&n&&n.isDef()){var s=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),u=n.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Wt(u.center,u.resolution,u.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:u,viewHints:s,wantedTiles:{},mapId:a(this),renderTargets:{}},u.nextCenter&&u.nextResolution){var l=isNaN(u.nextRotation)?u.rotation:u.nextRotation;o.nextExtent=Wt(u.nextCenter,u.nextResolution,l,r)}}this.frameState_=o,this.renderer_.renderFrame(o),o&&(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),i&&(!this.previousExtent_||!Ut(this.previousExtent_)&&!jt(o.extent,this.previousExtent_))&&(this.dispatchEvent(new xd(Kd,this,i)),this.previousExtent_=Pt(this.previousExtent_)),this.previousExtent_&&!o.viewHints[Qc]&&!o.viewHints[$c]&&!jt(o.extent,this.previousExtent_)&&(this.dispatchEvent(new xd(Yd,this,o)),_t(o.extent,this.previousExtent_))),this.dispatchEvent(new xd(Vd,this,o)),this.renderComplete_=this.hasListener(Zd)||this.hasListener(Ud)||this.hasListener(fa)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((function(){e.postRenderTimeoutHandle_=void 0,e.handlePostRender()}),0))}},{key:"setLayerGroup",value:function(t){var e=this.getLayerGroup();e&&this.handleLayerRemove_(new pd("removelayer",e)),this.set(Hd,t)}},{key:"setSize",value:function(t){this.set(Jd,t)}},{key:"setTarget",value:function(t){this.set(Qd,t)}},{key:"setView",value:function(t){if(!t||t instanceof gv)this.set($d,t);else{this.set($d,new gv);var e=this;t.then((function(t){e.setView(new gv(t))}))}}},{key:"updateSize",value:function(){var t=this.getTargetElement(),e=void 0;if(t){var r=getComputedStyle(t),n=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),i=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);isNaN(n)||isNaN(i)||!ja(e=[n,i])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0.")}this.setSize(e),this.updateViewportSize_()}},{key:"updateViewportSize_",value:function(){var t=this.getView();if(t){var e=void 0,r=getComputedStyle(this.viewport_);r.width&&r.height&&(e=[parseInt(r.width,10),parseInt(r.height,10)]),t.setViewportSize(e)}}}])&&bv(e.prototype,r),n&&bv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Yr);function Tv(t){return(Tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jv(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mv(){return(Mv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Iv(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Iv(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lv(t)););return t}function Fv(t,e){return(Fv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Lv(t);if(e){var i=Lv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Av(this,r)}}function Av(t,e){if(e&&("object"===Tv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Lv(t){return(Lv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fv(t,e)}(o,t);var e,r,n,i=Dv(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),e=i.call(this);var r=t.element;return!r||t.target||r.style.pointerEvents||(r.style.pointerEvents="auto"),e.element=r||null,e.target_=null,e.map_=null,e.listenerKeys=[],t.render&&(e.render=t.render),t.target&&e.setTarget(t.target),e}return e=o,(r=[{key:"disposeInternal",value:function(){Ka(this.element),Mv(Lv(o.prototype),"disposeInternal",this).call(this)}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(t){this.map_&&Ka(this.element);for(var e=0,r=this.listenerKeys.length;e<r;++e)Rr(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==or&&this.listenerKeys.push(Sr(t,Vd,this.render,this)),t.render())}},{key:"render",value:function(t){}},{key:"setTarget",value:function(t){this.target_="string"==typeof t?document.getElementById(t):t}}])&&jv(e.prototype,r),n&&jv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Yr);function Bv(t){return(Bv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gv(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Nv(t,e){return(Nv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Vv(t);if(e){var i=Vv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Xv(this,r)}}function Xv(t,e){if(e&&("object"===Bv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return qv(t)}function qv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vv(t){return(Vv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Kv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nv(t,e)}(o,t);var e,r,n,i=Wv(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};(e=i.call(this,{element:document.createElement("div"),render:r.render,target:r.target})).ulElement_=document.createElement("ul"),e.collapsed_=void 0===r.collapsed||r.collapsed,e.userCollapsed_=e.collapsed_,e.overrideCollapsible_=void 0!==r.collapsible,e.collapsible_=void 0===r.collapsible||r.collapsible,e.collapsible_||(e.collapsed_=!1);var n=void 0!==r.className?r.className:"ol-attribution",a=void 0!==r.tipLabel?r.tipLabel:"Attributions",s=void 0!==r.expandClassName?r.expandClassName:n+"-expand",u=void 0!==r.collapseLabel?r.collapseLabel:"›",l=void 0!==r.collapseClassName?r.collapseClassName:n+"-collapse";"string"==typeof u?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=u,e.collapseLabel_.className=l):e.collapseLabel_=u;var c=void 0!==r.label?r.label:"i";"string"==typeof c?(e.label_=document.createElement("span"),e.label_.textContent=c,e.label_.className=s):e.label_=c;var f=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_;e.toggleButton_=document.createElement("button"),e.toggleButton_.setAttribute("type","button"),e.toggleButton_.setAttribute("aria-expanded",String(!e.collapsed_)),e.toggleButton_.title=a,e.toggleButton_.appendChild(f),e.toggleButton_.addEventListener(vr,e.handleClick_.bind(qv(e)),!1);var h=n+" "+"ol-unselectable "+Za+(e.collapsed_&&e.collapsible_?" ol-collapsed":"")+(e.collapsible_?"":" ol-uncollapsible"),p=e.element;return p.className=h,p.appendChild(e.toggleButton_),p.appendChild(e.ulElement_),e.renderedAttributions_=[],e.renderedVisible_=!0,e}return e=o,(r=[{key:"collectSourceAttributions_",value:function(t){for(var e={},r=[],n=!0,i=t.layerStatesArray,o=0,a=i.length;o<a;++o){var s=i[o];if(Sa(s,t.viewState)){var u=s.layer.getSource();if(u){var l=u.getAttributions();if(l){var c=l(t);if(c)if(n=n&&!1!==u.getAttributionsCollapsible(),Array.isArray(c))for(var f=0,h=c.length;f<h;++f)c[f]in e||(r.push(c[f]),e[c[f]]=!0);else c in e||(r.push(c),e[c]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(n),r}},{key:"updateElement_",value:function(t){if(t){var e=this.collectSourceAttributions_(t),r=e.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!rr(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(var n=0,i=e.length;n<i;++n){var o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}},{key:"handleClick_",value:function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}},{key:"handleToggle_",value:function(){this.element.classList.toggle(Ua),this.collapsed_?Va(this.collapseLabel_,this.label_):Va(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"render",value:function(t){this.updateElement_(t.frameState)}}])&&Gv(e.prototype,r),n&&Gv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(zv);function Yv(t){return(Yv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zv(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Uv(t,e){return(Uv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Hv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$v(t);if(e){var i=$v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Jv(this,r)}}function Jv(t,e){if(e&&("object"===Yv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Qv(t)}function Qv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $v(t){return($v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uv(t,e)}(o,t);var e,r,n,i=Hv(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};e=i.call(this,{element:document.createElement("div"),render:r.render,target:r.target});var n=void 0!==r.className?r.className:"ol-rotate",a=void 0!==r.label?r.label:"⇧",s=void 0!==r.compassClassName?r.compassClassName:"ol-compass";e.label_=null,"string"==typeof a?(e.label_=document.createElement("span"),e.label_.className=s,e.label_.textContent=a):(e.label_=a,e.label_.classList.add(s));var u=r.tipLabel?r.tipLabel:"Reset rotation",l=document.createElement("button");l.className=n+"-reset",l.setAttribute("type","button"),l.title=u,l.appendChild(e.label_),l.addEventListener(vr,e.handleClick_.bind(Qv(e)),!1);var c=n+" "+"ol-unselectable "+Za,f=e.element;return f.className=c,f.appendChild(l),e.callResetNorth_=r.resetNorth?r.resetNorth:void 0,e.duration_=void 0!==r.duration?r.duration:250,e.autoHide_=void 0===r.autoHide||r.autoHide,e.rotation_=void 0,e.autoHide_&&e.element.classList.add(Ya),e}return e=o,(r=[{key:"handleClick_",value:function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:rc}):t.setRotation(0))}}},{key:"render",value:function(t){var e=t.frameState;if(e){var r=e.viewState.rotation;if(r!=this.rotation_){var n="rotate("+r+"rad)";if(this.autoHide_){var i=this.element.classList.contains(Ya);i||0!==r?i&&0!==r&&this.element.classList.remove(Ya):this.element.classList.add(Ya)}this.label_.style.transform=n}this.rotation_=r}}}])&&Zv(e.prototype,r),n&&Zv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(zv);function eg(t){return(eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ng(t,e){return(ng=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ig(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=sg(t);if(e){var i=sg(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return og(this,r)}}function og(t,e){if(e&&("object"===eg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ag(t)}function ag(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sg(t){return(sg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ug=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ng(t,e)}(o,t);var e,r,n,i=ig(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};e=i.call(this,{element:document.createElement("div"),target:r.target});var n=void 0!==r.className?r.className:"ol-zoom",a=void 0!==r.delta?r.delta:1,s=void 0!==r.zoomInClassName?r.zoomInClassName:n+"-in",u=void 0!==r.zoomOutClassName?r.zoomOutClassName:n+"-out",l=void 0!==r.zoomInLabel?r.zoomInLabel:"+",c=void 0!==r.zoomOutLabel?r.zoomOutLabel:"–",f=void 0!==r.zoomInTipLabel?r.zoomInTipLabel:"Zoom in",h=void 0!==r.zoomOutTipLabel?r.zoomOutTipLabel:"Zoom out",p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=f,p.appendChild("string"==typeof l?document.createTextNode(l):l),p.addEventListener(vr,e.handleClick_.bind(ag(e),a),!1);var y=document.createElement("button");y.className=u,y.setAttribute("type","button"),y.title=h,y.appendChild("string"==typeof c?document.createTextNode(c):c),y.addEventListener(vr,e.handleClick_.bind(ag(e),-a),!1);var d=n+" "+"ol-unselectable "+Za,v=e.element;return v.className=d,v.appendChild(p),v.appendChild(y),e.duration_=void 0!==r.duration?r.duration:250,e}return e=o,(r=[{key:"handleClick_",value:function(t,e){e.preventDefault(),this.zoomByDelta_(t)}},{key:"zoomByDelta_",value:function(t){var e=this.getMap().getView();if(e){var r=e.getZoom();if(void 0!==r){var n=e.getConstrainedZoom(r+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:rc})):e.setZoom(n)}}}}])&&rg(e.prototype,r),n&&rg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(zv);var lg="active";function cg(t){return(cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hg(t,e){return(hg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=dg(t);if(e){var i=dg(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return yg(this,r)}}function yg(t,e){if(e&&("object"===cg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dg(t){return(dg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vg(t,e,r,n){var i=t.getZoom();if(void 0!==i){var o=t.getConstrainedZoom(i+e),a=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:r,duration:void 0!==n?n:250,easing:rc})}}var gg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hg(t,e)}(o,t);var e,r,n,i=pg(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).on,e.once,e.un,t&&t.handleEvent&&(e.handleEvent=t.handleEvent),e.map_=null,e.setActive(!0),e}return e=o,(r=[{key:"getActive",value:function(){return this.get(lg)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(t){return!0}},{key:"setActive",value:function(t){this.set(lg,t)}},{key:"setMap",value:function(t){this.map_=t}}])&&fg(e.prototype,r),n&&fg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Yr);function mg(t){return(mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _g(t,e){return(_g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=kg(t);if(e){var i=kg(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return xg(this,r)}}function xg(t,e){if(e&&("object"===mg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function kg(t){return(kg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Sg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_g(t,e)}(o,t);var e,r,n,i=wg(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};return(e=i.call(this)).delta_=r.delta?r.delta:1,e.duration_=void 0!==r.duration?r.duration:250,e}return e=o,(r=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==Md.DBLCLICK){var r=t.originalEvent,n=t.map,i=t.coordinate,o=r.shiftKey?-this.delta_:this.delta_;vg(n.getView(),o,i,this.duration_),r.preventDefault(),e=!0}return!e}}])&&bg(e.prototype,r),n&&bg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(gg);function Og(t){return(Og="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Cg(t,e){return(Cg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Tg(t);if(e){var i=Tg(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Eg(this,r)}}function Eg(t,e){if(e&&("object"===Og(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Tg(t){return(Tg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jg(t){for(var e=t.length,r=0,n=0,i=0;i<e;i++)r+=t[i].clientX,n+=t[i].clientY;return[r/e,n/e]}var Mg=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cg(t,e)}(o,t);var e,r,n,i=Pg(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};return e=i.call(this,r),r.handleDownEvent&&(e.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(e.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(e.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(e.handleUpEvent=r.handleUpEvent),r.stopDown&&(e.stopDown=r.stopDown),e.handlingDownUpSequence=!1,e.trackedPointers_={},e.targetPointers=[],e}return e=o,(r=[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(t){return!1}},{key:"handleDragEvent",value:function(t){}},{key:"handleEvent",value:function(t){if(!t.originalEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Md.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Md.POINTERUP){var r=this.handleUpEvent(t);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(t.type==Md.POINTERDOWN){var n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Md.POINTERMOVE&&this.handleMoveEvent(t);return!e}},{key:"handleMoveEvent",value:function(t){}},{key:"handleUpEvent",value:function(t){return!1}},{key:"stopDown",value:function(t){return t}},{key:"updateTrackedPointers_",value:function(t){if(function(t){var e=t.type;return e===Md.POINTERDOWN||e===Md.POINTERDRAG||e===Md.POINTERUP}(t)){var e=t.originalEvent,r=e.pointerId.toString();t.type==Md.POINTERUP?delete this.trackedPointers_[r]:(t.type==Md.POINTERDOWN||r in this.trackedPointers_)&&(this.trackedPointers_[r]=e),this.targetPointers=l(this.trackedPointers_)}}}])&&Rg(e.prototype,r),n&&Rg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(gg);function Ig(t){var e=arguments;return function(t){for(var r=!0,n=0,i=e.length;n<i&&(r=r&&e[n](t));++n);return r}}var Fg=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Dg=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){var e=t.map.getTargetElement(),r=t.map.getOwnerDocument().activeElement;return e.contains(r)}(t)},Ag=nr,Lg=function(t){var e=t.originalEvent;return 0==e.button&&!(Hr&&Jr&&e.ctrlKey)},zg=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Bg=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Gg=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},Ng=function(t){var e=t.originalEvent;return gt(void 0!==e,56),"mouse"==e.pointerType},Wg=function(t){var e=t.originalEvent;return gt(void 0!==e,56),e.isPrimary&&0===e.button};function Xg(t){return(Xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vg(t,e){return(Vg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kg(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Zg(t);if(e){var i=Zg(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Yg(this,r)}}function Yg(t,e){if(e&&("object"===Xg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Zg(t){return(Zg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ug=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vg(t,e)}(o,t);var e,r,n,i=Kg(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};(e=i.call(this,{stopDown:ir})).kinetic_=r.kinetic,e.lastCentroid=null,e.lastPointersCount_,e.panning_=!1;var n=r.condition?r.condition:Ig(zg,Wg);return e.condition_=r.onFocusOnly?Ig(Dg,n):n,e.noKinetic_=!1,e}return e=o,(r=[{key:"handleDragEvent",value:function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e=this.targetPointers,r=jg(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){var n=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],i=t.map.getView();!function(t,e){t[0]*=e,t[1]*=e}(n,i.getResolution()),Qt(n,i.getRotation()),i.adjustCenterInternal(n)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=e.length,t.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(t){var e=t.map,r=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=r.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),s=e.getCoordinateFromPixelInternal([a[0]-n*Math.cos(i),a[1]-n*Math.sin(i)]);r.animateInternal({center:r.getConstrainedCenter(s),duration:500,easing:rc})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}])&&qg(e.prototype,r),n&&qg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Mg);function Hg(t){return(Hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qg(t,e){return(Qg=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=em(t);if(e){var i=em(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return tm(this,r)}}function tm(t,e){if(e&&("object"===Hg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function em(t){return(em=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qg(t,e)}(o,t);var e,r,n,i=$g(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};return(e=i.call(this,{stopDown:ir})).condition_=r.condition?r.condition:Fg,e.lastAngle_=void 0,e.duration_=void 0!==r.duration?r.duration:250,e}return e=o,(r=[{key:"handleDragEvent",value:function(t){if(Ng(t)){var e=t.map,r=e.getView();if(r.getConstraints().rotation!==av){var n=e.getSize(),i=t.pixel,o=Math.atan2(n[1]/2-i[1],i[0]-n[0]/2);if(void 0!==this.lastAngle_){var a=o-this.lastAngle_;r.adjustRotationInternal(-a)}this.lastAngle_=o}}}},{key:"handleUpEvent",value:function(t){return!Ng(t)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){return!(!Ng(t)||!Lg(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0,0))}}])&&Jg(e.prototype,r),n&&Jg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Mg);function nm(t){return(nm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function im(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function om(t,e){return(om=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function am(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=um(t);if(e){var i=um(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return sm(this,r)}}function sm(t,e){if(e&&("object"===nm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function um(t){return(um=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&om(t,e)}(o,t);var e,r,n,i=am(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).geometry_=null,e.element_=document.createElement("div"),e.element_.style.position="absolute",e.element_.style.pointerEvents="auto",e.element_.className="ol-box "+t,e.map_=null,e.startPixel_=null,e.endPixel_=null,e}return e=o,(r=[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var t=this.startPixel_,e=this.endPixel_,r="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+r,n.top=Math.min(t[1],e[1])+r,n.width=Math.abs(e[0]-t[0])+r,n.height=Math.abs(e[1]-t[1])+r}},{key:"setMap",value:function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){var t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Ji([r])}},{key:"getGeometry",value:function(){return this.geometry_}}])&&im(e.prototype,r),n&&im(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Je);function cm(t){return(cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fm(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hm(t,e,r){return e&&fm(t.prototype,e),r&&fm(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ym(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dm(t,e)}function dm(t,e){return(dm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mm(t);if(e){var i=mm(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return gm(this,r)}}function gm(t,e){if(e&&("object"===cm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function mm(t){return(mm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bm="boxstart",_m="boxdrag",wm="boxend",xm="boxcancel",km=function(t){ym(r,t);var e=vm(r);function r(t,n,i){var o;return pm(this,r),(o=e.call(this,t)).coordinate=n,o.mapBrowserEvent=i,o}return hm(r)}(Ze);function Sm(t){return(Sm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Om(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rm(t,e){return(Rm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Em(t);if(e){var i=Em(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Pm(this,r)}}function Pm(t,e){if(e&&("object"===Sm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Em(t){return(Em=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Tm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rm(t,e)}(o,t);var e,r,n,i=Cm(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{},n=r.condition?r.condition:Bg;return(e=i.call(this,{condition:n,className:r.className||"ol-dragzoom",minArea:r.minArea})).duration_=void 0!==r.duration?r.duration:200,e.out_=void 0!==r.out&&r.out,e}return e=o,(r=[{key:"onBoxEnd",value:function(t){var e=this.getMap().getView(),r=this.getGeometry();if(this.out_){var n=e.rotatedExtentForGeometry(r),i=e.getResolutionForExtentInternal(n),o=e.getResolution()/i;(r=r.clone()).scale(o*o)}e.fitInternal(r,{duration:this.duration_,easing:rc})}}])&&Om(e.prototype,r),n&&Om(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(t){ym(r,t);var e=vm(r);function r(t){var n;pm(this,r),(n=e.call(this)).on,n.once,n.un;var i=t||{};return n.box_=new lm(i.className||"ol-dragbox"),n.minArea_=void 0!==i.minArea?i.minArea:64,i.onBoxEnd&&(n.onBoxEnd=i.onBoxEnd),n.startPixel_=null,n.condition_=i.condition?i.condition:Lg,n.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:n.defaultBoxEndCondition,n}return hm(r,[{key:"defaultBoxEndCondition",value:function(t,e,r){var n=r[0]-e[0],i=r[1]-e[1];return n*n+i*i>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new km(_m,t.coordinate,t))}},{key:"handleUpEvent",value:function(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new km(e?wm:xm,t.coordinate,t)),!1}},{key:"handleDownEvent",value:function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new km(bm,t.coordinate,t)),!0)}},{key:"onBoxEnd",value:function(t){}}]),r}(Mg)),jm=37,Mm=38,Im=39,Fm=40;function Dm(t){return(Dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Am(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lm(t,e){return(Lm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Gm(t);if(e){var i=Gm(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Bm(this,r)}}function Bm(t,e){if(e&&("object"===Dm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Gm(t){return(Gm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lm(t,e)}(o,t);var e,r,n,i=zm(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};return(e=i.call(this)).defaultCondition_=function(t){return zg(t)&&Gg(t)},e.condition_=void 0!==r.condition?r.condition:e.defaultCondition_,e.duration_=void 0!==r.duration?r.duration:100,e.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,e}return e=o,(r=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==mr){var r=t.originalEvent,n=r.keyCode;if(this.condition_(t)&&(n==Fm||n==jm||n==Im||n==Mm)){var i=t.map.getView(),o=i.getResolution()*this.pixelDelta_,a=0,s=0;n==Fm?s=-o:n==jm?a=-o:n==Im?a=o:s=o;var u=[a,s];Qt(u,i.getRotation()),function(t,e,r){var n=t.getCenterInternal();if(n){var i=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==r?r:250,easing:ic,center:t.getConstrainedCenter(i)})}}(i,u,this.duration_),r.preventDefault(),e=!0}}return!e}}])&&Am(e.prototype,r),n&&Am(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(gg);function Wm(t){return(Wm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xm(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qm(t,e){return(qm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ym(t);if(e){var i=Ym(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Km(this,r)}}function Km(t,e){if(e&&("object"===Wm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ym(t){return(Ym=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zm=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qm(t,e)}(o,t);var e,r,n,i=Vm(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};return(e=i.call(this)).condition_=r.condition?r.condition:Gg,e.delta_=r.delta?r.delta:1,e.duration_=void 0!==r.duration?r.duration:100,e}return e=o,(r=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==mr||t.type==br){var r=t.originalEvent,n=r.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var i=t.map,o=n=="+".charCodeAt(0)?this.delta_:-this.delta_;vg(i.getView(),o,void 0,this.duration_),r.preventDefault(),e=!0}}return!e}}])&&Xm(e.prototype,r),n&&Xm(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(gg);function Um(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Hm=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.decay_=e,this.minVelocity_=r,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}var e,r,n;return e=t,(r=[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(t,e){this.points_.push(t,e,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var r=e-3;r>0&&this.points_[r+2]>t;)r-=3;var n=this.points_[e+2]-this.points_[r+2];if(n<1e3/60)return!1;var i=this.points_[e]-this.points_[r],o=this.points_[e+1]-this.points_[r+1];return this.angle_=Math.atan2(o,i),this.initialVelocity_=Math.sqrt(i*i+o*o)/n,this.initialVelocity_>this.minVelocity_}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}])&&Um(e.prototype,r),n&&Um(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jm(t){return(Jm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qm(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $m(t,e){return($m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=rb(t);if(e){var i=rb(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return eb(this,r)}}function eb(t,e){if(e&&("object"===Jm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rb(t){return(rb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nb="trackpad",ib="wheel",ob=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$m(t,e)}(o,t);var e,r,n,i=tb(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{};(e=i.call(this,r)).totalDelta_=0,e.lastDelta_=0,e.maxDelta_=void 0!==r.maxDelta?r.maxDelta:1,e.duration_=void 0!==r.duration?r.duration:250,e.timeout_=void 0!==r.timeout?r.timeout:80,e.useAnchor_=void 0===r.useAnchor||r.useAnchor,e.constrainResolution_=void 0!==r.constrainResolution&&r.constrainResolution;var n=r.condition?r.condition:Ag;return e.condition_=r.onFocusOnly?Ig(Dg,n):n,e.lastAnchor_=null,e.startTime_=void 0,e.timeoutId_,e.mode_=void 0,e.trackpadEventGap_=400,e.trackpadTimeoutId_,e.deltaPerZoom_=300,e}return e=o,(r=[{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(t){if(!this.condition_(t))return!0;if(t.type!==kr)return!0;var e,r=t.map,n=t.originalEvent;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==kr&&(e=n.deltaY,Ur&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=Qr),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?nb:ib);var o=r.getView();if(this.mode_===nb&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1;this.totalDelta_+=e;var a=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),a),!1}},{key:"handleWheelZoom_",value:function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var r=-p(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),vg(e,r,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}])&&Qm(e.prototype,r),n&&Qm(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(gg);function ab(t){return(ab="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ub(t,e){return(ub=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fb(t);if(e){var i=fb(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return cb(this,r)}}function cb(t,e){if(e&&("object"===ab(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fb(t){return(fb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hb=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ub(t,e)}(o,t);var e,r,n,i=lb(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{},n=r;return n.stopDown||(n.stopDown=ir),(e=i.call(this,n)).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0!==r.threshold?r.threshold:.3,e.duration_=void 0!==r.duration?r.duration:250,e}return e=o,(r=[{key:"handleDragEvent",value:function(t){var e=0,r=this.targetPointers[0],n=this.targetPointers[1],i=Math.atan2(n.clientY-r.clientY,n.clientX-r.clientX);if(void 0!==this.lastAngle_){var o=i-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=i;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==av){var u=a.getViewport().getBoundingClientRect(),l=jg(this.targetPointers);l[0]-=u.left,l[1]-=u.top,this.anchor_=a.getCoordinateFromPixelInternal(l),this.rotating_&&(a.render(),s.adjustRotationInternal(e,this.anchor_))}}},{key:"handleUpEvent",value:function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])&&sb(e.prototype,r),n&&sb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Mg);function pb(t){return(pb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function db(t,e){return(db=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mb(t);if(e){var i=mb(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return gb(this,r)}}function gb(t,e){if(e&&("object"===pb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function mb(t){return(mb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bb=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&db(t,e)}(o,t);var e,r,n,i=vb(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{},n=r;return n.stopDown||(n.stopDown=ir),(e=i.call(this,n)).anchor_=null,e.duration_=void 0!==r.duration?r.duration:400,e.lastDistance_=void 0,e.lastScaleDelta_=1,e}return e=o,(r=[{key:"handleDragEvent",value:function(t){var e=1,r=this.targetPointers[0],n=this.targetPointers[1],i=r.clientX-n.clientX,o=r.clientY-n.clientY,a=Math.sqrt(i*i+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,u=s.getView();1!=e&&(this.lastScaleDelta_=e);var l=s.getViewport().getBoundingClientRect(),c=jg(this.targetPointers);c[0]-=l.left,c[1]-=l.top,this.anchor_=s.getCoordinateFromPixelInternal(c),s.render(),u.adjustResolutionInternal(e,this.anchor_)}},{key:"handleUpEvent",value:function(t){if(this.targetPointers.length<2){var e=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,r),!1}return!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])&&yb(e.prototype,r),n&&yb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Mg);function _b(t){return(_b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xb(t,e){return(xb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ob(t);if(e){var i=Ob(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Sb(this,r)}}function Sb(t,e){if(e&&("object"===_b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ob(t){return(Ob=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rb=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xb(t,e)}(o,t);var e,r,n,i=kb(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=s({},t)).controls||(t.controls=function(t){var e=t||{},r=new nd;return(void 0===e.zoom||e.zoom)&&r.push(new ug(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&r.push(new tg(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&r.push(new Kv(e.attributionOptions)),r}()),t.interactions||(t.interactions=function(t){var e=t||{},r=new nd,n=new Hm(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&r.push(new rm),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&r.push(new Sg({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&r.push(new Ug({onFocusOnly:e.onFocusOnly,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&r.push(new hb),(void 0===e.pinchZoom||e.pinchZoom)&&r.push(new bb({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(r.push(new Nm),r.push(new Zm({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&r.push(new ob({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&r.push(new Tm({duration:e.zoomDuration})),r}({onFocusOnly:!0})),i.call(this,t)}return e=o,(r=[{key:"createRenderer",value:function(){return new Xy(this)}}])&&wb(e.prototype,r),n&&wb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Ev);function Cb(t){return(Cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Eb(){return(Eb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=Tb(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function Tb(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fb(t)););return t}function jb(t,e){return(jb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Fb(t);if(e){var i=Fb(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ib(this,r)}}function Ib(t,e){if(e&&("object"===Cb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Fb(t){return(Fb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Db(t,e){t.getImage().src=e}var Ab=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jb(t,e)}(o,t);var e,r,n,i=Mb(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=void 0===t.imageSmoothing||t.imageSmoothing;return void 0!==t.interpolate&&(r=t.interpolate),(e=i.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Db,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:r,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,e.tileClass=void 0!==t.tileClass?t.tileClass:bc,e.tileCacheForProjection={},e.tileGridForProjection={},e.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,e.renderReprojectionEdges_=!1,e}return e=o,(r=[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(t,e){var r=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==r?e:{}),this.tileCacheForProjection){var i=this.tileCacheForProjection[n];i.expireCache(i==r?e:{})}}},{key:"getGutterForProjection",value:function(t){return this.getProjection()&&t&&!he(this.getProjection(),t)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var t=Eb(Fb(o.prototype),"getKey",this).call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t}},{key:"getOpaque",value:function(t){return!(this.getProjection()&&t&&!he(this.getProjection(),t))&&Eb(Fb(o.prototype),"getOpaque",this).call(this,t)}},{key:"getTileGridForProjection",value:function(t){var e=this.getProjection();if(!this.tileGrid||e&&!he(e,t)){var r=a(t);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=Uh(t)),this.tileGridForProjection[r]}return this.tileGrid}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();if(!e||he(e,t))return this.tileCache;var r=a(t);return r in this.tileCacheForProjection||(this.tileCacheForProjection[r]=new Mh(this.tileCache.highWaterMark)),this.tileCacheForProjection[r]}},{key:"createTile_",value:function(t,e,r,n,i,o){var a=[t,e,r],s=this.getTileCoordForTileUrlFunction(a,i),u=s?this.tileUrlFunction(s,n,i):void 0,l=new this.tileClass(a,void 0!==u?Ro:To,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,l.addEventListener(pr,this.handleTileChange.bind(this)),l}},{key:"getTile",value:function(t,e,r,n,i){var o=this.getProjection();if(o&&i&&!he(o,i)){var a,s=this.getTileCacheForProjection(i),u=[t,e,r],l=kh(u);s.containsKey(l)&&(a=s.get(l));var c=this.getKey();if(a&&a.key==c)return a;var f=this.getTileGridForProjection(o),h=this.getTileGridForProjection(i),p=this.getTileCoordForTileUrlFunction(u,i),y=new Dc(o,f,i,h,u,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,r,n){return this.getTileInternal(t,e,r,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return y.key=c,a?(y.interimTile=a,y.refreshInterimChain(),s.replace(l,y)):s.set(l,y),y}return this.getTileInternal(t,e,r,n,o||i)}},{key:"getTileInternal",value:function(t,e,r,n,i){var o=null,a=xh(t,e,r),s=this.getKey();if(this.tileCache.containsKey(a)){if((o=this.tileCache.get(a)).key!=s){var u=o;o=this.createTile_(t,e,r,n,i,s),u.getState()==Ro?o.interimTile=u.interimTile:o.interimTile=u,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,r,n,i,s),this.tileCache.set(a,o);return o}},{key:"setRenderReprojectionEdges",value:function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}},{key:"setTileGridForProjection",value:function(t,e){var r=se(t);if(r){var n=a(r);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}}}])&&Pb(e.prototype,r),n&&Pb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(wp);function Lb(t){return("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bb(t,e,r){return e&&zb(t.prototype,e),r&&zb(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nb(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yb(t,e)}function Wb(t){var e=Kb();return function(){var r,n=Zb(t);if(e){var i=Zb(this).constructor;Reflect.construct(n,arguments,i)}else n.apply(this,arguments);return Xb(this,r)}}function Xb(t,e){if(e&&("object"===Lb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function qb(t){var e="function"==typeof Map?new Map:void 0;return function(t){if(null===t||(t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Vb(t,arguments,Zb(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Yb(n,t)}(t)}function Vb(t,e,r){return(Kb()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&Yb(i,r.prototype),i}).apply(null,arguments)}function Kb(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Yb(t,e){return(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zb(t){return(Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Error,Error;function Ub(t){return(Ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jb(t,e){return(Jb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=e_(t);if(e){var i=e_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $b(this,r)}}function $b(t,e){if(e&&("object"===Ub(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return t_(t)}function t_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e_(t){return(e_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var r_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jb(t,e)}(o,t);var e,r,n,i=Qb(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=void 0===t.imageSmoothing||t.imageSmoothing;if(void 0!==t.interpolate&&(r=t.interpolate),(e=i.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:r,projection:se("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:pa,tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection})).tileJSON_=null,e.tileSize_=t.tileSize,t.url)if(t.jsonp)!function(t,e,r,n){var i=document.createElement("script"),o="olc_"+a(e);function s(){delete window[o],i.parentNode.removeChild(i)}i.async=!0,i.src=t+(-1==t.indexOf("?")?"?":"&")+(n||"callback")+"="+o;var u=setTimeout((function(){s(),r&&r()}),1e4);window[o]=function(t){clearTimeout(u),s(),e(t)},document.getElementsByTagName("head")[0].appendChild(i)}(t.url,e.handleTileJSONResponse.bind(t_(e)),e.handleTileJSONError.bind(t_(e)));else{var n=new XMLHttpRequest;n.addEventListener("load",e.onXHRLoad_.bind(t_(e))),n.addEventListener("error",e.onXHRError_.bind(t_(e))),n.open("GET",t.url),n.send()}else t.tileJSON?e.handleTileJSONResponse(t.tileJSON):gt(!1,51);return e}return e=o,(r=[{key:"onXHRLoad_",value:function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var r;try{r=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(r)}else this.handleTileJSONError()}},{key:"onXHRError_",value:function(t){this.handleTileJSONError()}},{key:"getTileJSON",value:function(){return this.tileJSON_}},{key:"handleTileJSONResponse",value:function(t){var e,r=se("EPSG:4326"),n=this.getProjection();if(void 0!==t.bounds){var i=pe(r,n);e=Ht(t.bounds,i)}var o=$h(n),a=t.minzoom||0,s=Hh({extent:o,maxZoom:t.maxzoom||22,minZoom:a,tileSize:this.tileSize_});if(this.tileGrid=s,this.tileUrlFunction=yp(t.tiles,s),void 0!==t.attribution&&!this.getAttributions()){var u=void 0!==e?e:o;this.setAttributions((function(e){return Zt(u,e.extent)?[t.attribution]:null}))}this.tileJSON_=t,this.setState(ya)}},{key:"handleTileJSONError",value:function(){this.setState(da)}}])&&Hb(e.prototype,r),n&&Hb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Ab);function n_(t){return(n_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o_(){return(o_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=a_(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function a_(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c_(t)););return t}function s_(t,e){return(s_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=c_(t);if(e){var i=c_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l_(this,r)}}function l_(t,e){if(e&&("object"===n_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c_(t){return(c_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f_(t){return(f_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p_(t,e){return(p_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=v_(t);if(e){var i=v_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d_(this,r)}}function d_(t,e){if(e&&("object"===f_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function v_(t){return(v_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p_(t,e)}(o,t);var e,r,n,i=y_(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,t)}return e=o,(r=[{key:"createRenderer",value:function(){return new Zc(this)}}])&&h_(e.prototype,r),n&&h_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s_(t,e)}(o,t);var e,r,n,i=u_(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=t||{},n=s({},r);return delete n.preload,delete n.useInterimTilesOnError,(e=i.call(this,n)).on,e.once,e.un,e.setPreload(void 0!==r.preload?r.preload:0),e.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),e}return e=o,(r=[{key:"getPreload",value:function(){return this.get(th)}},{key:"setPreload",value:function(t){this.set(th,t)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(eh)}},{key:"setUseInterimTilesOnError",value:function(t){this.set(eh,t)}},{key:"getData",value:function(t){return o_(c_(o.prototype),"getData",this).call(this,t)}}])&&i_(e.prototype,r),n&&i_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Oa));function m_(t){return(m_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function __(t,e){return(__=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=S_(t);if(e){var i=S_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return x_(this,r)}}function x_(t,e){if(e&&("object"===m_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return k_(t)}function k_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S_(t){return(S_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&__(t,e)}(o,t);var e,r,n,i=w_(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(k_(e)),e.animatingOrInteracting_,e.dirty_=!1,e.hitDetectionImageData_=null,e.renderedFeatures_=null,e.renderedRevision_=-1,e.renderedResolution_=NaN,e.renderedExtent_=[1/0,1/0,-1/0,-1/0],e.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],e.renderedRotation_,e.renderedCenter_=null,e.renderedProjection_=null,e.renderedRenderOrder_=null,e.replayGroup_=null,e.replayGroupChanged=!0,e.declutterExecutorGroup=null,e.clipping=!0,e}return e=o,(r=[{key:"renderWorlds",value:function(t,e,r){var n=e.extent,i=e.viewState,o=i.center,a=i.resolution,s=i.projection,u=i.rotation,l=s.getExtent(),c=this.getLayer().getSource(),f=e.pixelRatio,h=e.viewHints,p=!(h[Qc]||h[$c]),y=this.context,d=Math.round(e.size[0]*f),v=Math.round(e.size[1]*f),g=c.getWrapX()&&s.canWrapX(),m=g?Yt(l):null,b=g?Math.ceil((n[2]-l[2])/m)+1:1,_=g?Math.floor((n[0]-l[0])/m):0;do{var w=this.getRenderTransform(o,a,u,f,d,v,_*m);t.execute(y,1,w,u,p,void 0,r)}while(++_<b)}},{key:"renderDeclutter",value:function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)}},{key:"renderFrame",value:function(t,e){var r=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,r){an(t,e,0,0,r,0,0)}(this.pixelTransform,1/r,1/r),cn(this.inversePixelTransform,this.pixelTransform);var i=fn(this.pixelTransform);this.useContainer(e,i,n.opacity,this.getBackground(t));var o=this.context,a=o.canvas,s=this.replayGroup_,u=this.declutterExecutorGroup;if((!s||s.isEmpty())&&(!u||u.isEmpty()))return null;var l=Math.round(t.size[0]*r),c=Math.round(t.size[1]*r);a.width!=l||a.height!=c?(a.width=l,a.height=c,a.style.transform!==i&&(a.style.transform=i)):this.containerReused||o.clearRect(0,0,l,c),this.preRender(o,t);var f=t.viewState,h=f.projection,p=!1,y=!0;if(n.extent&&this.clipping){var d=Oe(n.extent,h);(p=(y=Zt(d,t.extent))&&!kt(d,t.extent))&&this.clipUnrotated(o,t,d)}y&&this.renderWorlds(s,t),p&&o.restore(),this.postRender(o,t);var v=$a(n.opacity),g=this.container;return v!==g.style.opacity&&(g.style.opacity=v),this.renderedRotation_!==f.rotation&&(this.renderedRotation_=f.rotation,this.hitDetectionImageData_=null),this.container}},{key:"getFeatures",value:function(t){return new Promise(function(e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];sn(this.pixelTransform,r);var n=this.renderedCenter_,i=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,s=this.wrappedRenderedExtent_,u=this.getLayer(),l=[],c=r[0]*If,f=r[1]*If;l.push(this.getRenderTransform(n,i,o,If,c,f,0).slice());var h=u.getSource(),p=a.getExtent();if(h.getWrapX()&&a.canWrapX()&&!kt(p,s)){for(var y,d=s[0],v=Yt(p),g=0;d<p[0];)y=v*--g,l.push(this.getRenderTransform(n,i,o,If,c,f,y).slice()),d+=v;for(g=0,d=s[2];d>p[2];)y=v*++g,l.push(this.getRenderTransform(n,i,o,If,c,f,y).slice()),d-=v}this.hitDetectionImageData_=Ff(r,l,this.renderedFeatures_,u.getStyleFunction(),s,i,o)}e(Df(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))}},{key:"forEachFeatureAtCoordinate",value:function(t,e,r,n,i){var o=this;if(this.replayGroup_){var s,u=e.viewState.resolution,l=e.viewState.rotation,c=this.getLayer(),f={},h=function(t,e,r){var o=a(t),s=f[o];if(s){if(!0!==s&&r<s.distanceSq){if(0===r)return f[o]=!0,i.splice(i.lastIndexOf(s),1),n(t,c,e);s.geometry=e,s.distanceSq=r}}else{if(0===r)return f[o]=!0,n(t,c,e);i.push(f[o]={feature:t,layer:c,geometry:e,distanceSq:r,callback:n})}},p=[this.replayGroup_];return this.declutterExecutorGroup&&p.push(this.declutterExecutorGroup),p.some((function(n){return s=n.forEachFeatureAtCoordinate(t,u,l,r,h,n===o.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((function(t){return t.value})):null)})),s}}},{key:"handleFontsChanged",value:function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}},{key:"handleStyleImageChange_",value:function(t){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(t){var e=this.getLayer(),r=e.getSource();if(!r)return!1;var n=t.viewHints[Qc],i=t.viewHints[$c],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(!this.dirty_&&!o&&n||!a&&i)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=t.extent,u=t.viewState,l=u.projection,c=u.resolution,f=t.pixelRatio,h=e.getRevision(),p=e.getRenderBuffer(),y=e.getRenderOrder();void 0===y&&(y=Lf);var d=u.center.slice(),v=bt(s,p*c),g=v.slice(),m=[v.slice()],b=l.getExtent();if(r.getWrapX()&&l.canWrapX()&&!kt(b,t.extent)){var _=Yt(b),w=Math.max(Yt(v)/2,_);v[0]=b[0]-w,v[2]=b[2]+w,$t(d,l);var x=function(t,e){var r=e.getExtent(),n=Gt(t);if(e.canWrapX()&&(n[0]<r[0]||n[0]>=r[2])){var i=Yt(r),o=Math.floor((n[0]-r[0])/i)*i;t[0]-=o,t[2]-=o}return t}(m[0],l);x[0]<b[0]&&x[2]<b[2]?m.push([x[0]+_,x[1],x[2]+_,x[3]]):x[0]>b[0]&&x[2]>b[2]&&m.push([x[0]-_,x[1],x[2]-_,x[3]])}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==h&&this.renderedRenderOrder_==y&&kt(this.wrappedRenderedExtent_,v))return rr(this.renderedExtent_,g)||(this.hitDetectionImageData_=null,this.renderedExtent_=g),this.renderedCenter_=d,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var k,S=new rl(Bf(c,f),v,c,f);this.getLayer().getDeclutter()&&(k=new rl(Bf(c,f),v,c,f));var O,R=we();if(R){for(var C=0,P=m.length;C<P;++C){var E=Se(m[C],l);r.loadFeatures(E,Re(c,l),R)}O=pe(R,l)}else for(var T=0,j=m.length;T<j;++T)r.loadFeatures(m[T],c,l);var M=zf(c,f),I=function(t){var r,n=t.getStyleFunction()||e.getStyleFunction();if(n&&(r=n(t,c)),r){var i=this.renderFeature(t,M,r,S,O,k);this.dirty_=this.dirty_||i}}.bind(this),F=Se(v,l),D=r.getFeaturesInExtent(F);y&&D.sort(y);for(var A=0,L=D.length;A<L;++A)I(D[A]);this.renderedFeatures_=D;var z=S.finish(),B=new Cl(v,c,f,r.getOverlaps(),z,e.getRenderBuffer());return k&&(this.declutterExecutorGroup=new Cl(v,c,f,r.getOverlaps(),k.finish(),e.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=h,this.renderedRenderOrder_=y,this.renderedExtent_=g,this.wrappedRenderedExtent_=v,this.renderedCenter_=d,this.renderedProjection_=l,this.replayGroup_=B,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}},{key:"renderFeature",value:function(t,e,r,n,i,o){if(!r)return!1;var a=!1;if(Array.isArray(r))for(var s=0,u=r.length;s<u;++s)a=Gf(n,t,r[s],e,this.boundHandleStyleImageChange_,i,o)||a;else a=Gf(n,t,r,e,this.boundHandleStyleImageChange_,i,o);return a}}])&&b_(e.prototype,r),n&&b_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(tc);function R_(t){return(R_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function P_(t,e){return(P_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=j_(t);if(e){var i=j_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return T_(this,r)}}function T_(t,e){if(e&&("object"===R_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function j_(t){return(j_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var M_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P_(t,e)}(o,t);var e,r,n,i=E_(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,t)}return e=o,(r=[{key:"createRenderer",value:function(){return new O_(this)}}])&&C_(e.prototype,r),n&&C_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}($s);function I_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var F_=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rbush_=new Ra(e),this.items_={}}var e,r,n;return e=t,(r=[{key:"insert",value:function(t,e){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(r),this.items_[a(e)]=r}},{key:"load",value:function(t,e){for(var r=new Array(e.length),n=0,i=e.length;n<i;n++){var o=t[n],s=e[n],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};r[n]=u,this.items_[a(s)]=u}this.rbush_.load(r)}},{key:"remove",value:function(t){var e=a(t),r=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(r)}},{key:"update",value:function(t,e){var r=this.items_[a(e)];jt([r.minX,r.minY,r.maxX,r.maxY],t)||(this.remove(e),this.insert(t,e))}},{key:"getAll",value:function(){return this.rbush_.all().map((function(t){return t.value}))}},{key:"getInExtent",value:function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}},{key:"forEach",value:function(t){return this.forEach_(this.getAll(),t)}},{key:"forEachInExtent",value:function(t,e){return this.forEach_(this.getInExtent(t),e)}},{key:"forEach_",value:function(t,e){for(var r,n=0,i=t.length;n<i;n++)if(r=e(t[n]))return r;return r}},{key:"isEmpty",value:function(){return c(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(t){var e=this.rbush_.toJSON();return Ct(e.minX,e.minY,e.maxX,e.maxY,t)}},{key:"concat",value:function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]}}])&&I_(e.prototype,r),n&&I_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),D_="addfeature",A_="changefeature",L_="clear",z_="removefeature",B_="featuresloadstart",G_="featuresloadend",N_="featuresloaderror";function W_(t,e){return[[-1/0,-1/0,1/0,1/0]]}function X_(t){return(X_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q_(){return(q_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=V_(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function V_(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$_(t)););return t}function K_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Y_(t,e,r){return e&&K_(t.prototype,e),r&&K_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Z_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U_(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H_(t,e)}function H_(t,e){return(H_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function J_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$_(t);if(e){var i=$_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Q_(this,r)}}function Q_(t,e){if(e&&("object"===X_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $_(t){return($_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tw=function(t){U_(r,t);var e=J_(r);function r(t,n,i){var o;return Z_(this,r),(o=e.call(this,t)).feature=n,o.features=i,o}return Y_(r)}(Ze),ew=function(t){U_(r,t);var e=J_(r);function r(t){var n;Z_(this,r);var i=t||{};(n=e.call(this,{attributions:i.attributions,interpolate:!0,projection:void 0,state:ya,wrapX:void 0===i.wrapX||i.wrapX})).on,n.once,n.un,n.loader_=or,n.format_=i.format,n.overlaps_=void 0===i.overlaps||i.overlaps,n.url_=i.url,void 0!==i.loader?n.loader_=i.loader:void 0!==n.url_&&(gt(n.format_,7),n.loader_=Dp(n.url_,n.format_)),n.strategy_=void 0!==i.strategy?i.strategy:W_;var o,a,s=void 0===i.useSpatialIndex||i.useSpatialIndex;return n.featuresRtree_=s?new F_:null,n.loadedExtentsRtree_=new F_,n.loadingExtentsCount_=0,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null,Array.isArray(i.features)?a=i.features:i.features&&(a=(o=i.features).getArray()),s||void 0!==o||(o=new nd(a)),void 0!==a&&n.addFeaturesInternal(a),void 0!==o&&n.bindFeaturesCollection_(o),n}return Y_(r,[{key:"addFeature",value:function(t){this.addFeatureInternal(t),this.changed()}},{key:"addFeatureInternal",value:function(t){var e=a(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var r=t.getGeometry();if(r){var n=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new tw(D_,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)}},{key:"setupChangeEvents_",value:function(t,e){this.featureChangeKeys_[t]=[Sr(e,pr,this.handleFeatureChange_,this),Sr(e,Ue,this.handleFeatureChange_,this)]}},{key:"addToIndex_",value:function(t,e){var r=!0,n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?r=!1:this.idIndex_[n.toString()]=e),r&&(gt(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),r}},{key:"addFeatures",value:function(t){this.addFeaturesInternal(t),this.changed()}},{key:"addFeaturesInternal",value:function(t){for(var e=[],r=[],n=[],i=0,o=t.length;i<o;i++){var s=t[i],u=a(s);this.addToIndex_(u,s)&&r.push(s)}for(var l=0,c=r.length;l<c;l++){var f=r[l],h=a(f);this.setupChangeEvents_(h,f);var p=f.getGeometry();if(p){var y=p.getExtent();e.push(y),n.push(f)}else this.nullGeometryFeatures_[h]=f}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(D_))for(var d=0,v=r.length;d<v;d++)this.dispatchEvent(new tw(D_,r[d]))}},{key:"bindFeaturesCollection_",value:function(t){var e=!1;this.addEventListener(D_,(function(r){e||(e=!0,t.push(r.feature),e=!1)})),this.addEventListener(z_,(function(r){e||(e=!0,t.remove(r.feature),e=!1)})),t.addEventListener(qy,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(Vy,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t}},{key:"clear",value:function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(Rr)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var r=function(t){this.removeFeatureInternal(t)}.bind(this);for(var n in this.featuresRtree_.forEach(r),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var i=new tw(L_);this.dispatchEvent(i),this.changed()}},{key:"forEachFeature",value:function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureAtCoordinateDirect",value:function(t,e){var r=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(r,(function(r){return r.getGeometry().intersectsCoordinate(t)?e(r):void 0}))}},{key:"forEachFeatureInExtent",value:function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureIntersectingExtent",value:function(t,e){return this.forEachFeatureInExtent(t,(function(r){if(r.getGeometry().intersectsExtent(t)){var n=e(r);if(n)return n}}))}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),c(this.nullGeometryFeatures_)||er(t,l(this.nullGeometryFeatures_))),t}},{key:"getFeaturesAtCoordinate",value:function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}},{key:"getFeaturesInExtent",value:function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}},{key:"getClosestFeatureToCoordinate",value:function(t,e){var r=t[0],n=t[1],i=null,o=[NaN,NaN],a=1/0,s=[-1/0,-1/0,1/0,1/0],u=e||nr;return this.featuresRtree_.forEachInExtent(s,(function(t){if(u(t)){var e=t.getGeometry(),l=a;if((a=e.closestPointXY(r,n,o,a))<l){i=t;var c=Math.sqrt(a);s[0]=r-c,s[1]=n-c,s[2]=r+c,s[3]=n+c}}})),i}},{key:"getExtent",value:function(t){return this.featuresRtree_.getExtent(t)}},{key:"getFeatureById",value:function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null}},{key:"getFeatureByUid",value:function(t){var e=this.uidIndex_[t];return void 0!==e?e:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(t){var e=t.target,r=a(e),n=e.getGeometry();if(n){var i=n.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(i,e)):this.featuresRtree_&&this.featuresRtree_.update(i,e)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[r]=e);var o=e.getId();if(void 0!==o){var s=o.toString();this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[r]=e;this.changed(),this.dispatchEvent(new tw(A_,e))}},{key:"hasFeature",value:function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:a(t)in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&c(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}},{key:"loadFeatures",value:function(t,e,r){for(var n=this,i=this.loadedExtentsRtree_,o=this.strategy_(t,e,r),a=function(t,a){var s=o[t];i.forEachInExtent(s,(function(t){return kt(t.extent,s)}))||(++n.loadingExtentsCount_,n.dispatchEvent(new tw(B_)),n.loader_.call(n,s,e,r,function(t){--this.loadingExtentsCount_,this.dispatchEvent(new tw(G_,void 0,t))}.bind(n),function(){--this.loadingExtentsCount_,this.dispatchEvent(new tw(N_))}.bind(n)),i.insert(s,{extent:s.slice()}))},s=0,u=o.length;s<u;++s)a(s);this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}},{key:"refresh",value:function(){this.clear(!0),this.loadedExtentsRtree_.clear(),q_($_(r.prototype),"refresh",this).call(this)}},{key:"removeLoadedExtent",value:function(t){var e,r=this.loadedExtentsRtree_;r.forEachInExtent(t,(function(r){if(jt(r.extent,t))return e=r,!0})),e&&r.remove(e)}},{key:"removeFeature",value:function(t){if(t){var e=a(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}}},{key:"removeFeatureInternal",value:function(t){var e=a(t),r=this.featureChangeKeys_[e];if(r){r.forEach(Rr),delete this.featureChangeKeys_[e];var n=t.getId();return void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new tw(z_,t)),t}}},{key:"removeFromIdIndex_",value:function(t){var e=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===t){delete this.idIndex_[r],e=!0;break}return e}},{key:"setLoader",value:function(t){this.loader_=t}},{key:"setUrl",value:function(t){gt(this.format_,7),this.url_=t,this.setLoader(Dp(t,this.format_))}}]),r}(qh);function rw(t){return(rw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nw(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var iw={338:function(t){function e(t,e){this.x=t,this.y=e}t.exports=e,e.prototype={clone:function(){return new e(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},e.convert=function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t}},946:function(t){function e(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n}t.exports=e,e.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},e.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},e.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},e.prototype.solveCurveX=function(t,e){var r,n,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?r=i:n=i,i=.5*(n-r)+r}return i},e.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},872:function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?n(parseFloat(t)/100*255):n(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.G=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in r)return r[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=i.indexOf("("),l=i.indexOf(")");if(-1!==u&&l+1===i.length){var c=i.substr(0,u),f=i.substr(u+1,l-(u+1)).split(","),h=1;switch(c){case"rgba":if(4!==f.length)return null;h=a(f.pop());case"rgb":return 3!==f.length?null:[o(f[0]),o(f[1]),o(f[2]),h];case"hsla":if(4!==f.length)return null;h=a(f.pop());case"hsl":if(3!==f.length)return null;var p=(parseFloat(f[0])%360+360)%360/360,y=a(f[1]),d=a(f[2]),v=d<=.5?d*(y+1):d+y-d*y,g=2*d-v;return[n(255*s(g,v,p+1/3)),n(255*s(g,v,p)),n(255*s(g,v,p-1/3)),h];default:return null}}return null}}catch(t){}},523:function(t){var e={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},r=" ",n=/(italic|oblique)$/i,i={};t.exports=function(t,o,a){var s=i[t];if(!s){Array.isArray(t)||(t=[t]);for(var u=400,l="normal",c=[],f=0,h=t.length;f<h;++f){var p=t[f].split(" "),y=p[p.length-1].toLowerCase();for(var d in"normal"==y||"italic"==y||"oblique"==y?(l=y,p.pop(),y=p[p.length-1].toLowerCase()):n.test(y)&&(y=y.replace(n,""),l=p[p.length-1].replace(y,"")),e){var v=p.length>1?p[p.length-2].toLowerCase():"";if(y==d||y==d.replace("-","")||v+"-"+y==d){u=e[d],p.pop(),v&&d.startsWith(v)&&p.pop();break}}"number"==typeof y&&(u=y);var g=p.join(r).replace("Klokantech Noto Sans","Noto Sans");-1!==g.indexOf(r)&&(g='"'+g+'"'),c.push(g)}s=i[t]=[l,u,c]}return s[0]+r+s[1]+r+o+"px"+(a?"/"+a:"")+r+s[2]}},619:function(t){t.exports=function t(r,n){if(!r){var i=new e(n);throw Error.captureStackTrace&&Error.captureStackTrace(i,t),i}};var e=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);e.prototype.name="AssertionError"},422:function(t){(function(){var e;t.exports={icon:"icons/google.svg",name:"google",title:"Google Fonts",link:"google.com/fonts",getNames:function(){return e},getLink:function(t){return"https://fonts.google.com/specimen/"+t.replace(/( )/g,"+")},normalizeName:function(t){return t}},e=["ABeeZee","Abel","Abril Fatface","Aclonica","Acme","Actor","Adamina","Advent Pro","Aguafina Script","Akronim","Aladin","Aldrich","Alef","Alegreya","Alegreya SC","Alegreya Sans","Alegreya Sans SC","Alex Brush","Alfa Slab One","Alice","Alike","Alike Angular","Allan","Allerta","Allerta Stencil","Allura","Almendra","Almendra Display","Almendra SC","Amarante","Amaranth","Amatic SC","Amethysta","Amiri","Amita","Anaheim","Andada","Andika","Angkor","Annie Use Your Telescope","Anonymous Pro","Antic","Antic Didone","Antic Slab","Anton","Arapey","Arbutus","Arbutus Slab","Architects Daughter","Archivo Black","Archivo Narrow","Arimo","Arizonia","Armata","Artifika","Arvo","Arya","Asap","Asar","Asset","Astloch","Asul","Atomic Age","Aubrey","Audiowide","Autour One","Average","Average Sans","Averia Gruesa Libre","Averia Libre","Averia Sans Libre","Averia Serif Libre","Bad Script","Balthazar","Bangers","Basic","Battambang","Baumans","Bayon","Belgrano","Belleza","BenchNine","Bentham","Berkshire Swash","Bevan","Bigelow Rules","Bigshot One","Bilbo","Bilbo Swash Caps","Biryani","Bitter","Black Ops One","Bokor","Bonbon","Boogaloo","Bowlby One","Bowlby One SC","Brawler","Bree Serif","Bubblegum Sans","Bubbler One","Buda","Buenard","Butcherman","Butterfly Kids","Cabin","Cabin Condensed","Cabin Sketch","Caesar Dressing","Cagliostro","Calligraffitti","Cambay","Cambo","Candal","Cantarell","Cantata One","Cantora One","Capriola","Cardo","Carme","Carrois Gothic","Carrois Gothic SC","Carter One","Catamaran","Caudex","Caveat","Caveat Brush","Cedarville Cursive","Ceviche One","Changa One","Chango","Chau Philomene One","Chela One","Chelsea Market","Chenla","Cherry Cream Soda","Cherry Swash","Chewy","Chicle","Chivo","Chonburi","Cinzel","Cinzel Decorative","Clicker Script","Coda","Coda Caption","Codystar","Combo","Comfortaa","Coming Soon","Concert One","Condiment","Content","Contrail One","Convergence","Cookie","Copse","Corben","Courgette","Cousine","Coustard","Covered By Your Grace","Crafty Girls","Creepster","Crete Round","Crimson Text","Croissant One","Crushed","Cuprum","Cutive","Cutive Mono","Damion","Dancing Script","Dangrek","Dawning of a New Day","Days One","Dekko","Delius","Delius Swash Caps","Delius Unicase","Della Respira","Denk One","Devonshire","Dhurjati","Didact Gothic","Diplomata","Diplomata SC","Domine","Donegal One","Doppio One","Dorsa","Dosis","Dr Sugiyama","Droid Sans","Droid Sans Mono","Droid Serif","Duru Sans","Dynalight","EB Garamond","Eagle Lake","Eater","Economica","Eczar","Ek Mukta","Electrolize","Elsie","Elsie Swash Caps","Emblema One","Emilys Candy","Engagement","Englebert","Enriqueta","Erica One","Esteban","Euphoria Script","Ewert","Exo","Exo 2","Expletus Sans","Fanwood Text","Fascinate","Fascinate Inline","Faster One","Fasthand","Fauna One","Federant","Federo","Felipa","Fenix","Finger Paint","Fira Mono","Fira Sans","Fjalla One","Fjord One","Flamenco","Flavors","Fondamento","Fontdiner Swanky","Forum","Francois One","Freckle Face","Fredericka the Great","Fredoka One","Freehand","Fresca","Frijole","Fruktur","Fugaz One","GFS Didot","GFS Neohellenic","Gabriela","Gafata","Galdeano","Galindo","Gentium Basic","Gentium Book Basic","Geo","Geostar","Geostar Fill","Germania One","Gidugu","Gilda Display","Give You Glory","Glass Antiqua","Glegoo","Gloria Hallelujah","Goblin One","Gochi Hand","Gorditas","Goudy Bookletter 1911","Graduate","Grand Hotel","Gravitas One","Great Vibes","Griffy","Gruppo","Gudea","Gurajada","Habibi","Halant","Hammersmith One","Hanalei","Hanalei Fill","Handlee","Hanuman","Happy Monkey","Headland One","Henny Penny","Herr Von Muellerhoff","Hind","Hind Siliguri","Hind Vadodara","Holtwood One SC","Homemade Apple","Homenaje","IM Fell DW Pica","IM Fell DW Pica SC","IM Fell Double Pica","IM Fell Double Pica SC","IM Fell English","IM Fell English SC","IM Fell French Canon","IM Fell French Canon SC","IM Fell Great Primer","IM Fell Great Primer SC","Iceberg","Iceland","Imprima","Inconsolata","Inder","Indie Flower","Inika","Inknut Antiqua","Irish Grover","Istok Web","Italiana","Italianno","Itim","Jacques Francois","Jacques Francois Shadow","Jaldi","Jim Nightshade","Jockey One","Jolly Lodger","Josefin Sans","Josefin Slab","Joti One","Judson","Julee","Julius Sans One","Junge","Jura","Just Another Hand","Just Me Again Down Here","Kadwa","Kalam","Kameron","Kantumruy","Karla","Karma","Kaushan Script","Kavoon","Kdam Thmor","Keania One","Kelly Slab","Kenia","Khand","Khmer","Khula","Kite One","Knewave","Kotta One","Koulen","Kranky","Kreon","Kristi","Krona One","Kurale","La Belle Aurore","Laila","Lakki Reddy","Lancelot","Lateef","Lato","League Script","Leckerli One","Ledger","Lekton","Lemon","Libre Baskerville","Life Savers","Lilita One","Lily Script One","Limelight","Linden Hill","Lobster","Lobster Two","Londrina Outline","Londrina Shadow","Londrina Sketch","Londrina Solid","Lora","Love Ya Like A Sister","Loved by the King","Lovers Quarrel","Luckiest Guy","Lusitana","Lustria","Macondo","Macondo Swash Caps","Magra","Maiden Orange","Mako","Mallanna","Mandali","Marcellus","Marcellus SC","Marck Script","Margarine","Marko One","Marmelad","Martel","Martel Sans","Marvel","Mate","Mate SC","Maven Pro","McLaren","Meddon","MedievalSharp","Medula One","Megrim","Meie Script","Merienda","Merienda One","Merriweather","Merriweather Sans","Metal","Metal Mania","Metamorphous","Metrophobic","Michroma","Milonga","Miltonian","Miltonian Tattoo","Miniver","Miss Fajardose","Modak","Modern Antiqua","Molengo","Molle","Monda","Monofett","Monoton","Monsieur La Doulaise","Montaga","Montez","Montserrat","Montserrat Alternates","Montserrat Subrayada","Moul","Moulpali","Mountains of Christmas","Mouse Memoirs","Mr Bedfort","Mr Dafoe","Mr De Haviland","Mrs Saint Delafield","Mrs Sheppards","Muli","Mystery Quest","NTR","Neucha","Neuton","New Rocker","News Cycle","Niconne","Nixie One","Nobile","Nokora","Norican","Nosifer","Nothing You Could Do","Noticia Text","Noto Sans","Noto Serif","Nova Cut","Nova Flat","Nova Mono","Nova Oval","Nova Round","Nova Script","Nova Slim","Nova Square","Numans","Nunito","Odor Mean Chey","Offside","Old Standard TT","Oldenburg","Oleo Script","Oleo Script Swash Caps","Open Sans","Open Sans Condensed","Oranienbaum","Orbitron","Oregano","Orienta","Original Surfer","Oswald","Over the Rainbow","Overlock","Overlock SC","Ovo","Oxygen","Oxygen Mono","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Pacifico","Palanquin","Palanquin Dark","Paprika","Parisienne","Passero One","Passion One","Pathway Gothic One","Patrick Hand","Patrick Hand SC","Patua One","Paytone One","Peddana","Peralta","Permanent Marker","Petit Formal Script","Petrona","Philosopher","Piedra","Pinyon Script","Pirata One","Plaster","Play","Playball","Playfair Display","Playfair Display SC","Podkova","Poiret One","Poller One","Poly","Pompiere","Pontano Sans","Poppins","Port Lligat Sans","Port Lligat Slab","Pragati Narrow","Prata","Preahvihear","Press Start 2P","Princess Sofia","Prociono","Prosto One","Puritan","Purple Purse","Quando","Quantico","Quattrocento","Quattrocento Sans","Questrial","Quicksand","Quintessential","Qwigley","Racing Sans One","Radley","Rajdhani","Raleway","Raleway Dots","Ramabhadra","Ramaraja","Rambla","Rammetto One","Ranchers","Rancho","Ranga","Rationale","Ravi Prakash","Redressed","Reenie Beanie","Revalia","Rhodium Libre","Ribeye","Ribeye Marrow","Righteous","Risque","Roboto","Roboto Condensed","Roboto Mono","Roboto Slab","Rochester","Rock Salt","Rokkitt","Romanesco","Ropa Sans","Rosario","Rosarivo","Rouge Script","Rozha One","Rubik","Rubik Mono One","Rubik One","Ruda","Rufina","Ruge Boogie","Ruluko","Rum Raisin","Ruslan Display","Russo One","Ruthie","Rye","Sacramento","Sahitya","Sail","Salsa","Sanchez","Sancreek","Sansita One","Sarala","Sarina","Sarpanch","Satisfy","Scada","Scheherazade","Schoolbell","Seaweed Script","Sevillana","Seymour One","Shadows Into Light","Shadows Into Light Two","Shanti","Share","Share Tech","Share Tech Mono","Shojumaru","Short Stack","Siemreap","Sigmar One","Signika","Signika Negative","Simonetta","Sintony","Sirin Stencil","Six Caps","Skranji","Slabo 13px","Slabo 27px","Slackey","Smokum","Smythe","Sniglet","Snippet","Snowburst One","Sofadi One","Sofia","Sonsie One","Sorts Mill Goudy","Source Code Pro","Source Sans Pro","Source Serif Pro","Special Elite","Spicy Rice","Spinnaker","Spirax","Squada One","Sree Krushnadevaraya","Stalemate","Stalinist One","Stardos Stencil","Stint Ultra Condensed","Stint Ultra Expanded","Stoke","Strait","Sue Ellen Francisco","Sumana","Sunshiney","Supermercado One","Sura","Suranna","Suravaram","Suwannaphum","Swanky and Moo Moo","Syncopate","Tangerine","Taprom","Tauri","Teko","Telex","Tenali Ramakrishna","Tenor Sans","Text Me One","The Girl Next Door","Tienne","Tillana","Timmana","Tinos","Titan One","Titillium Web","Trade Winds","Trocchi","Trochut","Trykker","Tulpen One","Ubuntu","Ubuntu Condensed","Ubuntu Mono","Ultra","Uncial Antiqua","Underdog","Unica One","UnifrakturCook","UnifrakturMaguntia","Unkempt","Unlock","Unna","VT323","Vampiro One","Varela","Varela Round","Vast Shadow","Vesper Libre","Vibur","Vidaloka","Viga","Voces","Volkhov","Vollkorn","Voltaire","Waiting for the Sunrise","Wallpoet","Walter Turncoat","Warnes","Wellfleet","Wendy One","Wire One","Work Sans","Yanone Kaffeesatz","Yantramanav","Yellowtail","Yeseva One","Yesteryear","Zeyada"]}).call(this)},840:function(t){t.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}}}},ow={};function aw(t){var e=ow[t];if(void 0!==e)return e.exports;var r=ow[t]={exports:{}};return iw[t].call(r.exports,r,r.exports,aw),r.exports}aw.d=function(t,e){for(var r in e)aw.o(e,r)&&!aw.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},aw.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},aw.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var sw={};!function(){var t,e;aw.d(sw,{nn:function(){return fi},h0:function(){return ti},bg:function(){return Hn},ZP:function(){return fi},gG:function(){return gi},Hs:function(){return pi},xb:function(){return yi},b5:function(){return di},YU:function(){return Fn},iC:function(){return En},LN:function(){return vi},uX:function(){return Dn}});var r={};aw.r(r),aw.d(r,{array:function(){return re},color:function(){return ee},number:function(){return te}});var n={};aw.r(n),aw.d(n,{hcl:function(){return _e},lab:function(){return be}});var i=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Ms}))),o=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Fs}))),a=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Mf}))),u=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return fo}))),l=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return As}))),c=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Xs}))),f=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Zp}))),h=aw(872),p=function(t,e,r,n){void 0===n&&(n=1),this.r=t,this.g=e,this.b=r,this.a=n};p.parse=function(t){if(t){if(t instanceof p)return t;if("string"==typeof t){var e=(0,h.G)(t);if(e)return new p(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},p.prototype.toString=function(){var t=this.toArray(),e=t[0],r=t[1],n=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(r)+","+Math.round(n)+","+i+")"},p.prototype.toArray=function(){var t=this,e=t.r,r=t.g,n=t.b,i=t.a;return 0===i?[0,0,0,0]:[255*e/i,255*r/i,255*n/i,i]},p.black=new p(0,0,0,1),p.white=new p(1,1,1,1),p.transparent=new p(0,0,0,0),p.red=new p(1,0,0,1),p.blue=new p(0,0,1,1);var y=p,d=aw(619),v=function(t,e){var r=t.stops;if(!r)return function(t,e){var r=["get",t.property];if(void 0===t.default)return"string"===e.type?["string",r]:r;if("enum"===e.type)return["match",r,Object.keys(e.values),r,t.default];var n=["color"===e.type?"to-color":e.type,r,g(t.default)];return"array"===e.type&&n.splice(1,0,e.value,e.length||null),n}(t,e);var n=r&&"object"===rw(r[0][0]),i=n||void 0!==t.property,o=n||!i;return r=r.map((function(t){return!i&&e.tokens&&"string"==typeof t[1]?[t[0],S(t[1])]:[t[0],g(t[1])]})),n?function(t,e,r){for(var n={},i={},o=[],a=0;a<r.length;a++){var s=r[a],u=s[0].zoom;void 0===n[u]&&(n[u]={zoom:u,type:t.type,property:t.property,default:t.default},i[u]=[],o.push(u)),i[u].push([s[0].value,s[1]])}if("exponential"===k({},e)){for(var l=[m(t),["linear"],["zoom"]],c=0,f=o;c<f.length;c+=1){var h=f[c];x(l,h,_(n[h],e,i[h]),!1)}return l}for(var p=["step",["zoom"]],y=0,d=o;y<d.length;y+=1){var v=d[y];x(p,v,_(n[v],e,i[v]),!0)}return w(p),p}(t,e,r):o?function(t,e,r,n){void 0===n&&(n=["zoom"]);var i,o=k(t,e),a=!1;if("interval"===o)i=["step",n],a=!0;else{if("exponential"!==o)throw new Error('Unknown zoom function type "'+o+'"');var s=void 0!==t.base?t.base:1;i=[m(t),1===s?["linear"]:["exponential",s],n]}for(var u=0,l=r;u<l.length;u+=1){var c=l[u];x(i,c[0],c[1],a)}return w(i),i}(t,e,r):_(t,e,r)};function g(t){return"object"===rw(t)?["literal",t]:t}function m(t){switch(t.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function b(t,e){var r,n,i=g((r=t.default,n=e.default,void 0!==r?r:void 0!==n?n:void 0));return void 0===i&&"resolvedImage"===e.type?"":i}function _(t,e,r){var n=k(t,e),i=["get",t.property];if("categorical"===n&&"boolean"==typeof r[0][0]){d(t.stops.length>0&&t.stops.length<=2);for(var o=["case"],a=0,s=r;a<s.length;a+=1){var u=s[a];o.push(["==",i,u[0]],u[1])}return o.push(b(t,e)),o}if("categorical"===n){for(var l=["match",i],c=0,f=r;c<f.length;c+=1){var h=f[c];x(l,h[0],h[1],!1)}return l.push(b(t,e)),l}if("interval"===n){for(var p=["step",["number",i]],y=0,v=r;y<v.length;y+=1){var _=v[y];x(p,_[0],_[1],!0)}return w(p),void 0===t.default?p:["case",["==",["typeof",i],"number"],p,g(t.default)]}if("exponential"===n){for(var S=void 0!==t.base?t.base:1,O=[m(t),1===S?["linear"]:["exponential",S],["number",i]],R=0,C=r;R<C.length;R+=1){var P=C[R];x(O,P[0],P[1],!1)}return void 0===t.default?O:["case",["==",["typeof",i],"number"],O,g(t.default)]}throw new Error("Unknown property function type "+n)}function w(t){"step"===t[0]&&3===t.length&&(t.push(0),t.push(t[3]))}function x(t,e,r,n){t.length>3&&e===t[t.length-2]||(n&&2===t.length||t.push(e),t.push(r))}function k(t,e){return t.type?t.type:(d(e.expression),e.expression.interpolated?"exponential":"interval")}function S(t){for(var e=["concat"],r=/{([^{}]+)}/g,n=0,i=r.exec(t);null!==i;i=r.exec(t)){var o=t.slice(n,r.lastIndex-i[0].length);n=r.lastIndex,o.length>0&&e.push(o),e.push(["get",i[1]])}if(1===e.length)return t;if(n<t.length)e.push(t.slice(n));else if(2===e.length)return["to-string",e[1]];return e}function O(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var a in o)t[a]=o[a]}return t}var R=function(t){function e(e,r){t.call(this,r),this.message=r,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),C=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,n=e;r<n.length;r+=1){var i=n[r],o=i[0],a=i[1];this.bindings[o]=a}};C.prototype.concat=function(t){return new C(this,t)},C.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},C.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var P=C,E={kind:"null"},T={kind:"number"},j={kind:"string"},M={kind:"boolean"},I={kind:"color"},F={kind:"object"},D={kind:"value"},A={kind:"collator"},L={kind:"formatted"},z={kind:"resolvedImage"};function B(t,e){return{kind:"array",itemType:t,N:e}}function G(t){if("array"===t.kind){var e=G(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var N=[E,T,j,M,I,L,F,B(D),z];function W(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!W(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,n=N;r<n.length;r+=1){if(!W(n[r],e))return null}}return"Expected "+G(t)+" but found "+G(e)+" instead."}function X(t,e){return e.some((function(e){return e.kind===t.kind}))}function q(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"===rw(t):e===rw(t)}))}var V=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};V.prototype.compare=function(t,e){return this.collator.compare(t,e)},V.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var K=V,Y=function(t,e,r,n,i){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=r,this.fontStack=n,this.textColor=i},Z=function(t){this.sections=t};Z.fromString=function(t){return new Z([new Y(t,null,null,null,null)])},Z.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},Z.factory=function(t){return t instanceof Z?t:Z.fromString(t)},Z.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},Z.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];if(n.image)t.push(["image",n.image.name]);else{t.push(n.text);var i={};n.fontStack&&(i["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(i["font-scale"]=n.scale),n.textColor&&(i["text-color"]=["rgba"].concat(n.textColor.toArray())),t.push(i)}}return t};var U=Z,H=function(t){this.name=t.name,this.available=t.available};H.prototype.toString=function(){return this.name},H.fromString=function(t){return t?new H({name:t,available:!1}):null},H.prototype.serialize=function(){return["image",this.name]};var J=H;function Q(t,e,r,n){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[t,e,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function $(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof y)return!0;if(t instanceof K)return!0;if(t instanceof U)return!0;if(t instanceof J)return!0;if(Array.isArray(t)){for(var e=0,r=t;e<r.length;e+=1){if(!$(r[e]))return!1}return!0}if("object"===rw(t)){for(var n in t)if(!$(t[n]))return!1;return!0}return!1}function tt(t){if(null===t)return E;if("string"==typeof t)return j;if("boolean"==typeof t)return M;if("number"==typeof t)return T;if(t instanceof y)return I;if(t instanceof K)return A;if(t instanceof U)return L;if(t instanceof J)return z;if(Array.isArray(t)){for(var e,r=t.length,n=0,i=t;n<i.length;n+=1){var o=tt(i[n]);if(e){if(e===o)continue;e=D;break}e=o}return B(e||D,r)}return d("object"===rw(t)),F}function et(t){var e=rw(t);return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof y||t instanceof U||t instanceof J?t.toString():JSON.stringify(t)}var rt=function(t,e){this.type=t,this.value=e};rt.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!$(t[1]))return e.error("invalid value");var r=t[1],n=tt(r),i=e.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new rt(n,r)},rt.prototype.evaluate=function(){return this.value},rt.prototype.eachChild=function(){},rt.prototype.outputDefined=function(){return!0},rt.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof y?["rgba"].concat(this.value.toArray()):this.value instanceof U?this.value.serialize():(d(null===this.value||"string"==typeof this.value||"number"==typeof this.value||"boolean"==typeof this.value),this.value)};var nt=rt,it=function(t){this.name="ExpressionEvaluationError",this.message=t};it.prototype.toJSON=function(){return this.message};var ot=it,at={string:j,number:T,boolean:M,object:F},st=function(t,e){this.type=t,this.args=e};st.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,n=1,i=t[0];if("array"===i){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in at)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=at[s],n++}else o=D;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],n++}r=B(o,a)}else d(at[i],i),r=at[i];for(var u=[];n<t.length;n++){var l=e.parse(t[n],n,D);if(!l)return null;u.push(l)}return new st(r,u)},st.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!W(this.type,tt(r)))return r;if(e===this.args.length-1)throw new ot("Expected value to be of type "+G(this.type)+", but found "+G(tt(r))+" instead.")}return d(!1),null},st.prototype.eachChild=function(t){this.args.forEach(t)},st.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},st.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);var n=t.N;("number"==typeof n||this.args.length>1)&&e.push(n)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var ut=st,lt=function(t){this.type=L,this.sections=t};lt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[1];if(!Array.isArray(r)&&"object"===rw(r))return e.error("First argument must be an image or text section.");for(var n=[],i=!1,o=1;o<=t.length-1;++o){var a=t[o];if(i&&"object"===rw(a)&&!Array.isArray(a)){i=!1;var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,T)))return null;var u=null;if(a["text-font"]&&!(u=e.parse(a["text-font"],1,B(j))))return null;var l=null;if(a["text-color"]&&!(l=e.parse(a["text-color"],1,I)))return null;var c=n[n.length-1];c.scale=s,c.font=u,c.textColor=l}else{var f=e.parse(t[o],1,D);if(!f)return null;var h=f.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:f,scale:null,font:null,textColor:null})}}return new lt(n)},lt.prototype.evaluate=function(t){return new U(this.sections.map((function(e){var r=e.content.evaluate(t);return tt(r)===z?new Y("",r,null,null,null):new Y(et(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},lt.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor)}},lt.prototype.outputDefined=function(){return!1},lt.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var n=r[e];t.push(n.content.serialize());var i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),n.textColor&&(i["text-color"]=n.textColor.serialize()),t.push(i)}return t};var ct=lt,ft=function(t){this.type=z,this.input=t};ft.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,j);return r?new ft(r):e.error("No image name provided.")},ft.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=J.fromString(e);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(e)>-1),r},ft.prototype.eachChild=function(t){t(this.input)},ft.prototype.outputDefined=function(){return!1},ft.prototype.serialize=function(){return["image",this.input.serialize()]};var ht=ft,pt={"to-boolean":M,"to-color":I,"to-number":T,"to-string":j},yt=function(t,e){this.type=t,this.args=e};yt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if(d(pt[r],r),("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");for(var n=pt[r],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,D);if(!a)return null;i.push(a)}return new yt(n,i)},yt.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,r,n=0,i=this.args;n<i.length;n+=1){if(r=null,(e=i[n].evaluate(t))instanceof y)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":Q(e[0],e[1],e[2],e[3])))return new y(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ot(r||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(t)))return 0;var l=Number(a);if(!isNaN(l))return l}throw new ot("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?U.fromString(et(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?J.fromString(et(this.args[0].evaluate(t))):et(this.args[0].evaluate(t))},yt.prototype.eachChild=function(t){this.args.forEach(t)},yt.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},yt.prototype.serialize=function(){if("formatted"===this.type.kind)return new ct([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ht(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var dt=yt,vt=["Unknown","Point","LineString","Polygon"],gt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null};gt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},gt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?vt[this.feature.type]:this.feature.type:null},gt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},gt.prototype.canonicalID=function(){return this.canonical},gt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},gt.prototype.distanceFromCenter=function(){if(this.featureTileCoord&&this.featureDistanceData){var t=this.featureDistanceData.center,e=this.featureDistanceData.scale,r=this.featureTileCoord,n=r.x,i=r.y,o=n*e-t[0],a=i*e-t[1];return this.featureDistanceData.bearing[0]*o+this.featureDistanceData.bearing[1]*a}return 0},gt.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=y.parse(t)),e};var mt=gt,bt=function(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n};bt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},bt.prototype.eachChild=function(t){this.args.forEach(t)},bt.prototype.outputDefined=function(){return!1},bt.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},bt.parse=function(t,e){var r,n=t[0],i=bt.definitions[n];if(!i)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter((function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1})),u=null,l=0,c=s;l<c.length;l+=1){var f=c[l],h=f[0],p=f[1];u=new Zt(e.registry,e.path,null,e.scope);for(var y=[],v=!1,g=1;g<t.length;g++){var m=t[g],b=Array.isArray(h)?h[g-1]:h.type,_=u.parse(m,1+y.length,b);if(!_){v=!0;break}y.push(_)}if(!v)if(Array.isArray(h)&&h.length!==y.length)u.error("Expected "+h.length+" arguments, but found "+y.length+" instead.");else{for(var w=0;w<y.length;w++){var x=Array.isArray(h)?h[w]:h.type,k=y[w];u.concat(w+1).checkSubtype(x,k.type)}if(0===u.errors.length)return new bt(n,o,p,y)}}if(d(!u||u.errors.length>0),1===s.length)(r=e.errors).push.apply(r,u.errors);else{for(var S=(s.length?s:a).map((function(t){var e,r=t[0];return e=r,Array.isArray(e)?"("+e.map(G).join(", ")+")":"("+G(e.type)+"...)"})).join(" | "),O=[],R=1;R<t.length;R++){var C=e.parse(t[R],1+O.length);if(!C)return null;O.push(G(C.type))}e.error("Expected arguments of type "+S+", but found ("+O.join(", ")+") instead.")}return null},bt.register=function(t,e){for(var r in d(!bt.definitions),bt.definitions=e,e)t[r]=bt};var _t=bt,wt=function(t,e,r){this.type=A,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};wt.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!==rw(r)||Array.isArray(r))return e.error("Collator options argument must be an object.");var n=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,M);if(!n)return null;var i=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,M);if(!i)return null;var o=null;return r.locale&&!(o=e.parse(r.locale,1,j))?null:new wt(n,i,o)},wt.prototype.evaluate=function(t){return new K(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},wt.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},wt.prototype.outputDefined=function(){return!1},wt.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var xt=wt,kt=(aw(338),8192);function St(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Ot(t,e){return!(t[0]<=e[0])&&(!(t[2]>=e[2])&&(!(t[1]<=e[1])&&!(t[3]>=e[3])))}function Rt(t,e){var r,n=(180+t[0])/360,i=(r=t[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360),o=Math.pow(2,e.z);return[Math.round(n*o*kt),Math.round(i*o*kt)]}function Ct(t,e,r){var n=t[0]-e[0],i=t[1]-e[1],o=t[0]-r[0],a=t[1]-r[1];return n*a-o*i==0&&n*o<=0&&i*a<=0}function Pt(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function Et(t,e){for(var r=!1,n=0,i=e.length;n<i;n++)for(var o=e[n],a=0,s=o.length;a<s-1;a++){if(Ct(t,o[a],o[a+1]))return!1;Pt(t,o[a],o[a+1])&&(r=!r)}return r}function Tt(t,e){for(var r=0;r<e.length;r++)if(Et(t,e[r]))return!0;return!1}function jt(t,e,r,n){var i=t[0]-r[0],o=t[1]-r[1],a=e[0]-r[0],s=e[1]-r[1],u=n[0]-r[0],l=n[1]-r[1],c=i*l-u*o,f=a*l-u*s;return c>0&&f<0||c<0&&f>0}function Mt(t,e,r){for(var n=0,i=r;n<i.length;n+=1)for(var o=i[n],a=0;a<o.length-1;++a)if(s=t,u=e,l=o[a],c=o[a+1],f=void 0,h=void 0,p=void 0,y=void 0,p=[u[0]-s[0],u[1]-s[1]],y=[c[0]-l[0],c[1]-l[1]],0!=(f=y)[0]*(h=p)[1]-f[1]*h[0]&&jt(s,u,l,c)&&jt(l,c,s,u))return!0;var s,u,l,c,f,h,p,y;return!1}function It(t,e){for(var r=0;r<t.length;++r)if(!Et(t[r],e))return!1;for(var n=0;n<t.length-1;++n)if(Mt(t[n],t[n+1],e))return!1;return!0}function Ft(t,e){for(var r=0;r<e.length;r++)if(It(t,e[r]))return!0;return!1}function Dt(t,e,r){for(var n=[],i=0;i<t.length;i++){for(var o=[],a=0;a<t[i].length;a++){var s=Rt(t[i][a],r);St(e,s),o.push(s)}n.push(o)}return n}function At(t,e,r){for(var n=[],i=0;i<t.length;i++){var o=Dt(t[i],e,r);n.push(o)}return n}function Lt(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){var i=.5*n,o=t[0]-r[0]>i?-n:r[0]-t[0]>i?n:0;0===o&&(o=t[0]-r[2]>i?-n:r[2]-t[0]>i?n:0),t[0]+=o}St(e,t)}function zt(t,e,r,n){for(var i=Math.pow(2,n.z)*kt,o=[n.x*kt,n.y*kt],a=[],s=0,u=t;s<u.length;s+=1)for(var l=0,c=u[s];l<c.length;l+=1){var f=c[l],h=[f.x+o[0],f.y+o[1]];Lt(h,e,r,i),a.push(h)}return a}function Bt(t,e,r,n){for(var i=Math.pow(2,n.z)*kt,o=[n.x*kt,n.y*kt],a=[],s=0,u=t;s<u.length;s+=1){for(var l=[],c=0,f=u[s];c<f.length;c+=1){var h=f[c],p=[h.x+o[0],h.y+o[1]];St(e,p),l.push(p)}a.push(l)}if(e[2]-e[0]<=i/2){!function(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}(e);for(var y=0,d=a;y<d.length;y+=1)for(var v=0,g=d[y];v<g.length;v+=1){Lt(g[v],e,r,i)}}return a}var Gt=function(t,e){this.type=M,this.geojson=t,this.geometries=e};Gt.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if($(t[1])){var r=t[1];if("FeatureCollection"===r.type)for(var n=0;n<r.features.length;++n){var i=r.features[n].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Gt(r,r.features[n].geometry)}else if("Feature"===r.type){var o=r.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new Gt(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Gt(r,r)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Gt.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=Dt(e.coordinates,n,i),a=zt(t.geometry(),r,n,i);if(!Ot(r,n))return!1;for(var s=0,u=a;s<u.length;s+=1)if(!Et(u[s],o))return!1}if("MultiPolygon"===e.type){var l=At(e.coordinates,n,i),c=zt(t.geometry(),r,n,i);if(!Ot(r,n))return!1;for(var f=0,h=c;f<h.length;f+=1)if(!Tt(h[f],l))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var o=Dt(e.coordinates,n,i),a=Bt(t.geometry(),r,n,i);if(!Ot(r,n))return!1;for(var s=0,u=a;s<u.length;s+=1)if(!It(u[s],o))return!1}if("MultiPolygon"===e.type){var l=At(e.coordinates,n,i),c=Bt(t.geometry(),r,n,i);if(!Ot(r,n))return!1;for(var f=0,h=c;f<h.length;f+=1)if(!Ft(h[f],l))return!1}return!0}(t,this.geometries)}return!1},Gt.prototype.eachChild=function(){},Gt.prototype.outputDefined=function(){return!0},Gt.prototype.serialize=function(){return["within",this.geojson]};var Nt=Gt;function Wt(t){if(t instanceof _t){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Nt)return!1;var e=!0;return t.eachChild((function(t){e&&!Wt(t)&&(e=!1)})),e}function Xt(t){if(t instanceof _t&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Xt(t)&&(e=!1)})),e}function qt(t,e){if(t instanceof _t&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild((function(t){r&&!qt(t,e)&&(r=!1)})),r}var Vt=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Vt.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new Vt(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Vt.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Vt.prototype.eachChild=function(){},Vt.prototype.outputDefined=function(){return!1},Vt.prototype.serialize=function(){return["var",this.name]};var Kt=Vt,Yt=function(t,e,r,n,i){void 0===e&&(e=[]),void 0===n&&(n=new P),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=n,this.errors=i,this.expectedType=r};Yt.prototype.parse=function(t,e,r,n,i){return void 0===i&&(i={}),e?this.concat(e,r,n)._parse(t,i):this._parse(t,i)},Yt.prototype._parse=function(t,e){function r(t,e,r){return"assert"===r?new ut(e,[t]):"coerce"===r?new dt(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=t[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+rw(n)+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[n];if(i){var o=i.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=r(o,a,e.typeAnnotation||"coerce");else o=r(o,a,e.typeAnnotation||"assert")}if(!(o instanceof nt)&&"resolvedImage"!==o.type.kind&&Ut(o)){var u=new mt;try{o=new nt(o.type,o.evaluate(u))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"===rw(t)?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+rw(t)+" instead.")},Yt.prototype.concat=function(t,e,r){var n="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new Yt(this.registry,n,e||null,i,this.errors)},Yt.prototype.error=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var n=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new R(n,t))},Yt.prototype.checkSubtype=function(t,e){var r=W(t,e);return r&&this.error(r),r};var Zt=Yt;function Ut(t){if(t instanceof Kt)return Ut(t.boundExpression);if(t instanceof _t&&"error"===t.name)return!1;if(t instanceof xt)return!1;if(t instanceof Nt)return!1;var e=t instanceof dt||t instanceof ut,r=!0;return t.eachChild((function(t){r=e?r&&Ut(t):r&&t instanceof nt})),!!r&&(Wt(t)&&qt(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]))}function Ht(t,e){for(var r,n,i=t.length-1,o=0,a=i,s=0;o<=a;)if(r=t[s=Math.floor((o+a)/2)],n=t[s+1],r<=e){if(s===i||e<n)return s;o=s+1}else{if(!(r>e))throw new ot("Input is not a number.");a=s-1}return 0}var Jt=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var o=i[n],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};Jt.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var r=e.parse(t[1],1,T);if(!r)return null;var n=[],i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],u=o,l=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(n.length&&n[n.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var c=e.parse(s,l,i);if(!c)return null;i=i||c.type,n.push([a,c])}return new Jt(i,r,n)},Jt.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);var i=e.length;return n>=e[i-1]?r[i-1].evaluate(t):r[Ht(e,n)].evaluate(t)},Jt.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},Jt.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},Jt.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Qt=Jt,$t=aw(946);function te(t,e,r){return t*(1-r)+e*r}function ee(t,e,r){return new y(te(t.r,e.r,r),te(t.g,e.g,r),te(t.b,e.b,r),te(t.a,e.a,r))}function re(t,e,r){return t.map((function(t,n){return te(t,e[n],r)}))}var ne=.95047,ie=1.08883,oe=4/29,ae=6/29,se=3*ae*ae,ue=Math.PI/180,le=180/Math.PI;function ce(t){return t>.008856451679035631?Math.pow(t,1/3):t/se+oe}function pe(t){return t>ae?t*t*t:se*(t-oe)}function ye(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function de(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ve(t){var e=de(t.r),r=de(t.g),n=de(t.b),i=ce((.4124564*e+.3575761*r+.1804375*n)/ne),o=ce((.2126729*e+.7151522*r+.072175*n)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-ce((.0193339*e+.119192*r+.9503041*n)/ie)),alpha:t.a}}function ge(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=1*pe(e),r=ne*pe(r),n=ie*pe(n),new y(ye(3.2404542*r-1.5371385*e-.4985314*n),ye(-.969266*r+1.8760108*e+.041556*n),ye(.0556434*r-.2040259*e+1.0572252*n),t.alpha)}function me(t,e,r){var n=e-t;return t+r*(n>180||n<-180?n-360*Math.round(n/360):n)}var be={forward:ve,reverse:ge,interpolate:function(t,e,r){return{l:te(t.l,e.l,r),a:te(t.a,e.a,r),b:te(t.b,e.b,r),alpha:te(t.alpha,e.alpha,r)}}},_e={forward:function(t){var e=ve(t),r=e.l,n=e.a,i=e.b,o=Math.atan2(i,n)*le;return{h:o<0?o+360:o,c:Math.sqrt(n*n+i*i),l:r,alpha:t.a}},reverse:function(t){var e=t.h*ue,r=t.c;return ge({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:me(t.h,e.h,r),c:te(t.c,e.c,r),l:te(t.l,e.l,r),alpha:te(t.alpha,e.alpha,r)}}},xe=function(t,e,r,n,i){this.type=t,this.operator=e,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],l=s[1];this.labels.push(u),this.outputs.push(l)}};function ke(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}xe.interpolationFactor=function(t,e,r,n){var i=0;if("exponential"===t.name)i=ke(e,t.base,r,n);else if("linear"===t.name)i=ke(e,1,r,n);else if("cubic-bezier"===t.name){var o=t.controlPoints;i=new $t(o[0],o[1],o[2],o[3]).solve(ke(e,1,r,n))}return i},xe.parse=function(t,e){var r=t[0],n=t[1],i=t[2],o=t.slice(3);if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var a=n[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:a}}else{if("cubic-bezier"!==n[0])return e.error("Unknown interpolation type "+String(n[0]),1,0);var s=n.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,T)))return null;var u=[],l=null;"interpolate-hcl"===r||"interpolate-lab"===r?l=I:e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var c=0;c<o.length;c+=2){var f=o[c],h=o[c+1],p=c+3,y=c+4;if("number"!=typeof f)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(u.length&&u[u.length-1][0]>=f)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var d=e.parse(h,y,l);if(!d)return null;l=l||d.type,u.push([f,d])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new xe(l,r,n,i,u):e.error("Type "+G(l)+" is not interpolatable.")},xe.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var o=e.length;if(i>=e[o-1])return n[o-1].evaluate(t);var a=Ht(e,i),s=e[a],u=e[a+1],l=xe.interpolationFactor(this.interpolation,i,s,u),c=n[a].evaluate(t),f=n[a+1].evaluate(t);return"interpolate"===this.operator?r[this.type.kind.toLowerCase()](c,f,l):"interpolate-hcl"===this.operator?_e.reverse(_e.interpolate(_e.forward(c),_e.forward(f),l)):be.reverse(be.interpolate(be.forward(c),be.forward(f),l))},xe.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1){t(r[e])}},xe.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},xe.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var Se=xe,Oe=function(t,e){this.type=t,this.args=e};Oe.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,n=e.expectedType;n&&"value"!==n.kind&&(r=n);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],u=e.parse(s,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!u)return null;r=r||u.type,i.push(u)}d(r);var l=n&&i.some((function(t){return W(n,t.type)}));return new Oe(l?D:r,i)},Oe.prototype.evaluate=function(t){for(var e,r=null,n=0,i=0,o=this.args;i<o.length;i+=1){if(n++,(r=o[i].evaluate(t))&&r instanceof J&&!r.available&&(e||(e=r),r=null,n===this.args.length))return e;if(null!==r)break}return r},Oe.prototype.eachChild=function(t){this.args.forEach(t)},Oe.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},Oe.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var Re=Oe,Ce=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Ce.prototype.evaluate=function(t){return this.result.evaluate(t)},Ce.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1){t(r[e][1])}t(this.result)},Ce.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],n=1;n<t.length-1;n+=2){var i=t[n];if("string"!=typeof i)return e.error("Expected string, but found "+rw(i)+" instead.",n);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);var o=e.parse(t[n+1],n+1);if(!o)return null;r.push([i,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return a?new Ce(r,a):null},Ce.prototype.outputDefined=function(){return this.result.outputDefined()},Ce.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t};var Pe=Ce,Ee=function(t,e,r){this.type=t,this.index=e,this.input=r};Ee.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,T),n=e.parse(t[2],2,B(e.expectedType||D));if(!r||!n)return null;var i=n.type;return new Ee(i.itemType,r,n)},Ee.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new ot("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new ot("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new ot("Array index must be an integer, but found "+e+" instead.");return r[e]},Ee.prototype.eachChild=function(t){t(this.index),t(this.input)},Ee.prototype.outputDefined=function(){return!1},Ee.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Te=Ee,je=function(t,e){this.type=M,this.needle=t,this.haystack=e};je.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,D),n=e.parse(t[2],2,D);return r&&n?X(r.type,[M,j,T,E,D])?new je(r,n):e.error("Expected first argument to be of type boolean, string, number or null, but found "+G(r.type)+" instead"):null},je.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return!1;if(!q(e,["boolean","string","number","null"]))throw new ot("Expected first argument to be of type boolean, string, number or null, but found "+G(tt(e))+" instead.");if(!q(r,["string","array"]))throw new ot("Expected second argument to be of type array or string, but found "+G(tt(r))+" instead.");return r.indexOf(e)>=0},je.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},je.prototype.outputDefined=function(){return!0},je.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Me=je,Ie=function(t,e,r){this.type=T,this.needle=t,this.haystack=e,this.fromIndex=r};Ie.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,D),n=e.parse(t[2],2,D);if(!r||!n)return null;if(!X(r.type,[M,j,T,E,D]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+G(r.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,T);return i?new Ie(r,n,i):null}return new Ie(r,n)},Ie.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!q(e,["boolean","string","number","null"]))throw new ot("Expected first argument to be of type boolean, string, number or null, but found "+G(tt(e))+" instead.");if(!q(r,["string","array"]))throw new ot("Expected second argument to be of type array or string, but found "+G(tt(r))+" instead.");if(this.fromIndex){var n=this.fromIndex.evaluate(t);return r.indexOf(e,n)}return r.indexOf(e)},Ie.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},Ie.prototype.outputDefined=function(){return!1},Ie.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Fe=Ie,De=function(t,e,r,n,i,o){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o};De.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],u=t[a+1];Array.isArray(s)||(s=[s]);var l=e.concat(a);if(0===s.length)return l.error("Expected at least one branch label.");for(var c=0,f=s;c<f.length;c+=1){var h=f[c];if("number"!=typeof h&&"string"!=typeof h)return l.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return l.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return l.error("Numeric branch labels must be integer values.");if(r){if(l.checkSubtype(r,tt(h)))return null}else r=tt(h);if(void 0!==i[String(h)])return l.error("Branch labels must be unique.");i[String(h)]=o.length}var p=e.parse(u,a,n);if(!p)return null;n=n||p.type,o.push(p)}var y=e.parse(t[1],1,D);if(!y)return null;var v=e.parse(t[t.length-1],t.length-1,n);return v?(d(r&&n),"value"!==y.type.kind&&e.concat(1).checkSubtype(r,y.type)?null:new De(r,n,y,i,o,v)):null},De.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(tt(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},De.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},De.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},De.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],n={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i];void 0===(f=n[this.cases[a]])?(n[this.cases[a]]=r.length,r.push([this.cases[a],[a]])):r[f][1].push(a)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,l=r;u<l.length;u+=1){var c=l[u],f=c[0],h=c[1];1===h.length?e.push(s(h[0])):e.push(h.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var Ae=De,Le=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};Le.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var n=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,M);if(!o)return null;var a=e.parse(t[i+1],i+1,r);if(!a)return null;n.push([o,a]),r=r||a.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?(d(r),new Le(r,n,s)):null},Le.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},Le.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var n=r[e],i=n[0],o=n[1];t(i),t(o)}t(this.otherwise)},Le.prototype.outputDefined=function(){return this.branches.every((function(t){t[0];return t[1].outputDefined()}))&&this.otherwise.outputDefined()},Le.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var ze=Le,Be=function(t,e,r,n){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=n};Be.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,D),n=e.parse(t[2],2,T);if(!r||!n)return null;if(!X(r.type,[B(D),j,D]))return e.error("Expected first argument to be of type array or string, but found "+G(r.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,T);return i?new Be(r.type,r,n,i):null}return new Be(r.type,r,n)},Be.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!q(e,["string","array"]))throw new ot("Expected first argument to be of type array or string, but found "+G(tt(e))+" instead.");if(this.endIndex){var n=this.endIndex.evaluate(t);return e.slice(r,n)}return e.slice(r)},Be.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Be.prototype.outputDefined=function(){return!1},Be.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ge=Be;function Ne(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function We(t,e,r,n){return 0===n.compare(e,r)}function Xe(t,e,r){var n="=="!==t&&"!="!==t;return function(){function i(t,e,r){this.type=M,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var r=t[0],o=e.parse(t[1],1,D);if(!o)return null;if(!Ne(r,o.type))return e.concat(1).error('"'+r+"\" comparisons are not supported for type '"+G(o.type)+"'.");var a=e.parse(t[2],2,D);if(!a)return null;if(!Ne(r,a.type))return e.concat(2).error('"'+r+"\" comparisons are not supported for type '"+G(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+G(o.type)+"' and '"+G(a.type)+"'.");n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new ut(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new ut(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,A)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){var s=tt(o),u=tt(a);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new ot('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var l=tt(o),c=tt(a);if("string"!==l.kind||"string"!==c.kind)return e(i,o,a)}return this.collator?r(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},i}()}var qe=Xe("==",(function(t,e,r){return e===r}),We),Ve=Xe("!=",(function(t,e,r){return e!==r}),(function(t,e,r,n){return!We(0,e,r,n)})),Ke=Xe("<",(function(t,e,r){return e<r}),(function(t,e,r,n){return n.compare(e,r)<0})),Ye=Xe(">",(function(t,e,r){return e>r}),(function(t,e,r,n){return n.compare(e,r)>0})),Ze=Xe("<=",(function(t,e,r){return e<=r}),(function(t,e,r,n){return n.compare(e,r)<=0})),Ue=Xe(">=",(function(t,e,r){return e>=r}),(function(t,e,r,n){return n.compare(e,r)>=0})),He=function(t,e,r,n,i){this.type=j,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i};He.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,T);if(!r)return null;var n=t[2];if("object"!==rw(n)||Array.isArray(n))return e.error("NumberFormat options argument must be an object.");var i=null;if(n.locale&&!(i=e.parse(n.locale,1,j)))return null;var o=null;if(n.currency&&!(o=e.parse(n.currency,1,j)))return null;var a=null;if(n["min-fraction-digits"]&&!(a=e.parse(n["min-fraction-digits"],1,T)))return null;var s=null;return n["max-fraction-digits"]&&!(s=e.parse(n["max-fraction-digits"],1,T))?null:new He(r,i,o,a,s)},He.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},He.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},He.prototype.outputDefined=function(){return!1},He.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Je=He,Qe=function(t){this.type=T,this.input=t};Qe.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+G(r.type)+" instead."):new Qe(r):null},Qe.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ot("Expected value to be of type string or array, but found "+G(tt(e))+" instead.")},Qe.prototype.eachChild=function(t){t(this.input)},Qe.prototype.outputDefined=function(){return!1},Qe.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var $e={"==":qe,"!=":Ve,">":Ye,"<":Ke,">=":Ue,"<=":Ze,array:ut,at:Te,boolean:ut,case:ze,coalesce:Re,collator:xt,format:ct,image:ht,in:Me,"index-of":Fe,interpolate:Se,"interpolate-hcl":Se,"interpolate-lab":Se,length:Qe,let:Pe,literal:nt,match:Ae,number:ut,"number-format":Je,object:ut,slice:Ge,step:Qt,string:ut,"to-boolean":dt,"to-color":dt,"to-number":dt,"to-string":dt,var:Kt,within:Nt};function tr(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];r=r.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=Q(r,n,i,a);if(s)throw new ot(s);return new y(r/255*a,n/255*a,i/255*a,a)}function er(t,e){return t in e}function rr(t,e){var r=e[t];return void 0===r?null:r}function nr(t){return{type:t}}_t.register($e,{error:[{kind:"error"},[j],function(t,e){var r=e[0];throw new ot(r.evaluate(t))}],typeof:[j,[D],function(t,e){return G(tt(e[0].evaluate(t)))}],"to-rgba":[B(T,4),[I],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[I,[T,T,T],tr],rgba:[I,[T,T,T,T],tr],has:{type:M,overloads:[[[j],function(t,e){return er(e[0].evaluate(t),t.properties())}],[[j,F],function(t,e){var r=e[0],n=e[1];return er(r.evaluate(t),n.evaluate(t))}]]},get:{type:D,overloads:[[[j],function(t,e){return rr(e[0].evaluate(t),t.properties())}],[[j,F],function(t,e){var r=e[0],n=e[1];return rr(r.evaluate(t),n.evaluate(t))}]]},"feature-state":[D,[j],function(t,e){return rr(e[0].evaluate(t),t.featureState||{})}],properties:[F,[],function(t){return t.properties()}],"geometry-type":[j,[],function(t){return t.geometryType()}],id:[D,[],function(t){return t.id()}],zoom:[T,[],function(t){return t.globals.zoom}],pitch:[T,[],function(t){return t.globals.pitch||0}],"distance-from-center":[T,[],function(t){return t.distanceFromCenter()}],"heatmap-density":[T,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[T,[],function(t){return t.globals.lineProgress||0}],"sky-radial-progress":[T,[],function(t){return t.globals.skyRadialProgress||0}],accumulated:[D,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[T,nr(T),function(t,e){for(var r=0,n=0,i=e;n<i.length;n+=1){r+=i[n].evaluate(t)}return r}],"*":[T,nr(T),function(t,e){for(var r=1,n=0,i=e;n<i.length;n+=1){r*=i[n].evaluate(t)}return r}],"-":{type:T,overloads:[[[T,T],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)-n.evaluate(t)}],[[T],function(t,e){return-e[0].evaluate(t)}]]},"/":[T,[T,T],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)/n.evaluate(t)}],"%":[T,[T,T],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)%n.evaluate(t)}],ln2:[T,[],function(){return Math.LN2}],pi:[T,[],function(){return Math.PI}],e:[T,[],function(){return Math.E}],"^":[T,[T,T],function(t,e){var r=e[0],n=e[1];return Math.pow(r.evaluate(t),n.evaluate(t))}],sqrt:[T,[T],function(t,e){var r=e[0];return Math.sqrt(r.evaluate(t))}],log10:[T,[T],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN10}],ln:[T,[T],function(t,e){var r=e[0];return Math.log(r.evaluate(t))}],log2:[T,[T],function(t,e){var r=e[0];return Math.log(r.evaluate(t))/Math.LN2}],sin:[T,[T],function(t,e){var r=e[0];return Math.sin(r.evaluate(t))}],cos:[T,[T],function(t,e){var r=e[0];return Math.cos(r.evaluate(t))}],tan:[T,[T],function(t,e){var r=e[0];return Math.tan(r.evaluate(t))}],asin:[T,[T],function(t,e){var r=e[0];return Math.asin(r.evaluate(t))}],acos:[T,[T],function(t,e){var r=e[0];return Math.acos(r.evaluate(t))}],atan:[T,[T],function(t,e){var r=e[0];return Math.atan(r.evaluate(t))}],min:[T,nr(T),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[T,nr(T),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[T,[T],function(t,e){var r=e[0];return Math.abs(r.evaluate(t))}],round:[T,[T],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[T,[T],function(t,e){var r=e[0];return Math.floor(r.evaluate(t))}],ceil:[T,[T],function(t,e){var r=e[0];return Math.ceil(r.evaluate(t))}],"filter-==":[M,[j,D],function(t,e){var r=e[0],n=e[1];return t.properties()[r.value]===n.value}],"filter-id-==":[M,[D],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[M,[j],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[M,[j,D],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return rw(i)===rw(o)&&i<o}],"filter-id-<":[M,[D],function(t,e){var r=e[0],n=t.id(),i=r.value;return rw(n)===rw(i)&&n<i}],"filter->":[M,[j,D],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return rw(i)===rw(o)&&i>o}],"filter-id->":[M,[D],function(t,e){var r=e[0],n=t.id(),i=r.value;return rw(n)===rw(i)&&n>i}],"filter-<=":[M,[j,D],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return rw(i)===rw(o)&&i<=o}],"filter-id-<=":[M,[D],function(t,e){var r=e[0],n=t.id(),i=r.value;return rw(n)===rw(i)&&n<=i}],"filter->=":[M,[j,D],function(t,e){var r=e[0],n=e[1],i=t.properties()[r.value],o=n.value;return rw(i)===rw(o)&&i>=o}],"filter-id->=":[M,[D],function(t,e){var r=e[0],n=t.id(),i=r.value;return rw(n)===rw(i)&&n>=i}],"filter-has":[M,[D],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[M,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[M,[B(j)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[M,[B(D)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[M,[j,B(D)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[M,[j,B(D)],function(t,e){var r=e[0],n=e[1];return function(t,e,r,n){for(;r<=n;){var i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}(t.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:M,overloads:[[[M,M],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)&&n.evaluate(t)}],[nr(M),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(!n[r].evaluate(t))return!1}return!0}]]},any:{type:M,overloads:[[[M,M],function(t,e){var r=e[0],n=e[1];return r.evaluate(t)||n.evaluate(t)}],[nr(M),function(t,e){for(var r=0,n=e;r<n.length;r+=1){if(n[r].evaluate(t))return!0}return!1}]]},"!":[M,[M],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[M,[j],function(t,e){var r=e[0],n=t.globals&&t.globals.isSupportedScript;return!n||n(r.evaluate(t))}],upcase:[j,[j],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[j,[j],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[j,nr(D),function(t,e){return e.map((function(e){return et(e.evaluate(t))})).join("")}],"resolved-locale":[j,[A],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var ir=$e;function or(t){return{result:"success",value:t}}function ar(t){return{result:"error",value:t}}function sr(t){return!!t.expression&&t.expression.interpolated}function ur(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":rw(t)}function lr(t){return"object"===rw(t)&&null!==t&&!Array.isArray(t)}function cr(t){return t}function fr(t,e){var r,i,o,a="color"===e.type,s=t.stops&&"object"===rw(t.stops[0][0]),u=s||void 0!==t.property,l=s||!u,c=t.type||(sr(e)?"exponential":"interval");if(a&&((t=O({},t)).stops&&(t.stops=t.stops.map((function(t){return[t[0],y.parse(t[1])]}))),t.default?t.default=y.parse(t.default):t.default=y.parse(e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!n[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);if("exponential"===c)r=dr;else if("interval"===c)r=yr;else if("categorical"===c){r=pr,i=Object.create(null);for(var f=0,h=t.stops;f<h.length;f+=1){var p=h[f];i[p[0]]=p[1]}o=rw(t.stops[0][0])}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');r=vr}if(s){for(var d={},v=[],g=0;g<t.stops.length;g++){var m=t.stops[g],b=m[0].zoom;void 0===d[b]&&(d[b]={zoom:b,type:t.type,property:t.property,default:t.default,stops:[]},v.push(b)),d[b].stops.push([m[0].value,m[1]])}for(var _=[],w=0,x=v;w<x.length;w+=1){var k=x[w];_.push([d[k].zoom,fr(d[k],e)])}var S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:Se.interpolationFactor.bind(void 0,S),zoomStops:_.map((function(t){return t[0]})),evaluate:function(r,n){var i=r.zoom;return dr({stops:_,base:t.base},e,i).evaluate(i,n)}}}if(l){var R="exponential"===c?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Se.interpolationFactor.bind(void 0,R),zoomStops:t.stops.map((function(t){return t[0]})),evaluate:function(n){var a=n.zoom;return r(t,e,a,i,o)}}}return{kind:"source",evaluate:function(n,a){var s=a&&a.properties?a.properties[t.property]:void 0;return void 0===s?hr(t.default,e.default):r(t,e,s,i,o)}}}function hr(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function pr(t,e,r,n,i){return hr(rw(r)===i?n[r]:void 0,t.default,e.default)}function yr(t,e,r){if("number"!==ur(r))return hr(t.default,e.default);var n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];var i=Ht(t.stops.map((function(t){return t[0]})),r);return t.stops[i][1]}function dr(t,e,i){var o=void 0!==t.base?t.base:1;if("number"!==ur(i))return hr(t.default,e.default);var a=t.stops.length;if(1===a)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[a-1][0])return t.stops[a-1][1];var s=Ht(t.stops.map((function(t){return t[0]})),i),u=function(t,e,r,n){var i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(i,o,t.stops[s][0],t.stops[s+1][0]),l=t.stops[s][1],c=t.stops[s+1][1],f=r[e.type]||cr;if(t.colorSpace&&"rgb"!==t.colorSpace){var h=n[t.colorSpace];f=function(t,e){return h.reverse(h.interpolate(h.forward(t),h.forward(e),u))}}return"function"==typeof l.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=l.evaluate.apply(void 0,t),n=c.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return f(r,n,u)}}:f(l,c,u)}function vr(t,e,r){return"color"===e.type?r=y.parse(r):"formatted"===e.type?r=U.fromString(r.toString()):"resolvedImage"===e.type?r=J.fromString(r.toString()):ur(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),hr(r,t.default,e.default)}var gr=function(t,e){var r;this.expression=t,this._warningHistory={},this._evaluator=new mt,this._defaultValue=e?"color"===(r=e).type&&lr(r.default)?new y(0,0,0,0):"color"===r.type?y.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function mr(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in ir}function br(t,e){var r=new Zt(ir,[],e?function(t){var e={color:I,string:j,number:T,enum:j,boolean:M,formatted:L,resolvedImage:z};if("array"===t.type)return B(e[t.value]||D,t.length);return e[t.type]}(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?or(new gr(n,e)):(d(r.errors.length>0),ar(r.errors))}gr.prototype.evaluateWithoutErrorHandling=function(t,e,r,n,i,o,a,s){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)},gr.prototype.evaluate=function(t,e,r,n,i,o,a,s){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null;try{var u=this.expression.evaluate(this._evaluator);if(null==u||"number"==typeof u&&u!=u)return this._defaultValue;if(this._enumValues&&!(u in this._enumValues))throw new ot("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(u)+" instead.");return u}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var _r=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Xt(e.expression)};_r.prototype.evaluateWithoutErrorHandling=function(t,e,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,o)},_r.prototype.evaluate=function(t,e,r,n,i,o){return this._styleExpression.evaluate(t,e,r,n,i,o)};var wr=function(t,e,r,n){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Xt(e.expression),this.interpolationType=n};function xr(t,e){if("error"===(t=br(t,e)).result)return t;var r,n=t.value.expression,i=Wt(n);if(!i&&("data-driven"!==(r=e)["property-type"]&&"cross-faded-data-driven"!==r["property-type"]))return ar([new R("","data expressions not supported")]);var o=qt(n,["zoom","pitch","distance-from-center"]);if(!o&&!function(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}(e))return ar([new R("","zoom expressions not supported")]);var a=Sr(n);if(!a&&!o)return ar([new R("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof R)return ar([a]);if(a instanceof Se&&!sr(e))return ar([new R("",'"interpolate" expressions cannot be used with this property')]);if(!a)return or(new _r(i?"constant":"source",t.value));var s=a instanceof Se?a.interpolation:void 0;return or(new wr(i?"camera":"composite",t.value,a.labels,s))}wr.prototype.evaluateWithoutErrorHandling=function(t,e,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,o)},wr.prototype.evaluate=function(t,e,r,n,i,o){return this._styleExpression.evaluate(t,e,r,n,i,o)},wr.prototype.interpolationFactor=function(t,e,r){return this.interpolationType?Se.interpolationFactor(this.interpolationType,t,e,r):0};var kr=function(t,e){this._parameters=t,this._specification=e,O(this,fr(this._parameters,this._specification))};function Sr(t){var e=null;if(t instanceof Pe)e=Sr(t.result);else if(t instanceof Re)for(var r=0,n=t.args;r<n.length;r+=1){var i=n[r];if(e=Sr(i))break}else(t instanceof Qt||t instanceof Se)&&t.input instanceof _t&&"zoom"===t.input.name&&(e=t);return e instanceof R||t.eachChild((function(t){var r=Sr(t);r instanceof R?e=r:!e&&r?e=new R("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new R("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Or(t){if(Array.isArray(t))return t.map(Or);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var r in t)e[r]=Or(t[r]);return e}return function(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}(t)}kr.deserialize=function(t){return new kr(t._parameters,t._specification)},kr.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Rr=aw(840),Cr=Rr,Pr=function(t,e){void 0===e&&(e="fill");if(null==t)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};Er(t)||(t=Ar(t));var r=t,n=!0;try{n=function(t){if(!Mr(t))return t;var e=Or(t);return jr(e),e=Tr(e)}(r)}catch(t){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n"+JSON.stringify(r,null,2)+"\n        ")}var i=Cr["filter_"+e],o=br(n,i),a=null;if("error"===o.result)throw new Error(o.value.map((function(t){return t.key+": "+t.message})).join(", "));a=function(t,e,r){return o.value.evaluate(t,e,{},r)};var s=null,u=null;if(n!==r){var l=br(r,i);if("error"===l.result)throw new Error(l.value.map((function(t){return t.key+": "+t.message})).join(", "));s=function(t,e,r,n,i){return l.value.evaluate(t,e,{},r,void 0,void 0,n,i)},u=!Wt(l.value.expression)}a=a;var c=Dr(n);return{filter:a,dynamicFilter:s||void 0,needGeometry:c,needFeature:!!u}};function Er(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var n=r[e];if(!Er(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}function Tr(t){if(!Array.isArray(t))return t;var e=function(t){if(Ir.has(t[0]))for(var e=1;e<t.length;e++){if(Mr(t[e]))return!0}return t}(t);return!0===e?e:e.map((function(t){return Tr(t)}))}function jr(t){var e=!1,r=[];if("case"===t[0]){for(var n=1;n<t.length-1;n+=2)e=e||Mr(t[n]),r.push(t[n+1]);r.push(t[t.length-1])}else if("match"===t[0]){e=e||Mr(t[1]);for(var i=2;i<t.length-1;i+=2)r.push(t[i+1]);r.push(t[t.length-1])}else if("step"===t[0]){e=e||Mr(t[1]);for(var o=1;o<t.length-1;o+=2)r.push(t[o+1])}e&&(t.length=0,t.push.apply(t,["any"].concat(r)));for(var a=1;a<t.length;a++)jr(t[a])}function Mr(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;for(var e,r=1;r<t.length;r++){if(Mr(t[r]))return!0}return!1}var Ir=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Fr(t,e){return t<e?-1:t>e?1:0}function Dr(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(var e=1;e<t.length;e++)if(Dr(t[e]))return!0;return!1}function Ar(t){if(!t)return!0;var e,r=t[0];return t.length<=1?"any"!==r:"=="===r?Lr(t[1],t[2],"=="):"!="===r?Gr(Lr(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Lr(t[1],t[2],r):"any"===r?(e=t.slice(1),["any"].concat(e.map(Ar))):"all"===r?["all"].concat(t.slice(1).map(Ar)):"none"===r?["all"].concat(t.slice(1).map(Ar).map(Gr)):"in"===r?zr(t[1],t.slice(2)):"!in"===r?Gr(zr(t[1],t.slice(2))):"has"===r?Br(t[1]):"!has"===r?Gr(Br(t[1])):"within"!==r||t}function Lr(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function zr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return rw(t)!==rw(e[0])}))?["filter-in-large",t,["literal",e.sort(Fr)]]:["filter-in-small",t,["literal",e]]}}function Br(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Gr(t){return["!",t]}var Nr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Wr(t,e){var r={};for(var n in t)"ref"!==n&&(r[n]=t[n]);return Nr.forEach((function(t){t in e&&(r[t]=e[t])})),r}var Xr=function(t){t=t.slice();for(var e=Object.create(null),r=0;r<t.length;r++)e[t[r].id]=t[r];for(var n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Wr(t[n],e[t[n].ref]));return t};var qr=aw(523),Vr=aw(422),Kr=function(t){var e={};return aw.d(e,t),e}(nw({},"assign",(function(){return s}))),Yr="https://api.mapbox.com";function Zr(t){var e="mapbox://";return 0!==t.indexOf(e)?"":t.slice(e.length)}function Ur(t,e){var r=Zr(t);if(!r)return decodeURI(new URL(t,location.href).href);var n="styles/";if(0!==r.indexOf(n))throw new Error("unexpected style url: "+t);var i=r.slice(n.length);return Yr+"/styles/v1/"+i+"?&access_token="+e}function Hr(t,e,r,n){var i=new URL(t,n),o=Zr(t);return o?"https://{a-d}.tiles.mapbox.com/v4/"+o+"/{z}/{x}/{y}.vector.pbf?access_token="+e:e?(i.searchParams.set(r,e),decodeURI(i.href)):decodeURI(i.href)}function Jr(t){return t*Math.PI/180}var Qr=function(){for(var t=[],e=78271.51696402048;t.length<=24;e/=2)t.push(e);return t}();function $r(t,e){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(t,e);var r=document.createElement("canvas");return r.width=t,r.height=e,r}var tn={};function en(t,e,r){if(void 0===r&&(r={}),e in tn)return tn[e];var n=r.transformRequest&&r.transformRequest(e,t)||new Request(e);n.headers.get("Accept")||n.headers.set("Accept","application/json");var i=fetch(n).then((function(t){return delete tn[e],t.ok?t.json():Promise.reject(new Error("Error fetching source "+e))})).catch((function(t){return delete tn[e],Promise.reject(new Error("Error fetching source "+e))}));return tn[e]=i,i}function rn(t,e){if("string"!=typeof t)return Promise.resolve(t);if(!t.trim().startsWith("{"))return en("Style",t=Ur(t,e.accessToken),e);try{var r=JSON.parse(t);return Promise.resolve(r)}catch(t){return Promise.reject(t)}}var nn={};function on(t,e,r){void 0===r&&(r={});var n=[e,JSON.stringify(t)].toString(),i=nn[n];if(!i||r.transformRequest){var o=t.url;if(o){var a=Hr(o,r.accessToken,r.accessTokenParam||"access_token",e||location.href);i=o.startsWith("mapbox://")?Promise.resolve((0,Kr.assign)({},t,{url:void 0,tiles:a})):en("Source",a,r).then((function(t){for(var e=0,n=t.tiles.length;e<n;++e){var i=Hr(t.tiles[e],r.accessToken,r.accessTokenParam||"access_token",a||location.href);if(r.transformRequest){var o=r.transformRequest(i,"Tiles");o instanceof Request&&(i=decodeURI(o.url))}t.tiles[e]=i}return Promise.resolve(t)}))}else t=(0,Kr.assign)({},t,{tiles:t.tiles.map((function(t){return Hr(t,r.accessToken,r.accessTokenParam||"access_token",e||location.href)}))}),i=Promise.resolve((0,Kr.assign)({},t));r.transformRequest||(nn[n]=i)}return i}var an,sn=Array(256).join(" ");function un(t,e){if(e>=.05){for(var r="",n=t.split("\n"),i=sn.slice(0,Math.round(e/.1)),o=0,a=n.length;o<a;++o)o>0&&(r+="\n"),r+=n[o].split("").join(i);return r}return t}function ln(){return an||(an=$r(1,1).getContext("2d")),an}function cn(t,e){return ln().measureText(t).width+(t.length-1)*e}var fn={};function hn(t,e,r,n){if(-1!==t.indexOf("\n")){for(var i=t.split("\n"),o=[],a=0,s=i.length;a<s;++a)o.push(hn(i[a],e,r,n));return o.join("\n")}var u=r+","+e+","+t+","+n,l=fn[u];if(!l){var c=t.split(" ");if(c.length>1){var f=ln();f.font=e;for(var h=f.measureText("M").width*r,p="",y=[],d=0,v=c.length;d<v;++d){var g=c[d],m=p+(p?" ":"")+g;cn(m,n)<=h?p=m:(p&&y.push(p),p=g)}p&&y.push(p);for(var b=0,_=y.length;b<_&&_>1;++b){var w=y[b];if(cn(w,n)<.35*h){var x=b>0?cn(y[b-1],n):1/0,k=b<_-1?cn(y[b+1],n):1/0;y.splice(b,1),_-=1,x<k?(y[b-1]+=" "+w,b-=1):y[b]=w+" "+y[b]}}for(var S=0,O=y.length-1;S<O;++S){var R=y[S],C=y[S+1];if(cn(R,n)>.7*h&&cn(C,n)<.6*h){var P=R.split(" "),E=P.pop();cn(E,n)<.2*h&&(y[S]=P.join(" "),y[S+1]=E+" "+C),O-=1}}l=y.join("\n")}else l=t;l=un(l,n),fn[u]=l}return l}var pn,yn=/font-family: ?([^;]*);/,dn=/("|')/g;function vn(t){if(!pn){pn={};for(var e=document.styleSheets,r=0,n=e.length;r<n;++r){var i=e[r];try{var o=i.rules||i.cssRules;if(o)for(var a=0,s=o.length;a<s;++a){var u=o[a];if(5==u.type){var l=u.cssText.match(yn);pn[l[1].replace(dn,"")]=!0}}}catch(t){}}}return t in pn}var gn={},mn=Vr.getNames();function bn(t){var e=t.toString();if(e in gn)return t;for(var r=t.map((function(t){var e=qr(t,1).split(" ");return[e.slice(3).join(" ").replace(/"/g,""),e[1]+e[0]]})),n=0,i=r.length;n<i;++n){var o=r[n],a=o[0];if(!vn(a)&&-1!==mn.indexOf(a)){var s="https://fonts.googleapis.com/css?family="+a.replace(/ /g,"+")+":"+o[1];if(!document.querySelector('link[href="'+s+'"]')){var u=document.createElement("link");u.href=s,u.rel="stylesheet",document.head.appendChild(u)}}}return gn[e]=!0,t}var _n,wn,xn={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},kn={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},Sn={},On={zoom:0};function Rn(t,e,r,n,i,o,a){var s=t.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[s]||(o[s]={});var u=o[s];if(!u[r]){var l=(t[e]||Sn)[r],c=Rr[e+"_"+t.type][r];void 0===l&&(l=c.default);var f=mr(l);if(!f&&lr(l)&&(l=v(l,c),f=!0),f){var h=function(t,e){var r=xr(t,e);if("error"===r.result)throw new Error(r.value.map((function(t){return t.key+": "+t.message})).join(", "));return r.value}(l,c);u[r]=h.evaluate.bind(h)}else"color"==c.type&&(l=y.parse(l)),u[r]=function(){return l}}return On.zoom=n,u[r](On,i,a)}function Cn(t,e,r,n,i){return i||console.warn("No filterCache provided to evaluateFilter()"),t in i||(i[t]=Pr(e).filter),On.zoom=n,i[t](On,r)}var Pn=!1;function En(t){Pn=t}function Tn(t,e){if(t){if(!Pn&&(0===t.a||0===e))return;var r=t.a;return e=void 0===e?1:e,0===r?"transparent":"rgba("+Math.round(255*t.r/r)+","+Math.round(255*t.g/r)+","+Math.round(255*t.b/r)+","+r*e+")"}return t}var jn=/^([^]*)\{(.*)\}([^]*)$/;function Mn(t,e){var r;do{if(r=t.match(jn)){var n=e[r[2]]||"";t=r[1]+n+r[3]}}while(r);return t}var In=!1;function Fn(t){void 0===t&&(t=!1),In=t}function Dn(t,e,r,n,s,h,p){if(void 0===n&&(n=Qr),void 0===s&&(s=void 0),void 0===h&&(h=void 0),void 0===p&&(p=void 0),"string"==typeof e&&(e=JSON.parse(e)),8!=e.version)throw new Error("glStyle version 8 required.");var y,d;if(h)if("undefined"!=typeof Image){var v=new Image;v.crossOrigin="anonymous",v.onload=function(){y=v,d=[v.width,v.height],t.changed(),v.onload=null},v.src=h}else if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var g=self;g.postMessage({action:"loadImage",src:h}),g.addEventListener("message",(function(t){"imageLoaded"===t.data.action&&t.data.src===h&&(y=t.data.image,d=[y.width,y.height])}))}for(var m,b=Xr(e.layers),_={},w=[],x={},k={},S={},O={},R=0,C=b.length;R<C;++R){var P=b[R],E=P.id;if("string"==typeof r&&P.source==r||-1!==r.indexOf(E)){var T=P["source-layer"];if(m){if(P.source!==m)throw new Error('Layer "'+E+'" does not use source "'+m)}else{m=P.source;var j=e.sources[m];if(!j)throw new Error('Source "'+m+'" is not defined');var M=j.type;if("vector"!==M&&"geojson"!==M)throw new Error('Source "'+m+'" is not of type "vector" or "geojson", but "'+M+'"')}var I=_[T];I||(I=[],_[T]=I),I.push({layer:P,index:R}),w.push(E)}}var F=new l.default,D=new o.default,A=[],L=function(e,r){var h=e.getProperties(),v=_[h.layer];if(v){var g=n.indexOf(r);-1==g&&(g=function(t,e){for(var r=0,n=e.length;r<n;++r)if(e[r]<t&&r+1<n){var i=e[r]/e[r+1];return r+Math.log(e[r]/t)/Math.log(i)}return n-1}(r,n));for(var m,b=xn[e.getGeometry().getType()],w={properties:h,type:b},R=t.get("mapbox-featurestate")[e.getId()],C=-1,P=0,E=v.length;P<E;++P){var T=v[P],j=T.layer,M=j.id,I=j.layout||Sn,L=j.paint||Sn;if(!("none"===I.visibility||"minzoom"in j&&g<j.minzoom||"maxzoom"in j&&g>=j.maxzoom)){var z=j.filter;if(!z||Cn(M,z,w,g,O)){m=j;var B=void 0,G=void 0,N=void 0,W=void 0,X=void 0,q=void 0,V=T.index;if(3==b&&("fill"==j.type||"fill-extrusion"==j.type))if(G=Rn(j,"paint",j.type+"-opacity",g,w,S,R),j.type+"-pattern"in L){var K=Rn(j,"paint",j.type+"-pattern",g,w,S,R);if(K){var Y="string"==typeof K?Mn(K,h):K.toString();if(y&&s&&s[Y]){++C,(q=A[C])&&q.getFill()&&!q.getStroke()&&!q.getText()||(q=new c.default({fill:new o.default}),A[C]=q),N=q.getFill(),q.setZIndex(V);var Z=Y+"."+G,U=k[Z];if(!U){var H=s[Y],J=$r(H.width,H.height),Q=J.getContext("2d");Q.globalAlpha=G,Q.drawImage(y,H.x,H.y,H.width,H.height,0,0,H.width,H.height),U=Q.createPattern(J,"repeat"),k[Z]=U}N.setColor(U)}}}else B=Tn(Rn(j,"paint",j.type+"-color",g,w,S,R),G),j.type+"-outline-color"in L&&(X=Tn(Rn(j,"paint",j.type+"-outline-color",g,w,S,R),G)),X||(X=B),(B||X)&&(++C,(!(q=A[C])||B&&!q.getFill()||!B&&q.getFill()||X&&!q.getStroke()||!X&&q.getStroke()||q.getText())&&(q=new c.default({fill:B?new o.default:void 0,stroke:X?new l.default:void 0}),A[C]=q),B&&(N=q.getFill()).setColor(B),X&&((W=q.getStroke()).setColor(X),W.setWidth(.5)),q.setZIndex(V));if(1!=b&&"line"==j.type){B=!("line-pattern"in L)&&"line-color"in L?Tn(Rn(j,"paint","line-color",g,w,S,R),Rn(j,"paint","line-opacity",g,w,S,R)):void 0;var $=Rn(j,"paint","line-width",g,w,S,R);B&&$>0&&(++C,(q=A[C])&&q.getStroke()&&!q.getFill()&&!q.getText()||(q=new c.default({stroke:new l.default}),A[C]=q),(W=q.getStroke()).setLineCap(Rn(j,"layout","line-cap",g,w,S,R)),W.setLineJoin(Rn(j,"layout","line-join",g,w,S,R)),W.setMiterLimit(Rn(j,"layout","line-miter-limit",g,w,S,R)),W.setColor(B),W.setWidth($),W.setLineDash(L["line-dasharray"]?Rn(j,"paint","line-dasharray",g,w,S,R).map((function(t){return t*$})):null),q.setZIndex(V))}var tt=!1,et=null,rt=0,nt=void 0,it=void 0,ot=void 0;if((1==b||2==b)&&"icon-image"in I){var at=Rn(j,"layout","icon-image",g,w,S,R);if(at){nt="string"==typeof at?Mn(at,h):at.toString();var st=void 0;if(y&&s&&s[nt]){var ut=Rn(j,"layout","icon-rotation-alignment",g,w,S,R);if(2==b){var lt=e.getGeometry();if(lt.getFlatMidpoint||lt.getFlatMidpoints){var ct=lt.getExtent();if(Math.sqrt(Math.max(Math.pow((ct[2]-ct[0])/r,2),Math.pow((ct[3]-ct[1])/r,2)))>150){var ft="MultiLineString"===lt.getType()?lt.getFlatMidpoints():lt.getFlatMidpoint();if(wn||(_n=[NaN,NaN],wn=new u.default("Point",_n,[],{},null)),st=wn,_n[0]=ft[0],_n[1]=ft[1],"line"===Rn(j,"layout","symbol-placement",g,w,S,R)&&"map"===ut)for(var ht=lt.getStride(),pt=lt.getFlatCoordinates(),yt=0,dt=pt.length-ht;yt<dt;yt+=ht){var vt=pt[yt],gt=pt[yt+1],mt=pt[yt+ht],bt=pt[yt+ht+1],_t=Math.min(vt,mt),wt=Math.min(gt,bt),xt=Math.max(vt,mt),kt=Math.max(gt,bt);if(ft[0]>=_t&&ft[0]<=xt&&ft[1]>=wt&&ft[1]<=kt){rt=Math.atan2(gt-bt,mt-vt);break}}}}}if(2!==b||st){var St=Rn(j,"layout","icon-size",g,w,S,R),Ot=void 0!==L["icon-color"]?Rn(j,"paint","icon-color",g,w,S,R):null;if(!Ot||0!==Ot.a){var Rt=nt+"."+St;if(null!==Ot&&(Rt+="."+Ot),!(it=x[Rt])){var Ct=s[nt];it=new a.default({color:Ot?[255*Ot.r,255*Ot.g,255*Ot.b,Ot.a]:void 0,img:y,imgSize:d,size:[Ct.width,Ct.height],offset:[Ct.x,Ct.y],rotateWithView:"map"===ut,scale:St/Ct.pixelRatio,displacement:"icon-offset"in I?Rn(j,"layout","icon-offset",g,w,S,R).map((function(t){return-t*Ct.pixelRatio})):void 0}),x[Rt]=it}}it&&(++C,(q=A[C])&&q.getImage()&&!q.getFill()&&!q.getStroke()||(q=new c.default,A[C]=q),q.setGeometry(st),it.setRotation(rt+Jr(Rn(j,"layout","icon-rotate",g,w,S,R))),it.setOpacity(Rn(j,"paint","icon-opacity",g,w,S,R)),it.setAnchor(kn[Rn(j,"layout","icon-anchor",g,w,S,R)]),q.setImage(it),et=q.getText(),q.setText(void 0),q.setZIndex(V),tt=!0,ot=!1)}else ot=!0}}}if(1==b&&"circle"===j.type){++C,(q=A[C])&&q.getImage()&&!q.getFill()&&!q.getStroke()||(q=new c.default,A[C]=q);var Pt="circle-radius"in L?Rn(j,"paint","circle-radius",g,w,S,R):5,Et=Tn(Rn(j,"paint","circle-stroke-color",g,w,S,R),Rn(j,"paint","circle-stroke-opacity",g,w,S,R)),Tt=Tn(Rn(j,"paint","circle-color",g,w,S,R),Rn(j,"paint","circle-opacity",g,w,S,R)),jt=Rn(j,"paint","circle-stroke-width",g,w,S,R),Mt=Pt+"."+Et+"."+Tt+"."+jt;(it=x[Mt])||(it=new i.default({radius:Pt,stroke:Et&&jt>0?new l.default({width:jt,color:Et}):void 0,fill:Tt?new o.default({color:Tt}):void 0}),x[Mt]=it),q.setImage(it),et=q.getText(),q.setText(void 0),q.setGeometry(void 0),q.setZIndex(V),tt=!0}var It=void 0,Ft=void 0,Dt=void 0,At=void 0,Lt=void 0,zt=void 0;if("text-field"in I){At=Math.round(Rn(j,"layout","text-size",g,w,S,R));var Bt=Rn(j,"layout","text-font",g,w,S,R);Dt=Rn(j,"layout","text-line-height",g,w,S,R),Ft=qr(p?p(Bt):Bt,At,Dt),Lt=Rn(j,"layout","text-letter-spacing",g,w,S,R),zt=Rn(j,"layout","text-max-width",g,w,S,R);var Gt=Rn(j,"layout","text-field",g,w,S,R);It="object"===rw(Gt)&&Gt.sections?1===Gt.sections.length?Gt.toString():Gt.sections.reduce((function(t,e,r){var n=e.fontStack?e.fontStack.split(","):Bt,i=qr(p?p(n):n,At*(e.scale||1),Dt),o=e.text;if("\n"===o)return t.push("\n",""),t;if(2!=b){for(var a=0,s=(o=hn(o,i,zt,Lt).split("\n")).length;a<s;++a)a>0&&t.push("\n",""),t.push(o[a],i);return t}t.push(un(o,Lt),i)}),[]):Mn(Gt,h).trim(),G=Rn(j,"paint","text-opacity",g,w,S,R)}if(It&&G&&!ot){tt||(++C,(q=A[C])&&q.getText()&&!q.getFill()&&!q.getStroke()||(q=new c.default,A[C]=q),q.setImage(void 0),q.setGeometry(void 0)),q.getText()||q.setText(et||new f.default({padding:[2,2,2,2]})),et=q.getText();var Nt=I["text-transform"];"uppercase"==Nt?It=Array.isArray(It)?It.map((function(t,e){return e%2?t:t.toUpperCase()})):It.toUpperCase():"lowercase"==Nt&&(It=Array.isArray(It)?It.map((function(t,e){return e%2?t:t.toLowerCase()})):It.toLowerCase());var Wt=Array.isArray(It)?It:2==b?un(It,Lt):hn(It,Ft,zt,Lt);et.setText(Wt),et.setFont(Ft),et.setRotation(Jr(Rn(j,"layout","text-rotate",g,w,S,R)));var Xt=Rn(j,"layout","text-anchor",g,w,S,R),qt=tt||1==b?"point":Rn(j,"layout","symbol-placement",g,w,S,R);et.setPlacement(qt),et.setOverflow("point"===qt);var Vt=Rn(j,"paint","text-halo-width",g,w,S,R),Kt=Rn(j,"layout","text-offset",g,w,S,R),Yt=Rn(j,"paint","text-translate",g,w,S,R),Zt=0,Ut=0;if("point"==qt){var Ht="center";-1!==Xt.indexOf("left")?(Ht="left",Ut=Vt):-1!==Xt.indexOf("right")&&(Ht="right",Ut=-Vt),et.setTextAlign(Ht);var Jt=Rn(j,"layout","text-rotation-alignment",g,w,S,R);et.setRotateWithView("map"==Jt)}else et.setMaxAngle(Jr(Rn(j,"layout","text-max-angle",g,w,S,R))*It.length/Wt.length),et.setTextAlign(),et.setRotateWithView(!1);var Qt="middle";0==Xt.indexOf("bottom")?(Qt="bottom",Zt=-Vt-.5*(Dt-1)*At):0==Xt.indexOf("top")&&(Qt="top",Zt=Vt+.5*(Dt-1)*At),et.setTextBaseline(Qt),et.setOffsetX(Kt[0]*At+Ut+Yt[0]),et.setOffsetY(Kt[1]*At+Zt+Yt[1]),D.setColor(Tn(Rn(j,"paint","text-color",g,w,S,R),G)),et.setFill(D);var $t=Tn(Rn(j,"paint","text-halo-color",g,w,S,R),G);if($t){F.setColor($t),Vt*=2;var te=.5*At;F.setWidth(Vt<=te?Vt:te),et.setStroke(F)}else et.setStroke(void 0);var ee=Rn(j,"layout","text-padding",g,w,S,R),re=et.getPadding();ee!==re[0]&&(re[0]=ee,re[1]=ee,re[2]=ee,re[3]=ee),q.setZIndex(V)}}}}return C>-1?(A.length=C+1,In&&("function"==typeof e.set?e.set("mapbox-layer",m):e.getProperties()["mapbox-layer"]=m),A):void 0}};return t.setStyle(L),t.set("mapbox-source",m),t.set("mapbox-layers",w),t.set("mapbox-featurestate",{}),L}var An=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Cy}))),Ln=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return ko}))),zn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Rb}))),Bn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return Zh}))),Gn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return r_}))),Nn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return g_}))),Wn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return M_}))),Xn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return ew}))),qn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return ch}))),Vn=function(t){var e={};return aw.d(e,t),e}((nw(t={},"default",(function(){return qp})),nw(t,"defaultLoadFunction",(function(){return Vp})),t)),Kn=function(t){var e={};return aw.d(e,t),e}(nw({},"default",(function(){return gv}))),Yn=function(t){var e={};return aw.d(e,t),e}(nw({},"createXYZ",(function(){return Hh}))),Zn=function(t){var e={};return aw.d(e,t),e}((nw(e={},"equivalent",(function(){return he})),nw(e,"fromLonLat",(function(){return fe})),nw(e,"getUserProjection",(function(){return we})),e));function Un(t,e){e.accessToken||(e=(0,Kr.assign)({},e),new URL(t).searchParams.forEach((function(t,r){e.accessToken=t,e.accessTokenParam=r})));return e}function Hn(t,e,r,n,i){var o,a,s;return void 0===r&&(r=""),void 0===n&&(n={}),void 0===i&&(i=void 0),"string"==typeof n?(o=n,s={}):(o=n.styleUrl,s=n),i||(i=s.resolutions),o||"string"!=typeof e||e.trim().startsWith("{")||(o=e),o&&(o=o.startsWith("data:")?location.href:Ur(o,s.accessToken),s=Un(o,s)),new Promise((function(n,u){rn(e,s).then((function(e){if(8!=e.version)return u(new Error("glStyle version 8 required."));if(!(t instanceof Wn.default||t instanceof qn.default))return u(new Error("Can only apply to VectorLayer or VectorTileLayer"));var l,c,f,h=t instanceof qn.default?"vector":"geojson";if(r?a=Array.isArray(r)?e.layers.find((function(t){return t.id===r[0]})).source:r:(a=Object.keys(e.sources).find((function(t){return e.sources[t].type===h})),r=a),!a)return u(new Error("No "+h+" source found in the glStyle."));function p(){if(t instanceof qn.default)return ni(e.sources[a],o,s).then((function(e){var r=t.getSource();if(r?e!==r&&(r.setTileUrlFunction(e.getTileUrlFunction()),r.format_||(r.format_=e.format_),r.getAttributions()||r.setAttributions(e.getAttributions()),r.getTileLoadFunction()===Vn.defaultLoadFunction&&r.setTileLoadFunction(e.getTileLoadFunction()),(0,Zn.equivalent)(r.getProjection(),e.getProjection())&&(r.tileGrid=e.getTileGrid())):t.setSource(e),!isFinite(t.getMaxResolution())&&!isFinite(t.getMinZoom())){var n=t.getSource().getTileGrid();t.setMaxResolution(n.getResolution(n.getMinZoom()))}}));var r=si(e.sources[a],o,s),n=t.getSource();return n?r!==n&&(n.getAttributions()||n.setAttributions(r.getAttributions()),n.format_||(n.format_=r.getFormat()),n.url_=r.getUrl()):t.setSource(r),Promise.resolve()}function y(){f||e.sprite&&!l?f?(t.setStyle(f),p().then(n).catch(u)):u(new Error("Something went wrong trying to apply style.")):(f=Dn(t,e,r,i,l,c,bn),t.getStyle()?p().then(n).catch(u):u(new Error("Nothing to show for source ["+a+"]")))}if(e.sprite){var d=new URL(function(t,e,r){var n=Zr(t);if(!n)return decodeURI(new URL(t,r).href);var i="sprites/";if(0!==n.indexOf(i))throw new Error("unexpected sprites url: "+t);var o=n.slice(i.length);return Yr+"/styles/v1/"+o+"/sprite?access_token="+e}(e.sprite,s.accessToken,o||location.href)),v=.5==(window.devicePixelRatio>=1.5?.5:1)?"@2x":"",g=d.origin+d.pathname+v+".json"+d.search;new Promise((function(t,e){en("Sprite",g,s).then(t).catch((function(r){en("Sprite",g=d.origin+d.pathname+".json"+d.search,s).then(t).catch(e)}))})).then((function(t){void 0===t&&u(new Error("No sprites found.")),l=t,c=d.origin+d.pathname+v+".png"+d.search,y()})).catch((function(t){u(new Error("Sprites cannot be loaded: "+g+": "+t.message))}))}else y()})).catch(u)}))}var Jn={};function Qn(t,e){var r={id:e.id,type:e.type},n={};function i(i){var o=e.layout||{},a=e.paint||{};r.paint=a;var s,u,l="function"==typeof t.getSource?t.getSource().getTileGrid().getZForResolution(i):t.getView().getZoom(),c="function"==typeof t.getTargetElement?t.getTargetElement():void 0;if(void 0!==a["background-color"]&&(s=Rn(r,"paint","background-color",l,Jn,n),c&&(c.style.background=y.parse(s).toString())),void 0!==a["background-opacity"]&&(u=Rn(r,"paint","background-opacity",l,Jn,n),c&&(c.style.opacity=u)),"none"!=o.visibility)return Tn(s,u);c&&(c.style.backgroundColor="",c.style.opacity="")}if("function"==typeof t.getTargetElement)t.getTargetElement()&&i(),t.on(["change:resolution","change:target"],i);else{if("function"!=typeof t.setBackground)throw new Error("Unable to apply background.");t.setBackground(i)}}function $n(t,e){e.layers.some((function(e){if("background"===e.type)return Qn(t,e),!0}))}function ti(t,e,r){return void 0===r&&(r={}),"object"===rw(e)?($n(t,e),Promise.resolve()):rn(e,r).then((function(e){$n(t,e)}))}function ei(t,e){var r;return t.some((function(t){if(t.id==e)return r=t.source,!0})),r}function ri(t){var e=t.bounds;if(e){var r=(0,Zn.fromLonLat)([e[0],e[1]]),n=(0,Zn.fromLonLat)([e[2],e[3]]);return[r[0],r[1],n[0],n[1]]}}function ni(t,e,r){return new Promise((function(n,i){on(t,e,r).then((function(t){var e=new Gn.default({tileJSON:t}),r=e.getTileJSON(),i=e.getTileGrid(),o=ri(r),a=r.minzoom||0,s=r.maxzoom||22,u=e.get("ol-source");if(void 0===u){var l={attributions:e.getAttributions(),format:new Ln.default,tileGrid:new Bn.default({origin:i.getOrigin(0),extent:o||i.getExtent(),minZoom:a,resolutions:Qr.slice(0,s+1),tileSize:512})};Array.isArray(r.tiles)?l.urls=r.tiles:l.url=r.tiles,t.olSourceOptions&&Object.assign(l,t.olSourceOptions),u=new Vn.default(l),e.set("ol-source",u)}n(u)})).catch(i)}))}function ii(t,e,r){var n=new qn.default({declutter:!0,visible:!1});return ni(t,e,r).then((function(t){n.setSource(t)})).catch((function(t){n.setSource(void 0)})),n}function oi(t,e,r){var n=new Nn.default;return on(t,e,r).then((function(e){var r=new Gn.default({transition:0,crossOrigin:"anonymous",tileJSON:e}),i=ri(e),o=r.getTileGrid(),a=t.tileSize||e.tileSize||512,s=e.minzoom||0,u=e.maxzoom||22;r.tileGrid=new Bn.default({origin:o.getOrigin(0),extent:i||o.getExtent(),minZoom:s,resolutions:(0,Yn.createXYZ)({maxZoom:u,tileSize:a}).getResolutions(),tileSize:a});var l=r.getTileUrlFunction();r.setTileUrlFunction((function(t,e,n){var i=l(t,e,n);if(-1!=i.indexOf("{bbox-epsg-3857}")){var o=r.getTileGrid().getTileCoordExtent(t);i=i.replace("{bbox-epsg-3857}",o.toString())}return i})),n.setSource(r)})).catch((function(t){n.setSource(void 0)})),n}var ai=new An.default;function si(t,e,r){var n=t.data,i={};if("string"==typeof n){var o=Hr(n,r.accessToken,r.accessTokenParam||"access_token",e||location.href);if(r.transformRequest){var a=r.transformRequest(o,"GeoJSON");a instanceof Request&&(o=encodeURI(a.url))}i.url=o}else i.features=ai.readFeatures(n,{featureProjection:(0,Zn.getUserProjection)()||"EPSG:3857"});return new Xn.default((0,Kr.assign)({attributions:t.attribution,format:ai},i))}function ui(t,e,r){return new Wn.default({declutter:!0,source:si(t,e,r),visible:!1})}function li(t,e,r,n){var i=Rn(t,"paint","raster-opacity",r.getZoom(),Jn,n);e.setOpacity(i)}function ci(t,e,r,n){var i=[],o=e.getView();o.isDef()||o.getRotation()||o.getResolutions()||(o=new Kn.default((0,Kr.assign)(o.getProperties(),{maxResolution:Qr[0]})),e.setView(o)),"center"in t&&!o.getCenter()&&o.setCenter((0,Zn.fromLonLat)(t.center)),"zoom"in t&&void 0===o.getZoom()&&o.setResolution(Qr[0]/Math.pow(2,t.zoom)),o.getCenter()&&void 0!==o.getZoom()||o.fit(o.getProjection().getExtent(),{nearest:!0,size:e.getSize()});for(var a,s,u,l,c,f=t.layers,h=[],p=0,y=f.length;p<y;++p){var d=(a=f[p]).type;if("heatmap"==d||"hillshade"==d)throw new Error(d+" layers are not supported");if("background"==d)Qn(e,a);else{if((l=a.source||ei(f,a.ref))!=u){if(h.length&&(i.push(hi(c,h,t,r,e,n)),h=[]),"vector"==(s=t.sources[l]).type)c=ii(s,r,n);else if("raster"==s.type){(c=oi(s,r,n)).setVisible(!a.layout||"none"!==a.layout.visibility);var v={};o.on("change:resolution",li.bind(this,a,c,o,v)),li(a,c,o,v)}else"geojson"==s.type&&(c=ui(s,r,n));u=l,c&&c.set("mapbox-source",u)}h.push(a.id)}}return i.push(hi(c,h,t,r,e,n)),e.set("mapbox-style",t),Promise.all(i)}function fi(t,e,r){var n;if(void 0===r&&(r={}),("string"==typeof t||t instanceof HTMLElement)&&(t=new zn.default({target:t})),"string"==typeof e){var i=e.startsWith("data:")?location.href:Ur(e,r.accessToken);r=Un(i,r),n=new Promise((function(n,o){rn(e,r).then((function(e){ci(e,t,i,r).then((function(){n(t)})).catch(o)})).catch((function(t){o(new Error("Could not load "+e+": "+t.message))}))}))}else n=new Promise((function(n,i){ci(e,t,"",r).then((function(){n(t)})).catch(i)}));return n}function hi(t,e,r,n,i,o){void 0===o&&(o={});for(var a=24,s=0,u=r.layers,l=0,c=u.length;l<c;++l){var f=u[l];-1!==e.indexOf(f.id)&&(a=Math.min("minzoom"in f?f.minzoom:0,a),s=Math.max("maxzoom"in f?f.maxzoom:24,s))}return new Promise((function(u,l){var c=function(){var i=t.getSource();if(i&&"error"!==i.getState()){if("getTileGrid"in i){var c=i.getTileGrid();if(c){var f=c.getMinZoom();(a>0||f>0)&&t.setMaxResolution(Math.min(Qr[a],c.getResolution(f))+1e-9),s<24&&t.setMinResolution(Qr[s]+1e-9)}}i instanceof Xn.default||i instanceof Vn.default?Hn(t,r,e,(0,Kr.assign)({styleUrl:n},o)).then((function(){t.setVisible(!0),u()})).catch(l):u()}else l(new Error("Error accessing data for source "+t.get("mapbox-source")))};t.set("mapbox-layers",e),-1===i.getLayers().getArray().indexOf(t)&&i.addLayer(t),t.getSource()?c():t.once("change:source",c)}))}function pi(t,e){for(var r=t.getLayers().getArray(),n=0,i=r.length;n<i;++n){var o=r[n].get("mapbox-layers");if(o&&-1!==o.indexOf(e))return r[n]}}function yi(t,e){for(var r=[],n=t.getAllLayers(),i=0,o=n.length;i<o;++i)n[i].get("mapbox-source")===e&&r.push(n[i]);return r}function di(t,e){for(var r=t.getLayers().getArray(),n=0,i=r.length;n<i;++n){var o=r[n].getSource();if(r[n].get("mapbox-source")===e)return o}}function vi(t,e,r){for(var n=("getLayers"in t?yi(t,e.source):[t]),i=0,o=n.length;i<o;++i){var a=n[i].get("mapbox-featurestate");if(!a)throw new Error('Map or layer for source "'+e.source+'" not found.');r?a[e.id]=r:delete a[e.id],n[i].changed()}}function gi(t,e){for(var r=("getLayers"in t?yi(t,e.source):[t]),n=0,i=r.length;n<i;++n){var o=r[n].get("mapbox-featurestate");if(o&&o[e.id])return o[e.id]}return null}}();var uw,lw,cw,fw=sw.uX,hw=self,pw=new OffscreenCanvas(1,1);pw.style={};var yw=pw.getContext("2d"),dw={landcover:new qp({maxZoom:9,format:new ko,url:"https://api.maptiler.com/tiles/landcover/{z}/{x}/{y}.pbf?key=get_your_own_D6rA4zTHduk6KOKTXzGB"}),contours:new qp({minZoom:9,maxZoom:14,format:new ko,url:"https://api.maptiler.com/tiles/contours/{z}/{x}/{y}.pbf?key=get_your_own_D6rA4zTHduk6KOKTXzGB"}),openmaptiles:new qp({format:new ko,maxZoom:14,url:"https://api.maptiler.com/tiles/v3/{z}/{x}/{y}.pbf?key=get_your_own_D6rA4zTHduk6KOKTXzGB"})},vw=[];function gw(t){return t[0].replace("Noto Sans","serif").replace("Roboto","sans-serif")}var mw=new Go((function(t,e,r,n){return No(uw,t,e,r,n)}),(function(){return hw.postMessage({action:"requestRender"})}));hw.addEventListener("message",(function(t){if("requestFeatures"!==t.data.action){if("render"===t.data.action){uw=t.data.frameState,lw||(lw=uw.pixelRatio,fetch("https://api.maptiler.com/maps/topo/style.json?key=get_your_own_D6rA4zTHduk6KOKTXzGB").then((function(t){return t.json()})).then((function(t){var e,r=[];t.layers.forEach((function(t){t.source&&(e!==t.source&&(e=t.source,r.push({source:t.source,layers:[]})),r[r.length-1].layers.push(t.id))}));var n=t.sprite+(lw>1?"@2x":"")+".json",i=t.sprite+(lw>1?"@2x":"")+".png";fetch(n).then((function(t){return t.json()})).then((function(e){r.forEach((function(r){var n=dw[r.source];if(n){var o=new ch({declutter:!0,source:n,minZoom:n.getTileGrid().getMinZoom()});o.getRenderer().useContainer=function(t,e){this.containerReused=this.getLayer()!==vw[0],this.canvas=pw,this.context=yw,this.container={firstElementChild:pw,style:{opacity:o.getOpacity()}},cw=e},fw(o,t,r.layers,void 0,e,i,gw),vw.push(o)}})),hw.postMessage({action:"requestRender"})}))}))),uw.tileQueue=mw,uw.viewState.projection=se("EPSG:3857"),vw.forEach((function(t){Sa(t.getLayerState(),uw.viewState)&&t.getRenderer().renderFrame(uw,pw)})),vw.forEach((function(t){return t.getRenderer().context&&t.renderDeclutter(uw)})),mw.getTilesLoading()<8&&(mw.reprioritize(),mw.loadMoreTiles(8,2));var e=pw.transferToImageBitmap();hw.postMessage({action:"rendered",imageData:e,transform:cw,frameState:JSON.parse(Kp(uw))},[e])}}else{var r=vw.filter((function(t){return Sa(t.getLayerState(),uw.viewState)})).map((function(e){return e.getFeatures(t.data.pixel)}));Promise.all(r).then((function(t){var e=t.flat();hw.postMessage({action:"getFeatures",features:JSON.parse(Kp(e.map((function(t){return t.getProperties()}))))})}))}}))}()}();
//# sourceMappingURL=offscreen-canvas.worker.worker.js.map