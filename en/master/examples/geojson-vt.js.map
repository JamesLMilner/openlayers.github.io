{"version":3,"sources":["webpack:///./geojson-vt.js"],"names":["__webpack_require__","r","__webpack_exports__","_src_ol_Map_js__WEBPACK_IMPORTED_MODULE_0__","_src_ol_View_js__WEBPACK_IMPORTED_MODULE_1__","_src_ol_format_GeoJSON_js__WEBPACK_IMPORTED_MODULE_2__","_src_ol_source_OSM_js__WEBPACK_IMPORTED_MODULE_3__","_src_ol_source_VectorTile_js__WEBPACK_IMPORTED_MODULE_4__","_src_ol_layer_js__WEBPACK_IMPORTED_MODULE_5__","_src_ol_layer_js__WEBPACK_IMPORTED_MODULE_6__","_src_ol_proj_Projection_js__WEBPACK_IMPORTED_MODULE_7__","replacer","key","value","geometry","let","type","rawType","length","coordinates","properties","tags","map","layers","source","target","view","center","zoom","fetch","then","response","json","const","tileIndex","geojsonvt","extent","debug","vectorSource","format","dataProjection","code","units","tileUrlFunction","tileCoord","data","getTile","JSON","stringify","features","vectorLayer","addLayer"],"mappings":"2FAAAA,EAAAC,EAAAC,GAAA,IAAAC,EAAAH,EAAA,GAAAI,EAAAJ,EAAA,GAAAK,EAAAL,EAAA,IAAAM,EAAAN,EAAA,IAAAO,EAAAP,EAAA,IAAAQ,EAAAR,EAAA,GAAAS,EAAAT,EAAA,KAAAU,EAAAV,EAAA,IASMW,EAAW,SAASC,EAAKC,GAC7B,GAAIA,EAAMC,SAAU,CAClBC,IAAIC,EACEC,EAAUJ,EAAMG,KAClBF,EAAWD,EAAMC,SAsBrB,OApBgB,IAAZG,GACFD,EAAO,aACgB,GAAnBF,EAASI,SACXF,EAAO,QACPF,EAAWA,EAAS,KAED,IAAZG,GACTD,EAAO,kBACgB,GAAnBF,EAASI,SACXF,EAAO,aACPF,EAAWA,EAAS,KAED,IAAZG,IACTD,EAAO,UACHF,EAASI,OAAS,IACpBF,EAAO,eACPF,EAAW,CAACA,KAIT,CACLE,KAAQ,UACRF,SAAY,CACVE,KAAQA,EACRG,YAAeL,GAEjBM,WAAcP,EAAMQ,MAGtB,OAAOR,GAILS,EAAM,IAAInB,EAAA,EAAI,CAClBoB,OAAQ,CACN,IAAIf,EAAA,EAAU,CACZgB,OAAQ,IAAIlB,EAAA,KAGhBmB,OAAQ,MACRC,KAAM,IAAItB,EAAA,EAAK,CACbuB,OAAQ,CAAC,EAAG,GACZC,KAAM,MAKVC,MADY,kCACDC,KAAK,SAASC,GACvB,OAAOA,EAASC,SACfF,KAAK,SAASE,GACfC,IAAMC,EAAYC,UAAUH,EAAM,CAChCI,OAAQ,KACRC,MAAO,IAEHC,EAAe,IAAI/B,EAAA,EAAiB,CACxCgC,OAAQ,IAAIlC,EAAA,EAAQ,CAElBmC,eAAgB,IAAI9B,EAAA,EAAW,CAC7B+B,KAAM,cACNC,MAAO,cACPN,OAAQ,CAAC,EAAG,EAAG,KAAM,UAGzBO,gBAAiB,SAASC,GACxBX,IAAMY,EAAOX,EAAUY,QAAQF,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAKrE,MAAO,uCAJSG,KAAKC,UAAU,CAC7BhC,KAAM,oBACNiC,SAAUJ,EAAOA,EAAKI,SAAW,IAChCtC,MAIDuC,EAAc,IAAIzC,EAAA,EAAgB,CACtCe,OAAQc,IAEVhB,EAAI6B,SAASD","file":"geojson-vt.js","sourcesContent":["import Map from '../src/ol/Map.js';\nimport View from '../src/ol/View.js';\nimport GeoJSON from '../src/ol/format/GeoJSON.js';\nimport OSM from '../src/ol/source/OSM.js';\nimport VectorTileSource from '../src/ol/source/VectorTile.js';\nimport {Tile as TileLayer, VectorTile as VectorTileLayer} from '../src/ol/layer.js';\nimport Projection from '../src/ol/proj/Projection.js';\n\n// Converts geojson-vt data to GeoJSON\nconst replacer = function(key, value) {\n  if (value.geometry) {\n    let type;\n    const rawType = value.type;\n    let geometry = value.geometry;\n\n    if (rawType === 1) {\n      type = 'MultiPoint';\n      if (geometry.length == 1) {\n        type = 'Point';\n        geometry = geometry[0];\n      }\n    } else if (rawType === 2) {\n      type = 'MultiLineString';\n      if (geometry.length == 1) {\n        type = 'LineString';\n        geometry = geometry[0];\n      }\n    } else if (rawType === 3) {\n      type = 'Polygon';\n      if (geometry.length > 1) {\n        type = 'MultiPolygon';\n        geometry = [geometry];\n      }\n    }\n\n    return {\n      'type': 'Feature',\n      'geometry': {\n        'type': type,\n        'coordinates': geometry\n      },\n      'properties': value.tags\n    };\n  } else {\n    return value;\n  }\n};\n\nconst map = new Map({\n  layers: [\n    new TileLayer({\n      source: new OSM()\n    })\n  ],\n  target: 'map',\n  view: new View({\n    center: [0, 0],\n    zoom: 2\n  })\n});\n\nconst url = 'data/geojson/countries.geojson';\nfetch(url).then(function(response) {\n  return response.json();\n}).then(function(json) {\n  const tileIndex = geojsonvt(json, {\n    extent: 4096,\n    debug: 1\n  });\n  const vectorSource = new VectorTileSource({\n    format: new GeoJSON({\n      // Data returned from geojson-vt is in tile pixel units\n      dataProjection: new Projection({\n        code: 'TILE_PIXELS',\n        units: 'tile-pixels',\n        extent: [0, 0, 4096, 4096]\n      })\n    }),\n    tileUrlFunction: function(tileCoord) {\n      const data = tileIndex.getTile(tileCoord[0], tileCoord[1], tileCoord[2]);\n      const geojson = JSON.stringify({\n        type: 'FeatureCollection',\n        features: data ? data.features : []\n      }, replacer);\n      return 'data:application/json;charset=UTF-8,' + geojson;\n    }\n  });\n  const vectorLayer = new VectorTileLayer({\n    source: vectorSource\n  });\n  map.addLayer(vectorLayer);\n});\n"],"sourceRoot":""}