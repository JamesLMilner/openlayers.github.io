{"version":3,"file":"ol.js","sources":["../src/ol/webgl.js","../src/ol/index.js","../src/ol/AssertionError.js","../src/ol/CollectionEventType.js","../src/ol/ObjectEventType.js","../src/ol/obj.js","../src/ol/events.js","../src/ol/functions.js","../src/ol/Disposable.js","../src/ol/events/Event.js","../src/ol/events/EventTarget.js","../src/ol/events/EventType.js","../src/ol/Observable.js","../src/ol/Object.js","../src/ol/Collection.js","../src/ol/asserts.js","../src/ol/extent/Corner.js","../src/ol/extent/Relationship.js","../src/ol/extent.js","../src/ol/geom/flat/transform.js","../src/ol/math.js","../src/ol/geom/GeometryType.js","../src/ol/sphere.js","../src/ol/proj/Units.js","../src/ol/proj/Projection.js","../src/ol/proj/epsg3857.js","../src/ol/proj/epsg4326.js","../src/ol/proj/projections.js","../src/ol/proj/transforms.js","../src/ol/proj.js","../src/ol/transform.js","../src/ol/geom/Geometry.js","../src/ol/color.js","../src/ol/colorlike.js","../src/ol/dom.js","../src/ol/has.js","../src/ol/css.js","../src/ol/ImageState.js","../src/ol/structs/LRUCache.js","../src/ol/render/canvas.js","../src/ol/style/Image.js","../src/ol/style/RegularShape.js","../src/ol/style/Circle.js","../src/ol/style/Fill.js","../src/ol/style/Stroke.js","../src/ol/style/Style.js","../src/ol/Feature.js","../src/ol/GeolocationProperty.js","../src/ol/array.js","../src/ol/geom/GeometryLayout.js","../src/ol/geom/SimpleGeometry.js","../src/ol/geom/flat/area.js","../src/ol/geom/flat/closest.js","../src/ol/geom/flat/deflate.js","../src/ol/geom/flat/inflate.js","../src/ol/geom/flat/simplify.js","../src/ol/geom/LinearRing.js","../src/ol/geom/Point.js","../src/ol/geom/flat/contains.js","../src/ol/geom/flat/interiorpoint.js","../src/ol/geom/flat/segments.js","../src/ol/geom/flat/intersectsextent.js","../src/ol/geom/flat/reverse.js","../src/ol/geom/flat/orient.js","../src/ol/geom/Polygon.js","../src/ol/Geolocation.js","../src/ol/string.js","../src/ol/coordinate.js","../src/ol/geom/flat/interpolate.js","../src/ol/geom/flat/length.js","../src/ol/geom/LineString.js","../src/ol/geom/flat/geodesic.js","../src/ol/render/EventType.js","../src/ol/style/TextPlacement.js","../src/ol/style/Text.js","../src/ol/Graticule.js","../src/ol/ImageBase.js","../src/ol/Image.js","../src/ol/TileState.js","../src/ol/easing.js","../src/ol/Tile.js","../src/ol/ImageTile.js","../src/ol/Kinetic.js","../src/ol/MapEvent.js","../src/ol/MapBrowserEvent.js","../src/ol/MapBrowserEventType.js","../src/ol/MapBrowserPointerEvent.js","../src/ol/pointer/EventType.js","../src/ol/pointer/EventSource.js","../src/ol/pointer/MouseSource.js","../src/ol/pointer/MsSource.js","../src/ol/pointer/NativeSource.js","../src/ol/pointer/PointerEvent.js","../src/ol/pointer/TouchSource.js","../src/ol/pointer/PointerEventHandler.js","../src/ol/MapBrowserEventHandler.js","../src/ol/MapEventType.js","../src/ol/MapProperty.js","../src/ol/structs/PriorityQueue.js","../src/ol/TileQueue.js","../src/ol/tilegrid/common.js","../src/ol/centerconstraint.js","../src/ol/rotationconstraint.js","../src/ol/ViewHint.js","../src/ol/ViewProperty.js","../src/ol/View.js","../src/ol/resolutionconstraint.js","../src/ol/layer/Property.js","../src/ol/layer/Base.js","../src/ol/source/State.js","../src/ol/layer/Group.js","../src/ol/size.js","../src/ol/PluggableMap.js","../src/ol/control/Control.js","../src/ol/layer/Layer.js","../src/ol/control/Attribution.js","../src/ol/control/Rotate.js","../src/ol/control/Zoom.js","../src/ol/control/util.js","../src/ol/interaction/Property.js","../src/ol/interaction/Interaction.js","../src/ol/interaction/DoubleClickZoom.js","../src/ol/events/condition.js","../src/ol/interaction/Pointer.js","../src/ol/interaction/DragPan.js","../src/ol/interaction/DragRotate.js","../src/ol/render/Box.js","../src/ol/interaction/DragBox.js","../src/ol/interaction/DragZoom.js","../src/ol/events/KeyCode.js","../src/ol/interaction/KeyboardPan.js","../src/ol/interaction/KeyboardZoom.js","../src/ol/interaction/MouseWheelZoom.js","../src/ol/interaction/PinchRotate.js","../src/ol/interaction/PinchZoom.js","../src/ol/interaction/DragAndDrop.js","../src/ol/interaction/DragRotateAndZoom.js","../src/ol/geom/Circle.js","../src/ol/geom/MultiLineString.js","../src/ol/geom/MultiPoint.js","../src/ol/geom/flat/center.js","../src/ol/geom/MultiPolygon.js","../src/ol/LayerType.js","../src/ol/layer/VectorRenderType.js","../src/ol/layer/Vector.js","../src/ol/format/FormatType.js","../src/ol/featureloader.js","../src/ol/loadingstrategy.js","../src/ol/source/Source.js","../src/ol/source/VectorEventType.js","../node_modules/quickselect/quickselect.js","../node_modules/rbush/index.js","../src/ol/structs/RBush.js","../src/ol/source/Vector.js","../src/ol/interaction/Draw.js","../src/ol/interaction/Extent.js","../src/ol/interaction/Modify.js","../src/ol/interaction/Select.js","../src/ol/interaction/Snap.js","../src/ol/interaction/Translate.js","../src/ol/interaction.js","../src/ol/reproj/common.js","../src/ol/ImageCanvas.js","../src/ol/render/Event.js","../src/ol/render/VectorContext.js","../src/ol/render/canvas/Immediate.js","../src/ol/style/IconImageCache.js","../src/ol/renderer/Map.js","../src/ol/renderer/canvas/Map.js","../src/ol/renderer/Layer.js","../src/ol/renderer/canvas/Layer.js","../src/ol/renderer/canvas/IntermediateCanvas.js","../src/ol/renderer/canvas/ImageLayer.js","../src/ol/TileRange.js","../src/ol/renderer/canvas/TileLayer.js","../src/ol/render/ReplayGroup.js","../src/ol/render/ReplayType.js","../src/ol/geom/flat/textpath.js","../src/ol/render/canvas/Instruction.js","../src/ol/render/replay.js","../src/ol/render/canvas/Replay.js","../src/ol/render/canvas/ImageReplay.js","../src/ol/render/canvas/LineStringReplay.js","../src/ol/render/canvas/PolygonReplay.js","../src/ol/geom/flat/straightchunk.js","../src/ol/render/canvas/TextReplay.js","../src/ol/render/canvas/ReplayGroup.js","../src/ol/renderer/vector.js","../src/ol/renderer/canvas/VectorLayer.js","../src/ol/layer/VectorTileRenderType.js","../src/ol/renderer/canvas/VectorTileLayer.js","../src/ol/Map.js","../src/ol/OverlayPositioning.js","../src/ol/Overlay.js","../src/ol/VectorTile.js","../src/ol/control/FullScreen.js","../src/ol/control/OverviewMap.js","../src/ol/control/ScaleLine.js","../src/ol/control/ZoomSlider.js","../src/ol/control/ZoomToExtent.js","../src/ol/webgl/Shader.js","../src/ol/webgl/Fragment.js","../src/ol/webgl/Vertex.js","../src/ol/render/webgl/circlereplay/defaultshader.js","../src/ol/render/webgl/circlereplay/defaultshader/Locations.js","../src/ol/vec/mat4.js","../src/ol/render/webgl/Replay.js","../src/ol/render/webgl.js","../src/ol/webgl/Buffer.js","../src/ol/render/webgl/CircleReplay.js","../src/ol/render/webgl/texturereplay/defaultshader.js","../src/ol/render/webgl/texturereplay/defaultshader/Locations.js","../src/ol/webgl/ContextEventType.js","../src/ol/webgl/Context.js","../src/ol/render/webgl/TextureReplay.js","../src/ol/render/webgl/ImageReplay.js","../src/ol/geom/flat/topology.js","../src/ol/render/webgl/linestringreplay/defaultshader.js","../src/ol/render/webgl/linestringreplay/defaultshader/Locations.js","../src/ol/render/webgl/LineStringReplay.js","../src/ol/render/webgl/polygonreplay/defaultshader.js","../src/ol/render/webgl/polygonreplay/defaultshader/Locations.js","../src/ol/structs/LinkedList.js","../src/ol/render/webgl/PolygonReplay.js","../src/ol/style/Atlas.js","../src/ol/style/AtlasManager.js","../src/ol/render/webgl/TextReplay.js","../src/ol/render/webgl/ReplayGroup.js","../src/ol/render/webgl/Immediate.js","../src/ol/renderer/webgl/defaultmapshader.js","../src/ol/renderer/webgl/defaultmapshader/Locations.js","../src/ol/renderer/webgl/Layer.js","../src/ol/renderer/webgl/ImageLayer.js","../src/ol/renderer/webgl/Map.js","../src/ol/renderer/webgl/tilelayershader.js","../src/ol/renderer/webgl/tilelayershader/Locations.js","../src/ol/renderer/webgl/TileLayer.js","../src/ol/renderer/webgl/VectorLayer.js","../src/ol/WebGLMap.js","../src/ol/control/MousePosition.js","../src/ol/format/Feature.js","../src/ol/format/JSONFeature.js","../src/ol/format/EsriJSON.js","../src/ol/xml.js","../src/ol/format/XMLFeature.js","../src/ol/format/GMLBase.js","../src/ol/format/xsd.js","../src/ol/format/GML3.js","../src/ol/format/GML.js","../src/ol/format/GML2.js","../src/ol/format/GPX.js","../src/ol/geom/GeometryCollection.js","../src/ol/format/GeoJSON.js","../src/ol/format/TextFeature.js","../src/ol/format/IGC.js","../src/ol/style/IconAnchorUnits.js","../src/ol/style/IconImage.js","../src/ol/format/KML.js","../src/ol/style/IconOrigin.js","../src/ol/style/Icon.js","../node_modules/ieee754/index.js","../node_modules/pbf/index.js","../src/ol/render/Feature.js","../src/ol/format/MVT.js","../src/ol/format/OSMXML.js","../src/ol/geom/flat/flip.js","../src/ol/format/Polyline.js","../src/ol/format/TopoJSON.js","../src/ol/format/filter/Filter.js","../src/ol/format/filter/LogicalNary.js","../src/ol/format/filter/And.js","../src/ol/format/filter/Bbox.js","../src/ol/format/filter/Spatial.js","../src/ol/format/filter/Contains.js","../src/ol/format/filter/Comparison.js","../src/ol/format/filter/During.js","../src/ol/format/filter/ComparisonBinary.js","../src/ol/format/filter/EqualTo.js","../src/ol/format/filter/GreaterThan.js","../src/ol/format/filter/GreaterThanOrEqualTo.js","../src/ol/format/filter/Intersects.js","../src/ol/format/filter/IsBetween.js","../src/ol/format/filter/IsLike.js","../src/ol/format/filter/IsNull.js","../src/ol/format/filter/LessThan.js","../src/ol/format/filter/LessThanOrEqualTo.js","../src/ol/format/filter/Not.js","../src/ol/format/filter/NotEqualTo.js","../src/ol/format/filter/Or.js","../src/ol/format/filter/Within.js","../src/ol/format/filter.js","../src/ol/format/WFS.js","../src/ol/format/WKT.js","../src/ol/format/XLink.js","../src/ol/format/XML.js","../src/ol/format/WMSCapabilities.js","../src/ol/format/WMSGetFeatureInfo.js","../src/ol/format/OWS.js","../src/ol/format/WMTSCapabilities.js","../src/ol/layer/Heatmap.js","../src/ol/layer/Image.js","../src/ol/layer/TileProperty.js","../src/ol/layer/Tile.js","../src/ol/layer/VectorTile.js","../src/ol/tilecoord.js","../src/ol/tileurlfunction.js","../src/ol/net.js","../src/ol/TileCache.js","../src/ol/reproj.js","../src/ol/reproj/Triangulation.js","../src/ol/reproj/Tile.js","../src/ol/tilegrid/TileGrid.js","../src/ol/tilegrid.js","../src/ol/source/Tile.js","../src/ol/source/TileEventType.js","../src/ol/source/UrlTile.js","../src/ol/source/TileImage.js","../src/ol/source/BingMaps.js","../src/ol/source/XYZ.js","../src/ol/source/CartoDB.js","../src/ol/source/Cluster.js","../src/ol/reproj/Image.js","../src/ol/source/Image.js","../src/ol/uri.js","../src/ol/source/ImageArcGISRest.js","../src/ol/source/ImageCanvas.js","../src/ol/source/ImageMapGuide.js","../src/ol/source/ImageStatic.js","../src/ol/source/common.js","../src/ol/source/WMSServerType.js","../src/ol/source/ImageWMS.js","../src/ol/source/OSM.js","../node_modules/pixelworks/lib/util.js","../node_modules/pixelworks/lib/processor.js","../src/ol/source/Raster.js","../src/ol/source/Stamen.js","../src/ol/source/TileArcGISRest.js","../src/ol/source/TileDebug.js","../src/ol/source/TileJSON.js","../src/ol/source/TileWMS.js","../src/ol/source/UTFGrid.js","../src/ol/VectorImageTile.js","../src/ol/source/VectorTile.js","../src/ol/source/WMTSRequestEncoding.js","../src/ol/tilegrid/WMTS.js","../src/ol/source/WMTS.js","../src/ol/source/Zoomify.js","../src/index.js","../src/ol/proj/proj4.js","../src/ol/render.js"],"sourcesContent":["/**\n * @module ol/webgl\n */\n\n/**\n * Constants taken from goog.webgl\n */\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ONE = 1;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const SRC_ALPHA = 0x0302;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COLOR_ATTACHMENT0 = 0x8CE0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COLOR_BUFFER_BIT = 0x00004000;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TRIANGLES = 0x0004;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TRIANGLE_STRIP = 0x0005;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ONE_MINUS_SRC_ALPHA = 0x0303;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ARRAY_BUFFER = 0x8892;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ELEMENT_ARRAY_BUFFER = 0x8893;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STREAM_DRAW = 0x88E0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STATIC_DRAW = 0x88E4;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DYNAMIC_DRAW = 0x88E8;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const CULL_FACE = 0x0B44;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const BLEND = 0x0BE2;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STENCIL_TEST = 0x0B90;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEPTH_TEST = 0x0B71;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const SCISSOR_TEST = 0x0C11;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_BYTE = 0x1401;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_SHORT = 0x1403;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_INT = 0x1405;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FLOAT = 0x1406;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const RGBA = 0x1908;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FRAGMENT_SHADER = 0x8B30;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const VERTEX_SHADER = 0x8B31;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const LINK_STATUS = 0x8B82;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const LINEAR = 0x2601;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_MAG_FILTER = 0x2800;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_MIN_FILTER = 0x2801;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_WRAP_S = 0x2802;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_WRAP_T = 0x2803;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_2D = 0x0DE1;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE0 = 0x84C0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const CLAMP_TO_EDGE = 0x812F;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COMPILE_STATUS = 0x8B81;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FRAMEBUFFER = 0x8D40;\n\n\n/** end of goog.webgl constants\n */\n\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst CONTEXT_IDS = [\n  'experimental-webgl',\n  'webgl',\n  'webkit-3d',\n  'moz-webgl'\n];\n\n\n/**\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {Object=} opt_attributes Attributes.\n * @return {WebGLRenderingContext} WebGL rendering context.\n */\nexport function getContext(canvas, opt_attributes) {\n  const ii = CONTEXT_IDS.length;\n  for (let i = 0; i < ii; ++i) {\n    try {\n      const context = canvas.getContext(CONTEXT_IDS[i], opt_attributes);\n      if (context) {\n        return /** @type {!WebGLRenderingContext} */ (context);\n      }\n    } catch (e) {\n      // pass\n    }\n  }\n  return null;\n}\n","/**\n * @module ol\n */\n\nimport {getContext} from './webgl.js';\n\n\n/**\n * An array with two elements, representing a pixel. The first element is the\n * x-coordinate, the second the y-coordinate of the pixel.\n * @typedef {Array.<number>} Pixel\n * @api\n */\n\n\n/**\n * Include debuggable shader sources.  Default is `true`. This should be set to\n * `false` for production builds.\n * TODO: move to a separate ol-webgl package\n * @type {boolean}\n */\nexport const DEBUG_WEBGL = true;\n\n\n/**\n * TODO: move to a separate ol-webgl package\n * The maximum supported WebGL texture size in pixels. If WebGL is not\n * supported, the value is set to `undefined`.\n * @type {number|undefined}\n */\nlet WEBGL_MAX_TEXTURE_SIZE; // value is set below\n\n\n/**\n * TODO: move to a separate ol-webgl package\n * List of supported WebGL extensions.\n * @type {Array.<string>}\n */\nlet WEBGL_EXTENSIONS; // value is set below\n\n\n/**\n * TODO: move to a separate ol-webgl package\n * WebGL is available.\n * @type {boolean}\n */\nlet HAS_WEBGL = false;\n\n\nif (typeof window !== 'undefined' && 'WebGLRenderingContext' in window) {\n  try {\n    const canvas = /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS'));\n    const gl = getContext(canvas, {failIfMajorPerformanceCaveat: true});\n    if (gl) {\n      HAS_WEBGL = true;\n      WEBGL_MAX_TEXTURE_SIZE = /** @type {number} */ (gl.getParameter(gl.MAX_TEXTURE_SIZE));\n      WEBGL_EXTENSIONS = gl.getSupportedExtensions();\n    }\n  } catch (e) {\n    // pass\n  }\n}\n\nexport {HAS_WEBGL, WEBGL_MAX_TEXTURE_SIZE, WEBGL_EXTENSIONS};\n\n\n/**\n * OpenLayers version.\n * @type {string}\n */\nexport const VERSION = '5.0.0-beta.14';\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * Usage:\n *\n *     function ParentClass(a, b) { }\n *     ParentClass.prototype.foo = function(a) { }\n *\n *     function ChildClass(a, b, c) {\n *       // Call parent constructor\n *       ParentClass.call(this, a, b);\n *     }\n *     inherits(ChildClass, ParentClass);\n *\n *     var child = new ChildClass('a', 'b', 'see');\n *     child.foo(); // This works.\n *\n * @param {!Function} childCtor Child constructor.\n * @param {!Function} parentCtor Parent constructor.\n * @function\n * @api\n */\nexport function inherits(childCtor, parentCtor) {\n  childCtor.prototype = Object.create(parentCtor.prototype);\n  childCtor.prototype.constructor = childCtor;\n}\n\n\n/**\n * Counter for getUid.\n * @type {number}\n * @private\n */\nlet uidCounter_ = 0;\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. Unique IDs are generated\n * as a strictly increasing sequence. Adapted from goog.getUid.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {number} The unique ID for the object.\n */\nexport function getUid(obj) {\n  return obj.ol_uid || (obj.ol_uid = ++uidCounter_);\n}\n","/**\n * @module ol/AssertionError\n */\nimport {VERSION, inherits} from './index.js';\n\n/**\n * Error object thrown when an assertion failed. This is an ECMA-262 Error,\n * extended with a `code` property.\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error}\n * @constructor\n * @extends {Error}\n * @param {number} code Error code.\n */\nconst AssertionError = function(code) {\n\n  const path = VERSION.split('-')[0];\n\n  /**\n   * @type {string}\n   */\n  this.message = 'Assertion failed. See https://openlayers.org/en/' + path +\n      '/doc/errors/#' + code + ' for details.';\n\n  /**\n   * Error code. The meaning of the code can be found on\n   * {@link https://openlayers.org/en/latest/doc/errors/} (replace `latest` with\n   * the version found in the OpenLayers script's header comment if a version\n   * other than the latest is used).\n   * @type {number}\n   * @api\n   */\n  this.code = code;\n\n  this.name = 'AssertionError';\n\n};\n\ninherits(AssertionError, Error);\n\nexport default AssertionError;\n","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection~CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection~CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove'\n};\n","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object~ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange'\n};\n","/**\n * @module ol/obj\n */\n\n\n/**\n * Polyfill for Object.assign().  Assigns enumerable and own properties from\n * one or more source objects to a target object.\n *\n * @see https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n * @param {!Object} target The target object.\n * @param {...Object} var_sources The source object(s).\n * @return {!Object} The modified target object.\n */\nexport const assign = (typeof Object.assign === 'function') ? Object.assign : function(target, var_sources) {\n  if (target === undefined || target === null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1, ii = arguments.length; i < ii; ++i) {\n    const source = arguments[i];\n    if (source !== undefined && source !== null) {\n      for (const key in source) {\n        if (source.hasOwnProperty(key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n};\n\n\n/**\n * Removes all properties from an object.\n * @param {Object} object The object to clear.\n */\nexport function clear(object) {\n  for (const property in object) {\n    delete object[property];\n  }\n}\n\n\n/**\n * Get an array of property values from an object.\n * @param {Object<K,V>} object The object from which to get the values.\n * @return {!Array<V>} The property values.\n * @template K,V\n */\nexport function getValues(object) {\n  const values = [];\n  for (const property in object) {\n    values.push(object[property]);\n  }\n  return values;\n}\n\n\n/**\n * Determine if an object has any properties.\n * @param {Object} object The object to check.\n * @return {boolean} The object is empty.\n */\nexport function isEmpty(object) {\n  let property;\n  for (property in object) {\n    return false;\n  }\n  return !property;\n}\n","/**\n * @module ol/events\n */\nimport {clear} from './obj.js';\n\n\n/**\n * Key to use with {@link module:ol/Observable~Observable#unByKey}.\n * @typedef {Object} EventsKey\n * @property {Object} [bindTo]\n * @property {module:ol/events~ListenerFunction} [boundListener]\n * @property {boolean} callOnce\n * @property {number} [deleteIndex]\n * @property {module:ol/events~ListenerFunction} listener\n * @property {EventTarget|module:ol/events/EventTarget} target\n * @property {string} type\n * @api\n */\n\n\n/**\n * Listener function. This function is called with an event object as argument.\n * When the function returns `false`, event propagation will stop.\n *\n * @typedef {function(module:ol/events/Event)|function(module:ol/events/Event): boolean} ListenerFunction\n * @api\n */\n\n\n/**\n * @param {module:ol/events~EventsKey} listenerObj Listener object.\n * @return {module:ol/events~ListenerFunction} Bound listener.\n */\nexport function bindListener(listenerObj) {\n  const boundListener = function(evt) {\n    const listener = listenerObj.listener;\n    const bindTo = listenerObj.bindTo || listenerObj.target;\n    if (listenerObj.callOnce) {\n      unlistenByKey(listenerObj);\n    }\n    return listener.call(bindTo, evt);\n  };\n  listenerObj.boundListener = boundListener;\n  return boundListener;\n}\n\n\n/**\n * Finds the matching {@link module:ol/events~EventsKey} in the given listener\n * array.\n *\n * @param {!Array<!module:ol/events~EventsKey>} listeners Array of listeners.\n * @param {!Function} listener The listener function.\n * @param {Object=} opt_this The `this` value inside the listener.\n * @param {boolean=} opt_setDeleteIndex Set the deleteIndex on the matching\n *     listener, for {@link module:ol/events~unlistenByKey}.\n * @return {module:ol/events~EventsKey|undefined} The matching listener object.\n */\nexport function findListener(listeners, listener, opt_this, opt_setDeleteIndex) {\n  let listenerObj;\n  for (let i = 0, ii = listeners.length; i < ii; ++i) {\n    listenerObj = listeners[i];\n    if (listenerObj.listener === listener &&\n        listenerObj.bindTo === opt_this) {\n      if (opt_setDeleteIndex) {\n        listenerObj.deleteIndex = i;\n      }\n      return listenerObj;\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @param {string} type Type.\n * @return {Array.<module:ol/events~EventsKey>|undefined} Listeners.\n */\nexport function getListeners(target, type) {\n  const listenerMap = target.ol_lm;\n  return listenerMap ? listenerMap[type] : undefined;\n}\n\n\n/**\n * Get the lookup of listeners.  If one does not exist on the target, it is\n * created.\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @return {!Object.<string, Array.<module:ol/events~EventsKey>>} Map of\n *     listeners by event type.\n */\nfunction getListenerMap(target) {\n  let listenerMap = target.ol_lm;\n  if (!listenerMap) {\n    listenerMap = target.ol_lm = {};\n  }\n  return listenerMap;\n}\n\n\n/**\n * Clean up all listener objects of the given type.  All properties on the\n * listener objects will be removed, and if no listeners remain in the listener\n * map, it will be removed from the target.\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @param {string} type Type.\n */\nfunction removeListeners(target, type) {\n  const listeners = getListeners(target, type);\n  if (listeners) {\n    for (let i = 0, ii = listeners.length; i < ii; ++i) {\n      target.removeEventListener(type, listeners[i].boundListener);\n      clear(listeners[i]);\n    }\n    listeners.length = 0;\n    const listenerMap = target.ol_lm;\n    if (listenerMap) {\n      delete listenerMap[type];\n      if (Object.keys(listenerMap).length === 0) {\n        delete target.ol_lm;\n      }\n    }\n  }\n}\n\n\n/**\n * Registers an event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * This function efficiently binds a `listener` to a `this` object, and returns\n * a key for use with {@link module:ol/events~unlistenByKey}.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @param {boolean=} opt_once If true, add the listener as one-off listener.\n * @return {module:ol/events~EventsKey} Unique key for the listener.\n */\nexport function listen(target, type, listener, opt_this, opt_once) {\n  const listenerMap = getListenerMap(target);\n  let listeners = listenerMap[type];\n  if (!listeners) {\n    listeners = listenerMap[type] = [];\n  }\n  let listenerObj = findListener(listeners, listener, opt_this, false);\n  if (listenerObj) {\n    if (!opt_once) {\n      // Turn one-off listener into a permanent one.\n      listenerObj.callOnce = false;\n    }\n  } else {\n    listenerObj = /** @type {module:ol/events~EventsKey} */ ({\n      bindTo: opt_this,\n      callOnce: !!opt_once,\n      listener: listener,\n      target: target,\n      type: type\n    });\n    target.addEventListener(type, bindListener(listenerObj));\n    listeners.push(listenerObj);\n  }\n\n  return listenerObj;\n}\n\n\n/**\n * Registers a one-off event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * This function efficiently binds a `listener` as self-unregistering listener\n * to a `this` object, and returns a key for use with\n * {@link module:ol/events~unlistenByKey} in case the listener needs to be\n * unregistered before it is called.\n *\n * When {@link module:ol/events~listen} is called with the same arguments after this\n * function, the self-unregistering listener will be turned into a permanent\n * listener.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @return {module:ol/events~EventsKey} Key for unlistenByKey.\n */\nexport function listenOnce(target, type, listener, opt_this) {\n  return listen(target, type, listener, opt_this, true);\n}\n\n\n/**\n * Unregisters an event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * To return a listener, this function needs to be called with the exact same\n * arguments that were used for a previous {@link module:ol/events~listen} call.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n */\nexport function unlisten(target, type, listener, opt_this) {\n  const listeners = getListeners(target, type);\n  if (listeners) {\n    const listenerObj = findListener(listeners, listener, opt_this, true);\n    if (listenerObj) {\n      unlistenByKey(listenerObj);\n    }\n  }\n}\n\n\n/**\n * Unregisters event listeners on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * The argument passed to this function is the key returned from\n * {@link module:ol/events~listen} or {@link module:ol/events~listenOnce}.\n *\n * @param {module:ol/events~EventsKey} key The key.\n */\nexport function unlistenByKey(key) {\n  if (key && key.target) {\n    key.target.removeEventListener(key.type, key.boundListener);\n    const listeners = getListeners(key.target, key.type);\n    if (listeners) {\n      const i = 'deleteIndex' in key ? key.deleteIndex : listeners.indexOf(key);\n      if (i !== -1) {\n        listeners.splice(i, 1);\n      }\n      if (listeners.length === 0) {\n        removeListeners(key.target, key.type);\n      }\n    }\n    clear(key);\n  }\n}\n\n\n/**\n * Unregisters all event listeners on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n */\nexport function unlistenAll(target) {\n  const listenerMap = getListenerMap(target);\n  for (const type in listenerMap) {\n    removeListeners(target, type);\n  }\n}\n","/**\n * @module ol/functions\n */\n\n/**\n * Always returns true.\n * @returns {boolean} true.\n */\nexport function TRUE() {\n  return true;\n}\n\n/**\n * Always returns false.\n * @returns {boolean} false.\n */\nexport function FALSE() {\n  return false;\n}\n\n/**\n * A reusable function, used e.g. as a default for callbacks.\n *\n * @return {undefined} Nothing.\n */\nexport function UNDEFINED() {}\n","/**\n * @module ol/Disposable\n */\nimport {UNDEFINED} from './functions.js';\n\n/**\n * Objects that need to clean up after themselves.\n * @constructor\n */\nconst Disposable = function() {};\n\n/**\n * The object has already been disposed.\n * @type {boolean}\n * @private\n */\nDisposable.prototype.disposed_ = false;\n\n/**\n * Clean up.\n */\nDisposable.prototype.dispose = function() {\n  if (!this.disposed_) {\n    this.disposed_ = true;\n    this.disposeInternal();\n  }\n};\n\n/**\n * Extension point for disposable objects.\n * @protected\n */\nDisposable.prototype.disposeInternal = UNDEFINED;\nexport default Disposable;\n","/**\n * @module ol/events/Event\n */\n/**\n * @classdesc\n * Stripped down implementation of the W3C DOM Level 2 Event interface.\n * @see {@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface}\n *\n * This implementation only provides `type` and `target` properties, and\n * `stopPropagation` and `preventDefault` methods. It is meant as base class\n * for higher level events defined in the library, and works with\n * {@link module:ol/events/EventTarget~EventTarget}.\n *\n * @constructor\n * @param {string} type Type.\n */\nconst Event = function(type) {\n\n  /**\n   * @type {boolean}\n   */\n  this.propagationStopped;\n\n  /**\n   * The event type.\n   * @type {string}\n   * @api\n   */\n  this.type = type;\n\n  /**\n   * The event target.\n   * @type {Object}\n   * @api\n   */\n  this.target = null;\n\n};\n\n\n/**\n * Stop event propagation.\n * @function\n * @api\n */\nEvent.prototype.preventDefault =\n\n  /**\n   * Stop event propagation.\n   * @function\n   * @api\n   */\n  Event.prototype.stopPropagation = function() {\n    this.propagationStopped = true;\n  };\n\n\n/**\n * @param {Event|module:ol/events/Event} evt Event\n */\nexport function stopPropagation(evt) {\n  evt.stopPropagation();\n}\n\n\n/**\n * @param {Event|module:ol/events/Event} evt Event\n */\nexport function preventDefault(evt) {\n  evt.preventDefault();\n}\n\nexport default Event;\n","/**\n * @module ol/events/EventTarget\n */\nimport {inherits} from '../index.js';\nimport Disposable from '../Disposable.js';\nimport {unlistenAll} from '../events.js';\nimport {UNDEFINED} from '../functions.js';\nimport Event from '../events/Event.js';\n\n\n/**\n * @typedef {EventTarget|module:ol/events/EventTarget} EventTargetLike\n */\n\n\n/**\n * @classdesc\n * A simplified implementation of the W3C DOM Level 2 EventTarget interface.\n * @see {@link https://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-EventTarget}\n *\n * There are two important simplifications compared to the specification:\n *\n * 1. The handling of `useCapture` in `addEventListener` and\n *    `removeEventListener`. There is no real capture model.\n * 2. The handling of `stopPropagation` and `preventDefault` on `dispatchEvent`.\n *    There is no event target hierarchy. When a listener calls\n *    `stopPropagation` or `preventDefault` on an event object, it means that no\n *    more listeners after this one will be called. Same as when the listener\n *    returns false.\n *\n * @constructor\n * @extends {module:ol/Disposable}\n */\nconst EventTarget = function() {\n\n  Disposable.call(this);\n\n  /**\n   * @private\n   * @type {!Object.<string, number>}\n   */\n  this.pendingRemovals_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, number>}\n   */\n  this.dispatching_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, Array.<module:ol/events~ListenerFunction>>}\n   */\n  this.listeners_ = {};\n\n};\n\ninherits(EventTarget, Disposable);\n\n\n/**\n * @param {string} type Type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n */\nEventTarget.prototype.addEventListener = function(type, listener) {\n  let listeners = this.listeners_[type];\n  if (!listeners) {\n    listeners = this.listeners_[type] = [];\n  }\n  if (listeners.indexOf(listener) === -1) {\n    listeners.push(listener);\n  }\n};\n\n\n/**\n * @param {{type: string,\n *     target: (EventTarget|module:ol/events/EventTarget|undefined)}|module:ol/events/Event|\n *     string} event Event or event type.\n * @return {boolean|undefined} `false` if anyone called preventDefault on the\n *     event object or if any of the listeners returned false.\n */\nEventTarget.prototype.dispatchEvent = function(event) {\n  const evt = typeof event === 'string' ? new Event(event) : event;\n  const type = evt.type;\n  evt.target = this;\n  const listeners = this.listeners_[type];\n  let propagate;\n  if (listeners) {\n    if (!(type in this.dispatching_)) {\n      this.dispatching_[type] = 0;\n      this.pendingRemovals_[type] = 0;\n    }\n    ++this.dispatching_[type];\n    for (let i = 0, ii = listeners.length; i < ii; ++i) {\n      if (listeners[i].call(this, evt) === false || evt.propagationStopped) {\n        propagate = false;\n        break;\n      }\n    }\n    --this.dispatching_[type];\n    if (this.dispatching_[type] === 0) {\n      let pendingRemovals = this.pendingRemovals_[type];\n      delete this.pendingRemovals_[type];\n      while (pendingRemovals--) {\n        this.removeEventListener(type, UNDEFINED);\n      }\n      delete this.dispatching_[type];\n    }\n    return propagate;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nEventTarget.prototype.disposeInternal = function() {\n  unlistenAll(this);\n};\n\n\n/**\n * Get the listeners for a specified event type. Listeners are returned in the\n * order that they will be called in.\n *\n * @param {string} type Type.\n * @return {Array.<module:ol/events~ListenerFunction>} Listeners.\n */\nEventTarget.prototype.getListeners = function(type) {\n  return this.listeners_[type];\n};\n\n\n/**\n * @param {string=} opt_type Type. If not provided,\n *     `true` will be returned if this EventTarget has any listeners.\n * @return {boolean} Has listeners.\n */\nEventTarget.prototype.hasListener = function(opt_type) {\n  return opt_type ?\n    opt_type in this.listeners_ :\n    Object.keys(this.listeners_).length > 0;\n};\n\n\n/**\n * @param {string} type Type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n */\nEventTarget.prototype.removeEventListener = function(type, listener) {\n  const listeners = this.listeners_[type];\n  if (listeners) {\n    const index = listeners.indexOf(listener);\n    if (type in this.pendingRemovals_) {\n      // make listener a no-op, and remove later in #dispatchEvent()\n      listeners[index] = UNDEFINED;\n      ++this.pendingRemovals_[type];\n    } else {\n      listeners.splice(index, 1);\n      if (listeners.length === 0) {\n        delete this.listeners_[type];\n      }\n    }\n  }\n};\nexport default EventTarget;\n","/**\n * @module ol/events/EventType\n */\n\n/**\n * @enum {string}\n * @const\n */\nexport default {\n  /**\n   * Generic change event. Triggered when the revision counter is increased.\n   * @event module:ol/events/Event~Event#change\n   * @api\n   */\n  CHANGE: 'change',\n\n  CLEAR: 'clear',\n  CONTEXTMENU: 'contextmenu',\n  CLICK: 'click',\n  DBLCLICK: 'dblclick',\n  DRAGENTER: 'dragenter',\n  DRAGOVER: 'dragover',\n  DROP: 'drop',\n  ERROR: 'error',\n  KEYDOWN: 'keydown',\n  KEYPRESS: 'keypress',\n  LOAD: 'load',\n  MOUSEDOWN: 'mousedown',\n  MOUSEMOVE: 'mousemove',\n  MOUSEOUT: 'mouseout',\n  MOUSEUP: 'mouseup',\n  MOUSEWHEEL: 'mousewheel',\n  MSPOINTERDOWN: 'MSPointerDown',\n  RESIZE: 'resize',\n  TOUCHSTART: 'touchstart',\n  TOUCHMOVE: 'touchmove',\n  TOUCHEND: 'touchend',\n  WHEEL: 'wheel'\n};\n","/**\n * @module ol/Observable\n */\nimport {inherits} from './index.js';\nimport {listen, unlistenByKey, unlisten, listenOnce} from './events.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @fires module:ol/events/Event~Event\n * @struct\n * @api\n */\nconst Observable = function() {\n\n  EventTarget.call(this);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.revision_ = 0;\n\n};\n\ninherits(Observable, EventTarget);\n\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (let i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {module:ol/events~EventsKey} */ (key));\n  }\n}\n\n\n/**\n * Increases the revision counter and dispatches a 'change' event.\n * @api\n */\nObservable.prototype.changed = function() {\n  ++this.revision_;\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * Dispatches an event and calls all listeners listening for events\n * of this type. The event parameter can either be a string or an\n * Object with a `type` property.\n *\n * @param {{type: string,\n *     target: (EventTarget|module:ol/events/EventTarget|undefined)}|\n *     module:ol/events/Event|string} event Event object.\n * @function\n * @api\n */\nObservable.prototype.dispatchEvent;\n\n\n/**\n * Get the version number for this object.  Each time the object is modified,\n * its version number will be incremented.\n * @return {number} Revision.\n * @api\n */\nObservable.prototype.getRevision = function() {\n  return this.revision_;\n};\n\n\n/**\n * Listen for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @return {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.on = function(type, listener) {\n  if (Array.isArray(type)) {\n    const len = type.length;\n    const keys = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      keys[i] = listen(this, type[i], listener);\n    }\n    return keys;\n  } else {\n    return listen(this, /** @type {string} */ (type), listener);\n  }\n};\n\n\n/**\n * Listen once for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @return {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.once = function(type, listener) {\n  if (Array.isArray(type)) {\n    const len = type.length;\n    const keys = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      keys[i] = listenOnce(this, type[i], listener);\n    }\n    return keys;\n  } else {\n    return listenOnce(this, /** @type {string} */ (type), listener);\n  }\n};\n\n\n/**\n * Unlisten for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @api\n */\nObservable.prototype.un = function(type, listener) {\n  if (Array.isArray(type)) {\n    for (let i = 0, ii = type.length; i < ii; ++i) {\n      unlisten(this, type[i], listener);\n    }\n    return;\n  } else {\n    unlisten(this, /** @type {string} */ (type), listener);\n  }\n};\nexport default Observable;\n","/**\n * @module ol/Object\n */\nimport {getUid, inherits} from './index.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport Event from './events/Event.js';\nimport {assign} from './obj.js';\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of\n * this type.\n *\n * @param {string} type The event type.\n * @param {string} key The property name.\n * @param {*} oldValue The old value for `key`.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst ObjectEvent = function(type, key, oldValue) {\n  Event.call(this, type);\n\n  /**\n   * The name of the property whose value is changing.\n   * @type {string}\n   * @api\n   */\n  this.key = key;\n\n  /**\n   * The old value. To get the new value use `e.target.get(e.key)` where\n   * `e` is the event object.\n   * @type {*}\n   * @api\n   */\n  this.oldValue = oldValue;\n\n};\ninherits(ObjectEvent, Event);\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @constructor\n * @extends {module:ol/Observable}\n * @param {Object.<string, *>=} opt_values An object with key-value pairs.\n * @fires module:ol/Object~ObjectEvent\n * @api\n */\nconst BaseObject = function(opt_values) {\n  Observable.call(this);\n\n  // Call {@link module:ol~getUid} to ensure that the order of objects' ids is\n  // the same as the order in which they were created.  This also helps to\n  // ensure that object properties are always added in the same order, which\n  // helps many JavaScript engines generate faster code.\n  getUid(this);\n\n  /**\n   * @private\n   * @type {!Object.<string, *>}\n   */\n  this.values_ = {};\n\n  if (opt_values !== undefined) {\n    this.setProperties(opt_values);\n  }\n};\n\ninherits(BaseObject, Observable);\n\n\n/**\n * @type {Object.<string, string>}\n */\nconst changeEventTypeCache = {};\n\n\n/**\n * @param {string} key Key name.\n * @return {string} Change name.\n */\nexport function getChangeEventType(key) {\n  return changeEventTypeCache.hasOwnProperty(key) ?\n    changeEventTypeCache[key] :\n    (changeEventTypeCache[key] = 'change:' + key);\n}\n\n\n/**\n * Gets a value.\n * @param {string} key Key name.\n * @return {*} Value.\n * @api\n */\nBaseObject.prototype.get = function(key) {\n  let value;\n  if (this.values_.hasOwnProperty(key)) {\n    value = this.values_[key];\n  }\n  return value;\n};\n\n\n/**\n * Get a list of object property names.\n * @return {Array.<string>} List of property names.\n * @api\n */\nBaseObject.prototype.getKeys = function() {\n  return Object.keys(this.values_);\n};\n\n\n/**\n * Get an object of all property names and values.\n * @return {Object.<string, *>} Object.\n * @api\n */\nBaseObject.prototype.getProperties = function() {\n  return assign({}, this.values_);\n};\n\n\n/**\n * @param {string} key Key name.\n * @param {*} oldValue Old value.\n */\nBaseObject.prototype.notify = function(key, oldValue) {\n  let eventType;\n  eventType = getChangeEventType(key);\n  this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n  eventType = ObjectEventType.PROPERTYCHANGE;\n  this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n};\n\n\n/**\n * Sets a value.\n * @param {string} key Key name.\n * @param {*} value Value.\n * @param {boolean=} opt_silent Update without triggering an event.\n * @api\n */\nBaseObject.prototype.set = function(key, value, opt_silent) {\n  if (opt_silent) {\n    this.values_[key] = value;\n  } else {\n    const oldValue = this.values_[key];\n    this.values_[key] = value;\n    if (oldValue !== value) {\n      this.notify(key, oldValue);\n    }\n  }\n};\n\n\n/**\n * Sets a collection of key-value pairs.  Note that this changes any existing\n * properties and adds new ones (it does not remove any existing properties).\n * @param {Object.<string, *>} values Values.\n * @param {boolean=} opt_silent Update without triggering an event.\n * @api\n */\nBaseObject.prototype.setProperties = function(values, opt_silent) {\n  for (const key in values) {\n    this.set(key, values[key], opt_silent);\n  }\n};\n\n\n/**\n * Unsets a property.\n * @param {string} key Key name.\n * @param {boolean=} opt_silent Unset without triggering an event.\n * @api\n */\nBaseObject.prototype.unset = function(key, opt_silent) {\n  if (key in this.values_) {\n    const oldValue = this.values_[key];\n    delete this.values_[key];\n    if (!opt_silent) {\n      this.notify(key, oldValue);\n    }\n  }\n};\n\n\nexport default BaseObject;\n","/**\n * @module ol/Collection\n */\nimport {inherits} from './index.js';\nimport AssertionError from './AssertionError.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport BaseObject from './Object.js';\nimport Event from './events/Event.js';\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LENGTH: 'length'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/CollectionEventType} type Type.\n * @param {*=} opt_element Element.\n */\nexport const CollectionEvent = function(type, opt_element) {\n\n  Event.call(this, type);\n\n  /**\n   * The element that is added to or removed from the collection.\n   * @type {*}\n   * @api\n   */\n  this.element = opt_element;\n\n};\n\ninherits(CollectionEvent, Event);\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @fires module:ol/Collection~CollectionEvent\n * @param {Array.<T>=} opt_array Array.\n * @param {module:ol/Collection~Options=} opt_options Collection options.\n * @template T\n * @api\n */\nconst Collection = function(opt_array, opt_options) {\n\n  BaseObject.call(this);\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.unique_ = !!options.unique;\n\n  /**\n   * @private\n   * @type {!Array.<T>}\n   */\n  this.array_ = opt_array ? opt_array : [];\n\n  if (this.unique_) {\n    for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n      this.assertUnique_(this.array_[i], i);\n    }\n  }\n\n  this.updateLength_();\n\n};\n\ninherits(Collection, BaseObject);\n\n\n/**\n * Remove all elements from the collection.\n * @api\n */\nCollection.prototype.clear = function() {\n  while (this.getLength() > 0) {\n    this.pop();\n  }\n};\n\n\n/**\n * Add elements to the collection.  This pushes each item in the provided array\n * to the end of the collection.\n * @param {!Array.<T>} arr Array.\n * @return {module:ol/Collection.<T>} This collection.\n * @api\n */\nCollection.prototype.extend = function(arr) {\n  for (let i = 0, ii = arr.length; i < ii; ++i) {\n    this.push(arr[i]);\n  }\n  return this;\n};\n\n\n/**\n * Iterate over each element, calling the provided callback.\n * @param {function(T, number, Array.<T>): *} f The function to call\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array). The return value is ignored.\n * @api\n */\nCollection.prototype.forEach = function(f) {\n  const array = this.array_;\n  for (let i = 0, ii = array.length; i < ii; ++i) {\n    f(array[i], i, array);\n  }\n};\n\n\n/**\n * Get a reference to the underlying Array object. Warning: if the array\n * is mutated, no events will be dispatched by the collection, and the\n * collection's \"length\" property won't be in sync with the actual length\n * of the array.\n * @return {!Array.<T>} Array.\n * @api\n */\nCollection.prototype.getArray = function() {\n  return this.array_;\n};\n\n\n/**\n * Get the element at the provided index.\n * @param {number} index Index.\n * @return {T} Element.\n * @api\n */\nCollection.prototype.item = function(index) {\n  return this.array_[index];\n};\n\n\n/**\n * Get the length of this collection.\n * @return {number} The length of the array.\n * @observable\n * @api\n */\nCollection.prototype.getLength = function() {\n  return /** @type {number} */ (this.get(Property.LENGTH));\n};\n\n\n/**\n * Insert an element at the provided index.\n * @param {number} index Index.\n * @param {T} elem Element.\n * @api\n */\nCollection.prototype.insertAt = function(index, elem) {\n  if (this.unique_) {\n    this.assertUnique_(elem);\n  }\n  this.array_.splice(index, 0, elem);\n  this.updateLength_();\n  this.dispatchEvent(\n    new CollectionEvent(CollectionEventType.ADD, elem));\n};\n\n\n/**\n * Remove the last element of the collection and return it.\n * Return `undefined` if the collection is empty.\n * @return {T|undefined} Element.\n * @api\n */\nCollection.prototype.pop = function() {\n  return this.removeAt(this.getLength() - 1);\n};\n\n\n/**\n * Insert the provided element at the end of the collection.\n * @param {T} elem Element.\n * @return {number} New length of the collection.\n * @api\n */\nCollection.prototype.push = function(elem) {\n  if (this.unique_) {\n    this.assertUnique_(elem);\n  }\n  const n = this.getLength();\n  this.insertAt(n, elem);\n  return this.getLength();\n};\n\n\n/**\n * Remove the first occurrence of an element from the collection.\n * @param {T} elem Element.\n * @return {T|undefined} The removed element or undefined if none found.\n * @api\n */\nCollection.prototype.remove = function(elem) {\n  const arr = this.array_;\n  for (let i = 0, ii = arr.length; i < ii; ++i) {\n    if (arr[i] === elem) {\n      return this.removeAt(i);\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * Remove the element at the provided index and return it.\n * Return `undefined` if the collection does not contain this index.\n * @param {number} index Index.\n * @return {T|undefined} Value.\n * @api\n */\nCollection.prototype.removeAt = function(index) {\n  const prev = this.array_[index];\n  this.array_.splice(index, 1);\n  this.updateLength_();\n  this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE, prev));\n  return prev;\n};\n\n\n/**\n * Set the element at the provided index.\n * @param {number} index Index.\n * @param {T} elem Element.\n * @api\n */\nCollection.prototype.setAt = function(index, elem) {\n  const n = this.getLength();\n  if (index < n) {\n    if (this.unique_) {\n      this.assertUnique_(elem, index);\n    }\n    const prev = this.array_[index];\n    this.array_[index] = elem;\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.REMOVE, prev));\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem));\n  } else {\n    for (let j = n; j < index; ++j) {\n      this.insertAt(j, undefined);\n    }\n    this.insertAt(index, elem);\n  }\n};\n\n\n/**\n * @private\n */\nCollection.prototype.updateLength_ = function() {\n  this.set(Property.LENGTH, this.array_.length);\n};\n\n\n/**\n * @private\n * @param {T} elem Element.\n * @param {number=} opt_except Optional index to ignore.\n */\nCollection.prototype.assertUnique_ = function(elem, opt_except) {\n  for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n    if (this.array_[i] === elem && i !== opt_except) {\n      throw new AssertionError(58);\n    }\n  }\n};\n\nexport default Collection;\n","/**\n * @module ol/asserts\n */\nimport AssertionError from './AssertionError.js';\n\n/**\n * @param {*} assertion Assertion we expected to be truthy.\n * @param {number} errorCode Error code.\n */\nexport function assert(assertion, errorCode) {\n  if (!assertion) {\n    throw new AssertionError(errorCode);\n  }\n}\n","/**\n * @module ol/extent/Corner\n */\n\n/**\n * Extent corner.\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/extent/Relationship\n */\n\n/**\n * Relationship to an extent.\n * @enum {number}\n */\nexport default {\n  UNKNOWN: 0,\n  INTERSECTING: 1,\n  ABOVE: 2,\n  RIGHT: 4,\n  BELOW: 8,\n  LEFT: 16\n};\n","/**\n * @module ol/extent\n */\nimport {assert} from './asserts.js';\nimport Corner from './extent/Corner.js';\nimport Relationship from './extent/Relationship.js';\n\n\n/**\n * An array of numbers representing an extent: `[minx, miny, maxx, maxy]`.\n * @typedef {Array.<number>} Extent\n * @api\n */\n\n/**\n * Build an extent that includes all given coordinates.\n *\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @return {module:ol/extent~Extent} Bounding extent.\n * @api\n */\nexport function boundingExtent(coordinates) {\n  const extent = createEmpty();\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {Array.<number>} xs Xs.\n * @param {Array.<number>} ys Ys.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @private\n * @return {module:ol/extent~Extent} Extent.\n */\nfunction _boundingExtentXYs(xs, ys, opt_extent) {\n  const minX = Math.min.apply(null, xs);\n  const minY = Math.min.apply(null, ys);\n  const maxX = Math.max.apply(null, xs);\n  const maxY = Math.max.apply(null, ys);\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n}\n\n\n/**\n * Return extent increased by the provided value.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} value The amount by which the extent should be buffered.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nexport function buffer(extent, value, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0] - value;\n    opt_extent[1] = extent[1] - value;\n    opt_extent[2] = extent[2] + value;\n    opt_extent[3] = extent[3] + value;\n    return opt_extent;\n  } else {\n    return [\n      extent[0] - value,\n      extent[1] - value,\n      extent[2] + value,\n      extent[3] + value\n    ];\n  }\n}\n\n\n/**\n * Creates a clone of an extent.\n *\n * @param {module:ol/extent~Extent} extent Extent to clone.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} The clone.\n */\nexport function clone(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent.slice();\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {number} Closest squared distance.\n */\nexport function closestSquaredDistanceXY(extent, x, y) {\n  let dx, dy;\n  if (x < extent[0]) {\n    dx = extent[0] - x;\n  } else if (extent[2] < x) {\n    dx = x - extent[2];\n  } else {\n    dx = 0;\n  }\n  if (y < extent[1]) {\n    dy = extent[1] - y;\n  } else if (extent[3] < y) {\n    dy = y - extent[3];\n  } else {\n    dy = 0;\n  }\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {boolean} The coordinate is contained in the extent.\n * @api\n */\nexport function containsCoordinate(extent, coordinate) {\n  return containsXY(extent, coordinate[0], coordinate[1]);\n}\n\n\n/**\n * Check if one extent contains another.\n *\n * An extent is deemed contained if it lies completely within the other extent,\n * including if they share one or more edges.\n *\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {boolean} The second extent is contained by or on the edge of the\n *     first.\n * @api\n */\nexport function containsExtent(extent1, extent2) {\n  return extent1[0] <= extent2[0] && extent2[2] <= extent1[2] &&\n      extent1[1] <= extent2[1] && extent2[3] <= extent1[3];\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @return {boolean} The x, y values are contained in the extent.\n * @api\n */\nexport function containsXY(extent, x, y) {\n  return extent[0] <= x && x <= extent[2] && extent[1] <= y && y <= extent[3];\n}\n\n\n/**\n * Get the relationship between a coordinate and extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @return {module:ol/extent/Relationship} The relationship (bitwise compare with\n *     module:ol/extent/Relationship~Relationship).\n */\nexport function coordinateRelationship(extent, coordinate) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let relationship = Relationship.UNKNOWN;\n  if (x < minX) {\n    relationship = relationship | Relationship.LEFT;\n  } else if (x > maxX) {\n    relationship = relationship | Relationship.RIGHT;\n  }\n  if (y < minY) {\n    relationship = relationship | Relationship.BELOW;\n  } else if (y > maxY) {\n    relationship = relationship | Relationship.ABOVE;\n  }\n  if (relationship === Relationship.UNKNOWN) {\n    relationship = Relationship.INTERSECTING;\n  }\n  return relationship;\n}\n\n\n/**\n * Create an empty extent.\n * @return {module:ol/extent~Extent} Empty extent.\n * @api\n */\nexport function createEmpty() {\n  return [Infinity, Infinity, -Infinity, -Infinity];\n}\n\n\n/**\n * Create a new extent or update the provided extent.\n * @param {number} minX Minimum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxX Maximum X.\n * @param {number} maxY Maximum Y.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdate(minX, minY, maxX, maxY, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = minX;\n    opt_extent[1] = minY;\n    opt_extent[2] = maxX;\n    opt_extent[3] = maxY;\n    return opt_extent;\n  } else {\n    return [minX, minY, maxX, maxY];\n  }\n}\n\n\n/**\n * Create a new empty extent or make the provided one empty.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateEmpty(opt_extent) {\n  return createOrUpdate(\n    Infinity, Infinity, -Infinity, -Infinity, opt_extent);\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromCoordinate(coordinate, opt_extent) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  return createOrUpdate(x, y, x, y, opt_extent);\n}\n\n\n/**\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromCoordinates(coordinates, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendCoordinates(extent, coordinates);\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromFlatCoordinates(flatCoordinates, offset, end, stride, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendFlatCoordinates(extent, flatCoordinates, offset, end, stride);\n}\n\n/**\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} rings Rings.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromRings(rings, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendRings(extent, rings);\n}\n\n\n/**\n * Determine if two extents are equivalent.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {boolean} The two extents are equivalent.\n * @api\n */\nexport function equals(extent1, extent2) {\n  return extent1[0] == extent2[0] && extent1[2] == extent2[2] &&\n      extent1[1] == extent2[1] && extent1[3] == extent2[3];\n}\n\n\n/**\n * Modify an extent to include another extent.\n * @param {module:ol/extent~Extent} extent1 The extent to be modified.\n * @param {module:ol/extent~Extent} extent2 The extent that will be included in the first.\n * @return {module:ol/extent~Extent} A reference to the first (extended) extent.\n * @api\n */\nexport function extend(extent1, extent2) {\n  if (extent2[0] < extent1[0]) {\n    extent1[0] = extent2[0];\n  }\n  if (extent2[2] > extent1[2]) {\n    extent1[2] = extent2[2];\n  }\n  if (extent2[1] < extent1[1]) {\n    extent1[1] = extent2[1];\n  }\n  if (extent2[3] > extent1[3]) {\n    extent1[3] = extent2[3];\n  }\n  return extent1;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n */\nexport function extendCoordinate(extent, coordinate) {\n  if (coordinate[0] < extent[0]) {\n    extent[0] = coordinate[0];\n  }\n  if (coordinate[0] > extent[2]) {\n    extent[2] = coordinate[0];\n  }\n  if (coordinate[1] < extent[1]) {\n    extent[1] = coordinate[1];\n  }\n  if (coordinate[1] > extent[3]) {\n    extent[3] = coordinate[1];\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendCoordinates(extent, coordinates) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendFlatCoordinates(extent, flatCoordinates, offset, end, stride) {\n  for (; offset < end; offset += stride) {\n    extendXY(extent, flatCoordinates[offset], flatCoordinates[offset + 1]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} rings Rings.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendRings(extent, rings) {\n  for (let i = 0, ii = rings.length; i < ii; ++i) {\n    extendCoordinates(extent, rings[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n */\nexport function extendXY(extent, x, y) {\n  extent[0] = Math.min(extent[0], x);\n  extent[1] = Math.min(extent[1], y);\n  extent[2] = Math.max(extent[2], x);\n  extent[3] = Math.max(extent[3], y);\n}\n\n\n/**\n * This function calls `callback` for each corner of the extent. If the\n * callback returns a truthy value the function returns that value\n * immediately. Otherwise the function returns `false`.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(this:T, module:ol/coordinate~Coordinate): S} callback Callback.\n * @param {T=} opt_this Value to use as `this` when executing `callback`.\n * @return {S|boolean} Value.\n * @template S, T\n */\nexport function forEachCorner(extent, callback, opt_this) {\n  let val;\n  val = callback.call(opt_this, getBottomLeft(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getBottomRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getTopRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getTopLeft(extent));\n  if (val) {\n    return val;\n  }\n  return false;\n}\n\n\n/**\n * Get the size of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Area.\n * @api\n */\nexport function getArea(extent) {\n  let area = 0;\n  if (!isEmpty(extent)) {\n    area = getWidth(extent) * getHeight(extent);\n  }\n  return area;\n}\n\n\n/**\n * Get the bottom left coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Bottom left coordinate.\n * @api\n */\nexport function getBottomLeft(extent) {\n  return [extent[0], extent[1]];\n}\n\n\n/**\n * Get the bottom right coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Bottom right coordinate.\n * @api\n */\nexport function getBottomRight(extent) {\n  return [extent[2], extent[1]];\n}\n\n\n/**\n * Get the center coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Center.\n * @api\n */\nexport function getCenter(extent) {\n  return [(extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2];\n}\n\n\n/**\n * Get a corner coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/extent/Corner} corner Corner.\n * @return {module:ol/coordinate~Coordinate} Corner coordinate.\n */\nexport function getCorner(extent, corner) {\n  let coordinate;\n  if (corner === Corner.BOTTOM_LEFT) {\n    coordinate = getBottomLeft(extent);\n  } else if (corner === Corner.BOTTOM_RIGHT) {\n    coordinate = getBottomRight(extent);\n  } else if (corner === Corner.TOP_LEFT) {\n    coordinate = getTopLeft(extent);\n  } else if (corner === Corner.TOP_RIGHT) {\n    coordinate = getTopRight(extent);\n  } else {\n    assert(false, 13); // Invalid corner\n  }\n  return (\n    /** @type {!module:ol/coordinate~Coordinate} */ (coordinate)\n  );\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {number} Enlarged area.\n */\nexport function getEnlargedArea(extent1, extent2) {\n  const minX = Math.min(extent1[0], extent2[0]);\n  const minY = Math.min(extent1[1], extent2[1]);\n  const maxX = Math.max(extent1[2], extent2[2]);\n  const maxY = Math.max(extent1[3], extent2[3]);\n  return (maxX - minX) * (maxY - minY);\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function getForViewAndSize(center, resolution, rotation, size, opt_extent) {\n  const dx = resolution * size[0] / 2;\n  const dy = resolution * size[1] / 2;\n  const cosRotation = Math.cos(rotation);\n  const sinRotation = Math.sin(rotation);\n  const xCos = dx * cosRotation;\n  const xSin = dx * sinRotation;\n  const yCos = dy * cosRotation;\n  const ySin = dy * sinRotation;\n  const x = center[0];\n  const y = center[1];\n  const x0 = x - xCos + ySin;\n  const x1 = x - xCos - ySin;\n  const x2 = x + xCos - ySin;\n  const x3 = x + xCos + ySin;\n  const y0 = y - xSin - yCos;\n  const y1 = y - xSin + yCos;\n  const y2 = y + xSin + yCos;\n  const y3 = y + xSin - yCos;\n  return createOrUpdate(\n    Math.min(x0, x1, x2, x3), Math.min(y0, y1, y2, y3),\n    Math.max(x0, x1, x2, x3), Math.max(y0, y1, y2, y3),\n    opt_extent);\n}\n\n\n/**\n * Get the height of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Height.\n * @api\n */\nexport function getHeight(extent) {\n  return extent[3] - extent[1];\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {number} Intersection area.\n */\nexport function getIntersectionArea(extent1, extent2) {\n  const intersection = getIntersection(extent1, extent2);\n  return getArea(intersection);\n}\n\n\n/**\n * Get the intersection of two extents.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @param {module:ol/extent~Extent=} opt_extent Optional extent to populate with intersection.\n * @return {module:ol/extent~Extent} Intersecting extent.\n * @api\n */\nexport function getIntersection(extent1, extent2, opt_extent) {\n  const intersection = opt_extent ? opt_extent : createEmpty();\n  if (intersects(extent1, extent2)) {\n    if (extent1[0] > extent2[0]) {\n      intersection[0] = extent1[0];\n    } else {\n      intersection[0] = extent2[0];\n    }\n    if (extent1[1] > extent2[1]) {\n      intersection[1] = extent1[1];\n    } else {\n      intersection[1] = extent2[1];\n    }\n    if (extent1[2] < extent2[2]) {\n      intersection[2] = extent1[2];\n    } else {\n      intersection[2] = extent2[2];\n    }\n    if (extent1[3] < extent2[3]) {\n      intersection[3] = extent1[3];\n    } else {\n      intersection[3] = extent2[3];\n    }\n  } else {\n    createOrUpdateEmpty(intersection);\n  }\n  return intersection;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Margin.\n */\nexport function getMargin(extent) {\n  return getWidth(extent) + getHeight(extent);\n}\n\n\n/**\n * Get the size (width, height) of an extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @return {module:ol/size~Size} The extent size.\n * @api\n */\nexport function getSize(extent) {\n  return [extent[2] - extent[0], extent[3] - extent[1]];\n}\n\n\n/**\n * Get the top left coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Top left coordinate.\n * @api\n */\nexport function getTopLeft(extent) {\n  return [extent[0], extent[3]];\n}\n\n\n/**\n * Get the top right coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Top right coordinate.\n * @api\n */\nexport function getTopRight(extent) {\n  return [extent[2], extent[3]];\n}\n\n\n/**\n * Get the width of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Width.\n * @api\n */\nexport function getWidth(extent) {\n  return extent[2] - extent[0];\n}\n\n\n/**\n * Determine if one extent intersects another.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent.\n * @return {boolean} The two extents intersect.\n * @api\n */\nexport function intersects(extent1, extent2) {\n  return extent1[0] <= extent2[2] &&\n      extent1[2] >= extent2[0] &&\n      extent1[1] <= extent2[3] &&\n      extent1[3] >= extent2[1];\n}\n\n\n/**\n * Determine if an extent is empty.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} Is empty.\n * @api\n */\nexport function isEmpty(extent) {\n  return extent[2] < extent[0] || extent[3] < extent[1];\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function returnOrUpdate(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent;\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} value Value.\n */\nexport function scaleFromCenter(extent, value) {\n  const deltaX = ((extent[2] - extent[0]) / 2) * (value - 1);\n  const deltaY = ((extent[3] - extent[1]) / 2) * (value - 1);\n  extent[0] -= deltaX;\n  extent[2] += deltaX;\n  extent[1] -= deltaY;\n  extent[3] += deltaY;\n}\n\n\n/**\n * Determine if the segment between two coordinates intersects (crosses,\n * touches, or is contained by) the provided extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @param {module:ol/coordinate~Coordinate} start Segment start coordinate.\n * @param {module:ol/coordinate~Coordinate} end Segment end coordinate.\n * @return {boolean} The segment intersects the extent.\n */\nexport function intersectsSegment(extent, start, end) {\n  let intersects = false;\n  const startRel = coordinateRelationship(extent, start);\n  const endRel = coordinateRelationship(extent, end);\n  if (startRel === Relationship.INTERSECTING ||\n      endRel === Relationship.INTERSECTING) {\n    intersects = true;\n  } else {\n    const minX = extent[0];\n    const minY = extent[1];\n    const maxX = extent[2];\n    const maxY = extent[3];\n    const startX = start[0];\n    const startY = start[1];\n    const endX = end[0];\n    const endY = end[1];\n    const slope = (endY - startY) / (endX - startX);\n    let x, y;\n    if (!!(endRel & Relationship.ABOVE) &&\n        !(startRel & Relationship.ABOVE)) {\n      // potentially intersects top\n      x = endX - ((endY - maxY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.RIGHT) &&\n        !(startRel & Relationship.RIGHT)) {\n      // potentially intersects right\n      y = endY - ((endX - maxX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n    if (!intersects && !!(endRel & Relationship.BELOW) &&\n        !(startRel & Relationship.BELOW)) {\n      // potentially intersects bottom\n      x = endX - ((endY - minY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.LEFT) &&\n        !(startRel & Relationship.LEFT)) {\n      // potentially intersects left\n      y = endY - ((endX - minX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n\n  }\n  return intersects;\n}\n\n\n/**\n * Apply a transform function to the extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/proj~TransformFunction} transformFn Transform function.\n * Called with `[minX, minY, maxX, maxY]` extent coordinates.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nexport function applyTransform(extent, transformFn, opt_extent) {\n  const coordinates = [\n    extent[0], extent[1],\n    extent[0], extent[3],\n    extent[2], extent[1],\n    extent[2], extent[3]\n  ];\n  transformFn(coordinates, coordinates, 2);\n  const xs = [coordinates[0], coordinates[2], coordinates[4], coordinates[6]];\n  const ys = [coordinates[1], coordinates[3], coordinates[5], coordinates[7]];\n  return _boundingExtentXYs(xs, ys, opt_extent);\n}\n","/**\n * @module ol/geom/flat/transform\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function transform2D(flatCoordinates, offset, end, stride, transform, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const x = flatCoordinates[j];\n    const y = flatCoordinates[j + 1];\n    dest[i++] = transform[0] * x + transform[2] * y + transform[4];\n    dest[i++] = transform[1] * x + transform[3] * y + transform[5];\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} angle Angle.\n * @param {Array.<number>} anchor Rotation anchor point.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function rotate(flatCoordinates, offset, end, stride, angle, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + deltaX * cos - deltaY * sin;\n    dest[i++] = anchorY + deltaX * sin + deltaY * cos;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * Scale the coordinates.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} sx Scale factor in the x-direction.\n * @param {number} sy Scale factor in the y-direction.\n * @param {Array.<number>} anchor Scale anchor point.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function scale(flatCoordinates, offset, end, stride, sx, sy, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + sx * deltaX;\n    dest[i++] = anchorY + sy * deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function translate(flatCoordinates, offset, end, stride, deltaX, deltaY, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    dest[i++] = flatCoordinates[j] + deltaX;\n    dest[i++] = flatCoordinates[j + 1] + deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n","/**\n * @module ol/math\n */\nimport {assert} from './asserts.js';\n\n/**\n * Takes a number and clamps it to within the provided bounds.\n * @param {number} value The input number.\n * @param {number} min The minimum value to return.\n * @param {number} max The maximum value to return.\n * @return {number} The input number if it is within bounds, or the nearest\n *     number within the bounds.\n */\nexport function clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n\n/**\n * Return the hyperbolic cosine of a given number. The method will use the\n * native `Math.cosh` function if it is available, otherwise the hyperbolic\n * cosine will be calculated via the reference implementation of the Mozilla\n * developer network.\n *\n * @param {number} x X.\n * @return {number} Hyperbolic cosine of x.\n */\nexport const cosh  = (function() {\n  // Wrapped in a iife, to save the overhead of checking for the native\n  // implementation on every invocation.\n  let cosh;\n  if ('cosh' in Math) {\n    // The environment supports the native Math.cosh function, use it…\n    cosh = Math.cosh;\n  } else {\n    // … else, use the reference implementation of MDN:\n    cosh = function(x) {\n      const y = Math.exp(x);\n      return (y + 1 / y) / 2;\n    };\n  }\n  return cosh;\n}());\n\n\n/**\n * @param {number} x X.\n * @return {number} The smallest power of two greater than or equal to x.\n */\nexport function roundUpToPowerOfTwo(x) {\n  assert(0 < x, 29); // `x` must be greater than `0`\n  return Math.pow(2, Math.ceil(Math.log(x) / Math.LN2));\n}\n\n\n/**\n * Returns the square of the closest distance between the point (x, y) and the\n * line segment (x1, y1) to (x2, y2).\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredSegmentDistance(x, y, x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  if (dx !== 0 || dy !== 0) {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      x1 = x2;\n      y1 = y2;\n    } else if (t > 0) {\n      x1 += dx * t;\n      y1 += dy * t;\n    }\n  }\n  return squaredDistance(x, y, x1, y1);\n}\n\n\n/**\n * Returns the square of the distance between the points (x1, y1) and (x2, y2).\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredDistance(x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Solves system of linear equations using Gaussian elimination method.\n *\n * @param {Array.<Array.<number>>} mat Augmented matrix (n x n + 1 column)\n *                                     in row-major order.\n * @return {Array.<number>} The resulting vector.\n */\nexport function solveLinearSystem(mat) {\n  const n = mat.length;\n\n  for (let i = 0; i < n; i++) {\n    // Find max in the i-th column (ignoring i - 1 first rows)\n    let maxRow = i;\n    let maxEl = Math.abs(mat[i][i]);\n    for (let r = i + 1; r < n; r++) {\n      const absValue = Math.abs(mat[r][i]);\n      if (absValue > maxEl) {\n        maxEl = absValue;\n        maxRow = r;\n      }\n    }\n\n    if (maxEl === 0) {\n      return null; // matrix is singular\n    }\n\n    // Swap max row with i-th (current) row\n    const tmp = mat[maxRow];\n    mat[maxRow] = mat[i];\n    mat[i] = tmp;\n\n    // Subtract the i-th row to make all the remaining rows 0 in the i-th column\n    for (let j = i + 1; j < n; j++) {\n      const coef = -mat[j][i] / mat[i][i];\n      for (let k = i; k < n + 1; k++) {\n        if (i == k) {\n          mat[j][k] = 0;\n        } else {\n          mat[j][k] += coef * mat[i][k];\n        }\n      }\n    }\n  }\n\n  // Solve Ax=b for upper triangular matrix A (mat)\n  const x = new Array(n);\n  for (let l = n - 1; l >= 0; l--) {\n    x[l] = mat[l][n] / mat[l][l];\n    for (let m = l - 1; m >= 0; m--) {\n      mat[m][n] -= mat[m][l] * x[l];\n    }\n  }\n  return x;\n}\n\n\n/**\n * Converts radians to to degrees.\n *\n * @param {number} angleInRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\nexport function toDegrees(angleInRadians) {\n  return angleInRadians * 180 / Math.PI;\n}\n\n\n/**\n * Converts degrees to radians.\n *\n * @param {number} angleInDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\nexport function toRadians(angleInDegrees) {\n  return angleInDegrees * Math.PI / 180;\n}\n\n/**\n * Returns the modulo of a / b, depending on the sign of b.\n *\n * @param {number} a Dividend.\n * @param {number} b Divisor.\n * @return {number} Modulo.\n */\nexport function modulo(a, b) {\n  const r = a % b;\n  return r * b < 0 ? r + b : r;\n}\n\n/**\n * Calculates the linearly interpolated value of x between a and b.\n *\n * @param {number} a Number\n * @param {number} b Number\n * @param {number} x Value to be interpolated.\n * @return {number} Interpolated value.\n */\nexport function lerp(a, b, x) {\n  return a + x * (b - a);\n}\n","/**\n * @module ol/geom/GeometryType\n */\n\n/**\n * The geometry type. One of `'Point'`, `'LineString'`, `'LinearRing'`,\n * `'Polygon'`, `'MultiPoint'`, `'MultiLineString'`, `'MultiPolygon'`,\n * `'GeometryCollection'`, `'Circle'`.\n * @enum {string}\n */\nexport default {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  LINEAR_RING: 'LinearRing',\n  POLYGON: 'Polygon',\n  MULTI_POINT: 'MultiPoint',\n  MULTI_LINE_STRING: 'MultiLineString',\n  MULTI_POLYGON: 'MultiPolygon',\n  GEOMETRY_COLLECTION: 'GeometryCollection',\n  CIRCLE: 'Circle'\n};\n","/**\n * @license\n * Latitude/longitude spherical geodesy formulae taken from\n * http://www.movable-type.co.uk/scripts/latlong.html\n * Licensed under CC-BY-3.0.\n */\n\n/**\n * @module ol/sphere\n */\nimport {toRadians, toDegrees} from './math.js';\nimport GeometryType from './geom/GeometryType.js';\n\n\n/**\n * Object literal with options for the {@link getLength} or {@link getArea}\n * functions.\n * @typedef {Object} SphereMetricOptions\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857']\n * Projection of the  geometry.  By default, the geometry is assumed to be in\n * Web Mercator.\n * @property {number} [radius=6371008.8] Sphere radius.  By default, the radius of the\n * earth is used (Clarke 1866 Authalic Sphere).\n */\n\n\n/**\n * The mean Earth radius (1/3 * (2a + b)) for the WGS84 ellipsoid.\n * https://en.wikipedia.org/wiki/Earth_radius#Mean_radius\n * @type {number}\n */\nexport const DEFAULT_RADIUS = 6371008.8;\n\n\n/**\n * Get the great circle distance (in meters) between two geographic coordinates.\n * @param {Array} c1 Starting coordinate.\n * @param {Array} c2 Ending coordinate.\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {number} The great circle distance between the points (in meters).\n * @api\n */\nexport function getDistance(c1, c2, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lat2 = toRadians(c2[1]);\n  const deltaLatBy2 = (lat2 - lat1) / 2;\n  const deltaLonBy2 = toRadians(c2[0] - c1[0]) / 2;\n  const a = Math.sin(deltaLatBy2) * Math.sin(deltaLatBy2) +\n      Math.sin(deltaLonBy2) * Math.sin(deltaLonBy2) *\n      Math.cos(lat1) * Math.cos(lat2);\n  return 2 * radius * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n}\n\n\n/**\n * Get the cumulative great circle length of linestring coordinates (geographic).\n * @param {Array} coordinates Linestring coordinates.\n * @param {number} radius The sphere radius to use.\n * @return {number} The length (in meters).\n */\nfunction getLengthInternal(coordinates, radius) {\n  let length = 0;\n  for (let i = 0, ii = coordinates.length; i < ii - 1; ++i) {\n    length += getDistance(coordinates[i], coordinates[i + 1], radius);\n  }\n  return length;\n}\n\n\n/**\n * Get the spherical length of a geometry.  This length is the sum of the\n * great circle distances between coordinates.  For polygons, the length is\n * the sum of all rings.  For points, the length is zero.  For multi-part\n * geometries, the length is the sum of the length of each part.\n * @param {module:ol/geom/Geometry} geometry A geometry.\n * @param {module:ol/sphere~SphereMetricOptions=} opt_options Options for the\n * length calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n * You can change this by providing a `projection` option.\n * @return {number} The spherical length (in meters).\n * @api\n */\nexport function getLength(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let length = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT: {\n      break;\n    }\n    case GeometryType.LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      length = getLengthInternal(coordinates, radius);\n      break;\n    }\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        length += getLengthInternal(coordinates[i], radius);\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        for (j = 0, jj = coords.length; j < jj; ++j) {\n          length += getLengthInternal(coords[j], radius);\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        length += getLength(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return length;\n}\n\n\n/**\n * Returns the spherical area for a list of coordinates.\n *\n * [Reference](https://trs-new.jpl.nasa.gov/handle/2014/40409)\n * Robert. G. Chamberlain and William H. Duquette, \"Some Algorithms for\n * Polygons on a Sphere\", JPL Publication 07-03, Jet Propulsion\n * Laboratory, Pasadena, CA, June 2007\n *\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates List of coordinates of a linear\n * ring. If the ring is oriented clockwise, the area will be positive,\n * otherwise it will be negative.\n * @param {number} radius The sphere radius.\n * @return {number} Area (in square meters).\n */\nfunction getAreaInternal(coordinates, radius) {\n  let area = 0;\n  const len = coordinates.length;\n  let x1 = coordinates[len - 1][0];\n  let y1 = coordinates[len - 1][1];\n  for (let i = 0; i < len; i++) {\n    const x2 = coordinates[i][0];\n    const y2 = coordinates[i][1];\n    area += toRadians(x2 - x1) *\n        (2 + Math.sin(toRadians(y1)) +\n        Math.sin(toRadians(y2)));\n    x1 = x2;\n    y1 = y2;\n  }\n  return area * radius * radius / 2.0;\n}\n\n\n/**\n * Get the spherical area of a geometry.  This is the area (in meters) assuming\n * that polygon edges are segments of great circles on a sphere.\n * @param {module:ol/geom/Geometry} geometry A geometry.\n * @param {module:ol/sphere~SphereMetricOptions=} opt_options Options for the area\n *     calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n *     You can change this by providing a `projection` option.\n * @return {number} The spherical area (in square meters).\n * @api\n */\nexport function getArea(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let area = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT:\n    case GeometryType.LINE_STRING:\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      break;\n    }\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getCoordinates();\n      area = Math.abs(getAreaInternal(coordinates[0], radius));\n      for (i = 1, ii = coordinates.length; i < ii; ++i) {\n        area -= Math.abs(getAreaInternal(coordinates[i], radius));\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        area += Math.abs(getAreaInternal(coords[0], radius));\n        for (j = 1, jj = coords.length; j < jj; ++j) {\n          area -= Math.abs(getAreaInternal(coords[j], radius));\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        area += getArea(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return area;\n}\n\n\n/**\n * Returns the coordinate at the given distance and bearing from `c1`.\n *\n * @param {module:ol/coordinate~Coordinate} c1 The origin point (`[lon, lat]` in degrees).\n * @param {number} distance The great-circle distance between the origin\n *     point and the target point.\n * @param {number} bearing The bearing (in radians).\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {module:ol/coordinate~Coordinate} The target point.\n */\nexport function offset(c1, distance, bearing, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lon1 = toRadians(c1[0]);\n  const dByR = distance / radius;\n  const lat = Math.asin(\n    Math.sin(lat1) * Math.cos(dByR) +\n      Math.cos(lat1) * Math.sin(dByR) * Math.cos(bearing));\n  const lon = lon1 + Math.atan2(\n    Math.sin(bearing) * Math.sin(dByR) * Math.cos(lat1),\n    Math.cos(dByR) - Math.sin(lat1) * Math.sin(lat));\n  return [toDegrees(lon), toDegrees(lat)];\n}\n","/**\n * @module ol/proj/Units\n */\n\n/**\n * Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or\n * `'us-ft'`.\n * @enum {string}\n */\nconst Units = {\n  DEGREES: 'degrees',\n  FEET: 'ft',\n  METERS: 'm',\n  PIXELS: 'pixels',\n  TILE_PIXELS: 'tile-pixels',\n  USFEET: 'us-ft'\n};\n\n\n/**\n * Meters per unit lookup table.\n * @const\n * @type {Object.<module:ol/proj/Units, number>}\n * @api\n */\nexport const METERS_PER_UNIT = {};\n// use the radius of the Normal sphere\nMETERS_PER_UNIT[Units.DEGREES] = 2 * Math.PI * 6370997 / 360;\nMETERS_PER_UNIT[Units.FEET] = 0.3048;\nMETERS_PER_UNIT[Units.METERS] = 1;\nMETERS_PER_UNIT[Units.USFEET] = 1200 / 3937;\n\nexport default Units;\n","/**\n * @module ol/proj/Projection\n */\nimport {METERS_PER_UNIT} from '../proj/Units.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} code The SRS identifier code, e.g. `EPSG:4326`.\n * @property {module:ol/proj/Units|string} [units] Units. Required unless a\n * proj4 projection is defined for `code`.\n * @property {module:ol/extent~Extent} [extent] The validity extent for the SRS.\n * @property {string} [axisOrientation='enu'] The axis orientation as specified in Proj4.\n * @property {boolean} [global=false] Whether the projection is valid for the whole globe.\n * @property {number} [metersPerUnit] The meters per unit for the SRS.\n * If not provided, the `units` are used to get the meters per unit from the {@link module:ol/proj/Units~METERS_PER_UNIT}\n * lookup table.\n * @property {module:ol/extent~Extent} [worldExtent] The world extent for the SRS.\n * @property {function(number, module:ol/coordinate~Coordinate):number} [getPointResolution]\n * Function to determine resolution at a point. The function is called with a\n * `{number}` view resolution and an `{module:ol/coordinate~Coordinate}` as arguments, and returns\n * the `{number}` resolution at the passed coordinate. If this is `undefined`,\n * the default {@link module:ol/proj#getPointResolution} function will be used.\n */\n\n\n/**\n * @classdesc\n * Projection definition class. One of these is created for each projection\n * supported in the application and stored in the {@link module:ol/proj} namespace.\n * You can use these in applications, but this is not required, as API params\n * and options use {@link module:ol/proj~ProjectionLike} which means the simple string\n * code will suffice.\n *\n * You can use {@link module:ol/proj~get} to retrieve the object for a particular\n * projection.\n *\n * The library includes definitions for `EPSG:4326` and `EPSG:3857`, together\n * with the following aliases:\n * * `EPSG:4326`: CRS:84, urn:ogc:def:crs:EPSG:6.6:4326,\n *     urn:ogc:def:crs:OGC:1.3:CRS84, urn:ogc:def:crs:OGC:2:84,\n *     http://www.opengis.net/gml/srs/epsg.xml#4326,\n *     urn:x-ogc:def:crs:EPSG:4326\n * * `EPSG:3857`: EPSG:102100, EPSG:102113, EPSG:900913,\n *     urn:ogc:def:crs:EPSG:6.18:3:3857,\n *     http://www.opengis.net/gml/srs/epsg.xml#3857\n *\n * If you use proj4js, aliases can be added using `proj4.defs()`; see\n * [documentation](https://github.com/proj4js/proj4js). To set an alternative\n * namespace for proj4, use {@link module:ol/proj~setProj4}.\n *\n * @constructor\n * @param {module:ol/proj/Projection~Options} options Projection options.\n * @struct\n * @api\n */\nconst Projection = function(options) {\n  /**\n   * @private\n   * @type {string}\n   */\n  this.code_ = options.code;\n\n  /**\n   * Units of projected coordinates. When set to `TILE_PIXELS`, a\n   * `this.extent_` and `this.worldExtent_` must be configured properly for each\n   * tile.\n   * @private\n   * @type {module:ol/proj/Units}\n   */\n  this.units_ = /** @type {module:ol/proj/Units} */ (options.units);\n\n  /**\n   * Validity extent of the projection in projected coordinates. For projections\n   * with `TILE_PIXELS` units, this is the extent of the tile in\n   * tile pixel space.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = options.extent !== undefined ? options.extent : null;\n\n  /**\n   * Extent of the world in EPSG:4326. For projections with\n   * `TILE_PIXELS` units, this is the extent of the tile in\n   * projected coordinate space.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.worldExtent_ = options.worldExtent !== undefined ?\n    options.worldExtent : null;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.axisOrientation_ = options.axisOrientation !== undefined ?\n    options.axisOrientation : 'enu';\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.global_ = options.global !== undefined ? options.global : false;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.canWrapX_ = !!(this.global_ && this.extent_);\n\n  /**\n   * @private\n   * @type {function(number, module:ol/coordinate~Coordinate):number|undefined}\n   */\n  this.getPointResolutionFunc_ = options.getPointResolution;\n\n  /**\n   * @private\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.defaultTileGrid_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.metersPerUnit_ = options.metersPerUnit;\n};\n\n\n/**\n * @return {boolean} The projection is suitable for wrapping the x-axis\n */\nProjection.prototype.canWrapX = function() {\n  return this.canWrapX_;\n};\n\n\n/**\n * Get the code for this projection, e.g. 'EPSG:4326'.\n * @return {string} Code.\n * @api\n */\nProjection.prototype.getCode = function() {\n  return this.code_;\n};\n\n\n/**\n * Get the validity extent for this projection.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nProjection.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n\n/**\n * Get the units of this projection.\n * @return {module:ol/proj/Units} Units.\n * @api\n */\nProjection.prototype.getUnits = function() {\n  return this.units_;\n};\n\n\n/**\n * Get the amount of meters per unit of this projection.  If the projection is\n * not configured with `metersPerUnit` or a units identifier, the return is\n * `undefined`.\n * @return {number|undefined} Meters.\n * @api\n */\nProjection.prototype.getMetersPerUnit = function() {\n  return this.metersPerUnit_ || METERS_PER_UNIT[this.units_];\n};\n\n\n/**\n * Get the world extent for this projection.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nProjection.prototype.getWorldExtent = function() {\n  return this.worldExtent_;\n};\n\n\n/**\n * Get the axis orientation of this projection.\n * Example values are:\n * enu - the default easting, northing, elevation.\n * neu - northing, easting, up - useful for \"lat/long\" geographic coordinates,\n *     or south orientated transverse mercator.\n * wnu - westing, northing, up - some planetary coordinate systems have\n *     \"west positive\" coordinate systems\n * @return {string} Axis orientation.\n * @api\n */\nProjection.prototype.getAxisOrientation = function() {\n  return this.axisOrientation_;\n};\n\n\n/**\n * Is this projection a global projection which spans the whole world?\n * @return {boolean} Whether the projection is global.\n * @api\n */\nProjection.prototype.isGlobal = function() {\n  return this.global_;\n};\n\n\n/**\n* Set if the projection is a global projection which spans the whole world\n* @param {boolean} global Whether the projection is global.\n* @api\n*/\nProjection.prototype.setGlobal = function(global) {\n  this.global_ = global;\n  this.canWrapX_ = !!(global && this.extent_);\n};\n\n\n/**\n * @return {module:ol/tilegrid/TileGrid} The default tile grid.\n */\nProjection.prototype.getDefaultTileGrid = function() {\n  return this.defaultTileGrid_;\n};\n\n\n/**\n * @param {module:ol/tilegrid/TileGrid} tileGrid The default tile grid.\n */\nProjection.prototype.setDefaultTileGrid = function(tileGrid) {\n  this.defaultTileGrid_ = tileGrid;\n};\n\n\n/**\n * Set the validity extent for this projection.\n * @param {module:ol/extent~Extent} extent Extent.\n * @api\n */\nProjection.prototype.setExtent = function(extent) {\n  this.extent_ = extent;\n  this.canWrapX_ = !!(this.global_ && extent);\n};\n\n\n/**\n * Set the world extent for this projection.\n * @param {module:ol/extent~Extent} worldExtent World extent\n *     [minlon, minlat, maxlon, maxlat].\n * @api\n */\nProjection.prototype.setWorldExtent = function(worldExtent) {\n  this.worldExtent_ = worldExtent;\n};\n\n\n/**\n * Set the getPointResolution function (see {@link module:ol/proj~getPointResolution}\n * for this projection.\n * @param {function(number, module:ol/coordinate~Coordinate):number} func Function\n * @api\n */\nProjection.prototype.setGetPointResolution = function(func) {\n  this.getPointResolutionFunc_ = func;\n};\n\n\n/**\n * Get the custom point resolution function for this projection (if set).\n * @return {function(number, module:ol/coordinate~Coordinate):number|undefined} The custom point\n * resolution function (if set).\n */\nProjection.prototype.getPointResolutionFunc = function() {\n  return this.getPointResolutionFunc_;\n};\nexport default Projection;\n","/**\n * @module ol/proj/epsg3857\n */\nimport {inherits} from '../index.js';\nimport {cosh} from '../math.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\n\n\n/**\n * Radius of WGS84 sphere\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const HALF_SIZE = Math.PI * RADIUS;\n\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const EXTENT = [\n  -HALF_SIZE, -HALF_SIZE,\n  HALF_SIZE, HALF_SIZE\n];\n\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const WORLD_EXTENT = [-180, -85, 180, 85];\n\n\n/**\n * @classdesc\n * Projection object for web/spherical Mercator (EPSG:3857).\n *\n * @constructor\n * @extends {module:ol/proj/Projection}\n * @param {string} code Code.\n */\nfunction EPSG3857Projection(code) {\n  Projection.call(this, {\n    code: code,\n    units: Units.METERS,\n    extent: EXTENT,\n    global: true,\n    worldExtent: WORLD_EXTENT,\n    getPointResolution: function(resolution, point) {\n      return resolution / cosh(point[1] / RADIUS);\n    }\n  });\n}\ninherits(EPSG3857Projection, Projection);\n\n\n/**\n * Projections equal to EPSG:3857.\n *\n * @const\n * @type {Array.<module:ol/proj/Projection>}\n */\nexport const PROJECTIONS = [\n  new EPSG3857Projection('EPSG:3857'),\n  new EPSG3857Projection('EPSG:102100'),\n  new EPSG3857Projection('EPSG:102113'),\n  new EPSG3857Projection('EPSG:900913'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG:6.18:3:3857'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG::3857'),\n  new EPSG3857Projection('http://www.opengis.net/gml/srs/epsg.xml#3857')\n];\n\n\n/**\n * Transformation from EPSG:4326 to EPSG:3857.\n *\n * @param {Array.<number>} input Input array of coordinate values.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array.<number>} Output array of coordinate values.\n */\nexport function fromEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  const halfSize = HALF_SIZE;\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = halfSize * input[i] / 180;\n    let y = RADIUS *\n        Math.log(Math.tan(Math.PI * (input[i + 1] + 90) / 360));\n    if (y > halfSize) {\n      y = halfSize;\n    } else if (y < -halfSize) {\n      y = -halfSize;\n    }\n    output[i + 1] = y;\n  }\n  return output;\n}\n\n\n/**\n * Transformation from EPSG:3857 to EPSG:4326.\n *\n * @param {Array.<number>} input Input array of coordinate values.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array.<number>} Output array of coordinate values.\n */\nexport function toEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = 180 * input[i] / HALF_SIZE;\n    output[i + 1] = 360 * Math.atan(\n      Math.exp(input[i + 1] / RADIUS)) / Math.PI - 90;\n  }\n  return output;\n}\n","/**\n * @module ol/proj/epsg4326\n */\nimport {inherits} from '../index.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\n\n\n/**\n * Semi-major radius of the WGS84 ellipsoid.\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * Extent of the EPSG:4326 projection which is the whole world.\n *\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const EXTENT = [-180, -90, 180, 90];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const METERS_PER_UNIT = Math.PI * RADIUS / 180;\n\n\n/**\n * @classdesc\n * Projection object for WGS84 geographic coordinates (EPSG:4326).\n *\n * Note that OpenLayers does not strictly comply with the EPSG definition.\n * The EPSG registry defines 4326 as a CRS for Latitude,Longitude (y,x).\n * OpenLayers treats EPSG:4326 as a pseudo-projection, with x,y coordinates.\n *\n * @constructor\n * @extends {module:ol/proj/Projection}\n * @param {string} code Code.\n * @param {string=} opt_axisOrientation Axis orientation.\n */\nfunction EPSG4326Projection(code, opt_axisOrientation) {\n  Projection.call(this, {\n    code: code,\n    units: Units.DEGREES,\n    extent: EXTENT,\n    axisOrientation: opt_axisOrientation,\n    global: true,\n    metersPerUnit: METERS_PER_UNIT,\n    worldExtent: EXTENT\n  });\n}\ninherits(EPSG4326Projection, Projection);\n\n\n/**\n * Projections equal to EPSG:4326.\n *\n * @const\n * @type {Array.<module:ol/proj/Projection>}\n */\nexport const PROJECTIONS = [\n  new EPSG4326Projection('CRS:84'),\n  new EPSG4326Projection('EPSG:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG::4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG:6.6:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:1.3:CRS84'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:2:84'),\n  new EPSG4326Projection('http://www.opengis.net/gml/srs/epsg.xml#4326', 'neu'),\n  new EPSG4326Projection('urn:x-ogc:def:crs:EPSG:4326', 'neu')\n];\n","/**\n * @module ol/proj/projections\n */\n\n\n/**\n * @type {Object.<string, module:ol/proj/Projection>}\n */\nlet cache = {};\n\n\n/**\n * Clear the projections cache.\n */\nexport function clear() {\n  cache = {};\n}\n\n\n/**\n * Get a cached projection by code.\n * @param {string} code The code for the projection.\n * @return {module:ol/proj/Projection} The projection (if cached).\n */\nexport function get(code) {\n  return cache[code] || null;\n}\n\n\n/**\n * Add a projection to the cache.\n * @param {string} code The projection code.\n * @param {module:ol/proj/Projection} projection The projection to cache.\n */\nexport function add(code, projection) {\n  cache[code] = projection;\n}\n","/**\n * @module ol/proj/transforms\n */\nimport {isEmpty} from '../obj.js';\n\n\n/**\n * @private\n * @type {!Object.<string, Object.<string, module:ol/proj~TransformFunction>>}\n */\nlet transforms = {};\n\n\n/**\n * Clear the transform cache.\n */\nexport function clear() {\n  transforms = {};\n}\n\n\n/**\n * Registers a conversion function to convert coordinates from the source\n * projection to the destination projection.\n *\n * @param {module:ol/proj/Projection} source Source.\n * @param {module:ol/proj/Projection} destination Destination.\n * @param {module:ol/proj~TransformFunction} transformFn Transform.\n */\nexport function add(source, destination, transformFn) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  if (!(sourceCode in transforms)) {\n    transforms[sourceCode] = {};\n  }\n  transforms[sourceCode][destinationCode] = transformFn;\n}\n\n\n/**\n * Unregisters the conversion function to convert coordinates from the source\n * projection to the destination projection.  This method is used to clean up\n * cached transforms during testing.\n *\n * @param {module:ol/proj/Projection} source Source projection.\n * @param {module:ol/proj/Projection} destination Destination projection.\n * @return {module:ol/proj~TransformFunction} transformFn The unregistered transform.\n */\nexport function remove(source, destination) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  const transform = transforms[sourceCode][destinationCode];\n  delete transforms[sourceCode][destinationCode];\n  if (isEmpty(transforms[sourceCode])) {\n    delete transforms[sourceCode];\n  }\n  return transform;\n}\n\n\n/**\n * Get a transform given a source code and a destination code.\n * @param {string} sourceCode The code for the source projection.\n * @param {string} destinationCode The code for the destination projection.\n * @return {module:ol/proj~TransformFunction|undefined} The transform function (if found).\n */\nexport function get(sourceCode, destinationCode) {\n  let transform;\n  if (sourceCode in transforms && destinationCode in transforms[sourceCode]) {\n    transform = transforms[sourceCode][destinationCode];\n  }\n  return transform;\n}\n","/**\n * @module ol/proj\n */\n\n/**\n * The ol/proj module stores:\n * * a list of {@link module:ol/proj/Projection}\n * objects, one for each projection supported by the application\n * * a list of transform functions needed to convert coordinates in one projection\n * into another.\n *\n * The static functions are the methods used to maintain these.\n * Each transform function can handle not only simple coordinate pairs, but also\n * large arrays of coordinates such as vector geometries.\n *\n * When loaded, the library adds projection objects for EPSG:4326 (WGS84\n * geographic coordinates) and EPSG:3857 (Web or Spherical Mercator, as used\n * for example by Bing Maps or OpenStreetMap), together with the relevant\n * transform functions.\n *\n * Additional transforms may be added by using the {@link http://proj4js.org/}\n * library (version 2.2 or later). You can use the full build supplied by\n * Proj4js, or create a custom build to support those projections you need; see\n * the Proj4js website for how to do this. You also need the Proj4js definitions\n * for the required projections. These definitions can be obtained from\n * {@link https://epsg.io/}, and are a JS function, so can be loaded in a script\n * tag (as in the examples) or pasted into your application.\n *\n * After all required projection definitions are added to proj4's registry (by\n * using `proj4.defs()`), simply call `register(proj4)` from the `ol/proj/proj4`\n * package. Existing transforms are not changed by this function. See\n * examples/wms-image-custom-proj for an example of this.\n *\n * Additional projection definitions can be registered with `proj4.defs()` any\n * time. Just make sure to call `register(proj4)` again; for example, with user-supplied data where you don't\n * know in advance what projections are needed, you can initially load minimal\n * support and then load whichever are requested.\n *\n * Note that Proj4js does not support projection extents. If you want to add\n * one for creating default tile grids, you can add it after the Projection\n * object has been created with `setExtent`, for example,\n * `get('EPSG:1234').setExtent(extent)`.\n *\n * In addition to Proj4js support, any transform functions can be added with\n * {@link module:ol/proj~addCoordinateTransforms}. To use this, you must first create\n * a {@link module:ol/proj/Projection} object for the new projection and add it with\n * {@link module:ol/proj~addProjection}. You can then add the forward and inverse\n * functions with {@link module:ol/proj~addCoordinateTransforms}. See\n * examples/wms-custom-proj for an example of this.\n *\n * Note that if no transforms are needed and you only need to define the\n * projection, just add a {@link module:ol/proj/Projection} with\n * {@link module:ol/proj~addProjection}. See examples/wms-no-proj for an example of\n * this.\n */\nimport {getDistance} from './sphere.js';\nimport {applyTransform} from './extent.js';\nimport {modulo} from './math.js';\nimport {toEPSG4326, fromEPSG4326, PROJECTIONS as EPSG3857_PROJECTIONS} from './proj/epsg3857.js';\nimport {PROJECTIONS as EPSG4326_PROJECTIONS} from './proj/epsg4326.js';\nimport Projection from './proj/Projection.js';\nimport Units, {METERS_PER_UNIT} from './proj/Units.js';\nimport * as projections from './proj/projections.js';\nimport {add as addTransformFunc, clear as clearTransformFuncs, get as getTransformFunc} from './proj/transforms.js';\n\n\n/**\n * A projection as {@link module:ol/proj/Projection}, SRS identifier\n * string or undefined.\n * @typedef {module:ol/proj/Projection|string|undefined} ProjectionLike\n * @api\n */\n\n\n/**\n * A transform function accepts an array of input coordinate values, an optional\n * output array, and an optional dimension (default should be 2).  The function\n * transforms the input coordinate values, populates the output array, and\n * returns the output array.\n *\n * @typedef {function(Array.<number>, Array.<number>=, number=): Array.<number>} TransformFunction\n * @api\n */\n\n\nexport {METERS_PER_UNIT};\n\n\n/**\n * @param {Array.<number>} input Input coordinate array.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array.<number>} Output coordinate array (new array, same coordinate\n *     values).\n */\nexport function cloneTransform(input, opt_output, opt_dimension) {\n  let output;\n  if (opt_output !== undefined) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    output = opt_output;\n  } else {\n    output = input.slice();\n  }\n  return output;\n}\n\n\n/**\n * @param {Array.<number>} input Input coordinate array.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array.<number>} Input coordinate array (same array as input).\n */\nexport function identityTransform(input, opt_output, opt_dimension) {\n  if (opt_output !== undefined && input !== opt_output) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    input = opt_output;\n  }\n  return input;\n}\n\n\n/**\n * Add a Projection object to the list of supported projections that can be\n * looked up by their code.\n *\n * @param {module:ol/proj/Projection} projection Projection instance.\n * @api\n */\nexport function addProjection(projection) {\n  projections.add(projection.getCode(), projection);\n  addTransformFunc(projection, projection, cloneTransform);\n}\n\n\n/**\n * @param {Array.<module:ol/proj/Projection>} projections Projections.\n */\nexport function addProjections(projections) {\n  projections.forEach(addProjection);\n}\n\n\n/**\n * Fetches a Projection object for the code specified.\n *\n * @param {module:ol/proj~ProjectionLike} projectionLike Either a code string which is\n *     a combination of authority and identifier such as \"EPSG:4326\", or an\n *     existing projection object, or undefined.\n * @return {module:ol/proj/Projection} Projection object, or null if not in list.\n * @api\n */\nexport function get(projectionLike) {\n  let projection = null;\n  if (projectionLike instanceof Projection) {\n    projection = projectionLike;\n  } else if (typeof projectionLike === 'string') {\n    const code = projectionLike;\n    projection = projections.get(code);\n  }\n  return projection;\n}\n\n\n/**\n * Get the resolution of the point in degrees or distance units.\n * For projections with degrees as the unit this will simply return the\n * provided resolution. For other projections the point resolution is\n * by default estimated by transforming the 'point' pixel to EPSG:4326,\n * measuring its width and height on the normal sphere,\n * and taking the average of the width and height.\n * A custom function can be provided for a specific projection, either\n * by setting the `getPointResolution` option in the\n * {@link module:ol/proj/Projection~Projection} constructor or by using\n * {@link module:ol/proj/Projection~Projection#setGetPointResolution} to change an existing\n * projection object.\n * @param {module:ol/proj~ProjectionLike} projection The projection.\n * @param {number} resolution Nominal resolution in projection units.\n * @param {module:ol/coordinate~Coordinate} point Point to find adjusted resolution at.\n * @param {module:ol/proj/Units=} opt_units Units to get the point resolution in.\n * Default is the projection's units.\n * @return {number} Point resolution.\n * @api\n */\nexport function getPointResolution(projection, resolution, point, opt_units) {\n  projection = get(projection);\n  let pointResolution;\n  const getter = projection.getPointResolutionFunc();\n  if (getter) {\n    pointResolution = getter(resolution, point);\n  } else {\n    const units = projection.getUnits();\n    if (units == Units.DEGREES && !opt_units || opt_units == Units.DEGREES) {\n      pointResolution = resolution;\n    } else {\n      // Estimate point resolution by transforming the center pixel to EPSG:4326,\n      // measuring its width and height on the normal sphere, and taking the\n      // average of the width and height.\n      const toEPSG4326 = getTransformFromProjections(projection, get('EPSG:4326'));\n      let vertices = [\n        point[0] - resolution / 2, point[1],\n        point[0] + resolution / 2, point[1],\n        point[0], point[1] - resolution / 2,\n        point[0], point[1] + resolution / 2\n      ];\n      vertices = toEPSG4326(vertices, vertices, 2);\n      const width = getDistance(vertices.slice(0, 2), vertices.slice(2, 4));\n      const height = getDistance(vertices.slice(4, 6), vertices.slice(6, 8));\n      pointResolution = (width + height) / 2;\n      const metersPerUnit = opt_units ?\n        METERS_PER_UNIT[opt_units] :\n        projection.getMetersPerUnit();\n      if (metersPerUnit !== undefined) {\n        pointResolution /= metersPerUnit;\n      }\n    }\n  }\n  return pointResolution;\n}\n\n\n/**\n * Registers transformation functions that don't alter coordinates. Those allow\n * to transform between projections with equal meaning.\n *\n * @param {Array.<module:ol/proj/Projection>} projections Projections.\n * @api\n */\nexport function addEquivalentProjections(projections) {\n  addProjections(projections);\n  projections.forEach(function(source) {\n    projections.forEach(function(destination) {\n      if (source !== destination) {\n        addTransformFunc(source, destination, cloneTransform);\n      }\n    });\n  });\n}\n\n\n/**\n * Registers transformation functions to convert coordinates in any projection\n * in projection1 to any projection in projection2.\n *\n * @param {Array.<module:ol/proj/Projection>} projections1 Projections with equal\n *     meaning.\n * @param {Array.<module:ol/proj/Projection>} projections2 Projections with equal\n *     meaning.\n * @param {module:ol/proj~TransformFunction} forwardTransform Transformation from any\n *   projection in projection1 to any projection in projection2.\n * @param {module:ol/proj~TransformFunction} inverseTransform Transform from any projection\n *   in projection2 to any projection in projection1..\n */\nexport function addEquivalentTransforms(projections1, projections2, forwardTransform, inverseTransform) {\n  projections1.forEach(function(projection1) {\n    projections2.forEach(function(projection2) {\n      addTransformFunc(projection1, projection2, forwardTransform);\n      addTransformFunc(projection2, projection1, inverseTransform);\n    });\n  });\n}\n\n\n/**\n * Clear all cached projections and transforms.\n */\nexport function clearAllProjections() {\n  projections.clear();\n  clearTransformFuncs();\n}\n\n\n/**\n * @param {module:ol/proj/Projection|string|undefined} projection Projection.\n * @param {string} defaultCode Default code.\n * @return {module:ol/proj/Projection} Projection.\n */\nexport function createProjection(projection, defaultCode) {\n  if (!projection) {\n    return get(defaultCode);\n  } else if (typeof projection === 'string') {\n    return get(projection);\n  } else {\n    return (\n      /** @type {module:ol/proj/Projection} */ (projection)\n    );\n  }\n}\n\n\n/**\n * Creates a {@link module:ol/proj~TransformFunction} from a simple 2D coordinate transform\n * function.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} coordTransform Coordinate\n *     transform.\n * @return {module:ol/proj~TransformFunction} Transform function.\n */\nexport function createTransformFromCoordinateTransform(coordTransform) {\n  return (\n    /**\n     * @param {Array.<number>} input Input.\n     * @param {Array.<number>=} opt_output Output.\n     * @param {number=} opt_dimension Dimension.\n     * @return {Array.<number>} Output.\n     */\n    function(input, opt_output, opt_dimension) {\n      const length = input.length;\n      const dimension = opt_dimension !== undefined ? opt_dimension : 2;\n      const output = opt_output !== undefined ? opt_output : new Array(length);\n      for (let i = 0; i < length; i += dimension) {\n        const point = coordTransform([input[i], input[i + 1]]);\n        output[i] = point[0];\n        output[i + 1] = point[1];\n        for (let j = dimension - 1; j >= 2; --j) {\n          output[i + j] = input[i + j];\n        }\n      }\n      return output;\n    });\n}\n\n\n/**\n * Registers coordinate transform functions to convert coordinates between the\n * source projection and the destination projection.\n * The forward and inverse functions convert coordinate pairs; this function\n * converts these into the functions used internally which also handle\n * extents and coordinate arrays.\n *\n * @param {module:ol/proj~ProjectionLike} source Source projection.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} forward The forward transform\n *     function (that is, from the source projection to the destination\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} inverse The inverse transform\n *     function (that is, from the destination projection to the source\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @api\n */\nexport function addCoordinateTransforms(source, destination, forward, inverse) {\n  const sourceProj = get(source);\n  const destProj = get(destination);\n  addTransformFunc(sourceProj, destProj, createTransformFromCoordinateTransform(forward));\n  addTransformFunc(destProj, sourceProj, createTransformFromCoordinateTransform(inverse));\n}\n\n\n/**\n * Transforms a coordinate from longitude/latitude to a different projection.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate as longitude and latitude, i.e.\n *     an array with longitude as 1st and latitude as 2nd element.\n * @param {module:ol/proj~ProjectionLike=} opt_projection Target projection. The\n *     default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {module:ol/coordinate~Coordinate} Coordinate projected to the target projection.\n * @api\n */\nexport function fromLonLat(coordinate, opt_projection) {\n  return transform(coordinate, 'EPSG:4326',\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857');\n}\n\n\n/**\n * Transforms a coordinate to longitude/latitude.\n * @param {module:ol/coordinate~Coordinate} coordinate Projected coordinate.\n * @param {module:ol/proj~ProjectionLike=} opt_projection Projection of the coordinate.\n *     The default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {module:ol/coordinate~Coordinate} Coordinate as longitude and latitude, i.e. an array\n *     with longitude as 1st and latitude as 2nd element.\n * @api\n */\nexport function toLonLat(coordinate, opt_projection) {\n  const lonLat = transform(coordinate,\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857', 'EPSG:4326');\n  const lon = lonLat[0];\n  if (lon < -180 || lon > 180) {\n    lonLat[0] = modulo(lon + 180, 360) - 180;\n  }\n  return lonLat;\n}\n\n\n/**\n * Checks if two projections are the same, that is every coordinate in one\n * projection does represent the same geographic point as the same coordinate in\n * the other projection.\n *\n * @param {module:ol/proj/Projection} projection1 Projection 1.\n * @param {module:ol/proj/Projection} projection2 Projection 2.\n * @return {boolean} Equivalent.\n * @api\n */\nexport function equivalent(projection1, projection2) {\n  if (projection1 === projection2) {\n    return true;\n  }\n  const equalUnits = projection1.getUnits() === projection2.getUnits();\n  if (projection1.getCode() === projection2.getCode()) {\n    return equalUnits;\n  } else {\n    const transformFunc = getTransformFromProjections(projection1, projection2);\n    return transformFunc === cloneTransform && equalUnits;\n  }\n}\n\n\n/**\n * Searches in the list of transform functions for the function for converting\n * coordinates from the source projection to the destination projection.\n *\n * @param {module:ol/proj/Projection} sourceProjection Source Projection object.\n * @param {module:ol/proj/Projection} destinationProjection Destination Projection\n *     object.\n * @return {module:ol/proj~TransformFunction} Transform function.\n */\nexport function getTransformFromProjections(sourceProjection, destinationProjection) {\n  const sourceCode = sourceProjection.getCode();\n  const destinationCode = destinationProjection.getCode();\n  let transformFunc = getTransformFunc(sourceCode, destinationCode);\n  if (!transformFunc) {\n    transformFunc = identityTransform;\n  }\n  return transformFunc;\n}\n\n\n/**\n * Given the projection-like objects, searches for a transformation\n * function to convert a coordinates array from the source projection to the\n * destination projection.\n *\n * @param {module:ol/proj~ProjectionLike} source Source.\n * @param {module:ol/proj~ProjectionLike} destination Destination.\n * @return {module:ol/proj~TransformFunction} Transform function.\n * @api\n */\nexport function getTransform(source, destination) {\n  const sourceProjection = get(source);\n  const destinationProjection = get(destination);\n  return getTransformFromProjections(sourceProjection, destinationProjection);\n}\n\n\n/**\n * Transforms a coordinate from source projection to destination projection.\n * This returns a new coordinate (and does not modify the original).\n *\n * See {@link module:ol/proj~transformExtent} for extent transformation.\n * See the transform method of {@link module:ol/geom/Geometry~Geometry} and its\n * subclasses for geometry transforms.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/proj~ProjectionLike} source Source projection-like.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection-like.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nexport function transform(coordinate, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return transformFunc(coordinate, undefined, coordinate.length);\n}\n\n\n/**\n * Transforms an extent from source projection to destination projection.  This\n * returns a new extent (and does not modify the original).\n *\n * @param {module:ol/extent~Extent} extent The extent to transform.\n * @param {module:ol/proj~ProjectionLike} source Source projection-like.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection-like.\n * @return {module:ol/extent~Extent} The transformed extent.\n * @api\n */\nexport function transformExtent(extent, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return applyTransform(extent, transformFunc);\n}\n\n\n/**\n * Transforms the given point to the destination projection.\n *\n * @param {module:ol/coordinate~Coordinate} point Point.\n * @param {module:ol/proj/Projection} sourceProjection Source projection.\n * @param {module:ol/proj/Projection} destinationProjection Destination projection.\n * @return {module:ol/coordinate~Coordinate} Point.\n */\nexport function transformWithProjections(point, sourceProjection, destinationProjection) {\n  const transformFunc = getTransformFromProjections(sourceProjection, destinationProjection);\n  return transformFunc(point);\n}\n\n/**\n * Add transforms to and from EPSG:4326 and EPSG:3857.  This function is called\n * by when this module is executed and should only need to be called again after\n * `clearAllProjections()` is called (e.g. in tests).\n */\nexport function addCommon() {\n  // Add transformations that don't alter coordinates to convert within set of\n  // projections with equal meaning.\n  addEquivalentProjections(EPSG3857_PROJECTIONS);\n  addEquivalentProjections(EPSG4326_PROJECTIONS);\n  // Add transformations to convert EPSG:4326 like coordinates to EPSG:3857 like\n  // coordinates and back.\n  addEquivalentTransforms(EPSG4326_PROJECTIONS, EPSG3857_PROJECTIONS, fromEPSG4326, toEPSG4326);\n}\n\naddCommon();\n","/**\n * @module ol/transform\n */\nimport {assert} from './asserts.js';\n\n\n/**\n * An array representing an affine 2d transformation for use with\n * {@link module:ol/transform} functions. The array has 6 elements.\n * @typedef {!Array.<number>} Transform\n */\n\n\n/**\n * Collection of affine 2d transformation functions. The functions work on an\n * array of 6 elements. The element order is compatible with the [SVGMatrix\n * interface](https://developer.mozilla.org/en-US/docs/Web/API/SVGMatrix) and is\n * a subset (elements a to f) of a 3×3 matrix:\n * ```\n * [ a c e ]\n * [ b d f ]\n * [ 0 0 1 ]\n * ```\n */\n\n\n/**\n * @private\n * @type {module:ol/transform~Transform}\n */\nconst tmp_ = new Array(6);\n\n\n/**\n * Create an identity transform.\n * @return {!module:ol/transform~Transform} Identity transform.\n */\nexport function create() {\n  return [1, 0, 0, 1, 0, 0];\n}\n\n\n/**\n * Resets the given transform to an identity transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @return {!module:ol/transform~Transform} Transform.\n */\nexport function reset(transform) {\n  return set(transform, 1, 0, 0, 1, 0, 0);\n}\n\n\n/**\n * Multiply the underlying matrices of two transforms and return the result in\n * the first transform.\n * @param {!module:ol/transform~Transform} transform1 Transform parameters of matrix 1.\n * @param {!module:ol/transform~Transform} transform2 Transform parameters of matrix 2.\n * @return {!module:ol/transform~Transform} transform1 multiplied with transform2.\n */\nexport function multiply(transform1, transform2) {\n  const a1 = transform1[0];\n  const b1 = transform1[1];\n  const c1 = transform1[2];\n  const d1 = transform1[3];\n  const e1 = transform1[4];\n  const f1 = transform1[5];\n  const a2 = transform2[0];\n  const b2 = transform2[1];\n  const c2 = transform2[2];\n  const d2 = transform2[3];\n  const e2 = transform2[4];\n  const f2 = transform2[5];\n\n  transform1[0] = a1 * a2 + c1 * b2;\n  transform1[1] = b1 * a2 + d1 * b2;\n  transform1[2] = a1 * c2 + c1 * d2;\n  transform1[3] = b1 * c2 + d1 * d2;\n  transform1[4] = a1 * e2 + c1 * f2 + e1;\n  transform1[5] = b1 * e2 + d1 * f2 + f1;\n\n  return transform1;\n}\n\n/**\n * Set the transform components a-f on a given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} a The a component of the transform.\n * @param {number} b The b component of the transform.\n * @param {number} c The c component of the transform.\n * @param {number} d The d component of the transform.\n * @param {number} e The e component of the transform.\n * @param {number} f The f component of the transform.\n * @return {!module:ol/transform~Transform} Matrix with transform applied.\n */\nexport function set(transform, a, b, c, d, e, f) {\n  transform[0] = a;\n  transform[1] = b;\n  transform[2] = c;\n  transform[3] = d;\n  transform[4] = e;\n  transform[5] = f;\n  return transform;\n}\n\n\n/**\n * Set transform on one matrix from another matrix.\n * @param {!module:ol/transform~Transform} transform1 Matrix to set transform to.\n * @param {!module:ol/transform~Transform} transform2 Matrix to set transform from.\n * @return {!module:ol/transform~Transform} transform1 with transform from transform2 applied.\n */\nexport function setFromArray(transform1, transform2) {\n  transform1[0] = transform2[0];\n  transform1[1] = transform2[1];\n  transform1[2] = transform2[2];\n  transform1[3] = transform2[3];\n  transform1[4] = transform2[4];\n  transform1[5] = transform2[5];\n  return transform1;\n}\n\n\n/**\n * Transforms the given coordinate with the given transform returning the\n * resulting, transformed coordinate. The coordinate will be modified in-place.\n *\n * @param {module:ol/transform~Transform} transform The transformation.\n * @param {module:ol/coordinate~Coordinate|module:ol~Pixel} coordinate The coordinate to transform.\n * @return {module:ol/coordinate~Coordinate|module:ol~Pixel} return coordinate so that operations can be\n *     chained together.\n */\nexport function apply(transform, coordinate) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  coordinate[0] = transform[0] * x + transform[2] * y + transform[4];\n  coordinate[1] = transform[1] * x + transform[3] * y + transform[5];\n  return coordinate;\n}\n\n\n/**\n * Applies rotation to the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} angle Angle in radians.\n * @return {!module:ol/transform~Transform} The rotated transform.\n */\nexport function rotate(transform, angle) {\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  return multiply(transform, set(tmp_, cos, sin, -sin, cos, 0, 0));\n}\n\n\n/**\n * Applies scale to a given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} x Scale factor x.\n * @param {number} y Scale factor y.\n * @return {!module:ol/transform~Transform} The scaled transform.\n */\nexport function scale(transform, x, y) {\n  return multiply(transform, set(tmp_, x, 0, 0, y, 0, 0));\n}\n\n\n/**\n * Applies translation to the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} dx Translation x.\n * @param {number} dy Translation y.\n * @return {!module:ol/transform~Transform} The translated transform.\n */\nexport function translate(transform, dx, dy) {\n  return multiply(transform, set(tmp_, 1, 0, 0, 1, dx, dy));\n}\n\n\n/**\n * Creates a composite transform given an initial translation, scale, rotation, and\n * final translation (in that order only, not commutative).\n * @param {!module:ol/transform~Transform} transform The transform (will be modified in place).\n * @param {number} dx1 Initial translation x.\n * @param {number} dy1 Initial translation y.\n * @param {number} sx Scale factor x.\n * @param {number} sy Scale factor y.\n * @param {number} angle Rotation (in counter-clockwise radians).\n * @param {number} dx2 Final translation x.\n * @param {number} dy2 Final translation y.\n * @return {!module:ol/transform~Transform} The composite transform.\n */\nexport function compose(transform, dx1, dy1, sx, sy, angle, dx2, dy2) {\n  const sin = Math.sin(angle);\n  const cos = Math.cos(angle);\n  transform[0] = sx * cos;\n  transform[1] = sy * sin;\n  transform[2] = -sx * sin;\n  transform[3] = sy * cos;\n  transform[4] = dx2 * sx * cos - dy2 * sx * sin + dx1;\n  transform[5] = dx2 * sy * sin + dy2 * sy * cos + dy1;\n  return transform;\n}\n\n\n/**\n * Invert the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @return {!module:ol/transform~Transform} Inverse of the transform.\n */\nexport function invert(transform) {\n  const det = determinant(transform);\n  assert(det !== 0, 32); // Transformation matrix cannot be inverted\n\n  const a = transform[0];\n  const b = transform[1];\n  const c = transform[2];\n  const d = transform[3];\n  const e = transform[4];\n  const f = transform[5];\n\n  transform[0] = d / det;\n  transform[1] = -b / det;\n  transform[2] = -c / det;\n  transform[3] = a / det;\n  transform[4] = (c * f - d * e) / det;\n  transform[5] = -(a * f - b * e) / det;\n\n  return transform;\n}\n\n\n/**\n * Returns the determinant of the given matrix.\n * @param {!module:ol/transform~Transform} mat Matrix.\n * @return {number} Determinant.\n */\nexport function determinant(mat) {\n  return mat[0] * mat[3] - mat[1] * mat[2];\n}\n","/**\n * @module ol/geom/Geometry\n */\nimport {inherits} from '../index.js';\nimport BaseObject from '../Object.js';\nimport {createEmpty, getHeight, returnOrUpdate} from '../extent.js';\nimport {FALSE} from '../functions.js';\nimport {transform2D} from '../geom/flat/transform.js';\nimport {get as getProjection, getTransform} from '../proj.js';\nimport Units from '../proj/Units.js';\nimport {create as createTransform, compose as composeTransform} from '../transform.js';\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for vector geometries.\n *\n * To get notified of changes to the geometry, register a listener for the\n * generic `change` event on your geometry instance.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @api\n */\nconst Geometry = function() {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.extentRevision_ = -1;\n\n  /**\n   * @protected\n   * @type {Object.<string, module:ol/geom/Geometry>}\n   */\n  this.simplifiedGeometryCache = {};\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.simplifiedGeometryRevision = 0;\n\n};\n\ninherits(Geometry, BaseObject);\n\n\n/**\n * @type {module:ol/transform~Transform}\n */\nconst tmpTransform = createTransform();\n\n\n/**\n * Make a complete copy of the geometry.\n * @abstract\n * @return {!module:ol/geom/Geometry} Clone.\n */\nGeometry.prototype.clone = function() {};\n\n\n/**\n * @abstract\n * @param {number} x X.\n * @param {number} y Y.\n * @param {module:ol/coordinate~Coordinate} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @return {number} Minimum squared distance.\n */\nGeometry.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {};\n\n\n/**\n * Return the closest point of the geometry to the passed point as\n * {@link module:ol/coordinate~Coordinate coordinate}.\n * @param {module:ol/coordinate~Coordinate} point Point.\n * @param {module:ol/coordinate~Coordinate=} opt_closestPoint Closest point.\n * @return {module:ol/coordinate~Coordinate} Closest point.\n * @api\n */\nGeometry.prototype.getClosestPoint = function(point, opt_closestPoint) {\n  const closestPoint = opt_closestPoint ? opt_closestPoint : [NaN, NaN];\n  this.closestPointXY(point[0], point[1], closestPoint, Infinity);\n  return closestPoint;\n};\n\n\n/**\n * Returns true if this geometry includes the specified coordinate. If the\n * coordinate is on the boundary of the geometry, returns false.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {boolean} Contains coordinate.\n * @api\n */\nGeometry.prototype.intersectsCoordinate = function(coordinate) {\n  return this.containsXY(coordinate[0], coordinate[1]);\n};\n\n\n/**\n * @abstract\n * @param {module:ol/extent~Extent} extent Extent.\n * @protected\n * @return {module:ol/extent~Extent} extent Extent.\n */\nGeometry.prototype.computeExtent = function(extent) {};\n\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nGeometry.prototype.containsXY = FALSE;\n\n\n/**\n * Get the extent of the geometry.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} extent Extent.\n * @api\n */\nGeometry.prototype.getExtent = function(opt_extent) {\n  if (this.extentRevision_ != this.getRevision()) {\n    this.extent_ = this.computeExtent(this.extent_);\n    this.extentRevision_ = this.getRevision();\n  }\n  return returnOrUpdate(this.extent_, opt_extent);\n};\n\n\n/**\n * Rotate the geometry around a given coordinate. This modifies the geometry\n * coordinates in place.\n * @abstract\n * @param {number} angle Rotation angle in radians.\n * @param {module:ol/coordinate~Coordinate} anchor The rotation center.\n * @api\n */\nGeometry.prototype.rotate = function(angle, anchor) {};\n\n\n/**\n * Scale the geometry (with an optional origin).  This modifies the geometry\n * coordinates in place.\n * @abstract\n * @param {number} sx The scaling factor in the x-direction.\n * @param {number=} opt_sy The scaling factor in the y-direction (defaults to\n *     sx).\n * @param {module:ol/coordinate~Coordinate=} opt_anchor The scale origin (defaults to the center\n *     of the geometry extent).\n * @api\n */\nGeometry.prototype.scale = function(sx, opt_sy, opt_anchor) {};\n\n\n/**\n * Create a simplified version of this geometry.  For linestrings, this uses\n * the the {@link\n * https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm\n * Douglas Peucker} algorithm.  For polygons, a quantization-based\n * simplification is used to preserve topology.\n * @function\n * @param {number} tolerance The tolerance distance for simplification.\n * @return {module:ol/geom/Geometry} A new, simplified version of the original\n *     geometry.\n * @api\n */\nGeometry.prototype.simplify = function(tolerance) {\n  return this.getSimplifiedGeometry(tolerance * tolerance);\n};\n\n\n/**\n * Create a simplified version of this geometry using the Douglas Peucker\n * algorithm.\n * @see https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm\n * @abstract\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/Geometry} Simplified geometry.\n */\nGeometry.prototype.getSimplifiedGeometry = function(squaredTolerance) {};\n\n\n/**\n * Get the type of this geometry.\n * @abstract\n * @return {module:ol/geom/GeometryType} Geometry type.\n */\nGeometry.prototype.getType = function() {};\n\n\n/**\n * Apply a transform function to each coordinate of the geometry.\n * The geometry is modified in place.\n * If you do not want the geometry modified in place, first `clone()` it and\n * then use this function on the clone.\n * @abstract\n * @param {module:ol/proj~TransformFunction} transformFn Transform.\n */\nGeometry.prototype.applyTransform = function(transformFn) {};\n\n\n/**\n * Test if the geometry and the passed extent intersect.\n * @abstract\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} `true` if the geometry and the extent intersect.\n */\nGeometry.prototype.intersectsExtent = function(extent) {};\n\n\n/**\n * Translate the geometry.  This modifies the geometry coordinates in place.  If\n * instead you want a new geometry, first `clone()` this geometry.\n * @abstract\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n */\nGeometry.prototype.translate = function(deltaX, deltaY) {};\n\n\n/**\n * Transform each coordinate of the geometry from one coordinate reference\n * system to another. The geometry is modified in place.\n * For example, a line will be transformed to a line and a circle to a circle.\n * If you do not want the geometry modified in place, first `clone()` it and\n * then use this function on the clone.\n *\n * @param {module:ol/proj~ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {module:ol/proj~ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {module:ol/geom/Geometry} This geometry.  Note that original geometry is\n *     modified in place.\n * @api\n */\nGeometry.prototype.transform = function(source, destination) {\n  source = getProjection(source);\n  const transformFn = source.getUnits() == Units.TILE_PIXELS ?\n    function(inCoordinates, outCoordinates, stride) {\n      const pixelExtent = source.getExtent();\n      const projectedExtent = source.getWorldExtent();\n      const scale = getHeight(projectedExtent) / getHeight(pixelExtent);\n      composeTransform(tmpTransform,\n        projectedExtent[0], projectedExtent[3],\n        scale, -scale, 0,\n        0, 0);\n      transform2D(inCoordinates, 0, inCoordinates.length, stride,\n        tmpTransform, outCoordinates);\n      return getTransform(source, destination)(inCoordinates, outCoordinates, stride);\n    } :\n    getTransform(source, destination);\n  this.applyTransform(transformFn);\n  return this;\n};\nexport default Geometry;\n","/**\n * @module ol/color\n */\nimport {assert} from './asserts.js';\nimport {clamp} from './math.js';\n\n\n/**\n * A color represented as a short array [red, green, blue, alpha].\n * red, green, and blue should be integers in the range 0..255 inclusive.\n * alpha should be a float in the range 0..1 inclusive. If no alpha value is\n * given then `1` will be used.\n * @typedef {Array.<number>} Color\n * @api\n */\n\n\n/**\n * This RegExp matches # followed by 3, 4, 6, or 8 hex digits.\n * @const\n * @type {RegExp}\n * @private\n */\nconst HEX_COLOR_RE_ = /^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i;\n\n\n/**\n * Regular expression for matching potential named color style strings.\n * @const\n * @type {RegExp}\n * @private\n */\nconst NAMED_COLOR_RE_ = /^([a-z]*)$/i;\n\n\n/**\n * Return the color as an rgba string.\n * @param {module:ol/color~Color|string} color Color.\n * @return {string} Rgba string.\n * @api\n */\nexport function asString(color) {\n  if (typeof color === 'string') {\n    return color;\n  } else {\n    return toString(color);\n  }\n}\n\n/**\n * Return named color as an rgba string.\n * @param {string} color Named color.\n * @return {string} Rgb string.\n */\nfunction fromNamed(color) {\n  const el = document.createElement('div');\n  el.style.color = color;\n  if (el.style.color !== '') {\n    document.body.appendChild(el);\n    const rgb = getComputedStyle(el).color;\n    document.body.removeChild(el);\n    return rgb;\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {string} s String.\n * @return {module:ol/color~Color} Color.\n */\nexport const fromString = (\n  function() {\n\n    // We maintain a small cache of parsed strings.  To provide cheap LRU-like\n    // semantics, whenever the cache grows too large we simply delete an\n    // arbitrary 25% of the entries.\n\n    /**\n     * @const\n     * @type {number}\n     */\n    const MAX_CACHE_SIZE = 1024;\n\n    /**\n     * @type {Object.<string, module:ol/color~Color>}\n     */\n    const cache = {};\n\n    /**\n     * @type {number}\n     */\n    let cacheSize = 0;\n\n    return (\n      /**\n       * @param {string} s String.\n       * @return {module:ol/color~Color} Color.\n       */\n      function(s) {\n        let color;\n        if (cache.hasOwnProperty(s)) {\n          color = cache[s];\n        } else {\n          if (cacheSize >= MAX_CACHE_SIZE) {\n            let i = 0;\n            for (const key in cache) {\n              if ((i++ & 3) === 0) {\n                delete cache[key];\n                --cacheSize;\n              }\n            }\n          }\n          color = fromStringInternal_(s);\n          cache[s] = color;\n          ++cacheSize;\n        }\n        return color;\n      }\n    );\n\n  })();\n\n/**\n * Return the color as an array. This function maintains a cache of calculated\n * arrays which means the result should not be modified.\n * @param {module:ol/color~Color|string} color Color.\n * @return {module:ol/color~Color} Color.\n * @api\n */\nexport function asArray(color) {\n  if (Array.isArray(color)) {\n    return color;\n  } else {\n    return fromString(/** @type {string} */ (color));\n  }\n}\n\n/**\n * @param {string} s String.\n * @private\n * @return {module:ol/color~Color} Color.\n */\nfunction fromStringInternal_(s) {\n  let r, g, b, a, color;\n\n  if (NAMED_COLOR_RE_.exec(s)) {\n    s = fromNamed(s);\n  }\n\n  if (HEX_COLOR_RE_.exec(s)) { // hex\n    const n = s.length - 1; // number of hex digits\n    let d; // number of digits per channel\n    if (n <= 4) {\n      d = 1;\n    } else {\n      d = 2;\n    }\n    const hasAlpha = n === 4 || n === 8;\n    r = parseInt(s.substr(1 + 0 * d, d), 16);\n    g = parseInt(s.substr(1 + 1 * d, d), 16);\n    b = parseInt(s.substr(1 + 2 * d, d), 16);\n    if (hasAlpha) {\n      a = parseInt(s.substr(1 + 3 * d, d), 16);\n    } else {\n      a = 255;\n    }\n    if (d == 1) {\n      r = (r << 4) + r;\n      g = (g << 4) + g;\n      b = (b << 4) + b;\n      if (hasAlpha) {\n        a = (a << 4) + a;\n      }\n    }\n    color = [r, g, b, a / 255];\n  } else if (s.indexOf('rgba(') == 0) { // rgba()\n    color = s.slice(5, -1).split(',').map(Number);\n    normalize(color);\n  } else if (s.indexOf('rgb(') == 0) { // rgb()\n    color = s.slice(4, -1).split(',').map(Number);\n    color.push(1);\n    normalize(color);\n  } else {\n    assert(false, 14); // Invalid color\n  }\n  return (\n    /** @type {module:ol/color~Color} */ (color)\n  );\n}\n\n\n/**\n * TODO this function is only used in the test, we probably shouldn't export it\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/color~Color} Clamped color.\n */\nexport function normalize(color) {\n  color[0] = clamp((color[0] + 0.5) | 0, 0, 255);\n  color[1] = clamp((color[1] + 0.5) | 0, 0, 255);\n  color[2] = clamp((color[2] + 0.5) | 0, 0, 255);\n  color[3] = clamp(color[3], 0, 1);\n  return color;\n}\n\n\n/**\n * @param {module:ol/color~Color} color Color.\n * @return {string} String.\n */\nexport function toString(color) {\n  let r = color[0];\n  if (r != (r | 0)) {\n    r = (r + 0.5) | 0;\n  }\n  let g = color[1];\n  if (g != (g | 0)) {\n    g = (g + 0.5) | 0;\n  }\n  let b = color[2];\n  if (b != (b | 0)) {\n    b = (b + 0.5) | 0;\n  }\n  const a = color[3] === undefined ? 1 : color[3];\n  return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n}\n","/**\n * @module ol/colorlike\n */\nimport {toString} from './color.js';\n\n\n/**\n * A type accepted by CanvasRenderingContext2D.fillStyle\n * or CanvasRenderingContext2D.strokeStyle.\n * Represents a color, pattern, or gradient. The origin for patterns and\n * gradients as fill style is an increment of 512 css pixels from map coordinate\n * `[0, 0]`. For seamless repeat patterns, width and height of the pattern image\n * must be a factor of two (2, 4, 8, ..., 512).\n *\n * @typedef {string|CanvasPattern|CanvasGradient} ColorLike\n * @api\n */\n\n\n/**\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @return {module:ol/colorlike~ColorLike} The color as an {@link ol/colorlike~ColorLike}.\n * @api\n */\nexport function asColorLike(color) {\n  if (isColorLike(color)) {\n    return /** @type {string|CanvasPattern|CanvasGradient} */ (color);\n  } else {\n    return toString(/** @type {module:ol/color~Color} */ (color));\n  }\n}\n\n\n/**\n * @param {?} color The value that is potentially an {@link ol/colorlike~ColorLike}.\n * @return {boolean} The color is an {@link ol/colorlike~ColorLike}.\n */\nexport function isColorLike(color) {\n  return (\n    typeof color === 'string' ||\n    color instanceof CanvasPattern ||\n    color instanceof CanvasGradient\n  );\n}\n","/**\n * @module ol/dom\n */\n\n\n/**\n * Create an html canvas element and returns its 2d context.\n * @param {number=} opt_width Canvas width.\n * @param {number=} opt_height Canvas height.\n * @return {CanvasRenderingContext2D} The context.\n */\nexport function createCanvasContext2D(opt_width, opt_height) {\n  const canvas = /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS'));\n  if (opt_width) {\n    canvas.width = opt_width;\n  }\n  if (opt_height) {\n    canvas.height = opt_height;\n  }\n  return /** @type {CanvasRenderingContext2D} */ (canvas.getContext('2d'));\n}\n\n\n/**\n * Get the current computed width for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerWidth(true)`.\n * @param {!Element} element Element.\n * @return {number} The width.\n */\nexport function outerWidth(element) {\n  let width = element.offsetWidth;\n  const style = getComputedStyle(element);\n  width += parseInt(style.marginLeft, 10) + parseInt(style.marginRight, 10);\n\n  return width;\n}\n\n\n/**\n * Get the current computed height for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerHeight(true)`.\n * @param {!Element} element Element.\n * @return {number} The height.\n */\nexport function outerHeight(element) {\n  let height = element.offsetHeight;\n  const style = getComputedStyle(element);\n  height += parseInt(style.marginTop, 10) + parseInt(style.marginBottom, 10);\n\n  return height;\n}\n\n/**\n * @param {Node} newNode Node to replace old node\n * @param {Node} oldNode The node to be replaced\n */\nexport function replaceNode(newNode, oldNode) {\n  const parent = oldNode.parentNode;\n  if (parent) {\n    parent.replaceChild(newNode, oldNode);\n  }\n}\n\n/**\n * @param {Node} node The node to remove.\n * @returns {Node} The node that was removed or null.\n */\nexport function removeNode(node) {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * @param {Node} node The node to remove the children from.\n */\nexport function removeChildren(node) {\n  while (node.lastChild) {\n    node.removeChild(node.lastChild);\n  }\n}\n","/**\n * @module ol/has\n */\nimport {HAS_WEBGL} from './index.js';\n\nconst ua = typeof navigator !== 'undefined' ?\n  navigator.userAgent.toLowerCase() : '';\n\n/**\n * User agent string says we are dealing with Firefox as browser.\n * @type {boolean}\n */\nexport const FIREFOX = ua.indexOf('firefox') !== -1;\n\n/**\n * User agent string says we are dealing with Safari as browser.\n * @type {boolean}\n */\nexport const SAFARI = ua.indexOf('safari') !== -1 && ua.indexOf('chrom') == -1;\n\n/**\n * User agent string says we are dealing with a WebKit engine.\n * @type {boolean}\n */\nexport const WEBKIT = ua.indexOf('webkit') !== -1 && ua.indexOf('edge') == -1;\n\n/**\n * User agent string says we are dealing with a Mac as platform.\n * @type {boolean}\n */\nexport const MAC = ua.indexOf('macintosh') !== -1;\n\n\n/**\n * The ratio between physical pixels and device-independent pixels\n * (dips) on the device (`window.devicePixelRatio`).\n * @const\n * @type {number}\n * @api\n */\nexport const DEVICE_PIXEL_RATIO = window.devicePixelRatio || 1;\n\n\n/**\n * True if the browser's Canvas implementation implements {get,set}LineDash.\n * @type {boolean}\n */\nexport const CANVAS_LINE_DASH = function() {\n  let has = false;\n  try {\n    has = !!document.createElement('CANVAS').getContext('2d').setLineDash;\n  } catch (e) {\n    // pass\n  }\n  return has;\n}();\n\n\n/**\n * Is HTML5 geolocation supported in the current browser?\n * @const\n * @type {boolean}\n * @api\n */\nexport const GEOLOCATION = 'geolocation' in navigator;\n\n\n/**\n * True if browser supports touch events.\n * @const\n * @type {boolean}\n * @api\n */\nexport const TOUCH = 'ontouchstart' in window;\n\n\n/**\n * True if browser supports pointer events.\n * @const\n * @type {boolean}\n */\nexport const POINTER = 'PointerEvent' in window;\n\n\n/**\n * True if browser supports ms pointer events (IE 10).\n * @const\n * @type {boolean}\n */\nexport const MSPOINTER = !!(navigator.msPointerEnabled);\n\n\n/**\n * True if both OpenLayers and browser support WebGL.\n * @const\n * @type {boolean}\n * @api\n */\nexport const WEBGL = HAS_WEBGL;\n","/**\n * @module ol/css\n */\n\n\n/**\n * The CSS class for hidden feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_HIDDEN = 'ol-hidden';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them selectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_SELECTABLE = 'ol-selectable';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them unselectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSELECTABLE = 'ol-unselectable';\n\n\n/**\n * The CSS class for unsupported feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSUPPORTED = 'ol-unsupported';\n\n\n/**\n * The CSS class for controls.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_CONTROL = 'ol-control';\n\n\n/**\n * The CSS class that we'll give the DOM elements that are collapsed, i.e.\n * to those elements which usually can be expanded.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_COLLAPSED = 'ol-collapsed';\n\n\n/**\n * Get the list of font families from a font spec.  Note that this doesn't work\n * for font families that have commas in them.\n * @param {string} The CSS font property.\n * @return {Object.<string>} The font families (or null if the input spec is invalid).\n */\nexport const getFontFamilies = (function() {\n  let style;\n  const cache = {};\n  return function(font) {\n    if (!style) {\n      style = document.createElement('div').style;\n    }\n    if (!(font in cache)) {\n      style.font = font;\n      const family = style.fontFamily;\n      style.font = '';\n      if (!family) {\n        return null;\n      }\n      cache[font] = family.split(/,\\s?/);\n    }\n    return cache[font];\n  };\n})();\n","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3\n};\n","/**\n * @module ol/structs/LRUCache\n */\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport EventTarget from '../events/EventTarget.js';\nimport EventType from '../events/EventType.js';\n\n\n/**\n * @typedef {Object} Entry\n * @property {string} key_\n * @property {Object} newer\n * @property {Object} older\n * @property {*} value_\n */\n\n\n/**\n * Implements a Least-Recently-Used cache where the keys do not conflict with\n * Object's properties (e.g. 'hasOwnProperty' is not allowed as a key). Expiring\n * items from the cache is the responsibility of the user.\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @fires module:ol/events/Event~Event\n * @struct\n * @template T\n * @param {number=} opt_highWaterMark High water mark.\n */\nconst LRUCache = function(opt_highWaterMark) {\n\n  EventTarget.call(this);\n\n  /**\n   * @type {number}\n   */\n  this.highWaterMark = opt_highWaterMark !== undefined ? opt_highWaterMark : 2048;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.count_ = 0;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/structs/LRUCache~Entry>}\n   */\n  this.entries_ = {};\n\n  /**\n   * @private\n   * @type {?module:ol/structs/LRUCache~Entry}\n   */\n  this.oldest_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/structs/LRUCache~Entry}\n   */\n  this.newest_ = null;\n\n};\n\ninherits(LRUCache, EventTarget);\n\n\n/**\n * @return {boolean} Can expire cache.\n */\nLRUCache.prototype.canExpireCache = function() {\n  return this.getCount() > this.highWaterMark;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nLRUCache.prototype.clear = function() {\n  this.count_ = 0;\n  this.entries_ = {};\n  this.oldest_ = null;\n  this.newest_ = null;\n  this.dispatchEvent(EventType.CLEAR);\n};\n\n\n/**\n * @param {string} key Key.\n * @return {boolean} Contains key.\n */\nLRUCache.prototype.containsKey = function(key) {\n  return this.entries_.hasOwnProperty(key);\n};\n\n\n/**\n * @param {function(this: S, T, string, module:ol/structs/LRUCache): ?} f The function\n *     to call for every entry from the oldest to the newer. This function takes\n *     3 arguments (the entry value, the entry key and the LRUCache object).\n *     The return value is ignored.\n * @param {S=} opt_this The object to use as `this` in `f`.\n * @template S\n */\nLRUCache.prototype.forEach = function(f, opt_this) {\n  let entry = this.oldest_;\n  while (entry) {\n    f.call(opt_this, entry.value_, entry.key_, this);\n    entry = entry.newer;\n  }\n};\n\n\n/**\n * @param {string} key Key.\n * @return {T} Value.\n */\nLRUCache.prototype.get = function(key) {\n  const entry = this.entries_[key];\n  assert(entry !== undefined,\n    15); // Tried to get a value for a key that does not exist in the cache\n  if (entry === this.newest_) {\n    return entry.value_;\n  } else if (entry === this.oldest_) {\n    this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (this.oldest_.newer);\n    this.oldest_.older = null;\n  } else {\n    entry.newer.older = entry.older;\n    entry.older.newer = entry.newer;\n  }\n  entry.newer = null;\n  entry.older = this.newest_;\n  this.newest_.newer = entry;\n  this.newest_ = entry;\n  return entry.value_;\n};\n\n\n/**\n * Remove an entry from the cache.\n * @param {string} key The entry key.\n * @return {T} The removed entry.\n */\nLRUCache.prototype.remove = function(key) {\n  const entry = this.entries_[key];\n  assert(entry !== undefined, 15); // Tried to get a value for a key that does not exist in the cache\n  if (entry === this.newest_) {\n    this.newest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.older);\n    if (this.newest_) {\n      this.newest_.newer = null;\n    }\n  } else if (entry === this.oldest_) {\n    this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.newer);\n    if (this.oldest_) {\n      this.oldest_.older = null;\n    }\n  } else {\n    entry.newer.older = entry.older;\n    entry.older.newer = entry.newer;\n  }\n  delete this.entries_[key];\n  --this.count_;\n  return entry.value_;\n};\n\n\n/**\n * @return {number} Count.\n */\nLRUCache.prototype.getCount = function() {\n  return this.count_;\n};\n\n\n/**\n * @return {Array.<string>} Keys.\n */\nLRUCache.prototype.getKeys = function() {\n  const keys = new Array(this.count_);\n  let i = 0;\n  let entry;\n  for (entry = this.newest_; entry; entry = entry.older) {\n    keys[i++] = entry.key_;\n  }\n  return keys;\n};\n\n\n/**\n * @return {Array.<T>} Values.\n */\nLRUCache.prototype.getValues = function() {\n  const values = new Array(this.count_);\n  let i = 0;\n  let entry;\n  for (entry = this.newest_; entry; entry = entry.older) {\n    values[i++] = entry.value_;\n  }\n  return values;\n};\n\n\n/**\n * @return {T} Last value.\n */\nLRUCache.prototype.peekLast = function() {\n  return this.oldest_.value_;\n};\n\n\n/**\n * @return {string} Last key.\n */\nLRUCache.prototype.peekLastKey = function() {\n  return this.oldest_.key_;\n};\n\n\n/**\n * Get the key of the newest item in the cache.  Throws if the cache is empty.\n * @return {string} The newest key.\n */\nLRUCache.prototype.peekFirstKey = function() {\n  return this.newest_.key_;\n};\n\n\n/**\n * @return {T} value Value.\n */\nLRUCache.prototype.pop = function() {\n  const entry = this.oldest_;\n  delete this.entries_[entry.key_];\n  if (entry.newer) {\n    entry.newer.older = null;\n  }\n  this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.newer);\n  if (!this.oldest_) {\n    this.newest_ = null;\n  }\n  --this.count_;\n  return entry.value_;\n};\n\n\n/**\n * @param {string} key Key.\n * @param {T} value Value.\n */\nLRUCache.prototype.replace = function(key, value) {\n  this.get(key);  // update `newest_`\n  this.entries_[key].value_ = value;\n};\n\n\n/**\n * @param {string} key Key.\n * @param {T} value Value.\n */\nLRUCache.prototype.set = function(key, value) {\n  assert(!(key in this.entries_),\n    16); // Tried to set a value for a key that is used already\n  const entry = /** @type {module:ol/structs/LRUCache~Entry} */ ({\n    key_: key,\n    newer: null,\n    older: this.newest_,\n    value_: value\n  });\n  if (!this.newest_) {\n    this.oldest_ = entry;\n  } else {\n    this.newest_.newer = entry;\n  }\n  this.newest_ = entry;\n  this.entries_[key] = entry;\n  ++this.count_;\n};\n\n\n/**\n * Set a maximum number of entries for the cache.\n * @param {number} size Cache size.\n * @api\n */\nLRUCache.prototype.setSize = function(size) {\n  this.highWaterMark = size;\n};\n\n\n/**\n * Prune the cache.\n */\nLRUCache.prototype.prune = function() {\n  while (this.canExpireCache()) {\n    this.pop();\n  }\n};\nexport default LRUCache;\n","/**\n * @module ol/render/canvas\n */\nimport {getFontFamilies} from '../css.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {clear} from '../obj.js';\nimport LRUCache from '../structs/LRUCache.js';\nimport {create as createTransform} from '../transform.js';\n\n\n/**\n * @typedef {Object} FillState\n * @property {module:ol/colorlike~ColorLike} fillStyle\n */\n\n\n/**\n * @typedef {Object} FillStrokeState\n * @property {module:ol/colorlike~ColorLike} [currentFillStyle]\n * @property {module:ol/colorlike~ColorLike} [currentStrokeStyle]\n * @property {string} [currentLineCap]\n * @property {Array.<number>} currentLineDash\n * @property {number} [currentLineDashOffset]\n * @property {string} [currentLineJoin]\n * @property {number} [currentLineWidth]\n * @property {number} [currentMiterLimit]\n * @property {number} [lastStroke]\n * @property {module:ol/colorlike~ColorLike} [fillStyle]\n * @property {module:ol/colorlike~ColorLike} [strokeStyle]\n * @property {string} [lineCap]\n * @property {Array.<number>} lineDash\n * @property {number} [lineDashOffset]\n * @property {string} [lineJoin]\n * @property {number} [lineWidth]\n * @property {number} [miterLimit]\n */\n\n\n/**\n * @typedef {Object} StrokeState\n * @property {string} lineCap\n * @property {Array.<number>} lineDash\n * @property {number} lineDashOffset\n * @property {string} lineJoin\n * @property {number} lineWidth\n * @property {number} miterLimit\n * @property {module:ol/colorlike~ColorLike} strokeStyle\n */\n\n\n/**\n * @typedef {Object} TextState\n * @property {string} font\n * @property {string} [textAlign]\n * @property {string} textBaseline\n */\n\n\n/**\n * Container for decluttered replay instructions that need to be rendered or\n * omitted together, i.e. when styles render both an image and text, or for the\n * characters that form text along lines. The basic elements of this array are\n * `[minX, minY, maxX, maxY, count]`, where the first four entries are the\n * rendered extent of the group in pixel space. `count` is the number of styles\n * in the group, i.e. 2 when an image and a text are grouped, or 1 otherwise.\n * In addition to these four elements, declutter instruction arrays (i.e. the\n * arguments to {@link module:ol/render/canvas~drawImage} are appended to the array.\n * @typedef {Array.<*>} DeclutterGroup\n */\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultFont = '10px sans-serif';\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const defaultFillStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultLineCap = 'round';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const defaultLineDash = [];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineDashOffset = 0;\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultLineJoin = 'round';\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultMiterLimit = 10;\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const defaultStrokeStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextAlign = 'center';\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextBaseline = 'middle';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const defaultPadding = [0, 0, 0, 0];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineWidth = 1;\n\n\n/**\n * The label cache for text rendering. To change the default cache size of 2048\n * entries, use {@link module:ol/structs/LRUCache#setSize}.\n * @type {module:ol/structs/LRUCache.<HTMLCanvasElement>}\n * @api\n */\nexport const labelCache = new LRUCache();\n\n\n/**\n * @type {!Object.<string, number>}\n */\nexport const checkedFonts = {};\n\n\n/**\n * @type {CanvasRenderingContext2D}\n */\nlet measureContext = null;\n\n\n/**\n * @type {!Object.<string, number>}\n */\nexport const textHeights = {};\n\n\n/**\n * Clears the label cache when a font becomes available.\n * @param {string} fontSpec CSS font spec.\n */\nexport const checkFont = (function() {\n  const retries = 60;\n  const checked = checkedFonts;\n  const size = '32px ';\n  const referenceFonts = ['monospace', 'serif'];\n  const len = referenceFonts.length;\n  const text = 'wmytzilWMYTZIL@#/&?$%10\\uF013';\n  let interval, referenceWidth;\n\n  function isAvailable(font) {\n    const context = getMeasureContext();\n    let available = true;\n    for (let i = 0; i < len; ++i) {\n      const referenceFont = referenceFonts[i];\n      context.font = size + referenceFont;\n      referenceWidth = context.measureText(text).width;\n      if (font != referenceFont) {\n        context.font = size + font + ',' + referenceFont;\n        const width = context.measureText(text).width;\n        // If width and referenceWidth are the same, then the fallback was used\n        // instead of the font we wanted, so the font is not available.\n        available = available && width != referenceWidth;\n      }\n    }\n    return available;\n  }\n\n  function check() {\n    let done = true;\n    for (const font in checked) {\n      if (checked[font] < retries) {\n        if (isAvailable(font)) {\n          checked[font] = retries;\n          clear(textHeights);\n          // Make sure that loaded fonts are picked up by Safari\n          measureContext = null;\n          labelCache.clear();\n        } else {\n          ++checked[font];\n          done = false;\n        }\n      }\n    }\n    if (done) {\n      clearInterval(interval);\n      interval = undefined;\n    }\n  }\n\n  return function(fontSpec) {\n    const fontFamilies = getFontFamilies(fontSpec);\n    if (!fontFamilies) {\n      return;\n    }\n    for (let i = 0, ii = fontFamilies.length; i < ii; ++i) {\n      const fontFamily = fontFamilies[i];\n      if (!(fontFamily in checked)) {\n        checked[fontFamily] = retries;\n        if (!isAvailable(fontFamily)) {\n          checked[fontFamily] = 0;\n          if (interval === undefined) {\n            interval = setInterval(check, 32);\n          }\n        }\n      }\n    }\n  };\n})();\n\n\n/**\n * @return {CanvasRenderingContext2D} Measure context.\n */\nfunction getMeasureContext() {\n  if (!measureContext) {\n    measureContext = createCanvasContext2D(1, 1);\n  }\n  return measureContext;\n}\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @return {module:ol/size~Size} Measurement.\n */\nexport const measureTextHeight = (function() {\n  let span;\n  const heights = textHeights;\n  return function(font) {\n    let height = heights[font];\n    if (height == undefined) {\n      if (!span) {\n        span = document.createElement('span');\n        span.textContent = 'M';\n        span.style.margin = span.style.padding = '0 !important';\n        span.style.position = 'absolute !important';\n        span.style.left = '-99999px !important';\n      }\n      span.style.font = font;\n      document.body.appendChild(span);\n      height = heights[font] = span.offsetHeight;\n      document.body.removeChild(span);\n    }\n    return height;\n  };\n})();\n\n\n/**\n * @param {string} font Font.\n * @param {string} text Text.\n * @return {number} Width.\n */\nexport function measureTextWidth(font, text) {\n  const measureContext = getMeasureContext();\n  if (font != measureContext.font) {\n    measureContext.font = font;\n  }\n  return measureContext.measureText(text).width;\n}\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n * @param {number} offsetX X offset.\n * @param {number} offsetY Y offset.\n */\nexport function rotateAtOffset(context, rotation, offsetX, offsetY) {\n  if (rotation !== 0) {\n    context.translate(offsetX, offsetY);\n    context.rotate(rotation);\n    context.translate(-offsetX, -offsetY);\n  }\n}\n\n\nexport const resetTransform = createTransform();\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform|null} transform Transform.\n * @param {number} opacity Opacity.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} w Width.\n * @param {number} h Height.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} scale Scale.\n */\nexport function drawImage(context,\n  transform, opacity, image, originX, originY, w, h, x, y, scale) {\n  let alpha;\n  if (opacity != 1) {\n    alpha = context.globalAlpha;\n    context.globalAlpha = alpha * opacity;\n  }\n  if (transform) {\n    context.setTransform.apply(context, transform);\n  }\n\n  context.drawImage(image, originX, originY, w, h, x, y, w * scale, h * scale);\n\n  if (alpha) {\n    context.globalAlpha = alpha;\n  }\n  if (transform) {\n    context.setTransform.apply(context, resetTransform);\n  }\n}\n","/**\n * @module ol/style/Image\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} opacity\n * @property {boolean} rotateWithView\n * @property {number} rotation\n * @property {number} scale\n * @property {boolean} snapToPixel\n */\n\n\n/**\n * @classdesc\n * A base class used for creating subclasses and not instantiated in\n * apps. Base class for {@link module:ol/style/Icon~Icon}, {@link module:ol/style/Circle~CircleStyle} and\n * {@link module:ol/style/RegularShape~RegularShape}.\n *\n * @constructor\n * @abstract\n * @param {module:ol/style/Image~Options} options Options.\n * @api\n */\nconst ImageStyle = function(options) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.opacity_ = options.opacity;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.rotateWithView_ = options.rotateWithView;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.rotation_ = options.rotation;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.scale_ = options.scale;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.snapToPixel_ = options.snapToPixel;\n\n};\n\n\n/**\n * Get the symbolizer opacity.\n * @return {number} Opacity.\n * @api\n */\nImageStyle.prototype.getOpacity = function() {\n  return this.opacity_;\n};\n\n\n/**\n * Determine whether the symbolizer rotates with the map.\n * @return {boolean} Rotate with map.\n * @api\n */\nImageStyle.prototype.getRotateWithView = function() {\n  return this.rotateWithView_;\n};\n\n\n/**\n * Get the symoblizer rotation.\n * @return {number} Rotation.\n * @api\n */\nImageStyle.prototype.getRotation = function() {\n  return this.rotation_;\n};\n\n\n/**\n * Get the symbolizer scale.\n * @return {number} Scale.\n * @api\n */\nImageStyle.prototype.getScale = function() {\n  return this.scale_;\n};\n\n\n/**\n * Determine whether the symbolizer should be snapped to a pixel.\n * @return {boolean} The symbolizer should snap to a pixel.\n * @api\n */\nImageStyle.prototype.getSnapToPixel = function() {\n  return this.snapToPixel_;\n};\n\n\n/**\n * Get the anchor point in pixels. The anchor determines the center point for the\n * symbolizer.\n * @abstract\n * @return {Array.<number>} Anchor.\n */\nImageStyle.prototype.getAnchor = function() {};\n\n\n/**\n * Get the image element for the symbolizer.\n * @abstract\n * @param {number} pixelRatio Pixel ratio.\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Image element.\n */\nImageStyle.prototype.getImage = function(pixelRatio) {};\n\n\n/**\n * @abstract\n * @param {number} pixelRatio Pixel ratio.\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Image element.\n */\nImageStyle.prototype.getHitDetectionImage = function(pixelRatio) {};\n\n\n/**\n * @abstract\n * @return {module:ol/ImageState} Image state.\n */\nImageStyle.prototype.getImageState = function() {};\n\n\n/**\n * @abstract\n * @return {module:ol/size~Size} Image size.\n */\nImageStyle.prototype.getImageSize = function() {};\n\n\n/**\n * @abstract\n * @return {module:ol/size~Size} Size of the hit-detection image.\n */\nImageStyle.prototype.getHitDetectionImageSize = function() {};\n\n\n/**\n * Get the origin of the symbolizer.\n * @abstract\n * @return {Array.<number>} Origin.\n */\nImageStyle.prototype.getOrigin = function() {};\n\n\n/**\n * Get the size of the symbolizer (in pixels).\n * @abstract\n * @return {module:ol/size~Size} Size.\n */\nImageStyle.prototype.getSize = function() {};\n\n\n/**\n * Set the opacity.\n *\n * @param {number} opacity Opacity.\n * @api\n */\nImageStyle.prototype.setOpacity = function(opacity) {\n  this.opacity_ = opacity;\n};\n\n\n/**\n * Set whether to rotate the style with the view.\n *\n * @param {boolean} rotateWithView Rotate with map.\n * @api\n */\nImageStyle.prototype.setRotateWithView = function(rotateWithView) {\n  this.rotateWithView_ = rotateWithView;\n};\n\n\n/**\n * Set the rotation.\n *\n * @param {number} rotation Rotation.\n * @api\n */\nImageStyle.prototype.setRotation = function(rotation) {\n  this.rotation_ = rotation;\n};\n\n\n/**\n * Set the scale.\n *\n * @param {number} scale Scale.\n * @api\n */\nImageStyle.prototype.setScale = function(scale) {\n  this.scale_ = scale;\n};\n\n\n/**\n * Set whether to snap the image to the closest pixel.\n *\n * @param {boolean} snapToPixel Snap to pixel?\n * @api\n */\nImageStyle.prototype.setSnapToPixel = function(snapToPixel) {\n  this.snapToPixel_ = snapToPixel;\n};\n\n\n/**\n * @abstract\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {module:ol/events~EventsKey|undefined} Listener key.\n * @template T\n */\nImageStyle.prototype.listenImageChange = function(listener, thisArg) {};\n\n\n/**\n * Load not yet loaded URI.\n * @abstract\n */\nImageStyle.prototype.load = function() {};\n\n\n/**\n * @abstract\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @template T\n */\nImageStyle.prototype.unlistenImageChange = function(listener, thisArg) {};\nexport default ImageStyle;\n","/**\n * @module ol/style/RegularShape\n */\nimport {inherits} from '../index.js';\nimport {asColorLike} from '../colorlike.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {CANVAS_LINE_DASH} from '../has.js';\nimport ImageState from '../ImageState.js';\nimport {defaultStrokeStyle, defaultFillStyle, defaultLineCap, defaultLineWidth, defaultLineJoin, defaultMiterLimit} from '../render/canvas.js';\nimport ImageStyle from '../style/Image.js';\n\n\n/**\n * Specify radius for regular polygons, or radius1 and radius2 for stars.\n * @typedef {Object} Options\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {number} points Number of points for stars and regular polygons. In case of a polygon, the number of points\n * is the number of sides.\n * @property {number} [radius] Radius of a regular polygon.\n * @property {number} [radius1] Outer radius of a star.\n * @property {number} [radius2] Inner radius of a star.\n * @property {number} [angle=0] Shape's angle in radians. A value of 0 will have one of the shape's point facing up.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the shape in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the shape's position is animated. Without it, the shape may jitter noticeably.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {boolean} [rotateWithView=false] Whether to rotate the shape with the view.\n * @property {module:ol/style/AtlasManager} [atlasManager] The atlas manager to use for this symbol. When\n * using WebGL it is recommended to use an atlas manager to avoid texture switching. If an atlas manager is given, the\n * symbol is added to an atlas. By default no atlas manager is used.\n */\n\n\n/**\n * @typedef {Object} RenderOptions\n * @property {module:ol/colorlike~ColorLike} [strokeStyle]\n * @property {number} strokeWidth\n * @property {number} size\n * @property {string} lineCap\n * @property {Array.<number>} lineDash\n * @property {number} lineDashOffset\n * @property {string} lineJoin\n * @property {number} miterLimit\n */\n\n\n/**\n * @classdesc\n * Set regular shape style for vector features. The resulting shape will be\n * a regular polygon when `radius` is provided, or a star when `radius1` and\n * `radius2` are provided.\n *\n * @constructor\n * @param {module:ol/style/RegularShape~Options} options Options.\n * @extends {module:ol/style/Image}\n * @api\n */\nconst RegularShape = function(options) {\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.checksums_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.hitDetectionCanvas_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.origin_ = [0, 0];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.points_ = options.points;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.radius_ = /** @type {number} */ (options.radius !== undefined ?\n    options.radius : options.radius1);\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.radius2_ = options.radius2;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = options.angle !== undefined ? options.angle : 0;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.size_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.imageSize_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.hitDetectionImageSize_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/style/AtlasManager|undefined}\n   */\n  this.atlasManager_ = options.atlasManager;\n\n  this.render_(this.atlasManager_);\n\n  /**\n   * @type {boolean}\n   */\n  const snapToPixel = options.snapToPixel !== undefined ?\n    options.snapToPixel : true;\n\n  /**\n   * @type {boolean}\n   */\n  const rotateWithView = options.rotateWithView !== undefined ?\n    options.rotateWithView : false;\n\n  ImageStyle.call(this, {\n    opacity: 1,\n    rotateWithView: rotateWithView,\n    rotation: options.rotation !== undefined ? options.rotation : 0,\n    scale: 1,\n    snapToPixel: snapToPixel\n  });\n};\n\ninherits(RegularShape, ImageStyle);\n\n\n/**\n * Clones the style. If an atlasmanager was provided to the original style it will be used in the cloned style, too.\n * @return {module:ol/style/RegularShape} The cloned style.\n * @api\n */\nRegularShape.prototype.clone = function() {\n  const style = new RegularShape({\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    points: this.getPoints(),\n    radius: this.getRadius(),\n    radius2: this.getRadius2(),\n    angle: this.getAngle(),\n    snapToPixel: this.getSnapToPixel(),\n    stroke: this.getStroke() ?  this.getStroke().clone() : undefined,\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView(),\n    atlasManager: this.atlasManager_\n  });\n  style.setOpacity(this.getOpacity());\n  style.setScale(this.getScale());\n  return style;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getAnchor = function() {\n  return this.anchor_;\n};\n\n\n/**\n * Get the angle used in generating the shape.\n * @return {number} Shape's rotation in radians.\n * @api\n */\nRegularShape.prototype.getAngle = function() {\n  return this.angle_;\n};\n\n\n/**\n * Get the fill style for the shape.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nRegularShape.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getHitDetectionImage = function(pixelRatio) {\n  return this.hitDetectionCanvas_;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getImage = function(pixelRatio) {\n  return this.canvas_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getImageSize = function() {\n  return this.imageSize_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getHitDetectionImageSize = function() {\n  return this.hitDetectionImageSize_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getImageState = function() {\n  return ImageState.LOADED;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getOrigin = function() {\n  return this.origin_;\n};\n\n\n/**\n * Get the number of points for generating the shape.\n * @return {number} Number of points for stars and regular polygons.\n * @api\n */\nRegularShape.prototype.getPoints = function() {\n  return this.points_;\n};\n\n\n/**\n * Get the (primary) radius for the shape.\n * @return {number} Radius.\n * @api\n */\nRegularShape.prototype.getRadius = function() {\n  return this.radius_;\n};\n\n\n/**\n * Get the secondary radius for the shape.\n * @return {number|undefined} Radius2.\n * @api\n */\nRegularShape.prototype.getRadius2 = function() {\n  return this.radius2_;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getSize = function() {\n  return this.size_;\n};\n\n\n/**\n * Get the stroke style for the shape.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nRegularShape.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.listenImageChange = function(listener, thisArg) {};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.load = function() {};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.unlistenImageChange = function(listener, thisArg) {};\n\n\n/**\n * @protected\n * @param {module:ol/style/AtlasManager|undefined} atlasManager An atlas manager.\n */\nRegularShape.prototype.render_ = function(atlasManager) {\n  let imageSize;\n  let lineCap = '';\n  let lineJoin = '';\n  let miterLimit = 0;\n  let lineDash = null;\n  let lineDashOffset = 0;\n  let strokeStyle;\n  let strokeWidth = 0;\n\n  if (this.stroke_) {\n    strokeStyle = this.stroke_.getColor();\n    if (strokeStyle === null) {\n      strokeStyle = defaultStrokeStyle;\n    }\n    strokeStyle = asColorLike(strokeStyle);\n    strokeWidth = this.stroke_.getWidth();\n    if (strokeWidth === undefined) {\n      strokeWidth = defaultLineWidth;\n    }\n    lineDash = this.stroke_.getLineDash();\n    lineDashOffset = this.stroke_.getLineDashOffset();\n    if (!CANVAS_LINE_DASH) {\n      lineDash = null;\n      lineDashOffset = 0;\n    }\n    lineJoin = this.stroke_.getLineJoin();\n    if (lineJoin === undefined) {\n      lineJoin = defaultLineJoin;\n    }\n    lineCap = this.stroke_.getLineCap();\n    if (lineCap === undefined) {\n      lineCap = defaultLineCap;\n    }\n    miterLimit = this.stroke_.getMiterLimit();\n    if (miterLimit === undefined) {\n      miterLimit = defaultMiterLimit;\n    }\n  }\n\n  let size = 2 * (this.radius_ + strokeWidth) + 1;\n\n  /** @type {module:ol/style/RegularShape~RenderOptions} */\n  const renderOptions = {\n    strokeStyle: strokeStyle,\n    strokeWidth: strokeWidth,\n    size: size,\n    lineCap: lineCap,\n    lineDash: lineDash,\n    lineDashOffset: lineDashOffset,\n    lineJoin: lineJoin,\n    miterLimit: miterLimit\n  };\n\n  if (atlasManager === undefined) {\n    // no atlas manager is used, create a new canvas\n    const context = createCanvasContext2D(size, size);\n    this.canvas_ = context.canvas;\n\n    // canvas.width and height are rounded to the closest integer\n    size = this.canvas_.width;\n    imageSize = size;\n\n    this.draw_(renderOptions, context, 0, 0);\n\n    this.createHitDetectionCanvas_(renderOptions);\n  } else {\n    // an atlas manager is used, add the symbol to an atlas\n    size = Math.round(size);\n\n    const hasCustomHitDetectionImage = !this.fill_;\n    let renderHitDetectionCallback;\n    if (hasCustomHitDetectionImage) {\n      // render the hit-detection image into a separate atlas image\n      renderHitDetectionCallback =\n          this.drawHitDetectionCanvas_.bind(this, renderOptions);\n    }\n\n    const id = this.getChecksum();\n    const info = atlasManager.add(\n      id, size, size, this.draw_.bind(this, renderOptions),\n      renderHitDetectionCallback);\n\n    this.canvas_ = info.image;\n    this.origin_ = [info.offsetX, info.offsetY];\n    imageSize = info.image.width;\n\n    if (hasCustomHitDetectionImage) {\n      this.hitDetectionCanvas_ = info.hitImage;\n      this.hitDetectionImageSize_ =\n          [info.hitImage.width, info.hitImage.height];\n    } else {\n      this.hitDetectionCanvas_ = this.canvas_;\n      this.hitDetectionImageSize_ = [imageSize, imageSize];\n    }\n  }\n\n  this.anchor_ = [size / 2, size / 2];\n  this.size_ = [size, size];\n  this.imageSize_ = [imageSize, imageSize];\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n * @param {CanvasRenderingContext2D} context The rendering context.\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nRegularShape.prototype.draw_ = function(renderOptions, context, x, y) {\n  let i, angle0, radiusC;\n  // reset transform\n  context.setTransform(1, 0, 0, 1, 0, 0);\n\n  // then move to (x, y)\n  context.translate(x, y);\n\n  context.beginPath();\n\n  let points = this.points_;\n  if (points === Infinity) {\n    context.arc(\n      renderOptions.size / 2, renderOptions.size / 2,\n      this.radius_, 0, 2 * Math.PI, true);\n  } else {\n    const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n      : this.radius_;\n    if (radius2 !== this.radius_) {\n      points = 2 * points;\n    }\n    for (i = 0; i <= points; i++) {\n      angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n      radiusC = i % 2 === 0 ? this.radius_ : radius2;\n      context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n        renderOptions.size / 2 + radiusC * Math.sin(angle0));\n    }\n  }\n\n\n  if (this.fill_) {\n    let color = this.fill_.getColor();\n    if (color === null) {\n      color = defaultFillStyle;\n    }\n    context.fillStyle = asColorLike(color);\n    context.fill();\n  }\n  if (this.stroke_) {\n    context.strokeStyle = renderOptions.strokeStyle;\n    context.lineWidth = renderOptions.strokeWidth;\n    if (renderOptions.lineDash) {\n      context.setLineDash(renderOptions.lineDash);\n      context.lineDashOffset = renderOptions.lineDashOffset;\n    }\n    context.lineCap = renderOptions.lineCap;\n    context.lineJoin = renderOptions.lineJoin;\n    context.miterLimit = renderOptions.miterLimit;\n    context.stroke();\n  }\n  context.closePath();\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n */\nRegularShape.prototype.createHitDetectionCanvas_ = function(renderOptions) {\n  this.hitDetectionImageSize_ = [renderOptions.size, renderOptions.size];\n  if (this.fill_) {\n    this.hitDetectionCanvas_ = this.canvas_;\n    return;\n  }\n\n  // if no fill style is set, create an extra hit-detection image with a\n  // default fill style\n  const context = createCanvasContext2D(renderOptions.size, renderOptions.size);\n  this.hitDetectionCanvas_ = context.canvas;\n\n  this.drawHitDetectionCanvas_(renderOptions, context, 0, 0);\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n * @param {CanvasRenderingContext2D} context The context.\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nRegularShape.prototype.drawHitDetectionCanvas_ = function(renderOptions, context, x, y) {\n  // reset transform\n  context.setTransform(1, 0, 0, 1, 0, 0);\n\n  // then move to (x, y)\n  context.translate(x, y);\n\n  context.beginPath();\n\n  let points = this.points_;\n  if (points === Infinity) {\n    context.arc(\n      renderOptions.size / 2, renderOptions.size / 2,\n      this.radius_, 0, 2 * Math.PI, true);\n  } else {\n    const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n      : this.radius_;\n    if (radius2 !== this.radius_) {\n      points = 2 * points;\n    }\n    let i, radiusC, angle0;\n    for (i = 0; i <= points; i++) {\n      angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n      radiusC = i % 2 === 0 ? this.radius_ : radius2;\n      context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n        renderOptions.size / 2 + radiusC * Math.sin(angle0));\n    }\n  }\n\n  context.fillStyle = defaultFillStyle;\n  context.fill();\n  if (this.stroke_) {\n    context.strokeStyle = renderOptions.strokeStyle;\n    context.lineWidth = renderOptions.strokeWidth;\n    if (renderOptions.lineDash) {\n      context.setLineDash(renderOptions.lineDash);\n      context.lineDashOffset = renderOptions.lineDashOffset;\n    }\n    context.stroke();\n  }\n  context.closePath();\n};\n\n\n/**\n * @return {string} The checksum.\n */\nRegularShape.prototype.getChecksum = function() {\n  const strokeChecksum = this.stroke_ ?\n    this.stroke_.getChecksum() : '-';\n  const fillChecksum = this.fill_ ?\n    this.fill_.getChecksum() : '-';\n\n  const recalculate = !this.checksums_ ||\n      (strokeChecksum != this.checksums_[1] ||\n      fillChecksum != this.checksums_[2] ||\n      this.radius_ != this.checksums_[3] ||\n      this.radius2_ != this.checksums_[4] ||\n      this.angle_ != this.checksums_[5] ||\n      this.points_ != this.checksums_[6]);\n\n  if (recalculate) {\n    const checksum = 'r' + strokeChecksum + fillChecksum +\n        (this.radius_ !== undefined ? this.radius_.toString() : '-') +\n        (this.radius2_ !== undefined ? this.radius2_.toString() : '-') +\n        (this.angle_ !== undefined ? this.angle_.toString() : '-') +\n        (this.points_ !== undefined ? this.points_.toString() : '-');\n    this.checksums_ = [checksum, strokeChecksum, fillChecksum,\n      this.radius_, this.radius2_, this.angle_, this.points_];\n  }\n\n  return this.checksums_[0];\n};\nexport default RegularShape;\n","/**\n * @module ol/style/Circle\n */\nimport {inherits} from '../index.js';\nimport RegularShape from '../style/RegularShape.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {number} radius Circle radius.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the circle in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the circle's position is animated. Without it, the circle may jitter noticeably.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/AtlasManager} [atlasManager] The atlas manager to use for this circle.\n * When using WebGL it is recommended to use an atlas manager to avoid texture switching. If an atlas manager is given,\n * the circle is added to an atlas. By default no atlas manager is used.\n */\n\n\n/**\n * @classdesc\n * Set circle style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Circle~Options=} opt_options Options.\n * @extends {module:ol/style/RegularShape}\n * @api\n */\nconst CircleStyle = function(opt_options) {\n\n  const options = opt_options || {};\n\n  RegularShape.call(this, {\n    points: Infinity,\n    fill: options.fill,\n    radius: options.radius,\n    snapToPixel: options.snapToPixel,\n    stroke: options.stroke,\n    atlasManager: options.atlasManager\n  });\n\n};\n\ninherits(CircleStyle, RegularShape);\n\n\n/**\n * Clones the style.  If an atlasmanager was provided to the original style it will be used in the cloned style, too.\n * @return {module:ol/style/Circle} The cloned style.\n * @override\n * @api\n */\nCircleStyle.prototype.clone = function() {\n  const style = new CircleStyle({\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    radius: this.getRadius(),\n    snapToPixel: this.getSnapToPixel(),\n    atlasManager: this.atlasManager_\n  });\n  style.setOpacity(this.getOpacity());\n  style.setScale(this.getScale());\n  return style;\n};\n\n\n/**\n * Set the circle radius.\n *\n * @param {number} radius Circle radius.\n * @api\n */\nCircleStyle.prototype.setRadius = function(radius) {\n  this.radius_ = radius;\n  this.render_(this.atlasManager_);\n};\nexport default CircleStyle;\n","/**\n * @module ol/style/Fill\n */\nimport {getUid} from '../index.js';\nimport {asString} from '../color.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/color~Color|module:ol/colorlike~ColorLike} [color] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n */\n\n\n/**\n * @classdesc\n * Set fill style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Fill~Options=} opt_options Options.\n * @api\n */\nconst Fill = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/color~Color|module:ol/colorlike~ColorLike}\n   */\n  this.color_ = options.color !== undefined ? options.color : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Clones the style. The color is not cloned if it is an {@link module:ol/colorlike~ColorLike}.\n * @return {module:ol/style/Fill} The cloned style.\n * @api\n */\nFill.prototype.clone = function() {\n  const color = this.getColor();\n  return new Fill({\n    color: (color && color.slice) ? color.slice() : color || undefined\n  });\n};\n\n\n/**\n * Get the fill color.\n * @return {module:ol/color~Color|module:ol/colorlike~ColorLike} Color.\n * @api\n */\nFill.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Set the color.\n *\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @api\n */\nFill.prototype.setColor = function(color) {\n  this.color_ = color;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * @return {string} The checksum.\n */\nFill.prototype.getChecksum = function() {\n  if (this.checksum_ === undefined) {\n    if (\n      this.color_ instanceof CanvasPattern ||\n        this.color_ instanceof CanvasGradient\n    ) {\n      this.checksum_ = getUid(this.color_).toString();\n    } else {\n      this.checksum_ = 'f' + (this.color_ ? asString(this.color_) : '-');\n    }\n  }\n\n  return this.checksum_;\n};\nexport default Fill;\n","/**\n * @module ol/style/Stroke\n */\nimport {getUid} from '../index.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/color~Color|module:ol/colorlike~ColorLike} [color] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n * @property {string} [lineCap='round'] Line cap style: `butt`, `round`, or `square`.\n * @property {string} [lineJoin='round'] Line join style: `bevel`, `round`, or `miter`.\n * @property {Array.<number>} [lineDash] Line dash pattern. Default is `undefined` (no dash).\n * Please note that Internet Explorer 10 and lower do not support the `setLineDash` method on\n * the `CanvasRenderingContext2D` and therefore this option will have no visual effect in these browsers.\n * @property {number} [lineDashOffset=0] Line dash offset.\n * @property {number} [miterLimit=10] Miter limit.\n * @property {number} [width] Width.\n */\n\n\n/**\n * @classdesc\n * Set stroke style for vector features.\n * Note that the defaults given are the Canvas defaults, which will be used if\n * option is not defined. The `get` functions return whatever was entered in\n * the options; they will not return the default.\n *\n * @constructor\n * @param {module:ol/style/Stroke~Options=} opt_options Options.\n * @api\n */\nconst Stroke = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/color~Color|module:ol/colorlike~ColorLike}\n   */\n  this.color_ = options.color !== undefined ? options.color : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.lineCap_ = options.lineCap;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.lineDash_ = options.lineDash !== undefined ? options.lineDash : null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lineDashOffset_ = options.lineDashOffset;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.lineJoin_ = options.lineJoin;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.miterLimit_ = options.miterLimit;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.width_ = options.width;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Stroke} The cloned style.\n * @api\n */\nStroke.prototype.clone = function() {\n  const color = this.getColor();\n  return new Stroke({\n    color: (color && color.slice) ? color.slice() : color || undefined,\n    lineCap: this.getLineCap(),\n    lineDash: this.getLineDash() ? this.getLineDash().slice() : undefined,\n    lineDashOffset: this.getLineDashOffset(),\n    lineJoin: this.getLineJoin(),\n    miterLimit: this.getMiterLimit(),\n    width: this.getWidth()\n  });\n};\n\n\n/**\n * Get the stroke color.\n * @return {module:ol/color~Color|module:ol/colorlike~ColorLike} Color.\n * @api\n */\nStroke.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Get the line cap type for the stroke.\n * @return {string|undefined} Line cap.\n * @api\n */\nStroke.prototype.getLineCap = function() {\n  return this.lineCap_;\n};\n\n\n/**\n * Get the line dash style for the stroke.\n * @return {Array.<number>} Line dash.\n * @api\n */\nStroke.prototype.getLineDash = function() {\n  return this.lineDash_;\n};\n\n\n/**\n * Get the line dash offset for the stroke.\n * @return {number|undefined} Line dash offset.\n * @api\n */\nStroke.prototype.getLineDashOffset = function() {\n  return this.lineDashOffset_;\n};\n\n\n/**\n * Get the line join type for the stroke.\n * @return {string|undefined} Line join.\n * @api\n */\nStroke.prototype.getLineJoin = function() {\n  return this.lineJoin_;\n};\n\n\n/**\n * Get the miter limit for the stroke.\n * @return {number|undefined} Miter limit.\n * @api\n */\nStroke.prototype.getMiterLimit = function() {\n  return this.miterLimit_;\n};\n\n\n/**\n * Get the stroke width.\n * @return {number|undefined} Width.\n * @api\n */\nStroke.prototype.getWidth = function() {\n  return this.width_;\n};\n\n\n/**\n * Set the color.\n *\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @api\n */\nStroke.prototype.setColor = function(color) {\n  this.color_ = color;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line cap.\n *\n * @param {string|undefined} lineCap Line cap.\n * @api\n */\nStroke.prototype.setLineCap = function(lineCap) {\n  this.lineCap_ = lineCap;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line dash.\n *\n * Please note that Internet Explorer 10 and lower [do not support][mdn] the\n * `setLineDash` method on the `CanvasRenderingContext2D` and therefore this\n * property will have no visual effect in these browsers.\n *\n * [mdn]: https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Browser_compatibility\n *\n * @param {Array.<number>} lineDash Line dash.\n * @api\n */\nStroke.prototype.setLineDash = function(lineDash) {\n  this.lineDash_ = lineDash;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line dash offset.\n *\n * @param {number|undefined} lineDashOffset Line dash offset.\n * @api\n */\nStroke.prototype.setLineDashOffset = function(lineDashOffset) {\n  this.lineDashOffset_ = lineDashOffset;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line join.\n *\n * @param {string|undefined} lineJoin Line join.\n * @api\n */\nStroke.prototype.setLineJoin = function(lineJoin) {\n  this.lineJoin_ = lineJoin;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the miter limit.\n *\n * @param {number|undefined} miterLimit Miter limit.\n * @api\n */\nStroke.prototype.setMiterLimit = function(miterLimit) {\n  this.miterLimit_ = miterLimit;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the width.\n *\n * @param {number|undefined} width Width.\n * @api\n */\nStroke.prototype.setWidth = function(width) {\n  this.width_ = width;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * @return {string} The checksum.\n */\nStroke.prototype.getChecksum = function() {\n  if (this.checksum_ === undefined) {\n    this.checksum_ = 's';\n    if (this.color_) {\n      if (typeof this.color_ === 'string') {\n        this.checksum_ += this.color_;\n      } else {\n        this.checksum_ += getUid(this.color_).toString();\n      }\n    } else {\n      this.checksum_ += '-';\n    }\n    this.checksum_ += ',' +\n        (this.lineCap_ !== undefined ?\n          this.lineCap_.toString() : '-') + ',' +\n        (this.lineDash_ ?\n          this.lineDash_.toString() : '-') + ',' +\n        (this.lineDashOffset_ !== undefined ?\n          this.lineDashOffset_ : '-') + ',' +\n        (this.lineJoin_ !== undefined ?\n          this.lineJoin_ : '-') + ',' +\n        (this.miterLimit_ !== undefined ?\n          this.miterLimit_.toString() : '-') + ',' +\n        (this.width_ !== undefined ?\n          this.width_.toString() : '-');\n  }\n\n  return this.checksum_;\n};\nexport default Stroke;\n","/**\n * @module ol/style/Style\n */\n\n/**\n * Feature styles.\n *\n * If no style is defined, the following default style is used:\n * ```js\n *  import {Fill, Stroke, Circle, Style} from 'ol/style';\n *\n *  var fill = new Fill({\n *    color: 'rgba(255,255,255,0.4)'\n *  });\n *  var stroke = new Stroke({\n *    color: '#3399CC',\n *    width: 1.25\n *  });\n *  var styles = [\n *    new Style({\n *      image: new Circle({\n *        fill: fill,\n *        stroke: stroke,\n *        radius: 5\n *      }),\n *      fill: fill,\n *      stroke: stroke\n *    })\n *  ];\n * ```\n *\n * A separate editing style has the following defaults:\n * ```js\n *  import {Fill, Stroke, Circle, Style} from 'ol/style';\n *  import GeometryType from 'ol/geom/GeometryType';\n *\n *  var white = [255, 255, 255, 1];\n *  var blue = [0, 153, 255, 1];\n *  var width = 3;\n *  styles[GeometryType.POLYGON] = [\n *    new Style({\n *      fill: new Fill({\n *        color: [255, 255, 255, 0.5]\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POLYGON] =\n *      styles[GeometryType.POLYGON];\n *  styles[GeometryType.LINE_STRING] = [\n *    new Style({\n *      stroke: new Stroke({\n *        color: white,\n *        width: width + 2\n *      })\n *    }),\n *    new Style({\n *      stroke: new Stroke({\n *        color: blue,\n *        width: width\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_LINE_STRING] =\n *      styles[GeometryType.LINE_STRING];\n *  styles[GeometryType.POINT] = [\n *    new Style({\n *      image: new Circle({\n *        radius: width * 2,\n *        fill: new Fill({\n *          color: blue\n *        }),\n *        stroke: new Stroke({\n *          color: white,\n *          width: width / 2\n *        })\n *      }),\n *      zIndex: Infinity\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POINT] =\n *      styles[GeometryType.POINT];\n *  styles[GeometryType.GEOMETRY_COLLECTION] =\n *      styles[GeometryType.POLYGON].concat(\n *          styles[GeometryType.LINE_STRING],\n *          styles[GeometryType.POINT]\n *      );\n * ```\n */\nimport {assert} from '../asserts.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport CircleStyle from '../style/Circle.js';\nimport Fill from '../style/Fill.js';\nimport Stroke from '../style/Stroke.js';\n\n\n/**\n * A function that takes an {@link module:ol/Feature} and a `{number}`\n * representing the view's resolution. The function should return a\n * {@link module:ol/style/Style} or an array of them. This way e.g. a\n * vector layer can be styled.\n *\n * @typedef {function((module:ol/Feature|module:ol/render/Feature), number):\n *     (module:ol/style/Style|Array.<module:ol/style/Style>)} StyleFunction\n */\n\n\n/**\n * A function that takes an {@link module:ol/Feature} as argument and returns an\n * {@link module:ol/geom/Geometry} that will be rendered and styled for the feature.\n *\n * @typedef {function((module:ol/Feature|module:ol/render/Feature)):\n *     (module:ol/geom/Geometry|module:ol/render/Feature|undefined)} GeometryFunction\n */\n\n\n/**\n * Custom renderer function. Takes two arguments:\n *\n * 1. The pixel coordinates of the geometry in GeoJSON notation.\n * 2. The {@link module:ol/render~State} of the layer renderer.\n *\n * @typedef {function((module:ol/coordinate~Coordinate|Array<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>),module:ol/render~State)}\n * RenderFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction} [geometry] Feature property or geometry\n * or function returning a geometry to render for this style.\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {module:ol/style/Image} [image] Image style.\n * @property {module:ol/style/Style~RenderFunction} [renderer] Custom renderer. When configured, `fill`, `stroke` and `image` will be\n * ignored, and the provided function will be called with each render frame for each geometry.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/Text} [text] Text style.\n * @property {number} [zIndex] Z index.\n */\n\n\n/**\n * @classdesc\n * Container for vector feature rendering styles. Any changes made to the style\n * or its children through `set*()` methods will not take effect until the\n * feature or layer that uses the style is re-rendered.\n *\n * @constructor\n * @struct\n * @param {module:ol/style/Style~Options=} opt_options Style options.\n * @api\n */\nconst Style = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction}\n   */\n  this.geometry_ = null;\n\n  /**\n   * @private\n   * @type {!module:ol/style/Style~GeometryFunction}\n   */\n  this.geometryFunction_ = defaultGeometryFunction;\n\n  if (options.geometry !== undefined) {\n    this.setGeometry(options.geometry);\n  }\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill : null;\n\n  /**\n     * @private\n     * @type {module:ol/style/Image}\n     */\n  this.image_ = options.image !== undefined ? options.image : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Style~RenderFunction|null}\n   */\n  this.renderer_ = options.renderer !== undefined ? options.renderer : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Text}\n   */\n  this.text_ = options.text !== undefined ? options.text : null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.zIndex_ = options.zIndex;\n\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Style} The cloned style.\n * @api\n */\nStyle.prototype.clone = function() {\n  let geometry = this.getGeometry();\n  if (geometry && geometry.clone) {\n    geometry = geometry.clone();\n  }\n  return new Style({\n    geometry: geometry,\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    image: this.getImage() ? this.getImage().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    text: this.getText() ? this.getText().clone() : undefined,\n    zIndex: this.getZIndex()\n  });\n};\n\n\n/**\n * Get the custom renderer function that was configured with\n * {@link #setRenderer} or the `renderer` constructor option.\n * @return {module:ol/style/Style~RenderFunction|null} Custom renderer function.\n * @api\n */\nStyle.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Sets a custom renderer function for this style. When set, `fill`, `stroke`\n * and `image` options of the style will be ignored.\n * @param {module:ol/style/Style~RenderFunction|null} renderer Custom renderer function.\n * @api\n */\nStyle.prototype.setRenderer = function(renderer) {\n  this.renderer_ = renderer;\n};\n\n\n/**\n * Get the geometry to be rendered.\n * @return {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction}\n * Feature property or geometry or function that returns the geometry that will\n * be rendered with this style.\n * @api\n */\nStyle.prototype.getGeometry = function() {\n  return this.geometry_;\n};\n\n\n/**\n * Get the function used to generate a geometry for rendering.\n * @return {!module:ol/style/Style~GeometryFunction} Function that is called with a feature\n * and returns the geometry to render instead of the feature's geometry.\n * @api\n */\nStyle.prototype.getGeometryFunction = function() {\n  return this.geometryFunction_;\n};\n\n\n/**\n * Get the fill style.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nStyle.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * Set the fill style.\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nStyle.prototype.setFill = function(fill) {\n  this.fill_ = fill;\n};\n\n\n/**\n * Get the image style.\n * @return {module:ol/style/Image} Image style.\n * @api\n */\nStyle.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * Set the image style.\n * @param {module:ol/style/Image} image Image style.\n * @api\n */\nStyle.prototype.setImage = function(image) {\n  this.image_ = image;\n};\n\n\n/**\n * Get the stroke style.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nStyle.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * Set the stroke style.\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nStyle.prototype.setStroke = function(stroke) {\n  this.stroke_ = stroke;\n};\n\n\n/**\n * Get the text style.\n * @return {module:ol/style/Text} Text style.\n * @api\n */\nStyle.prototype.getText = function() {\n  return this.text_;\n};\n\n\n/**\n * Set the text style.\n * @param {module:ol/style/Text} text Text style.\n * @api\n */\nStyle.prototype.setText = function(text) {\n  this.text_ = text;\n};\n\n\n/**\n * Get the z-index for the style.\n * @return {number|undefined} ZIndex.\n * @api\n */\nStyle.prototype.getZIndex = function() {\n  return this.zIndex_;\n};\n\n\n/**\n * Set a geometry that is rendered instead of the feature's geometry.\n *\n * @param {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction} geometry\n *     Feature property or geometry or function returning a geometry to render\n *     for this style.\n * @api\n */\nStyle.prototype.setGeometry = function(geometry) {\n  if (typeof geometry === 'function') {\n    this.geometryFunction_ = geometry;\n  } else if (typeof geometry === 'string') {\n    this.geometryFunction_ = function(feature) {\n      return (\n        /** @type {module:ol/geom/Geometry} */ (feature.get(geometry))\n      );\n    };\n  } else if (!geometry) {\n    this.geometryFunction_ = defaultGeometryFunction;\n  } else if (geometry !== undefined) {\n    this.geometryFunction_ = function() {\n      return (\n        /** @type {module:ol/geom/Geometry} */ (geometry)\n      );\n    };\n  }\n  this.geometry_ = geometry;\n};\n\n\n/**\n * Set the z-index.\n *\n * @param {number|undefined} zIndex ZIndex.\n * @api\n */\nStyle.prototype.setZIndex = function(zIndex) {\n  this.zIndex_ = zIndex;\n};\n\n\n/**\n * Convert the provided object into a style function.  Functions passed through\n * unchanged.  Arrays of module:ol/style/Style or single style objects wrapped in a\n * new style function.\n * @param {module:ol/style/Style~StyleFunction|Array.<module:ol/style/Style>|module:ol/style/Style} obj\n *     A style function, a single style, or an array of styles.\n * @return {module:ol/style/Style~StyleFunction} A style function.\n */\nexport function toFunction(obj) {\n  let styleFunction;\n\n  if (typeof obj === 'function') {\n    styleFunction = obj;\n  } else {\n    /**\n     * @type {Array.<module:ol/style/Style>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(obj instanceof Style,\n        41); // Expected an `module:ol/style/Style~Style` or an array of `module:ol/style/Style~Style`\n      styles = [obj];\n    }\n    styleFunction = function() {\n      return styles;\n    };\n  }\n  return styleFunction;\n}\n\n\n/**\n * @type {Array.<module:ol/style/Style>}\n */\nlet defaultStyles = null;\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/style/Style>} Style.\n */\nexport function createDefaultStyle(feature, resolution) {\n  // We don't use an immediately-invoked function\n  // and a closure so we don't get an error at script evaluation time in\n  // browsers that do not support Canvas. (module:ol/style/Circle~CircleStyle does\n  // canvas.getContext('2d') at construction time, which will cause an.error\n  // in such browsers.)\n  if (!defaultStyles) {\n    const fill = new Fill({\n      color: 'rgba(255,255,255,0.4)'\n    });\n    const stroke = new Stroke({\n      color: '#3399CC',\n      width: 1.25\n    });\n    defaultStyles = [\n      new Style({\n        image: new CircleStyle({\n          fill: fill,\n          stroke: stroke,\n          radius: 5\n        }),\n        fill: fill,\n        stroke: stroke\n      })\n    ];\n  }\n  return defaultStyles;\n}\n\n\n/**\n * Default styles for editing features.\n * @return {Object.<module:ol/geom/GeometryType, Array.<module:ol/style/Style>>} Styles\n */\nexport function createEditingStyle() {\n  /** @type {Object.<module:ol/geom/GeometryType, Array.<module:ol/style/Style>>} */\n  const styles = {};\n  const white = [255, 255, 255, 1];\n  const blue = [0, 153, 255, 1];\n  const width = 3;\n  styles[GeometryType.POLYGON] = [\n    new Style({\n      fill: new Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_POLYGON] =\n      styles[GeometryType.POLYGON];\n\n  styles[GeometryType.LINE_STRING] = [\n    new Style({\n      stroke: new Stroke({\n        color: white,\n        width: width + 2\n      })\n    }),\n    new Style({\n      stroke: new Stroke({\n        color: blue,\n        width: width\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_LINE_STRING] =\n      styles[GeometryType.LINE_STRING];\n\n  styles[GeometryType.CIRCLE] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING]\n      );\n\n\n  styles[GeometryType.POINT] = [\n    new Style({\n      image: new CircleStyle({\n        radius: width * 2,\n        fill: new Fill({\n          color: blue\n        }),\n        stroke: new Stroke({\n          color: white,\n          width: width / 2\n        })\n      }),\n      zIndex: Infinity\n    })\n  ];\n  styles[GeometryType.MULTI_POINT] =\n      styles[GeometryType.POINT];\n\n  styles[GeometryType.GEOMETRY_COLLECTION] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING],\n        styles[GeometryType.POINT]\n      );\n\n  return styles;\n}\n\n\n/**\n * Function that is called with a feature and returns its default geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature to get the geometry for.\n * @return {module:ol/geom/Geometry|module:ol/render/Feature|undefined} Geometry to render.\n */\nfunction defaultGeometryFunction(feature) {\n  return feature.getGeometry();\n}\n\nexport default Style;\n","/**\n * @module ol/Feature\n */\nimport {assert} from './asserts.js';\nimport {listen, unlisten, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport {inherits} from './index.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport Geometry from './geom/Geometry.js';\nimport Style from './style/Style.js';\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature';\n * import Polygon from 'ol/geom/Polygon';\n * import Point from 'ol/geom/Point';\n *\n * var feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon'\n * });\n *\n * // get the polygon geometry\n * var poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * var point = feature.getGeometry();\n * ```\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/geom/Geometry|Object.<string, *>=} opt_geometryOrProperties\n * You may pass a Geometry object directly, or an object literal containing\n * properties. If you pass an object literal, you may include a Geometry\n * associated with a `geometry` key.\n * @api\n */\nconst Feature = function(opt_geometryOrProperties) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {number|string|undefined}\n   */\n  this.id_ = undefined;\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.geometryName_ = 'geometry';\n\n  /**\n   * User provided style.\n   * @private\n   * @type {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n   */\n  this.style_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Style~StyleFunction|undefined}\n   */\n  this.styleFunction_ = undefined;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.geometryChangeKey_ = null;\n\n  listen(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n\n  if (opt_geometryOrProperties !== undefined) {\n    if (opt_geometryOrProperties instanceof Geometry ||\n        !opt_geometryOrProperties) {\n      const geometry = opt_geometryOrProperties;\n      this.setGeometry(geometry);\n    } else {\n      /** @type {Object.<string, *>} */\n      const properties = opt_geometryOrProperties;\n      this.setProperties(properties);\n    }\n  }\n};\n\ninherits(Feature, BaseObject);\n\n\n/**\n * Clone this feature. If the original feature has a geometry it\n * is also cloned. The feature id is not set in the clone.\n * @return {module:ol/Feature} The clone.\n * @api\n */\nFeature.prototype.clone = function() {\n  const clone = new Feature(this.getProperties());\n  clone.setGeometryName(this.getGeometryName());\n  const geometry = this.getGeometry();\n  if (geometry) {\n    clone.setGeometry(geometry.clone());\n  }\n  const style = this.getStyle();\n  if (style) {\n    clone.setStyle(style);\n  }\n  return clone;\n};\n\n\n/**\n * Get the feature's default geometry.  A feature may have any number of named\n * geometries.  The \"default\" geometry (the one that is rendered by default) is\n * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n * @return {module:ol/geom/Geometry|undefined} The default geometry for the feature.\n * @api\n * @observable\n */\nFeature.prototype.getGeometry = function() {\n  return (\n    /** @type {module:ol/geom/Geometry|undefined} */ (this.get(this.geometryName_))\n  );\n};\n\n\n/**\n * Get the feature identifier.  This is a stable identifier for the feature and\n * is either set when reading data from a remote source or set explicitly by\n * calling {@link module:ol/Feature~Feature#setId}.\n * @return {number|string|undefined} Id.\n * @api\n */\nFeature.prototype.getId = function() {\n  return this.id_;\n};\n\n\n/**\n * Get the name of the feature's default geometry.  By default, the default\n * geometry is named `geometry`.\n * @return {string} Get the property name associated with the default geometry\n *     for this feature.\n * @api\n */\nFeature.prototype.getGeometryName = function() {\n  return this.geometryName_;\n};\n\n\n/**\n * Get the feature's style. Will return what was provided to the\n * {@link module:ol/Feature~Feature#setStyle} method.\n * @return {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} The feature style.\n * @api\n */\nFeature.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Get the feature's style function.\n * @return {module:ol/style/Style~StyleFunction|undefined} Return a function\n * representing the current style of this feature.\n * @api\n */\nFeature.prototype.getStyleFunction = function() {\n  return this.styleFunction_;\n};\n\n\n/**\n * @private\n */\nFeature.prototype.handleGeometryChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @private\n */\nFeature.prototype.handleGeometryChanged_ = function() {\n  if (this.geometryChangeKey_) {\n    unlistenByKey(this.geometryChangeKey_);\n    this.geometryChangeKey_ = null;\n  }\n  const geometry = this.getGeometry();\n  if (geometry) {\n    this.geometryChangeKey_ = listen(geometry,\n      EventType.CHANGE, this.handleGeometryChange_, this);\n  }\n  this.changed();\n};\n\n\n/**\n * Set the default geometry for the feature.  This will update the property\n * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n * @param {module:ol/geom/Geometry|undefined} geometry The new geometry.\n * @api\n * @observable\n */\nFeature.prototype.setGeometry = function(geometry) {\n  this.set(this.geometryName_, geometry);\n};\n\n\n/**\n * Set the style for the feature.  This can be a single style object, an array\n * of styles, or a function that takes a resolution and returns an array of\n * styles. If it is `null` the feature has no style (a `null` style).\n * @param {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} style Style for this feature.\n * @api\n * @fires module:ol/events/Event~Event#event:change\n */\nFeature.prototype.setStyle = function(style) {\n  this.style_ = style;\n  this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n  this.changed();\n};\n\n\n/**\n * Set the feature id.  The feature id is considered stable and may be used when\n * requesting features or comparing identifiers returned from a remote source.\n * The feature id can be used with the\n * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n * @param {number|string|undefined} id The feature id.\n * @api\n * @fires module:ol/events/Event~Event#event:change\n */\nFeature.prototype.setId = function(id) {\n  this.id_ = id;\n  this.changed();\n};\n\n\n/**\n * Set the property name to be used when getting the feature's default geometry.\n * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n * this name will be returned.\n * @param {string} name The property name of the default geometry.\n * @api\n */\nFeature.prototype.setGeometryName = function(name) {\n  unlisten(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n  this.geometryName_ = name;\n  listen(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n  this.handleGeometryChanged_();\n};\n\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of module:ol/style/Style or single style objects wrapped\n * in a new feature style function.\n * @param {module:ol/style/Style~StyleFunction|!Array.<module:ol/style/Style>|!module:ol/style/Style} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {module:ol/style/Style~StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  } else {\n    /**\n     * @type {Array.<module:ol/style/Style>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(obj instanceof Style,\n        41); // Expected an `module:ol/style/Style~Style` or an array of `module:ol/style/Style~Style`\n      styles = [obj];\n    }\n    return function() {\n      return styles;\n    };\n  }\n}\nexport default Feature;\n","/**\n * @module ol/GeolocationProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ACCURACY: 'accuracy',\n  ACCURACY_GEOMETRY: 'accuracyGeometry',\n  ALTITUDE: 'altitude',\n  ALTITUDE_ACCURACY: 'altitudeAccuracy',\n  HEADING: 'heading',\n  POSITION: 'position',\n  PROJECTION: 'projection',\n  SPEED: 'speed',\n  TRACKING: 'tracking',\n  TRACKING_OPTIONS: 'trackingOptions'\n};\n","/**\n * @module ol/array\n */\n\n\n/**\n * Performs a binary search on the provided sorted list and returns the index of the item if found. If it can't be found it'll return -1.\n * https://github.com/darkskyapp/binary-search\n *\n * @param {Array.<*>} haystack Items to search through.\n * @param {*} needle The item to look for.\n * @param {Function=} opt_comparator Comparator function.\n * @return {number} The index of the item if found, -1 if not.\n */\nexport function binarySearch(haystack, needle, opt_comparator) {\n  let mid, cmp;\n  const comparator = opt_comparator || numberSafeCompareFunction;\n  let low = 0;\n  let high = haystack.length;\n  let found = false;\n\n  while (low < high) {\n    /* Note that \"(low + high) >>> 1\" may overflow, and results in a typecast\n     * to double (which gives the wrong results). */\n    mid = low + (high - low >> 1);\n    cmp = +comparator(haystack[mid], needle);\n\n    if (cmp < 0.0) { /* Too low. */\n      low  = mid + 1;\n\n    } else { /* Key found or too high */\n      high = mid;\n      found = !cmp;\n    }\n  }\n\n  /* Key not found. */\n  return found ? low : ~low;\n}\n\n\n/**\n * Compare function for array sort that is safe for numbers.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second.\n */\nexport function numberSafeCompareFunction(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n\n/**\n * Whether the array contains the given object.\n * @param {Array.<*>} arr The array to test for the presence of the element.\n * @param {*} obj The object for which to test.\n * @return {boolean} The object is in the array.\n */\nexport function includes(arr, obj) {\n  return arr.indexOf(obj) >= 0;\n}\n\n\n/**\n * @param {Array.<number>} arr Array.\n * @param {number} target Target.\n * @param {number} direction 0 means return the nearest, > 0\n *    means return the largest nearest, < 0 means return the\n *    smallest nearest.\n * @return {number} Index.\n */\nexport function linearFindNearest(arr, target, direction) {\n  const n = arr.length;\n  if (arr[0] <= target) {\n    return 0;\n  } else if (target <= arr[n - 1]) {\n    return n - 1;\n  } else {\n    let i;\n    if (direction > 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] < target) {\n          return i - 1;\n        }\n      }\n    } else if (direction < 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] <= target) {\n          return i;\n        }\n      }\n    } else {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] == target) {\n          return i;\n        } else if (arr[i] < target) {\n          if (arr[i - 1] - target < target - arr[i]) {\n            return i - 1;\n          } else {\n            return i;\n          }\n        }\n      }\n    }\n    return n - 1;\n  }\n}\n\n\n/**\n * @param {Array.<*>} arr Array.\n * @param {number} begin Begin index.\n * @param {number} end End index.\n */\nexport function reverseSubArray(arr, begin, end) {\n  while (begin < end) {\n    const tmp = arr[begin];\n    arr[begin] = arr[end];\n    arr[end] = tmp;\n    ++begin;\n    --end;\n  }\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to modify.\n * @param {!Array.<VALUE>|VALUE} data The elements or arrays of elements to add to arr.\n * @template VALUE\n */\nexport function extend(arr, data) {\n  const extension = Array.isArray(data) ? data : [data];\n  const length = extension.length;\n  for (let i = 0; i < length; i++) {\n    arr[arr.length] = extension[i];\n  }\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to modify.\n * @param {VALUE} obj The element to remove.\n * @template VALUE\n * @return {boolean} If the element was removed.\n */\nexport function remove(arr, obj) {\n  const i = arr.indexOf(obj);\n  const found = i > -1;\n  if (found) {\n    arr.splice(i, 1);\n  }\n  return found;\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to search in.\n * @param {function(VALUE, number, ?) : boolean} func The function to compare.\n * @template VALUE\n * @return {VALUE|null} The element found or null.\n */\nexport function find(arr, func) {\n  const length = arr.length >>> 0;\n  let value;\n\n  for (let i = 0; i < length; i++) {\n    value = arr[i];\n    if (func(value, i, arr)) {\n      return value;\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {Array|Uint8ClampedArray} arr1 The first array to compare.\n * @param {Array|Uint8ClampedArray} arr2 The second array to compare.\n * @return {boolean} Whether the two arrays are equal.\n */\nexport function equals(arr1, arr2) {\n  const len1 = arr1.length;\n  if (len1 !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < len1; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<*>} arr The array to sort (modifies original).\n * @param {Function} compareFnc Comparison function.\n */\nexport function stableSort(arr, compareFnc) {\n  const length = arr.length;\n  const tmp = Array(arr.length);\n  let i;\n  for (i = 0; i < length; i++) {\n    tmp[i] = {index: i, value: arr[i]};\n  }\n  tmp.sort(function(a, b) {\n    return compareFnc(a.value, b.value) || a.index - b.index;\n  });\n  for (i = 0; i < arr.length; i++) {\n    arr[i] = tmp[i].value;\n  }\n}\n\n\n/**\n * @param {Array.<*>} arr The array to search in.\n * @param {Function} func Comparison function.\n * @return {number} Return index.\n */\nexport function findIndex(arr, func) {\n  let index;\n  const found = !arr.every(function(el, idx) {\n    index = idx;\n    return !func(el, idx, arr);\n  });\n  return found ? index : -1;\n}\n\n\n/**\n * @param {Array.<*>} arr The array to test.\n * @param {Function=} opt_func Comparison function.\n * @param {boolean=} opt_strict Strictly sorted (default false).\n * @return {boolean} Return index.\n */\nexport function isSorted(arr, opt_func, opt_strict) {\n  const compare = opt_func || numberSafeCompareFunction;\n  return arr.every(function(currentVal, index) {\n    if (index === 0) {\n      return true;\n    }\n    const res = compare(arr[index - 1], currentVal);\n    return !(res > 0 || opt_strict && res === 0);\n  });\n}\n","/**\n * @module ol/geom/GeometryLayout\n */\n\n/**\n * The coordinate layout for geometries, indicating whether a 3rd or 4th z ('Z')\n * or measure ('M') coordinate is available. Supported values are `'XY'`,\n * `'XYZ'`, `'XYM'`, `'XYZM'`.\n * @enum {string}\n */\nexport default {\n  XY: 'XY',\n  XYZ: 'XYZ',\n  XYM: 'XYM',\n  XYZM: 'XYZM'\n};\n","/**\n * @module ol/geom/SimpleGeometry\n */\nimport {inherits} from '../index.js';\nimport {FALSE} from '../functions.js';\nimport {createOrUpdateFromFlatCoordinates, getCenter} from '../extent.js';\nimport Geometry from '../geom/Geometry.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport {rotate, scale, translate, transform2D} from '../geom/flat/transform.js';\nimport {clear} from '../obj.js';\n\n/**\n * @classdesc\n * Abstract base class; only used for creating subclasses; do not instantiate\n * in apps, as cannot be rendered.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/geom/Geometry}\n * @api\n */\nconst SimpleGeometry = function() {\n\n  Geometry.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/geom/GeometryLayout}\n   */\n  this.layout = GeometryLayout.XY;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.stride = 2;\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.flatCoordinates = null;\n\n};\n\ninherits(SimpleGeometry, Geometry);\n\n\n/**\n * @param {number} stride Stride.\n * @return {module:ol/geom/GeometryLayout} layout Layout.\n */\nfunction getLayoutForStride(stride) {\n  let layout;\n  if (stride == 2) {\n    layout = GeometryLayout.XY;\n  } else if (stride == 3) {\n    layout = GeometryLayout.XYZ;\n  } else if (stride == 4) {\n    layout = GeometryLayout.XYZM;\n  }\n  return (\n    /** @type {module:ol/geom/GeometryLayout} */ (layout)\n  );\n}\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @return {number} Stride.\n */\nexport function getStrideForLayout(layout) {\n  let stride;\n  if (layout == GeometryLayout.XY) {\n    stride = 2;\n  } else if (layout == GeometryLayout.XYZ || layout == GeometryLayout.XYM) {\n    stride = 3;\n  } else if (layout == GeometryLayout.XYZM) {\n    stride = 4;\n  }\n  return /** @type {number} */ (stride);\n}\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.containsXY = FALSE;\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.computeExtent = function(extent) {\n  return createOrUpdateFromFlatCoordinates(this.flatCoordinates,\n    0, this.flatCoordinates.length, this.stride, extent);\n};\n\n\n/**\n * @abstract\n * @return {Array} Coordinates.\n */\nSimpleGeometry.prototype.getCoordinates = function() {};\n\n\n/**\n * Return the first coordinate of the geometry.\n * @return {module:ol/coordinate~Coordinate} First coordinate.\n * @api\n */\nSimpleGeometry.prototype.getFirstCoordinate = function() {\n  return this.flatCoordinates.slice(0, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Flat coordinates.\n */\nSimpleGeometry.prototype.getFlatCoordinates = function() {\n  return this.flatCoordinates;\n};\n\n\n/**\n * Return the last coordinate of the geometry.\n * @return {module:ol/coordinate~Coordinate} Last point.\n * @api\n */\nSimpleGeometry.prototype.getLastCoordinate = function() {\n  return this.flatCoordinates.slice(this.flatCoordinates.length - this.stride);\n};\n\n\n/**\n * Return the {@link module:ol/geom/GeometryLayout~GeometryLayout layout} of the geometry.\n * @return {module:ol/geom/GeometryLayout} Layout.\n * @api\n */\nSimpleGeometry.prototype.getLayout = function() {\n  return this.layout;\n};\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.getSimplifiedGeometry = function(squaredTolerance) {\n  if (this.simplifiedGeometryRevision != this.getRevision()) {\n    clear(this.simplifiedGeometryCache);\n    this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n    this.simplifiedGeometryRevision = this.getRevision();\n  }\n  // If squaredTolerance is negative or if we know that simplification will not\n  // have any effect then just return this.\n  if (squaredTolerance < 0 ||\n      (this.simplifiedGeometryMaxMinSquaredTolerance !== 0 &&\n       squaredTolerance <= this.simplifiedGeometryMaxMinSquaredTolerance)) {\n    return this;\n  }\n  const key = squaredTolerance.toString();\n  if (this.simplifiedGeometryCache.hasOwnProperty(key)) {\n    return this.simplifiedGeometryCache[key];\n  } else {\n    const simplifiedGeometry =\n        this.getSimplifiedGeometryInternal(squaredTolerance);\n    const simplifiedFlatCoordinates = simplifiedGeometry.getFlatCoordinates();\n    if (simplifiedFlatCoordinates.length < this.flatCoordinates.length) {\n      this.simplifiedGeometryCache[key] = simplifiedGeometry;\n      return simplifiedGeometry;\n    } else {\n      // Simplification did not actually remove any coordinates.  We now know\n      // that any calls to getSimplifiedGeometry with a squaredTolerance less\n      // than or equal to the current squaredTolerance will also not have any\n      // effect.  This allows us to short circuit simplification (saving CPU\n      // cycles) and prevents the cache of simplified geometries from filling\n      // up with useless identical copies of this geometry (saving memory).\n      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;\n      return this;\n    }\n  }\n};\n\n\n/**\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/SimpleGeometry} Simplified geometry.\n * @protected\n */\nSimpleGeometry.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  return this;\n};\n\n\n/**\n * @return {number} Stride.\n */\nSimpleGeometry.prototype.getStride = function() {\n  return this.stride;\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @protected\n */\nSimpleGeometry.prototype.setFlatCoordinatesInternal = function(layout, flatCoordinates) {\n  this.stride = getStrideForLayout(layout);\n  this.layout = layout;\n  this.flatCoordinates = flatCoordinates;\n};\n\n\n/**\n * @abstract\n * @param {Array} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n */\nSimpleGeometry.prototype.setCoordinates = function(coordinates, opt_layout) {};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout|undefined} layout Layout.\n * @param {Array} coordinates Coordinates.\n * @param {number} nesting Nesting.\n * @protected\n */\nSimpleGeometry.prototype.setLayout = function(layout, coordinates, nesting) {\n  /** @type {number} */\n  let stride;\n  if (layout) {\n    stride = getStrideForLayout(layout);\n  } else {\n    for (let i = 0; i < nesting; ++i) {\n      if (coordinates.length === 0) {\n        this.layout = GeometryLayout.XY;\n        this.stride = 2;\n        return;\n      } else {\n        coordinates = /** @type {Array} */ (coordinates[0]);\n      }\n    }\n    stride = coordinates.length;\n    layout = getLayoutForStride(stride);\n  }\n  this.layout = layout;\n  this.stride = stride;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.applyTransform = function(transformFn) {\n  if (this.flatCoordinates) {\n    transformFn(this.flatCoordinates, this.flatCoordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.rotate = function(angle, anchor) {\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    rotate(\n      flatCoordinates, 0, flatCoordinates.length,\n      stride, angle, anchor, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.scale = function(sx, opt_sy, opt_anchor) {\n  let sy = opt_sy;\n  if (sy === undefined) {\n    sy = sx;\n  }\n  let anchor = opt_anchor;\n  if (!anchor) {\n    anchor = getCenter(this.getExtent());\n  }\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    scale(\n      flatCoordinates, 0, flatCoordinates.length,\n      stride, sx, sy, anchor, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.translate = function(deltaX, deltaY) {\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    translate(\n      flatCoordinates, 0, flatCoordinates.length, stride,\n      deltaX, deltaY, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} simpleGeometry Simple geometry.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed flat coordinates.\n */\nexport function transformGeom2D(simpleGeometry, transform, opt_dest) {\n  const flatCoordinates = simpleGeometry.getFlatCoordinates();\n  if (!flatCoordinates) {\n    return null;\n  } else {\n    const stride = simpleGeometry.getStride();\n    return transform2D(\n      flatCoordinates, 0, flatCoordinates.length, stride,\n      transform, opt_dest);\n  }\n}\n\nexport default SimpleGeometry;\n","/**\n * @module ol/geom/flat/area\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRing(flatCoordinates, offset, end, stride) {\n  let twiceArea = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    twiceArea += y1 * x2 - x1 * y2;\n    x1 = x2;\n    y1 = y2;\n  }\n  return twiceArea / 2;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRings(flatCoordinates, offset, ends, stride) {\n  let area = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    area += linearRing(flatCoordinates, offset, end, stride);\n    offset = end;\n  }\n  return area;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  let area = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    area += linearRings(flatCoordinates, offset, ends, stride);\n    offset = ends[ends.length - 1];\n  }\n  return area;\n}\n","/**\n * @module ol/geom/flat/closest\n */\nimport {lerp, squaredDistance as squaredDx} from '../../math.js';\n\n\n/**\n * Returns the point on the 2D line segment flatCoordinates[offset1] to\n * flatCoordinates[offset2] that is closest to the point (x, y).  Extra\n * dimensions are linearly interpolated.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset1 Offset 1.\n * @param {number} offset2 Offset 2.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n */\nfunction assignClosest(flatCoordinates, offset1, offset2, stride, x, y, closestPoint) {\n  const x1 = flatCoordinates[offset1];\n  const y1 = flatCoordinates[offset1 + 1];\n  const dx = flatCoordinates[offset2] - x1;\n  const dy = flatCoordinates[offset2 + 1] - y1;\n  let offset;\n  if (dx === 0 && dy === 0) {\n    offset = offset1;\n  } else {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      offset = offset2;\n    } else if (t > 0) {\n      for (let i = 0; i < stride; ++i) {\n        closestPoint[i] = lerp(flatCoordinates[offset1 + i],\n          flatCoordinates[offset2 + i], t);\n      }\n      closestPoint.length = stride;\n      return;\n    } else {\n      offset = offset1;\n    }\n  }\n  for (let i = 0; i < stride; ++i) {\n    closestPoint[i] = flatCoordinates[offset + i];\n  }\n  closestPoint.length = stride;\n}\n\n\n/**\n * Return the squared of the largest distance between any pair of consecutive\n * coordinates.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function maxSquaredDelta(flatCoordinates, offset, end, stride, max) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  for (offset += stride; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    const squaredDelta = squaredDx(x1, y1, x2, y2);\n    if (squaredDelta > max) {\n      max = squaredDelta;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function arrayMaxSquaredDelta(flatCoordinates, offset, ends, stride, max) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    max = maxSquaredDelta(\n      flatCoordinates, offset, end, stride, max);\n    offset = end;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function multiArrayMaxSquaredDelta(flatCoordinates, offset, endss, stride, max) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    max = arrayMaxSquaredDelta(\n      flatCoordinates, offset, ends, stride, max);\n    offset = ends[ends.length - 1];\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestPoint(flatCoordinates, offset, end,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  if (offset == end) {\n    return minSquaredDistance;\n  }\n  let i, squaredDistance;\n  if (maxDelta === 0) {\n    // All points are identical, so just test the first point.\n    squaredDistance = squaredDx(\n      x, y, flatCoordinates[offset], flatCoordinates[offset + 1]);\n    if (squaredDistance < minSquaredDistance) {\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = flatCoordinates[offset + i];\n      }\n      closestPoint.length = stride;\n      return squaredDistance;\n    } else {\n      return minSquaredDistance;\n    }\n  }\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  let index = offset + stride;\n  while (index < end) {\n    assignClosest(\n      flatCoordinates, index - stride, index, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n      index += stride;\n    } else {\n      // Skip ahead multiple points, because we know that all the skipped\n      // points cannot be any closer than the closest point we have found so\n      // far.  We know this because we know how close the current point is, how\n      // close the closest point we have found so far is, and the maximum\n      // distance between consecutive points.  For example, if we're currently\n      // at distance 10, the best we've found so far is 3, and that the maximum\n      // distance between consecutive points is 2, then we'll need to skip at\n      // least (10 - 3) / 2 == 3 (rounded down) points to have any chance of\n      // finding a closer point.  We use Math.max(..., 1) to ensure that we\n      // always advance at least one point, to avoid an infinite loop.\n      index += stride * Math.max(\n        ((Math.sqrt(squaredDistance) -\n            Math.sqrt(minSquaredDistance)) / maxDelta) | 0, 1);\n    }\n  }\n  if (isRing) {\n    // Check the closing segment.\n    assignClosest(\n      flatCoordinates, end - stride, offset, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n    }\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestArrayPoint(flatCoordinates, offset, ends,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    minSquaredDistance = assignClosestPoint(\n      flatCoordinates, offset, end, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = end;\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestMultiArrayPoint(flatCoordinates, offset,\n  endss, stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    minSquaredDistance = assignClosestArrayPoint(\n      flatCoordinates, offset, ends, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = ends[ends.length - 1];\n  }\n  return minSquaredDistance;\n}\n","/**\n * @module ol/geom/flat/deflate\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinate(flatCoordinates, offset, coordinate, stride) {\n  for (let i = 0, ii = coordinate.length; i < ii; ++i) {\n    flatCoordinates[offset++] = coordinate[i];\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinates(flatCoordinates, offset, coordinates, stride) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    const coordinate = coordinates[i];\n    for (let j = 0; j < stride; ++j) {\n      flatCoordinates[offset++] = coordinate[j];\n    }\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinatess Coordinatess.\n * @param {number} stride Stride.\n * @param {Array.<number>=} opt_ends Ends.\n * @return {Array.<number>} Ends.\n */\nexport function deflateCoordinatesArray(flatCoordinates, offset, coordinatess, stride, opt_ends) {\n  const ends = opt_ends ? opt_ends : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatess.length; j < jj; ++j) {\n    const end = deflateCoordinates(\n      flatCoordinates, offset, coordinatess[j], stride);\n    ends[i++] = end;\n    offset = end;\n  }\n  ends.length = i;\n  return ends;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinatesss Coordinatesss.\n * @param {number} stride Stride.\n * @param {Array.<Array.<number>>=} opt_endss Endss.\n * @return {Array.<Array.<number>>} Endss.\n */\nexport function deflateMultiCoordinatesArray(flatCoordinates, offset, coordinatesss, stride, opt_endss) {\n  const endss = opt_endss ? opt_endss : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatesss.length; j < jj; ++j) {\n    const ends = deflateCoordinatesArray(\n      flatCoordinates, offset, coordinatesss[j], stride, endss[i]);\n    endss[i++] = ends;\n    offset = ends[ends.length - 1];\n  }\n  endss.length = i;\n  return endss;\n}\n","/**\n * @module ol/geom/flat/inflate\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {Array.<module:ol/coordinate~Coordinate>=} opt_coordinates Coordinates.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n */\nexport function inflateCoordinates(flatCoordinates, offset, end, stride, opt_coordinates) {\n  const coordinates = opt_coordinates !== undefined ? opt_coordinates : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    coordinates[i++] = flatCoordinates.slice(j, j + stride);\n  }\n  coordinates.length = i;\n  return coordinates;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>=} opt_coordinatess Coordinatess.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinatess.\n */\nexport function inflateCoordinatesArray(flatCoordinates, offset, ends, stride, opt_coordinatess) {\n  const coordinatess = opt_coordinatess !== undefined ? opt_coordinatess : [];\n  let i = 0;\n  for (let j = 0, jj = ends.length; j < jj; ++j) {\n    const end = ends[j];\n    coordinatess[i++] = inflateCoordinates(\n      flatCoordinates, offset, end, stride, coordinatess[i]);\n    offset = end;\n  }\n  coordinatess.length = i;\n  return coordinatess;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>=} opt_coordinatesss\n *     Coordinatesss.\n * @return {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} Coordinatesss.\n */\nexport function inflateMultiCoordinatesArray(flatCoordinates, offset, endss, stride, opt_coordinatesss) {\n  const coordinatesss = opt_coordinatesss !== undefined ? opt_coordinatesss : [];\n  let i = 0;\n  for (let j = 0, jj = endss.length; j < jj; ++j) {\n    const ends = endss[j];\n    coordinatesss[i++] = inflateCoordinatesArray(\n      flatCoordinates, offset, ends, stride, coordinatesss[i]);\n    offset = ends[ends.length - 1];\n  }\n  coordinatesss.length = i;\n  return coordinatesss;\n}\n","/**\n * @module ol/geom/flat/simplify\n */\n// Based on simplify-js https://github.com/mourner/simplify-js\n// Copyright (c) 2012, Vladimir Agafonkin\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n//    1. Redistributions of source code must retain the above copyright notice,\n//       this list of conditions and the following disclaimer.\n//\n//    2. Redistributions in binary form must reproduce the above copyright\n//       notice, this list of conditions and the following disclaimer in the\n//       documentation and/or other materials provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n// POSSIBILITY OF SUCH DAMAGE.\n\nimport {squaredSegmentDistance, squaredDistance} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {boolean} highQuality Highest quality.\n * @param {Array.<number>=} opt_simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @return {Array.<number>} Simplified line string.\n */\nexport function simplifyLineString(flatCoordinates, offset, end,\n  stride, squaredTolerance, highQuality, opt_simplifiedFlatCoordinates) {\n  const simplifiedFlatCoordinates = opt_simplifiedFlatCoordinates !== undefined ?\n    opt_simplifiedFlatCoordinates : [];\n  if (!highQuality) {\n    end = radialDistance(flatCoordinates, offset, end,\n      stride, squaredTolerance,\n      simplifiedFlatCoordinates, 0);\n    flatCoordinates = simplifiedFlatCoordinates;\n    offset = 0;\n    stride = 2;\n  }\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    flatCoordinates, offset, end, stride, squaredTolerance,\n    simplifiedFlatCoordinates, 0);\n  return simplifiedFlatCoordinates;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function douglasPeucker(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  const n = (end - offset) / stride;\n  if (n < 3) {\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  /** @type {Array.<number>} */\n  const markers = new Array(n);\n  markers[0] = 1;\n  markers[n - 1] = 1;\n  /** @type {Array.<number>} */\n  const stack = [offset, end - stride];\n  let index = 0;\n  while (stack.length > 0) {\n    const last = stack.pop();\n    const first = stack.pop();\n    let maxSquaredDistance = 0;\n    const x1 = flatCoordinates[first];\n    const y1 = flatCoordinates[first + 1];\n    const x2 = flatCoordinates[last];\n    const y2 = flatCoordinates[last + 1];\n    for (let i = first + stride; i < last; i += stride) {\n      const x = flatCoordinates[i];\n      const y = flatCoordinates[i + 1];\n      const squaredDistance = squaredSegmentDistance(\n        x, y, x1, y1, x2, y2);\n      if (squaredDistance > maxSquaredDistance) {\n        index = i;\n        maxSquaredDistance = squaredDistance;\n      }\n    }\n    if (maxSquaredDistance > squaredTolerance) {\n      markers[(index - offset) / stride] = 1;\n      if (first + stride < index) {\n        stack.push(first, index);\n      }\n      if (index + stride < last) {\n        stack.push(index, last);\n      }\n    }\n  }\n  for (let i = 0; i < n; ++i) {\n    if (markers[i]) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride + 1];\n    }\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerArray(flatCoordinates, offset,\n  ends, stride, squaredTolerance, simplifiedFlatCoordinates,\n  simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = douglasPeucker(\n      flatCoordinates, offset, end, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<Array.<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerMultiArray(\n  flatCoordinates, offset, endss, stride, squaredTolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = douglasPeuckerArray(\n      flatCoordinates, offset, ends, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function radialDistance(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  if (end <= offset + stride) {\n    // zero or one point, no simplification possible, so copy and return\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  // copy first point\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  let x2 = x1;\n  let y2 = y1;\n  for (offset += stride; offset < end; offset += stride) {\n    x2 = flatCoordinates[offset];\n    y2 = flatCoordinates[offset + 1];\n    if (squaredDistance(x1, y1, x2, y2) > squaredTolerance) {\n      // copy point at offset\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  if (x2 != x1 || y2 != y1) {\n    // copy last point\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {number} value Value.\n * @param {number} tolerance Tolerance.\n * @return {number} Rounded value.\n */\nexport function snap(value, tolerance) {\n  return tolerance * Math.round(value / tolerance);\n}\n\n\n/**\n * Simplifies a line string using an algorithm designed by Tim Schaub.\n * Coordinates are snapped to the nearest value in a virtual grid and\n * consecutive duplicate coordinates are discarded.  This effectively preserves\n * topology as the simplification of any subsection of a line string is\n * independent of the rest of the line string.  This means that, for examples,\n * the common edge between two polygons will be simplified to the same line\n * string independently in both polygons.  This implementation uses a single\n * pass over the coordinates and eliminates intermediate collinear points.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function quantize(flatCoordinates, offset, end, stride,\n  tolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  // do nothing if the line is empty\n  if (offset == end) {\n    return simplifiedOffset;\n  }\n  // snap the first coordinate (P1)\n  let x1 = snap(flatCoordinates[offset], tolerance);\n  let y1 = snap(flatCoordinates[offset + 1], tolerance);\n  offset += stride;\n  // add the first coordinate to the output\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  // find the next coordinate that does not snap to the same value as the first\n  // coordinate (P2)\n  let x2, y2;\n  do {\n    x2 = snap(flatCoordinates[offset], tolerance);\n    y2 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    if (offset == end) {\n      // all coordinates snap to the same value, the line collapses to a point\n      // push the last snapped value anyway to ensure that the output contains\n      // at least two points\n      // FIXME should we really return at least two points anyway?\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      return simplifiedOffset;\n    }\n  } while (x2 == x1 && y2 == y1);\n  while (offset < end) {\n    // snap the next coordinate (P3)\n    const x3 = snap(flatCoordinates[offset], tolerance);\n    const y3 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    // skip P3 if it is equal to P2\n    if (x3 == x2 && y3 == y2) {\n      continue;\n    }\n    // calculate the delta between P1 and P2\n    const dx1 = x2 - x1;\n    const dy1 = y2 - y1;\n    // calculate the delta between P3 and P1\n    const dx2 = x3 - x1;\n    const dy2 = y3 - y1;\n    // if P1, P2, and P3 are colinear and P3 is further from P1 than P2 is from\n    // P1 in the same direction then P2 is on the straight line between P1 and\n    // P3\n    if ((dx1 * dy2 == dy1 * dx2) &&\n        ((dx1 < 0 && dx2 < dx1) || dx1 == dx2 || (dx1 > 0 && dx2 > dx1)) &&\n        ((dy1 < 0 && dy2 < dy1) || dy1 == dy2 || (dy1 > 0 && dy2 > dy1))) {\n      // discard P2 and set P2 = P3\n      x2 = x3;\n      y2 = y3;\n      continue;\n    }\n    // either P1, P2, and P3 are not colinear, or they are colinear but P3 is\n    // between P3 and P1 or on the opposite half of the line to P2.  add P2,\n    // and continue with P1 = P2 and P2 = P3\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n    x1 = x2;\n    y1 = y2;\n    x2 = x3;\n    y2 = y3;\n  }\n  // add the last point (P2)\n  simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function quantizeArray(\n  flatCoordinates, offset, ends, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = quantize(\n      flatCoordinates, offset, end, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<Array.<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function quantizeMultiArray(\n  flatCoordinates, offset, endss, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = quantizeArray(\n      flatCoordinates, offset, ends, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n","/**\n * @module ol/geom/LinearRing\n */\nimport {inherits} from '../index.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {linearRing as linearRingArea} from '../geom/flat/area.js';\nimport {assignClosestPoint, maxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {douglasPeucker} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Linear ring geometry. Only used as part of polygon; cannot be rendered\n * on its own.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst LinearRing = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(LinearRing, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/LinearRing} Clone.\n * @override\n * @api\n */\nLinearRing.prototype.clone = function() {\n  const linearRing = new LinearRing(null);\n  linearRing.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return linearRing;\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestPoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Return the area of the linear ring on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nLinearRing.prototype.getArea = function() {\n  return linearRingArea(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the coordinates of the linear ring.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nLinearRing.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    squaredTolerance, simplifiedFlatCoordinates, 0);\n  const simplifiedLinearRing = new LinearRing(null);\n  simplifiedLinearRing.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates);\n  return simplifiedLinearRing;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLinearRing.prototype.getType = function() {\n  return GeometryType.LINEAR_RING;\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.intersectsExtent = function(extent) {};\n\n\n/**\n * Set the coordinates of the linear ring.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nLinearRing.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nLinearRing.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default LinearRing;\n","/**\n * @module ol/geom/Point\n */\nimport {inherits} from '../index.js';\nimport {createOrUpdateFromCoordinate, containsXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinate} from '../geom/flat/deflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Point geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {module:ol/coordinate~Coordinate} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Point = function(coordinates, opt_layout) {\n  SimpleGeometry.call(this);\n  this.setCoordinates(coordinates, opt_layout);\n};\n\ninherits(Point, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Point} Clone.\n * @override\n * @api\n */\nPoint.prototype.clone = function() {\n  const point = new Point(null);\n  point.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return point;\n};\n\n\n/**\n * @inheritDoc\n */\nPoint.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  const flatCoordinates = this.flatCoordinates;\n  const squaredDistance = squaredDx(x, y, flatCoordinates[0], flatCoordinates[1]);\n  if (squaredDistance < minSquaredDistance) {\n    const stride = this.stride;\n    for (let i = 0; i < stride; ++i) {\n      closestPoint[i] = flatCoordinates[i];\n    }\n    closestPoint.length = stride;\n    return squaredDistance;\n  } else {\n    return minSquaredDistance;\n  }\n};\n\n\n/**\n * Return the coordinate of the point.\n * @return {module:ol/coordinate~Coordinate} Coordinates.\n * @override\n * @api\n */\nPoint.prototype.getCoordinates = function() {\n  return !this.flatCoordinates ? [] : this.flatCoordinates.slice();\n};\n\n\n/**\n * @inheritDoc\n */\nPoint.prototype.computeExtent = function(extent) {\n  return createOrUpdateFromCoordinate(this.flatCoordinates, extent);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.getType = function() {\n  return GeometryType.POINT;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.intersectsExtent = function(extent) {\n  return containsXY(extent, this.flatCoordinates[0], this.flatCoordinates[1]);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinate(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nPoint.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default Point;\n","/**\n * @module ol/geom/flat/contains\n */\nimport {forEachCorner} from '../../extent.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} Contains extent.\n */\nexport function linearRingContainsExtent(flatCoordinates, offset, end, stride, extent) {\n  const outside = forEachCorner(extent,\n    /**\n     * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n     * @return {boolean} Contains (x, y).\n     */\n    function(coordinate) {\n      return !linearRingContainsXY(flatCoordinates, offset, end, stride, coordinate[0], coordinate[1]);\n    });\n  return !outside;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingContainsXY(flatCoordinates, offset, end, stride, x, y) {\n  // http://geomalgorithms.com/a03-_inclusion.html\n  // Copyright 2000 softSurfer, 2012 Dan Sunday\n  // This code may be freely used and modified for any purpose\n  // providing that this copyright notice is included with it.\n  // SoftSurfer makes no warranty for this code, and cannot be held\n  // liable for any real or imagined damage resulting from its use.\n  // Users of this code must verify correctness for their application.\n  let wn = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    if (y1 <= y) {\n      if (y2 > y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) > 0) {\n        wn++;\n      }\n    } else if (y2 <= y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) < 0) {\n      wn--;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return wn !== 0;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y) {\n  if (ends.length === 0) {\n    return false;\n  }\n  if (!linearRingContainsXY(flatCoordinates, offset, ends[0], stride, x, y)) {\n    return false;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsXY(flatCoordinates, ends[i - 1], ends[i], stride, x, y)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingssContainsXY(flatCoordinates, offset, endss, stride, x, y) {\n  if (endss.length === 0) {\n    return false;\n  }\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/interiorpoint\n */\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {linearRingsContainsXY} from '../flat/contains.js';\n\n\n/**\n * Calculates a point that is likely to lie in the interior of the linear rings.\n * Inspired by JTS's com.vividsolutions.jts.geom.Geometry#getInteriorPoint.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<number>} flatCenters Flat centers.\n * @param {number} flatCentersOffset Flat center offset.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Destination point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointOfArray(flatCoordinates, offset,\n  ends, stride, flatCenters, flatCentersOffset, opt_dest) {\n  let i, ii, x, x1, x2, y1, y2;\n  const y = flatCenters[flatCentersOffset + 1];\n  /** @type {Array.<number>} */\n  const intersections = [];\n  // Calculate intersections with the horizontal line\n  for (let r = 0, rr = ends.length; r < rr; ++r) {\n    const end = ends[r];\n    x1 = flatCoordinates[end - stride];\n    y1 = flatCoordinates[end - stride + 1];\n    for (i = offset; i < end; i += stride) {\n      x2 = flatCoordinates[i];\n      y2 = flatCoordinates[i + 1];\n      if ((y <= y1 && y2 <= y) || (y1 <= y && y <= y2)) {\n        x = (y - y1) / (y2 - y1) * (x2 - x1) + x1;\n        intersections.push(x);\n      }\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  // Find the longest segment of the horizontal line that has its center point\n  // inside the linear ring.\n  let pointX = NaN;\n  let maxSegmentLength = -Infinity;\n  intersections.sort(numberSafeCompareFunction);\n  x1 = intersections[0];\n  for (i = 1, ii = intersections.length; i < ii; ++i) {\n    x2 = intersections[i];\n    const segmentLength = Math.abs(x2 - x1);\n    if (segmentLength > maxSegmentLength) {\n      x = (x1 + x2) / 2;\n      if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n        pointX = x;\n        maxSegmentLength = segmentLength;\n      }\n    }\n    x1 = x2;\n  }\n  if (isNaN(pointX)) {\n    // There is no horizontal line that has its center point inside the linear\n    // ring.  Use the center of the the linear ring's extent.\n    pointX = flatCenters[flatCentersOffset];\n  }\n  if (opt_dest) {\n    opt_dest.push(pointX, y, maxSegmentLength);\n    return opt_dest;\n  } else {\n    return [pointX, y, maxSegmentLength];\n  }\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array.<number>} flatCenters Flat centers.\n * @return {Array.<number>} Interior points as XYM coordinates, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointsOfMultiArray(flatCoordinates, offset, endss, stride, flatCenters) {\n  let interiorPoints = [];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    interiorPoints = getInteriorPointOfArray(flatCoordinates,\n      offset, ends, stride, flatCenters, 2 * i, interiorPoints);\n    offset = ends[ends.length - 1];\n  }\n  return interiorPoints;\n}\n","/**\n * @module ol/geom/flat/segments\n */\n\n\n/**\n * This function calls `callback` for each segment of the flat coordinates\n * array. If the callback returns a truthy value the function returns that\n * value immediately. Otherwise the function returns `false`.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {function(this: S, module:ol/coordinate~Coordinate, module:ol/coordinate~Coordinate): T} callback Function\n *     called for each segment.\n * @param {S=} opt_this The object to be used as the value of 'this'\n *     within callback.\n * @return {T|boolean} Value.\n * @template T,S\n */\nexport function forEach(flatCoordinates, offset, end, stride, callback, opt_this) {\n  const point1 = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n  const point2 = [];\n  let ret;\n  for (; (offset + stride) < end; offset += stride) {\n    point2[0] = flatCoordinates[offset + stride];\n    point2[1] = flatCoordinates[offset + stride + 1];\n    ret = callback.call(opt_this, point1, point2);\n    if (ret) {\n      return ret;\n    }\n    point1[0] = point2[0];\n    point1[1] = point2[1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/intersectsextent\n */\nimport {containsExtent, createEmpty, extendFlatCoordinates, intersects, intersectsSegment} from '../../extent.js';\nimport {linearRingContainsXY, linearRingContainsExtent} from '../flat/contains.js';\nimport {forEach as forEachSegment} from '../flat/segments.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineString(flatCoordinates, offset, end, stride, extent) {\n  const coordinatesExtent = extendFlatCoordinates(\n    createEmpty(), flatCoordinates, offset, end, stride);\n  if (!intersects(extent, coordinatesExtent)) {\n    return false;\n  }\n  if (containsExtent(extent, coordinatesExtent)) {\n    return true;\n  }\n  if (coordinatesExtent[0] >= extent[0] &&\n      coordinatesExtent[2] <= extent[2]) {\n    return true;\n  }\n  if (coordinatesExtent[1] >= extent[1] &&\n      coordinatesExtent[3] <= extent[3]) {\n    return true;\n  }\n  return forEachSegment(flatCoordinates, offset, end, stride,\n    /**\n     * @param {module:ol/coordinate~Coordinate} point1 Start point.\n     * @param {module:ol/coordinate~Coordinate} point2 End point.\n     * @return {boolean} `true` if the segment and the extent intersect,\n     *     `false` otherwise.\n     */\n    function(point1, point2) {\n      return intersectsSegment(extent, point1, point2);\n    });\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineStringArray(flatCoordinates, offset, ends, stride, extent) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    if (intersectsLineString(\n      flatCoordinates, offset, ends[i], stride, extent)) {\n      return true;\n    }\n    offset = ends[i];\n  }\n  return false;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRing(flatCoordinates, offset, end, stride, extent) {\n  if (intersectsLineString(\n    flatCoordinates, offset, end, stride, extent)) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[3])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[3])) {\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingArray(flatCoordinates, offset, ends, stride, extent) {\n  if (!intersectsLinearRing(\n    flatCoordinates, offset, ends[0], stride, extent)) {\n    return false;\n  }\n  if (ends.length === 1) {\n    return true;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsExtent(flatCoordinates, ends[i - 1], ends[i], stride, extent)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingMultiArray(flatCoordinates, offset, endss, stride, extent) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (intersectsLinearRingArray(\n      flatCoordinates, offset, ends, stride, extent)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/reverse\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nexport function coordinates(flatCoordinates, offset, end, stride) {\n  while (offset < end - stride) {\n    for (let i = 0; i < stride; ++i) {\n      const tmp = flatCoordinates[offset + i];\n      flatCoordinates[offset + i] = flatCoordinates[end - stride + i];\n      flatCoordinates[end - stride + i] = tmp;\n    }\n    offset += stride;\n    end -= stride;\n  }\n}\n","/**\n * @module ol/geom/flat/orient\n */\nimport {coordinates as reverseCoordinates} from '../flat/reverse.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} Is clockwise.\n */\nexport function linearRingIsClockwise(flatCoordinates, offset, end, stride) {\n  // http://tinyurl.com/clockwise-method\n  // https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogrlinearring.cpp\n  let edge = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    edge += (x2 - x1) * (y2 + y1);\n    x1 = x2;\n    y1 = y2;\n  }\n  return edge > 0;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingIsOriented(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    if (i === 0) {\n      if ((right && isClockwise) || (!right && !isClockwise)) {\n        return false;\n      }\n    } else {\n      if ((right && !isClockwise) || (!right && isClockwise)) {\n        return false;\n      }\n    }\n    offset = end;\n  }\n  return true;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingsAreOriented(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    if (!linearRingIsOriented(\n      flatCoordinates, offset, endss[i], stride, opt_right)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRings(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    const reverse = i === 0 ?\n      (right && isClockwise) || (!right && !isClockwise) :\n      (right && !isClockwise) || (!right && isClockwise);\n    if (reverse) {\n      reverseCoordinates(flatCoordinates, offset, end, stride);\n    }\n    offset = end;\n  }\n  return offset;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRingsArray(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = orientLinearRings(\n      flatCoordinates, offset, endss[i], stride, opt_right);\n  }\n  return offset;\n}\n","/**\n * @module ol/geom/Polygon\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, getCenter} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport Point from '../geom/Point.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {offset as sphereOffset} from '../sphere.js';\nimport {linearRings as linearRingsArea} from '../geom/flat/area.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {linearRingsContainsXY} from '../geom/flat/contains.js';\nimport {deflateCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateCoordinatesArray} from '../geom/flat/inflate.js';\nimport {getInteriorPointOfArray} from '../geom/flat/interiorpoint.js';\nimport {intersectsLinearRingArray} from '../geom/flat/intersectsextent.js';\nimport {linearRingIsOriented, orientLinearRings} from '../geom/flat/orient.js';\nimport {quantizeArray} from '../geom/flat/simplify.js';\nimport {modulo} from '../math.js';\n\n/**\n * @classdesc\n * Polygon geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Array of linear\n *     rings that define the polygon. The first linear ring of the array\n *     defines the outer-boundary or surface of the polygon. Each subsequent\n *     linear ring defines a hole in the surface of the polygon. A linear ring\n *     is an array of vertices' coordinates where the first coordinate and the\n *     last are equivalent.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Polygon = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.ends_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatInteriorPointRevision_ = -1;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.flatInteriorPoint_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.orientedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.orientedFlatCoordinates_ = null;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(Polygon, SimpleGeometry);\n\n\n/**\n * Append the passed linear ring to this polygon.\n * @param {module:ol/geom/LinearRing} linearRing Linear ring.\n * @api\n */\nPolygon.prototype.appendLinearRing = function(linearRing) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = linearRing.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, linearRing.getFlatCoordinates());\n  }\n  this.ends_.push(this.flatCoordinates.length);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Polygon} Clone.\n * @override\n * @api\n */\nPolygon.prototype.clone = function() {\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), this.ends_.slice());\n  return polygon;\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.ends_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestArrayPoint(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.containsXY = function(x, y) {\n  return linearRingsContainsXY(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, x, y);\n};\n\n\n/**\n * Return the area of the polygon on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nPolygon.prototype.getArea = function() {\n  return linearRingsArea(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride);\n};\n\n\n/**\n * Get the coordinate array for this geometry.  This array has the structure\n * of a GeoJSON coordinate array for polygons.\n *\n * @param {boolean=} opt_right Orient coordinates according to the right-hand\n *     rule (counter-clockwise for exterior and clockwise for interior rings).\n *     If `false`, coordinates will be oriented according to the left-hand rule\n *     (clockwise for exterior and counter-clockwise for interior rings).\n *     By default, coordinate orientation will depend on how the geometry was\n *     constructed.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinates.\n * @override\n * @api\n */\nPolygon.prototype.getCoordinates = function(opt_right) {\n  let flatCoordinates;\n  if (opt_right !== undefined) {\n    flatCoordinates = this.getOrientedFlatCoordinates().slice();\n    orientLinearRings(\n      flatCoordinates, 0, this.ends_, this.stride, opt_right);\n  } else {\n    flatCoordinates = this.flatCoordinates;\n  }\n\n  return inflateCoordinatesArray(\n    flatCoordinates, 0, this.ends_, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Ends.\n */\nPolygon.prototype.getEnds = function() {\n  return this.ends_;\n};\n\n\n/**\n * @return {Array.<number>} Interior point.\n */\nPolygon.prototype.getFlatInteriorPoint = function() {\n  if (this.flatInteriorPointRevision_ != this.getRevision()) {\n    const flatCenter = getCenter(this.getExtent());\n    this.flatInteriorPoint_ = getInteriorPointOfArray(\n      this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride,\n      flatCenter, 0);\n    this.flatInteriorPointRevision_ = this.getRevision();\n  }\n  return this.flatInteriorPoint_;\n};\n\n\n/**\n * Return an interior point of the polygon.\n * @return {module:ol/geom/Point} Interior point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n * @api\n */\nPolygon.prototype.getInteriorPoint = function() {\n  return new Point(this.getFlatInteriorPoint(), GeometryLayout.XYM);\n};\n\n\n/**\n * Return the number of rings of the polygon,  this includes the exterior\n * ring and any interior rings.\n *\n * @return {number} Number of rings.\n * @api\n */\nPolygon.prototype.getLinearRingCount = function() {\n  return this.ends_.length;\n};\n\n\n/**\n * Return the Nth linear ring of the polygon geometry. Return `null` if the\n * given index is out of range.\n * The exterior linear ring is available at index `0` and the interior rings\n * at index `1` and beyond.\n *\n * @param {number} index Index.\n * @return {module:ol/geom/LinearRing} Linear ring.\n * @api\n */\nPolygon.prototype.getLinearRing = function(index) {\n  if (index < 0 || this.ends_.length <= index) {\n    return null;\n  }\n  const linearRing = new LinearRing(null);\n  linearRing.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]));\n  return linearRing;\n};\n\n\n/**\n * Return the linear rings of the polygon.\n * @return {Array.<module:ol/geom/LinearRing>} Linear rings.\n * @api\n */\nPolygon.prototype.getLinearRings = function() {\n  const layout = this.layout;\n  const flatCoordinates = this.flatCoordinates;\n  const ends = this.ends_;\n  const linearRings = [];\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const linearRing = new LinearRing(null);\n    linearRing.setFlatCoordinates(layout, flatCoordinates.slice(offset, end));\n    linearRings.push(linearRing);\n    offset = end;\n  }\n  return linearRings;\n};\n\n\n/**\n * @return {Array.<number>} Oriented flat coordinates.\n */\nPolygon.prototype.getOrientedFlatCoordinates = function() {\n  if (this.orientedRevision_ != this.getRevision()) {\n    const flatCoordinates = this.flatCoordinates;\n    if (linearRingIsOriented(\n      flatCoordinates, 0, this.ends_, this.stride)) {\n      this.orientedFlatCoordinates_ = flatCoordinates;\n    } else {\n      this.orientedFlatCoordinates_ = flatCoordinates.slice();\n      this.orientedFlatCoordinates_.length =\n          orientLinearRings(\n            this.orientedFlatCoordinates_, 0, this.ends_, this.stride);\n    }\n    this.orientedRevision_ = this.getRevision();\n  }\n  return this.orientedFlatCoordinates_;\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEnds = [];\n  simplifiedFlatCoordinates.length = quantizeArray(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    Math.sqrt(squaredTolerance),\n    simplifiedFlatCoordinates, 0, simplifiedEnds);\n  const simplifiedPolygon = new Polygon(null);\n  simplifiedPolygon.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEnds);\n  return simplifiedPolygon;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPolygon.prototype.getType = function() {\n  return GeometryType.POLYGON;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPolygon.prototype.intersectsExtent = function(extent) {\n  return intersectsLinearRingArray(\n    this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the polygon.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nPolygon.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.ends_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<number>} ends Ends.\n */\nPolygon.prototype.setFlatCoordinates = function(layout, flatCoordinates, ends) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.ends_ = ends;\n  this.changed();\n};\n\nexport default Polygon;\n\n\n/**\n * Create an approximation of a circle on the surface of a sphere.\n * @param {module:ol/coordinate~Coordinate} center Center (`[lon, lat]` in degrees).\n * @param {number} radius The great-circle distance from the center to\n *     the polygon vertices.\n * @param {number=} opt_n Optional number of vertices for the resulting\n *     polygon. Default is `32`.\n * @param {number=} opt_sphereRadius Optional radius for the sphere (defaults to\n *     the Earth's mean radius using the WGS84 ellipsoid).\n * @return {module:ol/geom/Polygon} The \"circular\" polygon.\n * @api\n */\nexport function circular(center, radius, opt_n, opt_sphereRadius) {\n  const n = opt_n ? opt_n : 32;\n  /** @type {Array.<number>} */\n  const flatCoordinates = [];\n  for (let i = 0; i < n; ++i) {\n    extend(flatCoordinates, sphereOffset(center, radius, 2 * Math.PI * i / n, opt_sphereRadius));\n  }\n  flatCoordinates.push(flatCoordinates[0], flatCoordinates[1]);\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(GeometryLayout.XY, flatCoordinates, [flatCoordinates.length]);\n  return polygon;\n}\n\n\n/**\n * Create a polygon from an extent. The layout used is `XY`.\n * @param {module:ol/extent~Extent} extent The extent.\n * @return {module:ol/geom/Polygon} The polygon.\n * @api\n */\nexport function fromExtent(extent) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const flatCoordinates =\n      [minX, minY, minX, maxY, maxX, maxY, maxX, minY, minX, minY];\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    GeometryLayout.XY, flatCoordinates, [flatCoordinates.length]);\n  return polygon;\n}\n\n\n/**\n * Create a regular polygon from a circle.\n * @param {module:ol/geom/Circle} circle Circle geometry.\n * @param {number=} opt_sides Number of sides of the polygon. Default is 32.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n * @return {module:ol/geom/Polygon} Polygon geometry.\n * @api\n */\nexport function fromCircle(circle, opt_sides, opt_angle) {\n  const sides = opt_sides ? opt_sides : 32;\n  const stride = circle.getStride();\n  const layout = circle.getLayout();\n  const polygon = new Polygon(null, layout);\n  const arrayLength = stride * (sides + 1);\n  const flatCoordinates = new Array(arrayLength);\n  for (let i = 0; i < arrayLength; i++) {\n    flatCoordinates[i] = 0;\n  }\n  const ends = [flatCoordinates.length];\n  polygon.setFlatCoordinates(layout, flatCoordinates, ends);\n  makeRegular(polygon, circle.getCenter(), circle.getRadius(), opt_angle);\n  return polygon;\n}\n\n\n/**\n * Modify the coordinates of a polygon to make it a regular polygon.\n * @param {module:ol/geom/Polygon} polygon Polygon geometry.\n * @param {module:ol/coordinate~Coordinate} center Center of the regular polygon.\n * @param {number} radius Radius of the regular polygon.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n */\nexport function makeRegular(polygon, center, radius, opt_angle) {\n  const flatCoordinates = polygon.getFlatCoordinates();\n  const layout = polygon.getLayout();\n  const stride = polygon.getStride();\n  const ends = polygon.getEnds();\n  const sides = flatCoordinates.length / stride - 1;\n  const startAngle = opt_angle ? opt_angle : 0;\n  for (let i = 0; i <= sides; ++i) {\n    const offset = i * stride;\n    const angle = startAngle + (modulo(i, sides) * 2 * Math.PI / sides);\n    flatCoordinates[offset] = center[0] + (radius * Math.cos(angle));\n    flatCoordinates[offset + 1] = center[1] + (radius * Math.sin(angle));\n  }\n  polygon.setFlatCoordinates(layout, flatCoordinates, ends);\n}\n","/**\n * @module ol/Geolocation\n */\nimport {inherits} from './index.js';\nimport GeolocationProperty from './GeolocationProperty.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport {listen} from './events.js';\nimport EventType from './events/EventType.js';\nimport {circular as circularPolygon} from './geom/Polygon.js';\nimport {GEOLOCATION} from './has.js';\nimport {toRadians} from './math.js';\nimport {get as getProjection, getTransformFromProjections, identityTransform} from './proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [tracking=false] Start Tracking right after\n * instantiation.\n * @property {GeolocationPositionOptions} [trackingOptions] Tracking options.\n * See {@link http://www.w3.org/TR/geolocation-API/#position_options_interface}.\n * @property {module:ol/proj~ProjectionLike} [projection] The projection the position\n * is reported in.\n */\n\n\n/**\n * @classdesc\n * Helper class for providing HTML5 Geolocation capabilities.\n * The [Geolocation API](http://www.w3.org/TR/geolocation-API/)\n * is used to locate a user's position.\n *\n * To get notified of position changes, register a listener for the generic\n * `change` event on your instance of {@link module:ol/Geolocation~Geolocation}.\n *\n * Example:\n *\n *     var geolocation = new Geolocation({\n *       // take the projection to use from the map's view\n *       projection: view.getProjection()\n *     });\n *     // listen to changes in position\n *     geolocation.on('change', function(evt) {\n *       window.console.log(geolocation.getPosition());\n *     });\n *\n * @fires error\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/Geolocation~Options=} opt_options Options.\n * @api\n */\nconst Geolocation = function(opt_options) {\n\n  BaseObject.call(this);\n\n  const options = opt_options || {};\n\n  /**\n   * The unprojected (EPSG:4326) device position.\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.position_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/proj~TransformFunction}\n   */\n  this.transform_ = identityTransform;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.watchId_ = undefined;\n\n  listen(\n    this, getChangeEventType(GeolocationProperty.PROJECTION),\n    this.handleProjectionChanged_, this);\n  listen(\n    this, getChangeEventType(GeolocationProperty.TRACKING),\n    this.handleTrackingChanged_, this);\n\n  if (options.projection !== undefined) {\n    this.setProjection(options.projection);\n  }\n  if (options.trackingOptions !== undefined) {\n    this.setTrackingOptions(options.trackingOptions);\n  }\n\n  this.setTracking(options.tracking !== undefined ? options.tracking : false);\n\n};\n\ninherits(Geolocation, BaseObject);\n\n\n/**\n * @inheritDoc\n */\nGeolocation.prototype.disposeInternal = function() {\n  this.setTracking(false);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @private\n */\nGeolocation.prototype.handleProjectionChanged_ = function() {\n  const projection = this.getProjection();\n  if (projection) {\n    this.transform_ = getTransformFromProjections(\n      getProjection('EPSG:4326'), projection);\n    if (this.position_) {\n      this.set(GeolocationProperty.POSITION, this.transform_(this.position_));\n    }\n  }\n};\n\n\n/**\n * @private\n */\nGeolocation.prototype.handleTrackingChanged_ = function() {\n  if (GEOLOCATION) {\n    const tracking = this.getTracking();\n    if (tracking && this.watchId_ === undefined) {\n      this.watchId_ = navigator.geolocation.watchPosition(\n        this.positionChange_.bind(this),\n        this.positionError_.bind(this),\n        this.getTrackingOptions());\n    } else if (!tracking && this.watchId_ !== undefined) {\n      navigator.geolocation.clearWatch(this.watchId_);\n      this.watchId_ = undefined;\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {GeolocationPosition} position position event.\n */\nGeolocation.prototype.positionChange_ = function(position) {\n  const coords = position.coords;\n  this.set(GeolocationProperty.ACCURACY, coords.accuracy);\n  this.set(GeolocationProperty.ALTITUDE,\n    coords.altitude === null ? undefined : coords.altitude);\n  this.set(GeolocationProperty.ALTITUDE_ACCURACY,\n    coords.altitudeAccuracy === null ?\n      undefined : coords.altitudeAccuracy);\n  this.set(GeolocationProperty.HEADING, coords.heading === null ?\n    undefined : toRadians(coords.heading));\n  if (!this.position_) {\n    this.position_ = [coords.longitude, coords.latitude];\n  } else {\n    this.position_[0] = coords.longitude;\n    this.position_[1] = coords.latitude;\n  }\n  const projectedPosition = this.transform_(this.position_);\n  this.set(GeolocationProperty.POSITION, projectedPosition);\n  this.set(GeolocationProperty.SPEED,\n    coords.speed === null ? undefined : coords.speed);\n  const geometry = circularPolygon(this.position_, coords.accuracy);\n  geometry.applyTransform(this.transform_);\n  this.set(GeolocationProperty.ACCURACY_GEOMETRY, geometry);\n  this.changed();\n};\n\n/**\n * Triggered when the Geolocation returns an error.\n * @event error\n * @api\n */\n\n/**\n * @private\n * @param {GeolocationPositionError} error error object.\n */\nGeolocation.prototype.positionError_ = function(error) {\n  error.type = EventType.ERROR;\n  this.setTracking(false);\n  this.dispatchEvent(/** @type {{type: string, target: undefined}} */ (error));\n};\n\n\n/**\n * Get the accuracy of the position in meters.\n * @return {number|undefined} The accuracy of the position measurement in\n *     meters.\n * @observable\n * @api\n */\nGeolocation.prototype.getAccuracy = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.ACCURACY));\n};\n\n\n/**\n * Get a geometry of the position accuracy.\n * @return {?module:ol/geom/Polygon} A geometry of the position accuracy.\n * @observable\n * @api\n */\nGeolocation.prototype.getAccuracyGeometry = function() {\n  return (\n    /** @type {?module:ol/geom/Polygon} */ (this.get(GeolocationProperty.ACCURACY_GEOMETRY) || null)\n  );\n};\n\n\n/**\n * Get the altitude associated with the position.\n * @return {number|undefined} The altitude of the position in meters above mean\n *     sea level.\n * @observable\n * @api\n */\nGeolocation.prototype.getAltitude = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.ALTITUDE));\n};\n\n\n/**\n * Get the altitude accuracy of the position.\n * @return {number|undefined} The accuracy of the altitude measurement in\n *     meters.\n * @observable\n * @api\n */\nGeolocation.prototype.getAltitudeAccuracy = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.ALTITUDE_ACCURACY));\n};\n\n\n/**\n * Get the heading as radians clockwise from North.\n * Note: depending on the browser, the heading is only defined if the `enableHighAccuracy`\n * is set to `true` in the tracking options.\n * @return {number|undefined} The heading of the device in radians from north.\n * @observable\n * @api\n */\nGeolocation.prototype.getHeading = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.HEADING));\n};\n\n\n/**\n * Get the position of the device.\n * @return {module:ol/coordinate~Coordinate|undefined} The current position of the device reported\n *     in the current projection.\n * @observable\n * @api\n */\nGeolocation.prototype.getPosition = function() {\n  return (\n    /** @type {module:ol/coordinate~Coordinate|undefined} */ (this.get(GeolocationProperty.POSITION))\n  );\n};\n\n\n/**\n * Get the projection associated with the position.\n * @return {module:ol/proj/Projection|undefined} The projection the position is\n *     reported in.\n * @observable\n * @api\n */\nGeolocation.prototype.getProjection = function() {\n  return (\n    /** @type {module:ol/proj/Projection|undefined} */ (this.get(GeolocationProperty.PROJECTION))\n  );\n};\n\n\n/**\n * Get the speed in meters per second.\n * @return {number|undefined} The instantaneous speed of the device in meters\n *     per second.\n * @observable\n * @api\n */\nGeolocation.prototype.getSpeed = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.SPEED));\n};\n\n\n/**\n * Determine if the device location is being tracked.\n * @return {boolean} The device location is being tracked.\n * @observable\n * @api\n */\nGeolocation.prototype.getTracking = function() {\n  return /** @type {boolean} */ (this.get(GeolocationProperty.TRACKING));\n};\n\n\n/**\n * Get the tracking options.\n * @see http://www.w3.org/TR/geolocation-API/#position-options\n * @return {GeolocationPositionOptions|undefined} PositionOptions as defined by\n *     the [HTML5 Geolocation spec\n *     ](http://www.w3.org/TR/geolocation-API/#position_options_interface).\n * @observable\n * @api\n */\nGeolocation.prototype.getTrackingOptions = function() {\n  return /** @type {GeolocationPositionOptions|undefined} */ (this.get(GeolocationProperty.TRACKING_OPTIONS));\n};\n\n\n/**\n * Set the projection to use for transforming the coordinates.\n * @param {module:ol/proj~ProjectionLike} projection The projection the position is\n *     reported in.\n * @observable\n * @api\n */\nGeolocation.prototype.setProjection = function(projection) {\n  this.set(GeolocationProperty.PROJECTION, getProjection(projection));\n};\n\n\n/**\n * Enable or disable tracking.\n * @param {boolean} tracking Enable tracking.\n * @observable\n * @api\n */\nGeolocation.prototype.setTracking = function(tracking) {\n  this.set(GeolocationProperty.TRACKING, tracking);\n};\n\n\n/**\n * Set the tracking options.\n * @see http://www.w3.org/TR/geolocation-API/#position-options\n * @param {GeolocationPositionOptions} options PositionOptions as defined by the\n *     [HTML5 Geolocation spec\n *     ](http://www.w3.org/TR/geolocation-API/#position_options_interface).\n * @observable\n * @api\n */\nGeolocation.prototype.setTrackingOptions = function(options) {\n  this.set(GeolocationProperty.TRACKING_OPTIONS, options);\n};\nexport default Geolocation;\n","/**\n * @module ol/string\n */\n\n/**\n * @param {number} number Number to be formatted\n * @param {number} width The desired width\n * @param {number=} opt_precision Precision of the output string (i.e. number of decimal places)\n * @returns {string} Formatted string\n */\nexport function padNumber(number, width, opt_precision) {\n  const numberString = opt_precision !== undefined ? number.toFixed(opt_precision) : '' + number;\n  let decimal = numberString.indexOf('.');\n  decimal = decimal === -1 ? numberString.length : decimal;\n  return decimal > width ? numberString : new Array(1 + width - decimal).join('0') + numberString;\n}\n\n\n/**\n * Adapted from https://github.com/omichelsen/compare-versions/blob/master/index.js\n * @param {string|number} v1 First version\n * @param {string|number} v2 Second version\n * @returns {number} Value\n */\nexport function compareVersions(v1, v2) {\n  const s1 = ('' + v1).split('.');\n  const s2 = ('' + v2).split('.');\n\n  for (let i = 0; i < Math.max(s1.length, s2.length); i++) {\n    const n1 = parseInt(s1[i] || '0', 10);\n    const n2 = parseInt(s2[i] || '0', 10);\n\n    if (n1 > n2) {\n      return 1;\n    }\n    if (n2 > n1) {\n      return -1;\n    }\n  }\n\n  return 0;\n}\n","/**\n * @module ol/coordinate\n */\nimport {modulo} from './math.js';\nimport {padNumber} from './string.js';\n\n\n/**\n * An array of numbers representing an xy coordinate. Example: `[16, 48]`.\n * @typedef {Array.<number>} Coordinate\n * @api\n */\n\n\n/**\n * A function that takes a {@link module:ol/coordinate~Coordinate} and\n * transforms it into a `{string}`.\n *\n * @typedef {function((module:ol/coordinate~Coordinate|undefined)): string} CoordinateFormat\n * @api\n */\n\n\n/**\n * Add `delta` to `coordinate`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {add} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     add(coord, [-2, 4]);\n *     // coord is now [5.85, 51.983333]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/coordinate~Coordinate} delta Delta.\n * @return {module:ol/coordinate~Coordinate} The input coordinate adjusted by\n * the given delta.\n * @api\n */\nexport function add(coordinate, delta) {\n  coordinate[0] += delta[0];\n  coordinate[1] += delta[1];\n  return coordinate;\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed circle.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @param {module:ol/geom/Circle} circle The circle.\n * @return {module:ol/coordinate~Coordinate} Closest point on the circumference.\n */\nexport function closestOnCircle(coordinate, circle) {\n  const r = circle.getRadius();\n  const center = circle.getCenter();\n  const x0 = center[0];\n  const y0 = center[1];\n  const x1 = coordinate[0];\n  const y1 = coordinate[1];\n\n  let dx = x1 - x0;\n  const dy = y1 - y0;\n  if (dx === 0 && dy === 0) {\n    dx = 1;\n  }\n  const d = Math.sqrt(dx * dx + dy * dy);\n\n  const x = x0 + r * dx / d;\n  const y = y0 + r * dy / d;\n\n  return [x, y];\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed segment.\n * This is the foot of the perpendicular of the coordinate to the segment when\n * the foot is on the segment, or the closest segment coordinate when the foot\n * is outside the segment.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @param {Array.<module:ol/coordinate~Coordinate>} segment The two coordinates\n * of the segment.\n * @return {module:ol/coordinate~Coordinate} The foot of the perpendicular of\n * the coordinate to the segment.\n */\nexport function closestOnSegment(coordinate, segment) {\n  const x0 = coordinate[0];\n  const y0 = coordinate[1];\n  const start = segment[0];\n  const end = segment[1];\n  const x1 = start[0];\n  const y1 = start[1];\n  const x2 = end[0];\n  const y2 = end[1];\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  const along = (dx === 0 && dy === 0) ? 0 :\n    ((dx * (x0 - x1)) + (dy * (y0 - y1))) / ((dx * dx + dy * dy) || 0);\n  let x, y;\n  if (along <= 0) {\n    x = x1;\n    y = y1;\n  } else if (along >= 1) {\n    x = x2;\n    y = y2;\n  } else {\n    x = x1 + along * dx;\n    y = y1 + along * dy;\n  }\n  return [x, y];\n}\n\n\n/**\n * Returns a {@link module:ol/coordinate~CoordinateFormat} function that can be\n * used to format\n * a {module:ol/coordinate~Coordinate} to a string.\n *\n * Example without specifying the fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY();\n *     var out = stringifyFunc(coord);\n *     // out is now '8, 48'\n *\n * Example with explicitly specifying 2 fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY(2);\n *     var out = stringifyFunc(coord);\n *     // out is now '7.85, 47.98'\n *\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {module:ol/coordinate~CoordinateFormat} Coordinate format.\n * @api\n */\nexport function createStringXY(opt_fractionDigits) {\n  return (\n    /**\n     * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n     * @return {string} String XY.\n     */\n    function(coordinate) {\n      return toStringXY(coordinate, opt_fractionDigits);\n    }\n  );\n}\n\n\n/**\n * @param {string} hemispheres Hemispheres.\n * @param {number} degrees Degrees.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} String.\n */\nexport function degreesToStringHDMS(hemispheres, degrees, opt_fractionDigits) {\n  const normalizedDegrees = modulo(degrees + 180, 360) - 180;\n  const x = Math.abs(3600 * normalizedDegrees);\n  const dflPrecision = opt_fractionDigits || 0;\n  const precision = Math.pow(10, dflPrecision);\n\n  let deg = Math.floor(x / 3600);\n  let min = Math.floor((x - deg * 3600) / 60);\n  let sec = x - (deg * 3600) - (min * 60);\n  sec = Math.ceil(sec * precision) / precision;\n\n  if (sec >= 60) {\n    sec = 0;\n    min += 1;\n  }\n\n  if (min >= 60) {\n    min = 0;\n    deg += 1;\n  }\n\n  return deg + '\\u00b0 ' + padNumber(min, 2) + '\\u2032 ' +\n    padNumber(sec, 2, dflPrecision) + '\\u2033' +\n    (normalizedDegrees == 0 ? '' : ' ' + hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0));\n}\n\n\n/**\n * Transforms the given {@link module:ol/coordinate~Coordinate} to a string\n * using the given string template. The strings `{x}` and `{y}` in the template\n * will be replaced with the first and second coordinate values respectively.\n *\n * Example without specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template);\n *     // out is now 'Coordinate is (8|48).'\n *\n * Example explicitly specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template, 2);\n *     // out is now 'Coordinate is (7.85|47.98).'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {string} template A template string with `{x}` and `{y}` placeholders\n *     that will be replaced by first and second coordinate values.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Formatted coordinate.\n * @api\n */\nexport function format(coordinate, template, opt_fractionDigits) {\n  if (coordinate) {\n    return template\n      .replace('{x}', coordinate[0].toFixed(opt_fractionDigits))\n      .replace('{y}', coordinate[1].toFixed(opt_fractionDigits));\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coordinate2 Second coordinate.\n * @return {boolean} The two coordinates are equal.\n */\nexport function equals(coordinate1, coordinate2) {\n  let equals = true;\n  for (let i = coordinate1.length - 1; i >= 0; --i) {\n    if (coordinate1[i] != coordinate2[i]) {\n      equals = false;\n      break;\n    }\n  }\n  return equals;\n}\n\n\n/**\n * Rotate `coordinate` by `angle`. `coordinate` is modified in place and\n * returned by the function.\n *\n * Example:\n *\n *     import {rotate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var rotateRadians = Math.PI / 2; // 90 degrees\n *     rotate(coord, rotateRadians);\n *     // coord is now [-47.983333, 7.85]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} angle Angle in radian.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nexport function rotate(coordinate, angle) {\n  const cosAngle = Math.cos(angle);\n  const sinAngle = Math.sin(angle);\n  const x = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  const y = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  coordinate[0] = x;\n  coordinate[1] = y;\n  return coordinate;\n}\n\n\n/**\n * Scale `coordinate` by `scale`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {scale as scaleCoordinate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var scale = 1.2;\n *     scaleCoordinate(coord, scale);\n *     // coord is now [9.42, 57.5799996]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} scale Scale factor.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function scale(coordinate, scale) {\n  coordinate[0] *= scale;\n  coordinate[1] *= scale;\n  return coordinate;\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coord1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coord2 Second coordinate.\n * @return {number} Squared distance between coord1 and coord2.\n */\nexport function squaredDistance(coord1, coord2) {\n  const dx = coord1[0] - coord2[0];\n  const dy = coord1[1] - coord2[1];\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coord1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coord2 Second coordinate.\n * @return {number} Distance between coord1 and coord2.\n */\nexport function distance(coord1, coord2) {\n  return Math.sqrt(squaredDistance(coord1, coord2));\n}\n\n\n/**\n * Calculate the squared distance from a coordinate to a line segment.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate of the point.\n * @param {Array.<module:ol/coordinate~Coordinate>} segment Line segment (2\n * coordinates).\n * @return {number} Squared distance from the point to the line segment.\n */\nexport function squaredDistanceToSegment(coordinate, segment) {\n  return squaredDistance(coordinate,\n    closestOnSegment(coordinate, segment));\n}\n\n\n/**\n * Format a geographic coordinate with the hemisphere, degrees, minutes, and\n * seconds.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord);\n *     // out is now '47° 58′ 60″ N 7° 50′ 60″ E'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord, 1);\n *     // out is now '47° 58′ 60.0″ N 7° 50′ 60.0″ E'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Hemisphere, degrees, minutes and seconds.\n * @api\n */\nexport function toStringHDMS(coordinate, opt_fractionDigits) {\n  if (coordinate) {\n    return degreesToStringHDMS('NS', coordinate[1], opt_fractionDigits) + ' ' +\n        degreesToStringHDMS('EW', coordinate[0], opt_fractionDigits);\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * Format a coordinate as a comma delimited string.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord);\n *     // out is now '8, 48'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord, 1);\n *     // out is now '7.8, 48.0'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} XY.\n * @api\n */\nexport function toStringXY(coordinate, opt_fractionDigits) {\n  return format(coordinate, '{x}, {y}', opt_fractionDigits);\n}\n","/**\n * @module ol/geom/flat/interpolate\n */\nimport {binarySearch} from '../../array.js';\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} fraction Fraction.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Destination.\n */\nexport function interpolatePoint(flatCoordinates, offset, end, stride, fraction, opt_dest) {\n  let pointX = NaN;\n  let pointY = NaN;\n  const n = (end - offset) / stride;\n  if (n === 1) {\n    pointX = flatCoordinates[offset];\n    pointY = flatCoordinates[offset + 1];\n  } else if (n == 2) {\n    pointX = (1 - fraction) * flatCoordinates[offset] +\n        fraction * flatCoordinates[offset + stride];\n    pointY = (1 - fraction) * flatCoordinates[offset + 1] +\n        fraction * flatCoordinates[offset + stride + 1];\n  } else if (n !== 0) {\n    let x1 = flatCoordinates[offset];\n    let y1 = flatCoordinates[offset + 1];\n    let length = 0;\n    const cumulativeLengths = [0];\n    for (let i = offset + stride; i < end; i += stride) {\n      const x2 = flatCoordinates[i];\n      const y2 = flatCoordinates[i + 1];\n      length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      cumulativeLengths.push(length);\n      x1 = x2;\n      y1 = y2;\n    }\n    const target = fraction * length;\n    const index = binarySearch(cumulativeLengths, target);\n    if (index < 0) {\n      const t = (target - cumulativeLengths[-index - 2]) /\n          (cumulativeLengths[-index - 1] - cumulativeLengths[-index - 2]);\n      const o = offset + (-index - 2) * stride;\n      pointX = lerp(\n        flatCoordinates[o], flatCoordinates[o + stride], t);\n      pointY = lerp(\n        flatCoordinates[o + 1], flatCoordinates[o + stride + 1], t);\n    } else {\n      pointX = flatCoordinates[offset + index * stride];\n      pointY = flatCoordinates[offset + index * stride + 1];\n    }\n  }\n  if (opt_dest) {\n    opt_dest[0] = pointX;\n    opt_dest[1] = pointY;\n    return opt_dest;\n  } else {\n    return [pointX, pointY];\n  }\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function lineStringCoordinateAtM(flatCoordinates, offset, end, stride, m, extrapolate) {\n  if (end == offset) {\n    return null;\n  }\n  let coordinate;\n  if (m < flatCoordinates[offset + stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(offset, offset + stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  } else if (flatCoordinates[end - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(end - stride, end);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  // FIXME use O(1) search\n  if (m == flatCoordinates[offset + stride - 1]) {\n    return flatCoordinates.slice(offset, offset + stride);\n  }\n  let lo = offset / stride;\n  let hi = end / stride;\n  while (lo < hi) {\n    const mid = (lo + hi) >> 1;\n    if (m < flatCoordinates[(mid + 1) * stride - 1]) {\n      hi = mid;\n    } else {\n      lo = mid + 1;\n    }\n  }\n  const m0 = flatCoordinates[lo * stride - 1];\n  if (m == m0) {\n    return flatCoordinates.slice((lo - 1) * stride, (lo - 1) * stride + stride);\n  }\n  const m1 = flatCoordinates[(lo + 1) * stride - 1];\n  const t = (m - m0) / (m1 - m0);\n  coordinate = [];\n  for (let i = 0; i < stride - 1; ++i) {\n    coordinate.push(lerp(flatCoordinates[(lo - 1) * stride + i],\n      flatCoordinates[lo * stride + i], t));\n  }\n  coordinate.push(m);\n  return coordinate;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @param {boolean} interpolate Interpolate.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function lineStringsCoordinateAtM(\n  flatCoordinates, offset, ends, stride, m, extrapolate, interpolate) {\n  if (interpolate) {\n    return lineStringCoordinateAtM(\n      flatCoordinates, offset, ends[ends.length - 1], stride, m, extrapolate);\n  }\n  let coordinate;\n  if (m < flatCoordinates[stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(0, stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  if (flatCoordinates[flatCoordinates.length - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(flatCoordinates.length - stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    if (offset == end) {\n      continue;\n    }\n    if (m < flatCoordinates[offset + stride - 1]) {\n      return null;\n    } else if (m <= flatCoordinates[end - 1]) {\n      return lineStringCoordinateAtM(\n        flatCoordinates, offset, end, stride, m, false);\n    }\n    offset = end;\n  }\n  return null;\n}\n","/**\n * @module ol/geom/flat/length\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Length.\n */\nexport function lineStringLength(flatCoordinates, offset, end, stride) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  let length = 0;\n  for (let i = offset + stride; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    x1 = x2;\n    y1 = y2;\n  }\n  return length;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Perimeter.\n */\nexport function linearRingLength(flatCoordinates, offset, end, stride) {\n  let perimeter = lineStringLength(flatCoordinates, offset, end, stride);\n  const dx = flatCoordinates[end - stride] - flatCoordinates[offset];\n  const dy = flatCoordinates[end - stride + 1] - flatCoordinates[offset + 1];\n  perimeter += Math.sqrt(dx * dx + dy * dy);\n  return perimeter;\n}\n","/**\n * @module ol/geom/LineString\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {assignClosestPoint, maxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {interpolatePoint, lineStringCoordinateAtM} from '../geom/flat/interpolate.js';\nimport {intersectsLineString} from '../geom/flat/intersectsextent.js';\nimport {lineStringLength} from '../geom/flat/length.js';\nimport {forEach as forEachSegment} from '../geom/flat/segments.js';\nimport {douglasPeucker} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Linestring geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst LineString = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.flatMidpoint_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatMidpointRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(LineString, SimpleGeometry);\n\n\n/**\n * Append the passed coordinate to the coordinates of the linestring.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @api\n */\nLineString.prototype.appendCoordinate = function(coordinate) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = coordinate.slice();\n  } else {\n    extend(this.flatCoordinates, coordinate);\n  }\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/LineString} Clone.\n * @override\n * @api\n */\nLineString.prototype.clone = function() {\n  const lineString = new LineString(null);\n  lineString.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return lineString;\n};\n\n\n/**\n * @inheritDoc\n */\nLineString.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestPoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Iterate over each segment, calling the provided callback.\n * If the callback returns a truthy value the function returns that\n * value immediately. Otherwise the function returns `false`.\n *\n * @param {function(this: S, module:ol/coordinate~Coordinate, module:ol/coordinate~Coordinate): T} callback Function\n *     called for each segment.\n * @return {T|boolean} Value.\n * @template T,S\n * @api\n */\nLineString.prototype.forEachSegment = function(callback) {\n  return forEachSegment(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, callback);\n};\n\n\n/**\n * Returns the coordinate at `m` using linear interpolation, or `null` if no\n * such coordinate exists.\n *\n * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n * M will return the first coordinate and Ms greater than the last M will\n * return the last coordinate.\n *\n * @param {number} m M.\n * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nLineString.prototype.getCoordinateAtM = function(m, opt_extrapolate) {\n  if (this.layout != GeometryLayout.XYM &&\n      this.layout != GeometryLayout.XYZM) {\n    return null;\n  }\n  const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n  return lineStringCoordinateAtM(this.flatCoordinates, 0,\n    this.flatCoordinates.length, this.stride, m, extrapolate);\n};\n\n\n/**\n * Return the coordinates of the linestring.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nLineString.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the coordinate at the provided fraction along the linestring.\n * The `fraction` is a number between 0 and 1, where 0 is the start of the\n * linestring and 1 is the end.\n * @param {number} fraction Fraction.\n * @param {module:ol/coordinate~Coordinate=} opt_dest Optional coordinate whose values will\n *     be modified. If not provided, a new coordinate will be returned.\n * @return {module:ol/coordinate~Coordinate} Coordinate of the interpolated point.\n * @api\n */\nLineString.prototype.getCoordinateAt = function(fraction, opt_dest) {\n  return interpolatePoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    fraction, opt_dest);\n};\n\n\n/**\n * Return the length of the linestring on projected plane.\n * @return {number} Length (on projected plane).\n * @api\n */\nLineString.prototype.getLength = function() {\n  return lineStringLength(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoint.\n */\nLineString.prototype.getFlatMidpoint = function() {\n  if (this.flatMidpointRevision_ != this.getRevision()) {\n    this.flatMidpoint_ = this.getCoordinateAt(0.5, this.flatMidpoint_);\n    this.flatMidpointRevision_ = this.getRevision();\n  }\n  return this.flatMidpoint_;\n};\n\n\n/**\n * @inheritDoc\n */\nLineString.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    squaredTolerance, simplifiedFlatCoordinates, 0);\n  const simplifiedLineString = new LineString(null);\n  simplifiedLineString.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates);\n  return simplifiedLineString;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLineString.prototype.getType = function() {\n  return GeometryType.LINE_STRING;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLineString.prototype.intersectsExtent = function(extent) {\n  return intersectsLineString(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    extent);\n};\n\n\n/**\n * Set the coordinates of the linestring.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nLineString.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nLineString.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default LineString;\n","/**\n * @module ol/geom/flat/geodesic\n */\nimport {squaredSegmentDistance, toRadians, toDegrees} from '../../math.js';\nimport {get as getProjection, getTransform} from '../../proj.js';\n\n\n/**\n * @param {function(number): module:ol/coordinate~Coordinate} interpolate Interpolate function.\n * @param {module:ol/proj~TransformFunction} transform Transform from longitude/latitude to\n *     projected coordinates.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nfunction line(interpolate, transform, squaredTolerance) {\n  // FIXME reduce garbage generation\n  // FIXME optimize stack operations\n\n  /** @type {Array.<number>} */\n  const flatCoordinates = [];\n\n  let geoA = interpolate(0);\n  let geoB = interpolate(1);\n\n  let a = transform(geoA);\n  let b = transform(geoB);\n\n  /** @type {Array.<module:ol/coordinate~Coordinate>} */\n  const geoStack = [geoB, geoA];\n  /** @type {Array.<module:ol/coordinate~Coordinate>} */\n  const stack = [b, a];\n  /** @type {Array.<number>} */\n  const fractionStack = [1, 0];\n\n  /** @type {!Object.<string, boolean>} */\n  const fractions = {};\n\n  let maxIterations = 1e5;\n  let geoM, m, fracA, fracB, fracM, key;\n\n  while (--maxIterations > 0 && fractionStack.length > 0) {\n    // Pop the a coordinate off the stack\n    fracA = fractionStack.pop();\n    geoA = geoStack.pop();\n    a = stack.pop();\n    // Add the a coordinate if it has not been added yet\n    key = fracA.toString();\n    if (!(key in fractions)) {\n      flatCoordinates.push(a[0], a[1]);\n      fractions[key] = true;\n    }\n    // Pop the b coordinate off the stack\n    fracB = fractionStack.pop();\n    geoB = geoStack.pop();\n    b = stack.pop();\n    // Find the m point between the a and b coordinates\n    fracM = (fracA + fracB) / 2;\n    geoM = interpolate(fracM);\n    m = transform(geoM);\n    if (squaredSegmentDistance(m[0], m[1], a[0], a[1],\n      b[0], b[1]) < squaredTolerance) {\n      // If the m point is sufficiently close to the straight line, then we\n      // discard it.  Just use the b coordinate and move on to the next line\n      // segment.\n      flatCoordinates.push(b[0], b[1]);\n      key = fracB.toString();\n      fractions[key] = true;\n    } else {\n      // Otherwise, we need to subdivide the current line segment.  Split it\n      // into two and push the two line segments onto the stack.\n      fractionStack.push(fracB, fracM, fracM, fracA);\n      stack.push(b, m, m, a);\n      geoStack.push(geoB, geoM, geoM, geoA);\n    }\n  }\n\n  return flatCoordinates;\n}\n\n\n/**\n * Generate a great-circle arcs between two lat/lon points.\n * @param {number} lon1 Longitude 1 in degrees.\n * @param {number} lat1 Latitude 1 in degrees.\n * @param {number} lon2 Longitude 2 in degrees.\n * @param {number} lat2 Latitude 2 in degrees.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nexport function greatCircleArc(lon1, lat1, lon2, lat2, projection, squaredTolerance) {\n  const geoProjection = getProjection('EPSG:4326');\n\n  const cosLat1 = Math.cos(toRadians(lat1));\n  const sinLat1 = Math.sin(toRadians(lat1));\n  const cosLat2 = Math.cos(toRadians(lat2));\n  const sinLat2 = Math.sin(toRadians(lat2));\n  const cosDeltaLon = Math.cos(toRadians(lon2 - lon1));\n  const sinDeltaLon = Math.sin(toRadians(lon2 - lon1));\n  const d = sinLat1 * sinLat2 + cosLat1 * cosLat2 * cosDeltaLon;\n\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {module:ol/coordinate~Coordinate} Coordinate.\n     */\n    function(frac) {\n      if (1 <= d) {\n        return [lon2, lat2];\n      }\n      const D = frac * Math.acos(d);\n      const cosD = Math.cos(D);\n      const sinD = Math.sin(D);\n      const y = sinDeltaLon * cosLat2;\n      const x = cosLat1 * sinLat2 - sinLat1 * cosLat2 * cosDeltaLon;\n      const theta = Math.atan2(y, x);\n      const lat = Math.asin(sinLat1 * cosD + cosLat1 * sinD * Math.cos(theta));\n      const lon = toRadians(lon1) +\n            Math.atan2(Math.sin(theta) * sinD * cosLat1,\n              cosD - sinLat1 * Math.sin(lat));\n      return [toDegrees(lon), toDegrees(lat)];\n    }, getTransform(geoProjection, projection), squaredTolerance);\n}\n\n\n/**\n * Generate a meridian (line at constant longitude).\n * @param {number} lon Longitude.\n * @param {number} lat1 Latitude 1.\n * @param {number} lat2 Latitude 2.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nexport function meridian(lon, lat1, lat2, projection, squaredTolerance) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {module:ol/coordinate~Coordinate} Coordinate.\n     */\n    function(frac) {\n      return [lon, lat1 + ((lat2 - lat1) * frac)];\n    },\n    getTransform(epsg4326Projection, projection), squaredTolerance);\n}\n\n\n/**\n * Generate a parallel (line at constant latitude).\n * @param {number} lat Latitude.\n * @param {number} lon1 Longitude 1.\n * @param {number} lon2 Longitude 2.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nexport function parallel(lat, lon1, lon2, projection, squaredTolerance) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {module:ol/coordinate~Coordinate} Coordinate.\n     */\n    function(frac) {\n      return [lon1 + ((lon2 - lon1) * frac), lat];\n    },\n    getTransform(epsg4326Projection, projection), squaredTolerance);\n}\n","/**\n * @module ol/render/EventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * @event module:ol/render/Event~RenderEvent#postcompose\n   * @api\n   */\n  POSTCOMPOSE: 'postcompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#precompose\n   * @api\n   */\n  PRECOMPOSE: 'precompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#render\n   * @api\n   */\n  RENDER: 'render'\n};\n","/**\n * @module ol/style/TextPlacement\n */\n\n/**\n * Text placement. One of `'point'`, `'line'`. Default is `'point'`. Note that\n * `'line'` requires the underlying geometry to be a {@link module:ol/geom/LineString~LineString},\n * {@link module:ol/geom/Polygon~Polygon}, {@link module:ol/geom/MultiLineString~MultiLineString} or\n * {@link module:ol/geom/MultiPolygon~MultiPolygon}.\n * @enum {string}\n */\nexport default {\n  POINT: 'point',\n  LINE: 'line'\n};\n","/**\n * @module ol/style/Text\n */\nimport Fill from '../style/Fill.js';\nimport TextPlacement from '../style/TextPlacement.js';\n\n\n/**\n * The default fill color to use if no fill was set at construction time; a\n * blackish `#333`.\n *\n * @const {string}\n */\nconst DEFAULT_FILL_COLOR = '#333';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [font] Font style as CSS 'font' value, see:\n * {@link https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font}. Default is '10px sans-serif'\n * @property {number} [maxAngle] When `placement` is set to `'line'`, allow a maximum angle between adjacent characters.\n * The expected value is in radians, and the default is 45° (`Math.PI / 4`).\n * @property {number} [offsetX=0] Horizontal text offset in pixels. A positive will shift the text right.\n * @property {number} [offsetY=0] Vertical text offset in pixels. A positive will shift the text down.\n * @property {boolean} [overflow=false] For polygon labels or when `placement` is set to `'line'`, allow text to exceed\n * the width of the polygon at the label position or the length of the path that it follows.\n * @property {module:ol/style/TextPlacement|string} [placement] Text placement.\n * @property {number} [scale] Scale.\n * @property {boolean} [rotateWithView=false] Whether to rotate the text with the view.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {string} [text] Text content.\n * @property {string} [textAlign] Text alignment. Possible values: 'left', 'right', 'center', 'end' or 'start'.\n * Default is 'center' for `placement: 'point'`. For `placement: 'line'`, the default is to let the renderer choose a\n * placement where `maxAngle` is not exceeded.\n * @property {string} [textBaseline='middle'] Text base line. Possible values: 'bottom', 'top', 'middle', 'alphabetic',\n * 'hanging', 'ideographic'.\n * @property {module:ol/style/Fill} [fill] Fill style. If none is provided, we'll use a dark fill-style (#333).\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/Fill} [backgroundFill] Fill style for the text background when `placement` is\n * `'point'`. Default is no fill.\n * @property {module:ol/style/Stroke} [backgroundStroke] Stroke style for the text background  when `placement`\n * is `'point'`. Default is no stroke.\n * @property {Array.<number>} [padding=[0, 0, 0, 0]] Padding in pixels around the text for decluttering and background. The order of\n * values in the array is `[top, right, bottom, left]`.\n */\n\n\n/**\n * @classdesc\n * Set text style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Text~Options=} opt_options Options.\n * @api\n */\nconst Text = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.font_ = options.font;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = options.rotation;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView_ = options.rotateWithView;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.scale_ = options.scale;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.text_ = options.text;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textAlign_ = options.textAlign;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textBaseline_ = options.textBaseline;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill :\n    new Fill({color: DEFAULT_FILL_COLOR});\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxAngle_ = options.maxAngle !== undefined ? options.maxAngle : Math.PI / 4;\n\n  /**\n   * @private\n   * @type {module:ol/style/TextPlacement|string}\n   */\n  this.placement_ = options.placement !== undefined ? options.placement : TextPlacement.POINT;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overflow_ = !!options.overflow;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetX_ = options.offsetX !== undefined ? options.offsetX : 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetY_ = options.offsetY !== undefined ? options.offsetY : 0;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.backgroundFill_ = options.backgroundFill ? options.backgroundFill : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.backgroundStroke_ = options.backgroundStroke ? options.backgroundStroke : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.padding_ = options.padding === undefined ? null : options.padding;\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Text} The cloned style.\n * @api\n */\nText.prototype.clone = function() {\n  return new Text({\n    font: this.getFont(),\n    placement: this.getPlacement(),\n    maxAngle: this.getMaxAngle(),\n    overflow: this.getOverflow(),\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView(),\n    scale: this.getScale(),\n    text: this.getText(),\n    textAlign: this.getTextAlign(),\n    textBaseline: this.getTextBaseline(),\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    offsetX: this.getOffsetX(),\n    offsetY: this.getOffsetY(),\n    backgroundFill: this.getBackgroundFill() ? this.getBackgroundFill().clone() : undefined,\n    backgroundStroke: this.getBackgroundStroke() ? this.getBackgroundStroke().clone() : undefined\n  });\n};\n\n\n/**\n * Get the `overflow` configuration.\n * @return {boolean} Let text overflow the length of the path they follow.\n * @api\n */\nText.prototype.getOverflow = function() {\n  return this.overflow_;\n};\n\n\n/**\n * Get the font name.\n * @return {string|undefined} Font.\n * @api\n */\nText.prototype.getFont = function() {\n  return this.font_;\n};\n\n\n/**\n * Get the maximum angle between adjacent characters.\n * @return {number} Angle in radians.\n * @api\n */\nText.prototype.getMaxAngle = function() {\n  return this.maxAngle_;\n};\n\n\n/**\n * Get the label placement.\n * @return {module:ol/style/TextPlacement|string} Text placement.\n * @api\n */\nText.prototype.getPlacement = function() {\n  return this.placement_;\n};\n\n\n/**\n * Get the x-offset for the text.\n * @return {number} Horizontal text offset.\n * @api\n */\nText.prototype.getOffsetX = function() {\n  return this.offsetX_;\n};\n\n\n/**\n * Get the y-offset for the text.\n * @return {number} Vertical text offset.\n * @api\n */\nText.prototype.getOffsetY = function() {\n  return this.offsetY_;\n};\n\n\n/**\n * Get the fill style for the text.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nText.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * Determine whether the text rotates with the map.\n * @return {boolean|undefined} Rotate with map.\n * @api\n */\nText.prototype.getRotateWithView = function() {\n  return this.rotateWithView_;\n};\n\n\n/**\n * Get the text rotation.\n * @return {number|undefined} Rotation.\n * @api\n */\nText.prototype.getRotation = function() {\n  return this.rotation_;\n};\n\n\n/**\n * Get the text scale.\n * @return {number|undefined} Scale.\n * @api\n */\nText.prototype.getScale = function() {\n  return this.scale_;\n};\n\n\n/**\n * Get the stroke style for the text.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nText.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * Get the text to be rendered.\n * @return {string|undefined} Text.\n * @api\n */\nText.prototype.getText = function() {\n  return this.text_;\n};\n\n\n/**\n * Get the text alignment.\n * @return {string|undefined} Text align.\n * @api\n */\nText.prototype.getTextAlign = function() {\n  return this.textAlign_;\n};\n\n\n/**\n * Get the text baseline.\n * @return {string|undefined} Text baseline.\n * @api\n */\nText.prototype.getTextBaseline = function() {\n  return this.textBaseline_;\n};\n\n\n/**\n * Get the background fill style for the text.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nText.prototype.getBackgroundFill = function() {\n  return this.backgroundFill_;\n};\n\n\n/**\n * Get the background stroke style for the text.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nText.prototype.getBackgroundStroke = function() {\n  return this.backgroundStroke_;\n};\n\n\n/**\n * Get the padding for the text.\n * @return {Array.<number>} Padding.\n * @api\n */\nText.prototype.getPadding = function() {\n  return this.padding_;\n};\n\n\n/**\n * Set the `overflow` property.\n *\n * @param {boolean} overflow Let text overflow the path that it follows.\n * @api\n */\nText.prototype.setOverflow = function(overflow) {\n  this.overflow_ = overflow;\n};\n\n\n/**\n * Set the font.\n *\n * @param {string|undefined} font Font.\n * @api\n */\nText.prototype.setFont = function(font) {\n  this.font_ = font;\n};\n\n\n/**\n * Set the maximum angle between adjacent characters.\n *\n * @param {number} maxAngle Angle in radians.\n * @api\n */\nText.prototype.setMaxAngle = function(maxAngle) {\n  this.maxAngle_ = maxAngle;\n};\n\n\n/**\n * Set the x offset.\n *\n * @param {number} offsetX Horizontal text offset.\n * @api\n */\nText.prototype.setOffsetX = function(offsetX) {\n  this.offsetX_ = offsetX;\n};\n\n\n/**\n * Set the y offset.\n *\n * @param {number} offsetY Vertical text offset.\n * @api\n */\nText.prototype.setOffsetY = function(offsetY) {\n  this.offsetY_ = offsetY;\n};\n\n\n/**\n * Set the text placement.\n *\n * @param {module:ol/style/TextPlacement|string} placement Placement.\n * @api\n */\nText.prototype.setPlacement = function(placement) {\n  this.placement_ = placement;\n};\n\n\n/**\n * Set the fill.\n *\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nText.prototype.setFill = function(fill) {\n  this.fill_ = fill;\n};\n\n\n/**\n * Set the rotation.\n *\n * @param {number|undefined} rotation Rotation.\n * @api\n */\nText.prototype.setRotation = function(rotation) {\n  this.rotation_ = rotation;\n};\n\n\n/**\n * Set the scale.\n *\n * @param {number|undefined} scale Scale.\n * @api\n */\nText.prototype.setScale = function(scale) {\n  this.scale_ = scale;\n};\n\n\n/**\n * Set the stroke.\n *\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nText.prototype.setStroke = function(stroke) {\n  this.stroke_ = stroke;\n};\n\n\n/**\n * Set the text.\n *\n * @param {string|undefined} text Text.\n * @api\n */\nText.prototype.setText = function(text) {\n  this.text_ = text;\n};\n\n\n/**\n * Set the text alignment.\n *\n * @param {string|undefined} textAlign Text align.\n * @api\n */\nText.prototype.setTextAlign = function(textAlign) {\n  this.textAlign_ = textAlign;\n};\n\n\n/**\n * Set the text baseline.\n *\n * @param {string|undefined} textBaseline Text baseline.\n * @api\n */\nText.prototype.setTextBaseline = function(textBaseline) {\n  this.textBaseline_ = textBaseline;\n};\n\n\n/**\n * Set the background fill.\n *\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nText.prototype.setBackgroundFill = function(fill) {\n  this.backgroundFill_ = fill;\n};\n\n\n/**\n * Set the background stroke.\n *\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nText.prototype.setBackgroundStroke = function(stroke) {\n  this.backgroundStroke_ = stroke;\n};\n\n\n/**\n * Set the padding (`[top, right, bottom, left]`).\n *\n * @param {!Array.<number>} padding Padding.\n * @api\n */\nText.prototype.setPadding = function(padding) {\n  this.padding_ = padding;\n};\nexport default Text;\n","/**\n * @module ol/Graticule\n */\nimport {degreesToStringHDMS} from './coordinate.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {intersects, getCenter} from './extent.js';\nimport GeometryLayout from './geom/GeometryLayout.js';\nimport LineString from './geom/LineString.js';\nimport Point from './geom/Point.js';\nimport {meridian, parallel} from './geom/flat/geodesic.js';\nimport {clamp} from './math.js';\nimport {get as getProjection, equivalent as equivalentProjection, getTransform, transformExtent} from './proj.js';\nimport RenderEventType from './render/EventType.js';\nimport Fill from './style/Fill.js';\nimport Stroke from './style/Stroke.js';\nimport Text from './style/Text.js';\n\n\n/**\n * @type {module:ol/style/Stroke}\n * @private\n * @const\n */\nconst DEFAULT_STROKE_STYLE = new Stroke({\n  color: 'rgba(0,0,0,0.2)'\n});\n\n/**\n * TODO can be configurable\n * @type {Array.<number>}\n * @private\n */\nconst INTERVALS = [\n  90, 45, 30, 20, 10, 5, 2, 1, 0.5, 0.2, 0.1, 0.05, 0.01, 0.005, 0.002, 0.001\n];\n\n/**\n * @typedef {Object} GraticuleLabelDataType\n * @property {module:ol/geom/Point} geom\n * @property {string} text\n */\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/PluggableMap} [map] Reference to an\n * {@link module:ol/Map~Map} object.\n * @property {number} [maxLines=100] The maximum number of meridians and\n * parallels from the center of the map. The default value of 100 means that at\n * most 200 meridians and 200 parallels will be displayed. The default value is\n * appropriate for conformal projections like Spherical Mercator. If you\n * increase the value, more lines will be drawn and the drawing performance will\n * decrease.\n * @property {module:ol/style/Stroke} [strokeStyle='rgba(0,0,0,0.2)'] The\n * stroke style to use for drawing the graticule. If not provided, a not fully\n * opaque black will be used.\n * @property {number} [targetSize=100] The target size of the graticule cells,\n * in pixels.\n * @property {boolean} [showLabels=false] Render a label with the respective\n * latitude/longitude for each graticule line.\n * @property {function(number):string} [lonLabelFormatter] Label formatter for\n * longitudes. This function is called with the longitude as argument, and\n * should return a formatted string representing the longitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {function(number):string} [latLabelFormatter] Label formatter for\n * latitudes. This function is called with the latitude as argument, and\n * should return a formatted string representing the latitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {number} [lonLabelPosition=0] Longitude label position in fractions\n * (0..1) of view extent. 0 means at the bottom of the viewport, 1 means at the\n * top.\n * @property {number} [latLabelPosition=1] Latitude label position in fractions\n * (0..1) of view extent. 0 means at the left of the viewport, 1 means at the\n * right.\n * @property {module:ol/style/Text} [lonLabelStyle] Longitude label text\n * style. If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textBaseline: 'bottom',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: new Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textBaseline` configuration will not work well for\n * `lonLabelPosition` configurations that position labels close to the top of\n * the viewport.\n * @property {module:ol/style/Text} [latLabelStyle] Latitude label text style.\n * If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textAlign: 'end',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textAlign` configuration will not work well for\n * `latLabelPosition` configurations that position labels close to the left of\n * the viewport.\n */\n\n\n/**\n * Render a grid for a coordinate system on a map.\n * @constructor\n * @param {module:ol/Graticule~Options=} opt_options Options.\n * @api\n */\nconst Graticule = function(opt_options) {\n  const options = opt_options || {};\n\n  /**\n   * @type {module:ol/PluggableMap}\n   * @private\n   */\n  this.map_ = null;\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.postcomposeListenerKey_ = null;\n\n  /**\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = null;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLat_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLon_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLat_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLon_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLatP_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLonP_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLatP_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLonP_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.targetSize_ = options.targetSize !== undefined ? options.targetSize : 100;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLines_ = options.maxLines !== undefined ? options.maxLines : 100;\n\n  /**\n   * @type {Array.<module:ol/geom/LineString>}\n   * @private\n   */\n  this.meridians_ = [];\n\n  /**\n   * @type {Array.<module:ol/geom/LineString>}\n   * @private\n   */\n  this.parallels_ = [];\n\n  /**\n   * @type {module:ol/style/Stroke}\n   * @private\n   */\n  this.strokeStyle_ = options.strokeStyle !== undefined ? options.strokeStyle : DEFAULT_STROKE_STYLE;\n\n  /**\n   * @type {module:ol/proj~TransformFunction|undefined}\n   * @private\n   */\n  this.fromLonLatTransform_ = undefined;\n\n  /**\n   * @type {module:ol/proj~TransformFunction|undefined}\n   * @private\n   */\n  this.toLonLatTransform_ = undefined;\n\n  /**\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.projectionCenterLonLat_ = null;\n\n  /**\n   * @type {Array.<module:ol/Graticule~GraticuleLabelDataType>}\n   * @private\n   */\n  this.meridiansLabels_ = null;\n\n  /**\n   * @type {Array.<module:ol/Graticule~GraticuleLabelDataType>}\n   * @private\n   */\n  this.parallelsLabels_ = null;\n\n  if (options.showLabels == true) {\n\n    /**\n     * @type {null|function(number):string}\n     * @private\n     */\n    this.lonLabelFormatter_ = options.lonLabelFormatter == undefined ?\n      degreesToStringHDMS.bind(this, 'EW') : options.lonLabelFormatter;\n\n    /**\n     * @type {function(number):string}\n     * @private\n     */\n    this.latLabelFormatter_ = options.latLabelFormatter == undefined ?\n      degreesToStringHDMS.bind(this, 'NS') : options.latLabelFormatter;\n\n    /**\n     * Longitude label position in fractions (0..1) of view extent. 0 means\n     * bottom, 1 means top.\n     * @type {number}\n     * @private\n     */\n    this.lonLabelPosition_ = options.lonLabelPosition == undefined ? 0 :\n      options.lonLabelPosition;\n\n    /**\n     * Latitude Label position in fractions (0..1) of view extent. 0 means left, 1\n     * means right.\n     * @type {number}\n     * @private\n     */\n    this.latLabelPosition_ = options.latLabelPosition == undefined ? 1 :\n      options.latLabelPosition;\n\n    /**\n     * @type {module:ol/style/Text}\n     * @private\n     */\n    this.lonLabelStyle_ = options.lonLabelStyle !== undefined ? options.lonLabelStyle :\n      new Text({\n        font: '12px Calibri,sans-serif',\n        textBaseline: 'bottom',\n        fill: new Fill({\n          color: 'rgba(0,0,0,1)'\n        }),\n        stroke: new Stroke({\n          color: 'rgba(255,255,255,1)',\n          width: 3\n        })\n      });\n\n    /**\n     * @type {module:ol/style/Text}\n     * @private\n     */\n    this.latLabelStyle_ = options.latLabelStyle !== undefined ? options.latLabelStyle :\n      new Text({\n        font: '12px Calibri,sans-serif',\n        textAlign: 'end',\n        fill: new Fill({\n          color: 'rgba(0,0,0,1)'\n        }),\n        stroke: new Stroke({\n          color: 'rgba(255,255,255,1)',\n          width: 3\n        })\n      });\n\n    this.meridiansLabels_ = [];\n    this.parallelsLabels_ = [];\n  }\n\n  this.setMap(options.map !== undefined ? options.map : null);\n};\n\n\n/**\n * @param {number} lon Longitude.\n * @param {number} minLat Minimal latitude.\n * @param {number} maxLat Maximal latitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {number} Index.\n * @private\n */\nGraticule.prototype.addMeridian_ = function(lon, minLat, maxLat, squaredTolerance, extent, index) {\n  const lineString = this.getMeridian_(lon, minLat, maxLat, squaredTolerance, index);\n  if (intersects(lineString.getExtent(), extent)) {\n    if (this.meridiansLabels_) {\n      const textPoint = this.getMeridianPoint_(lineString, extent, index);\n      this.meridiansLabels_[index] = {\n        geom: textPoint,\n        text: this.lonLabelFormatter_(lon)\n      };\n    }\n    this.meridians_[index++] = lineString;\n  }\n  return index;\n};\n\n/**\n * @param {module:ol/geom/LineString} lineString Meridian\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {module:ol/geom/Point} Meridian point.\n * @private\n */\nGraticule.prototype.getMeridianPoint_ = function(lineString, extent, index) {\n  const flatCoordinates = lineString.getFlatCoordinates();\n  const clampedBottom = Math.max(extent[1], flatCoordinates[1]);\n  const clampedTop = Math.min(extent[3], flatCoordinates[flatCoordinates.length - 1]);\n  const lat = clamp(\n    extent[1] + Math.abs(extent[1] - extent[3]) * this.lonLabelPosition_,\n    clampedBottom, clampedTop);\n  const coordinate = [flatCoordinates[0], lat];\n  const point = this.meridiansLabels_[index] !== undefined ?\n    this.meridiansLabels_[index].geom : new Point(null);\n  point.setCoordinates(coordinate);\n  return point;\n};\n\n\n/**\n * @param {number} lat Latitude.\n * @param {number} minLon Minimal longitude.\n * @param {number} maxLon Maximal longitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {number} Index.\n * @private\n */\nGraticule.prototype.addParallel_ = function(lat, minLon, maxLon, squaredTolerance, extent, index) {\n  const lineString = this.getParallel_(lat, minLon, maxLon, squaredTolerance, index);\n  if (intersects(lineString.getExtent(), extent)) {\n    if (this.parallelsLabels_) {\n      const textPoint = this.getParallelPoint_(lineString, extent, index);\n      this.parallelsLabels_[index] = {\n        geom: textPoint,\n        text: this.latLabelFormatter_(lat)\n      };\n    }\n    this.parallels_[index++] = lineString;\n  }\n  return index;\n};\n\n\n/**\n * @param {module:ol/geom/LineString} lineString Parallels.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {module:ol/geom/Point} Parallel point.\n * @private\n */\nGraticule.prototype.getParallelPoint_ = function(lineString, extent, index) {\n  const flatCoordinates = lineString.getFlatCoordinates();\n  const clampedLeft = Math.max(extent[0], flatCoordinates[0]);\n  const clampedRight = Math.min(extent[2], flatCoordinates[flatCoordinates.length - 2]);\n  const lon = clamp(\n    extent[0] + Math.abs(extent[0] - extent[2]) * this.latLabelPosition_,\n    clampedLeft, clampedRight);\n  const coordinate = [lon, flatCoordinates[1]];\n  const point = this.parallelsLabels_[index] !== undefined ?\n    this.parallelsLabels_[index].geom : new Point(null);\n  point.setCoordinates(coordinate);\n  return point;\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} squaredTolerance Squared tolerance.\n * @private\n */\nGraticule.prototype.createGraticule_ = function(extent, center, resolution, squaredTolerance) {\n\n  const interval = this.getInterval_(resolution);\n  if (interval == -1) {\n    this.meridians_.length = this.parallels_.length = 0;\n    if (this.meridiansLabels_) {\n      this.meridiansLabels_.length = 0;\n    }\n    if (this.parallelsLabels_) {\n      this.parallelsLabels_.length = 0;\n    }\n    return;\n  }\n\n  const centerLonLat = this.toLonLatTransform_(center);\n  let centerLon = centerLonLat[0];\n  let centerLat = centerLonLat[1];\n  const maxLines = this.maxLines_;\n  let cnt, idx, lat, lon;\n\n  let validExtent = [\n    Math.max(extent[0], this.minLonP_),\n    Math.max(extent[1], this.minLatP_),\n    Math.min(extent[2], this.maxLonP_),\n    Math.min(extent[3], this.maxLatP_)\n  ];\n\n  validExtent = transformExtent(validExtent, this.projection_, 'EPSG:4326');\n  const maxLat = validExtent[3];\n  const maxLon = validExtent[2];\n  const minLat = validExtent[1];\n  const minLon = validExtent[0];\n\n  // Create meridians\n\n  centerLon = Math.floor(centerLon / interval) * interval;\n  lon = clamp(centerLon, this.minLon_, this.maxLon_);\n\n  idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, 0);\n\n  cnt = 0;\n  while (lon != this.minLon_ && cnt++ < maxLines) {\n    lon = Math.max(lon - interval, this.minLon_);\n    idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n  }\n\n  lon = clamp(centerLon, this.minLon_, this.maxLon_);\n\n  cnt = 0;\n  while (lon != this.maxLon_ && cnt++ < maxLines) {\n    lon = Math.min(lon + interval, this.maxLon_);\n    idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n  }\n\n  this.meridians_.length = idx;\n  if (this.meridiansLabels_) {\n    this.meridiansLabels_.length = idx;\n  }\n\n  // Create parallels\n\n  centerLat = Math.floor(centerLat / interval) * interval;\n  lat = clamp(centerLat, this.minLat_, this.maxLat_);\n\n  idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, 0);\n\n  cnt = 0;\n  while (lat != this.minLat_ && cnt++ < maxLines) {\n    lat = Math.max(lat - interval, this.minLat_);\n    idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n  }\n\n  lat = clamp(centerLat, this.minLat_, this.maxLat_);\n\n  cnt = 0;\n  while (lat != this.maxLat_ && cnt++ < maxLines) {\n    lat = Math.min(lat + interval, this.maxLat_);\n    idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n  }\n\n  this.parallels_.length = idx;\n  if (this.parallelsLabels_) {\n    this.parallelsLabels_.length = idx;\n  }\n\n};\n\n\n/**\n * @param {number} resolution Resolution.\n * @return {number} The interval in degrees.\n * @private\n */\nGraticule.prototype.getInterval_ = function(resolution) {\n  const centerLon = this.projectionCenterLonLat_[0];\n  const centerLat = this.projectionCenterLonLat_[1];\n  let interval = -1;\n  const target = Math.pow(this.targetSize_ * resolution, 2);\n  /** @type {Array.<number>} **/\n  const p1 = [];\n  /** @type {Array.<number>} **/\n  const p2 = [];\n  for (let i = 0, ii = INTERVALS.length; i < ii; ++i) {\n    const delta = INTERVALS[i] / 2;\n    p1[0] = centerLon - delta;\n    p1[1] = centerLat - delta;\n    p2[0] = centerLon + delta;\n    p2[1] = centerLat + delta;\n    this.fromLonLatTransform_(p1, p1);\n    this.fromLonLatTransform_(p2, p2);\n    const dist = Math.pow(p2[0] - p1[0], 2) + Math.pow(p2[1] - p1[1], 2);\n    if (dist <= target) {\n      break;\n    }\n    interval = INTERVALS[i];\n  }\n  return interval;\n};\n\n\n/**\n * Get the map associated with this graticule.\n * @return {module:ol/PluggableMap} The map.\n * @api\n */\nGraticule.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * @param {number} lon Longitude.\n * @param {number} minLat Minimal latitude.\n * @param {number} maxLat Maximal latitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/LineString} The meridian line string.\n * @param {number} index Index.\n * @private\n */\nGraticule.prototype.getMeridian_ = function(lon, minLat, maxLat, squaredTolerance, index) {\n  const flatCoordinates = meridian(lon, minLat, maxLat, this.projection_, squaredTolerance);\n  const lineString = this.meridians_[index] !== undefined ? this.meridians_[index] : new LineString(null);\n  lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n  return lineString;\n};\n\n\n/**\n * Get the list of meridians.  Meridians are lines of equal longitude.\n * @return {Array.<module:ol/geom/LineString>} The meridians.\n * @api\n */\nGraticule.prototype.getMeridians = function() {\n  return this.meridians_;\n};\n\n\n/**\n * @param {number} lat Latitude.\n * @param {number} minLon Minimal longitude.\n * @param {number} maxLon Maximal longitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/LineString} The parallel line string.\n * @param {number} index Index.\n * @private\n */\nGraticule.prototype.getParallel_ = function(lat, minLon, maxLon, squaredTolerance, index) {\n  const flatCoordinates = parallel(lat, minLon, maxLon, this.projection_, squaredTolerance);\n  const lineString = this.parallels_[index] !== undefined ? this.parallels_[index] : new LineString(null);\n  lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n  return lineString;\n};\n\n\n/**\n * Get the list of parallels.  Parallels are lines of equal latitude.\n * @return {Array.<module:ol/geom/LineString>} The parallels.\n * @api\n */\nGraticule.prototype.getParallels = function() {\n  return this.parallels_;\n};\n\n\n/**\n * @param {module:ol/render/Event} e Event.\n * @private\n */\nGraticule.prototype.handlePostCompose_ = function(e) {\n  const vectorContext = e.vectorContext;\n  const frameState = e.frameState;\n  const extent = frameState.extent;\n  const viewState = frameState.viewState;\n  const center = viewState.center;\n  const projection = viewState.projection;\n  const resolution = viewState.resolution;\n  const pixelRatio = frameState.pixelRatio;\n  const squaredTolerance =\n      resolution * resolution / (4 * pixelRatio * pixelRatio);\n\n  const updateProjectionInfo = !this.projection_ ||\n      !equivalentProjection(this.projection_, projection);\n\n  if (updateProjectionInfo) {\n    this.updateProjectionInfo_(projection);\n  }\n\n  this.createGraticule_(extent, center, resolution, squaredTolerance);\n\n  // Draw the lines\n  vectorContext.setFillStrokeStyle(null, this.strokeStyle_);\n  let i, l, line;\n  for (i = 0, l = this.meridians_.length; i < l; ++i) {\n    line = this.meridians_[i];\n    vectorContext.drawGeometry(line);\n  }\n  for (i = 0, l = this.parallels_.length; i < l; ++i) {\n    line = this.parallels_[i];\n    vectorContext.drawGeometry(line);\n  }\n  let labelData;\n  if (this.meridiansLabels_) {\n    for (i = 0, l = this.meridiansLabels_.length; i < l; ++i) {\n      labelData = this.meridiansLabels_[i];\n      this.lonLabelStyle_.setText(labelData.text);\n      vectorContext.setTextStyle(this.lonLabelStyle_);\n      vectorContext.drawGeometry(labelData.geom);\n    }\n  }\n  if (this.parallelsLabels_) {\n    for (i = 0, l = this.parallelsLabels_.length; i < l; ++i) {\n      labelData = this.parallelsLabels_[i];\n      this.latLabelStyle_.setText(labelData.text);\n      vectorContext.setTextStyle(this.latLabelStyle_);\n      vectorContext.drawGeometry(labelData.geom);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nGraticule.prototype.updateProjectionInfo_ = function(projection) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n\n  const worldExtent = projection.getWorldExtent();\n  const worldExtentP = transformExtent(worldExtent, epsg4326Projection, projection);\n\n  this.maxLat_ = worldExtent[3];\n  this.maxLon_ = worldExtent[2];\n  this.minLat_ = worldExtent[1];\n  this.minLon_ = worldExtent[0];\n\n  this.maxLatP_ = worldExtentP[3];\n  this.maxLonP_ = worldExtentP[2];\n  this.minLatP_ = worldExtentP[1];\n  this.minLonP_ = worldExtentP[0];\n\n  this.fromLonLatTransform_ = getTransform(epsg4326Projection, projection);\n\n  this.toLonLatTransform_ = getTransform(projection, epsg4326Projection);\n\n  this.projectionCenterLonLat_ = this.toLonLatTransform_(getCenter(projection.getExtent()));\n\n  this.projection_ = projection;\n};\n\n\n/**\n * Set the map for this graticule.  The graticule will be rendered on the\n * provided map.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nGraticule.prototype.setMap = function(map) {\n  if (this.map_) {\n    unlistenByKey(this.postcomposeListenerKey_);\n    this.postcomposeListenerKey_ = null;\n    this.map_.render();\n  }\n  if (map) {\n    this.postcomposeListenerKey_ = listen(map, RenderEventType.POSTCOMPOSE, this.handlePostCompose_, this);\n    map.render();\n  }\n  this.map_ = map;\n};\nexport default Graticule;\n","/**\n * @module ol/ImageBase\n */\nimport {inherits} from './index.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/events/EventTarget}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number|undefined} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/ImageState} state State.\n */\nconst ImageBase = function(extent, resolution, pixelRatio, state) {\n\n  EventTarget.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent = extent;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.resolution = resolution;\n\n  /**\n   * @protected\n   * @type {module:ol/ImageState}\n   */\n  this.state = state;\n\n};\n\ninherits(ImageBase, EventTarget);\n\n\n/**\n * @protected\n */\nImageBase.prototype.changed = function() {\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * @return {module:ol/extent~Extent} Extent.\n */\nImageBase.prototype.getExtent = function() {\n  return this.extent;\n};\n\n\n/**\n * @abstract\n * @return {HTMLCanvasElement|Image|HTMLVideoElement} Image.\n */\nImageBase.prototype.getImage = function() {};\n\n\n/**\n * @return {number} PixelRatio.\n */\nImageBase.prototype.getPixelRatio = function() {\n  return this.pixelRatio_;\n};\n\n\n/**\n * @return {number} Resolution.\n */\nImageBase.prototype.getResolution = function() {\n  return /** @type {number} */ (this.resolution);\n};\n\n\n/**\n * @return {module:ol/ImageState} State.\n */\nImageBase.prototype.getState = function() {\n  return this.state;\n};\n\n\n/**\n * Load not yet loaded URI.\n * @abstract\n */\nImageBase.prototype.load = function() {};\n\nexport default ImageBase;\n","/**\n * @module ol/Image\n */\nimport {inherits} from './index.js';\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport {getHeight} from './extent.js';\n\n\n/**\n * A function that takes an {@link module:ol/Image~Image} for the image and a\n * `{string}` for the src as arguments. It is supposed to make it so the\n * underlying image {@link module:ol/Image~Image#getImage} is assigned the\n * content specified by the src. If not specified, the default is\n *\n *     function(image, src) {\n *       image.getImage().src = src;\n *     }\n *\n * Providing a custom `imageLoadFunction` can be useful to load images with\n * post requests or - in general - through XHR requests, where the src of the\n * image element would be set to a data URI when the content is loaded.\n *\n * @typedef {function(module:ol/Image, string)} LoadFunction\n * @api\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/ImageBase}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number|undefined} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {string} src Image source URI.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/Image~LoadFunction} imageLoadFunction Image load function.\n */\nconst ImageWrapper = function(extent, resolution, pixelRatio, src, crossOrigin, imageLoadFunction) {\n\n  ImageBase.call(this, extent, resolution, pixelRatio, ImageState.IDLE);\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|Image|HTMLVideoElement}\n   */\n  this.image_ = new Image();\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/ImageState}\n   */\n  this.state = ImageState.IDLE;\n\n  /**\n   * @private\n   * @type {module:ol/Image~LoadFunction}\n   */\n  this.imageLoadFunction_ = imageLoadFunction;\n\n};\n\ninherits(ImageWrapper, ImageBase);\n\n\n/**\n * @inheritDoc\n * @api\n */\nImageWrapper.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * Tracks loading or read errors.\n *\n * @private\n */\nImageWrapper.prototype.handleImageError_ = function() {\n  this.state = ImageState.ERROR;\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * Tracks successful image load.\n *\n * @private\n */\nImageWrapper.prototype.handleImageLoad_ = function() {\n  if (this.resolution === undefined) {\n    this.resolution = getHeight(this.extent) / this.image_.height;\n  }\n  this.state = ImageState.LOADED;\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * Load the image or retry if loading previously failed.\n * Loading is taken care of by the tile queue, and calling this method is\n * only needed for preloading or for reloading in case of an error.\n * @override\n * @api\n */\nImageWrapper.prototype.load = function() {\n  if (this.state == ImageState.IDLE || this.state == ImageState.ERROR) {\n    this.state = ImageState.LOADING;\n    this.changed();\n    this.imageListenerKeys_ = [\n      listenOnce(this.image_, EventType.ERROR,\n        this.handleImageError_, this),\n      listenOnce(this.image_, EventType.LOAD,\n        this.handleImageLoad_, this)\n    ];\n    this.imageLoadFunction_(this, this.src_);\n  }\n};\n\n\n/**\n * @param {HTMLCanvasElement|Image|HTMLVideoElement} image Image.\n */\nImageWrapper.prototype.setImage = function(image) {\n  this.image_ = image;\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\nImageWrapper.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\n\nexport default ImageWrapper;\n","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3,\n  EMPTY: 4,\n  ABORT: 5\n};\n","/**\n * @module ol/easing\n */\n\n\n/**\n * Start slow and speed up.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeIn(t) {\n  return Math.pow(t, 3);\n}\n\n\n/**\n * Start fast and slow down.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeOut(t) {\n  return 1 - easeIn(1 - t);\n}\n\n\n/**\n * Start slow, speed up, and then slow down again.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function inAndOut(t) {\n  return 3 * t * t - 2 * t * t * t;\n}\n\n\n/**\n * Maintain a constant speed over time.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function linear(t) {\n  return t;\n}\n\n\n/**\n * Start slow, speed up, and at the very end slow down again.  This has the\n * same general behavior as {@link module:ol/easing~inAndOut}, but the final\n * slowdown is delayed.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function upAndDown(t) {\n  if (t < 0.5) {\n    return inAndOut(2 * t);\n  } else {\n    return 1 - inAndOut(2 * (t - 0.5));\n  }\n}\n","/**\n * @module ol/Tile\n */\nimport {inherits} from './index.js';\nimport TileState from './TileState.js';\nimport {easeIn} from './easing.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n\n/**\n * A function that takes an {@link module:ol/Tile} for the tile and a\n * `{string}` for the url as arguments.\n *\n * @typedef {function(module:ol/Tile, string)} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~Tile} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(module:ol/tilecoord~TileCoord, number,\n *           module:ol/proj/Projection): (string|undefined)} UrlFunction\n * @api\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @api\n */\n\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/events/EventTarget}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {module:ol/Tile~Options=} opt_options Tile options.\n */\nconst Tile = function(tileCoord, state, opt_options) {\n  EventTarget.call(this);\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/tilecoord~TileCoord}\n   */\n  this.tileCoord = tileCoord;\n\n  /**\n   * @protected\n   * @type {module:ol/TileState}\n   */\n  this.state = state;\n\n  /**\n   * An \"interim\" tile for this tile. The interim tile may be used while this\n   * one is loading, for \"smooth\" transitions when changing params/dimensions\n   * on the source.\n   * @type {module:ol/Tile}\n   */\n  this.interimTile = null;\n\n  /**\n   * A key assigned to the tile. This is used by the tile source to determine\n   * if this tile can effectively be used, or if a new tile should be created\n   * and this one be used as an interim tile for this new tile.\n   * @type {string}\n   */\n  this.key = '';\n\n  /**\n   * The duration for the opacity transition.\n   * @type {number}\n   */\n  this.transition_ = options.transition === undefined ? 250 : options.transition;\n\n  /**\n   * Lookup of start times for rendering transitions.  If the start time is\n   * equal to -1, the transition is complete.\n   * @type {Object.<number, number>}\n   */\n  this.transitionStarts_ = {};\n\n};\n\ninherits(Tile, EventTarget);\n\n\n/**\n * @protected\n */\nTile.prototype.changed = function() {\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * @return {string} Key.\n */\nTile.prototype.getKey = function() {\n  return this.key + '/' + this.tileCoord;\n};\n\n/**\n * Get the interim tile most suitable for rendering using the chain of interim\n * tiles. This corresponds to the  most recent tile that has been loaded, if no\n * such tile exists, the original tile is returned.\n * @return {!module:ol/Tile} Best tile for rendering.\n */\nTile.prototype.getInterimTile = function() {\n  if (!this.interimTile) {\n    //empty chain\n    return this;\n  }\n  let tile = this.interimTile;\n\n  // find the first loaded tile and return it. Since the chain is sorted in\n  // decreasing order of creation time, there is no need to search the remainder\n  // of the list (all those tiles correspond to older requests and will be\n  // cleaned up by refreshInterimChain)\n  do {\n    if (tile.getState() == TileState.LOADED) {\n      return tile;\n    }\n    tile = tile.interimTile;\n  } while (tile);\n\n  // we can not find a better tile\n  return this;\n};\n\n/**\n * Goes through the chain of interim tiles and discards sections of the chain\n * that are no longer relevant.\n */\nTile.prototype.refreshInterimChain = function() {\n  if (!this.interimTile) {\n    return;\n  }\n\n  let tile = this.interimTile;\n  let prev = this;\n\n  do {\n    if (tile.getState() == TileState.LOADED) {\n      //we have a loaded tile, we can discard the rest of the list\n      //we would could abort any LOADING tile request\n      //older than this tile (i.e. any LOADING tile following this entry in the chain)\n      tile.interimTile = null;\n      break;\n    } else if (tile.getState() == TileState.LOADING) {\n      //keep this LOADING tile any loaded tiles later in the chain are\n      //older than this tile, so we're still interested in the request\n      prev = tile;\n    } else if (tile.getState() == TileState.IDLE) {\n      //the head of the list is the most current tile, we don't need\n      //to start any other requests for this chain\n      prev.interimTile = tile.interimTile;\n    } else {\n      prev = tile;\n    }\n    tile = prev.interimTile;\n  } while (tile);\n};\n\n/**\n * Get the tile coordinate for this tile.\n * @return {module:ol/tilecoord~TileCoord} The tile coordinate.\n * @api\n */\nTile.prototype.getTileCoord = function() {\n  return this.tileCoord;\n};\n\n\n/**\n * @return {module:ol/TileState} State.\n */\nTile.prototype.getState = function() {\n  return this.state;\n};\n\n/**\n * @param {module:ol/TileState} state State.\n */\nTile.prototype.setState = function(state) {\n  this.state = state;\n  this.changed();\n};\n\n/**\n * Load the image or retry if loading previously failed.\n * Loading is taken care of by the tile queue, and calling this method is\n * only needed for preloading or for reloading in case of an error.\n * @abstract\n * @api\n */\nTile.prototype.load = function() {};\n\n/**\n * Get the alpha value for rendering.\n * @param {number} id An id for the renderer.\n * @param {number} time The render frame time.\n * @return {number} A number between 0 and 1.\n */\nTile.prototype.getAlpha = function(id, time) {\n  if (!this.transition_) {\n    return 1;\n  }\n\n  let start = this.transitionStarts_[id];\n  if (!start) {\n    start = time;\n    this.transitionStarts_[id] = start;\n  } else if (start === -1) {\n    return 1;\n  }\n\n  const delta = time - start + (1000 / 60); // avoid rendering at 0\n  if (delta >= this.transition_) {\n    return 1;\n  }\n  return easeIn(delta / this.transition_);\n};\n\n/**\n * Determine if a tile is in an alpha transition.  A tile is considered in\n * transition if tile.getAlpha() has not yet been called or has been called\n * and returned 1.\n * @param {number} id An id for the renderer.\n * @return {boolean} The tile is in transition.\n */\nTile.prototype.inTransition = function(id) {\n  if (!this.transition_) {\n    return false;\n  }\n  return this.transitionStarts_[id] !== -1;\n};\n\n/**\n * Mark a transition as complete.\n * @param {number} id An id for the renderer.\n */\nTile.prototype.endTransition = function(id) {\n  if (this.transition_) {\n    this.transitionStarts_[id] = -1;\n  }\n};\nexport default Tile;\n","/**\n * @module ol/ImageTile\n */\nimport {inherits} from './index.js';\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @typedef {function(new: module:ol/ImageTile, module:ol/tilecoord~TileCoord,\n * module:ol/TileState, string, ?string, module:ol/Tile~LoadFunction)} TileClass\n * @api\n */\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {string} src Image source URI.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @param {module:ol/Tile~Options=} opt_options Tile options.\n */\nconst ImageTile = function(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n\n  Tile.call(this, tileCoord, state, opt_options);\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ = crossOrigin;\n\n  /**\n   * Image URI\n   *\n   * @private\n   * @type {string}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.image_ = new Image();\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/Tile~LoadFunction}\n   */\n  this.tileLoadFunction_ = tileLoadFunction;\n\n};\n\ninherits(ImageTile, Tile);\n\n\n/**\n * @inheritDoc\n */\nImageTile.prototype.disposeInternal = function() {\n  if (this.state == TileState.LOADING) {\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n  }\n  if (this.interimTile) {\n    this.interimTile.dispose();\n  }\n  this.state = TileState.ABORT;\n  this.changed();\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n * @api\n */\nImageTile.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * @inheritDoc\n */\nImageTile.prototype.getKey = function() {\n  return this.src_;\n};\n\n\n/**\n * Tracks loading or read errors.\n *\n * @private\n */\nImageTile.prototype.handleImageError_ = function() {\n  this.state = TileState.ERROR;\n  this.unlistenImage_();\n  this.image_ = getBlankImage();\n  this.changed();\n};\n\n\n/**\n * Tracks successful image load.\n *\n * @private\n */\nImageTile.prototype.handleImageLoad_ = function() {\n  if (this.image_.naturalWidth && this.image_.naturalHeight) {\n    this.state = TileState.LOADED;\n  } else {\n    this.state = TileState.EMPTY;\n  }\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nImageTile.prototype.load = function() {\n  if (this.state == TileState.ERROR) {\n    this.state = TileState.IDLE;\n    this.image_ = new Image();\n    if (this.crossOrigin_ !== null) {\n      this.image_.crossOrigin = this.crossOrigin_;\n    }\n  }\n  if (this.state == TileState.IDLE) {\n    this.state = TileState.LOADING;\n    this.changed();\n    this.imageListenerKeys_ = [\n      listenOnce(this.image_, EventType.ERROR,\n        this.handleImageError_, this),\n      listenOnce(this.image_, EventType.LOAD,\n        this.handleImageLoad_, this)\n    ];\n    this.tileLoadFunction_(this, this.src_);\n  }\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\nImageTile.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\n\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  const ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @constructor\n * @param {number} decay Rate of decay (must be negative).\n * @param {number} minVelocity Minimum velocity (pixels/millisecond).\n * @param {number} delay Delay to consider to calculate the kinetic\n *     initial values (milliseconds).\n * @struct\n * @api\n */\nconst Kinetic = function(decay, minVelocity, delay) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.decay_ = decay;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minVelocity_ = minVelocity;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delay_ = delay;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.points_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.initialVelocity_ = 0;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nKinetic.prototype.begin = function() {\n  this.points_.length = 0;\n  this.angle_ = 0;\n  this.initialVelocity_ = 0;\n};\n\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n */\nKinetic.prototype.update = function(x, y) {\n  this.points_.push(x, y, Date.now());\n};\n\n\n/**\n * @return {boolean} Whether we should do kinetic animation.\n */\nKinetic.prototype.end = function() {\n  if (this.points_.length < 6) {\n    // at least 2 points are required (i.e. there must be at least 6 elements\n    // in the array)\n    return false;\n  }\n  const delay = Date.now() - this.delay_;\n  const lastIndex = this.points_.length - 3;\n  if (this.points_[lastIndex + 2] < delay) {\n    // the last tracked point is too old, which means that the user stopped\n    // panning before releasing the map\n    return false;\n  }\n\n  // get the first point which still falls into the delay time\n  let firstIndex = lastIndex - 3;\n  while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n    firstIndex -= 3;\n  }\n\n  const duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n  // we don't want a duration of 0 (divide by zero)\n  // we also make sure the user panned for a duration of at least one frame\n  // (1/60s) to compute sane displacement values\n  if (duration < 1000 / 60) {\n    return false;\n  }\n\n  const dx = this.points_[lastIndex] - this.points_[firstIndex];\n  const dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n  this.angle_ = Math.atan2(dy, dx);\n  this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n  return this.initialVelocity_ > this.minVelocity_;\n};\n\n\n/**\n * @return {number} Total distance travelled (pixels).\n */\nKinetic.prototype.getDistance = function() {\n  return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n};\n\n\n/**\n * @return {number} Angle of the kinetic panning animation (radians).\n */\nKinetic.prototype.getAngle = function() {\n  return this.angle_;\n};\nexport default Kinetic;\n","/**\n * @module ol/MapEvent\n */\nimport {inherits} from './index.js';\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map event.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapEvent = function(type, map, opt_frameState) {\n\n  Event.call(this, type);\n\n  /**\n   * The map where the event occurred.\n   * @type {module:ol/PluggableMap}\n   * @api\n   */\n  this.map = map;\n\n  /**\n   * The frame state at the time of the event.\n   * @type {?module:ol/PluggableMap~FrameState}\n   * @api\n   */\n  this.frameState = opt_frameState !== undefined ? opt_frameState : null;\n\n};\n\ninherits(MapEvent, Event);\nexport default MapEvent;\n","/**\n * @module ol/MapBrowserEvent\n */\nimport {inherits} from './index.js';\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map browser event.\n *\n * @constructor\n * @extends {module:ol/MapEvent}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {Event} browserEvent Browser event.\n * @param {boolean=} opt_dragging Is the map currently being dragged?\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapBrowserEvent = function(type, map, browserEvent, opt_dragging, opt_frameState) {\n\n  MapEvent.call(this, type, map, opt_frameState);\n\n  /**\n   * The original browser event.\n   * @const\n   * @type {Event}\n   * @api\n   */\n  this.originalEvent = browserEvent;\n\n  /**\n   * The map pixel relative to the viewport corresponding to the original browser event.\n   * @type {module:ol~Pixel}\n   * @api\n   */\n  this.pixel = map.getEventPixel(browserEvent);\n\n  /**\n   * The coordinate in view projection corresponding to the original browser event.\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = map.getCoordinateFromPixel(this.pixel);\n\n  /**\n   * Indicates if the map is currently being dragged. Only set for\n   * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n   *\n   * @type {boolean}\n   * @api\n   */\n  this.dragging = opt_dragging !== undefined ? opt_dragging : false;\n\n};\n\ninherits(MapBrowserEvent, MapEvent);\n\n\n/**\n * Prevents the default browser action.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault\n * @override\n * @api\n */\nMapBrowserEvent.prototype.preventDefault = function() {\n  MapEvent.prototype.preventDefault.call(this);\n  this.originalEvent.preventDefault();\n};\n\n\n/**\n * Prevents further propagation of the current event.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation\n * @override\n * @api\n */\nMapBrowserEvent.prototype.stopPropagation = function() {\n  MapEvent.prototype.stopPropagation.call(this);\n  this.originalEvent.stopPropagation();\n};\nexport default MapBrowserEvent;\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/MapBrowserPointerEvent\n */\nimport {inherits} from './index.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\n\n/**\n * @constructor\n * @extends {module:ol/MapBrowserEvent}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @param {boolean=} opt_dragging Is the map currently being dragged?\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapBrowserPointerEvent = function(type, map, pointerEvent, opt_dragging,\n  opt_frameState) {\n\n  MapBrowserEvent.call(this, type, map, pointerEvent.originalEvent, opt_dragging,\n    opt_frameState);\n\n  /**\n   * @const\n   * @type {module:ol/pointer/PointerEvent}\n   */\n  this.pointerEvent = pointerEvent;\n\n};\n\ninherits(MapBrowserPointerEvent, MapBrowserEvent);\nexport default MapBrowserPointerEvent;\n","/**\n * @module ol/pointer/EventType\n */\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n  POINTERMOVE: 'pointermove',\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/pointer/EventSource\n */\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @param {!Object.<string, function(Event)>} mapping Event mapping.\n * @constructor\n */\nconst EventSource = function(dispatcher, mapping) {\n  /**\n   * @type {module:ol/pointer/PointerEventHandler}\n   */\n  this.dispatcher = dispatcher;\n\n  /**\n   * @private\n   * @const\n   * @type {!Object.<string, function(Event)>}\n   */\n  this.mapping_ = mapping;\n};\n\n\n/**\n * List of events supported by this source.\n * @return {Array.<string>} Event names\n */\nEventSource.prototype.getEvents = function() {\n  return Object.keys(this.mapping_);\n};\n\n\n/**\n * Returns the handler that should handle a given event type.\n * @param {string} eventType The event type.\n * @return {function(Event)} Handler\n */\nEventSource.prototype.getHandlerForEvent = function(eventType) {\n  return this.mapping_[eventType];\n};\nexport default EventSource;\n","/**\n * @module ol/pointer/MouseSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst MouseSource = function(dispatcher) {\n  const mapping = {\n    'mousedown': this.mousedown,\n    'mousemove': this.mousemove,\n    'mouseup': this.mouseup,\n    'mouseover': this.mouseover,\n    'mouseout': this.mouseout\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n\n  /**\n   * @const\n   * @type {Array.<module:ol~Pixel>}\n   */\n  this.lastTouches = [];\n};\n\ninherits(MouseSource, EventSource);\n\n\n/**\n * @type {number}\n */\nexport const POINTER_ID = 1;\n\n\n/**\n * @type {string}\n */\nexport const POINTER_TYPE = 'mouse';\n\n\n/**\n * Radius around touchend that swallows mouse events.\n *\n * @type {number}\n */\nconst DEDUP_DIST = 25;\n\n\n/**\n * Detect if a mouse event was simulated from a touch by\n * checking if previously there was a touch event at the\n * same position.\n *\n * FIXME - Known problem with the native Android browser on\n * Samsung GT-I9100 (Android 4.1.2):\n * In case the page is scrolled, this function does not work\n * correctly when a canvas is used (WebGL or canvas renderer).\n * Mouse listeners on canvas elements (for this browser), create\n * two mouse events: One 'good' and one 'bad' one (on other browsers or\n * when a div is used, there is only one event). For the 'bad' one,\n * clientX/clientY and also pageX/pageY are wrong when the page\n * is scrolled. Because of that, this function can not detect if\n * the events were simulated from a touch event. As result, a\n * pointer event at a wrong position is dispatched, which confuses\n * the map interactions.\n * It is unclear, how one can get the correct position for the event\n * or detect that the positions are invalid.\n *\n * @private\n * @param {Event} inEvent The in event.\n * @return {boolean} True, if the event was generated by a touch.\n */\nMouseSource.prototype.isEventSimulatedFromTouch_ = function(inEvent) {\n  const lts = this.lastTouches;\n  const x = inEvent.clientX;\n  const y = inEvent.clientY;\n  for (let i = 0, l = lts.length, t; i < l && (t = lts[i]); i++) {\n    // simulated mouse events will be swallowed near a primary touchend\n    const dx = Math.abs(x - t[0]);\n    const dy = Math.abs(y - t[1]);\n    if (dx <= DEDUP_DIST && dy <= DEDUP_DIST) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Creates a copy of the original event that will be used\n * for the fake pointer event.\n *\n * @param {Event} inEvent The in event.\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @return {Object} The copied event.\n */\nfunction prepareEvent(inEvent, dispatcher) {\n  const e = dispatcher.cloneEvent(inEvent, inEvent);\n\n  // forward mouse preventDefault\n  const pd = e.preventDefault;\n  e.preventDefault = function() {\n    inEvent.preventDefault();\n    pd();\n  };\n\n  e.pointerId = POINTER_ID;\n  e.isPrimary = true;\n  e.pointerType = POINTER_TYPE;\n\n  return e;\n}\n\n\n/**\n * Handler for `mousedown`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mousedown = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    // TODO(dfreedman) workaround for some elements not sending mouseup\n    // http://crbug/149091\n    if (POINTER_ID.toString() in this.pointerMap) {\n      this.cancel(inEvent);\n    }\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.pointerMap[POINTER_ID.toString()] = inEvent;\n    this.dispatcher.down(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mousemove`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mousemove = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.move(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mouseup`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseup = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const p = this.pointerMap[POINTER_ID.toString()];\n\n    if (p && p.button === inEvent.button) {\n      const e = prepareEvent(inEvent, this.dispatcher);\n      this.dispatcher.up(e, inEvent);\n      this.cleanupMouse();\n    }\n  }\n};\n\n\n/**\n * Handler for `mouseover`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseover = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.enterOver(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mouseout`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseout = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.leaveOut(e, inEvent);\n  }\n};\n\n\n/**\n * Dispatches a `pointercancel` event.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.cancel = function(inEvent) {\n  const e = prepareEvent(inEvent, this.dispatcher);\n  this.dispatcher.cancel(e, inEvent);\n  this.cleanupMouse();\n};\n\n\n/**\n * Remove the mouse from the list of active pointers.\n */\nMouseSource.prototype.cleanupMouse = function() {\n  delete this.pointerMap[POINTER_ID.toString()];\n};\nexport default MouseSource;\n","/**\n * @module ol/pointer/MsSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst MsSource = function(dispatcher) {\n  const mapping = {\n    'MSPointerDown': this.msPointerDown,\n    'MSPointerMove': this.msPointerMove,\n    'MSPointerUp': this.msPointerUp,\n    'MSPointerOut': this.msPointerOut,\n    'MSPointerOver': this.msPointerOver,\n    'MSPointerCancel': this.msPointerCancel,\n    'MSGotPointerCapture': this.msGotPointerCapture,\n    'MSLostPointerCapture': this.msLostPointerCapture\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, MSPointerEvent|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n};\n\ninherits(MsSource, EventSource);\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst POINTER_TYPES = [\n  '',\n  'unavailable',\n  'touch',\n  'pen',\n  'mouse'\n];\n\n\n/**\n * Creates a copy of the original event that will be used\n * for the fake pointer event.\n *\n * @private\n * @param {MSPointerEvent} inEvent The in event.\n * @return {Object} The copied event.\n */\nMsSource.prototype.prepareEvent_ = function(inEvent) {\n  let e = inEvent;\n  if (typeof inEvent.pointerType === 'number') {\n    e = this.dispatcher.cloneEvent(inEvent, inEvent);\n    e.pointerType = POINTER_TYPES[inEvent.pointerType];\n  }\n\n  return e;\n};\n\n\n/**\n * Remove this pointer from the list of active pointers.\n * @param {number} pointerId Pointer identifier.\n */\nMsSource.prototype.cleanup = function(pointerId) {\n  delete this.pointerMap[pointerId.toString()];\n};\n\n\n/**\n * Handler for `msPointerDown`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerDown = function(inEvent) {\n  this.pointerMap[inEvent.pointerId.toString()] = inEvent;\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.down(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerMove`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerMove = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.move(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerUp`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerUp = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.up(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n};\n\n\n/**\n * Handler for `msPointerOut`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerOut = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.leaveOut(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerOver`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerOver = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.enterOver(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerCancel`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerCancel = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.cancel(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n};\n\n\n/**\n * Handler for `msLostPointerCapture`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msLostPointerCapture = function(inEvent) {\n  const e = this.dispatcher.makeEvent('lostpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n};\n\n\n/**\n * Handler for `msGotPointerCapture`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msGotPointerCapture = function(inEvent) {\n  const e = this.dispatcher.makeEvent('gotpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n};\nexport default MsSource;\n","/**\n * @module ol/pointer/NativeSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst NativeSource = function(dispatcher) {\n  const mapping = {\n    'pointerdown': this.pointerDown,\n    'pointermove': this.pointerMove,\n    'pointerup': this.pointerUp,\n    'pointerout': this.pointerOut,\n    'pointerover': this.pointerOver,\n    'pointercancel': this.pointerCancel,\n    'gotpointercapture': this.gotPointerCapture,\n    'lostpointercapture': this.lostPointerCapture\n  };\n  EventSource.call(this, dispatcher, mapping);\n};\n\ninherits(NativeSource, EventSource);\n\n\n/**\n * Handler for `pointerdown`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerDown = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointermove`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerMove = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerup`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerUp = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerout`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerOut = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerover`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerOver = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointercancel`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerCancel = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `lostpointercapture`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.lostPointerCapture = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `gotpointercapture`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.gotPointerCapture = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\nexport default NativeSource;\n","/**\n * @module ol/pointer/PointerEvent\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport Event from '../events/Event.js';\n\n/**\n * A class for pointer events.\n *\n * This class is used as an abstraction for mouse events,\n * touch events and even native pointer events.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type The type of the event to create.\n * @param {Event} originalEvent The event.\n * @param {Object.<string, ?>=} opt_eventDict An optional dictionary of\n *    initial event properties.\n */\nconst PointerEvent = function(type, originalEvent, opt_eventDict) {\n  Event.call(this, type);\n\n  /**\n   * @const\n   * @type {Event}\n   */\n  this.originalEvent = originalEvent;\n\n  const eventDict = opt_eventDict ? opt_eventDict : {};\n\n  /**\n   * @type {number}\n   */\n  this.buttons = this.getButtons_(eventDict);\n\n  /**\n   * @type {number}\n   */\n  this.pressure = this.getPressure_(eventDict, this.buttons);\n\n  // MouseEvent related properties\n\n  /**\n   * @type {boolean}\n   */\n  this.bubbles = 'bubbles' in eventDict ? eventDict['bubbles'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.cancelable = 'cancelable' in eventDict ? eventDict['cancelable'] : false;\n\n  /**\n   * @type {Object}\n   */\n  this.view = 'view' in eventDict ? eventDict['view'] : null;\n\n  /**\n   * @type {number}\n   */\n  this.detail = 'detail' in eventDict ? eventDict['detail'] : null;\n\n  /**\n   * @type {number}\n   */\n  this.screenX = 'screenX' in eventDict ? eventDict['screenX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.screenY = 'screenY' in eventDict ? eventDict['screenY'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.clientX = 'clientX' in eventDict ? eventDict['clientX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.clientY = 'clientY' in eventDict ? eventDict['clientY'] : 0;\n\n  /**\n   * @type {boolean}\n   */\n  this.ctrlKey = 'ctrlKey' in eventDict ? eventDict['ctrlKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.altKey = 'altKey' in eventDict ? eventDict['altKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.shiftKey = 'shiftKey' in eventDict ? eventDict['shiftKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.metaKey = 'metaKey' in eventDict ? eventDict['metaKey'] : false;\n\n  /**\n   * @type {number}\n   */\n  this.button = 'button' in eventDict ? eventDict['button'] : 0;\n\n  /**\n   * @type {Node}\n   */\n  this.relatedTarget = 'relatedTarget' in eventDict ?\n    eventDict['relatedTarget'] : null;\n\n  // PointerEvent related properties\n\n  /**\n   * @const\n   * @type {number}\n   */\n  this.pointerId = 'pointerId' in eventDict ? eventDict['pointerId'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.width = 'width' in eventDict ? eventDict['width'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.height = 'height' in eventDict ? eventDict['height'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.tiltX = 'tiltX' in eventDict ? eventDict['tiltX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.tiltY = 'tiltY' in eventDict ? eventDict['tiltY'] : 0;\n\n  /**\n   * @type {string}\n   */\n  this.pointerType = 'pointerType' in eventDict ? eventDict['pointerType'] : '';\n\n  /**\n   * @type {number}\n   */\n  this.hwTimestamp = 'hwTimestamp' in eventDict ? eventDict['hwTimestamp'] : 0;\n\n  /**\n   * @type {boolean}\n   */\n  this.isPrimary = 'isPrimary' in eventDict ? eventDict['isPrimary'] : false;\n\n  // keep the semantics of preventDefault\n  if (originalEvent.preventDefault) {\n    this.preventDefault = function() {\n      originalEvent.preventDefault();\n    };\n  }\n};\n\ninherits(PointerEvent, Event);\n\n\n/**\n * Is the `buttons` property supported?\n * @type {boolean}\n */\nlet HAS_BUTTONS = false;\n\n\n/**\n * @private\n * @param {Object.<string, ?>} eventDict The event dictionary.\n * @return {number} Button indicator.\n */\nPointerEvent.prototype.getButtons_ = function(eventDict) {\n  // According to the w3c spec,\n  // http://www.w3.org/TR/DOM-Level-3-Events/#events-MouseEvent-button\n  // MouseEvent.button == 0 can mean either no mouse button depressed, or the\n  // left mouse button depressed.\n  //\n  // As of now, the only way to distinguish between the two states of\n  // MouseEvent.button is by using the deprecated MouseEvent.which property, as\n  // this maps mouse buttons to positive integers > 0, and uses 0 to mean that\n  // no mouse button is held.\n  //\n  // MouseEvent.which is derived from MouseEvent.button at MouseEvent creation,\n  // but initMouseEvent does not expose an argument with which to set\n  // MouseEvent.which. Calling initMouseEvent with a buttonArg of 0 will set\n  // MouseEvent.button == 0 and MouseEvent.which == 1, breaking the expectations\n  // of app developers.\n  //\n  // The only way to propagate the correct state of MouseEvent.which and\n  // MouseEvent.button to a new MouseEvent.button == 0 and MouseEvent.which == 0\n  // is to call initMouseEvent with a buttonArg value of -1.\n  //\n  // This is fixed with DOM Level 4's use of buttons\n  let buttons;\n  if (eventDict.buttons || HAS_BUTTONS) {\n    buttons = eventDict.buttons;\n  } else {\n    switch (eventDict.which) {\n      case 1: buttons = 1; break;\n      case 2: buttons = 4; break;\n      case 3: buttons = 2; break;\n      default: buttons = 0;\n    }\n  }\n  return buttons;\n};\n\n\n/**\n * @private\n * @param {Object.<string, ?>} eventDict The event dictionary.\n * @param {number} buttons Button indicator.\n * @return {number} The pressure.\n */\nPointerEvent.prototype.getPressure_ = function(eventDict, buttons) {\n  // Spec requires that pointers without pressure specified use 0.5 for down\n  // state and 0 for up state.\n  let pressure = 0;\n  if (eventDict.pressure) {\n    pressure = eventDict.pressure;\n  } else {\n    pressure = buttons ? 0.5 : 0;\n  }\n  return pressure;\n};\n\n\n/**\n * Checks if the `buttons` property is supported.\n */\n(function() {\n  try {\n    const ev = new MouseEvent('click', {buttons: 1});\n    HAS_BUTTONS = ev.buttons === 1;\n  } catch (e) {\n    // pass\n  }\n})();\nexport default PointerEvent;\n","/**\n * @module ol/pointer/TouchSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport {remove} from '../array.js';\nimport EventSource from '../pointer/EventSource.js';\nimport {POINTER_ID} from '../pointer/MouseSource.js';\n\n\n/**\n * @constructor\n * @param {module:ol/pointer/PointerEventHandler} dispatcher The event handler.\n * @param {module:ol/pointer/MouseSource} mouseSource Mouse source.\n * @extends {module:ol/pointer/EventSource}\n */\nconst TouchSource = function(dispatcher, mouseSource) {\n  const mapping = {\n    'touchstart': this.touchstart,\n    'touchmove': this.touchmove,\n    'touchend': this.touchend,\n    'touchcancel': this.touchcancel\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n\n  /**\n   * @const\n   * @type {module:ol/pointer/MouseSource}\n   */\n  this.mouseSource = mouseSource;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.firstTouchId_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.clickCount_ = 0;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.resetId_ = undefined;\n\n  /**\n   * Mouse event timeout: This should be long enough to\n   * ignore compat mouse events made by touch.\n   * @private\n   * @type {number}\n   */\n  this.dedupTimeout_ = 2500;\n};\n\ninherits(TouchSource, EventSource);\n\n\n/**\n * @type {number}\n */\nconst CLICK_COUNT_TIMEOUT = 200;\n\n\n/**\n * @type {string}\n */\nconst POINTER_TYPE = 'touch';\n\n/**\n * @private\n * @param {Touch} inTouch The in touch.\n * @return {boolean} True, if this is the primary touch.\n */\nTouchSource.prototype.isPrimaryTouch_ = function(inTouch) {\n  return this.firstTouchId_ === inTouch.identifier;\n};\n\n\n/**\n * Set primary touch if there are no pointers, or the only pointer is the mouse.\n * @param {Touch} inTouch The in touch.\n * @private\n */\nTouchSource.prototype.setPrimaryTouch_ = function(inTouch) {\n  const count = Object.keys(this.pointerMap).length;\n  if (count === 0 || (count === 1 && POINTER_ID.toString() in this.pointerMap)) {\n    this.firstTouchId_ = inTouch.identifier;\n    this.cancelResetClickCount_();\n  }\n};\n\n\n/**\n * @private\n * @param {Object} inPointer The in pointer object.\n */\nTouchSource.prototype.removePrimaryPointer_ = function(inPointer) {\n  if (inPointer.isPrimary) {\n    this.firstTouchId_ = undefined;\n    this.resetClickCount_();\n  }\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.resetClickCount_ = function() {\n  this.resetId_ = setTimeout(\n    this.resetClickCountHandler_.bind(this),\n    CLICK_COUNT_TIMEOUT);\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.resetClickCountHandler_ = function() {\n  this.clickCount_ = 0;\n  this.resetId_ = undefined;\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.cancelResetClickCount_ = function() {\n  if (this.resetId_ !== undefined) {\n    clearTimeout(this.resetId_);\n  }\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent Browser event\n * @param {Touch} inTouch Touch event\n * @return {Object} A pointer object.\n */\nTouchSource.prototype.touchToPointer_ = function(browserEvent, inTouch) {\n  const e = this.dispatcher.cloneEvent(browserEvent, inTouch);\n  // Spec specifies that pointerId 1 is reserved for Mouse.\n  // Touch identifiers can start at 0.\n  // Add 2 to the touch identifier for compatibility.\n  e.pointerId = inTouch.identifier + 2;\n  // TODO: check if this is necessary?\n  //e.target = findTarget(e);\n  e.bubbles = true;\n  e.cancelable = true;\n  e.detail = this.clickCount_;\n  e.button = 0;\n  e.buttons = 1;\n  e.width = inTouch.webkitRadiusX || inTouch.radiusX || 0;\n  e.height = inTouch.webkitRadiusY || inTouch.radiusY || 0;\n  e.pressure = inTouch.webkitForce || inTouch.force || 0.5;\n  e.isPrimary = this.isPrimaryTouch_(inTouch);\n  e.pointerType = POINTER_TYPE;\n\n  // make sure that the properties that are different for\n  // each `Touch` object are not copied from the BrowserEvent object\n  e.clientX = inTouch.clientX;\n  e.clientY = inTouch.clientY;\n  e.screenX = inTouch.screenX;\n  e.screenY = inTouch.screenY;\n\n  return e;\n};\n\n\n/**\n * @private\n * @param {Event} inEvent Touch event\n * @param {function(Event, Object)} inFunction In function.\n */\nTouchSource.prototype.processTouches_ = function(inEvent, inFunction) {\n  const touches = Array.prototype.slice.call(inEvent.changedTouches);\n  const count = touches.length;\n  function preventDefault() {\n    inEvent.preventDefault();\n  }\n  for (let i = 0; i < count; ++i) {\n    const pointer = this.touchToPointer_(inEvent, touches[i]);\n    // forward touch preventDefaults\n    pointer.preventDefault = preventDefault;\n    inFunction.call(this, inEvent, pointer);\n  }\n};\n\n\n/**\n * @private\n * @param {TouchList} touchList The touch list.\n * @param {number} searchId Search identifier.\n * @return {boolean} True, if the `Touch` with the given id is in the list.\n */\nTouchSource.prototype.findTouch_ = function(touchList, searchId) {\n  const l = touchList.length;\n  for (let i = 0; i < l; i++) {\n    const touch = touchList[i];\n    if (touch.identifier === searchId) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * In some instances, a touchstart can happen without a touchend. This\n * leaves the pointermap in a broken state.\n * Therefore, on every touchstart, we remove the touches that did not fire a\n * touchend event.\n * To keep state globally consistent, we fire a pointercancel for\n * this \"abandoned\" touch\n *\n * @private\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.vacuumTouches_ = function(inEvent) {\n  const touchList = inEvent.touches;\n  // pointerMap.getCount() should be < touchList.length here,\n  // as the touchstart has not been processed yet.\n  const keys = Object.keys(this.pointerMap);\n  const count = keys.length;\n  if (count >= touchList.length) {\n    const d = [];\n    for (let i = 0; i < count; ++i) {\n      const key = keys[i];\n      const value = this.pointerMap[key];\n      // Never remove pointerId == 1, which is mouse.\n      // Touch identifiers are 2 smaller than their pointerId, which is the\n      // index in pointermap.\n      if (key != POINTER_ID && !this.findTouch_(touchList, key - 2)) {\n        d.push(value.out);\n      }\n    }\n    for (let i = 0; i < d.length; ++i) {\n      this.cancelOut_(inEvent, d[i]);\n    }\n  }\n};\n\n\n/**\n * Handler for `touchstart`, triggers `pointerover`,\n * `pointerenter` and `pointerdown` events.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchstart = function(inEvent) {\n  this.vacuumTouches_(inEvent);\n  this.setPrimaryTouch_(inEvent.changedTouches[0]);\n  this.dedupSynthMouse_(inEvent);\n  this.clickCount_++;\n  this.processTouches_(inEvent, this.overDown_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer object.\n */\nTouchSource.prototype.overDown_ = function(browserEvent, inPointer) {\n  this.pointerMap[inPointer.pointerId] = {\n    target: inPointer.target,\n    out: inPointer,\n    outTarget: inPointer.target\n  };\n  this.dispatcher.over(inPointer, browserEvent);\n  this.dispatcher.enter(inPointer, browserEvent);\n  this.dispatcher.down(inPointer, browserEvent);\n};\n\n\n/**\n * Handler for `touchmove`.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchmove = function(inEvent) {\n  inEvent.preventDefault();\n  this.processTouches_(inEvent, this.moveOverOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer.\n */\nTouchSource.prototype.moveOverOut_ = function(browserEvent, inPointer) {\n  const event = inPointer;\n  const pointer = this.pointerMap[event.pointerId];\n  // a finger drifted off the screen, ignore it\n  if (!pointer) {\n    return;\n  }\n  const outEvent = pointer.out;\n  const outTarget = pointer.outTarget;\n  this.dispatcher.move(event, browserEvent);\n  if (outEvent && outTarget !== event.target) {\n    outEvent.relatedTarget = event.target;\n    event.relatedTarget = outTarget;\n    // recover from retargeting by shadow\n    outEvent.target = outTarget;\n    if (event.target) {\n      this.dispatcher.leaveOut(outEvent, browserEvent);\n      this.dispatcher.enterOver(event, browserEvent);\n    } else {\n      // clean up case when finger leaves the screen\n      event.target = outTarget;\n      event.relatedTarget = null;\n      this.cancelOut_(browserEvent, event);\n    }\n  }\n  pointer.out = event;\n  pointer.outTarget = event.target;\n};\n\n\n/**\n * Handler for `touchend`, triggers `pointerup`,\n * `pointerout` and `pointerleave` events.\n *\n * @param {Event} inEvent The event.\n */\nTouchSource.prototype.touchend = function(inEvent) {\n  this.dedupSynthMouse_(inEvent);\n  this.processTouches_(inEvent, this.upOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent An event.\n * @param {Object} inPointer The inPointer object.\n */\nTouchSource.prototype.upOut_ = function(browserEvent, inPointer) {\n  this.dispatcher.up(inPointer, browserEvent);\n  this.dispatcher.out(inPointer, browserEvent);\n  this.dispatcher.leave(inPointer, browserEvent);\n  this.cleanUpPointer_(inPointer);\n};\n\n\n/**\n * Handler for `touchcancel`, triggers `pointercancel`,\n * `pointerout` and `pointerleave` events.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchcancel = function(inEvent) {\n  this.processTouches_(inEvent, this.cancelOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer.\n */\nTouchSource.prototype.cancelOut_ = function(browserEvent, inPointer) {\n  this.dispatcher.cancel(inPointer, browserEvent);\n  this.dispatcher.out(inPointer, browserEvent);\n  this.dispatcher.leave(inPointer, browserEvent);\n  this.cleanUpPointer_(inPointer);\n};\n\n\n/**\n * @private\n * @param {Object} inPointer The inPointer object.\n */\nTouchSource.prototype.cleanUpPointer_ = function(inPointer) {\n  delete this.pointerMap[inPointer.pointerId];\n  this.removePrimaryPointer_(inPointer);\n};\n\n\n/**\n * Prevent synth mouse events from creating pointer events.\n *\n * @private\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.dedupSynthMouse_ = function(inEvent) {\n  const lts = this.mouseSource.lastTouches;\n  const t = inEvent.changedTouches[0];\n  // only the primary finger will synth mouse events\n  if (this.isPrimaryTouch_(t)) {\n    // remember x/y of last touch\n    const lt = [t.clientX, t.clientY];\n    lts.push(lt);\n\n    setTimeout(function() {\n      // remove touch after timeout\n      remove(lts, lt);\n    }, this.dedupTimeout_);\n  }\n};\nexport default TouchSource;\n","/**\n * @module ol/pointer/PointerEventHandler\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../index.js';\nimport {listen, unlisten} from '../events.js';\nimport EventTarget from '../events/EventTarget.js';\nimport {POINTER, MSPOINTER, TOUCH} from '../has.js';\nimport PointerEventType from '../pointer/EventType.js';\nimport MouseSource from '../pointer/MouseSource.js';\nimport MsSource from '../pointer/MsSource.js';\nimport NativeSource from '../pointer/NativeSource.js';\nimport PointerEvent from '../pointer/PointerEvent.js';\nimport TouchSource from '../pointer/TouchSource.js';\n\n/**\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @param {Element|HTMLDocument} element Viewport element.\n */\nconst PointerEventHandler = function(element) {\n  EventTarget.call(this);\n\n  /**\n   * @const\n   * @private\n   * @type {Element|HTMLDocument}\n   */\n  this.element_ = element;\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = {};\n\n  /**\n   * @type {Object.<string, function(Event)>}\n   * @private\n   */\n  this.eventMap_ = {};\n\n  /**\n   * @type {Array.<module:ol/pointer/EventSource>}\n   * @private\n   */\n  this.eventSourceList_ = [];\n\n  this.registerSources();\n};\n\ninherits(PointerEventHandler, EventTarget);\n\n/**\n * Properties to copy when cloning an event, with default values.\n * @type {Array.<Array>}\n */\nconst CLONE_PROPS = [\n  // MouseEvent\n  ['bubbles', false],\n  ['cancelable', false],\n  ['view', null],\n  ['detail', null],\n  ['screenX', 0],\n  ['screenY', 0],\n  ['clientX', 0],\n  ['clientY', 0],\n  ['ctrlKey', false],\n  ['altKey', false],\n  ['shiftKey', false],\n  ['metaKey', false],\n  ['button', 0],\n  ['relatedTarget', null],\n  // DOM Level 3\n  ['buttons', 0],\n  // PointerEvent\n  ['pointerId', 0],\n  ['width', 0],\n  ['height', 0],\n  ['pressure', 0],\n  ['tiltX', 0],\n  ['tiltY', 0],\n  ['pointerType', ''],\n  ['hwTimestamp', 0],\n  ['isPrimary', false],\n  // event instance\n  ['type', ''],\n  ['target', null],\n  ['currentTarget', null],\n  ['which', 0]\n];\n\n\n/**\n * Set up the event sources (mouse, touch and native pointers)\n * that generate pointer events.\n */\nPointerEventHandler.prototype.registerSources = function() {\n  if (POINTER) {\n    this.registerSource('native', new NativeSource(this));\n  } else if (MSPOINTER) {\n    this.registerSource('ms', new MsSource(this));\n  } else {\n    const mouseSource = new MouseSource(this);\n    this.registerSource('mouse', mouseSource);\n\n    if (TOUCH) {\n      this.registerSource('touch', new TouchSource(this, mouseSource));\n    }\n  }\n\n  // register events on the viewport element\n  this.register_();\n};\n\n\n/**\n * Add a new event source that will generate pointer events.\n *\n * @param {string} name A name for the event source\n * @param {module:ol/pointer/EventSource} source The source event.\n */\nPointerEventHandler.prototype.registerSource = function(name, source) {\n  const s = source;\n  const newEvents = s.getEvents();\n\n  if (newEvents) {\n    newEvents.forEach(function(e) {\n      const handler = s.getHandlerForEvent(e);\n\n      if (handler) {\n        this.eventMap_[e] = handler.bind(s);\n      }\n    }.bind(this));\n    this.eventSourceList_.push(s);\n  }\n};\n\n\n/**\n * Set up the events for all registered event sources.\n * @private\n */\nPointerEventHandler.prototype.register_ = function() {\n  const l = this.eventSourceList_.length;\n  for (let i = 0; i < l; i++) {\n    const eventSource = this.eventSourceList_[i];\n    this.addEvents_(eventSource.getEvents());\n  }\n};\n\n\n/**\n * Remove all registered events.\n * @private\n */\nPointerEventHandler.prototype.unregister_ = function() {\n  const l = this.eventSourceList_.length;\n  for (let i = 0; i < l; i++) {\n    const eventSource = this.eventSourceList_[i];\n    this.removeEvents_(eventSource.getEvents());\n  }\n};\n\n\n/**\n * Calls the right handler for a new event.\n * @private\n * @param {Event} inEvent Browser event.\n */\nPointerEventHandler.prototype.eventHandler_ = function(inEvent) {\n  const type = inEvent.type;\n  const handler = this.eventMap_[type];\n  if (handler) {\n    handler(inEvent);\n  }\n};\n\n\n/**\n * Setup listeners for the given events.\n * @private\n * @param {Array.<string>} events List of events.\n */\nPointerEventHandler.prototype.addEvents_ = function(events) {\n  events.forEach(function(eventName) {\n    listen(this.element_, eventName, this.eventHandler_, this);\n  }.bind(this));\n};\n\n\n/**\n * Unregister listeners for the given events.\n * @private\n * @param {Array.<string>} events List of events.\n */\nPointerEventHandler.prototype.removeEvents_ = function(events) {\n  events.forEach(function(e) {\n    unlisten(this.element_, e, this.eventHandler_, this);\n  }.bind(this));\n};\n\n\n/**\n * Returns a snapshot of inEvent, with writable properties.\n *\n * @param {Event} event Browser event.\n * @param {Event|Touch} inEvent An event that contains\n *    properties to copy.\n * @return {Object} An object containing shallow copies of\n *    `inEvent`'s properties.\n */\nPointerEventHandler.prototype.cloneEvent = function(event, inEvent) {\n  const eventCopy = {};\n  for (let i = 0, ii = CLONE_PROPS.length; i < ii; i++) {\n    const p = CLONE_PROPS[i][0];\n    eventCopy[p] = event[p] || inEvent[p] || CLONE_PROPS[i][1];\n  }\n\n  return eventCopy;\n};\n\n\n// EVENTS\n\n\n/**\n * Triggers a 'pointerdown' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.down = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERDOWN, data, event);\n};\n\n\n/**\n * Triggers a 'pointermove' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.move = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERMOVE, data, event);\n};\n\n\n/**\n * Triggers a 'pointerup' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.up = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERUP, data, event);\n};\n\n\n/**\n * Triggers a 'pointerenter' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.enter = function(data, event) {\n  data.bubbles = false;\n  this.fireEvent(PointerEventType.POINTERENTER, data, event);\n};\n\n\n/**\n * Triggers a 'pointerleave' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.leave = function(data, event) {\n  data.bubbles = false;\n  this.fireEvent(PointerEventType.POINTERLEAVE, data, event);\n};\n\n\n/**\n * Triggers a 'pointerover' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.over = function(data, event) {\n  data.bubbles = true;\n  this.fireEvent(PointerEventType.POINTEROVER, data, event);\n};\n\n\n/**\n * Triggers a 'pointerout' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.out = function(data, event) {\n  data.bubbles = true;\n  this.fireEvent(PointerEventType.POINTEROUT, data, event);\n};\n\n\n/**\n * Triggers a 'pointercancel' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.cancel = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERCANCEL, data, event);\n};\n\n\n/**\n * Triggers a combination of 'pointerout' and 'pointerleave' events.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.leaveOut = function(data, event) {\n  this.out(data, event);\n  if (!this.contains_(data.target, data.relatedTarget)) {\n    this.leave(data, event);\n  }\n};\n\n\n/**\n * Triggers a combination of 'pointerover' and 'pointerevents' events.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.enterOver = function(data, event) {\n  this.over(data, event);\n  if (!this.contains_(data.target, data.relatedTarget)) {\n    this.enter(data, event);\n  }\n};\n\n\n/**\n * @private\n * @param {Element} container The container element.\n * @param {Element} contained The contained element.\n * @return {boolean} Returns true if the container element\n *   contains the other element.\n */\nPointerEventHandler.prototype.contains_ = function(container, contained) {\n  if (!container || !contained) {\n    return false;\n  }\n  return container.contains(contained);\n};\n\n\n// EVENT CREATION AND TRACKING\n/**\n * Creates a new Event of type `inType`, based on the information in\n * `data`.\n *\n * @param {string} inType A string representing the type of event to create.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n * @return {module:ol/pointer/PointerEvent} A PointerEvent of type `inType`.\n */\nPointerEventHandler.prototype.makeEvent = function(inType, data, event) {\n  return new PointerEvent(inType, event, data);\n};\n\n\n/**\n * Make and dispatch an event in one call.\n * @param {string} inType A string representing the type of event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.fireEvent = function(inType, data, event) {\n  const e = this.makeEvent(inType, data, event);\n  this.dispatchEvent(e);\n};\n\n\n/**\n * Creates a pointer event from a native pointer event\n * and dispatches this event.\n * @param {Event} event A platform event with a target.\n */\nPointerEventHandler.prototype.fireNativeEvent = function(event) {\n  const e = this.makeEvent(event.type, event, event);\n  this.dispatchEvent(e);\n};\n\n\n/**\n * Wrap a native mouse event into a pointer event.\n * This proxy method is required for the legacy IE support.\n * @param {string} eventType The pointer event type.\n * @param {Event} event The event.\n * @return {module:ol/pointer/PointerEvent} The wrapped event.\n */\nPointerEventHandler.prototype.wrapMouseEvent = function(eventType, event) {\n  const pointerEvent = this.makeEvent(\n    eventType, MouseSource.prepareEvent(event, this), event);\n  return pointerEvent;\n};\n\n\n/**\n * @inheritDoc\n */\nPointerEventHandler.prototype.disposeInternal = function() {\n  this.unregister_();\n  EventTarget.prototype.disposeInternal.call(this);\n};\n\n\nexport default PointerEventHandler;\n","/**\n * @module ol/MapBrowserEventHandler\n */\nimport {inherits} from './index.js';\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapBrowserPointerEvent from './MapBrowserPointerEvent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventTarget from './events/EventTarget.js';\nimport PointerEventType from './pointer/EventType.js';\nimport PointerEventHandler from './pointer/PointerEventHandler.js';\n\n/**\n * @param {module:ol/PluggableMap} map The map with the viewport to\n * listen to events on.\n * @param {number=} moveTolerance The minimal distance the pointer must travel\n * to trigger a move.\n * @constructor\n * @extends {module:ol/events/EventTarget}\n */\nconst MapBrowserEventHandler = function(map, moveTolerance) {\n\n  EventTarget.call(this);\n\n  /**\n   * This is the element that we will listen to the real events on.\n   * @type {module:ol/PluggableMap}\n   * @private\n   */\n  this.map_ = map;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.clickTimeoutId_ = 0;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.dragging_ = false;\n\n  /**\n   * @type {!Array.<module:ol/events~EventsKey>}\n   * @private\n   */\n  this.dragListenerKeys_ = [];\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.moveTolerance_ = moveTolerance ?\n    moveTolerance * DEVICE_PIXEL_RATIO : DEVICE_PIXEL_RATIO;\n\n  /**\n   * The most recent \"down\" type event (or null if none have occurred).\n   * Set on pointerdown.\n   * @type {module:ol/pointer/PointerEvent}\n   * @private\n   */\n  this.down_ = null;\n\n  const element = this.map_.getViewport();\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.activePointers_ = 0;\n\n  /**\n   * @type {!Object.<number, boolean>}\n   * @private\n   */\n  this.trackedTouches_ = {};\n\n  /**\n   * Event handler which generates pointer events for\n   * the viewport element.\n   *\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.pointerEventHandler_ = new PointerEventHandler(element);\n\n  /**\n   * Event handler which generates pointer events for\n   * the document (used when dragging).\n   *\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.documentPointerEventHandler_ = null;\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.pointerdownListenerKey_ = listen(this.pointerEventHandler_,\n    PointerEventType.POINTERDOWN,\n    this.handlePointerDown_, this);\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.relayedListenerKey_ = listen(this.pointerEventHandler_,\n    PointerEventType.POINTERMOVE,\n    this.relayEvent_, this);\n\n};\n\ninherits(MapBrowserEventHandler, EventTarget);\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.emulateClick_ = function(pointerEvent) {\n  let newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.CLICK, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n  if (this.clickTimeoutId_ !== 0) {\n    // double-click\n    clearTimeout(this.clickTimeoutId_);\n    this.clickTimeoutId_ = 0;\n    newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.DBLCLICK, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n  } else {\n    // click\n    this.clickTimeoutId_ = setTimeout(function() {\n      this.clickTimeoutId_ = 0;\n      const newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.SINGLECLICK, this.map_, pointerEvent);\n      this.dispatchEvent(newEvent);\n    }.bind(this), 250);\n  }\n};\n\n\n/**\n * Keeps track on how many pointers are currently active.\n *\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.updateActivePointers_ = function(pointerEvent) {\n  const event = pointerEvent;\n\n  if (event.type == MapBrowserEventType.POINTERUP ||\n      event.type == MapBrowserEventType.POINTERCANCEL) {\n    delete this.trackedTouches_[event.pointerId];\n  } else if (event.type == MapBrowserEventType.POINTERDOWN) {\n    this.trackedTouches_[event.pointerId] = true;\n  }\n  this.activePointers_ = Object.keys(this.trackedTouches_).length;\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerUp_ = function(pointerEvent) {\n  this.updateActivePointers_(pointerEvent);\n  const newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.POINTERUP, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n\n  // We emulate click events on left mouse button click, touch contact, and pen\n  // contact. isMouseActionButton returns true in these cases (evt.button is set\n  // to 0).\n  // See http://www.w3.org/TR/pointerevents/#button-states\n  // We only fire click, singleclick, and doubleclick if nobody has called\n  // event.stopPropagation() or event.preventDefault().\n  if (!newEvent.propagationStopped && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {\n    this.emulateClick_(this.down_);\n  }\n\n  if (this.activePointers_ === 0) {\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n    this.dragging_ = false;\n    this.down_ = null;\n    this.documentPointerEventHandler_.dispose();\n    this.documentPointerEventHandler_ = null;\n  }\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @return {boolean} If the left mouse button was pressed.\n * @private\n */\nMapBrowserEventHandler.prototype.isMouseActionButton_ = function(pointerEvent) {\n  return pointerEvent.button === 0;\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerDown_ = function(pointerEvent) {\n  this.updateActivePointers_(pointerEvent);\n  const newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.POINTERDOWN, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n\n  this.down_ = pointerEvent;\n\n  if (this.dragListenerKeys_.length === 0) {\n    /* Set up a pointer event handler on the `document`,\n     * which is required when the pointer is moved outside\n     * the viewport when dragging.\n     */\n    this.documentPointerEventHandler_ =\n        new PointerEventHandler(document);\n\n    this.dragListenerKeys_.push(\n      listen(this.documentPointerEventHandler_,\n        MapBrowserEventType.POINTERMOVE,\n        this.handlePointerMove_, this),\n      listen(this.documentPointerEventHandler_,\n        MapBrowserEventType.POINTERUP,\n        this.handlePointerUp_, this),\n      /* Note that the listener for `pointercancel is set up on\n       * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n       * the `pointerup` and `pointermove` listeners.\n       *\n       * The reason for this is the following: `TouchSource.vacuumTouches_()`\n       * issues `pointercancel` events, when there was no `touchend` for a\n       * `touchstart`. Now, let's say a first `touchstart` is registered on\n       * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n       * But `documentPointerEventHandler_` doesn't know about the first\n       * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n       * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n       * only registered there.\n       */\n      listen(this.pointerEventHandler_,\n        MapBrowserEventType.POINTERCANCEL,\n        this.handlePointerUp_, this)\n    );\n  }\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerMove_ = function(pointerEvent) {\n  // Between pointerdown and pointerup, pointermove events are triggered.\n  // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n  // moved a significant distance.\n  if (this.isMoving_(pointerEvent)) {\n    this.dragging_ = true;\n    const newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERDRAG, this.map_, pointerEvent,\n      this.dragging_);\n    this.dispatchEvent(newEvent);\n  }\n\n  // Some native android browser triggers mousemove events during small period\n  // of time. See: https://code.google.com/p/android/issues/detail?id=5491 or\n  // https://code.google.com/p/android/issues/detail?id=19827\n  // ex: Galaxy Tab P3110 + Android 4.1.1\n  pointerEvent.preventDefault();\n};\n\n\n/**\n * Wrap and relay a pointer event.  Note that this requires that the type\n * string for the MapBrowserPointerEvent matches the PointerEvent type.\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.relayEvent_ = function(pointerEvent) {\n  const dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n  this.dispatchEvent(new MapBrowserPointerEvent(\n    pointerEvent.type, this.map_, pointerEvent, dragging));\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @return {boolean} Is moving.\n * @private\n */\nMapBrowserEventHandler.prototype.isMoving_ = function(pointerEvent) {\n  return this.dragging_ ||\n      Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ ||\n      Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;\n};\n\n\n/**\n * @inheritDoc\n */\nMapBrowserEventHandler.prototype.disposeInternal = function() {\n  if (this.relayedListenerKey_) {\n    unlistenByKey(this.relayedListenerKey_);\n    this.relayedListenerKey_ = null;\n  }\n  if (this.pointerdownListenerKey_) {\n    unlistenByKey(this.pointerdownListenerKey_);\n    this.pointerdownListenerKey_ = null;\n  }\n\n  this.dragListenerKeys_.forEach(unlistenByKey);\n  this.dragListenerKeys_.length = 0;\n\n  if (this.documentPointerEventHandler_) {\n    this.documentPointerEventHandler_.dispose();\n    this.documentPointerEventHandler_ = null;\n  }\n  if (this.pointerEventHandler_) {\n    this.pointerEventHandler_.dispose();\n    this.pointerEventHandler_ = null;\n  }\n  EventTarget.prototype.disposeInternal.call(this);\n};\nexport default MapBrowserEventHandler;\n","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend'\n\n};\n","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view'\n};\n","/**\n * @module ol/structs/PriorityQueue\n */\nimport {assert} from '../asserts.js';\nimport {clear} from '../obj.js';\n\n/**\n * Priority queue.\n *\n * The implementation is inspired from the Closure Library's Heap class and\n * Python's heapq module.\n *\n * @see http://closure-library.googlecode.com/svn/docs/closure_goog_structs_heap.js.source.html\n * @see http://hg.python.org/cpython/file/2.7/Lib/heapq.py\n *\n * @constructor\n * @param {function(T): number} priorityFunction Priority function.\n * @param {function(T): string} keyFunction Key function.\n * @struct\n * @template T\n */\nconst PriorityQueue = function(priorityFunction, keyFunction) {\n\n  /**\n   * @type {function(T): number}\n   * @private\n   */\n  this.priorityFunction_ = priorityFunction;\n\n  /**\n   * @type {function(T): string}\n   * @private\n   */\n  this.keyFunction_ = keyFunction;\n\n  /**\n   * @type {Array.<T>}\n   * @private\n   */\n  this.elements_ = [];\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.priorities_ = [];\n\n  /**\n   * @type {!Object.<string, boolean>}\n   * @private\n   */\n  this.queuedElements_ = {};\n\n};\n\n\n/**\n * @type {number}\n */\nexport const DROP = Infinity;\n\n\n/**\n * FIXME empty description for jsdoc\n */\nPriorityQueue.prototype.clear = function() {\n  this.elements_.length = 0;\n  this.priorities_.length = 0;\n  clear(this.queuedElements_);\n};\n\n\n/**\n * Remove and return the highest-priority element. O(log N).\n * @return {T} Element.\n */\nPriorityQueue.prototype.dequeue = function() {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const element = elements[0];\n  if (elements.length == 1) {\n    elements.length = 0;\n    priorities.length = 0;\n  } else {\n    elements[0] = elements.pop();\n    priorities[0] = priorities.pop();\n    this.siftUp_(0);\n  }\n  const elementKey = this.keyFunction_(element);\n  delete this.queuedElements_[elementKey];\n  return element;\n};\n\n\n/**\n * Enqueue an element. O(log N).\n * @param {T} element Element.\n * @return {boolean} The element was added to the queue.\n */\nPriorityQueue.prototype.enqueue = function(element) {\n  assert(!(this.keyFunction_(element) in this.queuedElements_),\n    31); // Tried to enqueue an `element` that was already added to the queue\n  const priority = this.priorityFunction_(element);\n  if (priority != DROP) {\n    this.elements_.push(element);\n    this.priorities_.push(priority);\n    this.queuedElements_[this.keyFunction_(element)] = true;\n    this.siftDown_(0, this.elements_.length - 1);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * @return {number} Count.\n */\nPriorityQueue.prototype.getCount = function() {\n  return this.elements_.length;\n};\n\n\n/**\n * Gets the index of the left child of the node at the given index.\n * @param {number} index The index of the node to get the left child for.\n * @return {number} The index of the left child.\n * @private\n */\nPriorityQueue.prototype.getLeftChildIndex_ = function(index) {\n  return index * 2 + 1;\n};\n\n\n/**\n * Gets the index of the right child of the node at the given index.\n * @param {number} index The index of the node to get the right child for.\n * @return {number} The index of the right child.\n * @private\n */\nPriorityQueue.prototype.getRightChildIndex_ = function(index) {\n  return index * 2 + 2;\n};\n\n\n/**\n * Gets the index of the parent of the node at the given index.\n * @param {number} index The index of the node to get the parent for.\n * @return {number} The index of the parent.\n * @private\n */\nPriorityQueue.prototype.getParentIndex_ = function(index) {\n  return (index - 1) >> 1;\n};\n\n\n/**\n * Make this a heap. O(N).\n * @private\n */\nPriorityQueue.prototype.heapify_ = function() {\n  let i;\n  for (i = (this.elements_.length >> 1) - 1; i >= 0; i--) {\n    this.siftUp_(i);\n  }\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nPriorityQueue.prototype.isEmpty = function() {\n  return this.elements_.length === 0;\n};\n\n\n/**\n * @param {string} key Key.\n * @return {boolean} Is key queued.\n */\nPriorityQueue.prototype.isKeyQueued = function(key) {\n  return key in this.queuedElements_;\n};\n\n\n/**\n * @param {T} element Element.\n * @return {boolean} Is queued.\n */\nPriorityQueue.prototype.isQueued = function(element) {\n  return this.isKeyQueued(this.keyFunction_(element));\n};\n\n\n/**\n * @param {number} index The index of the node to move down.\n * @private\n */\nPriorityQueue.prototype.siftUp_ = function(index) {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const count = elements.length;\n  const element = elements[index];\n  const priority = priorities[index];\n  const startIndex = index;\n\n  while (index < (count >> 1)) {\n    const lIndex = this.getLeftChildIndex_(index);\n    const rIndex = this.getRightChildIndex_(index);\n\n    const smallerChildIndex = rIndex < count &&\n        priorities[rIndex] < priorities[lIndex] ?\n      rIndex : lIndex;\n\n    elements[index] = elements[smallerChildIndex];\n    priorities[index] = priorities[smallerChildIndex];\n    index = smallerChildIndex;\n  }\n\n  elements[index] = element;\n  priorities[index] = priority;\n  this.siftDown_(startIndex, index);\n};\n\n\n/**\n * @param {number} startIndex The index of the root.\n * @param {number} index The index of the node to move up.\n * @private\n */\nPriorityQueue.prototype.siftDown_ = function(startIndex, index) {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const element = elements[index];\n  const priority = priorities[index];\n\n  while (index > startIndex) {\n    const parentIndex = this.getParentIndex_(index);\n    if (priorities[parentIndex] > priority) {\n      elements[index] = elements[parentIndex];\n      priorities[index] = priorities[parentIndex];\n      index = parentIndex;\n    } else {\n      break;\n    }\n  }\n  elements[index] = element;\n  priorities[index] = priority;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nPriorityQueue.prototype.reprioritize = function() {\n  const priorityFunction = this.priorityFunction_;\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  let index = 0;\n  const n = elements.length;\n  let element, i, priority;\n  for (i = 0; i < n; ++i) {\n    element = elements[i];\n    priority = priorityFunction(element);\n    if (priority == DROP) {\n      delete this.queuedElements_[this.keyFunction_(element)];\n    } else {\n      priorities[index] = priority;\n      elements[index++] = element;\n    }\n  }\n  elements.length = index;\n  priorities.length = index;\n  this.heapify_();\n};\nexport default PriorityQueue;\n","/**\n * @module ol/TileQueue\n */\nimport {inherits} from './index.js';\nimport TileState from './TileState.js';\nimport {listen, unlisten} from './events.js';\nimport EventType from './events/EventType.js';\nimport PriorityQueue from './structs/PriorityQueue.js';\n\n\n/**\n * @typedef {function(module:ol/Tile, string, module:ol/coordinate~Coordinate, number): number} PriorityFunction\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/structs/PriorityQueue.<Array>}\n * @param {module:ol/TileQueue~PriorityFunction} tilePriorityFunction\n *     Tile priority function.\n * @param {function(): ?} tileChangeCallback\n *     Function called on each tile change event.\n * @struct\n */\nconst TileQueue = function(tilePriorityFunction, tileChangeCallback) {\n\n  PriorityQueue.call(\n    this,\n    /**\n     * @param {Array} element Element.\n     * @return {number} Priority.\n     */\n    function(element) {\n      return tilePriorityFunction.apply(null, element);\n    },\n    /**\n     * @param {Array} element Element.\n     * @return {string} Key.\n     */\n    function(element) {\n      return (/** @type {module:ol/Tile} */ (element[0]).getKey());\n    });\n\n  /**\n   * @private\n   * @type {function(): ?}\n   */\n  this.tileChangeCallback_ = tileChangeCallback;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tilesLoading_ = 0;\n\n  /**\n   * @private\n   * @type {!Object.<string,boolean>}\n   */\n  this.tilesLoadingKeys_ = {};\n\n};\n\ninherits(TileQueue, PriorityQueue);\n\n\n/**\n * @inheritDoc\n */\nTileQueue.prototype.enqueue = function(element) {\n  const added = PriorityQueue.prototype.enqueue.call(this, element);\n  if (added) {\n    const tile = element[0];\n    listen(tile, EventType.CHANGE, this.handleTileChange, this);\n  }\n  return added;\n};\n\n\n/**\n * @return {number} Number of tiles loading.\n */\nTileQueue.prototype.getTilesLoading = function() {\n  return this.tilesLoading_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nTileQueue.prototype.handleTileChange = function(event) {\n  const tile = /** @type {module:ol/Tile} */ (event.target);\n  const state = tile.getState();\n  if (state === TileState.LOADED || state === TileState.ERROR ||\n      state === TileState.EMPTY || state === TileState.ABORT) {\n    unlisten(tile, EventType.CHANGE, this.handleTileChange, this);\n    const tileKey = tile.getKey();\n    if (tileKey in this.tilesLoadingKeys_) {\n      delete this.tilesLoadingKeys_[tileKey];\n      --this.tilesLoading_;\n    }\n    this.tileChangeCallback_();\n  }\n};\n\n\n/**\n * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n * @param {number} maxNewLoads Maximum number of new tiles to load.\n */\nTileQueue.prototype.loadMoreTiles = function(maxTotalLoading, maxNewLoads) {\n  let newLoads = 0;\n  let abortedTiles = false;\n  let state, tile, tileKey;\n  while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads &&\n         this.getCount() > 0) {\n    tile = /** @type {module:ol/Tile} */ (this.dequeue()[0]);\n    tileKey = tile.getKey();\n    state = tile.getState();\n    if (state === TileState.ABORT) {\n      abortedTiles = true;\n    } else if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n      this.tilesLoadingKeys_[tileKey] = true;\n      ++this.tilesLoading_;\n      ++newLoads;\n      tile.load();\n    }\n  }\n  if (newLoads === 0 && abortedTiles) {\n    // Do not stop the render loop when all wanted tiles were aborted due to\n    // a small, saturated tile cache.\n    this.tileChangeCallback_();\n  }\n};\nexport default TileQueue;\n","/**\n * @module ol/tilegrid/common\n */\n\n/**\n * Default maximum zoom for default tile grids.\n * @type {number}\n */\nexport const DEFAULT_MAX_ZOOM = 42;\n\n/**\n * Default tile size.\n * @type {number}\n */\nexport const DEFAULT_TILE_SIZE = 256;\n","/**\n * @module ol/centerconstraint\n */\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((module:ol/coordinate~Coordinate|undefined)): (module:ol/coordinate~Coordinate|undefined)} Type\n */\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/centerconstraint~Type} The constraint.\n */\nexport function createExtent(extent) {\n  return (\n    /**\n     * @param {module:ol/coordinate~Coordinate=} center Center.\n     * @return {module:ol/coordinate~Coordinate|undefined} Center.\n     */\n    function(center) {\n      if (center) {\n        return [\n          clamp(center[0], extent[0], extent[2]),\n          clamp(center[1], extent[1], extent[3])\n        ];\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate=} center Center.\n * @return {module:ol/coordinate~Coordinate|undefined} Center.\n */\nexport function none(center) {\n  return center;\n}\n","/**\n * @module ol/rotationconstraint\n */\nimport {toRadians} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number): (number|undefined)} Type\n */\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function disable(rotation, delta) {\n  if (rotation !== undefined) {\n    return 0;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function none(rotation, delta) {\n  if (rotation !== undefined) {\n    return rotation + delta;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number} n N.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createSnapToN(n) {\n  const theta = 2 * Math.PI / n;\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        rotation = Math.floor((rotation + delta) / theta + 0.5) * theta;\n        return rotation;\n      } else {\n        return undefined;\n      }\n    });\n}\n\n\n/**\n * @param {number=} opt_tolerance Tolerance.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createSnapToZero(opt_tolerance) {\n  const tolerance = opt_tolerance || toRadians(5);\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        if (Math.abs(rotation + delta) <= tolerance) {\n          return 0;\n        } else {\n          return rotation + delta;\n        }\n      } else {\n        return undefined;\n      }\n    });\n}\n","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1\n};\n","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation'\n};\n","/**\n * @module ol/View\n */\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {inherits, getUid} from './index.js';\nimport {UNDEFINED} from './functions.js';\nimport {createExtent, none as centerNone} from './centerconstraint.js';\nimport BaseObject from './Object.js';\nimport {createSnapToResolutions, createSnapToPower} from './resolutionconstraint.js';\nimport {createSnapToZero, createSnapToN, none as rotationNone, disable} from './rotationconstraint.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {linearFindNearest} from './array.js';\nimport {assert} from './asserts.js';\nimport {add as addCoordinate, rotate as rotateCoordinate, equals as coordinatesEqual} from './coordinate.js';\nimport {inAndOut} from './easing.js';\nimport {getForViewAndSize, getCenter, getHeight, getWidth, isEmpty} from './extent.js';\nimport GeometryType from './geom/GeometryType.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\nimport SimpleGeometry from './geom/SimpleGeometry.js';\nimport {clamp, modulo} from './math.js';\nimport {assign} from './obj.js';\nimport {createProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\n\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {module:ol/coordinate~Coordinate} [sourceCenter]\n * @property {module:ol/coordinate~Coordinate} [targetCenter]\n * @property {number} [sourceResolution]\n * @property {number} [targetResolution]\n * @property {number} [sourceRotation]\n * @property {number} [sourceRotation]\n * @property {module:ol/coordinate~Coordinate} [anchor]\n * @property {number} start\n * @property {number} duration\n * @property {boolean} complete\n * @property {function(number):number} easing\n * @property {function(boolean)} callback\n */\n\n\n/**\n * @typedef {Object} Constraints\n * @property {module:ol/centerconstraint~Type} center\n * @property {module:ol/resolutionconstraint~Type} resolution\n * @property {module:ol/rotationconstraint~Type} rotation\n */\n\n\n/**\n * @typedef {Object} FitOptions\n * @property {module:ol/size~Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array.<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [constrainResolution=true] Constrain the resolution.\n * @property {boolean} [nearest=false] If `constrainResolution` is `true`, get\n * the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean)} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n\n/**\n * @typedef {Object} ViewOptions\n * @property {module:ol/coordinate~Coordinate} [center] The initial center for\n * the view. The coordinate system for the center is specified with the\n * `projection` option. Layer sources will not be fetched if this is not set,\n * but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {module:ol/extent~Extent} [extent] The extent that constrains the\n * center, in other words, center cannot be set outside this extent.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array.<number>} [resolutions] Resolutions to determine the\n * resolution constraint. If set the `maxResolution`, `minResolution`,\n * `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view. The initial\n * resolution is determined using the {@link #constrainResolution} method.\n * @property {number} [zoomFactor=2] The zoom factor used to determine the\n * resolution constraint.\n */\n\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {module:ol/coordinate~Coordinate|undefined} center The center of the view at the end of\n * the animation.\n * @property {number|undefined} zoom The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number|undefined} resolution The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number|undefined} rotation The rotation of the view at the end of\n * the animation.\n * @property {module:ol/coordinate~Coordinate|undefined} anchor Optional anchor to remained fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {module:ol/coordinate~Coordinate} center\n * @property {module:ol/proj/Projection} projection\n * @property {number} resolution\n * @property {number} rotation\n * @property {number} zoom\n */\n\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nconst DEFAULT_MIN_ZOOM = 0;\n\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * ### The view states\n *\n * An View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * An View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Spherical Mercator (EPSG:3857).\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view. Any value can be passed to the setters. And the value\n * that is passed to a setter will effectively be the value set in the view,\n * and returned by the corresponding getter.\n *\n * But a View object also has a *resolution constraint*, a\n * *rotation constraint* and a *center constraint*.\n *\n * As said above, no constraints are applied when the setters are used to set\n * new states for the view. Applying constraints is done explicitly through\n * the use of the `constrain*` functions (`constrainResolution` and\n * `constrainRotation` and `constrainCenter`).\n *\n * The main users of the constraints are the interactions and the\n * controls. For example, double-clicking on the map changes the view to\n * the \"next\" resolution. And releasing the fingers after pinch-zooming\n * snaps to the closest resolution (with an animation).\n *\n * The *resolution constraint* snaps to specific resolutions. It is\n * determined by the following options: `resolutions`, `maxResolution`,\n * `maxZoom`, and `zoomFactor`. If `resolutions` is set, the other three\n * options are ignored. See documentation for each option for more\n * information.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default the rotation value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the center is not constrained at all.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/View~ViewOptions=} opt_options View options.\n * @api\n */\nconst View = function(opt_options) {\n  BaseObject.call(this);\n\n  const options = assign({}, opt_options);\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.hints_ = [0, 0];\n\n  /**\n   * @private\n   * @type {Array.<Array.<module:ol/View~Animation>>}\n   */\n  this.animations_ = [];\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.updateAnimationKey_;\n\n  this.updateAnimations_ = this.updateAnimations_.bind(this);\n\n  /**\n   * @private\n   * @const\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n  this.applyOptions_(options);\n};\n\ninherits(View, BaseObject);\n\n\n/**\n * Set up the view with the given options.\n * @param {module:ol/View~ViewOptions} options View options.\n */\nView.prototype.applyOptions_ = function(options) {\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const properties = {};\n  properties[ViewProperty.CENTER] = options.center !== undefined ?\n    options.center : null;\n\n  const resolutionConstraintInfo = createResolutionConstraint(options);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n  /**\n   * @private\n   * @type {Array.<number>|undefined}\n   */\n  this.resolutions_ = options.resolutions;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n  const centerConstraint = createCenterConstraint(options);\n  const resolutionConstraint = resolutionConstraintInfo.constraint;\n  const rotationConstraint = createRotationConstraint(options);\n\n  /**\n   * @private\n   * @type {module:ol/View~Constraints}\n   */\n  this.constraints_ = {\n    center: centerConstraint,\n    resolution: resolutionConstraint,\n    rotation: rotationConstraint\n  };\n\n  if (options.resolution !== undefined) {\n    properties[ViewProperty.RESOLUTION] = options.resolution;\n  } else if (options.zoom !== undefined) {\n    properties[ViewProperty.RESOLUTION] = this.constrainResolution(\n      this.maxResolution_, options.zoom - this.minZoom_);\n\n    if (this.resolutions_) { // in case map zoom is out of min/max zoom range\n      properties[ViewProperty.RESOLUTION] = clamp(\n        Number(this.getResolution() || properties[ViewProperty.RESOLUTION]),\n        this.minResolution_, this.maxResolution_);\n    }\n  }\n  properties[ViewProperty.ROTATION] = options.rotation !== undefined ? options.rotation : 0;\n  this.setProperties(properties);\n\n  /**\n   * @private\n   * @type {module:ol/View~ViewOptions}\n   */\n  this.options_ = options;\n\n};\n\n/**\n * Get an updated version of the view options used to construct the view.  The\n * current resolution (or zoom), center, and rotation are applied to any stored\n * options.  The provided options can be used to apply new min/max zoom or\n * resolution limits.\n * @param {module:ol/View~ViewOptions} newOptions New options to be applied.\n * @return {module:ol/View~ViewOptions} New options updated with the current view state.\n */\nView.prototype.getUpdatedOptions_ = function(newOptions) {\n  const options = assign({}, this.options_);\n\n  // preserve resolution (or zoom)\n  if (options.resolution !== undefined) {\n    options.resolution = this.getResolution();\n  } else {\n    options.zoom = this.getZoom();\n  }\n\n  // preserve center\n  options.center = this.getCenter();\n\n  // preserve rotation\n  options.rotation = this.getRotation();\n\n  return assign({}, options, newOptions);\n};\n\n\n/**\n * Animate the view.  The view's center, zoom (or resolution), and rotation\n * can be animated for smooth transitions between view states.  For example,\n * to animate the view to a new zoom level:\n *\n *     view.animate({zoom: view.getZoom() + 1});\n *\n * By default, the animation lasts one second and uses in-and-out easing.  You\n * can customize this behavior by including `duration` (in milliseconds) and\n * `easing` options (see {@link module:ol/easing}).\n *\n * To chain together multiple animations, call the method with multiple\n * animation objects.  For example, to first zoom and then pan:\n *\n *     view.animate({zoom: 10}, {center: [0, 0]});\n *\n * If you provide a function as the last argument to the animate method, it\n * will get called at the end of an animation series.  The callback will be\n * called with `true` if the animation series completed on its own or `false`\n * if it was cancelled.\n *\n * Animations are cancelled by user interactions (e.g. dragging the map) or by\n * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n * (or another method that calls one of these).\n *\n * @param {...(module:ol/View~AnimationOptions|function(boolean))} var_args Animation\n *     options.  Multiple animations can be run in series by passing multiple\n *     options objects.  To run multiple animations in parallel, call the method\n *     multiple times.  An optional callback can be provided as a final\n *     argument.  The callback will be called with a boolean indicating whether\n *     the animation completed without being cancelled.\n * @api\n */\nView.prototype.animate = function(var_args) {\n  let animationCount = arguments.length;\n  let callback;\n  if (animationCount > 1 && typeof arguments[animationCount - 1] === 'function') {\n    callback = arguments[animationCount - 1];\n    --animationCount;\n  }\n  if (!this.isDef()) {\n    // if view properties are not yet set, shortcut to the final state\n    const state = arguments[animationCount - 1];\n    if (state.center) {\n      this.setCenter(state.center);\n    }\n    if (state.zoom !== undefined) {\n      this.setZoom(state.zoom);\n    }\n    if (state.rotation !== undefined) {\n      this.setRotation(state.rotation);\n    }\n    if (callback) {\n      setTimeout(function() {\n        callback(true);\n      }, 0);\n    }\n    return;\n  }\n  let start = Date.now();\n  let center = this.getCenter().slice();\n  let resolution = this.getResolution();\n  let rotation = this.getRotation();\n  const series = [];\n  for (let i = 0; i < animationCount; ++i) {\n    const options = /** @type {module:ol/View~AnimationOptions} */ (arguments[i]);\n\n    const animation = /** @type {module:ol/View~Animation} */ ({\n      start: start,\n      complete: false,\n      anchor: options.anchor,\n      duration: options.duration !== undefined ? options.duration : 1000,\n      easing: options.easing || inAndOut\n    });\n\n    if (options.center) {\n      animation.sourceCenter = center;\n      animation.targetCenter = options.center;\n      center = animation.targetCenter;\n    }\n\n    if (options.zoom !== undefined) {\n      animation.sourceResolution = resolution;\n      animation.targetResolution = this.constrainResolution(\n        this.maxResolution_, options.zoom - this.minZoom_, 0);\n      resolution = animation.targetResolution;\n    } else if (options.resolution) {\n      animation.sourceResolution = resolution;\n      animation.targetResolution = options.resolution;\n      resolution = animation.targetResolution;\n    }\n\n    if (options.rotation !== undefined) {\n      animation.sourceRotation = rotation;\n      const delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n      animation.targetRotation = rotation + delta;\n      rotation = animation.targetRotation;\n    }\n\n    animation.callback = callback;\n\n    // check if animation is a no-op\n    if (isNoopAnimation(animation)) {\n      animation.complete = true;\n      // we still push it onto the series for callback handling\n    } else {\n      start += animation.duration;\n    }\n    series.push(animation);\n  }\n  this.animations_.push(series);\n  this.setHint(ViewHint.ANIMATING, 1);\n  this.updateAnimations_();\n};\n\n\n/**\n * Determine if the view is being animated.\n * @return {boolean} The view is being animated.\n * @api\n */\nView.prototype.getAnimating = function() {\n  return this.hints_[ViewHint.ANIMATING] > 0;\n};\n\n\n/**\n * Determine if the user is interacting with the view, such as panning or zooming.\n * @return {boolean} The view is being interacted with.\n * @api\n */\nView.prototype.getInteracting = function() {\n  return this.hints_[ViewHint.INTERACTING] > 0;\n};\n\n\n/**\n * Cancel any ongoing animations.\n * @api\n */\nView.prototype.cancelAnimations = function() {\n  this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n  for (let i = 0, ii = this.animations_.length; i < ii; ++i) {\n    const series = this.animations_[i];\n    if (series[0].callback) {\n      series[0].callback(false);\n    }\n  }\n  this.animations_.length = 0;\n};\n\n/**\n * Update all animations.\n */\nView.prototype.updateAnimations_ = function() {\n  if (this.updateAnimationKey_ !== undefined) {\n    cancelAnimationFrame(this.updateAnimationKey_);\n    this.updateAnimationKey_ = undefined;\n  }\n  if (!this.getAnimating()) {\n    return;\n  }\n  const now = Date.now();\n  let more = false;\n  for (let i = this.animations_.length - 1; i >= 0; --i) {\n    const series = this.animations_[i];\n    let seriesComplete = true;\n    for (let j = 0, jj = series.length; j < jj; ++j) {\n      const animation = series[j];\n      if (animation.complete) {\n        continue;\n      }\n      const elapsed = now - animation.start;\n      let fraction = animation.duration > 0 ? elapsed / animation.duration : 1;\n      if (fraction >= 1) {\n        animation.complete = true;\n        fraction = 1;\n      } else {\n        seriesComplete = false;\n      }\n      const progress = animation.easing(fraction);\n      if (animation.sourceCenter) {\n        const x0 = animation.sourceCenter[0];\n        const y0 = animation.sourceCenter[1];\n        const x1 = animation.targetCenter[0];\n        const y1 = animation.targetCenter[1];\n        const x = x0 + progress * (x1 - x0);\n        const y = y0 + progress * (y1 - y0);\n        this.set(ViewProperty.CENTER, [x, y]);\n      }\n      if (animation.sourceResolution && animation.targetResolution) {\n        const resolution = progress === 1 ?\n          animation.targetResolution :\n          animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);\n        if (animation.anchor) {\n          this.set(ViewProperty.CENTER,\n            this.calculateCenterZoom(resolution, animation.anchor));\n        }\n        this.set(ViewProperty.RESOLUTION, resolution);\n      }\n      if (animation.sourceRotation !== undefined && animation.targetRotation !== undefined) {\n        const rotation = progress === 1 ?\n          modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI :\n          animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);\n        if (animation.anchor) {\n          this.set(ViewProperty.CENTER,\n            this.calculateCenterRotate(rotation, animation.anchor));\n        }\n        this.set(ViewProperty.ROTATION, rotation);\n      }\n      more = true;\n      if (!animation.complete) {\n        break;\n      }\n    }\n    if (seriesComplete) {\n      this.animations_[i] = null;\n      this.setHint(ViewHint.ANIMATING, -1);\n      const callback = series[0].callback;\n      if (callback) {\n        setTimeout(function() {\n          callback(true);\n        }, 0);\n      }\n    }\n  }\n  // prune completed series\n  this.animations_ = this.animations_.filter(Boolean);\n  if (more && this.updateAnimationKey_ === undefined) {\n    this.updateAnimationKey_ = requestAnimationFrame(this.updateAnimations_);\n  }\n};\n\n/**\n * @param {number} rotation Target rotation.\n * @param {module:ol/coordinate~Coordinate} anchor Rotation anchor.\n * @return {module:ol/coordinate~Coordinate|undefined} Center for rotation and anchor.\n */\nView.prototype.calculateCenterRotate = function(rotation, anchor) {\n  let center;\n  const currentCenter = this.getCenter();\n  if (currentCenter !== undefined) {\n    center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n    rotateCoordinate(center, rotation - this.getRotation());\n    addCoordinate(center, anchor);\n  }\n  return center;\n};\n\n\n/**\n * @param {number} resolution Target resolution.\n * @param {module:ol/coordinate~Coordinate} anchor Zoom anchor.\n * @return {module:ol/coordinate~Coordinate|undefined} Center for resolution and anchor.\n */\nView.prototype.calculateCenterZoom = function(resolution, anchor) {\n  let center;\n  const currentCenter = this.getCenter();\n  const currentResolution = this.getResolution();\n  if (currentCenter !== undefined && currentResolution !== undefined) {\n    const x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;\n    const y = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;\n    center = [x, y];\n  }\n  return center;\n};\n\n\n/**\n * @private\n * @return {module:ol/size~Size} Viewport size or `[100, 100]` when no viewport is found.\n */\nView.prototype.getSizeFromViewport_ = function() {\n  const size = [100, 100];\n  const selector = '.ol-viewport[data-view=\"' + getUid(this) + '\"]';\n  const element = document.querySelector(selector);\n  if (element) {\n    const metrics = getComputedStyle(element);\n    size[0] = parseInt(metrics.width, 10);\n    size[1] = parseInt(metrics.height, 10);\n  }\n  return size;\n};\n\n\n/**\n * Get the constrained center of this view.\n * @param {module:ol/coordinate~Coordinate|undefined} center Center.\n * @return {module:ol/coordinate~Coordinate|undefined} Constrained center.\n * @api\n */\nView.prototype.constrainCenter = function(center) {\n  return this.constraints_.center(center);\n};\n\n\n/**\n * Get the constrained resolution of this view.\n * @param {number|undefined} resolution Resolution.\n * @param {number=} opt_delta Delta. Default is `0`.\n * @param {number=} opt_direction Direction. Default is `0`.\n * @return {number|undefined} Constrained resolution.\n * @api\n */\nView.prototype.constrainResolution = function(resolution, opt_delta, opt_direction) {\n  const delta = opt_delta || 0;\n  const direction = opt_direction || 0;\n  return this.constraints_.resolution(resolution, delta, direction);\n};\n\n\n/**\n * Get the constrained rotation of this view.\n * @param {number|undefined} rotation Rotation.\n * @param {number=} opt_delta Delta. Default is `0`.\n * @return {number|undefined} Constrained rotation.\n * @api\n */\nView.prototype.constrainRotation = function(rotation, opt_delta) {\n  const delta = opt_delta || 0;\n  return this.constraints_.rotation(rotation, delta);\n};\n\n\n/**\n * Get the view center.\n * @return {module:ol/coordinate~Coordinate|undefined} The center of the view.\n * @observable\n * @api\n */\nView.prototype.getCenter = function() {\n  return (\n    /** @type {module:ol/coordinate~Coordinate|undefined} */ (this.get(ViewProperty.CENTER))\n  );\n};\n\n\n/**\n * @return {module:ol/View~Constraints} Constraints.\n */\nView.prototype.getConstraints = function() {\n  return this.constraints_;\n};\n\n\n/**\n * @param {Array.<number>=} opt_hints Destination array.\n * @return {Array.<number>} Hint.\n */\nView.prototype.getHints = function(opt_hints) {\n  if (opt_hints !== undefined) {\n    opt_hints[0] = this.hints_[0];\n    opt_hints[1] = this.hints_[1];\n    return opt_hints;\n  } else {\n    return this.hints_.slice();\n  }\n};\n\n\n/**\n * Calculate the extent for the current view state and the passed size.\n * The size is the pixel dimensions of the box into which the calculated extent\n * should fit. In most cases you want to get the extent of the entire map,\n * that is `map.getSize()`.\n * @param {module:ol/size~Size=} opt_size Box pixel size. If not provided, the size of the\n * first map that uses this view will be used.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nView.prototype.calculateExtent = function(opt_size) {\n  const size = opt_size || this.getSizeFromViewport_();\n  const center = /** @type {!module:ol/coordinate~Coordinate} */ (this.getCenter());\n  assert(center, 1); // The view center is not defined\n  const resolution = /** @type {!number} */ (this.getResolution());\n  assert(resolution !== undefined, 2); // The view resolution is not defined\n  const rotation = /** @type {!number} */ (this.getRotation());\n  assert(rotation !== undefined, 3); // The view rotation is not defined\n\n  return getForViewAndSize(center, resolution, rotation, size);\n};\n\n\n/**\n * Get the maximum resolution of the view.\n * @return {number} The maximum resolution of the view.\n * @api\n */\nView.prototype.getMaxResolution = function() {\n  return this.maxResolution_;\n};\n\n\n/**\n * Get the minimum resolution of the view.\n * @return {number} The minimum resolution of the view.\n * @api\n */\nView.prototype.getMinResolution = function() {\n  return this.minResolution_;\n};\n\n\n/**\n * Get the maximum zoom level for the view.\n * @return {number} The maximum zoom level.\n * @api\n */\nView.prototype.getMaxZoom = function() {\n  return /** @type {number} */ (this.getZoomForResolution(this.minResolution_));\n};\n\n\n/**\n * Set a new maximum zoom level for the view.\n * @param {number} zoom The maximum zoom level.\n * @api\n */\nView.prototype.setMaxZoom = function(zoom) {\n  this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n};\n\n\n/**\n * Get the minimum zoom level for the view.\n * @return {number} The minimum zoom level.\n * @api\n */\nView.prototype.getMinZoom = function() {\n  return /** @type {number} */ (this.getZoomForResolution(this.maxResolution_));\n};\n\n\n/**\n * Set a new minimum zoom level for the view.\n * @param {number} zoom The minimum zoom level.\n * @api\n */\nView.prototype.setMinZoom = function(zoom) {\n  this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n};\n\n\n/**\n * Get the view projection.\n * @return {module:ol/proj/Projection} The projection of the view.\n * @api\n */\nView.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * Get the view resolution.\n * @return {number|undefined} The resolution of the view.\n * @observable\n * @api\n */\nView.prototype.getResolution = function() {\n  return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n};\n\n\n/**\n * Get the resolutions for the view. This returns the array of resolutions\n * passed to the constructor of the View, or undefined if none were given.\n * @return {Array.<number>|undefined} The resolutions of the view.\n * @api\n */\nView.prototype.getResolutions = function() {\n  return this.resolutions_;\n};\n\n\n/**\n * Get the resolution for a provided extent (in map units) and size (in pixels).\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/size~Size=} opt_size Box pixel size.\n * @return {number} The resolution at which the provided extent will render at\n *     the given size.\n * @api\n */\nView.prototype.getResolutionForExtent = function(extent, opt_size) {\n  const size = opt_size || this.getSizeFromViewport_();\n  const xResolution = getWidth(extent) / size[0];\n  const yResolution = getHeight(extent) / size[1];\n  return Math.max(xResolution, yResolution);\n};\n\n\n/**\n * Return a function that returns a value between 0 and 1 for a\n * resolution. Exponential scaling is assumed.\n * @param {number=} opt_power Power.\n * @return {function(number): number} Resolution for value function.\n */\nView.prototype.getResolutionForValueFunction = function(opt_power) {\n  const power = opt_power || 2;\n  const maxResolution = this.maxResolution_;\n  const minResolution = this.minResolution_;\n  const max = Math.log(maxResolution / minResolution) / Math.log(power);\n  return (\n    /**\n     * @param {number} value Value.\n     * @return {number} Resolution.\n     */\n    function(value) {\n      const resolution = maxResolution / Math.pow(power, value * max);\n      return resolution;\n    });\n};\n\n\n/**\n * Get the view rotation.\n * @return {number} The rotation of the view in radians.\n * @observable\n * @api\n */\nView.prototype.getRotation = function() {\n  return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n};\n\n\n/**\n * Return a function that returns a resolution for a value between\n * 0 and 1. Exponential scaling is assumed.\n * @param {number=} opt_power Power.\n * @return {function(number): number} Value for resolution function.\n */\nView.prototype.getValueForResolutionFunction = function(opt_power) {\n  const power = opt_power || 2;\n  const maxResolution = this.maxResolution_;\n  const minResolution = this.minResolution_;\n  const max = Math.log(maxResolution / minResolution) / Math.log(power);\n  return (\n    /**\n     * @param {number} resolution Resolution.\n     * @return {number} Value.\n     */\n    function(resolution) {\n      const value = (Math.log(maxResolution / resolution) / Math.log(power)) / max;\n      return value;\n    });\n};\n\n\n/**\n * @return {module:ol/View~State} View state.\n */\nView.prototype.getState = function() {\n  const center = /** @type {module:ol/coordinate~Coordinate} */ (this.getCenter());\n  const projection = this.getProjection();\n  const resolution = /** @type {number} */ (this.getResolution());\n  const rotation = this.getRotation();\n  return (\n    /** @type {module:ol/View~State} */ ({\n      center: center.slice(),\n      projection: projection !== undefined ? projection : null,\n      resolution: resolution,\n      rotation: rotation,\n      zoom: this.getZoom()\n    })\n  );\n};\n\n\n/**\n * Get the current zoom level.  If you configured your view with a resolutions\n * array (this is rare), this method may return non-integer zoom levels (so\n * the zoom level is not safe to use as an index into a resolutions array).\n * @return {number|undefined} Zoom.\n * @api\n */\nView.prototype.getZoom = function() {\n  let zoom;\n  const resolution = this.getResolution();\n  if (resolution !== undefined) {\n    zoom = this.getZoomForResolution(resolution);\n  }\n  return zoom;\n};\n\n\n/**\n * Get the zoom level for a resolution.\n * @param {number} resolution The resolution.\n * @return {number|undefined} The zoom level for the provided resolution.\n * @api\n */\nView.prototype.getZoomForResolution = function(resolution) {\n  let offset = this.minZoom_ || 0;\n  let max, zoomFactor;\n  if (this.resolutions_) {\n    const nearest = linearFindNearest(this.resolutions_, resolution, 1);\n    offset = nearest;\n    max = this.resolutions_[nearest];\n    if (nearest == this.resolutions_.length - 1) {\n      zoomFactor = 2;\n    } else {\n      zoomFactor = max / this.resolutions_[nearest + 1];\n    }\n  } else {\n    max = this.maxResolution_;\n    zoomFactor = this.zoomFactor_;\n  }\n  return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n};\n\n\n/**\n * Get the resolution for a zoom level.\n * @param {number} zoom Zoom level.\n * @return {number} The view resolution for the provided zoom level.\n * @api\n */\nView.prototype.getResolutionForZoom = function(zoom) {\n  return /** @type {number} */ (this.constrainResolution(\n    this.maxResolution_, zoom - this.minZoom_, 0));\n};\n\n\n/**\n * Fit the given geometry or extent based on the given map size and border.\n * The size is pixel dimensions of the box to fit the extent into.\n * In most cases you will want to use the map size, that is `map.getSize()`.\n * Takes care of the map angle.\n * @param {module:ol/geom/SimpleGeometry|module:ol/extent~Extent} geometryOrExtent The geometry or\n *     extent to fit the view to.\n * @param {module:ol/View~FitOptions=} opt_options Options.\n * @api\n */\nView.prototype.fit = function(geometryOrExtent, opt_options) {\n  const options = opt_options || {};\n  let size = options.size;\n  if (!size) {\n    size = this.getSizeFromViewport_();\n  }\n  /** @type {module:ol/geom/SimpleGeometry} */\n  let geometry;\n  if (!(geometryOrExtent instanceof SimpleGeometry)) {\n    assert(Array.isArray(geometryOrExtent),\n      24); // Invalid extent or geometry provided as `geometry`\n    assert(!isEmpty(geometryOrExtent),\n      25); // Cannot fit empty extent provided as `geometry`\n    geometry = polygonFromExtent(geometryOrExtent);\n  } else if (geometryOrExtent.getType() === GeometryType.CIRCLE) {\n    geometryOrExtent = geometryOrExtent.getExtent();\n    geometry = polygonFromExtent(geometryOrExtent);\n    geometry.rotate(this.getRotation(), getCenter(geometryOrExtent));\n  } else {\n    geometry = geometryOrExtent;\n  }\n\n  const padding = options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n  const constrainResolution = options.constrainResolution !== undefined ?\n    options.constrainResolution : true;\n  const nearest = options.nearest !== undefined ? options.nearest : false;\n  let minResolution;\n  if (options.minResolution !== undefined) {\n    minResolution = options.minResolution;\n  } else if (options.maxZoom !== undefined) {\n    minResolution = this.constrainResolution(\n      this.maxResolution_, options.maxZoom - this.minZoom_, 0);\n  } else {\n    minResolution = 0;\n  }\n  const coords = geometry.getFlatCoordinates();\n\n  // calculate rotated extent\n  const rotation = this.getRotation();\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let minRotX = +Infinity;\n  let minRotY = +Infinity;\n  let maxRotX = -Infinity;\n  let maxRotY = -Infinity;\n  const stride = geometry.getStride();\n  for (let i = 0, ii = coords.length; i < ii; i += stride) {\n    const rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n    const rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n    minRotX = Math.min(minRotX, rotX);\n    minRotY = Math.min(minRotY, rotY);\n    maxRotX = Math.max(maxRotX, rotX);\n    maxRotY = Math.max(maxRotY, rotY);\n  }\n\n  // calculate resolution\n  let resolution = this.getResolutionForExtent(\n    [minRotX, minRotY, maxRotX, maxRotY],\n    [size[0] - padding[1] - padding[3], size[1] - padding[0] - padding[2]]);\n  resolution = isNaN(resolution) ? minResolution :\n    Math.max(resolution, minResolution);\n  if (constrainResolution) {\n    let constrainedResolution = this.constrainResolution(resolution, 0, 0);\n    if (!nearest && constrainedResolution < resolution) {\n      constrainedResolution = this.constrainResolution(\n        constrainedResolution, -1, 0);\n    }\n    resolution = constrainedResolution;\n  }\n\n  // calculate center\n  sinAngle = -sinAngle; // go back to original rotation\n  let centerRotX = (minRotX + maxRotX) / 2;\n  let centerRotY = (minRotY + maxRotY) / 2;\n  centerRotX += (padding[1] - padding[3]) / 2 * resolution;\n  centerRotY += (padding[0] - padding[2]) / 2 * resolution;\n  const centerX = centerRotX * cosAngle - centerRotY * sinAngle;\n  const centerY = centerRotY * cosAngle + centerRotX * sinAngle;\n  const center = [centerX, centerY];\n  const callback = options.callback ? options.callback : UNDEFINED;\n\n  if (options.duration !== undefined) {\n    this.animate({\n      resolution: resolution,\n      center: center,\n      duration: options.duration,\n      easing: options.easing\n    }, callback);\n  } else {\n    this.setResolution(resolution);\n    this.setCenter(center);\n    setTimeout(callback.bind(undefined, true), 0);\n  }\n};\n\n\n/**\n * Center on coordinate and view position.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/size~Size} size Box pixel size.\n * @param {module:ol~Pixel} position Position on the view to center on.\n * @api\n */\nView.prototype.centerOn = function(coordinate, size, position) {\n  // calculate rotated position\n  const rotation = this.getRotation();\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  let rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  const resolution = this.getResolution();\n  rotX += (size[0] / 2 - position[0]) * resolution;\n  rotY += (position[1] - size[1] / 2) * resolution;\n\n  // go back to original angle\n  sinAngle = -sinAngle; // go back to original rotation\n  const centerX = rotX * cosAngle - rotY * sinAngle;\n  const centerY = rotY * cosAngle + rotX * sinAngle;\n\n  this.setCenter([centerX, centerY]);\n};\n\n\n/**\n * @return {boolean} Is defined.\n */\nView.prototype.isDef = function() {\n  return !!this.getCenter() && this.getResolution() !== undefined;\n};\n\n\n/**\n * Rotate the view around a given coordinate.\n * @param {number} rotation New rotation value for the view.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor The rotation center.\n * @api\n */\nView.prototype.rotate = function(rotation, opt_anchor) {\n  if (opt_anchor !== undefined) {\n    const center = this.calculateCenterRotate(rotation, opt_anchor);\n    this.setCenter(center);\n  }\n  this.setRotation(rotation);\n};\n\n\n/**\n * Set the center of the current view.\n * @param {module:ol/coordinate~Coordinate|undefined} center The center of the view.\n * @observable\n * @api\n */\nView.prototype.setCenter = function(center) {\n  this.set(ViewProperty.CENTER, center);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * @param {module:ol/ViewHint} hint Hint.\n * @param {number} delta Delta.\n * @return {number} New value.\n */\nView.prototype.setHint = function(hint, delta) {\n  this.hints_[hint] += delta;\n  this.changed();\n  return this.hints_[hint];\n};\n\n\n/**\n * Set the resolution for this view.\n * @param {number|undefined} resolution The resolution of the view.\n * @observable\n * @api\n */\nView.prototype.setResolution = function(resolution) {\n  this.set(ViewProperty.RESOLUTION, resolution);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * Set the rotation for this view.\n * @param {number} rotation The rotation of the view in radians.\n * @observable\n * @api\n */\nView.prototype.setRotation = function(rotation) {\n  this.set(ViewProperty.ROTATION, rotation);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * Zoom to a specific zoom level.\n * @param {number} zoom Zoom level.\n * @api\n */\nView.prototype.setZoom = function(zoom) {\n  this.setResolution(this.getResolutionForZoom(zoom));\n};\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {module:ol/centerconstraint~Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    return createExtent(options.extent);\n  } else {\n    return centerNone;\n  }\n}\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {{constraint: module:ol/resolutionconstraint~Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  let resolutionConstraint;\n  let maxResolution;\n  let minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  const defaultMaxZoom = 28;\n  const defaultZoomFactor = 2;\n\n  let minZoom = options.minZoom !== undefined ?\n    options.minZoom : DEFAULT_MIN_ZOOM;\n\n  let maxZoom = options.maxZoom !== undefined ?\n    options.maxZoom : defaultMaxZoom;\n\n  const zoomFactor = options.zoomFactor !== undefined ?\n    options.zoomFactor : defaultZoomFactor;\n\n  if (options.resolutions !== undefined) {\n    const resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution = resolutions[maxZoom] !== undefined ?\n      resolutions[maxZoom] : resolutions[resolutions.length - 1];\n    resolutionConstraint = createSnapToResolutions(\n      resolutions);\n  } else {\n    // calculate the default min and max resolution\n    const projection = createProjection(options.projection, 'EPSG:3857');\n    const extent = projection.getExtent();\n    const size = !extent ?\n      // use an extent that can fit the whole world if need be\n      360 * METERS_PER_UNIT[Units.DEGREES] /\n            projection.getMetersPerUnit() :\n      Math.max(getWidth(extent), getHeight(extent));\n\n    const defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(\n      defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    const defaultMinResolution = defaultMaxResolution / Math.pow(\n      defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom = minZoom + Math.floor(\n      Math.log(maxResolution / minResolution) / Math.log(zoomFactor));\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    resolutionConstraint = createSnapToPower(\n      zoomFactor, maxResolution, maxZoom - minZoom);\n  }\n  return {constraint: resolutionConstraint, maxResolution: maxResolution,\n    minResolution: minResolution, minZoom: minZoom, zoomFactor: zoomFactor};\n}\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  const enableRotation = options.enableRotation !== undefined ?\n    options.enableRotation : true;\n  if (enableRotation) {\n    const constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    } else {\n      return rotationNone;\n    }\n  } else {\n    return disable;\n  }\n}\n\n\n/**\n * Determine if an animation involves no view change.\n * @param {module:ol/View~Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\nexport default View;\n","/**\n * @module ol/resolutionconstraint\n */\nimport {linearFindNearest} from './array.js';\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number, number): (number|undefined)} Type\n */\n\n\n/**\n * @param {Array.<number>} resolutions Resolutions.\n * @return {module:ol/resolutionconstraint~Type} Zoom function.\n */\nexport function createSnapToResolutions(resolutions) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        let z = linearFindNearest(resolutions, resolution, direction);\n        z = clamp(z + delta, 0, resolutions.length - 1);\n        const index = Math.floor(z);\n        if (z != index && index < resolutions.length - 1) {\n          const power = resolutions[index] / resolutions[index + 1];\n          return resolutions[index] / Math.pow(power, z - index);\n        } else {\n          return resolutions[index];\n        }\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {number} power Power.\n * @param {number} maxResolution Maximum resolution.\n * @param {number=} opt_maxLevel Maximum level.\n * @return {module:ol/resolutionconstraint~Type} Zoom function.\n */\nexport function createSnapToPower(power, maxResolution, opt_maxLevel) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        const offset = -direction / 2 + 0.5;\n        const oldLevel = Math.floor(\n          Math.log(maxResolution / resolution) / Math.log(power) + offset);\n        let newLevel = Math.max(oldLevel + delta, 0);\n        if (opt_maxLevel !== undefined) {\n          newLevel = Math.min(newLevel, opt_maxLevel);\n        }\n        return maxResolution / Math.pow(power, newLevel);\n      } else {\n        return undefined;\n      }\n    });\n}\n","/**\n * @module ol/layer/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  OPACITY: 'opacity',\n  VISIBLE: 'visible',\n  EXTENT: 'extent',\n  Z_INDEX: 'zIndex',\n  MAX_RESOLUTION: 'maxResolution',\n  MIN_RESOLUTION: 'minResolution',\n  SOURCE: 'source'\n};\n","/**\n * @module ol/layer/Base\n */\nimport {inherits} from '../index.js';\nimport BaseObject from '../Object.js';\nimport LayerProperty from '../layer/Property.js';\nimport {clamp} from '../math.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Note that with {@link module:ol/layer/Base} and all its subclasses, any property set in\n * the options is set as a {@link module:ol/Object} property on the layer object, so\n * is observable, and has get/set accessors.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @param {module:ol/layer/Base~Options} options Layer options.\n * @api\n */\nconst BaseLayer = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const properties = assign({}, options);\n  properties[LayerProperty.OPACITY] =\n      options.opacity !== undefined ? options.opacity : 1;\n  properties[LayerProperty.VISIBLE] =\n      options.visible !== undefined ? options.visible : true;\n  properties[LayerProperty.Z_INDEX] =\n      options.zIndex !== undefined ? options.zIndex : 0;\n  properties[LayerProperty.MAX_RESOLUTION] =\n      options.maxResolution !== undefined ? options.maxResolution : Infinity;\n  properties[LayerProperty.MIN_RESOLUTION] =\n      options.minResolution !== undefined ? options.minResolution : 0;\n\n  this.setProperties(properties);\n\n  /**\n   * @type {module:ol/layer/Layer~State}\n   * @private\n   */\n  this.state_ = /** @type {module:ol/layer/Layer~State} */ ({\n    layer: /** @type {module:ol/layer/Layer} */ (this),\n    managed: true\n  });\n\n  /**\n   * The layer type.\n   * @type {module:ol/LayerType}\n   * @protected;\n   */\n  this.type;\n\n};\n\ninherits(BaseLayer, BaseObject);\n\n\n/**\n * Get the layer type (used when creating a layer renderer).\n * @return {module:ol/LayerType} The layer type.\n */\nBaseLayer.prototype.getType = function() {\n  return this.type;\n};\n\n\n/**\n * @return {module:ol/layer/Layer~State} Layer state.\n */\nBaseLayer.prototype.getLayerState = function() {\n  this.state_.opacity = clamp(this.getOpacity(), 0, 1);\n  this.state_.sourceState = this.getSourceState();\n  this.state_.visible = this.getVisible();\n  this.state_.extent = this.getExtent();\n  this.state_.zIndex = this.getZIndex();\n  this.state_.maxResolution = this.getMaxResolution();\n  this.state_.minResolution = Math.max(this.getMinResolution(), 0);\n\n  return this.state_;\n};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/layer/Layer>=} opt_array Array of layers (to be\n *     modified in place).\n * @return {Array.<module:ol/layer/Layer>} Array of layers.\n */\nBaseLayer.prototype.getLayersArray = function(opt_array) {};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/layer/Layer~State>=} opt_states Optional list of layer\n *     states (to be modified in place).\n * @return {Array.<module:ol/layer/Layer~State>} List of layer states.\n */\nBaseLayer.prototype.getLayerStatesArray = function(opt_states) {};\n\n\n/**\n * Return the {@link module:ol/extent~Extent extent} of the layer or `undefined` if it\n * will be visible regardless of extent.\n * @return {module:ol/extent~Extent|undefined} The layer extent.\n * @observable\n * @api\n */\nBaseLayer.prototype.getExtent = function() {\n  return (\n    /** @type {module:ol/extent~Extent|undefined} */ (this.get(LayerProperty.EXTENT))\n  );\n};\n\n\n/**\n * Return the maximum resolution of the layer.\n * @return {number} The maximum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getMaxResolution = function() {\n  return /** @type {number} */ (this.get(LayerProperty.MAX_RESOLUTION));\n};\n\n\n/**\n * Return the minimum resolution of the layer.\n * @return {number} The minimum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getMinResolution = function() {\n  return /** @type {number} */ (this.get(LayerProperty.MIN_RESOLUTION));\n};\n\n\n/**\n * Return the opacity of the layer (between 0 and 1).\n * @return {number} The opacity of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getOpacity = function() {\n  return /** @type {number} */ (this.get(LayerProperty.OPACITY));\n};\n\n\n/**\n * @abstract\n * @return {module:ol/source/State} Source state.\n */\nBaseLayer.prototype.getSourceState = function() {};\n\n\n/**\n * Return the visibility of the layer (`true` or `false`).\n * @return {boolean} The visibility of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getVisible = function() {\n  return /** @type {boolean} */ (this.get(LayerProperty.VISIBLE));\n};\n\n\n/**\n * Return the Z-index of the layer, which is used to order layers before\n * rendering. The default Z-index is 0.\n * @return {number} The Z-index of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getZIndex = function() {\n  return /** @type {number} */ (this.get(LayerProperty.Z_INDEX));\n};\n\n\n/**\n * Set the extent at which the layer is visible.  If `undefined`, the layer\n * will be visible at all extents.\n * @param {module:ol/extent~Extent|undefined} extent The extent of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setExtent = function(extent) {\n  this.set(LayerProperty.EXTENT, extent);\n};\n\n\n/**\n * Set the maximum resolution at which the layer is visible.\n * @param {number} maxResolution The maximum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setMaxResolution = function(maxResolution) {\n  this.set(LayerProperty.MAX_RESOLUTION, maxResolution);\n};\n\n\n/**\n * Set the minimum resolution at which the layer is visible.\n * @param {number} minResolution The minimum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setMinResolution = function(minResolution) {\n  this.set(LayerProperty.MIN_RESOLUTION, minResolution);\n};\n\n\n/**\n * Set the opacity of the layer, allowed values range from 0 to 1.\n * @param {number} opacity The opacity of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setOpacity = function(opacity) {\n  this.set(LayerProperty.OPACITY, opacity);\n};\n\n\n/**\n * Set the visibility of the layer (`true` or `false`).\n * @param {boolean} visible The visibility of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setVisible = function(visible) {\n  this.set(LayerProperty.VISIBLE, visible);\n};\n\n\n/**\n * Set Z-index of the layer, which is used to order layers before rendering.\n * The default Z-index is 0.\n * @param {number} zindex The z-index of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setZIndex = function(zindex) {\n  this.set(LayerProperty.Z_INDEX, zindex);\n};\nexport default BaseLayer;\n","/**\n * @module ol/source/State\n */\n\n/**\n * State of the source, one of 'undefined', 'loading', 'ready' or 'error'.\n * @enum {string}\n */\nexport default {\n  UNDEFINED: 'undefined',\n  LOADING: 'loading',\n  READY: 'ready',\n  ERROR: 'error'\n};\n","/**\n * @module ol/layer/Group\n */\nimport {getUid, inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {getChangeEventType} from '../Object.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getIntersection} from '../extent.js';\nimport BaseLayer from '../layer/Base.js';\nimport {assign, clear} from '../obj.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {(Array.<module:ol/layer/Base>|module:ol/Collection.<module:ol/layer/Base>)} [layers] Child layers.\n */\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LAYERS: 'layers'\n};\n\n\n/**\n * @classdesc\n * A {@link module:ol/Collection~Collection} of layers that are handled together.\n *\n * A generic `change` event is triggered when the group/Collection changes.\n *\n * @constructor\n * @extends {module:ol/layer/Base}\n * @param {module:ol/layer/Group~Options=} opt_options Layer options.\n * @api\n */\nconst LayerGroup = function(opt_options) {\n\n  const options = opt_options || {};\n  const baseOptions = /** @type {module:ol/layer/Group~Options} */ (assign({}, options));\n  delete baseOptions.layers;\n\n  let layers = options.layers;\n\n  BaseLayer.call(this, baseOptions);\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.layersListenerKeys_ = [];\n\n  /**\n   * @private\n   * @type {Object.<string, Array.<module:ol/events~EventsKey>>}\n   */\n  this.listenerKeys_ = {};\n\n  listen(this,\n    getChangeEventType(Property.LAYERS),\n    this.handleLayersChanged_, this);\n\n  if (layers) {\n    if (Array.isArray(layers)) {\n      layers = new Collection(layers.slice(), {unique: true});\n    } else {\n      assert(layers instanceof Collection,\n        43); // Expected `layers` to be an array or a `Collection`\n      layers = layers;\n    }\n  } else {\n    layers = new Collection(undefined, {unique: true});\n  }\n\n  this.setLayers(layers);\n\n};\n\ninherits(LayerGroup, BaseLayer);\n\n\n/**\n * @private\n */\nLayerGroup.prototype.handleLayerChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @private\n */\nLayerGroup.prototype.handleLayersChanged_ = function(event) {\n  this.layersListenerKeys_.forEach(unlistenByKey);\n  this.layersListenerKeys_.length = 0;\n\n  const layers = this.getLayers();\n  this.layersListenerKeys_.push(\n    listen(layers, CollectionEventType.ADD, this.handleLayersAdd_, this),\n    listen(layers, CollectionEventType.REMOVE, this.handleLayersRemove_, this)\n  );\n\n  for (const id in this.listenerKeys_) {\n    this.listenerKeys_[id].forEach(unlistenByKey);\n  }\n  clear(this.listenerKeys_);\n\n  const layersArray = layers.getArray();\n  for (let i = 0, ii = layersArray.length; i < ii; i++) {\n    const layer = layersArray[i];\n    this.listenerKeys_[getUid(layer).toString()] = [\n      listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n      listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n    ];\n  }\n\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} collectionEvent CollectionEvent.\n * @private\n */\nLayerGroup.prototype.handleLayersAdd_ = function(collectionEvent) {\n  const layer = /** @type {module:ol/layer/Base} */ (collectionEvent.element);\n  const key = getUid(layer).toString();\n  this.listenerKeys_[key] = [\n    listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n    listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n  ];\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} collectionEvent CollectionEvent.\n * @private\n */\nLayerGroup.prototype.handleLayersRemove_ = function(collectionEvent) {\n  const layer = /** @type {module:ol/layer/Base} */ (collectionEvent.element);\n  const key = getUid(layer).toString();\n  this.listenerKeys_[key].forEach(unlistenByKey);\n  delete this.listenerKeys_[key];\n  this.changed();\n};\n\n\n/**\n * Returns the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n * in this group.\n * @return {!module:ol/Collection.<module:ol/layer/Base>} Collection of\n *   {@link module:ol/layer/Base layers} that are part of this group.\n * @observable\n * @api\n */\nLayerGroup.prototype.getLayers = function() {\n  return (\n    /** @type {!module:ol/Collection.<module:ol/layer/Base>} */ (this.get(Property.LAYERS))\n  );\n};\n\n\n/**\n * Set the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n * in this group.\n * @param {!module:ol/Collection.<module:ol/layer/Base>} layers Collection of\n *   {@link module:ol/layer/Base layers} that are part of this group.\n * @observable\n * @api\n */\nLayerGroup.prototype.setLayers = function(layers) {\n  this.set(Property.LAYERS, layers);\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getLayersArray = function(opt_array) {\n  const array = opt_array !== undefined ? opt_array : [];\n  this.getLayers().forEach(function(layer) {\n    layer.getLayersArray(array);\n  });\n  return array;\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getLayerStatesArray = function(opt_states) {\n  const states = opt_states !== undefined ? opt_states : [];\n\n  const pos = states.length;\n\n  this.getLayers().forEach(function(layer) {\n    layer.getLayerStatesArray(states);\n  });\n\n  const ownLayerState = this.getLayerState();\n  for (let i = pos, ii = states.length; i < ii; i++) {\n    const layerState = states[i];\n    layerState.opacity *= ownLayerState.opacity;\n    layerState.visible = layerState.visible && ownLayerState.visible;\n    layerState.maxResolution = Math.min(\n      layerState.maxResolution, ownLayerState.maxResolution);\n    layerState.minResolution = Math.max(\n      layerState.minResolution, ownLayerState.minResolution);\n    if (ownLayerState.extent !== undefined) {\n      if (layerState.extent !== undefined) {\n        layerState.extent = getIntersection(layerState.extent, ownLayerState.extent);\n      } else {\n        layerState.extent = ownLayerState.extent;\n      }\n    }\n  }\n\n  return states;\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getSourceState = function() {\n  return SourceState.READY;\n};\n\nexport default LayerGroup;\n","/**\n * @module ol/size\n */\n\n\n/**\n * An array of numbers representing a size: `[width, height]`.\n * @typedef {Array.<number>} Size\n * @api\n */\n\n\n/**\n * Returns a buffered size.\n * @param {module:ol/size~Size} size Size.\n * @param {number} num The amount by which to buffer.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} The buffered size.\n */\nexport function buffer(size, num, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = size[0] + 2 * num;\n  opt_size[1] = size[1] + 2 * num;\n  return opt_size;\n}\n\n\n/**\n * Determines if a size has a positive area.\n * @param {module:ol/size~Size} size The size to test.\n * @return {boolean} The size has a positive area.\n */\nexport function hasArea(size) {\n  return size[0] > 0 && size[1] > 0;\n}\n\n\n/**\n * Returns a size scaled by a ratio. The result will be an array of integers.\n * @param {module:ol/size~Size} size Size.\n * @param {number} ratio Ratio.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} The scaled size.\n */\nexport function scale(size, ratio, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = (size[0] * ratio + 0.5) | 0;\n  opt_size[1] = (size[1] * ratio + 0.5) | 0;\n  return opt_size;\n}\n\n\n/**\n * Returns an `module:ol/size~Size` array for the passed in number (meaning: square) or\n * `module:ol/size~Size` array.\n * (meaning: non-square),\n * @param {number|module:ol/size~Size} size Width and height.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} Size.\n * @api\n */\nexport function toSize(size, opt_size) {\n  if (Array.isArray(size)) {\n    return size;\n  } else {\n    if (opt_size === undefined) {\n      opt_size = [size, size];\n    } else {\n      opt_size[0] = opt_size[1] = /** @type {number} */ (size);\n    }\n    return opt_size;\n  }\n}\n","/**\n * @module ol/PluggableMap\n */\nimport {getUid, inherits} from './index.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport TileQueue from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {assert} from './asserts.js';\nimport {removeNode} from './dom.js';\nimport {listen, unlistenByKey, unlisten} from './events.js';\nimport {stopPropagation} from './events/Event.js';\nimport EventType from './events/EventType.js';\nimport {createEmpty, clone, createOrUpdateEmpty, equals, getForViewAndSize, isEmpty} from './extent.js';\nimport {TRUE} from './functions.js';\nimport {DEVICE_PIXEL_RATIO, TOUCH} from './has.js';\nimport LayerGroup from './layer/Group.js';\nimport {hasArea} from './size.js';\nimport {DROP} from './structs/PriorityQueue.js';\nimport {create as createTransform, apply as applyTransform} from './transform.js';\n\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {module:ol/View~State} viewState The state of the current view.\n * @property {boolean} animate\n * @property {module:ol/transform~Transform} coordinateToPixelTransform\n * @property {null|module:ol/extent~Extent} extent\n * @property {module:ol/coordinate~Coordinate} focus\n * @property {number} index\n * @property {Object.<number, module:ol/layer/Layer~State>} layerStates\n * @property {Array.<module:ol/layer/Layer~State>} layerStatesArray\n * @property {module:ol/transform~Transform} pixelToCoordinateTransform\n * @property {Array.<module:ol/PluggableMap~PostRenderFunction>} postRenderFunctions\n * @property {module:ol/size~Size} size\n * @property {!Object.<string, boolean>} skippedFeatureUids\n * @property {module:ol/TileQueue} tileQueue\n * @property {Object.<string, Object.<string, module:ol/TileRange>>} usedTiles\n * @property {Array.<number>} viewHints\n * @property {!Object.<string, Object.<string, boolean>>} wantedTiles\n */\n\n\n/**\n * @typedef {function(module:ol/PluggableMap, ?module:ol/PluggableMap~FrameState): boolean} PostRenderFunction\n */\n\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {((function(module:ol/layer/Layer): boolean)|undefined)} layerFilter Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in pixels. Pixels\n * inside the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {module:ol/Collection.<module:ol/control/Control>} [controls]\n * @property {module:ol/Collection.<module:ol/interaction/Interaction>} [interactions]\n * @property {Element|Document} keyboardEventTarget\n * @property {module:ol/Collection.<module:ol/Overlay>} overlays\n * @property {Object.<string, *>} values\n */\n\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {module:ol/Collection.<module:ol/control/Control>|Array.<module:ol/control/Control>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control/util~defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {module:ol/Collection.<module:ol/interaction/Interaction>|Array.<module:ol/interaction/Interaction>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction~defaults} is used.\n * @property {Element|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array.<module:ol/layer/Base>|module:ol/Collection.<module:ol/layer/Base>} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {boolean} [loadTilesWhileAnimating=false] When set to `true`, tiles\n * will be loaded during animations. This may improve the user experience, but\n * can also make animations stutter on devices with slow memory.\n * @property {boolean} [loadTilesWhileInteracting=false] When set to `true`,\n * tiles will be loaded while interacting with the map. This may improve the\n * user experience, but can also make map panning and zooming choppy on devices\n * with slow memory.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {module:ol/Collection.<module:ol/Overlay>|Array.<module:ol/Overlay>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {Element|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered.\n * @property {module:ol/View} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst PluggableMap = function(options) {\n\n  BaseObject.call(this);\n\n  const optionsInternal = createOptionsInternal(options);\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxTilesLoading_ = options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.loadTilesWhileAnimating_ =\n      options.loadTilesWhileAnimating !== undefined ?\n        options.loadTilesWhileAnimating : false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.loadTilesWhileInteracting_ =\n      options.loadTilesWhileInteracting !== undefined ?\n        options.loadTilesWhileInteracting : false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = options.pixelRatio !== undefined ?\n    options.pixelRatio : DEVICE_PIXEL_RATIO;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.animationDelayKey_;\n\n  /**\n   * @private\n   */\n  this.animationDelay_ = function() {\n    this.animationDelayKey_ = undefined;\n    this.renderFrame_.call(this, Date.now());\n  }.bind(this);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.coordinateToPixelTransform_ = createTransform();\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.pixelToCoordinateTransform_ = createTransform();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.frameIndex_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/PluggableMap~FrameState}\n   */\n  this.frameState_ = null;\n\n  /**\n   * The extent at the previous 'moveend' event.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.previousExtent_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.viewPropertyListenerKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.viewChangeListenerKey_ = null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.layerGroupPropertyListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.viewport_ = document.createElement('DIV');\n  this.viewport_.className = 'ol-viewport' + (TOUCH ? ' ol-touch' : '');\n  this.viewport_.style.position = 'relative';\n  this.viewport_.style.overflow = 'hidden';\n  this.viewport_.style.width = '100%';\n  this.viewport_.style.height = '100%';\n  // prevent page zoom on IE >= 10 browsers\n  this.viewport_.style.msTouchAction = 'none';\n  this.viewport_.style.touchAction = 'none';\n\n  /**\n   * @private\n   * @type {!Element}\n   */\n  this.overlayContainer_ = document.createElement('DIV');\n  this.overlayContainer_.className = 'ol-overlaycontainer';\n  this.viewport_.appendChild(this.overlayContainer_);\n\n  /**\n   * @private\n   * @type {!Element}\n   */\n  this.overlayContainerStopEvent_ = document.createElement('DIV');\n  this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n  const overlayEvents = [\n    EventType.CLICK,\n    EventType.DBLCLICK,\n    EventType.MOUSEDOWN,\n    EventType.TOUCHSTART,\n    EventType.MSPOINTERDOWN,\n    MapBrowserEventType.POINTERDOWN,\n    EventType.MOUSEWHEEL,\n    EventType.WHEEL\n  ];\n  for (let i = 0, ii = overlayEvents.length; i < ii; ++i) {\n    listen(this.overlayContainerStopEvent_, overlayEvents[i], stopPropagation);\n  }\n  this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n  /**\n   * @private\n   * @type {module:ol/MapBrowserEventHandler}\n   */\n  this.mapBrowserEventHandler_ = new MapBrowserEventHandler(this, options.moveTolerance);\n  for (const key in MapBrowserEventType) {\n    listen(this.mapBrowserEventHandler_, MapBrowserEventType[key],\n      this.handleMapBrowserEvent, this);\n  }\n\n  /**\n   * @private\n   * @type {Element|Document}\n   */\n  this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.keyHandlerKeys_ = null;\n\n  listen(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n  listen(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n  listen(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n\n  /**\n   * @type {module:ol/Collection.<module:ol/control/Control>}\n   * @protected\n   */\n  this.controls = optionsInternal.controls || new Collection();\n\n  /**\n   * @type {module:ol/Collection.<module:ol/interaction/Interaction>}\n   * @protected\n   */\n  this.interactions = optionsInternal.interactions || new Collection();\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Overlay>}\n   * @private\n   */\n  this.overlays_ = optionsInternal.overlays;\n\n  /**\n   * A lookup of overlays by id.\n   * @private\n   * @type {Object.<string, module:ol/Overlay>}\n   */\n  this.overlayIdIndex_ = {};\n\n  /**\n   * @type {module:ol/renderer/Map}\n   * @private\n   */\n  this.renderer_ = this.createRenderer();\n\n  /**\n   * @type {function(Event)|undefined}\n   * @private\n   */\n  this.handleResize_;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.focus_ = null;\n\n  /**\n   * @private\n   * @type {!Array.<module:ol/PluggableMap~PostRenderFunction>}\n   */\n  this.postRenderFunctions_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/TileQueue}\n   */\n  this.tileQueue_ = new TileQueue(\n    this.getTilePriority.bind(this),\n    this.handleTileChange_.bind(this));\n\n  /**\n   * Uids of features to skip at rendering time.\n   * @type {Object.<string, boolean>}\n   * @private\n   */\n  this.skippedFeatureUids_ = {};\n\n  listen(\n    this, getChangeEventType(MapProperty.LAYERGROUP),\n    this.handleLayerGroupChanged_, this);\n  listen(this, getChangeEventType(MapProperty.VIEW),\n    this.handleViewChanged_, this);\n  listen(this, getChangeEventType(MapProperty.SIZE),\n    this.handleSizeChanged_, this);\n  listen(this, getChangeEventType(MapProperty.TARGET),\n    this.handleTargetChanged_, this);\n\n  // setProperties will trigger the rendering of the map if the map\n  // is \"defined\" already.\n  this.setProperties(optionsInternal.values);\n\n  this.controls.forEach(\n    /**\n     * @param {module:ol/control/Control} control Control.\n     * @this {module:ol/PluggableMap}\n     */\n    (function(control) {\n      control.setMap(this);\n    }).bind(this));\n\n  listen(this.controls, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(this);\n    }, this);\n\n  listen(this.controls, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(null);\n    }, this);\n\n  this.interactions.forEach(\n    /**\n     * @param {module:ol/interaction/Interaction} interaction Interaction.\n     * @this {module:ol/PluggableMap}\n     */\n    (function(interaction) {\n      interaction.setMap(this);\n    }).bind(this));\n\n  listen(this.interactions, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(this);\n    }, this);\n\n  listen(this.interactions, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(null);\n    }, this);\n\n  this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n\n  listen(this.overlays_, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      this.addOverlayInternal_(/** @type {module:ol/Overlay} */ (event.element));\n    }, this);\n\n  listen(this.overlays_, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      const overlay = /** @type {module:ol/Overlay} */ (event.element);\n      const id = overlay.getId();\n      if (id !== undefined) {\n        delete this.overlayIdIndex_[id.toString()];\n      }\n      event.element.setMap(null);\n    }, this);\n\n};\n\ninherits(PluggableMap, BaseObject);\n\n\nPluggableMap.prototype.createRenderer = function() {\n  throw new Error('Use a map type that has a createRenderer method');\n};\n\n\n/**\n * Add the given control to the map.\n * @param {module:ol/control/Control} control Control.\n * @api\n */\nPluggableMap.prototype.addControl = function(control) {\n  this.getControls().push(control);\n};\n\n\n/**\n * Add the given interaction to the map.\n * @param {module:ol/interaction/Interaction} interaction Interaction to add.\n * @api\n */\nPluggableMap.prototype.addInteraction = function(interaction) {\n  this.getInteractions().push(interaction);\n};\n\n\n/**\n * Adds the given layer to the top of this map. If you want to add a layer\n * elsewhere in the stack, use `getLayers()` and the methods available on\n * {@link module:ol/Collection~Collection}.\n * @param {module:ol/layer/Base} layer Layer.\n * @api\n */\nPluggableMap.prototype.addLayer = function(layer) {\n  const layers = this.getLayerGroup().getLayers();\n  layers.push(layer);\n};\n\n\n/**\n * Add the given overlay to the map.\n * @param {module:ol/Overlay} overlay Overlay.\n * @api\n */\nPluggableMap.prototype.addOverlay = function(overlay) {\n  this.getOverlays().push(overlay);\n};\n\n\n/**\n * This deals with map's overlay collection changes.\n * @param {module:ol/Overlay} overlay Overlay.\n * @private\n */\nPluggableMap.prototype.addOverlayInternal_ = function(overlay) {\n  const id = overlay.getId();\n  if (id !== undefined) {\n    this.overlayIdIndex_[id.toString()] = overlay;\n  }\n  overlay.setMap(this);\n};\n\n\n/**\n *\n * @inheritDoc\n */\nPluggableMap.prototype.disposeInternal = function() {\n  this.mapBrowserEventHandler_.dispose();\n  unlisten(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n  unlisten(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n  unlisten(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n  if (this.handleResize_ !== undefined) {\n    removeEventListener(EventType.RESIZE, this.handleResize_, false);\n    this.handleResize_ = undefined;\n  }\n  if (this.animationDelayKey_) {\n    cancelAnimationFrame(this.animationDelayKey_);\n    this.animationDelayKey_ = undefined;\n  }\n  this.setTarget(null);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Detect features that intersect a pixel on the viewport, and execute a\n * callback with each intersecting feature. Layers included in the detection can\n * be configured through the `layerFilter` option in `opt_options`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature),\n *     module:ol/layer/Layer): T} callback Feature callback. The callback will be\n *     called with two arguments. The first argument is one\n *     {@link module:ol/Feature feature} or\n *     {@link module:ol/render/Feature render feature} at the pixel, the second is\n *     the {@link module:ol/layer/Layer layer} of the feature and will be null for\n *     unmanaged layers. To stop detection, callback functions can return a\n *     truthy value.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {T|undefined} Callback result, i.e. the return value of last\n * callback execution, or the first truthy callback return value.\n * @template S,T\n * @api\n */\nPluggableMap.prototype.forEachFeatureAtPixel = function(pixel, callback, opt_options) {\n  if (!this.frameState_) {\n    return;\n  }\n  const coordinate = this.getCoordinateFromPixel(pixel);\n  opt_options = opt_options !== undefined ? opt_options : {};\n  const hitTolerance = opt_options.hitTolerance !== undefined ?\n    opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n  const layerFilter = opt_options.layerFilter !== undefined ?\n    opt_options.layerFilter : TRUE;\n  return this.renderer_.forEachFeatureAtCoordinate(\n    coordinate, this.frameState_, hitTolerance, callback, null,\n    layerFilter, null);\n};\n\n\n/**\n * Get all features that intersect a pixel on the viewport.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {Array.<module:ol/Feature|module:ol/render/Feature>} The detected features or\n * `null` if none were found.\n * @api\n */\nPluggableMap.prototype.getFeaturesAtPixel = function(pixel, opt_options) {\n  let features = null;\n  this.forEachFeatureAtPixel(pixel, function(feature) {\n    if (!features) {\n      features = [];\n    }\n    features.push(feature);\n  }, opt_options);\n  return features;\n};\n\n/**\n * Detect layers that have a color value at a pixel on the viewport, and\n * execute a callback with each matching layer. Layers included in the\n * detection can be configured through `opt_layerFilter`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback\n *     Layer callback. This callback will receive two arguments: first is the\n *     {@link module:ol/layer/Layer layer}, second argument is an array representing\n *     [R, G, B, A] pixel values (0 - 255) and will be `null` for layer types\n *     that do not currently support this argument. To stop detection, callback\n *     functions can return a truthy value.\n * @param {S=} opt_this Value to use as `this` when executing `callback`.\n * @param {(function(this: U, module:ol/layer/Layer): boolean)=} opt_layerFilter Layer\n *     filter function. The filter function will receive one argument, the\n *     {@link module:ol/layer/Layer layer-candidate} and it should return a boolean\n *     value. Only layers which are visible and for which this function returns\n *     `true` will be tested for features. By default, all visible layers will\n *     be tested.\n * @param {U=} opt_this2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result, i.e. the return value of last\n * callback execution, or the first truthy callback return value.\n * @template S,T,U\n * @api\n */\nPluggableMap.prototype.forEachLayerAtPixel = function(pixel, callback, opt_this, opt_layerFilter, opt_this2) {\n  if (!this.frameState_) {\n    return;\n  }\n  const thisArg = opt_this !== undefined ? opt_this : null;\n  const layerFilter = opt_layerFilter !== undefined ? opt_layerFilter : TRUE;\n  const thisArg2 = opt_this2 !== undefined ? opt_this2 : null;\n  return this.renderer_.forEachLayerAtPixel(\n    pixel, this.frameState_, callback, thisArg,\n    layerFilter, thisArg2);\n};\n\n\n/**\n * Detect if features intersect a pixel on the viewport. Layers included in the\n * detection can be configured through `opt_layerFilter`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {boolean} Is there a feature at the given pixel?\n * @template U\n * @api\n */\nPluggableMap.prototype.hasFeatureAtPixel = function(pixel, opt_options) {\n  if (!this.frameState_) {\n    return false;\n  }\n  const coordinate = this.getCoordinateFromPixel(pixel);\n  opt_options = opt_options !== undefined ? opt_options : {};\n  const layerFilter = opt_options.layerFilter !== undefined ? opt_options.layerFilter : TRUE;\n  const hitTolerance = opt_options.hitTolerance !== undefined ?\n    opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n  return this.renderer_.hasFeatureAtCoordinate(\n    coordinate, this.frameState_, hitTolerance, layerFilter, null);\n};\n\n\n/**\n * Returns the coordinate in view projection for a browser event.\n * @param {Event} event Event.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nPluggableMap.prototype.getEventCoordinate = function(event) {\n  return this.getCoordinateFromPixel(this.getEventPixel(event));\n};\n\n\n/**\n * Returns the map pixel position for a browser event relative to the viewport.\n * @param {Event} event Event.\n * @return {module:ol~Pixel} Pixel.\n * @api\n */\nPluggableMap.prototype.getEventPixel = function(event) {\n  const viewportPosition = this.viewport_.getBoundingClientRect();\n  const eventPosition = event.changedTouches ? event.changedTouches[0] : event;\n  return [\n    eventPosition.clientX - viewportPosition.left,\n    eventPosition.clientY - viewportPosition.top\n  ];\n};\n\n\n/**\n * Get the target in which this map is rendered.\n * Note that this returns what is entered as an option or in setTarget:\n * if that was an element, it returns an element; if a string, it returns that.\n * @return {Element|string|undefined} The Element or id of the Element that the\n *     map is rendered in.\n * @observable\n * @api\n */\nPluggableMap.prototype.getTarget = function() {\n  return /** @type {Element|string|undefined} */ (this.get(MapProperty.TARGET));\n};\n\n\n/**\n * Get the DOM element into which this map is rendered. In contrast to\n * `getTarget` this method always return an `Element`, or `null` if the\n * map has no target.\n * @return {Element} The element that the map is rendered in.\n * @api\n */\nPluggableMap.prototype.getTargetElement = function() {\n  const target = this.getTarget();\n  if (target !== undefined) {\n    return typeof target === 'string' ? document.getElementById(target) : target;\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Get the coordinate for a given pixel.  This returns a coordinate in the\n * map view projection.\n * @param {module:ol~Pixel} pixel Pixel position in the map viewport.\n * @return {module:ol/coordinate~Coordinate} The coordinate for the pixel position.\n * @api\n */\nPluggableMap.prototype.getCoordinateFromPixel = function(pixel) {\n  const frameState = this.frameState_;\n  if (!frameState) {\n    return null;\n  } else {\n    return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n  }\n};\n\n\n/**\n * Get the map controls. Modifying this collection changes the controls\n * associated with the map.\n * @return {module:ol/Collection.<module:ol/control/Control>} Controls.\n * @api\n */\nPluggableMap.prototype.getControls = function() {\n  return this.controls;\n};\n\n\n/**\n * Get the map overlays. Modifying this collection changes the overlays\n * associated with the map.\n * @return {module:ol/Collection.<module:ol/Overlay>} Overlays.\n * @api\n */\nPluggableMap.prototype.getOverlays = function() {\n  return this.overlays_;\n};\n\n\n/**\n * Get an overlay by its identifier (the value returned by overlay.getId()).\n * Note that the index treats string and numeric identifiers as the same. So\n * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n * @param {string|number} id Overlay identifier.\n * @return {module:ol/Overlay} Overlay.\n * @api\n */\nPluggableMap.prototype.getOverlayById = function(id) {\n  const overlay = this.overlayIdIndex_[id.toString()];\n  return overlay !== undefined ? overlay : null;\n};\n\n\n/**\n * Get the map interactions. Modifying this collection changes the interactions\n * associated with the map.\n *\n * Interactions are used for e.g. pan, zoom and rotate.\n * @return {module:ol/Collection.<module:ol/interaction/Interaction>} Interactions.\n * @api\n */\nPluggableMap.prototype.getInteractions = function() {\n  return this.interactions;\n};\n\n\n/**\n * Get the layergroup associated with this map.\n * @return {module:ol/layer/Group} A layer group containing the layers in this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.getLayerGroup = function() {\n  return (\n    /** @type {module:ol/layer/Group} */ (this.get(MapProperty.LAYERGROUP))\n  );\n};\n\n\n/**\n * Get the collection of layers associated with this map.\n * @return {!module:ol/Collection.<module:ol/layer/Base>} Layers.\n * @api\n */\nPluggableMap.prototype.getLayers = function() {\n  const layers = this.getLayerGroup().getLayers();\n  return layers;\n};\n\n\n/**\n * Get the pixel for a coordinate.  This takes a coordinate in the map view\n * projection and returns the corresponding pixel.\n * @param {module:ol/coordinate~Coordinate} coordinate A map coordinate.\n * @return {module:ol~Pixel} A pixel position in the map viewport.\n * @api\n */\nPluggableMap.prototype.getPixelFromCoordinate = function(coordinate) {\n  const frameState = this.frameState_;\n  if (!frameState) {\n    return null;\n  } else {\n    return applyTransform(frameState.coordinateToPixelTransform, coordinate.slice(0, 2));\n  }\n};\n\n\n/**\n * Get the map renderer.\n * @return {module:ol/renderer/Map} Renderer\n */\nPluggableMap.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Get the size of this map.\n * @return {module:ol/size~Size|undefined} The size in pixels of the map in the DOM.\n * @observable\n * @api\n */\nPluggableMap.prototype.getSize = function() {\n  return (\n    /** @type {module:ol/size~Size|undefined} */ (this.get(MapProperty.SIZE))\n  );\n};\n\n\n/**\n * Get the view associated with this map. A view manages properties such as\n * center and resolution.\n * @return {module:ol/View} The view that controls this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.getView = function() {\n  return (\n    /** @type {module:ol/View} */ (this.get(MapProperty.VIEW))\n  );\n};\n\n\n/**\n * Get the element that serves as the map viewport.\n * @return {Element} Viewport.\n * @api\n */\nPluggableMap.prototype.getViewport = function() {\n  return this.viewport_;\n};\n\n\n/**\n * Get the element that serves as the container for overlays.  Elements added to\n * this container will let mousedown and touchstart events through to the map,\n * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n * events.\n * @return {!Element} The map's overlay container.\n */\nPluggableMap.prototype.getOverlayContainer = function() {\n  return this.overlayContainer_;\n};\n\n\n/**\n * Get the element that serves as a container for overlays that don't allow\n * event propagation. Elements added to this container won't let mousedown and\n * touchstart events through to the map, so clicks and gestures on an overlay\n * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n * @return {!Element} The map's overlay container that stops events.\n */\nPluggableMap.prototype.getOverlayContainerStopEvent = function() {\n  return this.overlayContainerStopEvent_;\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {string} tileSourceKey Tile source key.\n * @param {module:ol/coordinate~Coordinate} tileCenter Tile center.\n * @param {number} tileResolution Tile resolution.\n * @return {number} Tile priority.\n */\nPluggableMap.prototype.getTilePriority = function(tile, tileSourceKey, tileCenter, tileResolution) {\n  // Filter out tiles at higher zoom levels than the current zoom level, or that\n  // are outside the visible extent.\n  const frameState = this.frameState_;\n  if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n    return DROP;\n  }\n  if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n    return DROP;\n  }\n  // Prioritize the highest zoom level tiles closest to the focus.\n  // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n  // Within a zoom level, tiles are prioritized by the distance in pixels\n  // between the center of the tile and the focus.  The factor of 65536 means\n  // that the prioritization should behave as desired for tiles up to\n  // 65536 * Math.log(2) = 45426 pixels from the focus.\n  const deltaX = tileCenter[0] - frameState.focus[0];\n  const deltaY = tileCenter[1] - frameState.focus[1];\n  return 65536 * Math.log(tileResolution) +\n      Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n};\n\n\n/**\n * @param {Event} browserEvent Browser event.\n * @param {string=} opt_type Type.\n */\nPluggableMap.prototype.handleBrowserEvent = function(browserEvent, opt_type) {\n  const type = opt_type || browserEvent.type;\n  const mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n  this.handleMapBrowserEvent(mapBrowserEvent);\n};\n\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent The event to handle.\n */\nPluggableMap.prototype.handleMapBrowserEvent = function(mapBrowserEvent) {\n  if (!this.frameState_) {\n    // With no view defined, we cannot translate pixels into geographical\n    // coordinates so interactions cannot be used.\n    return;\n  }\n  this.focus_ = mapBrowserEvent.coordinate;\n  mapBrowserEvent.frameState = this.frameState_;\n  const interactionsArray = this.getInteractions().getArray();\n  if (this.dispatchEvent(mapBrowserEvent) !== false) {\n    for (let i = interactionsArray.length - 1; i >= 0; i--) {\n      const interaction = interactionsArray[i];\n      if (!interaction.getActive()) {\n        continue;\n      }\n      const cont = interaction.handleEvent(mapBrowserEvent);\n      if (!cont) {\n        break;\n      }\n    }\n  }\n};\n\n\n/**\n * @protected\n */\nPluggableMap.prototype.handlePostRender = function() {\n\n  const frameState = this.frameState_;\n\n  // Manage the tile queue\n  // Image loads are expensive and a limited resource, so try to use them\n  // efficiently:\n  // * When the view is static we allow a large number of parallel tile loads\n  //   to complete the frame as quickly as possible.\n  // * When animating or interacting, image loads can cause janks, so we reduce\n  //   the maximum number of loads per frame and limit the number of parallel\n  //   tile loads to remain reactive to view changes and to reduce the chance of\n  //   loading tiles that will quickly disappear from view.\n  const tileQueue = this.tileQueue_;\n  if (!tileQueue.isEmpty()) {\n    let maxTotalLoading = this.maxTilesLoading_;\n    let maxNewLoads = maxTotalLoading;\n    if (frameState) {\n      const hints = frameState.viewHints;\n      if (hints[ViewHint.ANIMATING]) {\n        maxTotalLoading = this.loadTilesWhileAnimating_ ? 8 : 0;\n        maxNewLoads = 2;\n      }\n      if (hints[ViewHint.INTERACTING]) {\n        maxTotalLoading = this.loadTilesWhileInteracting_ ? 8 : 0;\n        maxNewLoads = 2;\n      }\n    }\n    if (tileQueue.getTilesLoading() < maxTotalLoading) {\n      tileQueue.reprioritize(); // FIXME only call if view has changed\n      tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n    }\n  }\n\n  const postRenderFunctions = this.postRenderFunctions_;\n  for (let i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n    postRenderFunctions[i](this, frameState);\n  }\n  postRenderFunctions.length = 0;\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleSizeChanged_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleTargetChanged_ = function() {\n  // target may be undefined, null, a string or an Element.\n  // If it's a string we convert it to an Element before proceeding.\n  // If it's not now an Element we remove the viewport from the DOM.\n  // If it's an Element we append the viewport element to it.\n\n  let targetElement;\n  if (this.getTarget()) {\n    targetElement = this.getTargetElement();\n  }\n\n  if (this.keyHandlerKeys_) {\n    for (let i = 0, ii = this.keyHandlerKeys_.length; i < ii; ++i) {\n      unlistenByKey(this.keyHandlerKeys_[i]);\n    }\n    this.keyHandlerKeys_ = null;\n  }\n\n  if (!targetElement) {\n    this.renderer_.removeLayerRenderers();\n    removeNode(this.viewport_);\n    if (this.handleResize_ !== undefined) {\n      removeEventListener(EventType.RESIZE, this.handleResize_, false);\n      this.handleResize_ = undefined;\n    }\n  } else {\n    targetElement.appendChild(this.viewport_);\n\n    const keyboardEventTarget = !this.keyboardEventTarget_ ?\n      targetElement : this.keyboardEventTarget_;\n    this.keyHandlerKeys_ = [\n      listen(keyboardEventTarget, EventType.KEYDOWN, this.handleBrowserEvent, this),\n      listen(keyboardEventTarget, EventType.KEYPRESS, this.handleBrowserEvent, this)\n    ];\n\n    if (!this.handleResize_) {\n      this.handleResize_ = this.updateSize.bind(this);\n      addEventListener(EventType.RESIZE, this.handleResize_, false);\n    }\n  }\n\n  this.updateSize();\n  // updateSize calls setSize, so no need to call this.render\n  // ourselves here.\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleTileChange_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleViewPropertyChanged_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleViewChanged_ = function() {\n  if (this.viewPropertyListenerKey_) {\n    unlistenByKey(this.viewPropertyListenerKey_);\n    this.viewPropertyListenerKey_ = null;\n  }\n  if (this.viewChangeListenerKey_) {\n    unlistenByKey(this.viewChangeListenerKey_);\n    this.viewChangeListenerKey_ = null;\n  }\n  const view = this.getView();\n  if (view) {\n    this.viewport_.setAttribute('data-view', getUid(view));\n    this.viewPropertyListenerKey_ = listen(\n      view, ObjectEventType.PROPERTYCHANGE,\n      this.handleViewPropertyChanged_, this);\n    this.viewChangeListenerKey_ = listen(\n      view, EventType.CHANGE,\n      this.handleViewPropertyChanged_, this);\n  }\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleLayerGroupChanged_ = function() {\n  if (this.layerGroupPropertyListenerKeys_) {\n    this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n    this.layerGroupPropertyListenerKeys_ = null;\n  }\n  const layerGroup = this.getLayerGroup();\n  if (layerGroup) {\n    this.layerGroupPropertyListenerKeys_ = [\n      listen(\n        layerGroup, ObjectEventType.PROPERTYCHANGE,\n        this.render, this),\n      listen(\n        layerGroup, EventType.CHANGE,\n        this.render, this)\n    ];\n  }\n  this.render();\n};\n\n\n/**\n * @return {boolean} Is rendered.\n */\nPluggableMap.prototype.isRendered = function() {\n  return !!this.frameState_;\n};\n\n\n/**\n * Requests an immediate render in a synchronous manner.\n * @api\n */\nPluggableMap.prototype.renderSync = function() {\n  if (this.animationDelayKey_) {\n    cancelAnimationFrame(this.animationDelayKey_);\n  }\n  this.animationDelay_();\n};\n\n\n/**\n * Request a map rendering (at the next animation frame).\n * @api\n */\nPluggableMap.prototype.render = function() {\n  if (this.animationDelayKey_ === undefined) {\n    this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n  }\n};\n\n\n/**\n * Remove the given control from the map.\n * @param {module:ol/control/Control} control Control.\n * @return {module:ol/control/Control|undefined} The removed control (or undefined\n *     if the control was not found).\n * @api\n */\nPluggableMap.prototype.removeControl = function(control) {\n  return this.getControls().remove(control);\n};\n\n\n/**\n * Remove the given interaction from the map.\n * @param {module:ol/interaction/Interaction} interaction Interaction to remove.\n * @return {module:ol/interaction/Interaction|undefined} The removed interaction (or\n *     undefined if the interaction was not found).\n * @api\n */\nPluggableMap.prototype.removeInteraction = function(interaction) {\n  return this.getInteractions().remove(interaction);\n};\n\n\n/**\n * Removes the given layer from the map.\n * @param {module:ol/layer/Base} layer Layer.\n * @return {module:ol/layer/Base|undefined} The removed layer (or undefined if the\n *     layer was not found).\n * @api\n */\nPluggableMap.prototype.removeLayer = function(layer) {\n  const layers = this.getLayerGroup().getLayers();\n  return layers.remove(layer);\n};\n\n\n/**\n * Remove the given overlay from the map.\n * @param {module:ol/Overlay} overlay Overlay.\n * @return {module:ol/Overlay|undefined} The removed overlay (or undefined\n *     if the overlay was not found).\n * @api\n */\nPluggableMap.prototype.removeOverlay = function(overlay) {\n  return this.getOverlays().remove(overlay);\n};\n\n\n/**\n * @param {number} time Time.\n * @private\n */\nPluggableMap.prototype.renderFrame_ = function(time) {\n  let viewState;\n\n  const size = this.getSize();\n  const view = this.getView();\n  const extent = createEmpty();\n  const previousFrameState = this.frameState_;\n  /** @type {?module:ol/PluggableMap~FrameState} */\n  let frameState = null;\n  if (size !== undefined && hasArea(size) && view && view.isDef()) {\n    const viewHints = view.getHints(this.frameState_ ? this.frameState_.viewHints : undefined);\n    const layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n    const layerStates = {};\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      layerStates[getUid(layerStatesArray[i].layer)] = layerStatesArray[i];\n    }\n    viewState = view.getState();\n    let focus = this.focus_;\n    if (!focus) {\n      focus = viewState.center;\n      const pixelResolution = viewState.resolution / this.pixelRatio_;\n      focus[0] = Math.round(focus[0] / pixelResolution) * pixelResolution;\n      focus[1] = Math.round(focus[1] / pixelResolution) * pixelResolution;\n    }\n    frameState = /** @type {module:ol/PluggableMap~FrameState} */ ({\n      animate: false,\n      coordinateToPixelTransform: this.coordinateToPixelTransform_,\n      extent: extent,\n      focus: focus,\n      index: this.frameIndex_++,\n      layerStates: layerStates,\n      layerStatesArray: layerStatesArray,\n      pixelRatio: this.pixelRatio_,\n      pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n      postRenderFunctions: [],\n      size: size,\n      skippedFeatureUids: this.skippedFeatureUids_,\n      tileQueue: this.tileQueue_,\n      time: time,\n      usedTiles: {},\n      viewState: viewState,\n      viewHints: viewHints,\n      wantedTiles: {}\n    });\n  }\n\n  if (frameState) {\n    frameState.extent = getForViewAndSize(viewState.center,\n      viewState.resolution, viewState.rotation, frameState.size, extent);\n  }\n\n  this.frameState_ = frameState;\n  this.renderer_.renderFrame(frameState);\n\n  if (frameState) {\n    if (frameState.animate) {\n      this.render();\n    }\n    Array.prototype.push.apply(this.postRenderFunctions_, frameState.postRenderFunctions);\n\n    if (previousFrameState) {\n      const moveStart = !this.previousExtent_ ||\n                  (!isEmpty(this.previousExtent_) &&\n                  !equals(frameState.extent, this.previousExtent_));\n      if (moveStart) {\n        this.dispatchEvent(\n          new MapEvent(MapEventType.MOVESTART, this, previousFrameState));\n        this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n      }\n    }\n\n    const idle = this.previousExtent_ &&\n        !frameState.viewHints[ViewHint.ANIMATING] &&\n        !frameState.viewHints[ViewHint.INTERACTING] &&\n        !equals(frameState.extent, this.previousExtent_);\n\n    if (idle) {\n      this.dispatchEvent(new MapEvent(MapEventType.MOVEEND, this, frameState));\n      clone(frameState.extent, this.previousExtent_);\n    }\n  }\n\n  this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n  setTimeout(this.handlePostRender.bind(this), 0);\n\n};\n\n\n/**\n * Sets the layergroup of this map.\n * @param {module:ol/layer/Group} layerGroup A layer group containing the layers in this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.setLayerGroup = function(layerGroup) {\n  this.set(MapProperty.LAYERGROUP, layerGroup);\n};\n\n\n/**\n * Set the size of this map.\n * @param {module:ol/size~Size|undefined} size The size in pixels of the map in the DOM.\n * @observable\n * @api\n */\nPluggableMap.prototype.setSize = function(size) {\n  this.set(MapProperty.SIZE, size);\n};\n\n\n/**\n * Set the target element to render this map into.\n * @param {Element|string|undefined} target The Element or id of the Element\n *     that the map is rendered in.\n * @observable\n * @api\n */\nPluggableMap.prototype.setTarget = function(target) {\n  this.set(MapProperty.TARGET, target);\n};\n\n\n/**\n * Set the view for this map.\n * @param {module:ol/View} view The view that controls this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.setView = function(view) {\n  this.set(MapProperty.VIEW, view);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n */\nPluggableMap.prototype.skipFeature = function(feature) {\n  const featureUid = getUid(feature).toString();\n  this.skippedFeatureUids_[featureUid] = true;\n  this.render();\n};\n\n\n/**\n * Force a recalculation of the map viewport size.  This should be called when\n * third-party code changes the size of the map viewport.\n * @api\n */\nPluggableMap.prototype.updateSize = function() {\n  const targetElement = this.getTargetElement();\n\n  if (!targetElement) {\n    this.setSize(undefined);\n  } else {\n    const computedStyle = getComputedStyle(targetElement);\n    this.setSize([\n      targetElement.offsetWidth -\n          parseFloat(computedStyle['borderLeftWidth']) -\n          parseFloat(computedStyle['paddingLeft']) -\n          parseFloat(computedStyle['paddingRight']) -\n          parseFloat(computedStyle['borderRightWidth']),\n      targetElement.offsetHeight -\n          parseFloat(computedStyle['borderTopWidth']) -\n          parseFloat(computedStyle['paddingTop']) -\n          parseFloat(computedStyle['paddingBottom']) -\n          parseFloat(computedStyle['borderBottomWidth'])\n    ]);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n */\nPluggableMap.prototype.unskipFeature = function(feature) {\n  const featureUid = getUid(feature).toString();\n  delete this.skippedFeatureUids_[featureUid];\n  this.render();\n};\n\n\n/**\n * @param {MapOptions} options Map options.\n * @return {module:ol/PluggableMap~MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n\n  /**\n   * @type {Element|Document}\n   */\n  let keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget = typeof options.keyboardEventTarget === 'string' ?\n      document.getElementById(options.keyboardEventTarget) :\n      options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const values = {};\n\n  const layerGroup = (options.layers instanceof LayerGroup) ?\n    options.layers : new LayerGroup({layers: options.layers});\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] = options.view !== undefined ?\n    options.view : new View();\n\n  let controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(options.controls instanceof Collection,\n        47); // Expected `controls` to be an array or an `module:ol/Collection~Collection`\n      controls = options.controls;\n    }\n  }\n\n  let interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(options.interactions instanceof Collection,\n        48); // Expected `interactions` to be an array or an `module:ol/Collection~Collection`\n      interactions = options.interactions;\n    }\n  }\n\n  let overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(options.overlays instanceof Collection,\n        49); // Expected `overlays` to be an array or an `module:ol/Collection~Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values\n  };\n\n}\nexport default PluggableMap;\n","/**\n * @module ol/control/Control\n */\nimport {inherits} from '../index.js';\nimport {UNDEFINED} from '../functions.js';\nimport MapEventType from '../MapEventType.js';\nimport BaseObject from '../Object.js';\nimport {removeNode} from '../dom.js';\nimport {listen, unlistenByKey} from '../events.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Element} [element] The element is the control's\n * container element. This only needs to be specified if you're developing\n * a custom control.\n * @property {function(module:ol/MapEvent)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n * @property {Element|string} [target] Specify a target if you want\n * the control to be rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control is a visible widget with a DOM element in a fixed position on the\n * screen. They can involve user input (buttons), or be informational only;\n * the position is determined using CSS. By default these are placed in the\n * container with CSS class name `ol-overlaycontainer-stopevent`, but can use\n * any outside DOM element.\n *\n * This is the base class for controls. You can use it for simple custom\n * controls by creating the element with listeners, creating an instance:\n * ```js\n * var myControl = new Control({element: myElement});\n * ```\n * and then adding this to the map.\n *\n * The main advantage of having this as a control rather than a simple separate\n * DOM element is that preventing propagation is handled for you. Controls\n * will also be objects in a {@link module:ol/Collection~Collection}, so you can use their methods.\n *\n * You can also extend this base for your own control class. See\n * examples/custom-controls for an example of how to do this.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/control/Control~Options} options Control options.\n * @api\n */\nconst Control = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @protected\n   * @type {Element}\n   */\n  this.element = options.element ? options.element : null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.target_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  /**\n   * @protected\n   * @type {!Array.<module:ol/events~EventsKey>}\n   */\n  this.listenerKeys = [];\n\n  /**\n   * @type {function(module:ol/MapEvent)}\n   */\n  this.render = options.render ? options.render : UNDEFINED;\n\n  if (options.target) {\n    this.setTarget(options.target);\n  }\n\n};\n\ninherits(Control, BaseObject);\n\n\n/**\n * @inheritDoc\n */\nControl.prototype.disposeInternal = function() {\n  removeNode(this.element);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Get the map associated with this control.\n * @return {module:ol/PluggableMap} Map.\n * @api\n */\nControl.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nControl.prototype.setMap = function(map) {\n  if (this.map_) {\n    removeNode(this.element);\n  }\n  for (let i = 0, ii = this.listenerKeys.length; i < ii; ++i) {\n    unlistenByKey(this.listenerKeys[i]);\n  }\n  this.listenerKeys.length = 0;\n  this.map_ = map;\n  if (this.map_) {\n    const target = this.target_ ?\n      this.target_ : map.getOverlayContainerStopEvent();\n    target.appendChild(this.element);\n    if (this.render !== UNDEFINED) {\n      this.listenerKeys.push(listen(map,\n        MapEventType.POSTRENDER, this.render, this));\n    }\n    map.render();\n  }\n};\n\n\n/**\n * This function is used to set a target element for the control. It has no\n * effect if it is called after the control has been added to the map (i.e.\n * after `setMap` is called on the control). If no `target` is set in the\n * options passed to the control constructor and if `setTarget` is not called\n * then the control is added to the map's overlay container.\n * @param {Element|string} target Target.\n * @api\n */\nControl.prototype.setTarget = function(target) {\n  this.target_ = typeof target === 'string' ?\n    document.getElementById(target) :\n    target;\n};\nexport default Control;\n","/**\n * @module ol/layer/Layer\n */\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getUid, inherits} from '../index.js';\nimport {getChangeEventType} from '../Object.js';\nimport BaseLayer from '../layer/Base.js';\nimport LayerProperty from '../layer/Property.js';\nimport {assign} from '../obj.js';\nimport RenderEventType from '../render/EventType.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/source/Source} [source] Source for this layer.  If not provided to the constructor,\n * the source can be set by calling {@link module:ol/layer/Layer#setSource layer.setSource(source)} after\n * construction.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {module:ol/layer/Layer} layer\n * @property {number} opacity\n * @property {module:ol/source/Source~State} sourceState\n * @property {boolean} visible\n * @property {boolean} managed\n * @property {module:ol/extent~Extent} [extent]\n * @property {number} zIndex\n * @property {number} maxResolution\n * @property {number} minResolution\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * A visual representation of raster or vector map data.\n * Layers group together those properties that pertain to how the data is to be\n * displayed, irrespective of the source of that data.\n *\n * Layers are usually added to a map with {@link module:ol/Map#addLayer}. Components\n * like {@link module:ol/interaction/Select~Select} use unmanaged layers\n * internally. These unmanaged layers are associated with the map using\n * {@link module:ol/layer/Layer~Layer#setMap} instead.\n *\n * A generic `change` event is fired when the state of the source changes.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/layer/Base}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Layer~Options} options Layer options.\n * @api\n */\nconst Layer = function(options) {\n\n  const baseOptions = assign({}, options);\n  delete baseOptions.source;\n\n  BaseLayer.call(this, /** @type {module:ol/layer/Base~Options} */ (baseOptions));\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapPrecomposeKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapRenderKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.sourceChangeKey_ = null;\n\n  if (options.map) {\n    this.setMap(options.map);\n  }\n\n  listen(this,\n    getChangeEventType(LayerProperty.SOURCE),\n    this.handleSourcePropertyChange_, this);\n\n  const source = options.source ? options.source : null;\n  this.setSource(source);\n};\n\ninherits(Layer, BaseLayer);\n\n\n/**\n * Return `true` if the layer is visible, and if the passed resolution is\n * between the layer's minResolution and maxResolution. The comparison is\n * inclusive for `minResolution` and exclusive for `maxResolution`.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {number} resolution Resolution.\n * @return {boolean} The layer is visible at the given resolution.\n */\nexport function visibleAtResolution(layerState, resolution) {\n  return layerState.visible && resolution >= layerState.minResolution &&\n      resolution < layerState.maxResolution;\n}\n\n\n/**\n * @inheritDoc\n */\nLayer.prototype.getLayersArray = function(opt_array) {\n  const array = opt_array ? opt_array : [];\n  array.push(this);\n  return array;\n};\n\n\n/**\n * @inheritDoc\n */\nLayer.prototype.getLayerStatesArray = function(opt_states) {\n  const states = opt_states ? opt_states : [];\n  states.push(this.getLayerState());\n  return states;\n};\n\n\n/**\n * Get the layer source.\n * @return {module:ol/source/Source} The layer source (or `null` if not yet set).\n * @observable\n * @api\n */\nLayer.prototype.getSource = function() {\n  const source = this.get(LayerProperty.SOURCE);\n  return (\n    /** @type {module:ol/source/Source} */ (source) || null\n  );\n};\n\n\n/**\n  * @inheritDoc\n  */\nLayer.prototype.getSourceState = function() {\n  const source = this.getSource();\n  return !source ? SourceState.UNDEFINED : source.getState();\n};\n\n\n/**\n * @private\n */\nLayer.prototype.handleSourceChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @private\n */\nLayer.prototype.handleSourcePropertyChange_ = function() {\n  if (this.sourceChangeKey_) {\n    unlistenByKey(this.sourceChangeKey_);\n    this.sourceChangeKey_ = null;\n  }\n  const source = this.getSource();\n  if (source) {\n    this.sourceChangeKey_ = listen(source,\n      EventType.CHANGE, this.handleSourceChange_, this);\n  }\n  this.changed();\n};\n\n\n/**\n * Sets the layer to be rendered on top of other layers on a map. The map will\n * not manage this layer in its layers collection, and the callback in\n * {@link module:ol/Map#forEachLayerAtPixel} will receive `null` as layer. This\n * is useful for temporary layers. To remove an unmanaged layer from the map,\n * use `#setMap(null)`.\n *\n * To add the layer to a map and have it managed by the map, use\n * {@link module:ol/Map#addLayer} instead.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nLayer.prototype.setMap = function(map) {\n  if (this.mapPrecomposeKey_) {\n    unlistenByKey(this.mapPrecomposeKey_);\n    this.mapPrecomposeKey_ = null;\n  }\n  if (!map) {\n    this.changed();\n  }\n  if (this.mapRenderKey_) {\n    unlistenByKey(this.mapRenderKey_);\n    this.mapRenderKey_ = null;\n  }\n  if (map) {\n    this.mapPrecomposeKey_ = listen(map, RenderEventType.PRECOMPOSE, function(evt) {\n      const layerState = this.getLayerState();\n      layerState.managed = false;\n      layerState.zIndex = Infinity;\n      evt.frameState.layerStatesArray.push(layerState);\n      evt.frameState.layerStates[getUid(this)] = layerState;\n    }, this);\n    this.mapRenderKey_ = listen(this, EventType.CHANGE, map.render, map);\n    this.changed();\n  }\n};\n\n\n/**\n * Set the layer source.\n * @param {module:ol/source/Source} source The layer source.\n * @observable\n * @api\n */\nLayer.prototype.setSource = function(source) {\n  this.set(LayerProperty.SOURCE, source);\n};\nexport default Layer;\n","/**\n * @module ol/control/Attribution\n */\nimport {inherits} from '../index.js';\nimport {equals} from '../array.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_COLLAPSED} from '../css.js';\nimport {removeChildren, replaceNode} from '../dom.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {visibleAtResolution} from '../layer/Layer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-attribution'] CSS class name.\n * @property {Element|string} [target] Specify a target if you\n * want the control to be rendered outside of the map's\n * viewport.\n * @property {boolean} [collapsible=true] Specify if attributions can\n * be collapsed. If you use an OSM source, should be set to `false` — see\n * {@link https://www.openstreetmap.org/copyright OSM Copyright} —\n * @property {boolean} [collapsed=true] Specify if attributions should\n * be collapsed at startup.\n * @property {string} [tipLabel='Attributions'] Text label to use for the button tip.\n * @property {string} [label='i'] Text label to use for the\n * collapsed attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [collapseLabel='»'] Text label to use\n * for the expanded attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {function(module:ol/MapEvent)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n */\n\n\n/**\n * @classdesc\n * Control to show all the attributions associated with the layer sources\n * in the map. This control is one of the default controls included in maps.\n * By default it will show in the bottom right portion of the map, but this can\n * be changed by using a css selector for `.ol-attribution`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Attribution~Options=} opt_options Attribution options.\n * @api\n */\nconst Attribution = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.ulElement_ = document.createElement('UL');\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsed_ = options.collapsed !== undefined ? options.collapsed : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsible_ = options.collapsible !== undefined ?\n    options.collapsible : true;\n\n  if (!this.collapsible_) {\n    this.collapsed_ = false;\n  }\n\n  const className = options.className !== undefined ? options.className : 'ol-attribution';\n\n  const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Attributions';\n\n  const collapseLabel = options.collapseLabel !== undefined ? options.collapseLabel : '\\u00BB';\n\n  if (typeof collapseLabel === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.collapseLabel_ = document.createElement('span');\n    this.collapseLabel_.textContent = collapseLabel;\n  } else {\n    this.collapseLabel_ = collapseLabel;\n  }\n\n  const label = options.label !== undefined ? options.label : 'i';\n\n  if (typeof label === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.label_ = document.createElement('span');\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n  }\n\n\n  const activeLabel = (this.collapsible_ && !this.collapsed_) ?\n    this.collapseLabel_ : this.label_;\n  const button = document.createElement('button');\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(activeLabel);\n\n  listen(button, EventType.CLICK, this.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL +\n      (this.collapsed_ && this.collapsible_ ? ' ' + CLASS_COLLAPSED : '') +\n      (this.collapsible_ ? '' : ' ol-uncollapsible');\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(this.ulElement_);\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /**\n   * A list of currently rendered resolutions.\n   * @type {Array.<string>}\n   * @private\n   */\n  this.renderedAttributions_ = [];\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n};\n\ninherits(Attribution, Control);\n\n\n/**\n * Get a list of visible attributions.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {Array.<string>} Attributions.\n * @private\n */\nAttribution.prototype.getSourceAttributions_ = function(frameState) {\n  /**\n   * Used to determine if an attribution already exists.\n   * @type {!Object.<string, boolean>}\n   */\n  const lookup = {};\n\n  /**\n   * A list of visible attributions.\n   * @type {Array.<string>}\n   */\n  const visibleAttributions = [];\n\n  const layerStatesArray = frameState.layerStatesArray;\n  const resolution = frameState.viewState.resolution;\n  for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    const layerState = layerStatesArray[i];\n    if (!visibleAtResolution(layerState, resolution)) {\n      continue;\n    }\n\n    const source = layerState.layer.getSource();\n    if (!source) {\n      continue;\n    }\n\n    const attributionGetter = source.getAttributions();\n    if (!attributionGetter) {\n      continue;\n    }\n\n    const attributions = attributionGetter(frameState);\n    if (!attributions) {\n      continue;\n    }\n\n    if (Array.isArray(attributions)) {\n      for (let j = 0, jj = attributions.length; j < jj; ++j) {\n        if (!(attributions[j] in lookup)) {\n          visibleAttributions.push(attributions[j]);\n          lookup[attributions[j]] = true;\n        }\n      }\n    } else {\n      if (!(attributions in lookup)) {\n        visibleAttributions.push(attributions);\n        lookup[attributions] = true;\n      }\n    }\n  }\n  return visibleAttributions;\n};\n\n\n/**\n * Update the attribution element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/Attribution}\n * @api\n */\nexport function render(mapEvent) {\n  this.updateElement_(mapEvent.frameState);\n}\n\n\n/**\n * @private\n * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nAttribution.prototype.updateElement_ = function(frameState) {\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.element.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const attributions = this.getSourceAttributions_(frameState);\n\n  const visible = attributions.length > 0;\n  if (this.renderedVisible_ != visible) {\n    this.element.style.display = visible ? '' : 'none';\n    this.renderedVisible_ = visible;\n  }\n\n  if (equals(attributions, this.renderedAttributions_)) {\n    return;\n  }\n\n  removeChildren(this.ulElement_);\n\n  // append the attributions\n  for (let i = 0, ii = attributions.length; i < ii; ++i) {\n    const element = document.createElement('LI');\n    element.innerHTML = attributions[i];\n    this.ulElement_.appendChild(element);\n  }\n\n  this.renderedAttributions_ = attributions;\n};\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nAttribution.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleToggle_();\n};\n\n\n/**\n * @private\n */\nAttribution.prototype.handleToggle_ = function() {\n  this.element.classList.toggle(CLASS_COLLAPSED);\n  if (this.collapsed_) {\n    replaceNode(this.collapseLabel_, this.label_);\n  } else {\n    replaceNode(this.label_, this.collapseLabel_);\n  }\n  this.collapsed_ = !this.collapsed_;\n};\n\n\n/**\n * Return `true` if the attribution is collapsible, `false` otherwise.\n * @return {boolean} True if the widget is collapsible.\n * @api\n */\nAttribution.prototype.getCollapsible = function() {\n  return this.collapsible_;\n};\n\n\n/**\n * Set whether the attribution should be collapsible.\n * @param {boolean} collapsible True if the widget is collapsible.\n * @api\n */\nAttribution.prototype.setCollapsible = function(collapsible) {\n  if (this.collapsible_ === collapsible) {\n    return;\n  }\n  this.collapsible_ = collapsible;\n  this.element.classList.toggle('ol-uncollapsible');\n  if (!collapsible && this.collapsed_) {\n    this.handleToggle_();\n  }\n};\n\n\n/**\n * Collapse or expand the attribution according to the passed parameter. Will\n * not do anything if the attribution isn't collapsible or if the current\n * collapsed state is already the one requested.\n * @param {boolean} collapsed True if the widget is collapsed.\n * @api\n */\nAttribution.prototype.setCollapsed = function(collapsed) {\n  if (!this.collapsible_ || this.collapsed_ === collapsed) {\n    return;\n  }\n  this.handleToggle_();\n};\n\n\n/**\n * Return `true` when the attribution is currently collapsed or `false`\n * otherwise.\n * @return {boolean} True if the widget is collapsed.\n * @api\n */\nAttribution.prototype.getCollapsed = function() {\n  return this.collapsed_;\n};\nexport default Attribution;\n","/**\n * @module ol/control/Rotate\n */\n\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_HIDDEN, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {inherits} from '../index.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-rotate'] CSS class name.\n * @property {string|Element} [label='⇧'] Text label to use for the rotate button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Reset rotation'] Text label to use for the rotate tip.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {boolean} [autoHide=true] Hide the control when rotation is 0.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control should\n * be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {function()} [resetNorth] Function called when the control is clicked.\n * This will override the default `resetNorth`.\n * @property {Element|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A button control to reset rotation to 0.\n * To style this control use css selector `.ol-rotate`. A `.ol-hidden` css\n * selector is added to the button when the rotation is 0.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Rotate~Options=} opt_options Rotate options.\n * @api\n */\nconst Rotate = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-rotate';\n\n  const label = options.label !== undefined ? options.label : '\\u21E7';\n\n  /**\n   * @type {Element}\n   * @private\n   */\n  this.label_ = null;\n\n  if (typeof label === 'string') {\n    this.label_ = document.createElement('span');\n    this.label_.className = 'ol-compass';\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n    this.label_.classList.add('ol-compass');\n  }\n\n  const tipLabel = options.tipLabel ? options.tipLabel : 'Reset rotation';\n\n  const button = document.createElement('button');\n  button.className = className + '-reset';\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(this.label_);\n\n  listen(button, EventType.CLICK,\n    Rotate.prototype.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(button);\n\n  this.callResetNorth_ = options.resetNorth ? options.resetNorth : undefined;\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.autoHide_ = options.autoHide !== undefined ? options.autoHide : true;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = undefined;\n\n  if (this.autoHide_) {\n    this.element.classList.add(CLASS_HIDDEN);\n  }\n\n};\n\ninherits(Rotate, Control);\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nRotate.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  if (this.callResetNorth_ !== undefined) {\n    this.callResetNorth_();\n  } else {\n    this.resetNorth_();\n  }\n};\n\n\n/**\n * @private\n */\nRotate.prototype.resetNorth_ = function() {\n  const map = this.getMap();\n  const view = map.getView();\n  if (!view) {\n    // the map does not have a view, so we can't act\n    // upon it\n    return;\n  }\n  if (view.getRotation() !== undefined) {\n    if (this.duration_ > 0) {\n      view.animate({\n        rotation: 0,\n        duration: this.duration_,\n        easing: easeOut\n      });\n    } else {\n      view.setRotation(0);\n    }\n  }\n};\n\n\n/**\n * Update the rotate control element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/Rotate}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    return;\n  }\n  const rotation = frameState.viewState.rotation;\n  if (rotation != this.rotation_) {\n    const transform = 'rotate(' + rotation + 'rad)';\n    if (this.autoHide_) {\n      const contains = this.element.classList.contains(CLASS_HIDDEN);\n      if (!contains && rotation === 0) {\n        this.element.classList.add(CLASS_HIDDEN);\n      } else if (contains && rotation !== 0) {\n        this.element.classList.remove(CLASS_HIDDEN);\n      }\n    }\n    this.label_.style.msTransform = transform;\n    this.label_.style.webkitTransform = transform;\n    this.label_.style.transform = transform;\n  }\n  this.rotation_ = rotation;\n}\n\nexport default Rotate;\n","/**\n * @module ol/control/Zoom\n */\nimport {inherits} from '../index.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {string} [className='ol-zoom'] CSS class name.\n * @property {string|Element} [zoomInLabel='+'] Text label to use for the zoom-in\n * button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [zoomOutLabel='-'] Text label to use for the zoom-out button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [zoomInTipLabel='Zoom in'] Text label to use for the button tip.\n * @property {string} [zoomOutTipLabel='Zoom out'] Text label to use for the button tip.\n * @property {number} [delta=1] The zoom delta applied on each click.\n * @property {Element|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control with 2 buttons, one for zoom in and one for zoom out.\n * This control is one of the default controls of a map. To style this control\n * use css selectors `.ol-zoom-in` and `.ol-zoom-out`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Zoom~Options=} opt_options Zoom options.\n * @api\n */\nconst Zoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-zoom';\n\n  const delta = options.delta !== undefined ? options.delta : 1;\n\n  const zoomInLabel = options.zoomInLabel !== undefined ? options.zoomInLabel : '+';\n  const zoomOutLabel = options.zoomOutLabel !== undefined ? options.zoomOutLabel : '\\u2212';\n\n  const zoomInTipLabel = options.zoomInTipLabel !== undefined ?\n    options.zoomInTipLabel : 'Zoom in';\n  const zoomOutTipLabel = options.zoomOutTipLabel !== undefined ?\n    options.zoomOutTipLabel : 'Zoom out';\n\n  const inElement = document.createElement('button');\n  inElement.className = className + '-in';\n  inElement.setAttribute('type', 'button');\n  inElement.title = zoomInTipLabel;\n  inElement.appendChild(\n    typeof zoomInLabel === 'string' ? document.createTextNode(zoomInLabel) : zoomInLabel\n  );\n\n  listen(inElement, EventType.CLICK,\n    Zoom.prototype.handleClick_.bind(this, delta));\n\n  const outElement = document.createElement('button');\n  outElement.className = className + '-out';\n  outElement.setAttribute('type', 'button');\n  outElement.title = zoomOutTipLabel;\n  outElement.appendChild(\n    typeof zoomOutLabel === 'string' ? document.createTextNode(zoomOutLabel) : zoomOutLabel\n  );\n\n  listen(outElement, EventType.CLICK,\n    Zoom.prototype.handleClick_.bind(this, -delta));\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(inElement);\n  element.appendChild(outElement);\n\n  Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(Zoom, Control);\n\n\n/**\n * @param {number} delta Zoom delta.\n * @param {Event} event The event to handle\n * @private\n */\nZoom.prototype.handleClick_ = function(delta, event) {\n  event.preventDefault();\n  this.zoomByDelta_(delta);\n};\n\n\n/**\n * @param {number} delta Zoom delta.\n * @private\n */\nZoom.prototype.zoomByDelta_ = function(delta) {\n  const map = this.getMap();\n  const view = map.getView();\n  if (!view) {\n    // the map does not have a view, so we can't act\n    // upon it\n    return;\n  }\n  const currentResolution = view.getResolution();\n  if (currentResolution) {\n    const newResolution = view.constrainResolution(currentResolution, delta);\n    if (this.duration_ > 0) {\n      if (view.getAnimating()) {\n        view.cancelAnimations();\n      }\n      view.animate({\n        resolution: newResolution,\n        duration: this.duration_,\n        easing: easeOut\n      });\n    } else {\n      view.setResolution(newResolution);\n    }\n  }\n};\nexport default Zoom;\n","/**\n * @module ol/control/util\n */\nimport Collection from '../Collection.js';\nimport Attribution from './Attribution.js';\nimport Rotate from './Rotate.js';\nimport Zoom from './Zoom.js';\n\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [attribution=true] Include\n * {@link module:ol/control/Attribution~Attribution}.\n * @property {module:ol/control/Attribution~Options} [attributionOptions]\n * Options for {@link module:ol/control/Attribution~Attribution}.\n * @property {boolean} [rotate=true] Include\n * {@link module:ol/control/Rotate~Rotate}.\n * @property {module:ol/control/Rotate~Options} [rotateOptions] Options\n * for {@link module:ol/control/Rotate~Rotate}.\n * @property {boolean} [zoom] Include {@link module:ol/control/Zoom~Zoom}.\n * @property {module:ol/control/Zoom~Options} [zoomOptions] Options for\n * {@link module:ol/control/Zoom~Zoom}.\n * @api\n */\n\n\n/**\n * Set of controls included in maps by default. Unless configured otherwise,\n * this returns a collection containing an instance of each of the following\n * controls:\n * * {@link module:ol/control/Zoom~Zoom}\n * * {@link module:ol/control/Rotate~Rotate}\n * * {@link module:ol/control/Attribution~Attribution}\n *\n * @param {module:ol/control/util~DefaultsOptions=} opt_options\n * Defaults options.\n * @return {module:ol/Collection.<module:ol/control/Control>}\n * Controls.\n * @function module:ol/control.defaults\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const controls = new Collection();\n\n  const zoomControl = options.zoom !== undefined ? options.zoom : true;\n  if (zoomControl) {\n    controls.push(new Zoom(options.zoomOptions));\n  }\n\n  const rotateControl = options.rotate !== undefined ? options.rotate : true;\n  if (rotateControl) {\n    controls.push(new Rotate(options.rotateOptions));\n  }\n\n  const attributionControl = options.attribution !== undefined ?\n    options.attribution : true;\n  if (attributionControl) {\n    controls.push(new Attribution(options.attributionOptions));\n  }\n\n  return controls;\n}\n","/**\n * @module ol/interaction/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ACTIVE: 'active'\n};\n","/**\n * @module ol/interaction/Interaction\n */\nimport {inherits} from '../index.js';\nimport BaseObject from '../Object.js';\nimport {easeOut, linear} from '../easing.js';\nimport InteractionProperty from '../interaction/Property.js';\nimport {clamp} from '../math.js';\n\n\n/**\n * Object literal with config options for interactions.\n * @typedef {Object} InteractionOptions\n * @property {function(module:ol/MapBrowserEvent):boolean} handleEvent\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. If the function returns a falsy value, propagation of\n * the event to other interactions in the map's interactions chain will be\n * prevented (this includes functions with no explicit return).\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * User actions that change the state of the map. Some are similar to controls,\n * but are not associated with a DOM element.\n * For example, {@link module:ol/interaction/KeyboardZoom~KeyboardZoom} is\n * functionally the same as {@link module:ol/control/Zoom~Zoom}, but triggered\n * by a keyboard event not a button element event.\n * Although interactions do not have a DOM element, some of them do render\n * vectors and so are visible on the screen.\n *\n * @constructor\n * @param {module:ol/interaction/Interaction~InteractionOptions} options Options.\n * @extends {module:ol/Object}\n * @api\n */\nconst Interaction = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  this.setActive(true);\n\n  /**\n   * @type {function(module:ol/MapBrowserEvent):boolean}\n   */\n  this.handleEvent = options.handleEvent;\n\n};\n\ninherits(Interaction, BaseObject);\n\n\n/**\n * Return whether the interaction is currently active.\n * @return {boolean} `true` if the interaction is active, `false` otherwise.\n * @observable\n * @api\n */\nInteraction.prototype.getActive = function() {\n  return /** @type {boolean} */ (this.get(InteractionProperty.ACTIVE));\n};\n\n\n/**\n * Get the map associated with this interaction.\n * @return {module:ol/PluggableMap} Map.\n * @api\n */\nInteraction.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nInteraction.prototype.setActive = function(active) {\n  this.set(InteractionProperty.ACTIVE, active);\n};\n\n\n/**\n * Remove the interaction from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {module:ol/PluggableMap} map Map.\n */\nInteraction.prototype.setMap = function(map) {\n  this.map_ = map;\n};\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {module:ol/coordinate~Coordinate} delta Delta.\n * @param {number=} opt_duration Duration.\n */\nexport function pan(view, delta, opt_duration) {\n  const currentCenter = view.getCenter();\n  if (currentCenter) {\n    const center = view.constrainCenter(\n      [currentCenter[0] + delta[0], currentCenter[1] + delta[1]]);\n    if (opt_duration) {\n      view.animate({\n        duration: opt_duration,\n        easing: linear,\n        center: center\n      });\n    } else {\n      view.setCenter(center);\n    }\n  }\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} rotation Rotation.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function rotate(view, rotation, opt_anchor, opt_duration) {\n  rotation = view.constrainRotation(rotation, 0);\n  rotateWithoutConstraints(view, rotation, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} rotation Rotation.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function rotateWithoutConstraints(view, rotation, opt_anchor, opt_duration) {\n  if (rotation !== undefined) {\n    const currentRotation = view.getRotation();\n    const currentCenter = view.getCenter();\n    if (currentRotation !== undefined && currentCenter && opt_duration > 0) {\n      view.animate({\n        rotation: rotation,\n        anchor: opt_anchor,\n        duration: opt_duration,\n        easing: easeOut\n      });\n    } else {\n      view.rotate(rotation, opt_anchor);\n    }\n  }\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} resolution Resolution to go to.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n * @param {number=} opt_direction Zooming direction; > 0 indicates\n *     zooming out, in which case the constraints system will select\n *     the largest nearest resolution; < 0 indicates zooming in, in\n *     which case the constraints system will select the smallest\n *     nearest resolution; == 0 indicates that the zooming direction\n *     is unknown/not relevant, in which case the constraints system\n *     will select the nearest resolution. If not defined 0 is\n *     assumed.\n */\nexport function zoom(view, resolution, opt_anchor, opt_duration, opt_direction) {\n  resolution = view.constrainResolution(resolution, 0, opt_direction);\n  zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number} delta Delta from previous zoom level.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function zoomByDelta(view, delta, opt_anchor, opt_duration) {\n  const currentResolution = view.getResolution();\n  let resolution = view.constrainResolution(currentResolution, delta, 0);\n\n  if (resolution !== undefined) {\n    const resolutions = view.getResolutions();\n    resolution = clamp(\n      resolution,\n      view.getMinResolution() || resolutions[resolutions.length - 1],\n      view.getMaxResolution() || resolutions[0]);\n  }\n\n  // If we have a constraint on center, we need to change the anchor so that the\n  // new center is within the extent. We first calculate the new center, apply\n  // the constraint to it, and then calculate back the anchor\n  if (opt_anchor && resolution !== undefined && resolution !== currentResolution) {\n    const currentCenter = view.getCenter();\n    let center = view.calculateCenterZoom(resolution, opt_anchor);\n    center = view.constrainCenter(center);\n\n    opt_anchor = [\n      (resolution * currentCenter[0] - currentResolution * center[0]) /\n          (resolution - currentResolution),\n      (resolution * currentCenter[1] - currentResolution * center[1]) /\n          (resolution - currentResolution)\n    ];\n  }\n\n  zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} resolution Resolution to go to.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration) {\n  if (resolution) {\n    const currentResolution = view.getResolution();\n    const currentCenter = view.getCenter();\n    if (currentResolution !== undefined && currentCenter &&\n        resolution !== currentResolution && opt_duration) {\n      view.animate({\n        resolution: resolution,\n        anchor: opt_anchor,\n        duration: opt_duration,\n        easing: easeOut\n      });\n    } else {\n      if (opt_anchor) {\n        const center = view.calculateCenterZoom(resolution, opt_anchor);\n        view.setCenter(center);\n      }\n      view.setResolution(resolution);\n    }\n  }\n}\n\nexport default Interaction;\n","/**\n * @module ol/interaction/DoubleClickZoom\n */\nimport {inherits} from '../index.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [delta=1] The zoom delta applied on each double click.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom by double-clicking on the map.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/DoubleClickZoom~Options=} opt_options Options.\n * @api\n */\nconst DoubleClickZoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = options.delta ? options.delta : 1;\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(DoubleClickZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a\n * doubleclick) and eventually zooms the map.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/DoubleClickZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  const browserEvent = mapBrowserEvent.originalEvent;\n  if (mapBrowserEvent.type == MapBrowserEventType.DBLCLICK) {\n    const map = mapBrowserEvent.map;\n    const anchor = mapBrowserEvent.coordinate;\n    const delta = browserEvent.shiftKey ? -this.delta_ : this.delta_;\n    const view = map.getView();\n    zoomByDelta(view, delta, anchor, this.duration_);\n    mapBrowserEvent.preventDefault();\n    stopEvent = true;\n  }\n  return !stopEvent;\n}\n\nexport default DoubleClickZoom;\n","/**\n * @module ol/events/condition\n */\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport {assert} from '../asserts.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport {WEBKIT, MAC} from '../has.js';\n\n\n/**\n * A function that takes an {@link module:ol/MapBrowserEvent} and returns a\n * `{boolean}`. If the condition is met, true should be returned.\n *\n * @typedef {function(this: ?, module:ol/MapBrowserEvent): boolean} Condition\n */\n\n\n/**\n * Return `true` if only the alt-key is pressed, `false` otherwise (e.g. when\n * additionally the shift-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt key is pressed.\n * @api\n */\nexport const altKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the alt-key and shift-key is pressed, `false` otherwise\n * (e.g. when additionally the platform-modifier-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt and shift keys are pressed.\n * @api\n */\nexport const altShiftKeysOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the map has the focus. This condition requires a map target\n * element with a `tabindex` attribute, e.g. `<div id=\"map\" tabindex=\"1\">`.\n *\n * @param {module:ol/MapBrowserEvent} event Map browser event.\n * @return {boolean} The map has the focus.\n * @api\n */\nexport const focus = function(event) {\n  return event.target.getTargetElement() === document.activeElement;\n};\n\n\n/**\n * Return always true.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True.\n * @function\n * @api\n */\nexport const always = TRUE;\n\n\n/**\n * Return `true` if the event is a `click` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `click` event.\n * @api\n */\nexport const click = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.CLICK;\n};\n\n\n/**\n * Return `true` if the event has an \"action\"-producing mouse button.\n *\n * By definition, this includes left-click on windows/linux, and left-click\n * without the ctrl key on Macs.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} The result.\n */\nexport const mouseActionButton = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return originalEvent.button == 0 &&\n      !(WEBKIT && MAC && originalEvent.ctrlKey);\n};\n\n\n/**\n * Return always false.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} False.\n * @function\n * @api\n */\nexport const never = FALSE;\n\n\n/**\n * Return `true` if the browser event is a `pointermove` event, `false`\n * otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the browser event is a `pointermove` event.\n * @api\n */\nexport const pointerMove = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == 'pointermove';\n};\n\n\n/**\n * Return `true` if the event is a map `singleclick` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `singleclick` event.\n * @api\n */\nexport const singleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK;\n};\n\n\n/**\n * Return `true` if the event is a map `dblclick` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `dblclick` event.\n * @api\n */\nexport const doubleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.DBLCLICK;\n};\n\n\n/**\n * Return `true` if no modifier key (alt-, shift- or platform-modifier-key) is\n * pressed.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True only if there no modifier keys are pressed.\n * @api\n */\nexport const noModifierKeys = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the platform-modifier-key (the meta-key on Mac,\n * ctrl-key otherwise) is pressed, `false` otherwise (e.g. when additionally\n * the shift-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the platform modifier key is pressed.\n * @api\n */\nexport const platformModifierKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return !originalEvent.altKey &&\n    (MAC ? originalEvent.metaKey : originalEvent.ctrlKey) &&\n    !originalEvent.shiftKey;\n};\n\n\n/**\n * Return `true` if only the shift-key is pressed, `false` otherwise (e.g. when\n * additionally the alt-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the shift key is pressed.\n * @api\n */\nexport const shiftKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the target element is not editable, i.e. not a `<input>`-,\n * `<select>`- or `<textarea>`-element, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True only if the target element is not editable.\n * @api\n */\nexport const targetNotEditable = function(mapBrowserEvent) {\n  const target = mapBrowserEvent.originalEvent.target;\n  const tagName = target.tagName;\n  return (\n    tagName !== 'INPUT' &&\n      tagName !== 'SELECT' &&\n      tagName !== 'TEXTAREA');\n};\n\n\n/**\n * Return `true` if the event originates from a mouse device.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a mouse device.\n * @api\n */\nexport const mouseOnly = function(mapBrowserEvent) {\n  assert(mapBrowserEvent.pointerEvent, 56); // mapBrowserEvent must originate from a pointer event\n  // see http://www.w3.org/TR/pointerevents/#widl-PointerEvent-pointerType\n  return (\n    /** @type {module:ol/MapBrowserEvent} */ (mapBrowserEvent).pointerEvent.pointerType == 'mouse'\n  );\n};\n\n\n/**\n * Return `true` if the event originates from a primary pointer in\n * contact with the surface or if the left mouse button is pressed.\n * @see http://www.w3.org/TR/pointerevents/#button-states\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a primary pointer.\n * @api\n */\nexport const primaryAction = function(mapBrowserEvent) {\n  const pointerEvent = mapBrowserEvent.pointerEvent;\n  return pointerEvent.isPrimary && pointerEvent.button === 0;\n};\n","/**\n * @module ol/interaction/Pointer\n */\nimport {inherits} from '../index.js';\nimport {FALSE, UNDEFINED} from '../functions.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport Interaction from '../interaction/Interaction.js';\nimport {getValues} from '../obj.js';\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleDragEvent = UNDEFINED;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Capture dragging.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleUpEvent = FALSE;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Capture dragging.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleDownEvent = FALSE;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleMoveEvent = UNDEFINED;\n\n\n/**\n * @typedef {Object} Options\n * @property {(function(module:ol/MapBrowserPointerEvent):boolean)} [handleDownEvent]\n * Function handling \"down\" events. If the function returns `true` then a drag\n * sequence is started.\n * @property {(function(module:ol/MapBrowserPointerEvent))} [handleDragEvent]\n * Function handling \"drag\" events. This function is called on \"move\" events\n * during a drag sequence.\n * @property {(function(module:ol/MapBrowserEvent):boolean)} [handleEvent]\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. The function may return `false` to prevent the\n * propagation of the event to other interactions in the map's interactions\n * chain.\n * @property {(function(module:ol/MapBrowserPointerEvent))} [handleMoveEvent]\n * Function handling \"move\" events. This function is called on \"move\" events,\n * also during a drag sequence (so during a drag sequence both the\n * `handleDragEvent` function and this function are called).\n * @property {(function(module:ol/MapBrowserPointerEvent):boolean)} [handleUpEvent]\n *  Function handling \"up\" events. If the function returns `false` then the\n * current drag sequence is stopped.\n */\n\n\n/**\n * @classdesc\n * Base class that calls user-defined functions on `down`, `move` and `up`\n * events. This class also manages \"drag sequences\".\n *\n * When the `handleDownEvent` user function returns `true` a drag sequence is\n * started. During a drag sequence the `handleDragEvent` user function is\n * called on `move` events. The drag sequence ends when the `handleUpEvent`\n * user function is called and returns `false`.\n *\n * @constructor\n * @param {module:ol/interaction/Pointer~Options=} opt_options Options.\n * @extends {module:ol/interaction/Interaction}\n * @api\n */\nconst PointerInteraction = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  Interaction.call(this, {\n    handleEvent: options.handleEvent || handleEvent\n  });\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent):boolean}\n   * @private\n   */\n  this.handleDownEvent_ = options.handleDownEvent ?\n    options.handleDownEvent : handleDownEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent)}\n   * @private\n   */\n  this.handleDragEvent_ = options.handleDragEvent ?\n    options.handleDragEvent : handleDragEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent)}\n   * @private\n   */\n  this.handleMoveEvent_ = options.handleMoveEvent ?\n    options.handleMoveEvent : handleMoveEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent):boolean}\n   * @private\n   */\n  this.handleUpEvent_ = options.handleUpEvent ?\n    options.handleUpEvent : handleUpEvent;\n\n  /**\n   * @type {boolean}\n   * @protected\n   */\n  this.handlingDownUpSequence = false;\n\n  /**\n   * @type {!Object.<string, module:ol/pointer/PointerEvent>}\n   * @private\n   */\n  this.trackedPointers_ = {};\n\n  /**\n   * @type {Array.<module:ol/pointer/PointerEvent>}\n   * @protected\n   */\n  this.targetPointers = [];\n\n};\n\ninherits(PointerInteraction, Interaction);\n\n\n/**\n * @param {Array.<module:ol/pointer/PointerEvent>} pointerEvents List of events.\n * @return {module:ol~Pixel} Centroid pixel.\n */\nexport function centroid(pointerEvents) {\n  const length = pointerEvents.length;\n  let clientX = 0;\n  let clientY = 0;\n  for (let i = 0; i < length; i++) {\n    clientX += pointerEvents[i].clientX;\n    clientY += pointerEvents[i].clientY;\n  }\n  return [clientX / length, clientY / length];\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Whether the event is a pointerdown, pointerdrag\n *     or pointerup event.\n */\nfunction isPointerDraggingEvent(mapBrowserEvent) {\n  const type = mapBrowserEvent.type;\n  return type === MapBrowserEventType.POINTERDOWN ||\n    type === MapBrowserEventType.POINTERDRAG ||\n    type === MapBrowserEventType.POINTERUP;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @private\n */\nPointerInteraction.prototype.updateTrackedPointers_ = function(mapBrowserEvent) {\n  if (isPointerDraggingEvent(mapBrowserEvent)) {\n    const event = mapBrowserEvent.pointerEvent;\n\n    const id = event.pointerId.toString();\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n      delete this.trackedPointers_[id];\n    } else if (mapBrowserEvent.type ==\n        MapBrowserEventType.POINTERDOWN) {\n      this.trackedPointers_[id] = event;\n    } else if (id in this.trackedPointers_) {\n      // update only when there was a pointerdown event for this pointer\n      this.trackedPointers_[id] = event;\n    }\n    this.targetPointers = getValues(this.trackedPointers_);\n  }\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may call into\n * other functions, if event sequences like e.g. 'drag' or 'down-up' etc. are\n * detected.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Pointer}\n * @api\n */\nexport function handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n\n  let stopEvent = false;\n  this.updateTrackedPointers_(mapBrowserEvent);\n  if (this.handlingDownUpSequence) {\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERDRAG) {\n      this.handleDragEvent_(mapBrowserEvent);\n    } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n      const handledUp = this.handleUpEvent_(mapBrowserEvent);\n      this.handlingDownUpSequence = handledUp && this.targetPointers.length > 0;\n    }\n  } else {\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERDOWN) {\n      const handled = this.handleDownEvent_(mapBrowserEvent);\n      this.handlingDownUpSequence = handled;\n      stopEvent = this.shouldStopEvent(handled);\n    } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE) {\n      this.handleMoveEvent_(mapBrowserEvent);\n    }\n  }\n  return !stopEvent;\n}\n\n\n/**\n * This method is used to determine if \"down\" events should be propagated to\n * other interactions or should be stopped.\n *\n * The method receives the return code of the \"handleDownEvent\" function.\n *\n * By default this function is the \"identity\" function. It's overridden in\n * child classes.\n *\n * @param {boolean} handled Was the event handled by the interaction?\n * @return {boolean} Should the event be stopped?\n * @protected\n */\nPointerInteraction.prototype.shouldStopEvent = function(handled) {\n  return handled;\n};\n\nexport default PointerInteraction;\n","/**\n * @module ol/interaction/DragPan\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {scale as scaleCoordinate, rotate as rotateCoordinate, add as addCoordinate} from '../coordinate.js';\nimport {easeOut} from '../easing.js';\nimport {noModifierKeys} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~noModifierKeys}.\n * @property {module:ol/Kinetic} [kinetic] Kinetic inertia to apply to the pan.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map by dragging the map.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragPan~Options=} opt_options Options.\n * @api\n */\nconst DragPan = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/Kinetic|undefined}\n   */\n  this.kinetic_ = options.kinetic;\n\n  /**\n   * @type {module:ol~Pixel}\n   */\n  this.lastCentroid = null;\n\n  /**\n   * @type {number}\n   */\n  this.lastPointersCount_;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : noModifierKeys;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.noKinetic_ = false;\n\n};\n\ninherits(DragPan, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  const targetPointers = this.targetPointers;\n  const centroid = centroidFromPointers(targetPointers);\n  if (targetPointers.length == this.lastPointersCount_) {\n    if (this.kinetic_) {\n      this.kinetic_.update(centroid[0], centroid[1]);\n    }\n    if (this.lastCentroid) {\n      const deltaX = this.lastCentroid[0] - centroid[0];\n      const deltaY = centroid[1] - this.lastCentroid[1];\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      let center = [deltaX, deltaY];\n      scaleCoordinate(center, view.getResolution());\n      rotateCoordinate(center, view.getRotation());\n      addCoordinate(center, view.getCenter());\n      center = view.constrainCenter(center);\n      view.setCenter(center);\n    }\n  } else if (this.kinetic_) {\n    // reset so we don't overestimate the kinetic energy after\n    // after one finger down, tiny drag, second finger down\n    this.kinetic_.begin();\n  }\n  this.lastCentroid = centroid;\n  this.lastPointersCount_ = targetPointers.length;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (this.targetPointers.length === 0) {\n    if (!this.noKinetic_ && this.kinetic_ && this.kinetic_.end()) {\n      const distance = this.kinetic_.getDistance();\n      const angle = this.kinetic_.getAngle();\n      const center = /** @type {!module:ol/coordinate~Coordinate} */ (view.getCenter());\n      const centerpx = map.getPixelFromCoordinate(center);\n      const dest = map.getCoordinateFromPixel([\n        centerpx[0] - distance * Math.cos(angle),\n        centerpx[1] - distance * Math.sin(angle)\n      ]);\n      view.animate({\n        center: view.constrainCenter(dest),\n        duration: 500,\n        easing: easeOut\n      });\n    }\n    view.setHint(ViewHint.INTERACTING, -1);\n    return false;\n  } else {\n    if (this.kinetic_) {\n      // reset so we don't overestimate the kinetic energy after\n      // after one finger up, tiny drag, second finger up\n      this.kinetic_.begin();\n    }\n    this.lastCentroid = null;\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length > 0 && this.condition_(mapBrowserEvent)) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    this.lastCentroid = null;\n    if (!this.handlingDownUpSequence) {\n      view.setHint(ViewHint.INTERACTING, 1);\n    }\n    // stop any current animation\n    if (view.getAnimating()) {\n      view.setCenter(mapBrowserEvent.frameState.viewState.center);\n    }\n    if (this.kinetic_) {\n      this.kinetic_.begin();\n    }\n    // No kinetic as soon as more than one pointer on the screen is\n    // detected. This is to prevent nasty pans after pinch.\n    this.noKinetic_ = this.targetPointers.length > 1;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nDragPan.prototype.shouldStopEvent = FALSE;\nexport default DragPan;\n","/**\n * @module ol/interaction/DragRotate\n */\nimport {inherits} from '../index.js';\nimport {disable} from '../rotationconstraint.js';\nimport ViewHint from '../ViewHint.js';\nimport {altShiftKeysOnly, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport {rotate, rotateWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an\n * {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~altShiftKeysOnly}.\n * @property {number} [duration=250] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the alt and shift keys are held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragRotate~Options=} opt_options Options.\n * @api\n */\nconst DragRotate = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : altShiftKeysOnly;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n};\n\ninherits(DragRotate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (view.getConstraints().rotation === disable) {\n    return;\n  }\n  const size = map.getSize();\n  const offset = mapBrowserEvent.pixel;\n  const theta =\n      Math.atan2(size[1] / 2 - offset[1], offset[0] - size[0] / 2);\n  if (this.lastAngle_ !== undefined) {\n    const delta = theta - this.lastAngle_;\n    const rotation = view.getRotation();\n    rotateWithoutConstraints(view, rotation - delta);\n  }\n  this.lastAngle_ = theta;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n  const rotation = view.getRotation();\n  rotate(view, rotation, undefined, this.duration_);\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (mouseActionButton(mapBrowserEvent) && this.condition_(mapBrowserEvent)) {\n    const map = mapBrowserEvent.map;\n    map.getView().setHint(ViewHint.INTERACTING, 1);\n    this.lastAngle_ = undefined;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nDragRotate.prototype.shouldStopEvent = FALSE;\nexport default DragRotate;\n","/**\n * @module ol/render/Box\n */\n// FIXME add rotation\n\nimport {inherits} from '../index.js';\nimport Disposable from '../Disposable.js';\nimport Polygon from '../geom/Polygon.js';\n\n/**\n * @constructor\n * @extends {module:ol/Disposable}\n * @param {string} className CSS class name.\n */\nconst RenderBox = function(className) {\n\n  /**\n   * @type {module:ol/geom/Polygon}\n   * @private\n   */\n  this.geometry_ = null;\n\n  /**\n   * @type {HTMLDivElement}\n   * @private\n   */\n  this.element_ = /** @type {HTMLDivElement} */ (document.createElement('div'));\n  this.element_.style.position = 'absolute';\n  this.element_.className = 'ol-box ' + className;\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  /**\n   * @private\n   * @type {module:ol~Pixel}\n   */\n  this.startPixel_ = null;\n\n  /**\n   * @private\n   * @type {module:ol~Pixel}\n   */\n  this.endPixel_ = null;\n\n};\n\ninherits(RenderBox, Disposable);\n\n\n/**\n * @inheritDoc\n */\nRenderBox.prototype.disposeInternal = function() {\n  this.setMap(null);\n};\n\n\n/**\n * @private\n */\nRenderBox.prototype.render_ = function() {\n  const startPixel = this.startPixel_;\n  const endPixel = this.endPixel_;\n  const px = 'px';\n  const style = this.element_.style;\n  style.left = Math.min(startPixel[0], endPixel[0]) + px;\n  style.top = Math.min(startPixel[1], endPixel[1]) + px;\n  style.width = Math.abs(endPixel[0] - startPixel[0]) + px;\n  style.height = Math.abs(endPixel[1] - startPixel[1]) + px;\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n */\nRenderBox.prototype.setMap = function(map) {\n  if (this.map_) {\n    this.map_.getOverlayContainer().removeChild(this.element_);\n    const style = this.element_.style;\n    style.left = style.top = style.width = style.height = 'inherit';\n  }\n  this.map_ = map;\n  if (this.map_) {\n    this.map_.getOverlayContainer().appendChild(this.element_);\n  }\n};\n\n\n/**\n * @param {module:ol~Pixel} startPixel Start pixel.\n * @param {module:ol~Pixel} endPixel End pixel.\n */\nRenderBox.prototype.setPixels = function(startPixel, endPixel) {\n  this.startPixel_ = startPixel;\n  this.endPixel_ = endPixel;\n  this.createOrUpdateGeometry();\n  this.render_();\n};\n\n\n/**\n * Creates or updates the cached geometry.\n */\nRenderBox.prototype.createOrUpdateGeometry = function() {\n  const startPixel = this.startPixel_;\n  const endPixel = this.endPixel_;\n  const pixels = [\n    startPixel,\n    [startPixel[0], endPixel[1]],\n    endPixel,\n    [endPixel[0], startPixel[1]]\n  ];\n  const coordinates = pixels.map(this.map_.getCoordinateFromPixel, this.map_);\n  // close the polygon\n  coordinates[4] = coordinates[0].slice();\n  if (!this.geometry_) {\n    this.geometry_ = new Polygon([coordinates]);\n  } else {\n    this.geometry_.setCoordinates([coordinates]);\n  }\n};\n\n\n/**\n * @return {module:ol/geom/Polygon} Geometry.\n */\nRenderBox.prototype.getGeometry = function() {\n  return this.geometry_;\n};\nexport default RenderBox;\n","/**\n * @module ol/interaction/DragBox\n */\n// FIXME draw drag box\nimport Event from '../events/Event.js';\nimport {inherits} from '../index.js';\nimport {always, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {UNDEFINED} from '../functions.js';\nimport PointerInteraction from '../interaction/Pointer.js';\nimport RenderBox from '../render/Box.js';\n\n\n/**\n * A function that takes a {@link module:ol/MapBrowserEvent} and two\n * {@link module:ol~Pixel}s and returns a `{boolean}`. If the condition is met,\n * true should be returned.\n * @typedef {function(this: ?, module:ol/MapBrowserEvent, module:ol~Pixel, module:ol~Pixel):boolean} EndCondition\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragbox'] CSS class name for styling the box.\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link ol/events/condition~always}.\n * @property {number} [minArea=64] The minimum area of the box in pixel, this value is used by the default\n * `boxEndCondition` function.\n * @property {module:ol/interaction/DragBox~EndCondition} [boxEndCondition] A function that takes a {@link module:ol/MapBrowserEvent~MapBrowserEvent} and two\n * {@link module:ol~Pixel}s to indicate whether a `boxend` event should be fired.\n * Default is `true` if the area of the box is bigger than the `minArea` option.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragBoxEventType = {\n  /**\n   * Triggered upon drag box start.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxstart\n   * @api\n   */\n  BOXSTART: 'boxstart',\n\n  /**\n   * Triggered on drag when box is active.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxdrag\n   * @api\n   */\n  BOXDRAG: 'boxdrag',\n\n  /**\n   * Triggered upon drag box end.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxend\n   * @api\n   */\n  BOXEND: 'boxend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragBox~DragBox} instances are instances of\n * this type.\n *\n * @param {string} type The event type.\n * @param {module:ol/coordinate~Coordinate} coordinate The event coordinate.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Originating event.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst DragBoxEvent = function(type, coordinate, mapBrowserEvent) {\n  Event.call(this, type);\n\n  /**\n   * The coordinate of the drag event.\n   * @const\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = coordinate;\n\n  /**\n   * @const\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserEvent;\n\n};\n\ninherits(DragBoxEvent, Event);\n\n\n/**\n * @classdesc\n * Allows the user to draw a vector box by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the shift or other key is held down. This is used, for example,\n * for zooming to a specific area of the map\n * (see {@link module:ol/interaction/DragZoom~DragZoom} and\n * {@link module:ol/interaction/DragRotateAndZoom}).\n *\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/DragBox~DragBoxEvent\n * @param {module:ol/interaction/DragBox~Options=} opt_options Options.\n * @api\n */\nconst DragBox = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/render/Box}\n   * @private\n   */\n  this.box_ = new RenderBox(options.className || 'ol-dragbox');\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minArea_ = options.minArea !== undefined ? options.minArea : 64;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.startPixel_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : always;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/DragBox~EndCondition}\n   */\n  this.boxEndCondition_ = options.boxEndCondition ?\n    options.boxEndCondition : defaultBoxEndCondition;\n};\n\ninherits(DragBox, PointerInteraction);\n\n\n/**\n * The default condition for determining whether the boxend event\n * should fire.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent The originating MapBrowserEvent\n *     leading to the box end.\n * @param {module:ol~Pixel} startPixel The starting pixel of the box.\n * @param {module:ol~Pixel} endPixel The end pixel of the box.\n * @return {boolean} Whether or not the boxend condition should be fired.\n * @this {module:ol/interaction/DragBox}\n */\nfunction defaultBoxEndCondition(mapBrowserEvent, startPixel, endPixel) {\n  const width = endPixel[0] - startPixel[0];\n  const height = endPixel[1] - startPixel[1];\n  return width * width + height * height >= this.minArea_;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  this.box_.setPixels(this.startPixel_, mapBrowserEvent.pixel);\n\n  this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXDRAG,\n    mapBrowserEvent.coordinate, mapBrowserEvent));\n}\n\n\n/**\n * Returns geometry of last drawn box.\n * @return {module:ol/geom/Polygon} Geometry.\n * @api\n */\nDragBox.prototype.getGeometry = function() {\n  return this.box_.getGeometry();\n};\n\n\n/**\n * To be overridden by child classes.\n * FIXME: use constructor option instead of relying on overriding.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @protected\n */\nDragBox.prototype.onBoxEnd = UNDEFINED;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  this.box_.setMap(null);\n\n  if (this.boxEndCondition_(mapBrowserEvent,\n    this.startPixel_, mapBrowserEvent.pixel)) {\n    this.onBoxEnd(mapBrowserEvent);\n    this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXEND,\n      mapBrowserEvent.coordinate, mapBrowserEvent));\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (mouseActionButton(mapBrowserEvent) &&\n      this.condition_(mapBrowserEvent)) {\n    this.startPixel_ = mapBrowserEvent.pixel;\n    this.box_.setMap(mapBrowserEvent.map);\n    this.box_.setPixels(this.startPixel_, this.startPixel_);\n    this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXSTART,\n      mapBrowserEvent.coordinate, mapBrowserEvent));\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\nexport default DragBox;\n","/**\n * @module ol/interaction/DragZoom\n */\nimport {inherits} from '../index.js';\nimport {easeOut} from '../easing.js';\nimport {shiftKeyOnly} from '../events/condition.js';\nimport {createOrUpdateFromCoordinates, getBottomLeft, getCenter, getTopRight, scaleFromCenter} from '../extent.js';\nimport DragBox from '../interaction/DragBox.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragzoom'] CSS class name for styling the\n * box.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {boolean} [out=false] Use interaction for zooming out.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when a key, shift by default, is held down.\n *\n * To change the style of the box, use CSS and the `.ol-dragzoom` selector, or\n * your custom one configured with `className`.\n *\n * @constructor\n * @extends {module:ol/interaction/DragBox}\n * @param {module:ol/interaction/DragZoom~Options=} opt_options Options.\n * @api\n */\nconst DragZoom = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  const condition = options.condition ? options.condition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.out_ = options.out !== undefined ? options.out : false;\n\n  DragBox.call(this, {\n    condition: condition,\n    className: options.className || 'ol-dragzoom'\n  });\n\n};\n\ninherits(DragZoom, DragBox);\n\n\n/**\n * @inheritDoc\n */\nDragZoom.prototype.onBoxEnd = function() {\n  const map = this.getMap();\n\n  const view = /** @type {!module:ol/View} */ (map.getView());\n\n  const size = /** @type {!module:ol/size~Size} */ (map.getSize());\n\n  let extent = this.getGeometry().getExtent();\n\n  if (this.out_) {\n    const mapExtent = view.calculateExtent(size);\n    const boxPixelExtent = createOrUpdateFromCoordinates([\n      map.getPixelFromCoordinate(getBottomLeft(extent)),\n      map.getPixelFromCoordinate(getTopRight(extent))]);\n    const factor = view.getResolutionForExtent(boxPixelExtent, size);\n\n    scaleFromCenter(mapExtent, 1 / factor);\n    extent = mapExtent;\n  }\n\n  const resolution = view.constrainResolution(\n    view.getResolutionForExtent(extent, size));\n\n  let center = getCenter(extent);\n  center = view.constrainCenter(center);\n\n  view.animate({\n    resolution: resolution,\n    center: center,\n    duration: this.duration_,\n    easing: easeOut\n  });\n\n};\nexport default DragZoom;\n","/**\n * @module ol/events/KeyCode\n */\n\n/**\n * @enum {number}\n * @const\n */\nexport default {\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40\n};\n","/**\n * @module ol/interaction/KeyboardPan\n */\nimport {inherits} from '../index.js';\nimport {rotate as rotateCoordinate} from '../coordinate.js';\nimport EventType from '../events/EventType.js';\nimport KeyCode from '../events/KeyCode.js';\nimport {noModifierKeys, targetNotEditable} from '../events/condition.js';\nimport Interaction, {pan} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~noModifierKeys} and\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {number} [pixelDelta=128] The amount of pixels to pan on each key\n * press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map using keyboard arrows.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/KeyboardPan~Options=} opt_options Options.\n * @api\n */\nconst KeyboardPan = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @param {module:ol/MapBrowserEvent} mapBrowserEvent Browser event.\n   * @return {boolean} Combined condition result.\n   */\n  this.defaultCondition_ = function(mapBrowserEvent) {\n    return noModifierKeys(mapBrowserEvent) &&\n      targetNotEditable(mapBrowserEvent);\n  };\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition !== undefined ?\n    options.condition : this.defaultCondition_;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelDelta_ = options.pixelDelta !== undefined ?\n    options.pixelDelta : 128;\n\n};\n\ninherits(KeyboardPan, Interaction);\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides the direction to pan to (if an arrow key was\n * pressed).\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/KeyboardPan}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN) {\n    const keyEvent = mapBrowserEvent.originalEvent;\n    const keyCode = keyEvent.keyCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (keyCode == KeyCode.DOWN ||\n        keyCode == KeyCode.LEFT ||\n        keyCode == KeyCode.RIGHT ||\n        keyCode == KeyCode.UP)) {\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      const mapUnitsDelta = view.getResolution() * this.pixelDelta_;\n      let deltaX = 0, deltaY = 0;\n      if (keyCode == KeyCode.DOWN) {\n        deltaY = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.LEFT) {\n        deltaX = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.RIGHT) {\n        deltaX = mapUnitsDelta;\n      } else {\n        deltaY = mapUnitsDelta;\n      }\n      const delta = [deltaX, deltaY];\n      rotateCoordinate(delta, view.getRotation());\n      pan(view, delta, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardPan;\n","/**\n * @module ol/interaction/KeyboardZoom\n */\nimport {inherits} from '../index.js';\nimport EventType from '../events/EventType.js';\nimport {targetNotEditable} from '../events/condition.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [delta=1] The zoom level delta on each key press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map using keyboard + and -.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link moudle:ol/interaction/KeyboardPan~KeyboardPan}.\n *\n * @constructor\n * @param {module:ol/interaction/KeyboardZoom~Options=} opt_options Options.\n * @extends {module:ol/interaction/Interaction}\n * @api\n */\nconst KeyboardZoom = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : targetNotEditable;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = options.delta ? options.delta : 1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n};\n\ninherits(KeyboardZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides whether to zoom in or out (depending on whether the\n * key pressed was '+' or '-').\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/KeyboardZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN ||\n      mapBrowserEvent.type == EventType.KEYPRESS) {\n    const keyEvent = mapBrowserEvent.originalEvent;\n    const charCode = keyEvent.charCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (charCode == '+'.charCodeAt(0) || charCode == '-'.charCodeAt(0))) {\n      const map = mapBrowserEvent.map;\n      const delta = (charCode == '+'.charCodeAt(0)) ? this.delta_ : -this.delta_;\n      const view = map.getView();\n      zoomByDelta(view, delta, undefined, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardZoom;\n","/**\n * @module ol/interaction/MouseWheelZoom\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {always} from '../events/condition.js';\nimport {easeOut} from '../easing.js';\nimport EventType from '../events/EventType.js';\nimport {DEVICE_PIXEL_RATIO, FIREFOX, SAFARI} from '../has.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\nimport {clamp} from '../math.js';\n\n\n/**\n * Maximum mouse wheel delta.\n * @type {number}\n */\nconst MAX_DELTA = 1;\n\n\n/**\n * @enum {string}\n */\nexport const Mode = {\n  TRACKPAD: 'trackpad',\n  WHEEL: 'wheel'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~always}.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [timeout=80] Mouse wheel timeout duration in milliseconds.\n * @property {boolean} [constrainResolution=false] When using a trackpad or\n * magic mouse, zoom to the closest integer zoom level after the scroll gesture\n * ends.\n * @property {boolean} [useAnchor=true] Enable zooming using the mouse's\n * location as the anchor. When set to `false`, zooming in and out will zoom to\n * the center of the screen instead of zooming on the mouse's location.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by scrolling the mouse wheel.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/MouseWheelZoom~Options=} opt_options Options.\n * @api\n */\nconst MouseWheelZoom = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.timeout_ = options.timeout !== undefined ? options.timeout : 80;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.useAnchor_ = options.useAnchor !== undefined ? options.useAnchor : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.constrainResolution_ = options.constrainResolution || false;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : always;\n\n  /**\n   * @private\n   * @type {?module:ol/coordinate~Coordinate}\n   */\n  this.lastAnchor_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.startTime_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.timeoutId_ = undefined;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/MouseWheelZoom~Mode|undefined}\n   */\n  this.mode_ = undefined;\n\n  /**\n   * Trackpad events separated by this delay will be considered separate\n   * interactions.\n   * @type {number}\n   */\n  this.trackpadEventGap_ = 400;\n\n  /**\n   * @type {number|undefined}\n   */\n  this.trackpadTimeoutId_ = undefined;\n\n  /**\n   * The number of delta values per zoom level\n   * @private\n   * @type {number}\n   */\n  this.trackpadDeltaPerZoom_ = 300;\n\n  /**\n   * The zoom factor by which scroll zooming is allowed to exceed the limits.\n   * @private\n   * @type {number}\n   */\n  this.trackpadZoomBuffer_ = 1.5;\n\n};\n\ninherits(MouseWheelZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a\n * mousewheel-event) and eventually zooms the map.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} Allow event propagation.\n * @this {module:ol/interaction/MouseWheelZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!this.condition_(mapBrowserEvent)) {\n    return true;\n  }\n  const type = mapBrowserEvent.type;\n  if (type !== EventType.WHEEL && type !== EventType.MOUSEWHEEL) {\n    return true;\n  }\n\n  mapBrowserEvent.preventDefault();\n\n  const map = mapBrowserEvent.map;\n  const wheelEvent = /** @type {WheelEvent} */ (mapBrowserEvent.originalEvent);\n\n  if (this.useAnchor_) {\n    this.lastAnchor_ = mapBrowserEvent.coordinate;\n  }\n\n  // Delta normalisation inspired by\n  // https://github.com/mapbox/mapbox-gl-js/blob/001c7b9/js/ui/handler/scroll_zoom.js\n  let delta;\n  if (mapBrowserEvent.type == EventType.WHEEL) {\n    delta = wheelEvent.deltaY;\n    if (FIREFOX &&\n        wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\n      delta /= DEVICE_PIXEL_RATIO;\n    }\n    if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_LINE) {\n      delta *= 40;\n    }\n  } else if (mapBrowserEvent.type == EventType.MOUSEWHEEL) {\n    delta = -wheelEvent.wheelDeltaY;\n    if (SAFARI) {\n      delta /= 3;\n    }\n  }\n\n  if (delta === 0) {\n    return false;\n  }\n\n  const now = Date.now();\n\n  if (this.startTime_ === undefined) {\n    this.startTime_ = now;\n  }\n\n  if (!this.mode_ || now - this.startTime_ > this.trackpadEventGap_) {\n    this.mode_ = Math.abs(delta) < 4 ?\n      Mode.TRACKPAD :\n      Mode.WHEEL;\n  }\n\n  if (this.mode_ === Mode.TRACKPAD) {\n    const view = map.getView();\n    if (this.trackpadTimeoutId_) {\n      clearTimeout(this.trackpadTimeoutId_);\n    } else {\n      view.setHint(ViewHint.INTERACTING, 1);\n    }\n    this.trackpadTimeoutId_ = setTimeout(this.decrementInteractingHint_.bind(this), this.trackpadEventGap_);\n    let resolution = view.getResolution() * Math.pow(2, delta / this.trackpadDeltaPerZoom_);\n    const minResolution = view.getMinResolution();\n    const maxResolution = view.getMaxResolution();\n    let rebound = 0;\n    if (resolution < minResolution) {\n      resolution = Math.max(resolution, minResolution / this.trackpadZoomBuffer_);\n      rebound = 1;\n    } else if (resolution > maxResolution) {\n      resolution = Math.min(resolution, maxResolution * this.trackpadZoomBuffer_);\n      rebound = -1;\n    }\n    if (this.lastAnchor_) {\n      const center = view.calculateCenterZoom(resolution, this.lastAnchor_);\n      view.setCenter(view.constrainCenter(center));\n    }\n    view.setResolution(resolution);\n\n    if (rebound === 0 && this.constrainResolution_) {\n      view.animate({\n        resolution: view.constrainResolution(resolution, delta > 0 ? -1 : 1),\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: this.duration_\n      });\n    }\n\n    if (rebound > 0) {\n      view.animate({\n        resolution: minResolution,\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: 500\n      });\n    } else if (rebound < 0) {\n      view.animate({\n        resolution: maxResolution,\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: 500\n      });\n    }\n    this.startTime_ = now;\n    return false;\n  }\n\n  this.delta_ += delta;\n\n  const timeLeft = Math.max(this.timeout_ - (now - this.startTime_), 0);\n\n  clearTimeout(this.timeoutId_);\n  this.timeoutId_ = setTimeout(this.handleWheelZoom_.bind(this, map), timeLeft);\n\n  return false;\n}\n\n\n/**\n * @private\n */\nMouseWheelZoom.prototype.decrementInteractingHint_ = function() {\n  this.trackpadTimeoutId_ = undefined;\n  const view = this.getMap().getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n};\n\n\n/**\n * @private\n * @param {module:ol/PluggableMap} map Map.\n */\nMouseWheelZoom.prototype.handleWheelZoom_ = function(map) {\n  const view = map.getView();\n  if (view.getAnimating()) {\n    view.cancelAnimations();\n  }\n  const maxDelta = MAX_DELTA;\n  const delta = clamp(this.delta_, -maxDelta, maxDelta);\n  zoomByDelta(view, -delta, this.lastAnchor_, this.duration_);\n  this.mode_ = undefined;\n  this.delta_ = 0;\n  this.lastAnchor_ = null;\n  this.startTime_ = undefined;\n  this.timeoutId_ = undefined;\n};\n\n\n/**\n * Enable or disable using the mouse's location as an anchor when zooming\n * @param {boolean} useAnchor true to zoom to the mouse's location, false\n * to zoom to the center of the map\n * @api\n */\nMouseWheelZoom.prototype.setMouseAnchor = function(useAnchor) {\n  this.useAnchor_ = useAnchor;\n  if (!useAnchor) {\n    this.lastAnchor_ = null;\n  }\n};\n\n\nexport default MouseWheelZoom;\n","/**\n * @module ol/interaction/PinchRotate\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {FALSE} from '../functions.js';\nimport {rotate, rotateWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\nimport {disable} from '../rotationconstraint.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] The duration of the animation in\n * milliseconds.\n * @property {number} [threshold=0.3] Minimal angle in radians to start a rotation.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by twisting with two fingers\n * on a touch screen.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/PinchRotate~Options=} opt_options Options.\n * @api\n */\nconst PinchRotate = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.rotating_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.rotationDelta_ = 0.0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.threshold_ = options.threshold !== undefined ? options.threshold : 0.3;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(PinchRotate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  let rotationDelta = 0.0;\n\n  const touch0 = this.targetPointers[0];\n  const touch1 = this.targetPointers[1];\n\n  // angle between touches\n  const angle = Math.atan2(\n    touch1.clientY - touch0.clientY,\n    touch1.clientX - touch0.clientX);\n\n  if (this.lastAngle_ !== undefined) {\n    const delta = angle - this.lastAngle_;\n    this.rotationDelta_ += delta;\n    if (!this.rotating_ &&\n        Math.abs(this.rotationDelta_) > this.threshold_) {\n      this.rotating_ = true;\n    }\n    rotationDelta = delta;\n  }\n  this.lastAngle_ = angle;\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (view.getConstraints().rotation === disable) {\n    return;\n  }\n\n  // rotate anchor point.\n  // FIXME: should be the intersection point between the lines:\n  //     touch0,touch1 and previousTouch0,previousTouch1\n  const viewportPosition = map.getViewport().getBoundingClientRect();\n  const centroid = centroidFromPointers(this.targetPointers);\n  centroid[0] -= viewportPosition.left;\n  centroid[1] -= viewportPosition.top;\n  this.anchor_ = map.getCoordinateFromPixel(centroid);\n\n  // rotate\n  if (this.rotating_) {\n    const rotation = view.getRotation();\n    map.render();\n    rotateWithoutConstraints(view, rotation + rotationDelta, this.anchor_);\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (this.targetPointers.length < 2) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n    if (this.rotating_) {\n      const rotation = view.getRotation();\n      rotate(view, rotation, this.anchor_, this.duration_);\n    }\n    return false;\n  } else {\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length >= 2) {\n    const map = mapBrowserEvent.map;\n    this.anchor_ = null;\n    this.lastAngle_ = undefined;\n    this.rotating_ = false;\n    this.rotationDelta_ = 0.0;\n    if (!this.handlingDownUpSequence) {\n      map.getView().setHint(ViewHint.INTERACTING, 1);\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nPinchRotate.prototype.shouldStopEvent = FALSE;\n\nexport default PinchRotate;\n","/**\n * @module ol/interaction/PinchZoom\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport {FALSE} from '../functions.js';\nimport {zoom, zoomWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=400] Animation duration in milliseconds.\n * @property {boolean} [constrainResolution=false] Zoom to the closest integer\n * zoom level after the pinch gesture ends.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by pinching with two fingers\n * on a touch screen.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/PinchZoom~Options=} opt_options Options.\n * @api\n */\nconst PinchZoom = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.constrainResolution_ = options.constrainResolution || false;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastDistance_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.lastScaleDelta_ = 1;\n\n};\n\ninherits(PinchZoom, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  let scaleDelta = 1.0;\n\n  const touch0 = this.targetPointers[0];\n  const touch1 = this.targetPointers[1];\n  const dx = touch0.clientX - touch1.clientX;\n  const dy = touch0.clientY - touch1.clientY;\n\n  // distance between touches\n  const distance = Math.sqrt(dx * dx + dy * dy);\n\n  if (this.lastDistance_ !== undefined) {\n    scaleDelta = this.lastDistance_ / distance;\n  }\n  this.lastDistance_ = distance;\n\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const maxResolution = view.getMaxResolution();\n  const minResolution = view.getMinResolution();\n  let newResolution = resolution * scaleDelta;\n  if (newResolution > maxResolution) {\n    scaleDelta = maxResolution / resolution;\n    newResolution = maxResolution;\n  } else if (newResolution < minResolution) {\n    scaleDelta = minResolution / resolution;\n    newResolution = minResolution;\n  }\n\n  if (scaleDelta != 1.0) {\n    this.lastScaleDelta_ = scaleDelta;\n  }\n\n  // scale anchor point.\n  const viewportPosition = map.getViewport().getBoundingClientRect();\n  const centroid = centroidFromPointers(this.targetPointers);\n  centroid[0] -= viewportPosition.left;\n  centroid[1] -= viewportPosition.top;\n  this.anchor_ = map.getCoordinateFromPixel(centroid);\n\n  // scale, bypass the resolution constraint\n  map.render();\n  zoomWithoutConstraints(view, newResolution, this.anchor_);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (this.targetPointers.length < 2) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n    const resolution = view.getResolution();\n    if (this.constrainResolution_ ||\n        resolution < view.getMinResolution() ||\n        resolution > view.getMaxResolution()) {\n      // Zoom to final resolution, with an animation, and provide a\n      // direction not to zoom out/in if user was pinching in/out.\n      // Direction is > 0 if pinching out, and < 0 if pinching in.\n      const direction = this.lastScaleDelta_ - 1;\n      zoom(view, resolution, this.anchor_, this.duration_, direction);\n    }\n    return false;\n  } else {\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length >= 2) {\n    const map = mapBrowserEvent.map;\n    this.anchor_ = null;\n    this.lastDistance_ = undefined;\n    this.lastScaleDelta_ = 1;\n    if (!this.handlingDownUpSequence) {\n      map.getView().setHint(ViewHint.INTERACTING, 1);\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nPinchZoom.prototype.shouldStopEvent = FALSE;\nexport default PinchZoom;\n","/**\n * @module ol/interaction/DragAndDrop\n */\n// FIXME should handle all geo-referenced data, not just vector data\n\nimport {inherits} from '../index.js';\nimport {TRUE} from '../functions.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport Interaction from '../interaction/Interaction.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array.<function(new: module:ol/format/Feature)>} [formatConstructors] Format constructors.\n * @property {module:ol/source/Vector} [source] Optional vector source where features will be added.  If a source is provided\n * all existing features will be removed and new features will be added when\n * they are dropped on the target.  If you want to add features to a vector\n * source without removing the existing features (append only), instead of\n * providing the source option listen for the \"addfeatures\" event.\n * @property {module:ol/proj~ProjectionLike} [projection] Target projection. By default, the map's view's projection is used.\n * @property {Element} [target] The element that is used as the drop target, default is the viewport element.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragAndDropEventType = {\n  /**\n   * Triggered when features are added\n   * @event module:ol/interaction/DragAndDrop~DragAndDropEvent#addfeatures\n   * @api\n   */\n  ADD_FEATURES: 'addfeatures'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragAndDrop~DragAndDrop} instances are instances\n * of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/DragAndDrop~DragAndDropEventType} type Type.\n * @param {File} file File.\n * @param {Array.<module:ol/Feature>=} opt_features Features.\n * @param {module:ol/proj/Projection=} opt_projection Projection.\n */\nconst DragAndDropEvent = function(type, file, opt_features, opt_projection) {\n\n  Event.call(this, type);\n\n  /**\n   * The features parsed from dropped data.\n   * @type {Array.<module:ol/Feature>|undefined}\n   * @api\n   */\n  this.features = opt_features;\n\n  /**\n   * The dropped file.\n   * @type {File}\n   * @api\n   */\n  this.file = file;\n\n  /**\n   * The feature projection.\n   * @type {module:ol/proj/Projection|undefined}\n   * @api\n   */\n  this.projection = opt_projection;\n\n};\ninherits(DragAndDropEvent, Event);\n\n\n/**\n * @classdesc\n * Handles input of vector data by drag and drop.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @fires module:ol/interaction/DragAndDrop~DragAndDropEvent\n * @param {module:ol/interaction/DragAndDrop~Options=} opt_options Options.\n * @api\n */\nconst DragAndDrop = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  Interaction.call(this, {\n    handleEvent: TRUE\n  });\n\n  /**\n   * @private\n   * @type {Array.<function(new: module:ol/format/Feature)>}\n   */\n  this.formatConstructors_ = options.formatConstructors ?\n    options.formatConstructors : [];\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = options.projection ?\n    getProjection(options.projection) : null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.dropListenKeys_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/source/Vector}\n   */\n  this.source_ = options.source || null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.target = options.target ? options.target : null;\n\n};\n\ninherits(DragAndDrop, Interaction);\n\n\n/**\n * @param {DragEvent} event Event.\n * @this {module:ol/interaction/DragAndDrop}\n */\nfunction handleDrop(event) {\n  const files = event.dataTransfer.files;\n  for (let i = 0, ii = files.length; i < ii; ++i) {\n    const file = files.item(i);\n    const reader = new FileReader();\n    reader.addEventListener(EventType.LOAD, this.handleResult_.bind(this, file));\n    reader.readAsText(file);\n  }\n}\n\n\n/**\n * @param {DragEvent} event Event.\n */\nfunction handleStop(event) {\n  event.stopPropagation();\n  event.preventDefault();\n  event.dataTransfer.dropEffect = 'copy';\n}\n\n\n/**\n * @param {File} file File.\n * @param {Event} event Load event.\n * @private\n */\nDragAndDrop.prototype.handleResult_ = function(file, event) {\n  const result = event.target.result;\n  const map = this.getMap();\n  let projection = this.projection_;\n  if (!projection) {\n    const view = map.getView();\n    projection = view.getProjection();\n  }\n\n  const formatConstructors = this.formatConstructors_;\n  let features = [];\n  for (let i = 0, ii = formatConstructors.length; i < ii; ++i) {\n    /**\n     * Avoid \"cannot instantiate abstract class\" error.\n     * @type {Function}\n     */\n    const formatConstructor = formatConstructors[i];\n    /**\n     * @type {module:ol/format/Feature}\n     */\n    const format = new formatConstructor();\n    features = this.tryReadFeatures_(format, result, {\n      featureProjection: projection\n    });\n    if (features && features.length > 0) {\n      break;\n    }\n  }\n  if (this.source_) {\n    this.source_.clear();\n    this.source_.addFeatures(features);\n  }\n  this.dispatchEvent(\n    new DragAndDropEvent(\n      DragAndDropEventType.ADD_FEATURES, file,\n      features, projection));\n};\n\n\n/**\n * @private\n */\nDragAndDrop.prototype.registerListeners_ = function() {\n  const map = this.getMap();\n  if (map) {\n    const dropArea = this.target ? this.target : map.getViewport();\n    this.dropListenKeys_ = [\n      listen(dropArea, EventType.DROP, handleDrop, this),\n      listen(dropArea, EventType.DRAGENTER, handleStop, this),\n      listen(dropArea, EventType.DRAGOVER, handleStop, this),\n      listen(dropArea, EventType.DROP, handleStop, this)\n    ];\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nDragAndDrop.prototype.setActive = function(active) {\n  Interaction.prototype.setActive.call(this, active);\n  if (active) {\n    this.registerListeners_();\n  } else {\n    this.unregisterListeners_();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nDragAndDrop.prototype.setMap = function(map) {\n  this.unregisterListeners_();\n  Interaction.prototype.setMap.call(this, map);\n  if (this.getActive()) {\n    this.registerListeners_();\n  }\n};\n\n\n/**\n * @param {module:ol/format/Feature} format Format.\n * @param {string} text Text.\n * @param {module:ol/format/Feature~ReadOptions} options Read options.\n * @private\n * @return {Array.<module:ol/Feature>} Features.\n */\nDragAndDrop.prototype.tryReadFeatures_ = function(format, text, options) {\n  try {\n    return format.readFeatures(text, options);\n  } catch (e) {\n    return null;\n  }\n};\n\n\n/**\n * @private\n */\nDragAndDrop.prototype.unregisterListeners_ = function() {\n  if (this.dropListenKeys_) {\n    this.dropListenKeys_.forEach(unlistenByKey);\n    this.dropListenKeys_ = null;\n  }\n};\n\n\nexport default DragAndDrop;\n","/**\n * @module ol/interaction/DragRotateAndZoom\n */\nimport {inherits} from '../index.js';\nimport {disable} from '../rotationconstraint.js';\nimport ViewHint from '../ViewHint.js';\nimport {shiftKeyOnly, mouseOnly} from '../events/condition.js';\nimport {rotate, rotateWithoutConstraints, zoom, zoomWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=400] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom and rotate the map by clicking and dragging\n * on the map.  By default, this interaction is limited to when the shift\n * key is held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * And this interaction is not included in the default interactions.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragRotateAndZoom~Options=} opt_options Options.\n * @api\n */\nconst DragRotateAndZoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastMagnitude_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.lastScaleDelta_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n};\n\ninherits(DragRotateAndZoom, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  const map = mapBrowserEvent.map;\n  const size = map.getSize();\n  const offset = mapBrowserEvent.pixel;\n  const deltaX = offset[0] - size[0] / 2;\n  const deltaY = size[1] / 2 - offset[1];\n  const theta = Math.atan2(deltaY, deltaX);\n  const magnitude = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n  const view = map.getView();\n  if (view.getConstraints().rotation !== disable && this.lastAngle_ !== undefined) {\n    const angleDelta = theta - this.lastAngle_;\n    rotateWithoutConstraints(view, view.getRotation() - angleDelta);\n  }\n  this.lastAngle_ = theta;\n  if (this.lastMagnitude_ !== undefined) {\n    const resolution = this.lastMagnitude_ * (view.getResolution() / magnitude);\n    zoomWithoutConstraints(view, resolution);\n  }\n  if (this.lastMagnitude_ !== undefined) {\n    this.lastScaleDelta_ = this.lastMagnitude_ / magnitude;\n  }\n  this.lastMagnitude_ = magnitude;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n  const direction = this.lastScaleDelta_ - 1;\n  rotate(view, view.getRotation());\n  zoom(view, view.getResolution(), undefined, this.duration_, direction);\n  this.lastScaleDelta_ = 0;\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (this.condition_(mapBrowserEvent)) {\n    mapBrowserEvent.map.getView().setHint(ViewHint.INTERACTING, 1);\n    this.lastAngle_ = undefined;\n    this.lastMagnitude_ = undefined;\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport default DragRotateAndZoom;\n","/**\n * @module ol/geom/Circle\n */\nimport {inherits} from '../index.js';\nimport {createOrUpdate, forEachCorner, intersects} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinate} from '../geom/flat/deflate.js';\n\n/**\n * @classdesc\n * Circle geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number=} opt_radius Radius.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Circle = function(center, opt_radius, opt_layout) {\n  SimpleGeometry.call(this);\n  const radius = opt_radius ? opt_radius : 0;\n  this.setCenterAndRadius(center, radius, opt_layout);\n};\n\ninherits(Circle, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Circle} Clone.\n * @override\n * @api\n */\nCircle.prototype.clone = function() {\n  const circle = new Circle(null);\n  circle.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return circle;\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  const flatCoordinates = this.flatCoordinates;\n  const dx = x - flatCoordinates[0];\n  const dy = y - flatCoordinates[1];\n  const squaredDistance = dx * dx + dy * dy;\n  if (squaredDistance < minSquaredDistance) {\n    if (squaredDistance === 0) {\n      for (let i = 0; i < this.stride; ++i) {\n        closestPoint[i] = flatCoordinates[i];\n      }\n    } else {\n      const delta = this.getRadius() / Math.sqrt(squaredDistance);\n      closestPoint[0] = flatCoordinates[0] + delta * dx;\n      closestPoint[1] = flatCoordinates[1] + delta * dy;\n      for (let i = 2; i < this.stride; ++i) {\n        closestPoint[i] = flatCoordinates[i];\n      }\n    }\n    closestPoint.length = this.stride;\n    return squaredDistance;\n  } else {\n    return minSquaredDistance;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.containsXY = function(x, y) {\n  const flatCoordinates = this.flatCoordinates;\n  const dx = x - flatCoordinates[0];\n  const dy = y - flatCoordinates[1];\n  return dx * dx + dy * dy <= this.getRadiusSquared_();\n};\n\n\n/**\n * Return the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n * @return {module:ol/coordinate~Coordinate} Center.\n * @api\n */\nCircle.prototype.getCenter = function() {\n  return this.flatCoordinates.slice(0, this.stride);\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.computeExtent = function(extent) {\n  const flatCoordinates = this.flatCoordinates;\n  const radius = flatCoordinates[this.stride] - flatCoordinates[0];\n  return createOrUpdate(\n    flatCoordinates[0] - radius, flatCoordinates[1] - radius,\n    flatCoordinates[0] + radius, flatCoordinates[1] + radius,\n    extent);\n};\n\n\n/**\n * Return the radius of the circle.\n * @return {number} Radius.\n * @api\n */\nCircle.prototype.getRadius = function() {\n  return Math.sqrt(this.getRadiusSquared_());\n};\n\n\n/**\n * @private\n * @return {number} Radius squared.\n */\nCircle.prototype.getRadiusSquared_ = function() {\n  const dx = this.flatCoordinates[this.stride] - this.flatCoordinates[0];\n  const dy = this.flatCoordinates[this.stride + 1] - this.flatCoordinates[1];\n  return dx * dx + dy * dy;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nCircle.prototype.getType = function() {\n  return GeometryType.CIRCLE;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nCircle.prototype.intersectsExtent = function(extent) {\n  const circleExtent = this.getExtent();\n  if (intersects(extent, circleExtent)) {\n    const center = this.getCenter();\n\n    if (extent[0] <= center[0] && extent[2] >= center[0]) {\n      return true;\n    }\n    if (extent[1] <= center[1] && extent[3] >= center[1]) {\n      return true;\n    }\n\n    return forEachCorner(extent, this.intersectsCoordinate, this);\n  }\n  return false;\n\n};\n\n\n/**\n * Set the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @api\n */\nCircle.prototype.setCenter = function(center) {\n  const stride = this.stride;\n  const radius = this.flatCoordinates[stride] - this.flatCoordinates[0];\n  const flatCoordinates = center.slice();\n  flatCoordinates[stride] = flatCoordinates[0] + radius;\n  for (let i = 1; i < stride; ++i) {\n    flatCoordinates[stride + i] = center[i];\n  }\n  this.setFlatCoordinates(this.layout, flatCoordinates);\n};\n\n\n/**\n * Set the center (as {@link module:ol/coordinate~Coordinate coordinate}) and the radius (as\n * number) of the circle.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} radius Radius.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nCircle.prototype.setCenterAndRadius = function(center, radius, opt_layout) {\n  if (!center) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, center, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    /** @type {Array.<number>} */\n    const flatCoordinates = this.flatCoordinates;\n    let offset = deflateCoordinate(\n      flatCoordinates, 0, center, this.stride);\n    flatCoordinates[offset++] = flatCoordinates[0] + radius;\n    for (let i = 1, ii = this.stride; i < ii; ++i) {\n      flatCoordinates[offset++] = flatCoordinates[i];\n    }\n    flatCoordinates.length = offset;\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.getCoordinates = function() {};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.setCoordinates = function(coordinates, opt_layout) {};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nCircle.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\n\n\n/**\n * Set the radius of the circle. The radius is in the units of the projection.\n * @param {number} radius Radius.\n * @api\n */\nCircle.prototype.setRadius = function(radius) {\n  this.flatCoordinates[this.stride] = this.flatCoordinates[0] + radius;\n  this.changed();\n};\n\n\n/**\n * Transform each coordinate of the circle from one coordinate reference system\n * to another. The geometry is modified in place.\n * If you do not want the geometry modified in place, first clone() it and\n * then use this function on the clone.\n *\n * Internally a circle is currently represented by two points: the center of\n * the circle `[cx, cy]`, and the point to the right of the circle\n * `[cx + r, cy]`. This `transform` function just transforms these two points.\n * So the resulting geometry is also a circle, and that circle does not\n * correspond to the shape that would be obtained by transforming every point\n * of the original circle.\n *\n * @param {module:ol/proj~ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {module:ol/proj~ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {module:ol/geom/Circle} This geometry.  Note that original geometry is\n *     modified in place.\n * @function\n * @api\n */\nCircle.prototype.transform;\nexport default Circle;\n","/**\n * @module ol/geom/MultiLineString\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateCoordinatesArray} from '../geom/flat/inflate.js';\nimport {interpolatePoint, lineStringsCoordinateAtM} from '../geom/flat/interpolate.js';\nimport {intersectsLineStringArray} from '../geom/flat/intersectsextent.js';\nimport {douglasPeuckerArray} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-linestring geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiLineString = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.ends_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(MultiLineString, SimpleGeometry);\n\n\n/**\n * Append the passed linestring to the multilinestring.\n * @param {module:ol/geom/LineString} lineString LineString.\n * @api\n */\nMultiLineString.prototype.appendLineString = function(lineString) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = lineString.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, lineString.getFlatCoordinates().slice());\n  }\n  this.ends_.push(this.flatCoordinates.length);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiLineString} Clone.\n * @override\n * @api\n */\nMultiLineString.prototype.clone = function() {\n  const multiLineString = new MultiLineString(null);\n  multiLineString.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), this.ends_.slice());\n  return multiLineString;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiLineString.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.ends_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestArrayPoint(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Returns the coordinate at `m` using linear interpolation, or `null` if no\n * such coordinate exists.\n *\n * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n * M will return the first coordinate and Ms greater than the last M will\n * return the last coordinate.\n *\n * `opt_interpolate` controls interpolation between consecutive LineStrings\n * within the MultiLineString. If `opt_interpolate` is `true` the coordinates\n * will be linearly interpolated between the last coordinate of one LineString\n * and the first coordinate of the next LineString.  If `opt_interpolate` is\n * `false` then the function will return `null` for Ms falling between\n * LineStrings.\n *\n * @param {number} m M.\n * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n * @param {boolean=} opt_interpolate Interpolate. Default is `false`.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nMultiLineString.prototype.getCoordinateAtM = function(m, opt_extrapolate, opt_interpolate) {\n  if ((this.layout != GeometryLayout.XYM &&\n       this.layout != GeometryLayout.XYZM) ||\n      this.flatCoordinates.length === 0) {\n    return null;\n  }\n  const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n  const interpolate = opt_interpolate !== undefined ? opt_interpolate : false;\n  return lineStringsCoordinateAtM(this.flatCoordinates, 0,\n    this.ends_, this.stride, m, extrapolate, interpolate);\n};\n\n\n/**\n * Return the coordinates of the multilinestring.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinates.\n * @override\n * @api\n */\nMultiLineString.prototype.getCoordinates = function() {\n  return inflateCoordinatesArray(\n    this.flatCoordinates, 0, this.ends_, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Ends.\n */\nMultiLineString.prototype.getEnds = function() {\n  return this.ends_;\n};\n\n\n/**\n * Return the linestring at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/LineString} LineString.\n * @api\n */\nMultiLineString.prototype.getLineString = function(index) {\n  if (index < 0 || this.ends_.length <= index) {\n    return null;\n  }\n  const lineString = new LineString(null);\n  lineString.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]));\n  return lineString;\n};\n\n\n/**\n * Return the linestrings of this multilinestring.\n * @return {Array.<module:ol/geom/LineString>} LineStrings.\n * @api\n */\nMultiLineString.prototype.getLineStrings = function() {\n  const flatCoordinates = this.flatCoordinates;\n  const ends = this.ends_;\n  const layout = this.layout;\n  /** @type {Array.<module:ol/geom/LineString>} */\n  const lineStrings = [];\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const lineString = new LineString(null);\n    lineString.setFlatCoordinates(layout, flatCoordinates.slice(offset, end));\n    lineStrings.push(lineString);\n    offset = end;\n  }\n  return lineStrings;\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoints.\n */\nMultiLineString.prototype.getFlatMidpoints = function() {\n  const midpoints = [];\n  const flatCoordinates = this.flatCoordinates;\n  let offset = 0;\n  const ends = this.ends_;\n  const stride = this.stride;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const midpoint = interpolatePoint(\n      flatCoordinates, offset, end, stride, 0.5);\n    extend(midpoints, midpoint);\n    offset = end;\n  }\n  return midpoints;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiLineString.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEnds = [];\n  simplifiedFlatCoordinates.length = douglasPeuckerArray(\n    this.flatCoordinates, 0, this.ends_, this.stride, squaredTolerance,\n    simplifiedFlatCoordinates, 0, simplifiedEnds);\n  const simplifiedMultiLineString = new MultiLineString(null);\n  simplifiedMultiLineString.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEnds);\n  return simplifiedMultiLineString;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiLineString.prototype.getType = function() {\n  return GeometryType.MULTI_LINE_STRING;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiLineString.prototype.intersectsExtent = function(extent) {\n  return intersectsLineStringArray(\n    this.flatCoordinates, 0, this.ends_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the multilinestring.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiLineString.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.ends_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<number>} ends Ends.\n */\nMultiLineString.prototype.setFlatCoordinates = function(layout, flatCoordinates, ends) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.ends_ = ends;\n  this.changed();\n};\n\n\n/**\n * @param {Array.<module:ol/geom/LineString>} lineStrings LineStrings.\n */\nMultiLineString.prototype.setLineStrings = function(lineStrings) {\n  let layout = this.getLayout();\n  const flatCoordinates = [];\n  const ends = [];\n  for (let i = 0, ii = lineStrings.length; i < ii; ++i) {\n    const lineString = lineStrings[i];\n    if (i === 0) {\n      layout = lineString.getLayout();\n    }\n    extend(flatCoordinates, lineString.getFlatCoordinates());\n    ends.push(flatCoordinates.length);\n  }\n  this.setFlatCoordinates(layout, flatCoordinates, ends);\n};\nexport default MultiLineString;\n","/**\n * @module ol/geom/MultiPoint\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, containsXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Multi-point geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiPoint = function(coordinates, opt_layout) {\n  SimpleGeometry.call(this);\n  this.setCoordinates(coordinates, opt_layout);\n};\n\ninherits(MultiPoint, SimpleGeometry);\n\n\n/**\n * Append the passed point to this multipoint.\n * @param {module:ol/geom/Point} point Point.\n * @api\n */\nMultiPoint.prototype.appendPoint = function(point) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = point.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, point.getFlatCoordinates());\n  }\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiPoint} Clone.\n * @override\n * @api\n */\nMultiPoint.prototype.clone = function() {\n  const multiPoint = new MultiPoint(null);\n  multiPoint.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return multiPoint;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPoint.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  const flatCoordinates = this.flatCoordinates;\n  const stride = this.stride;\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const squaredDistance = squaredDx(\n      x, y, flatCoordinates[i], flatCoordinates[i + 1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (let j = 0; j < stride; ++j) {\n        closestPoint[j] = flatCoordinates[i + j];\n      }\n      closestPoint.length = stride;\n    }\n  }\n  return minSquaredDistance;\n};\n\n\n/**\n * Return the coordinates of the multipoint.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nMultiPoint.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the point at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/Point} Point.\n * @api\n */\nMultiPoint.prototype.getPoint = function(index) {\n  const n = !this.flatCoordinates ? 0 : this.flatCoordinates.length / this.stride;\n  if (index < 0 || n <= index) {\n    return null;\n  }\n  const point = new Point(null);\n  point.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index * this.stride, (index + 1) * this.stride));\n  return point;\n};\n\n\n/**\n * Return the points of this multipoint.\n * @return {Array.<module:ol/geom/Point>} Points.\n * @api\n */\nMultiPoint.prototype.getPoints = function() {\n  const flatCoordinates = this.flatCoordinates;\n  const layout = this.layout;\n  const stride = this.stride;\n  /** @type {Array.<module:ol/geom/Point>} */\n  const points = [];\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const point = new Point(null);\n    point.setFlatCoordinates(layout, flatCoordinates.slice(i, i + stride));\n    points.push(point);\n  }\n  return points;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPoint.prototype.getType = function() {\n  return GeometryType.MULTI_POINT;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPoint.prototype.intersectsExtent = function(extent) {\n  const flatCoordinates = this.flatCoordinates;\n  const stride = this.stride;\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const x = flatCoordinates[i];\n    const y = flatCoordinates[i + 1];\n    if (containsXY(extent, x, y)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Set the coordinates of the multipoint.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiPoint.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nMultiPoint.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default MultiPoint;\n","/**\n * @module ol/geom/flat/center\n */\nimport {createEmpty, createOrUpdateFromFlatCoordinates} from '../../extent.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {Array.<number>} Flat centers.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  const flatCenters = [];\n  let extent = createEmpty();\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    extent = createOrUpdateFromFlatCoordinates(flatCoordinates, offset, ends[0], stride);\n    flatCenters.push((extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2);\n    offset = ends[ends.length - 1];\n  }\n  return flatCenters;\n}\n","/**\n * @module ol/geom/MultiPolygon\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport Polygon from '../geom/Polygon.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {linearRingss as linearRingssArea} from '../geom/flat/area.js';\nimport {linearRingss as linearRingssCenter} from '../geom/flat/center.js';\nimport {assignClosestMultiArrayPoint, multiArrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {linearRingssContainsXY} from '../geom/flat/contains.js';\nimport {deflateMultiCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateMultiCoordinatesArray} from '../geom/flat/inflate.js';\nimport {getInteriorPointsOfMultiArray} from '../geom/flat/interiorpoint.js';\nimport {intersectsLinearRingMultiArray} from '../geom/flat/intersectsextent.js';\nimport {linearRingsAreOriented, orientLinearRingsArray} from '../geom/flat/orient.js';\nimport {quantizeMultiArray} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-polygon geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiPolygon = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<Array.<number>>}\n   * @private\n   */\n  this.endss_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatInteriorPointsRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.flatInteriorPoints_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.orientedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.orientedFlatCoordinates_ = null;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(MultiPolygon, SimpleGeometry);\n\n\n/**\n * Append the passed polygon to this multipolygon.\n * @param {module:ol/geom/Polygon} polygon Polygon.\n * @api\n */\nMultiPolygon.prototype.appendPolygon = function(polygon) {\n  /** @type {Array.<number>} */\n  let ends;\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = polygon.getFlatCoordinates().slice();\n    ends = polygon.getEnds().slice();\n    this.endss_.push();\n  } else {\n    const offset = this.flatCoordinates.length;\n    extend(this.flatCoordinates, polygon.getFlatCoordinates());\n    ends = polygon.getEnds().slice();\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      ends[i] += offset;\n    }\n  }\n  this.endss_.push(ends);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiPolygon} Clone.\n * @override\n * @api\n */\nMultiPolygon.prototype.clone = function() {\n  const multiPolygon = new MultiPolygon(null);\n\n  const len = this.endss_.length;\n  const newEndss = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    newEndss[i] = this.endss_[i].slice();\n  }\n\n  multiPolygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), newEndss);\n  return multiPolygon;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(multiArrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.endss_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestMultiArrayPoint(\n    this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.containsXY = function(x, y) {\n  return linearRingssContainsXY(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, x, y);\n};\n\n\n/**\n * Return the area of the multipolygon on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nMultiPolygon.prototype.getArea = function() {\n  return linearRingssArea(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride);\n};\n\n\n/**\n * Get the coordinate array for this geometry.  This array has the structure\n * of a GeoJSON coordinate array for multi-polygons.\n *\n * @param {boolean=} opt_right Orient coordinates according to the right-hand\n *     rule (counter-clockwise for exterior and clockwise for interior rings).\n *     If `false`, coordinates will be oriented according to the left-hand rule\n *     (clockwise for exterior and counter-clockwise for interior rings).\n *     By default, coordinate orientation will depend on how the geometry was\n *     constructed.\n * @return {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} Coordinates.\n * @override\n * @api\n */\nMultiPolygon.prototype.getCoordinates = function(opt_right) {\n  let flatCoordinates;\n  if (opt_right !== undefined) {\n    flatCoordinates = this.getOrientedFlatCoordinates().slice();\n    orientLinearRingsArray(\n      flatCoordinates, 0, this.endss_, this.stride, opt_right);\n  } else {\n    flatCoordinates = this.flatCoordinates;\n  }\n\n  return inflateMultiCoordinatesArray(\n    flatCoordinates, 0, this.endss_, this.stride);\n};\n\n\n/**\n * @return {Array.<Array.<number>>} Endss.\n */\nMultiPolygon.prototype.getEndss = function() {\n  return this.endss_;\n};\n\n\n/**\n * @return {Array.<number>} Flat interior points.\n */\nMultiPolygon.prototype.getFlatInteriorPoints = function() {\n  if (this.flatInteriorPointsRevision_ != this.getRevision()) {\n    const flatCenters = linearRingssCenter(\n      this.flatCoordinates, 0, this.endss_, this.stride);\n    this.flatInteriorPoints_ = getInteriorPointsOfMultiArray(\n      this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n      flatCenters);\n    this.flatInteriorPointsRevision_ = this.getRevision();\n  }\n  return this.flatInteriorPoints_;\n};\n\n\n/**\n * Return the interior points as {@link module:ol/geom/MultiPoint multipoint}.\n * @return {module:ol/geom/MultiPoint} Interior points as XYM coordinates, where M is\n * the length of the horizontal intersection that the point belongs to.\n * @api\n */\nMultiPolygon.prototype.getInteriorPoints = function() {\n  const interiorPoints = new MultiPoint(null);\n  interiorPoints.setFlatCoordinates(GeometryLayout.XYM,\n    this.getFlatInteriorPoints().slice());\n  return interiorPoints;\n};\n\n\n/**\n * @return {Array.<number>} Oriented flat coordinates.\n */\nMultiPolygon.prototype.getOrientedFlatCoordinates = function() {\n  if (this.orientedRevision_ != this.getRevision()) {\n    const flatCoordinates = this.flatCoordinates;\n    if (linearRingsAreOriented(\n      flatCoordinates, 0, this.endss_, this.stride)) {\n      this.orientedFlatCoordinates_ = flatCoordinates;\n    } else {\n      this.orientedFlatCoordinates_ = flatCoordinates.slice();\n      this.orientedFlatCoordinates_.length =\n          orientLinearRingsArray(\n            this.orientedFlatCoordinates_, 0, this.endss_, this.stride);\n    }\n    this.orientedRevision_ = this.getRevision();\n  }\n  return this.orientedFlatCoordinates_;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEndss = [];\n  simplifiedFlatCoordinates.length = quantizeMultiArray(\n    this.flatCoordinates, 0, this.endss_, this.stride,\n    Math.sqrt(squaredTolerance),\n    simplifiedFlatCoordinates, 0, simplifiedEndss);\n  const simplifiedMultiPolygon = new MultiPolygon(null);\n  simplifiedMultiPolygon.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEndss);\n  return simplifiedMultiPolygon;\n};\n\n\n/**\n * Return the polygon at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/Polygon} Polygon.\n * @api\n */\nMultiPolygon.prototype.getPolygon = function(index) {\n  if (index < 0 || this.endss_.length <= index) {\n    return null;\n  }\n  let offset;\n  if (index === 0) {\n    offset = 0;\n  } else {\n    const prevEnds = this.endss_[index - 1];\n    offset = prevEnds[prevEnds.length - 1];\n  }\n  const ends = this.endss_[index].slice();\n  const end = ends[ends.length - 1];\n  if (offset !== 0) {\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      ends[i] -= offset;\n    }\n  }\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(offset, end), ends);\n  return polygon;\n};\n\n\n/**\n * Return the polygons of this multipolygon.\n * @return {Array.<module:ol/geom/Polygon>} Polygons.\n * @api\n */\nMultiPolygon.prototype.getPolygons = function() {\n  const layout = this.layout;\n  const flatCoordinates = this.flatCoordinates;\n  const endss = this.endss_;\n  const polygons = [];\n  let offset = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i].slice();\n    const end = ends[ends.length - 1];\n    if (offset !== 0) {\n      for (let j = 0, jj = ends.length; j < jj; ++j) {\n        ends[j] -= offset;\n      }\n    }\n    const polygon = new Polygon(null);\n    polygon.setFlatCoordinates(\n      layout, flatCoordinates.slice(offset, end), ends);\n    polygons.push(polygon);\n    offset = end;\n  }\n  return polygons;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPolygon.prototype.getType = function() {\n  return GeometryType.MULTI_POLYGON;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPolygon.prototype.intersectsExtent = function(extent) {\n  return intersectsLinearRingMultiArray(\n    this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the multipolygon.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiPolygon.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.endss_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 3);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const endss = deflateMultiCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.endss_);\n    if (endss.length === 0) {\n      this.flatCoordinates.length = 0;\n    } else {\n      const lastEnds = endss[endss.length - 1];\n      this.flatCoordinates.length = lastEnds.length === 0 ?\n        0 : lastEnds[lastEnds.length - 1];\n    }\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<Array.<number>>} endss Endss.\n */\nMultiPolygon.prototype.setFlatCoordinates = function(layout, flatCoordinates, endss) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.endss_ = endss;\n  this.changed();\n};\n\n\n/**\n * @param {Array.<module:ol/geom/Polygon>} polygons Polygons.\n */\nMultiPolygon.prototype.setPolygons = function(polygons) {\n  let layout = this.getLayout();\n  const flatCoordinates = [];\n  const endss = [];\n  for (let i = 0, ii = polygons.length; i < ii; ++i) {\n    const polygon = polygons[i];\n    if (i === 0) {\n      layout = polygon.getLayout();\n    }\n    const offset = flatCoordinates.length;\n    const ends = polygon.getEnds();\n    for (let j = 0, jj = ends.length; j < jj; ++j) {\n      ends[j] += offset;\n    }\n    extend(flatCoordinates, polygon.getFlatCoordinates());\n    endss.push(ends);\n  }\n  this.setFlatCoordinates(layout, flatCoordinates, endss);\n};\n\nexport default MultiPolygon;\n","/**\n * @module ol/LayerType\n */\n\n/**\n * A layer type used when creating layer renderers.\n * @enum {string}\n */\nexport default {\n  IMAGE: 'IMAGE',\n  TILE: 'TILE',\n  VECTOR_TILE: 'VECTOR_TILE',\n  VECTOR: 'VECTOR'\n};\n","/**\n * @module ol/layer/VectorRenderType\n */\n\n/**\n * @enum {string}\n * Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance.\n * @api\n */\nexport default {\n  IMAGE: 'image',\n  VECTOR: 'vector'\n};\n","/**\n * @module ol/layer/Vector\n */\nimport {inherits} from '../index.js';\nimport LayerType from '../LayerType.js';\nimport Layer from '../layer/Layer.js';\nimport VectorRenderType from '../layer/VectorRenderType.js';\nimport {assign} from '../obj.js';\nimport {createDefaultStyle, toFunction as toStyleFunction} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/render~OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created. Use\n * `null` to avoid the sort, but get an undefined draw order.\n * @property {number} [renderBuffer=100] The buffer in pixels around the viewport extent used by the\n * renderer when getting features from the vector source for the rendering or hit-detection.\n * Recommended value: the size of the largest symbol, line width or label.\n * @property {module:ol/layer/VectorRenderType|string} [renderMode='vector'] Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but point symbols and\n *    texts are always rotated with the view and pixels are scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering even during\n *    animations, but slower performance.\n * @property {module:ol/source/Vector} [source] Source.\n * @property {module:ol/PluggableMap} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [declutter=false] Declutter images and text. Decluttering is applied to all\n * image and text styles, and the priority is defined by the z-index of the style. Lower z-index\n * means higher priority.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {boolean} [updateWhileAnimating=false] When set to `true` and `renderMode`\n * is `vector`, feature batches will be recreated during animations. This means that no\n * vectors will be shown clipped, but the setting will have a performance impact for large\n * amounts of vector data. When set to `false`, batches will be recreated when no animation\n * is active.\n * @property {boolean} [updateWhileInteracting=false] When set to `true` and `renderMode`\n * is `vector`, feature batches will be recreated during interactions. See also\n * `updateWhileAnimating`.\n */\n\n\n/**\n * @enum {string}\n * Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance.\n * @api\n */\nexport const RenderType = {\n  IMAGE: 'image',\n  VECTOR: 'vector'\n};\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  RENDER_ORDER: 'renderOrder'\n};\n\n\n/**\n * @classdesc\n * Vector data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Layer}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Vector~Options=} opt_options Options.\n * @api\n */\nconst VectorLayer = function(opt_options) {\n  const options = opt_options ?\n    opt_options : /** @type {module:ol/layer/Vector~Options} */ ({});\n\n  const baseOptions = assign({}, options);\n\n  delete baseOptions.style;\n  delete baseOptions.renderBuffer;\n  delete baseOptions.updateWhileAnimating;\n  delete baseOptions.updateWhileInteracting;\n  Layer.call(this, /** @type {module:ol/layer/Layer~Options} */ (baseOptions));\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.declutter_ = options.declutter !== undefined ? options.declutter : false;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.renderBuffer_ = options.renderBuffer !== undefined ?\n    options.renderBuffer : 100;\n\n  /**\n   * User provided style.\n   * @type {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n   * @private\n   */\n  this.style_ = null;\n\n  /**\n   * Style function for use within the library.\n   * @type {module:ol/style/Style~StyleFunction|undefined}\n   * @private\n   */\n  this.styleFunction_ = undefined;\n\n  this.setStyle(options.style);\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.updateWhileAnimating_ = options.updateWhileAnimating !== undefined ?\n    options.updateWhileAnimating : false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.updateWhileInteracting_ = options.updateWhileInteracting !== undefined ?\n    options.updateWhileInteracting : false;\n\n  /**\n   * @private\n   * @type {module:ol/layer/VectorTileRenderType|string}\n   */\n  this.renderMode_ = options.renderMode || VectorRenderType.VECTOR;\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {module:ol/LayerType}\n   */\n  this.type = LayerType.VECTOR;\n\n};\n\ninherits(VectorLayer, Layer);\n\n\n/**\n * @return {boolean} Declutter.\n */\nVectorLayer.prototype.getDeclutter = function() {\n  return this.declutter_;\n};\n\n\n/**\n * @param {boolean} declutter Declutter.\n */\nVectorLayer.prototype.setDeclutter = function(declutter) {\n  this.declutter_ = declutter;\n};\n\n\n/**\n * @return {number|undefined} Render buffer.\n */\nVectorLayer.prototype.getRenderBuffer = function() {\n  return this.renderBuffer_;\n};\n\n\n/**\n * @return {function(module:ol/Feature, module:ol/Feature): number|null|undefined} Render\n *     order.\n */\nVectorLayer.prototype.getRenderOrder = function() {\n  return (\n    /** @type {module:ol/render~OrderFunction|null|undefined} */ (this.get(Property.RENDER_ORDER))\n  );\n};\n\n\n/**\n * Return the associated {@link module:ol/source/Vector vectorsource} of the layer.\n * @function\n * @return {module:ol/source/Vector} Source.\n * @api\n */\nVectorLayer.prototype.getSource;\n\n\n/**\n * Get the style for features.  This returns whatever was passed to the `style`\n * option at construction or to the `setStyle` method.\n * @return {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n *     Layer style.\n * @api\n */\nVectorLayer.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Get the style function.\n * @return {module:ol/style/Style~StyleFunction|undefined} Layer style function.\n * @api\n */\nVectorLayer.prototype.getStyleFunction = function() {\n  return this.styleFunction_;\n};\n\n\n/**\n * @return {boolean} Whether the rendered layer should be updated while\n *     animating.\n */\nVectorLayer.prototype.getUpdateWhileAnimating = function() {\n  return this.updateWhileAnimating_;\n};\n\n\n/**\n * @return {boolean} Whether the rendered layer should be updated while\n *     interacting.\n */\nVectorLayer.prototype.getUpdateWhileInteracting = function() {\n  return this.updateWhileInteracting_;\n};\n\n\n/**\n * @param {module:ol/render~OrderFunction|null|undefined} renderOrder\n *     Render order.\n */\nVectorLayer.prototype.setRenderOrder = function(renderOrder) {\n  this.set(Property.RENDER_ORDER, renderOrder);\n};\n\n\n/**\n * Set the style for features.  This can be a single style object, an array\n * of styles, or a function that takes a feature and resolution and returns\n * an array of styles. If it is `undefined` the default style is used. If\n * it is `null` the layer has no style (a `null` style), so only features\n * that have their own styles will be rendered in the layer. See\n * {@link module:ol/style} for information on the default style.\n * @param {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction|null|undefined}\n *     style Layer style.\n * @api\n */\nVectorLayer.prototype.setStyle = function(style) {\n  this.style_ = style !== undefined ? style : createDefaultStyle;\n  this.styleFunction_ = style === null ?\n    undefined : toStyleFunction(this.style_);\n  this.changed();\n};\n\n\n/**\n * @return {module:ol/layer/VectorRenderType|string} The render mode.\n */\nVectorLayer.prototype.getRenderMode = function() {\n  return this.renderMode_;\n};\n\n\nexport default VectorLayer;\n","/**\n * @module ol/format/FormatType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ARRAY_BUFFER: 'arraybuffer',\n  JSON: 'json',\n  TEXT: 'text',\n  XML: 'xml'\n};\n","/**\n * @module ol/featureloader\n */\nimport {UNDEFINED} from './functions.js';\nimport FormatType from './format/FormatType.js';\n\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * load features.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area to be loaded,\n * a `{number}` representing the resolution (map units per pixel) and an\n * {@link module:ol/proj/Projection} for the projection  as\n * arguments. `this` within the function is bound to the\n * {@link module:ol/source/Vector} it's called from.\n *\n * The function is responsible for loading the features and adding them to the\n * source.\n * @typedef {function(this:module:ol/source/Vector, module:ol/extent~Extent, number,\n *                    module:ol/proj/Projection)} FeatureLoader\n * @api\n */\n\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * get the url to load features from.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area\n * to be loaded, a `{number}` representing the resolution (map units per pixel)\n * and an {@link module:ol/proj/Projection} for the projection  as\n * arguments and returns a `{string}` representing the URL.\n * @typedef {function(module:ol/extent~Extent, number, module:ol/proj/Projection): string} FeatureUrlFunction\n * @api\n */\n\n\n/**\n * @param {string|module:ol/featureloader~FeatureUrlFunction} url Feature URL service.\n * @param {module:ol/format/Feature} format Feature format.\n * @param {function(this:module:ol/VectorTile, Array.<module:ol/Feature>, module:ol/proj/Projection, module:ol/extent~Extent)|function(this:module:ol/source/Vector, Array.<module:ol/Feature>)} success\n *     Function called with the loaded features and optionally with the data\n *     projection. Called with the vector tile or source as `this`.\n * @param {function(this:module:ol/VectorTile)|function(this:module:ol/source/Vector)} failure\n *     Function called when loading failed. Called with the vector tile or\n *     source as `this`.\n * @return {module:ol/featureloader~FeatureLoader} The feature loader.\n */\nexport function loadFeaturesXhr(url, format, success, failure) {\n  return (\n    /**\n     * @param {module:ol/extent~Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {module:ol/proj/Projection} projection Projection.\n     * @this {module:ol/source/Vector|module:ol/VectorTile}\n     */\n    function(extent, resolution, projection) {\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET',\n        typeof url === 'function' ? url(extent, resolution, projection) : url,\n        true);\n      if (format.getType() == FormatType.ARRAY_BUFFER) {\n        xhr.responseType = 'arraybuffer';\n      }\n      /**\n       * @param {Event} event Event.\n       * @private\n       */\n      xhr.onload = function(event) {\n        // status will be 0 for file:// urls\n        if (!xhr.status || xhr.status >= 200 && xhr.status < 300) {\n          const type = format.getType();\n          /** @type {Document|Node|Object|string|undefined} */\n          let source;\n          if (type == FormatType.JSON || type == FormatType.TEXT) {\n            source = xhr.responseText;\n          } else if (type == FormatType.XML) {\n            source = xhr.responseXML;\n            if (!source) {\n              source = new DOMParser().parseFromString(xhr.responseText, 'application/xml');\n            }\n          } else if (type == FormatType.ARRAY_BUFFER) {\n            source = /** @type {ArrayBuffer} */ (xhr.response);\n          }\n          if (source) {\n            success.call(this, format.readFeatures(source,\n              {featureProjection: projection}),\n            format.readProjection(source), format.getLastExtent());\n          } else {\n            failure.call(this);\n          }\n        } else {\n          failure.call(this);\n        }\n      }.bind(this);\n      /**\n       * @private\n       */\n      xhr.onerror = function() {\n        failure.call(this);\n      }.bind(this);\n      xhr.send();\n    }\n  );\n}\n\n\n/**\n * Create an XHR feature loader for a `url` and `format`. The feature loader\n * loads features (with XHR), parses the features, and adds them to the\n * vector source.\n * @param {string|module:ol/featureloader~FeatureUrlFunction} url Feature URL service.\n * @param {module:ol/format/Feature} format Feature format.\n * @return {module:ol/featureloader~FeatureLoader} The feature loader.\n * @api\n */\nexport function xhr(url, format) {\n  return loadFeaturesXhr(url, format,\n    /**\n     * @param {Array.<module:ol/Feature>} features The loaded features.\n     * @param {module:ol/proj/Projection} dataProjection Data\n     * projection.\n     * @this {module:ol/source/Vector}\n     */\n    function(features, dataProjection) {\n      this.addFeatures(features);\n    }, /* FIXME handle error */ UNDEFINED);\n}\n","/**\n * @module ol/loadingstrategy\n */\n\n\n/**\n * Strategy function for loading all features with a single request.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/extent~Extent>} Extents.\n * @api\n */\nexport function all(extent, resolution) {\n  return [[-Infinity, -Infinity, Infinity, Infinity]];\n}\n\n\n/**\n * Strategy function for loading features based on the view's extent and\n * resolution.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/extent~Extent>} Extents.\n * @api\n */\nexport function bbox(extent, resolution) {\n  return [extent];\n}\n\n\n/**\n * Creates a strategy function for loading features based on a tile grid.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {function(module:ol/extent~Extent, number): Array.<module:ol/extent~Extent>} Loading strategy.\n * @api\n */\nexport function tile(tileGrid) {\n  return (\n    /**\n     * @param {module:ol/extent~Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @return {Array.<module:ol/extent~Extent>} Extents.\n     */\n    function(extent, resolution) {\n      const z = tileGrid.getZForResolution(resolution);\n      const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n      /** @type {Array.<module:ol/extent~Extent>} */\n      const extents = [];\n      /** @type {module:ol/tilecoord~TileCoord} */\n      const tileCoord = [z, 0, 0];\n      for (tileCoord[1] = tileRange.minX; tileCoord[1] <= tileRange.maxX; ++tileCoord[1]) {\n        for (tileCoord[2] = tileRange.minY; tileCoord[2] <= tileRange.maxY; ++tileCoord[2]) {\n          extents.push(tileGrid.getTileCoordExtent(tileCoord));\n        }\n      }\n      return extents;\n    }\n  );\n}\n","/**\n * @module ol/source/Source\n */\nimport {inherits} from '../index.js';\nimport {UNDEFINED} from '../functions.js';\nimport BaseObject from '../Object.js';\nimport {get as getProjection} from '../proj.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * A function that returns a string or an array of strings representing source\n * attributions.\n *\n * @typedef {function(module:ol/PluggableMap~FrameState): (string|Array.<string>)} Attribution\n */\n\n\n/**\n * A type that can be used to provide attribution information for data sources.\n *\n * It represents either\n * * a simple string (e.g. `'© Acme Inc.'`)\n * * an array of simple strings (e.g. `['© Acme Inc.', '© Bacme Inc.']`)\n * * a function that returns a string or array of strings (`{@link module:ol/source/Source~Attribution}`)\n *\n * @typedef {string|Array.<string>|module:ol/source/Source~Attribution} AttributionLike\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {module:ol/proj~ProjectionLike} projection\n * @property {module:ol/source/State} [state]\n * @property {boolean} [wrapX]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for {@link module:ol/layer/Layer~Layer} sources.\n *\n * A generic `change` event is triggered when the state of the source changes.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @param {module:ol/source/Source~Options} options Source options.\n * @api\n */\nconst Source = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = getProjection(options.projection);\n\n  /**\n   * @private\n   * @type {?module:ol/source/Source~Attribution}\n   */\n  this.attributions_ = this.adaptAttributions_(options.attributions);\n\n  /**\n   * @private\n   * @type {module:ol/source/State}\n   */\n  this.state_ = options.state !== undefined ?\n    options.state : SourceState.READY;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.wrapX_ = options.wrapX !== undefined ? options.wrapX : false;\n\n};\n\ninherits(Source, BaseObject);\n\n/**\n * Turns the attributions option into an attributions function.\n * @param {module:ol/source/Source~AttributionLike|undefined} attributionLike The attribution option.\n * @return {?module:ol/source/Source~Attribution} An attribution function (or null).\n */\nSource.prototype.adaptAttributions_ = function(attributionLike) {\n  if (!attributionLike) {\n    return null;\n  }\n  if (Array.isArray(attributionLike)) {\n    return function(frameState) {\n      return attributionLike;\n    };\n  }\n\n  if (typeof attributionLike === 'function') {\n    return attributionLike;\n  }\n\n  return function(frameState) {\n    return [attributionLike];\n  };\n};\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {Object.<string, boolean>} skippedFeatureUids Skipped feature uids.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T} callback Feature callback.\n * @return {T|undefined} Callback result.\n * @template T\n */\nSource.prototype.forEachFeatureAtCoordinate = UNDEFINED;\n\n\n/**\n * Get the attribution function for the source.\n * @return {?module:ol/source/Source~Attribution} Attribution function.\n */\nSource.prototype.getAttributions = function() {\n  return this.attributions_;\n};\n\n\n/**\n * Get the projection of the source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nSource.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * @abstract\n * @return {Array.<number>|undefined} Resolutions.\n */\nSource.prototype.getResolutions = function() {};\n\n\n/**\n * Get the state of the source, see {@link module:ol/source/State~State} for possible states.\n * @return {module:ol/source/State} State.\n * @api\n */\nSource.prototype.getState = function() {\n  return this.state_;\n};\n\n\n/**\n * @return {boolean|undefined} Wrap X.\n */\nSource.prototype.getWrapX = function() {\n  return this.wrapX_;\n};\n\n\n/**\n * Refreshes the source and finally dispatches a 'change' event.\n * @api\n */\nSource.prototype.refresh = function() {\n  this.changed();\n};\n\n\n/**\n * Set the attributions of the source.\n * @param {module:ol/source/Source~AttributionLike|undefined} attributions Attributions.\n *     Can be passed as `string`, `Array<string>`, `{@link module:ol/source/Source~Attribution}`,\n *     or `undefined`.\n * @api\n */\nSource.prototype.setAttributions = function(attributions) {\n  this.attributions_ = this.adaptAttributions_(attributions);\n  this.changed();\n};\n\n\n/**\n * Set the state of the source.\n * @param {module:ol/source/State} state State.\n * @protected\n */\nSource.prototype.setState = function(state) {\n  this.state_ = state;\n  this.changed();\n};\nexport default Source;\n","/**\n * @module ol/source/VectorEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a feature is added to the source.\n   * @event ol/source/Vector~VectorSourceEvent#addfeature\n   * @api\n   */\n  ADDFEATURE: 'addfeature',\n\n  /**\n   * Triggered when a feature is updated.\n   * @event ol/source/Vector~VectorSourceEvent#changefeature\n   * @api\n   */\n  CHANGEFEATURE: 'changefeature',\n\n  /**\n   * Triggered when the clear method is called on the source.\n   * @event ol/source/Vector~VectorSourceEvent#clear\n   * @api\n   */\n  CLEAR: 'clear',\n\n  /**\n   * Triggered when a feature is removed from the source.\n   * See {@link module:ol/source/Vector#clear source.clear()} for exceptions.\n   * @event ol/source/Vector~VectorSourceEvent#removefeature\n   * @api\n   */\n  REMOVEFEATURE: 'removefeature'\n};\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.quickselect = factory());\n}(this, (function () { 'use strict';\n\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) i++;\n            while (compare(arr[j], t) > 0) j--;\n        }\n\n        if (compare(arr[left], t) === 0) swap(arr, left, j);\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nreturn quickselect;\n\n})));\n","'use strict';\n\nmodule.exports = rbush;\nmodule.exports.default = rbush;\n\nvar quickselect = require('quickselect');\n\nfunction rbush(maxEntries, format) {\n    if (!(this instanceof rbush)) return new rbush(maxEntries, format);\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries || 9);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n\n    if (format) {\n        this._initFormat(format);\n    }\n\n    this.clear();\n}\n\nrbush.prototype = {\n\n    all: function () {\n        return this._all(this.data, []);\n    },\n\n    search: function (bbox) {\n\n        var node = this.data,\n            result = [],\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return result;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf) result.push(child);\n                    else if (contains(bbox, childBBox)) this._all(child, result);\n                    else nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return result;\n    },\n\n    collides: function (bbox) {\n\n        var node = this.data,\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return false;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf || contains(bbox, childBBox)) return true;\n                    nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return false;\n    },\n\n    load: function (data) {\n        if (!(data && data.length)) return this;\n\n        if (data.length < this._minEntries) {\n            for (var i = 0, len = data.length; i < len; i++) {\n                this.insert(data[i]);\n            }\n            return this;\n        }\n\n        // recursively build the tree with the given data from scratch using OMT algorithm\n        var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n        if (!this.data.children.length) {\n            // save as is if tree is empty\n            this.data = node;\n\n        } else if (this.data.height === node.height) {\n            // split root if trees have the same height\n            this._splitRoot(this.data, node);\n\n        } else {\n            if (this.data.height < node.height) {\n                // swap trees if inserted one is bigger\n                var tmpNode = this.data;\n                this.data = node;\n                node = tmpNode;\n            }\n\n            // insert the small tree into the large tree at appropriate level\n            this._insert(node, this.data.height - node.height - 1, true);\n        }\n\n        return this;\n    },\n\n    insert: function (item) {\n        if (item) this._insert(item, this.data.height - 1);\n        return this;\n    },\n\n    clear: function () {\n        this.data = createNode([]);\n        return this;\n    },\n\n    remove: function (item, equalsFn) {\n        if (!item) return this;\n\n        var node = this.data,\n            bbox = this.toBBox(item),\n            path = [],\n            indexes = [],\n            i, parent, index, goingUp;\n\n        // depth-first iterative tree traversal\n        while (node || path.length) {\n\n            if (!node) { // go up\n                node = path.pop();\n                parent = path[path.length - 1];\n                i = indexes.pop();\n                goingUp = true;\n            }\n\n            if (node.leaf) { // check current node\n                index = findItem(item, node.children, equalsFn);\n\n                if (index !== -1) {\n                    // item found, remove the item and condense tree upwards\n                    node.children.splice(index, 1);\n                    path.push(node);\n                    this._condense(path);\n                    return this;\n                }\n            }\n\n            if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n                path.push(node);\n                indexes.push(i);\n                i = 0;\n                parent = node;\n                node = node.children[0];\n\n            } else if (parent) { // go right\n                i++;\n                node = parent.children[i];\n                goingUp = false;\n\n            } else node = null; // nothing found\n        }\n\n        return this;\n    },\n\n    toBBox: function (item) { return item; },\n\n    compareMinX: compareNodeMinX,\n    compareMinY: compareNodeMinY,\n\n    toJSON: function () { return this.data; },\n\n    fromJSON: function (data) {\n        this.data = data;\n        return this;\n    },\n\n    _all: function (node, result) {\n        var nodesToSearch = [];\n        while (node) {\n            if (node.leaf) result.push.apply(result, node.children);\n            else nodesToSearch.push.apply(nodesToSearch, node.children);\n\n            node = nodesToSearch.pop();\n        }\n        return result;\n    },\n\n    _build: function (items, left, right, height) {\n\n        var N = right - left + 1,\n            M = this._maxEntries,\n            node;\n\n        if (N <= M) {\n            // reached leaf level; return leaf\n            node = createNode(items.slice(left, right + 1));\n            calcBBox(node, this.toBBox);\n            return node;\n        }\n\n        if (!height) {\n            // target height of the bulk-loaded tree\n            height = Math.ceil(Math.log(N) / Math.log(M));\n\n            // target number of root entries to maximize storage utilization\n            M = Math.ceil(N / Math.pow(M, height - 1));\n        }\n\n        node = createNode([]);\n        node.leaf = false;\n        node.height = height;\n\n        // split the items into M mostly square tiles\n\n        var N2 = Math.ceil(N / M),\n            N1 = N2 * Math.ceil(Math.sqrt(M)),\n            i, j, right2, right3;\n\n        multiSelect(items, left, right, N1, this.compareMinX);\n\n        for (i = left; i <= right; i += N1) {\n\n            right2 = Math.min(i + N1 - 1, right);\n\n            multiSelect(items, i, right2, N2, this.compareMinY);\n\n            for (j = i; j <= right2; j += N2) {\n\n                right3 = Math.min(j + N2 - 1, right2);\n\n                // pack each entry recursively\n                node.children.push(this._build(items, j, right3, height - 1));\n            }\n        }\n\n        calcBBox(node, this.toBBox);\n\n        return node;\n    },\n\n    _chooseSubtree: function (bbox, node, level, path) {\n\n        var i, len, child, targetNode, area, enlargement, minArea, minEnlargement;\n\n        while (true) {\n            path.push(node);\n\n            if (node.leaf || path.length - 1 === level) break;\n\n            minArea = minEnlargement = Infinity;\n\n            for (i = 0, len = node.children.length; i < len; i++) {\n                child = node.children[i];\n                area = bboxArea(child);\n                enlargement = enlargedArea(bbox, child) - area;\n\n                // choose entry with the least area enlargement\n                if (enlargement < minEnlargement) {\n                    minEnlargement = enlargement;\n                    minArea = area < minArea ? area : minArea;\n                    targetNode = child;\n\n                } else if (enlargement === minEnlargement) {\n                    // otherwise choose one with the smallest area\n                    if (area < minArea) {\n                        minArea = area;\n                        targetNode = child;\n                    }\n                }\n            }\n\n            node = targetNode || node.children[0];\n        }\n\n        return node;\n    },\n\n    _insert: function (item, level, isNode) {\n\n        var toBBox = this.toBBox,\n            bbox = isNode ? item : toBBox(item),\n            insertPath = [];\n\n        // find the best node for accommodating the item, saving all nodes along the path too\n        var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n        // put the item into the node\n        node.children.push(item);\n        extend(node, bbox);\n\n        // split on node overflow; propagate upwards if necessary\n        while (level >= 0) {\n            if (insertPath[level].children.length > this._maxEntries) {\n                this._split(insertPath, level);\n                level--;\n            } else break;\n        }\n\n        // adjust bboxes along the insertion path\n        this._adjustParentBBoxes(bbox, insertPath, level);\n    },\n\n    // split overflowed node into two\n    _split: function (insertPath, level) {\n\n        var node = insertPath[level],\n            M = node.children.length,\n            m = this._minEntries;\n\n        this._chooseSplitAxis(node, m, M);\n\n        var splitIndex = this._chooseSplitIndex(node, m, M);\n\n        var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n        newNode.height = node.height;\n        newNode.leaf = node.leaf;\n\n        calcBBox(node, this.toBBox);\n        calcBBox(newNode, this.toBBox);\n\n        if (level) insertPath[level - 1].children.push(newNode);\n        else this._splitRoot(node, newNode);\n    },\n\n    _splitRoot: function (node, newNode) {\n        // split root node\n        this.data = createNode([node, newNode]);\n        this.data.height = node.height + 1;\n        this.data.leaf = false;\n        calcBBox(this.data, this.toBBox);\n    },\n\n    _chooseSplitIndex: function (node, m, M) {\n\n        var i, bbox1, bbox2, overlap, area, minOverlap, minArea, index;\n\n        minOverlap = minArea = Infinity;\n\n        for (i = m; i <= M - m; i++) {\n            bbox1 = distBBox(node, 0, i, this.toBBox);\n            bbox2 = distBBox(node, i, M, this.toBBox);\n\n            overlap = intersectionArea(bbox1, bbox2);\n            area = bboxArea(bbox1) + bboxArea(bbox2);\n\n            // choose distribution with minimum overlap\n            if (overlap < minOverlap) {\n                minOverlap = overlap;\n                index = i;\n\n                minArea = area < minArea ? area : minArea;\n\n            } else if (overlap === minOverlap) {\n                // otherwise choose distribution with minimum area\n                if (area < minArea) {\n                    minArea = area;\n                    index = i;\n                }\n            }\n        }\n\n        return index;\n    },\n\n    // sorts node children by the best axis for split\n    _chooseSplitAxis: function (node, m, M) {\n\n        var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX,\n            compareMinY = node.leaf ? this.compareMinY : compareNodeMinY,\n            xMargin = this._allDistMargin(node, m, M, compareMinX),\n            yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n        // if total distributions margin value is minimal for x, sort by minX,\n        // otherwise it's already sorted by minY\n        if (xMargin < yMargin) node.children.sort(compareMinX);\n    },\n\n    // total margin of all possible split distributions where each node is at least m full\n    _allDistMargin: function (node, m, M, compare) {\n\n        node.children.sort(compare);\n\n        var toBBox = this.toBBox,\n            leftBBox = distBBox(node, 0, m, toBBox),\n            rightBBox = distBBox(node, M - m, M, toBBox),\n            margin = bboxMargin(leftBBox) + bboxMargin(rightBBox),\n            i, child;\n\n        for (i = m; i < M - m; i++) {\n            child = node.children[i];\n            extend(leftBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(leftBBox);\n        }\n\n        for (i = M - m - 1; i >= m; i--) {\n            child = node.children[i];\n            extend(rightBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(rightBBox);\n        }\n\n        return margin;\n    },\n\n    _adjustParentBBoxes: function (bbox, path, level) {\n        // adjust bboxes along the given tree path\n        for (var i = level; i >= 0; i--) {\n            extend(path[i], bbox);\n        }\n    },\n\n    _condense: function (path) {\n        // go through the path, removing empty nodes and updating bboxes\n        for (var i = path.length - 1, siblings; i >= 0; i--) {\n            if (path[i].children.length === 0) {\n                if (i > 0) {\n                    siblings = path[i - 1].children;\n                    siblings.splice(siblings.indexOf(path[i]), 1);\n\n                } else this.clear();\n\n            } else calcBBox(path[i], this.toBBox);\n        }\n    },\n\n    _initFormat: function (format) {\n        // data format (minX, minY, maxX, maxY accessors)\n\n        // uses eval-type function compilation instead of just accepting a toBBox function\n        // because the algorithms are very sensitive to sorting functions performance,\n        // so they should be dead simple and without inner calls\n\n        var compareArr = ['return a', ' - b', ';'];\n\n        this.compareMinX = new Function('a', 'b', compareArr.join(format[0]));\n        this.compareMinY = new Function('a', 'b', compareArr.join(format[1]));\n\n        this.toBBox = new Function('a',\n            'return {minX: a' + format[0] +\n            ', minY: a' + format[1] +\n            ', maxX: a' + format[2] +\n            ', maxY: a' + format[3] + '};');\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) return items.indexOf(item);\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) return i;\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) destNode = createNode(null);\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k, child; i < p; i++) {\n        child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX),\n        minY = Math.max(a.minY, b.minY),\n        maxX = Math.min(a.maxX, b.maxX),\n        maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right],\n        mid;\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) continue;\n\n        mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n","/**\n * @module ol/structs/RBush\n */\nimport {getUid} from '../index.js';\nimport rbush from 'rbush';\nimport {createOrUpdate, equals} from '../extent.js';\nimport {isEmpty} from '../obj.js';\n\n/**\n * @typedef {Object} Entry\n * @property {number} minX\n * @property {number} minY\n * @property {number} maxX\n * @property {number} maxY\n * @property {Object} [value]\n */\n\n/**\n * Wrapper around the RBush by Vladimir Agafonkin.\n *\n * @constructor\n * @param {number=} opt_maxEntries Max entries.\n * @see https://github.com/mourner/rbush\n * @struct\n * @template T\n */\nconst RBush = function(opt_maxEntries) {\n\n  /**\n   * @private\n   */\n  this.rbush_ = rbush(opt_maxEntries, undefined);\n\n  /**\n   * A mapping between the objects added to this rbush wrapper\n   * and the objects that are actually added to the internal rbush.\n   * @private\n   * @type {Object.<number, module:ol/structs/RBush~Entry>}\n   */\n  this.items_ = {};\n\n};\n\n\n/**\n * Insert a value into the RBush.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {T} value Value.\n */\nRBush.prototype.insert = function(extent, value) {\n  /** @type {module:ol/structs/RBush~Entry} */\n  const item = {\n    minX: extent[0],\n    minY: extent[1],\n    maxX: extent[2],\n    maxY: extent[3],\n    value: value\n  };\n\n  this.rbush_.insert(item);\n  this.items_[getUid(value)] = item;\n};\n\n\n/**\n * Bulk-insert values into the RBush.\n * @param {Array.<module:ol/extent~Extent>} extents Extents.\n * @param {Array.<T>} values Values.\n */\nRBush.prototype.load = function(extents, values) {\n  const items = new Array(values.length);\n  for (let i = 0, l = values.length; i < l; i++) {\n    const extent = extents[i];\n    const value = values[i];\n\n    /** @type {module:ol/structs/RBush~Entry} */\n    const item = {\n      minX: extent[0],\n      minY: extent[1],\n      maxX: extent[2],\n      maxY: extent[3],\n      value: value\n    };\n    items[i] = item;\n    this.items_[getUid(value)] = item;\n  }\n  this.rbush_.load(items);\n};\n\n\n/**\n * Remove a value from the RBush.\n * @param {T} value Value.\n * @return {boolean} Removed.\n */\nRBush.prototype.remove = function(value) {\n  const uid = getUid(value);\n\n  // get the object in which the value was wrapped when adding to the\n  // internal rbush. then use that object to do the removal.\n  const item = this.items_[uid];\n  delete this.items_[uid];\n  return this.rbush_.remove(item) !== null;\n};\n\n\n/**\n * Update the extent of a value in the RBush.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {T} value Value.\n */\nRBush.prototype.update = function(extent, value) {\n  const item = this.items_[getUid(value)];\n  const bbox = [item.minX, item.minY, item.maxX, item.maxY];\n  if (!equals(bbox, extent)) {\n    this.remove(value);\n    this.insert(extent, value);\n  }\n};\n\n\n/**\n * Return all values in the RBush.\n * @return {Array.<T>} All.\n */\nRBush.prototype.getAll = function() {\n  const items = this.rbush_.all();\n  return items.map(function(item) {\n    return item.value;\n  });\n};\n\n\n/**\n * Return all values in the given extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {Array.<T>} All in extent.\n */\nRBush.prototype.getInExtent = function(extent) {\n  /** @type {module:ol/structs/RBush~Entry} */\n  const bbox = {\n    minX: extent[0],\n    minY: extent[1],\n    maxX: extent[2],\n    maxY: extent[3]\n  };\n  const items = this.rbush_.search(bbox);\n  return items.map(function(item) {\n    return item.value;\n  });\n};\n\n\n/**\n * Calls a callback function with each value in the tree.\n * If the callback returns a truthy value, this value is returned without\n * checking the rest of the tree.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEach = function(callback, opt_this) {\n  return this.forEach_(this.getAll(), callback, opt_this);\n};\n\n\n/**\n * Calls a callback function with each value in the provided extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEachInExtent = function(extent, callback, opt_this) {\n  return this.forEach_(this.getInExtent(extent), callback, opt_this);\n};\n\n\n/**\n * @param {Array.<T>} values Values.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @private\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEach_ = function(values, callback, opt_this) {\n  let result;\n  for (let i = 0, l = values.length; i < l; i++) {\n    result = callback.call(opt_this, values[i]);\n    if (result) {\n      return result;\n    }\n  }\n  return result;\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nRBush.prototype.isEmpty = function() {\n  return isEmpty(this.items_);\n};\n\n\n/**\n * Remove all values from the RBush.\n */\nRBush.prototype.clear = function() {\n  this.rbush_.clear();\n  this.items_ = {};\n};\n\n\n/**\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nRBush.prototype.getExtent = function(opt_extent) {\n  // FIXME add getExtent() to rbush\n  const data = this.rbush_.data;\n  return createOrUpdate(data.minX, data.minY, data.maxX, data.maxY, opt_extent);\n};\n\n\n/**\n * @param {module:ol/structs/RBush} rbush R-Tree.\n */\nRBush.prototype.concat = function(rbush) {\n  this.rbush_.load(rbush.rbush_.all());\n  for (const i in rbush.items_) {\n    this.items_[i | 0] = rbush.items_[i | 0];\n  }\n};\nexport default RBush;\n","/**\n * @module ol/source/Vector\n */\n\nimport {getUid, inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {extend} from '../array.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, equals} from '../extent.js';\nimport {xhr} from '../featureloader.js';\nimport {TRUE, UNDEFINED} from '../functions.js';\nimport {all as allStrategy} from '../loadingstrategy.js';\nimport {isEmpty, getValues} from '../obj.js';\nimport Source from '../source/Source.js';\nimport SourceState from '../source/State.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\n\n/**\n * A function that takes an {@link module:ol/extent~Extent} and a resolution as arguments, and\n * returns an array of {@link module:ol/extent~Extent} with the extents to load. Usually this\n * is one of the standard {@link module:ol/loadingstrategy} strategies.\n *\n * @typedef {function(module:ol/extent~Extent, number): Array.<module:ol/extent~Extent>} LoadingStrategy\n * @api\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Vector} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Type.\n * @param {module:ol/Feature=} opt_feature Feature.\n */\nexport const VectorSourceEvent = function(type, opt_feature) {\n\n  Event.call(this, type);\n\n  /**\n   * The feature being added or removed.\n   * @type {module:ol/Feature|undefined}\n   * @api\n   */\n  this.feature = opt_feature;\n\n};\ninherits(VectorSourceEvent, Event);\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {Array.<module:ol/Feature>|module:ol/Collection.<module:ol/Feature>} [features]\n * Features. If provided as {@link module:ol/Collection}, the features in the source\n * and the collection will stay in sync.\n * @property {module:ol/format/Feature} [format] The feature format used by the XHR\n * feature loader when `url` is set. Required if `url` is set, otherwise ignored.\n * @property {module:ol/featureloader~FeatureLoader} [loader]\n * The loader function used to load features, from a remote source for example.\n * If this is not set and `url` is set, the source will create and use an XHR\n * feature loader.\n *\n * Example:\n *\n * ```js\n * import {Vector} from 'ol/source';\n * import {GeoJSON} from 'ol/format';\n * import {bbox} from 'ol/loadingstrategy';\n *\n * var vectorSource = new Vector({\n *   format: new GeoJSON(),\n *   loader: function(extent, resolution, projection) {\n *      var proj = projection.getCode();\n *      var url = 'https://ahocevar.com/geoserver/wfs?service=WFS&' +\n *          'version=1.1.0&request=GetFeature&typename=osm:water_areas&' +\n *          'outputFormat=application/json&srsname=' + proj + '&' +\n *          'bbox=' + extent.join(',') + ',' + proj;\n *      var xhr = new XMLHttpRequest();\n *      xhr.open('GET', url);\n *      var onError = function() {\n *        vectorSource.removeLoadedExtent(extent);\n *      }\n *      xhr.onerror = onError;\n *      xhr.onload = function() {\n *        if (xhr.status == 200) {\n *          vectorSource.addFeatures(\n *              vectorSource.getFormat().readFeatures(xhr.responseText));\n *        } else {\n *          onError();\n *        }\n *      }\n *      xhr.send();\n *    },\n *    strategy: bbox\n *  });\n * ```\n * @property {boolean} [overlaps=true] This source may have overlapping geometries.\n * Setting this to `false` (e.g. for sources with polygons that represent administrative\n * boundaries or TopoJSON sources) allows the renderer to optimise fill and\n * stroke operations.\n * @property {module:ol/source/Vector~LoadingStrategy} [strategy] The loading strategy to use.\n * By default an {@link module:ol/loadingstrategy~all}\n * strategy is used, a one-off strategy which loads all features at once.\n * @property {string|module:ol/featureloader~FeatureUrlfunction} [url]\n * Setting this option instructs the source to load features using an XHR loader\n * (see {@link module:ol/featureloader~xhr}). Use a `string` and an\n * {@link module:ol/loadingstrategy~all} for a one-off download of all features from\n * the given URL. Use a {@link module:ol/featureloader~FeatureUrlfunction} to generate the url with\n * other loading strategies.\n * Requires `format` to be set as well.\n * When default XHR feature loader is provided, the features will\n * be transformed from the data projection to the view projection\n * during parsing. If your remote data source does not advertise its projection\n * properly, this transformation will be incorrect. For some formats, the\n * default projection (usually EPSG:4326) can be overridden by setting the\n * dataProjection constructor option on the format.\n * Note that if a source contains non-feature data, such as a GeoJSON geometry\n * or a KML NetworkLink, these will be ignored. Use a custom loader to load these.\n * @property {boolean} [useSpatialIndex=true]\n * By default, an RTree is used as spatial index. When features are removed and\n * added frequently, and the total number of features is low, setting this to\n * `false` may improve performance.\n *\n * Note that\n * {@link module:ol/source/Vector~VectorSource#getFeaturesInExtent},\n * {@link module:ol/source/Vector~VectorSource#getClosestFeatureToCoordinate} and\n * {@link module:ol/source/Vector~VectorSource#getExtent} cannot be used when `useSpatialIndex` is\n * set to `false`, and {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent} will loop\n * through all features.\n *\n * When set to `false`, the features will be maintained in an\n * {@link module:ol/Collection}, which can be retrieved through\n * {@link module:ol/source/Vector~VectorSource#getFeaturesCollection}.\n * @property {boolean} [wrapX=true] Wrap the world horizontally. For vector editing across the\n * -180° and 180° meridians to work properly, this should be set to `false`. The\n * resulting geometry coordinates will then exceed the world bounds.\n */\n\n\n/**\n * @classdesc\n * Provides a source of features for vector layers. Vector features provided\n * by this source are suitable for editing. See {@link module:ol/source/VectorTile~VectorTile} for\n * vector data that is optimized for rendering.\n *\n * @constructor\n * @extends {module:ol/source/Source}\n * @fires ol/source/Vector~VectorSourceEvent\n * @param {module:ol/source/Vector~Options=} opt_options Vector source options.\n * @api\n */\nconst VectorSource = function(opt_options) {\n\n  const options = opt_options || {};\n\n  Source.call(this, {\n    attributions: options.attributions,\n    projection: undefined,\n    state: SourceState.READY,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/featureloader~FeatureLoader}\n   */\n  this.loader_ = UNDEFINED;\n\n  /**\n   * @private\n   * @type {module:ol/format/Feature|undefined}\n   */\n  this.format_ = options.format;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overlaps_ = options.overlaps == undefined ? true : options.overlaps;\n\n  /**\n   * @private\n   * @type {string|module:ol/featureloader~FeatureUrlFunction|undefined}\n   */\n  this.url_ = options.url;\n\n  if (options.loader !== undefined) {\n    this.loader_ = options.loader;\n  } else if (this.url_ !== undefined) {\n    assert(this.format_, 7); // `format` must be set when `url` is set\n    // create a XHR feature loader for \"url\" and \"format\"\n    this.loader_ = xhr(this.url_, /** @type {module:ol/format/Feature} */ (this.format_));\n  }\n\n  /**\n   * @private\n   * @type {module:ol/source/Vector~LoadingStrategy}\n   */\n  this.strategy_ = options.strategy !== undefined ? options.strategy : allStrategy;\n\n  const useSpatialIndex =\n      options.useSpatialIndex !== undefined ? options.useSpatialIndex : true;\n\n  /**\n   * @private\n   * @type {module:ol/structs/RBush.<module:ol/Feature>}\n   */\n  this.featuresRtree_ = useSpatialIndex ? new RBush() : null;\n\n  /**\n   * @private\n   * @type {module:ol/structs/RBush.<{extent: module:ol/extent~Extent}>}\n   */\n  this.loadedExtentsRtree_ = new RBush();\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.nullGeometryFeatures_ = {};\n\n  /**\n   * A lookup of features by id (the return from feature.getId()).\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.idIndex_ = {};\n\n  /**\n   * A lookup of features without id (keyed by getUid(feature)).\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.undefIdIndex_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, Array.<module:ol/events~EventsKey>>}\n   */\n  this.featureChangeKeys_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   */\n  this.featuresCollection_ = null;\n\n  let collection, features;\n  if (options.features instanceof Collection) {\n    collection = options.features;\n    features = collection.getArray();\n  } else if (Array.isArray(options.features)) {\n    features = options.features;\n  }\n  if (!useSpatialIndex && collection === undefined) {\n    collection = new Collection(features);\n  }\n  if (features !== undefined) {\n    this.addFeaturesInternal(features);\n  }\n  if (collection !== undefined) {\n    this.bindFeaturesCollection_(collection);\n  }\n\n};\n\ninherits(VectorSource, Source);\n\n\n/**\n * Add a single feature to the source.  If you want to add a batch of features\n * at once, call {@link module:ol/source/Vector~VectorSource#addFeatures #addFeatures()}\n * instead. A feature will not be added to the source if feature with\n * the same id is already there. The reason for this behavior is to avoid\n * feature duplication when using bbox or tile loading strategies.\n * @param {module:ol/Feature} feature Feature to add.\n * @api\n */\nVectorSource.prototype.addFeature = function(feature) {\n  this.addFeatureInternal(feature);\n  this.changed();\n};\n\n\n/**\n * Add a feature without firing a `change` event.\n * @param {module:ol/Feature} feature Feature.\n * @protected\n */\nVectorSource.prototype.addFeatureInternal = function(feature) {\n  const featureKey = getUid(feature).toString();\n\n  if (!this.addToIndex_(featureKey, feature)) {\n    return;\n  }\n\n  this.setupChangeEvents_(featureKey, feature);\n\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    const extent = geometry.getExtent();\n    if (this.featuresRtree_) {\n      this.featuresRtree_.insert(extent, feature);\n    }\n  } else {\n    this.nullGeometryFeatures_[featureKey] = feature;\n  }\n\n  this.dispatchEvent(\n    new VectorSourceEvent(VectorEventType.ADDFEATURE, feature));\n};\n\n\n/**\n * @param {string} featureKey Unique identifier for the feature.\n * @param {module:ol/Feature} feature The feature.\n * @private\n */\nVectorSource.prototype.setupChangeEvents_ = function(featureKey, feature) {\n  this.featureChangeKeys_[featureKey] = [\n    listen(feature, EventType.CHANGE,\n      this.handleFeatureChange_, this),\n    listen(feature, ObjectEventType.PROPERTYCHANGE,\n      this.handleFeatureChange_, this)\n  ];\n};\n\n\n/**\n * @param {string} featureKey Unique identifier for the feature.\n * @param {module:ol/Feature} feature The feature.\n * @return {boolean} The feature is \"valid\", in the sense that it is also a\n *     candidate for insertion into the Rtree.\n * @private\n */\nVectorSource.prototype.addToIndex_ = function(featureKey, feature) {\n  let valid = true;\n  const id = feature.getId();\n  if (id !== undefined) {\n    if (!(id.toString() in this.idIndex_)) {\n      this.idIndex_[id.toString()] = feature;\n    } else {\n      valid = false;\n    }\n  } else {\n    assert(!(featureKey in this.undefIdIndex_),\n      30); // The passed `feature` was already added to the source\n    this.undefIdIndex_[featureKey] = feature;\n  }\n  return valid;\n};\n\n\n/**\n * Add a batch of features to the source.\n * @param {Array.<module:ol/Feature>} features Features to add.\n * @api\n */\nVectorSource.prototype.addFeatures = function(features) {\n  this.addFeaturesInternal(features);\n  this.changed();\n};\n\n\n/**\n * Add features without firing a `change` event.\n * @param {Array.<module:ol/Feature>} features Features.\n * @protected\n */\nVectorSource.prototype.addFeaturesInternal = function(features) {\n  const extents = [];\n  const newFeatures = [];\n  const geometryFeatures = [];\n\n  for (let i = 0, length = features.length; i < length; i++) {\n    const feature = features[i];\n    const featureKey = getUid(feature).toString();\n    if (this.addToIndex_(featureKey, feature)) {\n      newFeatures.push(feature);\n    }\n  }\n\n  for (let i = 0, length = newFeatures.length; i < length; i++) {\n    const feature = newFeatures[i];\n    const featureKey = getUid(feature).toString();\n    this.setupChangeEvents_(featureKey, feature);\n\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      const extent = geometry.getExtent();\n      extents.push(extent);\n      geometryFeatures.push(feature);\n    } else {\n      this.nullGeometryFeatures_[featureKey] = feature;\n    }\n  }\n  if (this.featuresRtree_) {\n    this.featuresRtree_.load(extents, geometryFeatures);\n  }\n\n  for (let i = 0, length = newFeatures.length; i < length; i++) {\n    this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE, newFeatures[i]));\n  }\n};\n\n\n/**\n * @param {!module:ol/Collection.<module:ol/Feature>} collection Collection.\n * @private\n */\nVectorSource.prototype.bindFeaturesCollection_ = function(collection) {\n  let modifyingCollection = false;\n  listen(this, VectorEventType.ADDFEATURE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        collection.push(evt.feature);\n        modifyingCollection = false;\n      }\n    });\n  listen(this, VectorEventType.REMOVEFEATURE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        collection.remove(evt.feature);\n        modifyingCollection = false;\n      }\n    });\n  listen(collection, CollectionEventType.ADD,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        this.addFeature(/** @type {module:ol/Feature} */ (evt.element));\n        modifyingCollection = false;\n      }\n    }, this);\n  listen(collection, CollectionEventType.REMOVE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        this.removeFeature(/** @type {module:ol/Feature} */ (evt.element));\n        modifyingCollection = false;\n      }\n    }, this);\n  this.featuresCollection_ = collection;\n};\n\n\n/**\n * Remove all features from the source.\n * @param {boolean=} opt_fast Skip dispatching of {@link module:ol/source/Vector~VectorSourceEvent#removefeature} events.\n * @api\n */\nVectorSource.prototype.clear = function(opt_fast) {\n  if (opt_fast) {\n    for (const featureId in this.featureChangeKeys_) {\n      const keys = this.featureChangeKeys_[featureId];\n      keys.forEach(unlistenByKey);\n    }\n    if (!this.featuresCollection_) {\n      this.featureChangeKeys_ = {};\n      this.idIndex_ = {};\n      this.undefIdIndex_ = {};\n    }\n  } else {\n    if (this.featuresRtree_) {\n      this.featuresRtree_.forEach(this.removeFeatureInternal, this);\n      for (const id in this.nullGeometryFeatures_) {\n        this.removeFeatureInternal(this.nullGeometryFeatures_[id]);\n      }\n    }\n  }\n  if (this.featuresCollection_) {\n    this.featuresCollection_.clear();\n  }\n\n  if (this.featuresRtree_) {\n    this.featuresRtree_.clear();\n  }\n  this.loadedExtentsRtree_.clear();\n  this.nullGeometryFeatures_ = {};\n\n  const clearEvent = new VectorSourceEvent(VectorEventType.CLEAR);\n  this.dispatchEvent(clearEvent);\n  this.changed();\n};\n\n\n/**\n * Iterate through all features on the source, calling the provided callback\n * with each one.  If the callback returns any \"truthy\" value, iteration will\n * stop and the function will return the same value.\n * Note: this function only iterate through the feature that have a defined geometry.\n *\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     on the source.  Return a truthy value to stop iteration.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeature = function(callback) {\n  if (this.featuresRtree_) {\n    return this.featuresRtree_.forEach(callback);\n  } else if (this.featuresCollection_) {\n    return this.featuresCollection_.forEach(callback);\n  }\n};\n\n\n/**\n * Iterate through all features whose geometries contain the provided\n * coordinate, calling the callback with each feature.  If the callback returns\n * a \"truthy\" value, iteration will stop and the function will return the same\n * value.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose goemetry contains the provided coordinate.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n */\nVectorSource.prototype.forEachFeatureAtCoordinateDirect = function(coordinate, callback) {\n  const extent = [coordinate[0], coordinate[1], coordinate[0], coordinate[1]];\n  return this.forEachFeatureInExtent(extent, function(feature) {\n    const geometry = feature.getGeometry();\n    if (geometry.intersectsCoordinate(coordinate)) {\n      return callback(feature);\n    } else {\n      return undefined;\n    }\n  });\n};\n\n\n/**\n * Iterate through all features whose bounding box intersects the provided\n * extent (note that the feature's geometry may not intersect the extent),\n * calling the callback with each feature.  If the callback returns a \"truthy\"\n * value, iteration will stop and the function will return the same value.\n *\n * If you are interested in features whose geometry intersects an extent, call\n * the {@link module:ol/source/Vector~VectorSource#forEachFeatureIntersectingExtent #forEachFeatureIntersectingExtent()} method instead.\n *\n * When `useSpatialIndex` is set to false, this method will loop through all\n * features, equivalent to {@link module:ol/source/Vector~VectorSource#forEachFeature #forEachFeature()}.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose bounding box intersects the provided extent.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeatureInExtent = function(extent, callback) {\n  if (this.featuresRtree_) {\n    return this.featuresRtree_.forEachInExtent(extent, callback);\n  } else if (this.featuresCollection_) {\n    return this.featuresCollection_.forEach(callback);\n  }\n};\n\n\n/**\n * Iterate through all features whose geometry intersects the provided extent,\n * calling the callback with each feature.  If the callback returns a \"truthy\"\n * value, iteration will stop and the function will return the same value.\n *\n * If you only want to test for bounding box intersection, call the\n * {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent #forEachFeatureInExtent()} method instead.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose geometry intersects the provided extent.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeatureIntersectingExtent = function(extent, callback) {\n  return this.forEachFeatureInExtent(extent,\n    /**\n     * @param {module:ol/Feature} feature Feature.\n     * @return {T|undefined} The return value from the last call to the callback.\n     * @template T\n     */\n    function(feature) {\n      const geometry = feature.getGeometry();\n      if (geometry.intersectsExtent(extent)) {\n        const result = callback(feature);\n        if (result) {\n          return result;\n        }\n      }\n    });\n};\n\n\n/**\n * Get the features collection associated with this source. Will be `null`\n * unless the source was configured with `useSpatialIndex` set to `false`, or\n * with an {@link module:ol/Collection} as `features`.\n * @return {module:ol/Collection.<module:ol/Feature>} The collection of features.\n * @api\n */\nVectorSource.prototype.getFeaturesCollection = function() {\n  return this.featuresCollection_;\n};\n\n\n/**\n * Get all features on the source in random order.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeatures = function() {\n  let features;\n  if (this.featuresCollection_) {\n    features = this.featuresCollection_.getArray();\n  } else if (this.featuresRtree_) {\n    features = this.featuresRtree_.getAll();\n    if (!isEmpty(this.nullGeometryFeatures_)) {\n      extend(features, getValues(this.nullGeometryFeatures_));\n    }\n  }\n  return (\n    /** @type {Array.<module:ol/Feature>} */ (features)\n  );\n};\n\n\n/**\n * Get all features whose geometry intersects the provided coordinate.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeaturesAtCoordinate = function(coordinate) {\n  const features = [];\n  this.forEachFeatureAtCoordinateDirect(coordinate, function(feature) {\n    features.push(feature);\n  });\n  return features;\n};\n\n\n/**\n * Get all features in the provided extent.  Note that this returns an array of\n * all features intersecting the given extent in random order (so it may include\n * features whose geometries do not intersect the extent).\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeaturesInExtent = function(extent) {\n  return this.featuresRtree_.getInExtent(extent);\n};\n\n\n/**\n * Get the closest feature to the provided coordinate.\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {function(module:ol/Feature):boolean=} opt_filter Feature filter function.\n *     The filter function will receive one argument, the {@link module:ol/Feature feature}\n *     and it should return a boolean value. By default, no filtering is made.\n * @return {module:ol/Feature} Closest feature.\n * @api\n */\nVectorSource.prototype.getClosestFeatureToCoordinate = function(coordinate, opt_filter) {\n  // Find the closest feature using branch and bound.  We start searching an\n  // infinite extent, and find the distance from the first feature found.  This\n  // becomes the closest feature.  We then compute a smaller extent which any\n  // closer feature must intersect.  We continue searching with this smaller\n  // extent, trying to find a closer feature.  Every time we find a closer\n  // feature, we update the extent being searched so that any even closer\n  // feature must intersect it.  We continue until we run out of features.\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let closestFeature = null;\n  const closestPoint = [NaN, NaN];\n  let minSquaredDistance = Infinity;\n  const extent = [-Infinity, -Infinity, Infinity, Infinity];\n  const filter = opt_filter ? opt_filter : TRUE;\n  this.featuresRtree_.forEachInExtent(extent,\n    /**\n     * @param {module:ol/Feature} feature Feature.\n     */\n    function(feature) {\n      if (filter(feature)) {\n        const geometry = feature.getGeometry();\n        const previousMinSquaredDistance = minSquaredDistance;\n        minSquaredDistance = geometry.closestPointXY(\n          x, y, closestPoint, minSquaredDistance);\n        if (minSquaredDistance < previousMinSquaredDistance) {\n          closestFeature = feature;\n          // This is sneaky.  Reduce the extent that it is currently being\n          // searched while the R-Tree traversal using this same extent object\n          // is still in progress.  This is safe because the new extent is\n          // strictly contained by the old extent.\n          const minDistance = Math.sqrt(minSquaredDistance);\n          extent[0] = x - minDistance;\n          extent[1] = y - minDistance;\n          extent[2] = x + minDistance;\n          extent[3] = y + minDistance;\n        }\n      }\n    });\n  return closestFeature;\n};\n\n\n/**\n * Get the extent of the features currently in the source.\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent. If provided, no new extent\n *     will be created. Instead, that extent's coordinates will be overwritten.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nVectorSource.prototype.getExtent = function(opt_extent) {\n  return this.featuresRtree_.getExtent(opt_extent);\n};\n\n\n/**\n * Get a feature by its identifier (the value returned by feature.getId()).\n * Note that the index treats string and numeric identifiers as the same.  So\n * `source.getFeatureById(2)` will return a feature with id `'2'` or `2`.\n *\n * @param {string|number} id Feature identifier.\n * @return {module:ol/Feature} The feature (or `null` if not found).\n * @api\n */\nVectorSource.prototype.getFeatureById = function(id) {\n  const feature = this.idIndex_[id.toString()];\n  return feature !== undefined ? feature : null;\n};\n\n\n/**\n * Get the format associated with this source.\n *\n * @return {module:ol/format/Feature|undefined} The feature format.\n * @api\n */\nVectorSource.prototype.getFormat = function() {\n  return this.format_;\n};\n\n\n/**\n * @return {boolean} The source can have overlapping geometries.\n */\nVectorSource.prototype.getOverlaps = function() {\n  return this.overlaps_;\n};\n\n\n/**\n * @override\n */\nVectorSource.prototype.getResolutions = function() {};\n\n\n/**\n * Get the url associated with this source.\n *\n * @return {string|module:ol/featureloader~FeatureUrlFunction|undefined} The url.\n * @api\n */\nVectorSource.prototype.getUrl = function() {\n  return this.url_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @private\n */\nVectorSource.prototype.handleFeatureChange_ = function(event) {\n  const feature = /** @type {module:ol/Feature} */ (event.target);\n  const featureKey = getUid(feature).toString();\n  const geometry = feature.getGeometry();\n  if (!geometry) {\n    if (!(featureKey in this.nullGeometryFeatures_)) {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.remove(feature);\n      }\n      this.nullGeometryFeatures_[featureKey] = feature;\n    }\n  } else {\n    const extent = geometry.getExtent();\n    if (featureKey in this.nullGeometryFeatures_) {\n      delete this.nullGeometryFeatures_[featureKey];\n      if (this.featuresRtree_) {\n        this.featuresRtree_.insert(extent, feature);\n      }\n    } else {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.update(extent, feature);\n      }\n    }\n  }\n  const id = feature.getId();\n  if (id !== undefined) {\n    const sid = id.toString();\n    if (featureKey in this.undefIdIndex_) {\n      delete this.undefIdIndex_[featureKey];\n      this.idIndex_[sid] = feature;\n    } else {\n      if (this.idIndex_[sid] !== feature) {\n        this.removeFromIdIndex_(feature);\n        this.idIndex_[sid] = feature;\n      }\n    }\n  } else {\n    if (!(featureKey in this.undefIdIndex_)) {\n      this.removeFromIdIndex_(feature);\n      this.undefIdIndex_[featureKey] = feature;\n    }\n  }\n  this.changed();\n  this.dispatchEvent(new VectorSourceEvent(\n    VectorEventType.CHANGEFEATURE, feature));\n};\n\n/**\n * Returns true if the feature is contained within the source.\n * @param {module:ol/Feature} feature Feature.\n * @return {boolean} Has feature.\n * @api\n */\nVectorSource.prototype.hasFeature = function(feature) {\n  const id = feature.getId();\n  if (id !== undefined) {\n    return id in this.idIndex_;\n  } else {\n    const featureKey = getUid(feature).toString();\n    return featureKey in this.undefIdIndex_;\n  }\n};\n\n/**\n * @return {boolean} Is empty.\n */\nVectorSource.prototype.isEmpty = function() {\n  return this.featuresRtree_.isEmpty() && isEmpty(this.nullGeometryFeatures_);\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {module:ol/proj/Projection} projection Projection.\n */\nVectorSource.prototype.loadFeatures = function(extent, resolution, projection) {\n  const loadedExtentsRtree = this.loadedExtentsRtree_;\n  const extentsToLoad = this.strategy_(extent, resolution);\n  for (let i = 0, ii = extentsToLoad.length; i < ii; ++i) {\n    const extentToLoad = extentsToLoad[i];\n    const alreadyLoaded = loadedExtentsRtree.forEachInExtent(extentToLoad,\n      /**\n       * @param {{extent: module:ol/extent~Extent}} object Object.\n       * @return {boolean} Contains.\n       */\n      function(object) {\n        return containsExtent(object.extent, extentToLoad);\n      });\n    if (!alreadyLoaded) {\n      this.loader_.call(this, extentToLoad, resolution, projection);\n      loadedExtentsRtree.insert(extentToLoad, {extent: extentToLoad.slice()});\n    }\n  }\n};\n\n\n/**\n * Remove an extent from the list of loaded extents.\n * @param {module:ol/extent~Extent} extent Extent.\n * @api\n */\nVectorSource.prototype.removeLoadedExtent = function(extent) {\n  const loadedExtentsRtree = this.loadedExtentsRtree_;\n  let obj;\n  loadedExtentsRtree.forEachInExtent(extent, function(object) {\n    if (equals(object.extent, extent)) {\n      obj = object;\n      return true;\n    }\n  });\n  if (obj) {\n    loadedExtentsRtree.remove(obj);\n  }\n};\n\n\n/**\n * Remove a single feature from the source.  If you want to remove all features\n * at once, use the {@link module:ol/source/Vector~VectorSource#clear #clear()} method\n * instead.\n * @param {module:ol/Feature} feature Feature to remove.\n * @api\n */\nVectorSource.prototype.removeFeature = function(feature) {\n  const featureKey = getUid(feature).toString();\n  if (featureKey in this.nullGeometryFeatures_) {\n    delete this.nullGeometryFeatures_[featureKey];\n  } else {\n    if (this.featuresRtree_) {\n      this.featuresRtree_.remove(feature);\n    }\n  }\n  this.removeFeatureInternal(feature);\n  this.changed();\n};\n\n\n/**\n * Remove feature without firing a `change` event.\n * @param {module:ol/Feature} feature Feature.\n * @protected\n */\nVectorSource.prototype.removeFeatureInternal = function(feature) {\n  const featureKey = getUid(feature).toString();\n  this.featureChangeKeys_[featureKey].forEach(unlistenByKey);\n  delete this.featureChangeKeys_[featureKey];\n  const id = feature.getId();\n  if (id !== undefined) {\n    delete this.idIndex_[id.toString()];\n  } else {\n    delete this.undefIdIndex_[featureKey];\n  }\n  this.dispatchEvent(new VectorSourceEvent(\n    VectorEventType.REMOVEFEATURE, feature));\n};\n\n\n/**\n * Remove a feature from the id index.  Called internally when the feature id\n * may have changed.\n * @param {module:ol/Feature} feature The feature.\n * @return {boolean} Removed the feature from the index.\n * @private\n */\nVectorSource.prototype.removeFromIdIndex_ = function(feature) {\n  let removed = false;\n  for (const id in this.idIndex_) {\n    if (this.idIndex_[id] === feature) {\n      delete this.idIndex_[id];\n      removed = true;\n      break;\n    }\n  }\n  return removed;\n};\n\n\n/**\n * Set the new loader of the source. The next loadFeatures call will use the\n * new loader.\n * @param {module:ol/featureloader~FeatureLoader} loader The loader to set.\n * @api\n */\nVectorSource.prototype.setLoader = function(loader) {\n  this.loader_ = loader;\n};\n\nexport default VectorSource;\n","/**\n * @module ol/interaction/Draw\n */\nimport {inherits} from '../index.js';\nimport EventType from '../events/EventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {getChangeEventType} from '../Object.js';\nimport {squaredDistance as squaredCoordinateDistance} from '../coordinate.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {noModifierKeys, always, shiftKeyOnly} from '../events/condition.js';\nimport {boundingExtent, getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport Circle from '../geom/Circle.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport {POINTER_TYPE} from '../pointer/MouseSource.js';\nimport Point from '../geom/Point.js';\nimport Polygon, {fromCircle, makeRegular} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport InteractionProperty from '../interaction/Property.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/geom/GeometryType} type Geometry type of\n * the geometries being drawn with this instance.\n * @property {number} [clickTolerance=6] The maximum distance in pixels between\n * \"down\" and \"up\" for a \"up\" event to be considered a \"click\" event and\n * actually add a point/vertex to the geometry being drawn.  The default of `6`\n * was chosen for the draw interaction to behave correctly on mouse as well as\n * on touch devices.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * Destination collection for the drawn features.\n * @property {module:ol/source/Vector} [source] Destination source for\n * the drawn features.\n * @property {number} [dragVertexDelay=500] Delay in milliseconds after pointerdown\n * before the current vertex can be dragged to its exact position.\n * @property {number} [snapTolerance=12] Pixel distance for snapping to the\n * drawing finish.\n * @property {boolean} [stopClick=false] Stop click, singleclick, and\n * doubleclick events from firing during drawing.\n * @property {number} [maxPoints] The number of points that can be drawn before\n * a polygon ring or line string is finished. By default there is no\n * restriction.\n * @property {number} [minPoints] The number of points that must be drawn\n * before a polygon ring or line string can be finished. Default is `3` for\n * polygon rings and `2` for line strings.\n * @property {module:ol/events/condition~Condition} [finishCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether the drawing can be finished.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style for sketch features.\n * @property {module:ol/interaction/Draw~GeometryFunction} [geometryFunction]\n * Function that is called when a geometry's coordinates are updated.\n * @property {string} [geometryName] Geometry name to use for features created\n * by the draw interaction.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default {@link module:ol/events/condition~noModifierKeys}, i.e. a click,\n * adds a vertex or deactivates freehand drawing.\n * @property {boolean} [freehand=false] Operate in freehand mode for lines,\n * polygons, and circles.  This makes the interaction always operate in freehand\n * mode and takes precedence over any `freehandCondition` option.\n * @property {module:ol/events/condition~Condition} [freehandCondition]\n * Condition that activates freehand drawing for lines and polygons. This\n * function takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether that event should be handled. The\n * default is {@link module:ol/events/condition~shiftKeyOnly}, meaning that the\n * Shift key activates freehand drawing.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * Function that takes an array of coordinates and an optional existing geometry as\n * arguments, and returns a geometry. The optional existing geometry is the\n * geometry that is returned when the function is called without a second\n * argument.\n * @typedef {function(!Array.<module:ol/coordinate~Coordinate>, module:ol/geom/SimpleGeometry=):\n *     module:ol/geom/SimpleGeometry} GeometryFunction\n */\n\n\n/**\n * Draw mode.  This collapses multi-part geometry types with their single-part\n * cousins.\n * @enum {string}\n */\nconst Mode = {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  CIRCLE: 'Circle'\n};\n\n\n/**\n * @enum {string}\n */\nconst DrawEventType = {\n  /**\n   * Triggered upon feature draw start\n   * @event module:ol/interaction/Draw~DrawEvent#drawstart\n   * @api\n   */\n  DRAWSTART: 'drawstart',\n  /**\n   * Triggered upon feature draw end\n   * @event module:ol/interaction/Draw~DrawEvent#drawend\n   * @api\n   */\n  DRAWEND: 'drawend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Draw~Draw} instances are\n * instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/Draw~DrawEventType} type Type.\n * @param {module:ol/Feature} feature The feature drawn.\n */\nconst DrawEvent = function(type, feature) {\n\n  Event.call(this, type);\n\n  /**\n   * The feature being drawn.\n   * @type {module:ol/Feature}\n   * @api\n   */\n  this.feature = feature;\n\n};\n\ninherits(DrawEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for drawing feature geometries.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Draw~DrawEvent\n * @param {module:ol/interaction/Draw~Options} options Options.\n * @api\n */\nconst Draw = function(options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.shouldHandle_ = false;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.downPx_ = null;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.downTimeout_;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.lastDragTime_;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.freehand_ = false;\n\n  /**\n   * Target source for drawn features.\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = options.source ? options.source : null;\n\n  /**\n   * Target collection for drawn features.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features ? options.features : null;\n\n  /**\n   * Pixel distance for snapping.\n   * @type {number}\n   * @private\n   */\n  this.snapTolerance_ = options.snapTolerance ? options.snapTolerance : 12;\n\n  /**\n   * Geometry type.\n   * @type {module:ol/geom/GeometryType}\n   * @private\n   */\n  this.type_ = /** @type {module:ol/geom/GeometryType} */ (options.type);\n\n  /**\n   * Drawing mode (derived from geometry type.\n   * @type {module:ol/interaction/Draw~Mode}\n   * @private\n   */\n  this.mode_ = getMode(this.type_);\n\n  /**\n   * Stop click, singleclick, and doubleclick events from firing during drawing.\n   * Default is `false`.\n   * @type {boolean}\n   * @private\n   */\n  this.stopClick_ = !!options.stopClick;\n\n  /**\n   * The number of points that must be drawn before a polygon ring or line\n   * string can be finished.  The default is 3 for polygon rings and 2 for\n   * line strings.\n   * @type {number}\n   * @private\n   */\n  this.minPoints_ = options.minPoints ?\n    options.minPoints :\n    (this.mode_ === Mode.POLYGON ? 3 : 2);\n\n  /**\n   * The number of points that can be drawn before a polygon ring or line string\n   * is finished. The default is no restriction.\n   * @type {number}\n   * @private\n   */\n  this.maxPoints_ = options.maxPoints ? options.maxPoints : Infinity;\n\n  /**\n   * A function to decide if a potential finish coordinate is permissible\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.finishCondition_ = options.finishCondition ? options.finishCondition : TRUE;\n\n  let geometryFunction = options.geometryFunction;\n  if (!geometryFunction) {\n    if (this.type_ === GeometryType.CIRCLE) {\n      /**\n       * @param {!Array.<module:ol/coordinate~Coordinate>} coordinates\n       *     The coordinates.\n       * @param {module:ol/geom/SimpleGeometry=} opt_geometry Optional geometry.\n       * @return {module:ol/geom/SimpleGeometry} A geometry.\n       */\n      geometryFunction = function(coordinates, opt_geometry) {\n        const circle = opt_geometry ? /** @type {module:ol/geom/Circle} */ (opt_geometry) :\n          new Circle([NaN, NaN]);\n        const squaredLength = squaredCoordinateDistance(\n          coordinates[0], coordinates[1]);\n        circle.setCenterAndRadius(coordinates[0], Math.sqrt(squaredLength));\n        return circle;\n      };\n    } else {\n      let Constructor;\n      const mode = this.mode_;\n      if (mode === Mode.POINT) {\n        Constructor = Point;\n      } else if (mode === Mode.LINE_STRING) {\n        Constructor = LineString;\n      } else if (mode === Mode.POLYGON) {\n        Constructor = Polygon;\n      }\n      /**\n       * @param {!Array.<module:ol/coordinate~Coordinate>} coordinates\n       *     The coordinates.\n       * @param {module:ol/geom/SimpleGeometry=} opt_geometry Optional geometry.\n       * @return {module:ol/geom/SimpleGeometry} A geometry.\n       */\n      geometryFunction = function(coordinates, opt_geometry) {\n        let geometry = opt_geometry;\n        if (geometry) {\n          if (mode === Mode.POLYGON) {\n            if (coordinates[0].length) {\n              // Add a closing coordinate to match the first\n              geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n            } else {\n              geometry.setCoordinates([]);\n            }\n          } else {\n            geometry.setCoordinates(coordinates);\n          }\n        } else {\n          geometry = new Constructor(coordinates);\n        }\n        return geometry;\n      };\n    }\n  }\n\n  /**\n   * @type {module:ol/interaction/Draw~GeometryFunction}\n   * @private\n   */\n  this.geometryFunction_ = geometryFunction;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.dragVertexDelay_ = options.dragVertexDelay !== undefined ? options.dragVertexDelay : 500;\n\n  /**\n   * Finish coordinate for the feature (first point for polygons, last point for\n   * linestrings).\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.finishCoordinate_ = null;\n\n  /**\n   * Sketch feature.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchFeature_ = null;\n\n  /**\n   * Sketch point.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchPoint_ = null;\n\n  /**\n   * Sketch coordinates. Used when drawing a line or polygon.\n   * @type {module:ol/coordinate~Coordinate|Array.<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>}\n   * @private\n   */\n  this.sketchCoords_ = null;\n\n  /**\n   * Sketch line. Used when drawing polygon.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchLine_ = null;\n\n  /**\n   * Sketch line coordinates. Used when drawing a polygon or circle.\n   * @type {Array.<module:ol/coordinate~Coordinate>}\n   * @private\n   */\n  this.sketchLineCoords_ = null;\n\n  /**\n   * Squared tolerance for handling up events.  If the squared distance\n   * between a down and up event is greater than this tolerance, up events\n   * will not be handled.\n   * @type {number}\n   * @private\n   */\n  this.squaredClickTolerance_ = options.clickTolerance ?\n    options.clickTolerance * options.clickTolerance : 36;\n\n  /**\n   * Draw overlay where our sketch features are drawn.\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.overlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: options.wrapX ? options.wrapX : false\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileInteracting: true\n  });\n\n  /**\n   * Name of the geometry attribute for newly created features.\n   * @type {string|undefined}\n   * @private\n   */\n  this.geometryName_ = options.geometryName;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : noModifierKeys;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.freehandCondition_;\n  if (options.freehand) {\n    this.freehandCondition_ = always;\n  } else {\n    this.freehandCondition_ = options.freehandCondition ?\n      options.freehandCondition : shiftKeyOnly;\n  }\n\n  listen(this,\n    getChangeEventType(InteractionProperty.ACTIVE),\n    this.updateState_, this);\n\n};\n\ninherits(Draw, PointerInteraction);\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  return function(feature, resolution) {\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\n/**\n * @inheritDoc\n */\nDraw.prototype.setMap = function(map) {\n  PointerInteraction.prototype.setMap.call(this, map);\n  this.updateState_();\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may actually\n * draw or finish the drawing.\n * @param {module:ol/MapBrowserEvent} event Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Draw}\n * @api\n */\nexport function handleEvent(event) {\n  if (event.originalEvent.type === EventType.CONTEXTMENU) {\n    // Avoid context menu for long taps when drawing on mobile\n    event.preventDefault();\n  }\n  this.freehand_ = this.mode_ !== Mode.POINT && this.freehandCondition_(event);\n  let move = event.type === MapBrowserEventType.POINTERMOVE;\n  let pass = true;\n  if (this.lastDragTime_ && event.type === MapBrowserEventType.POINTERDRAG) {\n    const now = Date.now();\n    if (now - this.lastDragTime_ >= this.dragVertexDelay_) {\n      this.downPx_ = event.pixel;\n      this.shouldHandle_ = !this.freehand_;\n      move = true;\n    } else {\n      this.lastDragTime_ = undefined;\n    }\n    if (this.shouldHandle_ && this.downTimeout_) {\n      clearTimeout(this.downTimeout_);\n      this.downTimeout_ = undefined;\n    }\n  }\n  if (this.freehand_ &&\n      event.type === MapBrowserEventType.POINTERDRAG &&\n      this.sketchFeature_ !== null) {\n    this.addToDrawing_(event);\n    pass = false;\n  } else if (this.freehand_ &&\n      event.type === MapBrowserEventType.POINTERDOWN) {\n    pass = false;\n  } else if (move) {\n    pass = event.type === MapBrowserEventType.POINTERMOVE;\n    if (pass && this.freehand_) {\n      pass = this.handlePointerMove_(event);\n    } else if (event.pointerEvent.pointerType == POINTER_TYPE ||\n        (event.type === MapBrowserEventType.POINTERDRAG && !this.downTimeout_)) {\n      this.handlePointerMove_(event);\n    }\n  } else if (event.type === MapBrowserEventType.DBLCLICK) {\n    pass = false;\n  }\n\n  return handlePointerEvent.call(this, event) && pass;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Draw}\n */\nfunction handleDownEvent(event) {\n  this.shouldHandle_ = !this.freehand_;\n\n  if (this.freehand_) {\n    this.downPx_ = event.pixel;\n    if (!this.finishCoordinate_) {\n      this.startDrawing_(event);\n    }\n    return true;\n  } else if (this.condition_(event)) {\n    this.lastDragTime_ = Date.now();\n    this.downTimeout_ = setTimeout(function() {\n      this.handlePointerMove_(new MapBrowserPointerEvent(\n        MapBrowserEventType.POINTERMOVE, event.map, event.pointerEvent, event.frameState));\n    }.bind(this), this.dragVertexDelay_);\n    this.downPx_ = event.pixel;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Draw}\n */\nfunction handleUpEvent(event) {\n  let pass = true;\n\n  if (this.downTimeout_) {\n    clearTimeout(this.downTimeout_);\n    this.downTimeout_ = undefined;\n  }\n\n  this.handlePointerMove_(event);\n\n  const circleMode = this.mode_ === Mode.CIRCLE;\n\n  if (this.shouldHandle_) {\n    if (!this.finishCoordinate_) {\n      this.startDrawing_(event);\n      if (this.mode_ === Mode.POINT) {\n        this.finishDrawing();\n      }\n    } else if (this.freehand_ || circleMode) {\n      this.finishDrawing();\n    } else if (this.atFinish_(event)) {\n      if (this.finishCondition_(event)) {\n        this.finishDrawing();\n      }\n    } else {\n      this.addToDrawing_(event);\n    }\n    pass = false;\n  } else if (this.freehand_) {\n    this.finishCoordinate_ = null;\n    this.abortDrawing_();\n  }\n  if (!pass && this.stopClick_) {\n    event.stopPropagation();\n  }\n  return pass;\n}\n\n\n/**\n * Handle move events.\n * @param {module:ol/MapBrowserEvent} event A move event.\n * @return {boolean} Pass the event to other interactions.\n * @private\n */\nDraw.prototype.handlePointerMove_ = function(event) {\n  if (this.downPx_ &&\n      ((!this.freehand_ && this.shouldHandle_) ||\n      (this.freehand_ && !this.shouldHandle_))) {\n    const downPx = this.downPx_;\n    const clickPx = event.pixel;\n    const dx = downPx[0] - clickPx[0];\n    const dy = downPx[1] - clickPx[1];\n    const squaredDistance = dx * dx + dy * dy;\n    this.shouldHandle_ = this.freehand_ ?\n      squaredDistance > this.squaredClickTolerance_ :\n      squaredDistance <= this.squaredClickTolerance_;\n    if (!this.shouldHandle_) {\n      return true;\n    }\n  }\n\n  if (this.finishCoordinate_) {\n    this.modifyDrawing_(event);\n  } else {\n    this.createOrUpdateSketchPoint_(event);\n  }\n  return true;\n};\n\n\n/**\n * Determine if an event is within the snapping tolerance of the start coord.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @return {boolean} The event is within the snapping tolerance of the start.\n * @private\n */\nDraw.prototype.atFinish_ = function(event) {\n  let at = false;\n  if (this.sketchFeature_) {\n    let potentiallyDone = false;\n    let potentiallyFinishCoordinates = [this.finishCoordinate_];\n    if (this.mode_ === Mode.LINE_STRING) {\n      potentiallyDone = this.sketchCoords_.length > this.minPoints_;\n    } else if (this.mode_ === Mode.POLYGON) {\n      potentiallyDone = this.sketchCoords_[0].length >\n          this.minPoints_;\n      potentiallyFinishCoordinates = [this.sketchCoords_[0][0],\n        this.sketchCoords_[0][this.sketchCoords_[0].length - 2]];\n    }\n    if (potentiallyDone) {\n      const map = event.map;\n      for (let i = 0, ii = potentiallyFinishCoordinates.length; i < ii; i++) {\n        const finishCoordinate = potentiallyFinishCoordinates[i];\n        const finishPixel = map.getPixelFromCoordinate(finishCoordinate);\n        const pixel = event.pixel;\n        const dx = pixel[0] - finishPixel[0];\n        const dy = pixel[1] - finishPixel[1];\n        const snapTolerance = this.freehand_ ? 1 : this.snapTolerance_;\n        at = Math.sqrt(dx * dx + dy * dy) <= snapTolerance;\n        if (at) {\n          this.finishCoordinate_ = finishCoordinate;\n          break;\n        }\n      }\n    }\n  }\n  return at;\n};\n\n\n/**\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.createOrUpdateSketchPoint_ = function(event) {\n  const coordinates = event.coordinate.slice();\n  if (!this.sketchPoint_) {\n    this.sketchPoint_ = new Feature(new Point(coordinates));\n    this.updateSketchFeatures_();\n  } else {\n    const sketchPointGeom = /** @type {module:ol/geom/Point} */ (this.sketchPoint_.getGeometry());\n    sketchPointGeom.setCoordinates(coordinates);\n  }\n};\n\n\n/**\n * Start the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.startDrawing_ = function(event) {\n  const start = event.coordinate;\n  this.finishCoordinate_ = start;\n  if (this.mode_ === Mode.POINT) {\n    this.sketchCoords_ = start.slice();\n  } else if (this.mode_ === Mode.POLYGON) {\n    this.sketchCoords_ = [[start.slice(), start.slice()]];\n    this.sketchLineCoords_ = this.sketchCoords_[0];\n  } else {\n    this.sketchCoords_ = [start.slice(), start.slice()];\n  }\n  if (this.sketchLineCoords_) {\n    this.sketchLine_ = new Feature(\n      new LineString(this.sketchLineCoords_));\n  }\n  const geometry = this.geometryFunction_(this.sketchCoords_);\n  this.sketchFeature_ = new Feature();\n  if (this.geometryName_) {\n    this.sketchFeature_.setGeometryName(this.geometryName_);\n  }\n  this.sketchFeature_.setGeometry(geometry);\n  this.updateSketchFeatures_();\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n};\n\n\n/**\n * Modify the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.modifyDrawing_ = function(event) {\n  let coordinate = event.coordinate;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let coordinates, last;\n  if (this.mode_ === Mode.POINT) {\n    last = this.sketchCoords_;\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    last = coordinates[coordinates.length - 1];\n    if (this.atFinish_(event)) {\n      // snap to finish\n      coordinate = this.finishCoordinate_.slice();\n    }\n  } else {\n    coordinates = this.sketchCoords_;\n    last = coordinates[coordinates.length - 1];\n  }\n  last[0] = coordinate[0];\n  last[1] = coordinate[1];\n  this.geometryFunction_(/** @type {!Array.<module:ol/coordinate~Coordinate>} */ (this.sketchCoords_), geometry);\n  if (this.sketchPoint_) {\n    const sketchPointGeom = /** @type {module:ol/geom/Point} */ (this.sketchPoint_.getGeometry());\n    sketchPointGeom.setCoordinates(coordinate);\n  }\n  let sketchLineGeom;\n  if (geometry instanceof Polygon &&\n      this.mode_ !== Mode.POLYGON) {\n    if (!this.sketchLine_) {\n      this.sketchLine_ = new Feature(new LineString(null));\n    }\n    const ring = geometry.getLinearRing(0);\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setFlatCoordinates(\n      ring.getLayout(), ring.getFlatCoordinates());\n  } else if (this.sketchLineCoords_) {\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setCoordinates(this.sketchLineCoords_);\n  }\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Add a new coordinate to the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.addToDrawing_ = function(event) {\n  const coordinate = event.coordinate;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let done;\n  let coordinates;\n  if (this.mode_ === Mode.LINE_STRING) {\n    this.finishCoordinate_ = coordinate.slice();\n    coordinates = this.sketchCoords_;\n    if (coordinates.length >= this.maxPoints_) {\n      if (this.freehand_) {\n        coordinates.pop();\n      } else {\n        done = true;\n      }\n    }\n    coordinates.push(coordinate.slice());\n    this.geometryFunction_(coordinates, geometry);\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    if (coordinates.length >= this.maxPoints_) {\n      if (this.freehand_) {\n        coordinates.pop();\n      } else {\n        done = true;\n      }\n    }\n    coordinates.push(coordinate.slice());\n    if (done) {\n      this.finishCoordinate_ = coordinates[0];\n    }\n    this.geometryFunction_(this.sketchCoords_, geometry);\n  }\n  this.updateSketchFeatures_();\n  if (done) {\n    this.finishDrawing();\n  }\n};\n\n\n/**\n * Remove last point of the feature currently being drawn.\n * @api\n */\nDraw.prototype.removeLastPoint = function() {\n  if (!this.sketchFeature_) {\n    return;\n  }\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let coordinates, sketchLineGeom;\n  if (this.mode_ === Mode.LINE_STRING) {\n    coordinates = this.sketchCoords_;\n    coordinates.splice(-2, 1);\n    this.geometryFunction_(coordinates, geometry);\n    if (coordinates.length >= 2) {\n      this.finishCoordinate_ = coordinates[coordinates.length - 2].slice();\n    }\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    coordinates.splice(-2, 1);\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setCoordinates(coordinates);\n    this.geometryFunction_(this.sketchCoords_, geometry);\n  }\n\n  if (coordinates.length === 0) {\n    this.finishCoordinate_ = null;\n  }\n\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Stop drawing and add the sketch feature to the target layer.\n * The {@link module:ol/interaction/Draw~DrawEventType.DRAWEND} event is\n * dispatched before inserting the feature.\n * @api\n */\nDraw.prototype.finishDrawing = function() {\n  const sketchFeature = this.abortDrawing_();\n  if (!sketchFeature) {\n    return;\n  }\n  let coordinates = this.sketchCoords_;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (sketchFeature.getGeometry());\n  if (this.mode_ === Mode.LINE_STRING) {\n    // remove the redundant last point\n    coordinates.pop();\n    this.geometryFunction_(coordinates, geometry);\n  } else if (this.mode_ === Mode.POLYGON) {\n    // remove the redundant last point in ring\n    coordinates[0].pop();\n    this.geometryFunction_(coordinates, geometry);\n    coordinates = geometry.getCoordinates();\n  }\n\n  // cast multi-part geometries\n  if (this.type_ === GeometryType.MULTI_POINT) {\n    sketchFeature.setGeometry(new MultiPoint([coordinates]));\n  } else if (this.type_ === GeometryType.MULTI_LINE_STRING) {\n    sketchFeature.setGeometry(new MultiLineString([coordinates]));\n  } else if (this.type_ === GeometryType.MULTI_POLYGON) {\n    sketchFeature.setGeometry(new MultiPolygon([coordinates]));\n  }\n\n  // First dispatch event to allow full set up of feature\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWEND, sketchFeature));\n\n  // Then insert feature\n  if (this.features_) {\n    this.features_.push(sketchFeature);\n  }\n  if (this.source_) {\n    this.source_.addFeature(sketchFeature);\n  }\n};\n\n\n/**\n * Stop drawing without adding the sketch feature to the target layer.\n * @return {module:ol/Feature} The sketch feature (or null if none).\n * @private\n */\nDraw.prototype.abortDrawing_ = function() {\n  this.finishCoordinate_ = null;\n  const sketchFeature = this.sketchFeature_;\n  if (sketchFeature) {\n    this.sketchFeature_ = null;\n    this.sketchPoint_ = null;\n    this.sketchLine_ = null;\n    this.overlay_.getSource().clear(true);\n  }\n  return sketchFeature;\n};\n\n\n/**\n * Extend an existing geometry by adding additional points. This only works\n * on features with `LineString` geometries, where the interaction will\n * extend lines by adding points to the end of the coordinates array.\n * @param {!module:ol/Feature} feature Feature to be extended.\n * @api\n */\nDraw.prototype.extend = function(feature) {\n  const geometry = feature.getGeometry();\n  const lineString = /** @type {module:ol/geom/LineString} */ (geometry);\n  this.sketchFeature_ = feature;\n  this.sketchCoords_ = lineString.getCoordinates();\n  const last = this.sketchCoords_[this.sketchCoords_.length - 1];\n  this.finishCoordinate_ = last.slice();\n  this.sketchCoords_.push(last.slice());\n  this.updateSketchFeatures_();\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n};\n\n\n/**\n * @inheritDoc\n */\nDraw.prototype.shouldStopEvent = FALSE;\n\n\n/**\n * Redraw the sketch features.\n * @private\n */\nDraw.prototype.updateSketchFeatures_ = function() {\n  const sketchFeatures = [];\n  if (this.sketchFeature_) {\n    sketchFeatures.push(this.sketchFeature_);\n  }\n  if (this.sketchLine_) {\n    sketchFeatures.push(this.sketchLine_);\n  }\n  if (this.sketchPoint_) {\n    sketchFeatures.push(this.sketchPoint_);\n  }\n  const overlaySource = this.overlay_.getSource();\n  overlaySource.clear(true);\n  overlaySource.addFeatures(sketchFeatures);\n};\n\n\n/**\n * @private\n */\nDraw.prototype.updateState_ = function() {\n  const map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    this.abortDrawing_();\n  }\n  this.overlay_.setMap(active ? map : null);\n};\n\n\n/**\n * Create a `geometryFunction` for `type: 'Circle'` that will create a regular\n * polygon with a user specified number of sides and start angle instead of an\n * `module:ol/geom/Circle~Circle` geometry.\n * @param {number=} opt_sides Number of sides of the regular polygon. Default is\n *     32.\n * @param {number=} opt_angle Angle of the first point in radians. 0 means East.\n *     Default is the angle defined by the heading from the center of the\n *     regular polygon to the current pointer position.\n * @return {module:ol/interaction/Draw~GeometryFunction} Function that draws a\n *     polygon.\n * @api\n */\nexport function createRegularPolygon(opt_sides, opt_angle) {\n  return function(coordinates, opt_geometry) {\n    const center = coordinates[0];\n    const end = coordinates[1];\n    const radius = Math.sqrt(\n      squaredCoordinateDistance(center, end));\n    const geometry = opt_geometry ? /** @type {module:ol/geom/Polygon} */ (opt_geometry) :\n      fromCircle(new Circle(center), opt_sides);\n    const angle = opt_angle ? opt_angle :\n      Math.atan((end[1] - center[1]) / (end[0] - center[0]));\n    makeRegular(geometry, center, radius, angle);\n    return geometry;\n  };\n}\n\n\n/**\n * Create a `geometryFunction` that will create a box-shaped polygon (aligned\n * with the coordinate system axes).  Use this with the draw interaction and\n * `type: 'Circle'` to return a box instead of a circle geometry.\n * @return {module:ol/interaction/Draw~GeometryFunction} Function that draws a box-shaped polygon.\n * @api\n */\nexport function createBox() {\n  return (\n    function(coordinates, opt_geometry) {\n      const extent = boundingExtent(coordinates);\n      const geometry = opt_geometry || new Polygon(null);\n      geometry.setCoordinates([[\n        getBottomLeft(extent),\n        getBottomRight(extent),\n        getTopRight(extent),\n        getTopLeft(extent),\n        getBottomLeft(extent)\n      ]]);\n      return geometry;\n    }\n  );\n}\n\n\n/**\n * Get the drawing mode.  The mode for mult-part geometries is the same as for\n * their single-part cousins.\n * @param {module:ol/geom/GeometryType} type Geometry type.\n * @return {module:ol/interaction/Draw~Mode} Drawing mode.\n */\nfunction getMode(type) {\n  let mode;\n  if (type === GeometryType.POINT ||\n      type === GeometryType.MULTI_POINT) {\n    mode = Mode.POINT;\n  } else if (type === GeometryType.LINE_STRING ||\n      type === GeometryType.MULTI_LINE_STRING) {\n    mode = Mode.LINE_STRING;\n  } else if (type === GeometryType.POLYGON ||\n      type === GeometryType.MULTI_POLYGON) {\n    mode = Mode.POLYGON;\n  } else if (type === GeometryType.CIRCLE) {\n    mode = Mode.CIRCLE;\n  }\n  return (\n    /** @type {!module:ol/interaction/Draw~Mode} */ (mode)\n  );\n}\n\n\nexport default Draw;\n","/**\n * @module ol/interaction/Extent\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {squaredDistanceToSegment, closestOnSegment, distance as coordinateDistance, squaredDistance as squaredCoordinateDistance} from '../coordinate.js';\nimport Event from '../events/Event.js';\nimport {boundingExtent, getArea} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport {fromExtent as polygonFromExtent} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/extent~Extent} [extent] Initial extent. Defaults to no\n * initial extent.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [boxStyle]\n * Style for the drawn extent box. Defaults to\n * {@link module:ol/style/Style~createEditing()['Polygon']}\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the\n * pointer close enough to a segment or vertex for editing.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [pointerStyle]\n * Style for the cursor used to draw the extent. Defaults to\n * {@link module:ol/style/Style~createEditing()['Point']}\n * @property {boolean} [wrapX=false] Wrap the drawn extent across multiple maps\n * in the X direction? Only affects visuals, not functionality.\n */\n\n\n/**\n * @enum {string}\n */\nconst ExtentEventType = {\n  /**\n   * Triggered after the extent is changed\n   * @event module:ol/interaction/Extent~ExtentEventType#extentchanged\n   * @api\n   */\n  EXTENTCHANGED: 'extentchanged'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Extent~Extent} instances are\n * instances of this type.\n *\n * @constructor\n * @param {module:ol/extent~Extent} extent the new extent\n * @extends {module:ol/events/Event}\n */\nconst ExtentInteractionEvent = function(extent) {\n  Event.call(this, ExtentEventType.EXTENTCHANGED);\n\n  /**\n   * The current extent.\n   * @type {module:ol/extent~Extent}\n   * @api\n   */\n  this.extent = extent;\n\n};\ninherits(ExtentInteractionEvent, Event);\n\n\n/**\n * @classdesc\n * Allows the user to draw a vector box by clicking and dragging on the map.\n * Once drawn, the vector box can be modified by dragging its vertices or edges.\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Extent~Event\n * @param {module:ol/interaction/Extent~Options=} opt_options Options.\n * @api\n */\nconst ExtentInteraction = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * Extent of the drawn box\n   * @type {module:ol/extent~Extent}\n   * @private\n   */\n  this.extent_ = null;\n\n  /**\n   * Handler for pointer move events\n   * @type {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent|null}\n   * @private\n   */\n  this.pointerHandler_ = null;\n\n  /**\n   * Pixel threshold to snap to extent\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * Is the pointer snapped to an extent vertex\n   * @type {boolean}\n   * @private\n   */\n  this.snappedToVertex_ = false;\n\n  /**\n   * Feature for displaying the visible extent\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.extentFeature_ = null;\n\n  /**\n   * Feature for displaying the visible pointer\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.vertexFeature_ = null;\n\n  if (!opt_options) {\n    opt_options = {};\n  }\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * Layer for the extentFeature\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.extentOverlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!opt_options.wrapX\n    }),\n    style: opt_options.boxStyle ? opt_options.boxStyle : getDefaultExtentStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * Layer for the vertexFeature\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.vertexOverlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!opt_options.wrapX\n    }),\n    style: opt_options.pointerStyle ? opt_options.pointerStyle : getDefaultPointerStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  if (opt_options.extent) {\n    this.setExtent(opt_options.extent);\n  }\n};\n\ninherits(ExtentInteraction, PointerInteraction);\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Event.\n * @return {boolean} Propagate event?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n  //display pointer (if not dragging)\n  if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE && !this.handlingDownUpSequence) {\n    this.handlePointerMove_(mapBrowserEvent);\n  }\n  //call pointer to determine up/down/drag\n  handlePointerEvent.call(this, mapBrowserEvent);\n  //return false to stop propagation\n  return false;\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Event handled?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  const pixel = mapBrowserEvent.pixel;\n  const map = mapBrowserEvent.map;\n\n  const extent = this.getExtent();\n  let vertex = this.snapToVertex_(pixel, map);\n\n  //find the extent corner opposite the passed corner\n  const getOpposingPoint = function(point) {\n    let x_ = null;\n    let y_ = null;\n    if (point[0] == extent[0]) {\n      x_ = extent[2];\n    } else if (point[0] == extent[2]) {\n      x_ = extent[0];\n    }\n    if (point[1] == extent[1]) {\n      y_ = extent[3];\n    } else if (point[1] == extent[3]) {\n      y_ = extent[1];\n    }\n    if (x_ !== null && y_ !== null) {\n      return [x_, y_];\n    }\n    return null;\n  };\n  if (vertex && extent) {\n    const x = (vertex[0] == extent[0] || vertex[0] == extent[2]) ? vertex[0] : null;\n    const y = (vertex[1] == extent[1] || vertex[1] == extent[3]) ? vertex[1] : null;\n\n    //snap to point\n    if (x !== null && y !== null) {\n      this.pointerHandler_ = getPointHandler(getOpposingPoint(vertex));\n    //snap to edge\n    } else if (x !== null) {\n      this.pointerHandler_ = getEdgeHandler(\n        getOpposingPoint([x, extent[1]]),\n        getOpposingPoint([x, extent[3]])\n      );\n    } else if (y !== null) {\n      this.pointerHandler_ = getEdgeHandler(\n        getOpposingPoint([extent[0], y]),\n        getOpposingPoint([extent[2], y])\n      );\n    }\n  //no snap - new bbox\n  } else {\n    vertex = map.getCoordinateFromPixel(pixel);\n    this.setExtent([vertex[0], vertex[1], vertex[0], vertex[1]]);\n    this.pointerHandler_ = getPointHandler(vertex);\n  }\n  return true; //event handled; start downup sequence\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Event handled?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (this.pointerHandler_) {\n    const pixelCoordinate = mapBrowserEvent.coordinate;\n    this.setExtent(this.pointerHandler_(pixelCoordinate));\n    this.createOrUpdatePointerFeature_(pixelCoordinate);\n  }\n  return true;\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  this.pointerHandler_ = null;\n  //If bbox is zero area, set to null;\n  const extent = this.getExtent();\n  if (!extent || getArea(extent) === 0) {\n    this.setExtent(null);\n  }\n  return false; //Stop handling downup sequence\n}\n\n/**\n * Returns the default style for the drawn bbox\n *\n * @return {module:ol/style/Style~StyleFunction} Default Extent style\n */\nfunction getDefaultExtentStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POLYGON];\n  };\n}\n\n/**\n * Returns the default style for the pointer\n *\n * @return {module:ol/style/Style~StyleFunction} Default pointer style\n */\nfunction getDefaultPointerStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POINT];\n  };\n}\n\n/**\n * @param {module:ol/coordinate~Coordinate} fixedPoint corner that will be unchanged in the new extent\n * @returns {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent} event handler\n */\nfunction getPointHandler(fixedPoint) {\n  return function(point) {\n    return boundingExtent([fixedPoint, point]);\n  };\n}\n\n/**\n * @param {module:ol/coordinate~Coordinate} fixedP1 first corner that will be unchanged in the new extent\n * @param {module:ol/coordinate~Coordinate} fixedP2 second corner that will be unchanged in the new extent\n * @returns {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent|null} event handler\n */\nfunction getEdgeHandler(fixedP1, fixedP2) {\n  if (fixedP1[0] == fixedP2[0]) {\n    return function(point) {\n      return boundingExtent([fixedP1, [point[0], fixedP2[1]]]);\n    };\n  } else if (fixedP1[1] == fixedP2[1]) {\n    return function(point) {\n      return boundingExtent([fixedP1, [fixedP2[0], point[1]]]);\n    };\n  } else {\n    return null;\n  }\n}\n\n/**\n * @param {module:ol/extent~Extent} extent extent\n * @returns {Array<Array<module:ol/coordinate~Coordinate>>} extent line segments\n */\nfunction getSegments(extent) {\n  return [\n    [[extent[0], extent[1]], [extent[0], extent[3]]],\n    [[extent[0], extent[3]], [extent[2], extent[3]]],\n    [[extent[2], extent[3]], [extent[2], extent[1]]],\n    [[extent[2], extent[1]], [extent[0], extent[1]]]\n  ];\n}\n\n/**\n * @param {module:ol~Pixel} pixel cursor location\n * @param {module:ol/PluggableMap} map map\n * @returns {module:ol/coordinate~Coordinate|null} snapped vertex on extent\n * @private\n */\nExtentInteraction.prototype.snapToVertex_ = function(pixel, map) {\n  const pixelCoordinate = map.getCoordinateFromPixel(pixel);\n  const sortByDistance = function(a, b) {\n    return squaredDistanceToSegment(pixelCoordinate, a) -\n        squaredDistanceToSegment(pixelCoordinate, b);\n  };\n  const extent = this.getExtent();\n  if (extent) {\n    //convert extents to line segments and find the segment closest to pixelCoordinate\n    const segments = getSegments(extent);\n    segments.sort(sortByDistance);\n    const closestSegment = segments[0];\n\n    let vertex = (closestOnSegment(pixelCoordinate,\n      closestSegment));\n    const vertexPixel = map.getPixelFromCoordinate(vertex);\n\n    //if the distance is within tolerance, snap to the segment\n    if (coordinateDistance(pixel, vertexPixel) <= this.pixelTolerance_) {\n      //test if we should further snap to a vertex\n      const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n      const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n      const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n      const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n      const dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n      this.snappedToVertex_ = dist <= this.pixelTolerance_;\n      if (this.snappedToVertex_) {\n        vertex = squaredDist1 > squaredDist2 ?\n          closestSegment[1] : closestSegment[0];\n      }\n      return vertex;\n    }\n  }\n  return null;\n};\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent pointer move event\n * @private\n */\nExtentInteraction.prototype.handlePointerMove_ = function(mapBrowserEvent) {\n  const pixel = mapBrowserEvent.pixel;\n  const map = mapBrowserEvent.map;\n\n  let vertex = this.snapToVertex_(pixel, map);\n  if (!vertex) {\n    vertex = map.getCoordinateFromPixel(pixel);\n  }\n  this.createOrUpdatePointerFeature_(vertex);\n};\n\n/**\n * @param {module:ol/extent~Extent} extent extent\n * @returns {module:ol/Feature} extent as featrue\n * @private\n */\nExtentInteraction.prototype.createOrUpdateExtentFeature_ = function(extent) {\n  let extentFeature = this.extentFeature_;\n\n  if (!extentFeature) {\n    if (!extent) {\n      extentFeature = new Feature({});\n    } else {\n      extentFeature = new Feature(polygonFromExtent(extent));\n    }\n    this.extentFeature_ = extentFeature;\n    this.extentOverlay_.getSource().addFeature(extentFeature);\n  } else {\n    if (!extent) {\n      extentFeature.setGeometry(undefined);\n    } else {\n      extentFeature.setGeometry(polygonFromExtent(extent));\n    }\n  }\n  return extentFeature;\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} vertex location of feature\n * @returns {module:ol/Feature} vertex as feature\n * @private\n */\nExtentInteraction.prototype.createOrUpdatePointerFeature_ = function(vertex) {\n  let vertexFeature = this.vertexFeature_;\n  if (!vertexFeature) {\n    vertexFeature = new Feature(new Point(vertex));\n    this.vertexFeature_ = vertexFeature;\n    this.vertexOverlay_.getSource().addFeature(vertexFeature);\n  } else {\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    geometry.setCoordinates(vertex);\n  }\n  return vertexFeature;\n};\n\n\n/**\n * @inheritDoc\n */\nExtentInteraction.prototype.setMap = function(map) {\n  this.extentOverlay_.setMap(map);\n  this.vertexOverlay_.setMap(map);\n  PointerInteraction.prototype.setMap.call(this, map);\n};\n\n/**\n * Returns the current drawn extent in the view projection\n *\n * @return {module:ol/extent~Extent} Drawn extent in the view projection.\n * @api\n */\nExtentInteraction.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n/**\n * Manually sets the drawn extent, using the view projection.\n *\n * @param {module:ol/extent~Extent} extent Extent\n * @api\n */\nExtentInteraction.prototype.setExtent = function(extent) {\n  //Null extent means no bbox\n  this.extent_ = extent ? extent : null;\n  this.createOrUpdateExtentFeature_(extent);\n  this.dispatchEvent(new ExtentInteractionEvent(this.extent_));\n};\n\n\nexport default ExtentInteraction;\n","/**\n * @module ol/interaction/Modify\n */\nimport {getUid, inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {equals} from '../array.js';\nimport {equals as coordinatesEqual, distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, squaredDistanceToSegment, closestOnSegment} from '../coordinate.js';\nimport {listen, unlisten} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {always, primaryAction, altKeyOnly, singleClick} from '../events/condition.js';\nimport {boundingExtent, buffer, createOrUpdateFromCoordinate} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @enum {string}\n */\nconst ModifyEventType = {\n  /**\n   * Triggered upon feature modification start\n   * @event ModifyEvent#modifystart\n   * @api\n   */\n  MODIFYSTART: 'modifystart',\n  /**\n   * Triggered upon feature modification end\n   * @event ModifyEvent#modifyend\n   * @api\n   */\n  MODIFYEND: 'modifyend'\n};\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {Array.<number>} [depth]\n * @property {module:ol/Feature} feature\n * @property {module:ol/geom/SimpleGeometry} geometry\n * @property {number} index\n * @property {Array.<module:ol/extent~Extent>} segment\n * @property {Array.<module:ol/interaction/Modify~SegmentData>} [featureSegments]\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event will be considered to add or move a\n * vertex to the sketch. Default is\n * {@link module:ol/events/condition~primaryAction}.\n * @property {module:ol/events/condition~Condition} [deleteCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. By default,\n * {@link module:ol/events/condition~singleClick} with\n * {@link module:ol/events/condition~altKeyOnly} results in a vertex deletion.\n * @property {module:ol/events/condition~Condition} [insertVertexCondition] A\n * function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether a new vertex can be added to the sketch\n * features. Default is {@link module:ol/events/condition~always}.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the\n * pointer close enough to a segment or vertex for editing.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style used for the features being modified. By default the default edit\n * style is used (see {@link module:ol/style}).\n * @property {module:ol/source/Vector} [source] The vector source with\n * features to modify.  If a vector source is not provided, a feature collection\n * must be provided with the features option.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * The features the interaction works on.  If a feature collection is not\n * provided, a vector source must be provided with the source option.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Modify~Modify} instances are\n * instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {ModifyEventType} type Type.\n * @param {module:ol/Collection.<module:ol/Feature>} features\n * The features modified.\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserPointerEvent\n * Associated {@link module:ol/MapBrowserPointerEvent}.\n */\nexport const ModifyEvent = function(type, features, mapBrowserPointerEvent) {\n\n  Event.call(this, type);\n\n  /**\n   * The features being modified.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @api\n   */\n  this.features = features;\n\n  /**\n   * Associated {@link module:ol/MapBrowserEvent}.\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserPointerEvent;\n};\n\ninherits(ModifyEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for modifying feature geometries.  To modify features that have\n * been added to an existing source, construct the modify interaction with the\n * `source` option.  If you want to modify features in a collection (for example,\n * the collection used by a select interaction), construct the interaction with\n * the `features` option.  The interaction must be constructed with either a\n * `source` or `features` option.\n *\n * By default, the interaction will allow deletion of vertices when the `alt`\n * key is pressed.  To configure the interaction with a different condition\n * for deletion, use the `deleteCondition` option.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/Modify~Options} options Options.\n * @fires module:ol/interaction/Modify~ModifyEvent\n * @api\n */\nconst Modify = function(options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : primaryAction;\n\n\n  /**\n   * @private\n   * @param {module:ol/MapBrowserEvent} mapBrowserEvent Browser event.\n   * @return {boolean} Combined condition result.\n   */\n  this.defaultDeleteCondition_ = function(mapBrowserEvent) {\n    return altKeyOnly(mapBrowserEvent) && singleClick(mapBrowserEvent);\n  };\n\n  /**\n   * @type {module:ol/events/condition~Condition}\n   * @private\n   */\n  this.deleteCondition_ = options.deleteCondition ?\n    options.deleteCondition : this.defaultDeleteCondition_;\n\n  /**\n   * @type {module:ol/events/condition~Condition}\n   * @private\n   */\n  this.insertVertexCondition_ = options.insertVertexCondition ?\n    options.insertVertexCondition : always;\n\n  /**\n   * Editing vertex.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.vertexFeature_ = null;\n\n  /**\n   * Segments intersecting {@link this.vertexFeature_} by segment uid.\n   * @type {Object.<string, boolean>}\n   * @private\n   */\n  this.vertexSegments_ = null;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.lastPixel_ = [0, 0];\n\n  /**\n   * Tracks if the next `singleclick` event should be ignored to prevent\n   * accidental deletion right after vertex creation.\n   * @type {boolean}\n   * @private\n   */\n  this.ignoreNextSingleClick_ = false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.modified_ = false;\n\n  /**\n   * Segment RTree for each layer\n   * @type {module:ol/structs/RBush.<module:ol/interaction/Modify~SegmentData>}\n   * @private\n   */\n  this.rBush_ = new RBush();\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.snappedToVertex_ = false;\n\n  /**\n   * Indicate whether the interaction is currently changing a feature's\n   * coordinates.\n   * @type {boolean}\n   * @private\n   */\n  this.changingFeature_ = false;\n\n  /**\n   * @type {Array}\n   * @private\n   */\n  this.dragSegments_ = [];\n\n  /**\n   * Draw overlay where sketch features are drawn.\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.overlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!options.wrapX\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * @const\n   * @private\n   * @type {!Object.<string, function(module:ol/Feature, module:ol/geom/Geometry)>}\n   */\n  this.SEGMENT_WRITERS_ = {\n    'Point': this.writePointGeometry_,\n    'LineString': this.writeLineStringGeometry_,\n    'LinearRing': this.writeLineStringGeometry_,\n    'Polygon': this.writePolygonGeometry_,\n    'MultiPoint': this.writeMultiPointGeometry_,\n    'MultiLineString': this.writeMultiLineStringGeometry_,\n    'MultiPolygon': this.writeMultiPolygonGeometry_,\n    'Circle': this.writeCircleGeometry_,\n    'GeometryCollection': this.writeGeometryCollectionGeometry_\n  };\n\n\n  /**\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = null;\n\n  let features;\n  if (options.source) {\n    this.source_ = options.source;\n    features = new Collection(this.source_.getFeatures());\n    listen(this.source_, VectorEventType.ADDFEATURE,\n      this.handleSourceAdd_, this);\n    listen(this.source_, VectorEventType.REMOVEFEATURE,\n      this.handleSourceRemove_, this);\n  } else {\n    features = options.features;\n  }\n  if (!features) {\n    throw new Error('The modify interaction requires features or a source');\n  }\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = features;\n\n  this.features_.forEach(this.addFeature_.bind(this));\n  listen(this.features_, CollectionEventType.ADD,\n    this.handleFeatureAdd_, this);\n  listen(this.features_, CollectionEventType.REMOVE,\n    this.handleFeatureRemove_, this);\n\n  /**\n   * @type {module:ol/MapBrowserPointerEvent}\n   * @private\n   */\n  this.lastPointerEvent_ = null;\n\n};\n\ninherits(Modify, PointerInteraction);\n\n\n/**\n * The segment index assigned to a circle's center when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CENTER_INDEX = 0;\n\n/**\n * The segment index assigned to a circle's circumference when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CIRCUMFERENCE_INDEX = 1;\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.addFeature_ = function(feature) {\n  const geometry = feature.getGeometry();\n  if (geometry && geometry.getType() in this.SEGMENT_WRITERS_) {\n    this.SEGMENT_WRITERS_[geometry.getType()].call(this, feature, geometry);\n  }\n  const map = this.getMap();\n  if (map && map.isRendered() && this.getActive()) {\n    this.handlePointerAtPixel_(this.lastPixel_, map);\n  }\n  listen(feature, EventType.CHANGE,\n    this.handleFeatureChange_, this);\n};\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Map browser event\n * @private\n */\nModify.prototype.willModifyFeatures_ = function(evt) {\n  if (!this.modified_) {\n    this.modified_ = true;\n    this.dispatchEvent(new ModifyEvent(\n      ModifyEventType.MODIFYSTART, this.features_, evt));\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.removeFeature_ = function(feature) {\n  this.removeFeatureSegmentData_(feature);\n  // Remove the vertex feature if the collection of canditate features\n  // is empty.\n  if (this.vertexFeature_ && this.features_.getLength() === 0) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n  unlisten(feature, EventType.CHANGE,\n    this.handleFeatureChange_, this);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.removeFeatureSegmentData_ = function(feature) {\n  const rBush = this.rBush_;\n  const /** @type {Array.<module:ol/interaction/Modify~SegmentData>} */ nodesToRemove = [];\n  rBush.forEach(\n    /**\n     * @param {module:ol/interaction/Modify~SegmentData} node RTree node.\n     */\n    function(node) {\n      if (feature === node.feature) {\n        nodesToRemove.push(node);\n      }\n    });\n  for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n    rBush.remove(nodesToRemove[i]);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nModify.prototype.setActive = function(active) {\n  if (this.vertexFeature_ && !active) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n  PointerInteraction.prototype.setActive.call(this, active);\n};\n\n\n/**\n * @inheritDoc\n */\nModify.prototype.setMap = function(map) {\n  this.overlay_.setMap(map);\n  PointerInteraction.prototype.setMap.call(this, map);\n};\n\n\n/**\n * @param {module:ol/source/Vector~VectorSourceEvent} event Event.\n * @private\n */\nModify.prototype.handleSourceAdd_ = function(event) {\n  if (event.feature) {\n    this.features_.push(event.feature);\n  }\n};\n\n\n/**\n * @param {module:ol/source/Vector~VectorSourceEvent} event Event.\n * @private\n */\nModify.prototype.handleSourceRemove_ = function(event) {\n  if (event.feature) {\n    this.features_.remove(event.feature);\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nModify.prototype.handleFeatureAdd_ = function(evt) {\n  this.addFeature_(/** @type {module:ol/Feature} */ (evt.element));\n};\n\n\n/**\n * @param {module:ol/events/Event} evt Event.\n * @private\n */\nModify.prototype.handleFeatureChange_ = function(evt) {\n  if (!this.changingFeature_) {\n    const feature = /** @type {module:ol/Feature} */ (evt.target);\n    this.removeFeature_(feature);\n    this.addFeature_(feature);\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nModify.prototype.handleFeatureRemove_ = function(evt) {\n  const feature = /** @type {module:ol/Feature} */ (evt.element);\n  this.removeFeature_(feature);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Point} geometry Geometry.\n * @private\n */\nModify.prototype.writePointGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    segment: [coordinates, coordinates]\n  });\n  this.rBush_.insert(geometry.getExtent(), segmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiPointGeometry_ = function(feature, geometry) {\n  const points = geometry.getCoordinates();\n  for (let i = 0, ii = points.length; i < ii; ++i) {\n    const coordinates = points[i];\n    const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n      feature: feature,\n      geometry: geometry,\n      depth: [i],\n      index: i,\n      segment: [coordinates, coordinates]\n    });\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @private\n */\nModify.prototype.writeLineStringGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n      feature: feature,\n      geometry: geometry,\n      index: i,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiLineStringGeometry_ = function(feature, geometry) {\n  const lines = geometry.getCoordinates();\n  for (let j = 0, jj = lines.length; j < jj; ++j) {\n    const coordinates = lines[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n        feature: feature,\n        geometry: geometry,\n        depth: [j],\n        index: i,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @private\n */\nModify.prototype.writePolygonGeometry_ = function(feature, geometry) {\n  const rings = geometry.getCoordinates();\n  for (let j = 0, jj = rings.length; j < jj; ++j) {\n    const coordinates = rings[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n        feature: feature,\n        geometry: geometry,\n        depth: [j],\n        index: i,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiPolygonGeometry_ = function(feature, geometry) {\n  const polygons = geometry.getCoordinates();\n  for (let k = 0, kk = polygons.length; k < kk; ++k) {\n    const rings = polygons[k];\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n          feature: feature,\n          geometry: geometry,\n          depth: [j, k],\n          index: i,\n          segment: segment\n        });\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n};\n\n\n/**\n * We convert a circle into two segments.  The segment at index\n * {@link CIRCLE_CENTER_INDEX} is the\n * circle's center (a point).  The segment at index\n * {@link CIRCLE_CIRCUMFERENCE_INDEX} is\n * the circumference, and is not a line segment.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @private\n */\nModify.prototype.writeCircleGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCenter();\n  const centerSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    index: CIRCLE_CENTER_INDEX,\n    segment: [coordinates, coordinates]\n  });\n  const circumferenceSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    index: CIRCLE_CIRCUMFERENCE_INDEX,\n    segment: [coordinates, coordinates]\n  });\n  const featureSegments = [centerSegmentData, circumferenceSegmentData];\n  centerSegmentData.featureSegments = circumferenceSegmentData.featureSegments = featureSegments;\n  this.rBush_.insert(createOrUpdateFromCoordinate(coordinates), centerSegmentData);\n  this.rBush_.insert(geometry.getExtent(), circumferenceSegmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @private\n */\nModify.prototype.writeGeometryCollectionGeometry_ = function(feature, geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0; i < geometries.length; ++i) {\n    this.SEGMENT_WRITERS_[geometries[i].getType()].call(this, feature, geometries[i]);\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinates Coordinates.\n * @return {module:ol/Feature} Vertex feature.\n * @private\n */\nModify.prototype.createOrUpdateVertexFeature_ = function(coordinates) {\n  let vertexFeature = this.vertexFeature_;\n  if (!vertexFeature) {\n    vertexFeature = new Feature(new Point(coordinates));\n    this.vertexFeature_ = vertexFeature;\n    this.overlay_.getSource().addFeature(vertexFeature);\n  } else {\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    geometry.setCoordinates(coordinates);\n  }\n  return vertexFeature;\n};\n\n\n/**\n * @param {module:ol/interaction/Modify~SegmentData} a The first segment data.\n * @param {module:ol/interaction/Modify~SegmentData} b The second segment data.\n * @return {number} The difference in indexes.\n */\nfunction compareIndexes(a, b) {\n  return a.index - b.index;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Modify}\n */\nfunction handleDownEvent(evt) {\n  if (!this.condition_(evt)) {\n    return false;\n  }\n  this.handlePointerAtPixel_(evt.pixel, evt.map);\n  const pixelCoordinate = evt.map.getCoordinateFromPixel(evt.pixel);\n  this.dragSegments_.length = 0;\n  this.modified_ = false;\n  const vertexFeature = this.vertexFeature_;\n  if (vertexFeature) {\n    const insertVertices = [];\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    const vertex = geometry.getCoordinates();\n    const vertexExtent = boundingExtent([vertex]);\n    const segmentDataMatches = this.rBush_.getInExtent(vertexExtent);\n    const componentSegments = {};\n    segmentDataMatches.sort(compareIndexes);\n    for (let i = 0, ii = segmentDataMatches.length; i < ii; ++i) {\n      const segmentDataMatch = segmentDataMatches[i];\n      const segment = segmentDataMatch.segment;\n      let uid = getUid(segmentDataMatch.feature);\n      const depth = segmentDataMatch.depth;\n      if (depth) {\n        uid += '-' + depth.join('-'); // separate feature components\n      }\n      if (!componentSegments[uid]) {\n        componentSegments[uid] = new Array(2);\n      }\n      if (segmentDataMatch.geometry.getType() === GeometryType.CIRCLE &&\n      segmentDataMatch.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n\n        const closestVertex = closestOnSegmentData(pixelCoordinate, segmentDataMatch);\n        if (coordinatesEqual(closestVertex, vertex) && !componentSegments[uid][0]) {\n          this.dragSegments_.push([segmentDataMatch, 0]);\n          componentSegments[uid][0] = segmentDataMatch;\n        }\n      } else if (coordinatesEqual(segment[0], vertex) &&\n          !componentSegments[uid][0]) {\n        this.dragSegments_.push([segmentDataMatch, 0]);\n        componentSegments[uid][0] = segmentDataMatch;\n      } else if (coordinatesEqual(segment[1], vertex) &&\n          !componentSegments[uid][1]) {\n\n        // prevent dragging closed linestrings by the connecting node\n        if ((segmentDataMatch.geometry.getType() ===\n            GeometryType.LINE_STRING ||\n            segmentDataMatch.geometry.getType() ===\n            GeometryType.MULTI_LINE_STRING) &&\n            componentSegments[uid][0] &&\n            componentSegments[uid][0].index === 0) {\n          continue;\n        }\n\n        this.dragSegments_.push([segmentDataMatch, 1]);\n        componentSegments[uid][1] = segmentDataMatch;\n      } else if (this.insertVertexCondition_(evt) && getUid(segment) in this.vertexSegments_ &&\n          (!componentSegments[uid][0] && !componentSegments[uid][1])) {\n        insertVertices.push([segmentDataMatch, vertex]);\n      }\n    }\n    if (insertVertices.length) {\n      this.willModifyFeatures_(evt);\n    }\n    for (let j = insertVertices.length - 1; j >= 0; --j) {\n      this.insertVertex_.apply(this, insertVertices[j]);\n    }\n  }\n  return !!this.vertexFeature_;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @this {module:ol/interaction/Modify}\n */\nfunction handleDragEvent(evt) {\n  this.ignoreNextSingleClick_ = false;\n  this.willModifyFeatures_(evt);\n\n  const vertex = evt.coordinate;\n  for (let i = 0, ii = this.dragSegments_.length; i < ii; ++i) {\n    const dragSegment = this.dragSegments_[i];\n    const segmentData = dragSegment[0];\n    const depth = segmentData.depth;\n    const geometry = segmentData.geometry;\n    let coordinates;\n    const segment = segmentData.segment;\n    const index = dragSegment[1];\n\n    while (vertex.length < geometry.getStride()) {\n      vertex.push(segment[index][vertex.length]);\n    }\n\n    switch (geometry.getType()) {\n      case GeometryType.POINT:\n        coordinates = vertex;\n        segment[0] = segment[1] = vertex;\n        break;\n      case GeometryType.MULTI_POINT:\n        coordinates = geometry.getCoordinates();\n        coordinates[segmentData.index] = vertex;\n        segment[0] = segment[1] = vertex;\n        break;\n      case GeometryType.LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates[segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.MULTI_POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[1]][depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.CIRCLE:\n        segment[0] = segment[1] = vertex;\n        if (segmentData.index === CIRCLE_CENTER_INDEX) {\n          this.changingFeature_ = true;\n          geometry.setCenter(vertex);\n          this.changingFeature_ = false;\n        } else { // We're dragging the circle's circumference:\n          this.changingFeature_ = true;\n          geometry.setRadius(coordinateDistance(geometry.getCenter(), vertex));\n          this.changingFeature_ = false;\n        }\n        break;\n      default:\n        // pass\n    }\n\n    if (coordinates) {\n      this.setGeometryCoordinates_(geometry, coordinates);\n    }\n  }\n  this.createOrUpdateVertexFeature_(vertex);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Modify}\n */\nfunction handleUpEvent(evt) {\n  for (let i = this.dragSegments_.length - 1; i >= 0; --i) {\n    const segmentData = this.dragSegments_[i][0];\n    const geometry = segmentData.geometry;\n    if (geometry.getType() === GeometryType.CIRCLE) {\n      // Update a circle object in the R* bush:\n      const coordinates = geometry.getCenter();\n      const centerSegmentData = segmentData.featureSegments[0];\n      const circumferenceSegmentData = segmentData.featureSegments[1];\n      centerSegmentData.segment[0] = centerSegmentData.segment[1] = coordinates;\n      circumferenceSegmentData.segment[0] = circumferenceSegmentData.segment[1] = coordinates;\n      this.rBush_.update(createOrUpdateFromCoordinate(coordinates), centerSegmentData);\n      this.rBush_.update(geometry.getExtent(), circumferenceSegmentData);\n    } else {\n      this.rBush_.update(boundingExtent(segmentData.segment), segmentData);\n    }\n  }\n  if (this.modified_) {\n    this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n    this.modified_ = false;\n  }\n  return false;\n}\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may modify the\n * geometry.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Modify}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n  this.lastPointerEvent_ = mapBrowserEvent;\n\n  let handled;\n  if (!mapBrowserEvent.map.getView().getInteracting() &&\n      mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE &&\n      !this.handlingDownUpSequence) {\n    this.handlePointerMove_(mapBrowserEvent);\n  }\n  if (this.vertexFeature_ && this.deleteCondition_(mapBrowserEvent)) {\n    if (mapBrowserEvent.type != MapBrowserEventType.SINGLECLICK || !this.ignoreNextSingleClick_) {\n      handled = this.removePoint();\n    } else {\n      handled = true;\n    }\n  }\n\n  if (mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK) {\n    this.ignoreNextSingleClick_ = false;\n  }\n\n  return handlePointerEvent.call(this, mapBrowserEvent) && !handled;\n}\n\n\n/**\n * @param {module:ol/MapBrowserEvent} evt Event.\n * @private\n */\nModify.prototype.handlePointerMove_ = function(evt) {\n  this.lastPixel_ = evt.pixel;\n  this.handlePointerAtPixel_(evt.pixel, evt.map);\n};\n\n\n/**\n * @param {module:ol~Pixel} pixel Pixel\n * @param {module:ol/PluggableMap} map Map.\n * @private\n */\nModify.prototype.handlePointerAtPixel_ = function(pixel, map) {\n  const pixelCoordinate = map.getCoordinateFromPixel(pixel);\n  const sortByDistance = function(a, b) {\n    return pointDistanceToSegmentDataSquared(pixelCoordinate, a) -\n        pointDistanceToSegmentDataSquared(pixelCoordinate, b);\n  };\n\n  const box = buffer(createOrUpdateFromCoordinate(pixelCoordinate),\n    map.getView().getResolution() * this.pixelTolerance_);\n\n  const rBush = this.rBush_;\n  const nodes = rBush.getInExtent(box);\n  if (nodes.length > 0) {\n    nodes.sort(sortByDistance);\n    const node = nodes[0];\n    const closestSegment = node.segment;\n    let vertex = closestOnSegmentData(pixelCoordinate, node);\n    const vertexPixel = map.getPixelFromCoordinate(vertex);\n    let dist = coordinateDistance(pixel, vertexPixel);\n    if (dist <= this.pixelTolerance_) {\n      const vertexSegments = {};\n\n      if (node.geometry.getType() === GeometryType.CIRCLE &&\n      node.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n\n        this.snappedToVertex_ = true;\n        this.createOrUpdateVertexFeature_(vertex);\n      } else {\n        const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n        const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n        const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n        const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n        dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n        this.snappedToVertex_ = dist <= this.pixelTolerance_;\n        if (this.snappedToVertex_) {\n          vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n        }\n        this.createOrUpdateVertexFeature_(vertex);\n        for (let i = 1, ii = nodes.length; i < ii; ++i) {\n          const segment = nodes[i].segment;\n          if ((coordinatesEqual(closestSegment[0], segment[0]) &&\n              coordinatesEqual(closestSegment[1], segment[1]) ||\n              (coordinatesEqual(closestSegment[0], segment[1]) &&\n              coordinatesEqual(closestSegment[1], segment[0])))) {\n            vertexSegments[getUid(segment)] = true;\n          } else {\n            break;\n          }\n        }\n      }\n\n      vertexSegments[getUid(closestSegment)] = true;\n      this.vertexSegments_ = vertexSegments;\n      return;\n    }\n  }\n  if (this.vertexFeature_) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n};\n\n\n/**\n * Returns the distance from a point to a line segment.\n *\n * @param {module:ol/coordinate~Coordinate} pointCoordinates The coordinates of the point from\n *        which to calculate the distance.\n * @param {module:ol/interaction/Modify~SegmentData} segmentData The object describing the line\n *        segment we are calculating the distance to.\n * @return {number} The square of the distance between a point and a line segment.\n */\nfunction pointDistanceToSegmentDataSquared(pointCoordinates, segmentData) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE) {\n    const circleGeometry = /** @type {module:ol/geom/Circle} */ (geometry);\n\n    if (segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n      const distanceToCenterSquared =\n            squaredCoordinateDistance(circleGeometry.getCenter(), pointCoordinates);\n      const distanceToCircumference =\n            Math.sqrt(distanceToCenterSquared) - circleGeometry.getRadius();\n      return distanceToCircumference * distanceToCircumference;\n    }\n  }\n  return squaredDistanceToSegment(pointCoordinates, segmentData.segment);\n}\n\n/**\n * Returns the point closest to a given line segment.\n *\n * @param {module:ol/coordinate~Coordinate} pointCoordinates The point to which a closest point\n *        should be found.\n * @param {module:ol/interaction/Modify~SegmentData} segmentData The object describing the line\n *        segment which should contain the closest point.\n * @return {module:ol/coordinate~Coordinate} The point closest to the specified line segment.\n */\nfunction closestOnSegmentData(pointCoordinates, segmentData) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE &&\n  segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n    return geometry.getClosestPoint(pointCoordinates);\n  }\n  return closestOnSegment(pointCoordinates, segmentData.segment);\n}\n\n\n/**\n * @param {module:ol/interaction/Modify~SegmentData} segmentData Segment data.\n * @param {module:ol/coordinate~Coordinate} vertex Vertex.\n * @private\n */\nModify.prototype.insertVertex_ = function(segmentData, vertex) {\n  const segment = segmentData.segment;\n  const feature = segmentData.feature;\n  const geometry = segmentData.geometry;\n  const depth = segmentData.depth;\n  const index = /** @type {number} */ (segmentData.index);\n  let coordinates;\n\n  while (vertex.length < geometry.getStride()) {\n    vertex.push(0);\n  }\n\n  switch (geometry.getType()) {\n    case GeometryType.MULTI_LINE_STRING:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.POLYGON:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.MULTI_POLYGON:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[1]][depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.LINE_STRING:\n      coordinates = geometry.getCoordinates();\n      coordinates.splice(index + 1, 0, vertex);\n      break;\n    default:\n      return;\n  }\n\n  this.setGeometryCoordinates_(geometry, coordinates);\n  const rTree = this.rBush_;\n  rTree.remove(segmentData);\n  this.updateSegmentIndices_(geometry, index, depth, 1);\n  const newSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    segment: [segment[0], vertex],\n    feature: feature,\n    geometry: geometry,\n    depth: depth,\n    index: index\n  });\n  rTree.insert(boundingExtent(newSegmentData.segment),\n    newSegmentData);\n  this.dragSegments_.push([newSegmentData, 1]);\n\n  const newSegmentData2 = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    segment: [vertex, segment[1]],\n    feature: feature,\n    geometry: geometry,\n    depth: depth,\n    index: index + 1\n  });\n  rTree.insert(boundingExtent(newSegmentData2.segment), newSegmentData2);\n  this.dragSegments_.push([newSegmentData2, 0]);\n  this.ignoreNextSingleClick_ = true;\n};\n\n/**\n * Removes the vertex currently being pointed.\n * @return {boolean} True when a vertex was removed.\n * @api\n */\nModify.prototype.removePoint = function() {\n  if (this.lastPointerEvent_ && this.lastPointerEvent_.type != MapBrowserEventType.POINTERDRAG) {\n    const evt = this.lastPointerEvent_;\n    this.willModifyFeatures_(evt);\n    this.removeVertex_();\n    this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n    this.modified_ = false;\n    return true;\n  }\n  return false;\n};\n\n/**\n * Removes a vertex from all matching features.\n * @return {boolean} True when a vertex was removed.\n * @private\n */\nModify.prototype.removeVertex_ = function() {\n  const dragSegments = this.dragSegments_;\n  const segmentsByFeature = {};\n  let deleted = false;\n  let component, coordinates, dragSegment, geometry, i, index, left;\n  let newIndex, right, segmentData, uid;\n  for (i = dragSegments.length - 1; i >= 0; --i) {\n    dragSegment = dragSegments[i];\n    segmentData = dragSegment[0];\n    uid = getUid(segmentData.feature);\n    if (segmentData.depth) {\n      // separate feature components\n      uid += '-' + segmentData.depth.join('-');\n    }\n    if (!(uid in segmentsByFeature)) {\n      segmentsByFeature[uid] = {};\n    }\n    if (dragSegment[1] === 0) {\n      segmentsByFeature[uid].right = segmentData;\n      segmentsByFeature[uid].index = segmentData.index;\n    } else if (dragSegment[1] == 1) {\n      segmentsByFeature[uid].left = segmentData;\n      segmentsByFeature[uid].index = segmentData.index + 1;\n    }\n\n  }\n  for (uid in segmentsByFeature) {\n    right = segmentsByFeature[uid].right;\n    left = segmentsByFeature[uid].left;\n    index = segmentsByFeature[uid].index;\n    newIndex = index - 1;\n    if (left !== undefined) {\n      segmentData = left;\n    } else {\n      segmentData = right;\n    }\n    if (newIndex < 0) {\n      newIndex = 0;\n    }\n    geometry = segmentData.geometry;\n    coordinates = geometry.getCoordinates();\n    component = coordinates;\n    deleted = false;\n    switch (geometry.getType()) {\n      case GeometryType.MULTI_LINE_STRING:\n        if (coordinates[segmentData.depth[0]].length > 2) {\n          coordinates[segmentData.depth[0]].splice(index, 1);\n          deleted = true;\n        }\n        break;\n      case GeometryType.LINE_STRING:\n        if (coordinates.length > 2) {\n          coordinates.splice(index, 1);\n          deleted = true;\n        }\n        break;\n      case GeometryType.MULTI_POLYGON:\n        component = component[segmentData.depth[1]];\n        /* falls through */\n      case GeometryType.POLYGON:\n        component = component[segmentData.depth[0]];\n        if (component.length > 4) {\n          if (index == component.length - 1) {\n            index = 0;\n          }\n          component.splice(index, 1);\n          deleted = true;\n          if (index === 0) {\n            // close the ring again\n            component.pop();\n            component.push(component[0]);\n            newIndex = component.length - 1;\n          }\n        }\n        break;\n      default:\n        // pass\n    }\n\n    if (deleted) {\n      this.setGeometryCoordinates_(geometry, coordinates);\n      const segments = [];\n      if (left !== undefined) {\n        this.rBush_.remove(left);\n        segments.push(left.segment[0]);\n      }\n      if (right !== undefined) {\n        this.rBush_.remove(right);\n        segments.push(right.segment[1]);\n      }\n      if (left !== undefined && right !== undefined) {\n        const newSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n          depth: segmentData.depth,\n          feature: segmentData.feature,\n          geometry: segmentData.geometry,\n          index: newIndex,\n          segment: segments\n        });\n        this.rBush_.insert(boundingExtent(newSegmentData.segment),\n          newSegmentData);\n      }\n      this.updateSegmentIndices_(geometry, index, segmentData.depth, -1);\n      if (this.vertexFeature_) {\n        this.overlay_.getSource().removeFeature(this.vertexFeature_);\n        this.vertexFeature_ = null;\n      }\n      dragSegments.length = 0;\n    }\n\n  }\n  return deleted;\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {Array} coordinates Coordinates.\n * @private\n */\nModify.prototype.setGeometryCoordinates_ = function(geometry, coordinates) {\n  this.changingFeature_ = true;\n  geometry.setCoordinates(coordinates);\n  this.changingFeature_ = false;\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {number} index Index.\n * @param {Array.<number>|undefined} depth Depth.\n * @param {number} delta Delta (1 or -1).\n * @private\n */\nModify.prototype.updateSegmentIndices_ = function(\n  geometry, index, depth, delta) {\n  this.rBush_.forEachInExtent(geometry.getExtent(), function(segmentDataMatch) {\n    if (segmentDataMatch.geometry === geometry &&\n        (depth === undefined || segmentDataMatch.depth === undefined ||\n        equals(segmentDataMatch.depth, depth)) &&\n        segmentDataMatch.index > index) {\n      segmentDataMatch.index += delta;\n    }\n  });\n};\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POINT];\n  };\n}\n\n\nexport default Modify;\n","/**\n * @module ol/interaction/Select\n */\nimport {getUid, inherits} from '../index.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {extend, includes} from '../array.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {singleClick, never, shiftKeyOnly, pointerMove} from '../events/condition.js';\nimport {TRUE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Interaction from '../interaction/Interaction.js';\nimport VectorLayer from '../layer/Vector.js';\nimport {clear} from '../obj.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @enum {string}\n */\nconst SelectEventType = {\n  /**\n   * Triggered when feature(s) has been (de)selected.\n   * @event SelectEvent#select\n   * @api\n   */\n  SELECT: 'select'\n};\n\n\n/**\n * A function that takes an {@link module:ol/Feature} or\n * {@link module:ol/render/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @typedef {function((module:ol/Feature|module:ol/render/Feature), module:ol/layer/Layer):\n *     boolean} FilterFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [addCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is the event\n * for the selected features as a whole. By default, this is\n * {@link module:ol/events/condition~singleClick}. Clicking on a feature selects that\n * feature and removes any that were in the selection. Clicking outside any\n * feature removes all from the selection.\n * See `toggle`, `add`, `remove` options for adding/removing extra features to/\n * from the selection.\n * @property {Array.<module:ol/layer/Layer>|function(module:ol/layer/Layer): boolean} [layers]\n * A list of layers from which features should be selected. Alternatively, a\n * filter function can be provided. The function will be called for each layer\n * in the map and should return `true` for layers that you want to be\n * selectable. If the option is absent, all visible layers will be considered\n * selectable.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style for the selected features. By default the default edit style is used\n * (see {@link module:ol/style}).\n * @property {module:ol/events/condition~Condition} [removeCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {module:ol/events/condition~Condition} [toggleCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is in addition\n * to the `condition` event. By default,\n * {@link module:ol/events/condition~shiftKeyOnly}, i.e. pressing `shift` as\n * well as the `condition` event, adds that feature to the current selection if\n * it is not currently selected, and removes it if it is. See `add` and `remove`\n * if you want to use different events instead of a toggle.\n * @property {boolean} [multi=false] A boolean that determines if the default\n * behaviour should select only single features or all (overlapping) features at\n * the clicked map position. The default of `false` means single select.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * Collection where the interaction will place selected features. Optional. If\n * not set the interaction will create a collection. In any case the collection\n * used by the interaction is returned by\n * {@link module:ol/interaction/Select~Select#getFeatures}.\n * @property {module:ol/interaction/Select~FilterFunction} [filter] A function\n * that takes an {@link module:ol/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @property {boolean} [wrapX=true] Wrap the world horizontally on the selection\n * overlay.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside\n * the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Select~Select} instances are instances of\n * this type.\n *\n * @param {SelectEventType} type The event type.\n * @param {Array.<module:ol/Feature>} selected Selected features.\n * @param {Array.<module:ol/Feature>} deselected Deselected features.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Associated\n *     {@link module:ol/MapBrowserEvent}.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst SelectEvent = function(type, selected, deselected, mapBrowserEvent) {\n  Event.call(this, type);\n\n  /**\n   * Selected features array.\n   * @type {Array.<module:ol/Feature>}\n   * @api\n   */\n  this.selected = selected;\n\n  /**\n   * Deselected features array.\n   * @type {Array.<module:ol/Feature>}\n   * @api\n   */\n  this.deselected = deselected;\n\n  /**\n   * Associated {@link module:ol/MapBrowserEvent}.\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserEvent;\n};\n\ninherits(SelectEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for selecting vector features. By default, selected features are\n * styled differently, so this interaction can be used for visual highlighting,\n * as well as selecting features for other actions, such as modification or\n * output. There are three ways of controlling which features are selected:\n * using the browser event as defined by the `condition` and optionally the\n * `toggle`, `add`/`remove`, and `multi` options; a `layers` filter; and a\n * further feature filter using the `filter` option.\n *\n * Selected features are added to an internal unmanaged layer.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/Select~Options=} opt_options Options.\n * @fires SelectEvent\n * @api\n */\nconst Select = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : singleClick;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.addCondition_ = options.addCondition ? options.addCondition : never;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.removeCondition_ = options.removeCondition ? options.removeCondition : never;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.toggleCondition_ = options.toggleCondition ? options.toggleCondition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.multi_ = options.multi ? options.multi : false;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/Select~FilterFunction}\n   */\n  this.filter_ = options.filter ? options.filter : TRUE;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n  const featureOverlay = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      features: options.features,\n      wrapX: options.wrapX\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/layer/Vector}\n   */\n  this.featureOverlay_ = featureOverlay;\n\n  /** @type {function(module:ol/layer/Layer): boolean} */\n  let layerFilter;\n  if (options.layers) {\n    if (typeof options.layers === 'function') {\n      layerFilter = options.layers;\n    } else {\n      const layers = options.layers;\n      layerFilter = function(layer) {\n        return includes(layers, layer);\n      };\n    }\n  } else {\n    layerFilter = TRUE;\n  }\n\n  /**\n   * @private\n   * @type {function(module:ol/layer/Layer): boolean}\n   */\n  this.layerFilter_ = layerFilter;\n\n  /**\n   * An association between selected feature (key)\n   * and layer (value)\n   * @private\n   * @type {Object.<number, module:ol/layer/Layer>}\n   */\n  this.featureLayerAssociation_ = {};\n\n  const features = this.featureOverlay_.getSource().getFeaturesCollection();\n  listen(features, CollectionEventType.ADD,\n    this.addFeature_, this);\n  listen(features, CollectionEventType.REMOVE,\n    this.removeFeature_, this);\n\n};\n\ninherits(Select, Interaction);\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/layer/Layer} layer Layer.\n * @private\n */\nSelect.prototype.addFeatureLayerAssociation_ = function(feature, layer) {\n  const key = getUid(feature);\n  this.featureLayerAssociation_[key] = layer;\n};\n\n\n/**\n * Get the selected features.\n * @return {module:ol/Collection.<module:ol/Feature>} Features collection.\n * @api\n */\nSelect.prototype.getFeatures = function() {\n  return this.featureOverlay_.getSource().getFeaturesCollection();\n};\n\n\n/**\n * Returns the Hit-detection tolerance.\n * @returns {number} Hit tolerance in pixels.\n * @api\n */\nSelect.prototype.getHitTolerance = function() {\n  return this.hitTolerance_;\n};\n\n\n/**\n * Returns the associated {@link module:ol/layer/Vector~Vector vectorlayer} of\n * the (last) selected feature. Note that this will not work with any\n * programmatic method like pushing features to\n * {@link module:ol/interaction/Select~Select#getFeatures collection}.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature\n * @return {module:ol/layer/Vector} Layer.\n * @api\n */\nSelect.prototype.getLayer = function(feature) {\n  const key = getUid(feature);\n  return (\n    /** @type {module:ol/layer/Vector} */ (this.featureLayerAssociation_[key])\n  );\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may change the\n * selected state of features.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Select}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!this.condition_(mapBrowserEvent)) {\n    return true;\n  }\n  const add = this.addCondition_(mapBrowserEvent);\n  const remove = this.removeCondition_(mapBrowserEvent);\n  const toggle = this.toggleCondition_(mapBrowserEvent);\n  const set = !add && !remove && !toggle;\n  const map = mapBrowserEvent.map;\n  const features = this.featureOverlay_.getSource().getFeaturesCollection();\n  const deselected = [];\n  const selected = [];\n  if (set) {\n    // Replace the currently selected feature(s) with the feature(s) at the\n    // pixel, or clear the selected feature(s) if there is no feature at\n    // the pixel.\n    clear(this.featureLayerAssociation_);\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @param {module:ol/layer/Layer} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            selected.push(feature);\n            this.addFeatureLayerAssociation_(feature, layer);\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let i = features.getLength() - 1; i >= 0; --i) {\n      const feature = features.item(i);\n      const index = selected.indexOf(feature);\n      if (index > -1) {\n        // feature is already selected\n        selected.splice(index, 1);\n      } else {\n        features.remove(feature);\n        deselected.push(feature);\n      }\n    }\n    if (selected.length !== 0) {\n      features.extend(selected);\n    }\n  } else {\n    // Modify the currently selected feature(s).\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @param {module:ol/layer/Layer} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            if ((add || toggle) && !includes(features.getArray(), feature)) {\n              selected.push(feature);\n              this.addFeatureLayerAssociation_(feature, layer);\n            } else if ((remove || toggle) && includes(features.getArray(), feature)) {\n              deselected.push(feature);\n              this.removeFeatureLayerAssociation_(feature);\n            }\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let j = deselected.length - 1; j >= 0; --j) {\n      features.remove(deselected[j]);\n    }\n    features.extend(selected);\n  }\n  if (selected.length > 0 || deselected.length > 0) {\n    this.dispatchEvent(\n      new SelectEvent(SelectEventType.SELECT,\n        selected, deselected, mapBrowserEvent));\n  }\n  return pointerMove(mapBrowserEvent);\n}\n\n\n/**\n * Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @api\n */\nSelect.prototype.setHitTolerance = function(hitTolerance) {\n  this.hitTolerance_ = hitTolerance;\n};\n\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {module:ol/PluggableMap} map Map.\n * @override\n * @api\n */\nSelect.prototype.setMap = function(map) {\n  const currentMap = this.getMap();\n  const selectedFeatures =\n      this.featureOverlay_.getSource().getFeaturesCollection();\n  if (currentMap) {\n    selectedFeatures.forEach(currentMap.unskipFeature.bind(currentMap));\n  }\n  Interaction.prototype.setMap.call(this, map);\n  this.featureOverlay_.setMap(map);\n  if (map) {\n    selectedFeatures.forEach(map.skipFeature.bind(map));\n  }\n};\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  extend(styles[GeometryType.POLYGON], styles[GeometryType.LINE_STRING]);\n  extend(styles[GeometryType.GEOMETRY_COLLECTION], styles[GeometryType.LINE_STRING]);\n\n  return function(feature, resolution) {\n    if (!feature.getGeometry()) {\n      return null;\n    }\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSelect.prototype.addFeature_ = function(evt) {\n  const map = this.getMap();\n  if (map) {\n    map.skipFeature(/** @type {module:ol/Feature} */ (evt.element));\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSelect.prototype.removeFeature_ = function(evt) {\n  const map = this.getMap();\n  if (map) {\n    map.unskipFeature(/** @type {module:ol/Feature} */ (evt.element));\n  }\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @private\n */\nSelect.prototype.removeFeatureLayerAssociation_ = function(feature) {\n  const key = getUid(feature);\n  delete this.featureLayerAssociation_[key];\n};\n\n\nexport default Select;\n","/**\n * @module ol/interaction/Snap\n */\nimport {getUid, inherits} from '../index.js';\nimport {CollectionEvent} from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, closestOnCircle, closestOnSegment, squaredDistanceToSegment} from '../coordinate.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {boundingExtent, createEmpty} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {fromCircle} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport {getValues} from '../obj.js';\nimport {VectorSourceEvent} from '../source/Vector.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\n\n\n/**\n * @typedef {Object} Result\n * @property {boolean} snapped\n * @property {module:ol/coordinate~Coordinate|null} vertex\n * @property {module:ol~Pixel|null} vertexPixel\n */\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {module:ol/Feature} feature\n * @property {Array.<module:ol/coordinate~Coordinate>} segment\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/Collection.<module:ol/Feature>} [features] Snap to these features. Either this option or source should be provided.\n * @property {boolean} [edge=true] Snap to edges.\n * @property {boolean} [vertex=true] Snap to vertices.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the pointer close enough to a segment or\n * vertex for snapping.\n * @property {module:ol/source/Vector} [source] Snap to features from this source. Either this option or features should be provided\n */\n\n\n/**\n * @classdesc\n * Handles snapping of vector features while modifying or drawing them.  The\n * features can come from a {@link module:ol/source/Vector} or {@link module:ol/Collection~Collection}\n * Any interaction object that allows the user to interact\n * with the features using the mouse can benefit from the snapping, as long\n * as it is added before.\n *\n * The snap interaction modifies map browser event `coordinate` and `pixel`\n * properties to force the snap to occur to any interaction that them.\n *\n * Example:\n *\n *     import Snap from 'ol/interaction/Snap';\n *\n *     var snap = new Snap({\n *       source: source\n *     });\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/Snap~Options=} opt_options Options.\n * @api\n */\nconst Snap = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleEvent: handleEvent,\n    handleDownEvent: TRUE,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = options.source ? options.source : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.vertex_ = options.vertex !== undefined ? options.vertex : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.edge_ = options.edge !== undefined ? options.edge : true;\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features ? options.features : null;\n\n  /**\n   * @type {Array.<module:ol/events~EventsKey>}\n   * @private\n   */\n  this.featuresListenerKeys_ = [];\n\n  /**\n   * @type {Object.<number, module:ol/events~EventsKey>}\n   * @private\n   */\n  this.featureChangeListenerKeys_ = {};\n\n  /**\n   * Extents are preserved so indexed segment can be quickly removed\n   * when its feature geometry changes\n   * @type {Object.<number, module:ol/extent~Extent>}\n   * @private\n   */\n  this.indexedFeaturesExtents_ = {};\n\n  /**\n   * If a feature geometry changes while a pointer drag|move event occurs, the\n   * feature doesn't get updated right away.  It will be at the next 'pointerup'\n   * event fired.\n   * @type {!Object.<number, module:ol/Feature>}\n   * @private\n   */\n  this.pendingFeatures_ = {};\n\n  /**\n   * Used for distance sorting in sortByDistance_\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.pixelCoordinate_ = null;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * @type {function(module:ol/interaction/Snap~SegmentData, module:ol/interaction/Snap~SegmentData): number}\n   * @private\n   */\n  this.sortByDistance_ = sortByDistance.bind(this);\n\n\n  /**\n  * Segment RTree for each layer\n  * @type {module:ol/structs/RBush.<module:ol/interaction/Snap~SegmentData>}\n  * @private\n  */\n  this.rBush_ = new RBush();\n\n\n  /**\n  * @const\n  * @private\n  * @type {Object.<string, function(module:ol/Feature, module:ol/geom/Geometry)>}\n  */\n  this.SEGMENT_WRITERS_ = {\n    'Point': this.writePointGeometry_,\n    'LineString': this.writeLineStringGeometry_,\n    'LinearRing': this.writeLineStringGeometry_,\n    'Polygon': this.writePolygonGeometry_,\n    'MultiPoint': this.writeMultiPointGeometry_,\n    'MultiLineString': this.writeMultiLineStringGeometry_,\n    'MultiPolygon': this.writeMultiPolygonGeometry_,\n    'GeometryCollection': this.writeGeometryCollectionGeometry_,\n    'Circle': this.writeCircleGeometry_\n  };\n};\n\ninherits(Snap, PointerInteraction);\n\n\n/**\n * Add a feature to the collection of features that we may snap to.\n * @param {module:ol/Feature} feature Feature.\n * @param {boolean=} opt_listen Whether to listen to the feature change or not\n *     Defaults to `true`.\n * @api\n */\nSnap.prototype.addFeature = function(feature, opt_listen) {\n  const register = opt_listen !== undefined ? opt_listen : true;\n  const feature_uid = getUid(feature);\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    const segmentWriter = this.SEGMENT_WRITERS_[geometry.getType()];\n    if (segmentWriter) {\n      this.indexedFeaturesExtents_[feature_uid] = geometry.getExtent(createEmpty());\n      segmentWriter.call(this, feature, geometry);\n    }\n  }\n\n  if (register) {\n    this.featureChangeListenerKeys_[feature_uid] = listen(\n      feature,\n      EventType.CHANGE,\n      this.handleFeatureChange_, this);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nSnap.prototype.forEachFeatureAdd_ = function(feature) {\n  this.addFeature(feature);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nSnap.prototype.forEachFeatureRemove_ = function(feature) {\n  this.removeFeature(feature);\n};\n\n\n/**\n * @return {module:ol/Collection.<module:ol/Feature>|Array.<module:ol/Feature>} Features.\n * @private\n */\nSnap.prototype.getFeatures_ = function() {\n  let features;\n  if (this.features_) {\n    features = this.features_;\n  } else if (this.source_) {\n    features = this.source_.getFeatures();\n  }\n  return (\n    /** @type {!Array.<module:ol/Feature>|!module:ol/Collection.<module:ol/Feature>} */ (features)\n  );\n};\n\n\n/**\n * @param {module:ol/source/Vector|module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureAdd_ = function(evt) {\n  let feature;\n  if (evt instanceof VectorSourceEvent) {\n    feature = evt.feature;\n  } else if (evt instanceof CollectionEvent) {\n    feature = evt.element;\n  }\n  this.addFeature(/** @type {module:ol/Feature} */ (feature));\n};\n\n\n/**\n * @param {module:ol/source/Vector|module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureRemove_ = function(evt) {\n  let feature;\n  if (evt instanceof VectorSourceEvent) {\n    feature = evt.feature;\n  } else if (evt instanceof CollectionEvent) {\n    feature = evt.element;\n  }\n  this.removeFeature(/** @type {module:ol/Feature} */ (feature));\n};\n\n\n/**\n * @param {module:ol/events/Event} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureChange_ = function(evt) {\n  const feature = /** @type {module:ol/Feature} */ (evt.target);\n  if (this.handlingDownUpSequence) {\n    const uid = getUid(feature);\n    if (!(uid in this.pendingFeatures_)) {\n      this.pendingFeatures_[uid] = feature;\n    }\n  } else {\n    this.updateFeature_(feature);\n  }\n};\n\n\n/**\n * Remove a feature from the collection of features that we may snap to.\n * @param {module:ol/Feature} feature Feature\n * @param {boolean=} opt_unlisten Whether to unlisten to the feature change\n *     or not. Defaults to `true`.\n * @api\n */\nSnap.prototype.removeFeature = function(feature, opt_unlisten) {\n  const unregister = opt_unlisten !== undefined ? opt_unlisten : true;\n  const feature_uid = getUid(feature);\n  const extent = this.indexedFeaturesExtents_[feature_uid];\n  if (extent) {\n    const rBush = this.rBush_;\n    const nodesToRemove = [];\n    rBush.forEachInExtent(extent, function(node) {\n      if (feature === node.feature) {\n        nodesToRemove.push(node);\n      }\n    });\n    for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n      rBush.remove(nodesToRemove[i]);\n    }\n  }\n\n  if (unregister) {\n    unlistenByKey(this.featureChangeListenerKeys_[feature_uid]);\n    delete this.featureChangeListenerKeys_[feature_uid];\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nSnap.prototype.setMap = function(map) {\n  const currentMap = this.getMap();\n  const keys = this.featuresListenerKeys_;\n  const features = this.getFeatures_();\n\n  if (currentMap) {\n    keys.forEach(unlistenByKey);\n    keys.length = 0;\n    features.forEach(this.forEachFeatureRemove_.bind(this));\n  }\n  PointerInteraction.prototype.setMap.call(this, map);\n\n  if (map) {\n    if (this.features_) {\n      keys.push(\n        listen(this.features_, CollectionEventType.ADD,\n          this.handleFeatureAdd_, this),\n        listen(this.features_, CollectionEventType.REMOVE,\n          this.handleFeatureRemove_, this)\n      );\n    } else if (this.source_) {\n      keys.push(\n        listen(this.source_, VectorEventType.ADDFEATURE,\n          this.handleFeatureAdd_, this),\n        listen(this.source_, VectorEventType.REMOVEFEATURE,\n          this.handleFeatureRemove_, this)\n      );\n    }\n    features.forEach(this.forEachFeatureAdd_.bind(this));\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nSnap.prototype.shouldStopEvent = FALSE;\n\n\n/**\n * @param {module:ol~Pixel} pixel Pixel\n * @param {module:ol/coordinate~Coordinate} pixelCoordinate Coordinate\n * @param {module:ol/PluggableMap} map Map.\n * @return {module:ol/interaction/Snap~Result} Snap result\n */\nSnap.prototype.snapTo = function(pixel, pixelCoordinate, map) {\n\n  const lowerLeft = map.getCoordinateFromPixel(\n    [pixel[0] - this.pixelTolerance_, pixel[1] + this.pixelTolerance_]);\n  const upperRight = map.getCoordinateFromPixel(\n    [pixel[0] + this.pixelTolerance_, pixel[1] - this.pixelTolerance_]);\n  const box = boundingExtent([lowerLeft, upperRight]);\n\n  let segments = this.rBush_.getInExtent(box);\n\n  // If snapping on vertices only, don't consider circles\n  if (this.vertex_ && !this.edge_) {\n    segments = segments.filter(function(segment) {\n      return segment.feature.getGeometry().getType() !==\n          GeometryType.CIRCLE;\n    });\n  }\n\n  let snappedToVertex = false;\n  let snapped = false;\n  let vertex = null;\n  let vertexPixel = null;\n  let dist, pixel1, pixel2, squaredDist1, squaredDist2;\n  if (segments.length > 0) {\n    this.pixelCoordinate_ = pixelCoordinate;\n    segments.sort(this.sortByDistance_);\n    const closestSegment = segments[0].segment;\n    const isCircle = segments[0].feature.getGeometry().getType() ===\n        GeometryType.CIRCLE;\n    if (this.vertex_ && !this.edge_) {\n      pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n      pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n      squaredDist1 = squaredCoordinateDistance(pixel, pixel1);\n      squaredDist2 = squaredCoordinateDistance(pixel, pixel2);\n      dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n      snappedToVertex = dist <= this.pixelTolerance_;\n      if (snappedToVertex) {\n        snapped = true;\n        vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n        vertexPixel = map.getPixelFromCoordinate(vertex);\n      }\n    } else if (this.edge_) {\n      if (isCircle) {\n        vertex = closestOnCircle(pixelCoordinate,\n          /** @type {module:ol/geom/Circle} */ (segments[0].feature.getGeometry()));\n      } else {\n        vertex = closestOnSegment(pixelCoordinate, closestSegment);\n      }\n      vertexPixel = map.getPixelFromCoordinate(vertex);\n      if (coordinateDistance(pixel, vertexPixel) <= this.pixelTolerance_) {\n        snapped = true;\n        if (this.vertex_ && !isCircle) {\n          pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n          pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n          squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n          squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n          dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n          snappedToVertex = dist <= this.pixelTolerance_;\n          if (snappedToVertex) {\n            vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n            vertexPixel = map.getPixelFromCoordinate(vertex);\n          }\n        }\n      }\n    }\n    if (snapped) {\n      vertexPixel = [Math.round(vertexPixel[0]), Math.round(vertexPixel[1])];\n    }\n  }\n  return (\n    /** @type {module:ol/interaction/Snap~Result} */ ({\n      snapped: snapped,\n      vertex: vertex,\n      vertexPixel: vertexPixel\n    })\n  );\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @private\n */\nSnap.prototype.updateFeature_ = function(feature) {\n  this.removeFeature(feature, false);\n  this.addFeature(feature, false);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @private\n */\nSnap.prototype.writeCircleGeometry_ = function(feature, geometry) {\n  const polygon = fromCircle(geometry);\n  const coordinates = polygon.getCoordinates()[0];\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @private\n */\nSnap.prototype.writeGeometryCollectionGeometry_ = function(feature, geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0; i < geometries.length; ++i) {\n    const segmentWriter = this.SEGMENT_WRITERS_[geometries[i].getType()];\n    if (segmentWriter) {\n      segmentWriter.call(this, feature, geometries[i]);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @private\n */\nSnap.prototype.writeLineStringGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiLineStringGeometry_ = function(feature, geometry) {\n  const lines = geometry.getCoordinates();\n  for (let j = 0, jj = lines.length; j < jj; ++j) {\n    const coordinates = lines[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n        feature: feature,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiPointGeometry_ = function(feature, geometry) {\n  const points = geometry.getCoordinates();\n  for (let i = 0, ii = points.length; i < ii; ++i) {\n    const coordinates = points[i];\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: [coordinates, coordinates]\n    });\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiPolygonGeometry_ = function(feature, geometry) {\n  const polygons = geometry.getCoordinates();\n  for (let k = 0, kk = polygons.length; k < kk; ++k) {\n    const rings = polygons[k];\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n          feature: feature,\n          segment: segment\n        });\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Point} geometry Geometry.\n * @private\n */\nSnap.prototype.writePointGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n    feature: feature,\n    segment: [coordinates, coordinates]\n  });\n  this.rBush_.insert(geometry.getExtent(), segmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @private\n */\nSnap.prototype.writePolygonGeometry_ = function(feature, geometry) {\n  const rings = geometry.getCoordinates();\n  for (let j = 0, jj = rings.length; j < jj; ++j) {\n    const coordinates = rings[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n        feature: feature,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * Handle all pointer events events.\n * @param {module:ol/MapBrowserEvent} evt A move event.\n * @return {boolean} Pass the event to other interactions.\n * @this {module:ol/interaction/Snap}\n */\nexport function handleEvent(evt) {\n  const result = this.snapTo(evt.pixel, evt.coordinate, evt.map);\n  if (result.snapped) {\n    evt.coordinate = result.vertex.slice(0, 2);\n    evt.pixel = result.vertexPixel;\n  }\n  return handlePointerEvent.call(this, evt);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Snap}\n */\nfunction handleUpEvent(evt) {\n  const featuresToUpdate = getValues(this.pendingFeatures_);\n  if (featuresToUpdate.length) {\n    featuresToUpdate.forEach(this.updateFeature_.bind(this));\n    this.pendingFeatures_ = {};\n  }\n  return false;\n}\n\n\n/**\n * Sort segments by distance, helper function\n * @param {module:ol/interaction/Snap~SegmentData} a The first segment data.\n * @param {module:ol/interaction/Snap~SegmentData} b The second segment data.\n * @return {number} The difference in distance.\n * @this {module:ol/interaction/Snap}\n */\nfunction sortByDistance(a, b) {\n  const deltaA = squaredDistanceToSegment(this.pixelCoordinate_, a.segment);\n  const deltaB = squaredDistanceToSegment(this.pixelCoordinate_, b.segment);\n  return deltaA - deltaB;\n}\n\nexport default Snap;\n","/**\n * @module ol/interaction/Translate\n */\nimport {inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport {getChangeEventType} from '../Object.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {TRUE} from '../functions.js';\nimport {includes} from '../array.js';\nimport PointerInteraction from '../interaction/Pointer.js';\nimport InteractionProperty from '../interaction/Property.js';\n\n\n/**\n * @enum {string}\n */\nconst TranslateEventType = {\n  /**\n   * Triggered upon feature translation start.\n   * @event TranslateEvent#translatestart\n   * @api\n   */\n  TRANSLATESTART: 'translatestart',\n  /**\n   * Triggered upon feature translation.\n   * @event TranslateEvent#translating\n   * @api\n   */\n  TRANSLATING: 'translating',\n  /**\n   * Triggered upon feature translation end.\n   * @event TranslateEvent#translateend\n   * @api\n   */\n  TRANSLATEEND: 'translateend'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/Collection.<module:ol/Feature>} [features] Only features contained in this collection will be able to be translated. If\n * not specified, all features on the map will be able to be translated.\n * @property {Array.<module:ol/layer/Layer>|function(module:ol/layer/Layer): boolean} [layers] A list of layers from which features should be\n * translated. Alternatively, a filter function can be provided. The\n * function will be called for each layer in the map and should return\n * `true` for layers that you want to be translatable. If the option is\n * absent, all visible layers will be considered translatable.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Translate~Translate} instances\n * are instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/Translate~TranslateEventType} type Type.\n * @param {module:ol/Collection.<module:ol/Feature>} features The features translated.\n * @param {module:ol/coordinate~Coordinate} coordinate The event coordinate.\n */\nexport const TranslateEvent = function(type, features, coordinate) {\n\n  Event.call(this, type);\n\n  /**\n   * The features being translated.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @api\n   */\n  this.features = features;\n\n  /**\n   * The coordinate of the drag event.\n   * @const\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = coordinate;\n};\n\ninherits(TranslateEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for translating (moving) features.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Translate~TranslateEvent\n * @param {module:ol/interaction/Translate~Options=} opt_options Options.\n * @api\n */\nconst Translate = function(opt_options) {\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleMoveEvent: handleMoveEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * The last position we translated to.\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.lastCoordinate_ = null;\n\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features !== undefined ? options.features : null;\n\n  /** @type {function(module:ol/layer/Layer): boolean} */\n  let layerFilter;\n  if (options.layers) {\n    if (typeof options.layers === 'function') {\n      layerFilter = options.layers;\n    } else {\n      const layers = options.layers;\n      layerFilter = function(layer) {\n        return includes(layers, layer);\n      };\n    }\n  } else {\n    layerFilter = TRUE;\n  }\n\n  /**\n   * @private\n   * @type {function(module:ol/layer/Layer): boolean}\n   */\n  this.layerFilter_ = layerFilter;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n  /**\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.lastFeature_ = null;\n\n  listen(this,\n    getChangeEventType(InteractionProperty.ACTIVE),\n    this.handleActiveChanged_, this);\n\n};\n\ninherits(Translate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Translate}\n */\nfunction handleDownEvent(event) {\n  this.lastFeature_ = this.featuresAtPixel_(event.pixel, event.map);\n  if (!this.lastCoordinate_ && this.lastFeature_) {\n    this.lastCoordinate_ = event.coordinate;\n    handleMoveEvent.call(this, event);\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATESTART, features,\n        event.coordinate));\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Translate}\n */\nfunction handleUpEvent(event) {\n  if (this.lastCoordinate_) {\n    this.lastCoordinate_ = null;\n    handleMoveEvent.call(this, event);\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATEEND, features,\n        event.coordinate));\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @this {module:ol/interaction/Translate}\n */\nfunction handleDragEvent(event) {\n  if (this.lastCoordinate_) {\n    const newCoordinate = event.coordinate;\n    const deltaX = newCoordinate[0] - this.lastCoordinate_[0];\n    const deltaY = newCoordinate[1] - this.lastCoordinate_[1];\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    features.forEach(function(feature) {\n      const geom = feature.getGeometry();\n      geom.translate(deltaX, deltaY);\n      feature.setGeometry(geom);\n    });\n\n    this.lastCoordinate_ = newCoordinate;\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATING, features,\n        newCoordinate));\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserEvent} event Event.\n * @this {module:ol/interaction/Translate}\n */\nfunction handleMoveEvent(event) {\n  const elem = event.map.getViewport();\n\n  // Change the cursor to grab/grabbing if hovering any of the features managed\n  // by the interaction\n  if (this.featuresAtPixel_(event.pixel, event.map)) {\n    elem.classList.remove(this.lastCoordinate_ ? 'ol-grab' : 'ol-grabbing');\n    elem.classList.add(this.lastCoordinate_ ? 'ol-grabbing' : 'ol-grab');\n  } else {\n    elem.classList.remove('ol-grab', 'ol-grabbing');\n  }\n}\n\n\n/**\n * Tests to see if the given coordinates intersects any of our selected\n * features.\n * @param {module:ol~Pixel} pixel Pixel coordinate to test for intersection.\n * @param {module:ol/PluggableMap} map Map to test the intersection on.\n * @return {module:ol/Feature} Returns the feature found at the specified pixel\n * coordinates.\n * @private\n */\nTranslate.prototype.featuresAtPixel_ = function(pixel, map) {\n  return map.forEachFeatureAtPixel(pixel,\n    function(feature) {\n      if (!this.features_ || includes(this.features_.getArray(), feature)) {\n        return feature;\n      }\n    }.bind(this), {\n      layerFilter: this.layerFilter_,\n      hitTolerance: this.hitTolerance_\n    });\n};\n\n\n/**\n * Returns the Hit-detection tolerance.\n * @returns {number} Hit tolerance in pixels.\n * @api\n */\nTranslate.prototype.getHitTolerance = function() {\n  return this.hitTolerance_;\n};\n\n\n/**\n * Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @api\n */\nTranslate.prototype.setHitTolerance = function(hitTolerance) {\n  this.hitTolerance_ = hitTolerance;\n};\n\n\n/**\n * @inheritDoc\n */\nTranslate.prototype.setMap = function(map) {\n  const oldMap = this.getMap();\n  PointerInteraction.prototype.setMap.call(this, map);\n  this.updateState_(oldMap);\n};\n\n\n/**\n * @private\n */\nTranslate.prototype.handleActiveChanged_ = function() {\n  this.updateState_(null);\n};\n\n\n/**\n * @param {module:ol/PluggableMap} oldMap Old map.\n * @private\n */\nTranslate.prototype.updateState_ = function(oldMap) {\n  let map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    map = map || oldMap;\n    if (map) {\n      const elem = map.getViewport();\n      elem.classList.remove('ol-grab', 'ol-grabbing');\n    }\n  }\n};\n\n\nexport default Translate;\n","/**\n * @module ol/interaction\n */\nimport Collection from './Collection.js';\nimport Kinetic from './Kinetic.js';\nimport DoubleClickZoom from './interaction/DoubleClickZoom.js';\nimport DragPan from './interaction/DragPan.js';\nimport DragRotate from './interaction/DragRotate.js';\nimport DragZoom from './interaction/DragZoom.js';\nimport KeyboardPan from './interaction/KeyboardPan.js';\nimport KeyboardZoom from './interaction/KeyboardZoom.js';\nimport MouseWheelZoom from './interaction/MouseWheelZoom.js';\nimport PinchRotate from './interaction/PinchRotate.js';\nimport PinchZoom from './interaction/PinchZoom.js';\n\nexport {default as DoubleClickZoom} from './interaction/DoubleClickZoom.js';\nexport {default as DragAndDrop} from './interaction/DragAndDrop.js';\nexport {default as DragBox} from './interaction/DragBox.js';\nexport {default as DragPan} from './interaction/DragPan.js';\nexport {default as DragRotate} from './interaction/DragRotate.js';\nexport {default as DragRotateAndZoom} from './interaction/DragRotateAndZoom.js';\nexport {default as DragZoom} from './interaction/DragZoom.js';\nexport {default as Draw} from './interaction/Draw.js';\nexport {default as Extent} from './interaction/Extent.js';\nexport {default as Interaction} from './interaction/Interaction.js';\nexport {default as KeyboardPan} from './interaction/KeyboardPan.js';\nexport {default as KeyboardZoom} from './interaction/KeyboardZoom.js';\nexport {default as Modify} from './interaction/Modify.js';\nexport {default as MouseWheelZoom} from './interaction/MouseWheelZoom.js';\nexport {default as PinchRotate} from './interaction/PinchRotate.js';\nexport {default as PinchZoom} from './interaction/PinchZoom.js';\nexport {default as Pointer} from './interaction/Pointer.js';\nexport {default as Select} from './interaction/Select.js';\nexport {default as Snap} from './interaction/Snap.js';\nexport {default as Translate} from './interaction/Translate.js';\n\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [altShiftDragRotate=true] Whether Alt-Shift-drag rotate is\n * desired.\n * @property {boolean} [constrainResolution=false] Zoom to the closest integer\n * zoom level after the wheel/trackpad or pinch gesture ends.\n * @property {boolean} [doubleClickZoom=true] Whether double click zoom is\n * desired.\n * @property {boolean} [keyboard=true] Whether keyboard interaction is desired.\n * @property {boolean} [mouseWheelZoom=true] Whether mousewheel zoom is desired.\n * @property {boolean} [shiftDragZoom=true] Whether Shift-drag zoom is desired.\n * @property {boolean} [dragPan=true] Whether drag pan is desired.\n * @property {boolean} [pinchRotate=true] Whether pinch rotate is desired.\n * @property {boolean} [pinchZoom=true] Whether pinch zoom is desired.\n * @property {number} [zoomDelta] Zoom level delta when using keyboard or\n * mousewheel zoom.\n * @property {number} [zoomDuration] Duration of the zoom animation in\n * milliseconds.\n */\n\n\n/**\n * Set of interactions included in maps by default. Specific interactions can be\n * excluded by setting the appropriate option to false in the constructor\n * options, but the order of the interactions is fixed.  If you want to specify\n * a different order for interactions, you will need to create your own\n * {@link module:ol/interaction/Interaction} instances and insert\n * them into a {@link module:ol/Collection} in the order you want\n * before creating your {@link module:ol/Map~Map} instance. The default set of\n * interactions, in sequence, is:\n * * {@link module:ol/interaction/DragRotate~DragRotate}\n * * {@link module:ol/interaction/DoubleClickZoom~DoubleClickZoom}\n * * {@link module:ol/interaction/DragPan~DragPan}\n * * {@link module:ol/interaction/PinchRotate~PinchRotate}\n * * {@link module:ol/interaction/PinchZoom~PinchZoom}\n * * {@link module:ol/interaction/KeyboardPan~KeyboardPan}\n * * {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}\n * * {@link module:ol/interaction/MouseWheelZoom~MouseWheelZoom}\n * * {@link module:ol/interaction/DragZoom~DragZoom}\n *\n * @param {module:ol/interaction/Interaction~DefaultsOptions=} opt_options\n * Defaults options.\n * @return {module:ol/Collection.<module:ol/interaction/Interaction>}\n * A collection of interactions to be used with the {@link module:ol/Map~Map}\n * constructor's `interactions` option.\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const interactions = new Collection();\n\n  const kinetic = new Kinetic(-0.005, 0.05, 100);\n\n  const altShiftDragRotate = options.altShiftDragRotate !== undefined ?\n    options.altShiftDragRotate : true;\n  if (altShiftDragRotate) {\n    interactions.push(new DragRotate());\n  }\n\n  const doubleClickZoom = options.doubleClickZoom !== undefined ?\n    options.doubleClickZoom : true;\n  if (doubleClickZoom) {\n    interactions.push(new DoubleClickZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const dragPan = options.dragPan !== undefined ? options.dragPan : true;\n  if (dragPan) {\n    interactions.push(new DragPan({\n      kinetic: kinetic\n    }));\n  }\n\n  const pinchRotate = options.pinchRotate !== undefined ? options.pinchRotate :\n    true;\n  if (pinchRotate) {\n    interactions.push(new PinchRotate());\n  }\n\n  const pinchZoom = options.pinchZoom !== undefined ? options.pinchZoom : true;\n  if (pinchZoom) {\n    interactions.push(new PinchZoom({\n      constrainResolution: options.constrainResolution,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const keyboard = options.keyboard !== undefined ? options.keyboard : true;\n  if (keyboard) {\n    interactions.push(new KeyboardPan());\n    interactions.push(new KeyboardZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const mouseWheelZoom = options.mouseWheelZoom !== undefined ?\n    options.mouseWheelZoom : true;\n  if (mouseWheelZoom) {\n    interactions.push(new MouseWheelZoom({\n      constrainResolution: options.constrainResolution,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const shiftDragZoom = options.shiftDragZoom !== undefined ?\n    options.shiftDragZoom : true;\n  if (shiftDragZoom) {\n    interactions.push(new DragZoom({\n      duration: options.zoomDuration\n    }));\n  }\n\n  return interactions;\n\n}\n","/**\n * Default maximum allowed threshold  (in pixels) for reprojection\n * triangulation.\n * @type {number}\n */\nexport const ERROR_THRESHOLD = 0.5;\n\n/**\n * Enable automatic reprojection of raster sources. Default is `true`.\n * TODO: decide if we want to expose this as a build flag or remove it\n * @type {boolean}\n */\nexport const ENABLE_RASTER_REPROJECTION = true;\n","/**\n * @module ol/ImageCanvas\n */\nimport {inherits} from './index.js';\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n\n\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error))} Loader\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/ImageBase}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {module:ol/ImageCanvas~Loader=} opt_loader Optional loader function to\n *     support asynchronous canvas drawing.\n */\nconst ImageCanvas = function(extent, resolution, pixelRatio, canvas, opt_loader) {\n\n  /**\n   * Optional canvas loader function.\n   * @type {?module:ol/ImageCanvas~Loader}\n   * @private\n   */\n  this.loader_ = opt_loader !== undefined ? opt_loader : null;\n\n  const state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n\n  ImageBase.call(this, extent, resolution, pixelRatio, state);\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = canvas;\n\n  /**\n   * @private\n   * @type {Error}\n   */\n  this.error_ = null;\n\n};\n\ninherits(ImageCanvas, ImageBase);\n\n\n/**\n * Get any error associated with asynchronous rendering.\n * @return {Error} Any error that occurred during rendering.\n */\nImageCanvas.prototype.getError = function() {\n  return this.error_;\n};\n\n\n/**\n * Handle async drawing complete.\n * @param {Error} err Any error during drawing.\n * @private\n */\nImageCanvas.prototype.handleLoad_ = function(err) {\n  if (err) {\n    this.error_ = err;\n    this.state = ImageState.ERROR;\n  } else {\n    this.state = ImageState.LOADED;\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nImageCanvas.prototype.load = function() {\n  if (this.state == ImageState.IDLE) {\n    this.state = ImageState.LOADING;\n    this.changed();\n    this.loader_(this.handleLoad_.bind(this));\n  }\n};\n\n\n/**\n * @return {HTMLCanvasElement} Canvas element.\n */\nImageCanvas.prototype.getImage = function() {\n  return this.canvas_;\n};\nexport default ImageCanvas;\n","/**\n * @module ol/render/Event\n */\nimport {inherits} from '../index.js';\nimport Event from '../events/Event.js';\n\n/**\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/render/EventType} type Type.\n * @param {module:ol/render/VectorContext=} opt_vectorContext Vector context.\n * @param {module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n * @param {?CanvasRenderingContext2D=} opt_context Context.\n * @param {?module:ol/webgl/Context=} opt_glContext WebGL Context.\n */\nconst RenderEvent = function(\n  type, opt_vectorContext, opt_frameState, opt_context,\n  opt_glContext) {\n\n  Event.call(this, type);\n\n  /**\n   * For canvas, this is an instance of {@link module:ol/render/canvas/Immediate}.\n   * @type {module:ol/render/VectorContext|undefined}\n   * @api\n   */\n  this.vectorContext = opt_vectorContext;\n\n  /**\n   * An object representing the current render frame state.\n   * @type {module:ol/PluggableMap~FrameState|undefined}\n   * @api\n   */\n  this.frameState = opt_frameState;\n\n  /**\n   * Canvas context. Only available when a Canvas renderer is used, null\n   * otherwise.\n   * @type {CanvasRenderingContext2D|null|undefined}\n   * @api\n   */\n  this.context = opt_context;\n\n  /**\n   * WebGL context. Only available when a WebGL renderer is used, null\n   * otherwise.\n   * @type {module:ol/webgl/Context|null|undefined}\n   * @api\n   */\n  this.glContext = opt_glContext;\n\n};\n\ninherits(RenderEvent, Event);\nexport default RenderEvent;\n","/**\n * @module ol/render/VectorContext\n */\n/**\n * Context for drawing geometries.  A vector context is available on render\n * events and does not need to be constructed directly.\n * @constructor\n * @abstract\n * @struct\n * @api\n */\nconst VectorContext = function() {\n};\n\n\n/**\n * Render a geometry with a custom renderer.\n *\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {Function} renderer Renderer.\n */\nVectorContext.prototype.drawCustom = function(geometry, feature, renderer) {};\n\n\n/**\n * Render a geometry.\n *\n * @param {module:ol/geom/Geometry} geometry The geometry to render.\n */\nVectorContext.prototype.drawGeometry = function(geometry) {};\n\n\n/**\n * Set the rendering style.\n *\n * @param {module:ol/style/Style} style The rendering style.\n */\nVectorContext.prototype.setStyle = function(style) {};\n\n\n/**\n * @param {module:ol/geom/Circle} circleGeometry Circle geometry.\n * @param {module:ol/Feature} feature Feature.\n */\nVectorContext.prototype.drawCircle = function(circleGeometry, feature) {};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n */\nVectorContext.prototype.drawFeature = function(feature, style) {};\n\n\n/**\n * @param {module:ol/geom/GeometryCollection} geometryCollectionGeometry Geometry\n *     collection.\n * @param {module:ol/Feature} feature Feature.\n */\nVectorContext.prototype.drawGeometryCollection = function(geometryCollectionGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/LineString|module:ol/render/Feature} lineStringGeometry Line string geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawLineString = function(lineStringGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} multiLineStringGeometry MultiLineString geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} multiPointGeometry MultiPoint geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiPoint = function(multiPointGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiPolygon} multiPolygonGeometry MultiPolygon geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Point|module:ol/render/Feature} pointGeometry Point geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawPoint = function(pointGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} polygonGeometry Polygon geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawPolygon = function(polygonGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawText = function(geometry, feature) {};\n\n\n/**\n * @param {module:ol/style/Fill} fillStyle Fill style.\n * @param {module:ol/style/Stroke} strokeStyle Stroke style.\n */\nVectorContext.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {};\n\n\n/**\n * @param {module:ol/style/Image} imageStyle Image style.\n * @param {module:ol/render/canvas~DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setImageStyle = function(imageStyle, opt_declutterGroup) {};\n\n\n/**\n * @param {module:ol/style/Text} textStyle Text style.\n * @param {module:ol/render/canvas~DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setTextStyle = function(textStyle, opt_declutterGroup) {};\nexport default VectorContext;\n","/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\n\nimport {inherits} from '../../index.js';\nimport {equals} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {intersects} from '../../extent.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {transformGeom2D} from '../../geom/SimpleGeometry.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport VectorContext from '../VectorContext.js';\nimport {defaultTextAlign, defaultFillStyle, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline, defaultFont} from '../canvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n *\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @struct\n */\nconst CanvasImmediateRenderer = function(context, pixelRatio, extent, transform, viewRotation) {\n  VectorContext.call(this);\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = context;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = extent;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = transform;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.viewRotation_ = viewRotation;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.contextFillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.contextStrokeState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~TextState}\n   */\n  this.contextTextState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.fillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.strokeState_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageAnchorX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageAnchorY_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageHeight_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOpacity_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOriginX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOriginY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.imageRotateWithView_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageRotation_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageScale_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.imageSnapToPixel_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageWidth_ = 0;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.textRotateWithView_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textRotation_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textScale_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.textFillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.textStrokeState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~TextState}\n   */\n  this.textState_ = null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.pixelCoordinates_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.tmpLocalTransform_ = createTransform();\n\n};\n\ninherits(CanvasImmediateRenderer, VectorContext);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n */\nCanvasImmediateRenderer.prototype.drawImages_ = function(flatCoordinates, offset, end, stride) {\n  if (!this.image_) {\n    return;\n  }\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, 2, this.transform_,\n    this.pixelCoordinates_);\n  const context = this.context_;\n  const localTransform = this.tmpLocalTransform_;\n  const alpha = context.globalAlpha;\n  if (this.imageOpacity_ != 1) {\n    context.globalAlpha = alpha * this.imageOpacity_;\n  }\n  let rotation = this.imageRotation_;\n  if (this.imageRotateWithView_) {\n    rotation += this.viewRotation_;\n  }\n  for (let i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n    let x = pixelCoordinates[i] - this.imageAnchorX_;\n    let y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n    if (this.imageSnapToPixel_) {\n      x = Math.round(x);\n      y = Math.round(y);\n    }\n    if (rotation !== 0 || this.imageScale_ != 1) {\n      const centerX = x + this.imageAnchorX_;\n      const centerY = y + this.imageAnchorY_;\n      composeTransform(localTransform,\n        centerX, centerY,\n        this.imageScale_, this.imageScale_,\n        rotation,\n        -centerX, -centerY);\n      context.setTransform.apply(context, localTransform);\n    }\n    context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_,\n      this.imageWidth_, this.imageHeight_, x, y,\n      this.imageWidth_, this.imageHeight_);\n  }\n  if (rotation !== 0 || this.imageScale_ != 1) {\n    context.setTransform(1, 0, 0, 1, 0, 0);\n  }\n  if (this.imageOpacity_ != 1) {\n    context.globalAlpha = alpha;\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n */\nCanvasImmediateRenderer.prototype.drawText_ = function(flatCoordinates, offset, end, stride) {\n  if (!this.textState_ || this.text_ === '') {\n    return;\n  }\n  if (this.textFillState_) {\n    this.setContextFillState_(this.textFillState_);\n  }\n  if (this.textStrokeState_) {\n    this.setContextStrokeState_(this.textStrokeState_);\n  }\n  this.setContextTextState_(this.textState_);\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, stride, this.transform_,\n    this.pixelCoordinates_);\n  const context = this.context_;\n  let rotation = this.textRotation_;\n  if (this.textRotateWithView_) {\n    rotation += this.viewRotation_;\n  }\n  for (; offset < end; offset += stride) {\n    const x = pixelCoordinates[offset] + this.textOffsetX_;\n    const y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n    if (rotation !== 0 || this.textScale_ != 1) {\n      const localTransform = composeTransform(this.tmpLocalTransform_,\n        x, y,\n        this.textScale_, this.textScale_,\n        rotation,\n        -x, -y);\n      context.setTransform.apply(context, localTransform);\n    }\n    if (this.textStrokeState_) {\n      context.strokeText(this.text_, x, y);\n    }\n    if (this.textFillState_) {\n      context.fillText(this.text_, x, y);\n    }\n  }\n  if (rotation !== 0 || this.textScale_ != 1) {\n    context.setTransform(1, 0, 0, 1, 0, 0);\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {boolean} close Close.\n * @private\n * @return {number} end End.\n */\nCanvasImmediateRenderer.prototype.moveToLineTo_ = function(flatCoordinates, offset, end, stride, close) {\n  const context = this.context_;\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, stride, this.transform_,\n    this.pixelCoordinates_);\n  context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n  let length = pixelCoordinates.length;\n  if (close) {\n    length -= 2;\n  }\n  for (let i = 2; i < length; i += 2) {\n    context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n  }\n  if (close) {\n    context.closePath();\n  }\n  return end;\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @private\n * @return {number} End.\n */\nCanvasImmediateRenderer.prototype.drawRings_ = function(flatCoordinates, offset, ends, stride) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n  }\n  return offset;\n};\n\n\n/**\n * Render a circle geometry into the canvas.  Rendering is immediate and uses\n * the current fill and stroke styles.\n *\n * @param {module:ol/geom/Circle} geometry Circle geometry.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawCircle = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.fillState_ || this.strokeState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const pixelCoordinates = transformGeom2D(\n      geometry, this.transform_, this.pixelCoordinates_);\n    const dx = pixelCoordinates[2] - pixelCoordinates[0];\n    const dy = pixelCoordinates[3] - pixelCoordinates[1];\n    const radius = Math.sqrt(dx * dx + dy * dy);\n    const context = this.context_;\n    context.beginPath();\n    context.arc(\n      pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    this.drawText_(geometry.getCenter(), 0, 2, 2);\n  }\n};\n\n\n/**\n * Set the rendering style.  Note that since this is an immediate rendering API,\n * any `zIndex` on the provided style will be ignored.\n *\n * @param {module:ol/style/Style} style The rendering style.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.setStyle = function(style) {\n  this.setFillStrokeStyle(style.getFill(), style.getStroke());\n  this.setImageStyle(style.getImage());\n  this.setTextStyle(style.getText());\n};\n\n\n/**\n * Render a geometry into the canvas.  Call\n * {@link module:ol/render/canvas/Immediate#setStyle} first to set the rendering style.\n *\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry The geometry to render.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawGeometry = function(geometry) {\n  const type = geometry.getType();\n  switch (type) {\n    case GeometryType.POINT:\n      this.drawPoint(/** @type {module:ol/geom/Point} */ (geometry));\n      break;\n    case GeometryType.LINE_STRING:\n      this.drawLineString(/** @type {module:ol/geom/LineString} */ (geometry));\n      break;\n    case GeometryType.POLYGON:\n      this.drawPolygon(/** @type {module:ol/geom/Polygon} */ (geometry));\n      break;\n    case GeometryType.MULTI_POINT:\n      this.drawMultiPoint(/** @type {module:ol/geom/MultiPoint} */ (geometry));\n      break;\n    case GeometryType.MULTI_LINE_STRING:\n      this.drawMultiLineString(/** @type {module:ol/geom/MultiLineString} */ (geometry));\n      break;\n    case GeometryType.MULTI_POLYGON:\n      this.drawMultiPolygon(/** @type {module:ol/geom/MultiPolygon} */ (geometry));\n      break;\n    case GeometryType.GEOMETRY_COLLECTION:\n      this.drawGeometryCollection(/** @type {module:ol/geom/GeometryCollection} */ (geometry));\n      break;\n    case GeometryType.CIRCLE:\n      this.drawCircle(/** @type {module:ol/geom/Circle} */ (geometry));\n      break;\n    default:\n  }\n};\n\n\n/**\n * Render a feature into the canvas.  Note that any `zIndex` on the provided\n * style will be ignored - features are rendered immediately in the order that\n * this method is called.  If you need `zIndex` support, you should be using an\n * {@link module:ol/layer/Vector~VectorLayer} instead.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawFeature = function(feature, style) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  this.setStyle(style);\n  this.drawGeometry(geometry);\n};\n\n\n/**\n * Render a GeometryCollection to the canvas.  Rendering is immediate and\n * uses the current styles appropriate for each geometry in the collection.\n *\n * @param {module:ol/geom/GeometryCollection} geometry Geometry collection.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawGeometryCollection = function(geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    this.drawGeometry(geometries[i]);\n  }\n};\n\n\n/**\n * Render a Point geometry into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/Point|module:ol/render/Feature} geometry Point geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawPoint = function(geometry) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const stride = geometry.getStride();\n  if (this.image_) {\n    this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n  if (this.text_ !== '') {\n    this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n * uses the current style.\n *\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} geometry MultiPoint geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiPoint = function(geometry) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const stride = geometry.getStride();\n  if (this.image_) {\n    this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n  if (this.text_ !== '') {\n    this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * Render a LineString into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/LineString|module:ol/render/Feature} geometry LineString geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawLineString = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_) {\n    this.setContextStrokeState_(this.strokeState_);\n    const context = this.context_;\n    const flatCoordinates = geometry.getFlatCoordinates();\n    context.beginPath();\n    this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length,\n      geometry.getStride(), false);\n    context.stroke();\n  }\n  if (this.text_ !== '') {\n    const flatMidpoint = geometry.getFlatMidpoint();\n    this.drawText_(flatMidpoint, 0, 2, 2);\n  }\n};\n\n\n/**\n * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n * and uses the current style.\n *\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} geometry MultiLineString geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiLineString = function(geometry) {\n  const geometryExtent = geometry.getExtent();\n  if (!intersects(this.extent_, geometryExtent)) {\n    return;\n  }\n  if (this.strokeState_) {\n    this.setContextStrokeState_(this.strokeState_);\n    const context = this.context_;\n    const flatCoordinates = geometry.getFlatCoordinates();\n    let offset = 0;\n    const ends = geometry.getEnds();\n    const stride = geometry.getStride();\n    context.beginPath();\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n    }\n    context.stroke();\n  }\n  if (this.text_ !== '') {\n    const flatMidpoints = geometry.getFlatMidpoints();\n    this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n  }\n};\n\n\n/**\n * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} geometry Polygon geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawPolygon = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_ || this.fillState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const context = this.context_;\n    context.beginPath();\n    this.drawRings_(geometry.getOrientedFlatCoordinates(),\n      0, geometry.getEnds(), geometry.getStride());\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    const flatInteriorPoint = geometry.getFlatInteriorPoint();\n    this.drawText_(flatInteriorPoint, 0, 2, 2);\n  }\n};\n\n\n/**\n * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n * uses the current style.\n * @param {module:ol/geom/MultiPolygon} geometry MultiPolygon geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiPolygon = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_ || this.fillState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const context = this.context_;\n    const flatCoordinates = geometry.getOrientedFlatCoordinates();\n    let offset = 0;\n    const endss = geometry.getEndss();\n    const stride = geometry.getStride();\n    context.beginPath();\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      const ends = endss[i];\n      offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n    }\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    const flatInteriorPoints = geometry.getFlatInteriorPoints();\n    this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillState} fillState Fill state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextFillState_ = function(fillState) {\n  const context = this.context_;\n  const contextFillState = this.contextFillState_;\n  if (!contextFillState) {\n    context.fillStyle = fillState.fillStyle;\n    this.contextFillState_ = {\n      fillStyle: fillState.fillStyle\n    };\n  } else {\n    if (contextFillState.fillStyle != fillState.fillStyle) {\n      contextFillState.fillStyle = context.fillStyle = fillState.fillStyle;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~StrokeState} strokeState Stroke state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextStrokeState_ = function(strokeState) {\n  const context = this.context_;\n  const contextStrokeState = this.contextStrokeState_;\n  if (!contextStrokeState) {\n    context.lineCap = strokeState.lineCap;\n    if (CANVAS_LINE_DASH) {\n      context.setLineDash(strokeState.lineDash);\n      context.lineDashOffset = strokeState.lineDashOffset;\n    }\n    context.lineJoin = strokeState.lineJoin;\n    context.lineWidth = strokeState.lineWidth;\n    context.miterLimit = strokeState.miterLimit;\n    context.strokeStyle = strokeState.strokeStyle;\n    this.contextStrokeState_ = {\n      lineCap: strokeState.lineCap,\n      lineDash: strokeState.lineDash,\n      lineDashOffset: strokeState.lineDashOffset,\n      lineJoin: strokeState.lineJoin,\n      lineWidth: strokeState.lineWidth,\n      miterLimit: strokeState.miterLimit,\n      strokeStyle: strokeState.strokeStyle\n    };\n  } else {\n    if (contextStrokeState.lineCap != strokeState.lineCap) {\n      contextStrokeState.lineCap = context.lineCap = strokeState.lineCap;\n    }\n    if (CANVAS_LINE_DASH) {\n      if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n        context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n      }\n      if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n        contextStrokeState.lineDashOffset = context.lineDashOffset =\n            strokeState.lineDashOffset;\n      }\n    }\n    if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n      contextStrokeState.lineJoin = context.lineJoin = strokeState.lineJoin;\n    }\n    if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n      contextStrokeState.lineWidth = context.lineWidth = strokeState.lineWidth;\n    }\n    if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n      contextStrokeState.miterLimit = context.miterLimit =\n          strokeState.miterLimit;\n    }\n    if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n      contextStrokeState.strokeStyle = context.strokeStyle =\n          strokeState.strokeStyle;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~TextState} textState Text state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextTextState_ = function(textState) {\n  const context = this.context_;\n  const contextTextState = this.contextTextState_;\n  const textAlign = textState.textAlign ?\n    textState.textAlign : defaultTextAlign;\n  if (!contextTextState) {\n    context.font = textState.font;\n    context.textAlign = textAlign;\n    context.textBaseline = textState.textBaseline;\n    this.contextTextState_ = {\n      font: textState.font,\n      textAlign: textAlign,\n      textBaseline: textState.textBaseline\n    };\n  } else {\n    if (contextTextState.font != textState.font) {\n      contextTextState.font = context.font = textState.font;\n    }\n    if (contextTextState.textAlign != textAlign) {\n      contextTextState.textAlign = context.textAlign = textAlign;\n    }\n    if (contextTextState.textBaseline != textState.textBaseline) {\n      contextTextState.textBaseline = context.textBaseline =\n          textState.textBaseline;\n    }\n  }\n};\n\n\n/**\n * Set the fill and stroke style for subsequent draw operations.  To clear\n * either fill or stroke styles, pass null for the appropriate parameter.\n *\n * @param {module:ol/style/Fill} fillStyle Fill style.\n * @param {module:ol/style/Stroke} strokeStyle Stroke style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  if (!fillStyle) {\n    this.fillState_ = null;\n  } else {\n    const fillStyleColor = fillStyle.getColor();\n    this.fillState_ = {\n      fillStyle: asColorLike(fillStyleColor ?\n        fillStyleColor : defaultFillStyle)\n    };\n  }\n  if (!strokeStyle) {\n    this.strokeState_ = null;\n  } else {\n    const strokeStyleColor = strokeStyle.getColor();\n    const strokeStyleLineCap = strokeStyle.getLineCap();\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    const strokeStyleLineJoin = strokeStyle.getLineJoin();\n    const strokeStyleWidth = strokeStyle.getWidth();\n    const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n    this.strokeState_ = {\n      lineCap: strokeStyleLineCap !== undefined ?\n        strokeStyleLineCap : defaultLineCap,\n      lineDash: strokeStyleLineDash ?\n        strokeStyleLineDash : defaultLineDash,\n      lineDashOffset: strokeStyleLineDashOffset ?\n        strokeStyleLineDashOffset : defaultLineDashOffset,\n      lineJoin: strokeStyleLineJoin !== undefined ?\n        strokeStyleLineJoin : defaultLineJoin,\n      lineWidth: this.pixelRatio_ * (strokeStyleWidth !== undefined ?\n        strokeStyleWidth : defaultLineWidth),\n      miterLimit: strokeStyleMiterLimit !== undefined ?\n        strokeStyleMiterLimit : defaultMiterLimit,\n      strokeStyle: asColorLike(strokeStyleColor ?\n        strokeStyleColor : defaultStrokeStyle)\n    };\n  }\n};\n\n\n/**\n * Set the image style for subsequent draw operations.  Pass null to remove\n * the image style.\n *\n * @param {module:ol/style/Image} imageStyle Image style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setImageStyle = function(imageStyle) {\n  if (!imageStyle) {\n    this.image_ = null;\n  } else {\n    const imageAnchor = imageStyle.getAnchor();\n    // FIXME pixel ratio\n    const imageImage = imageStyle.getImage(1);\n    const imageOrigin = imageStyle.getOrigin();\n    const imageSize = imageStyle.getSize();\n    this.imageAnchorX_ = imageAnchor[0];\n    this.imageAnchorY_ = imageAnchor[1];\n    this.imageHeight_ = imageSize[1];\n    this.image_ = imageImage;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    this.imageScale_ = imageStyle.getScale() * this.pixelRatio_;\n    this.imageSnapToPixel_ = imageStyle.getSnapToPixel();\n    this.imageWidth_ = imageSize[0];\n  }\n};\n\n\n/**\n * Set the text style for subsequent draw operations.  Pass null to\n * remove the text style.\n *\n * @param {module:ol/style/Text} textStyle Text style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setTextStyle = function(textStyle) {\n  if (!textStyle) {\n    this.text_ = '';\n  } else {\n    const textFillStyle = textStyle.getFill();\n    if (!textFillStyle) {\n      this.textFillState_ = null;\n    } else {\n      const textFillStyleColor = textFillStyle.getColor();\n      this.textFillState_ = {\n        fillStyle: asColorLike(textFillStyleColor ?\n          textFillStyleColor : defaultFillStyle)\n      };\n    }\n    const textStrokeStyle = textStyle.getStroke();\n    if (!textStrokeStyle) {\n      this.textStrokeState_ = null;\n    } else {\n      const textStrokeStyleColor = textStrokeStyle.getColor();\n      const textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n      const textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n      const textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n      const textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n      const textStrokeStyleWidth = textStrokeStyle.getWidth();\n      const textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n      this.textStrokeState_ = {\n        lineCap: textStrokeStyleLineCap !== undefined ?\n          textStrokeStyleLineCap : defaultLineCap,\n        lineDash: textStrokeStyleLineDash ?\n          textStrokeStyleLineDash : defaultLineDash,\n        lineDashOffset: textStrokeStyleLineDashOffset ?\n          textStrokeStyleLineDashOffset : defaultLineDashOffset,\n        lineJoin: textStrokeStyleLineJoin !== undefined ?\n          textStrokeStyleLineJoin : defaultLineJoin,\n        lineWidth: textStrokeStyleWidth !== undefined ?\n          textStrokeStyleWidth : defaultLineWidth,\n        miterLimit: textStrokeStyleMiterLimit !== undefined ?\n          textStrokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(textStrokeStyleColor ?\n          textStrokeStyleColor : defaultStrokeStyle)\n      };\n    }\n    const textFont = textStyle.getFont();\n    const textOffsetX = textStyle.getOffsetX();\n    const textOffsetY = textStyle.getOffsetY();\n    const textRotateWithView = textStyle.getRotateWithView();\n    const textRotation = textStyle.getRotation();\n    const textScale = textStyle.getScale();\n    const textText = textStyle.getText();\n    const textTextAlign = textStyle.getTextAlign();\n    const textTextBaseline = textStyle.getTextBaseline();\n    this.textState_ = {\n      font: textFont !== undefined ?\n        textFont : defaultFont,\n      textAlign: textTextAlign !== undefined ?\n        textTextAlign : defaultTextAlign,\n      textBaseline: textTextBaseline !== undefined ?\n        textTextBaseline : defaultTextBaseline\n    };\n    this.text_ = textText !== undefined ? textText : '';\n    this.textOffsetX_ =\n        textOffsetX !== undefined ? (this.pixelRatio_ * textOffsetX) : 0;\n    this.textOffsetY_ =\n        textOffsetY !== undefined ? (this.pixelRatio_ * textOffsetY) : 0;\n    this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n    this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n    this.textScale_ = this.pixelRatio_ * (textScale !== undefined ?\n      textScale : 1);\n  }\n};\nexport default CanvasImmediateRenderer;\n","/**\n * @module ol/style/IconImageCache\n */\nimport {asString} from '../color.js';\n\n/**\n * Singleton class. Available through {@link module:ol/style/IconImageCache~shared}.\n * @constructor\n */\nconst IconImageCache = function() {\n\n  /**\n   * @type {!Object.<string, module:ol/style/IconImage>}\n   * @private\n   */\n  this.cache_ = {};\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.cacheSize_ = 0;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxCacheSize_ = 32;\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @return {string} Cache key.\n */\nfunction getKey(src, crossOrigin, color) {\n  const colorString = color ? asString(color) : 'null';\n  return crossOrigin + ':' + src + ':' + colorString;\n}\n\n\n/**\n * FIXME empty description for jsdoc\n */\nIconImageCache.prototype.clear = function() {\n  this.cache_ = {};\n  this.cacheSize_ = 0;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nIconImageCache.prototype.expire = function() {\n  if (this.cacheSize_ > this.maxCacheSize_) {\n    let i = 0;\n    for (const key in this.cache_) {\n      const iconImage = this.cache_[key];\n      if ((i++ & 3) === 0 && !iconImage.hasListener()) {\n        delete this.cache_[key];\n        --this.cacheSize_;\n      }\n    }\n  }\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/style/IconImage} Icon image.\n */\nIconImageCache.prototype.get = function(src, crossOrigin, color) {\n  const key = getKey(src, crossOrigin, color);\n  return key in this.cache_ ? this.cache_[key] : null;\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @param {module:ol/style/IconImage} iconImage Icon image.\n */\nIconImageCache.prototype.set = function(src, crossOrigin, color, iconImage) {\n  const key = getKey(src, crossOrigin, color);\n  this.cache_[key] = iconImage;\n  ++this.cacheSize_;\n};\n\n\n/**\n * Set the cache size of the icon cache. Default is `32`. Change this value when\n * your map uses more than 32 different icon images and you are not caching icon\n * styles on the application level.\n * @param {number} maxCacheSize Cache max size.\n * @api\n */\nIconImageCache.prototype.setSize = function(maxCacheSize) {\n  this.maxCacheSize_ = maxCacheSize;\n  this.expire();\n};\nexport default IconImageCache;\n\n\n/**\n * The {@link module:ol/style/IconImageCache~IconImageCache} for\n * {@link module:ol/style/Icon~Icon} images.\n * @api\n */\nexport const shared = new IconImageCache();\n","/**\n * @module ol/renderer/Map\n */\nimport {getUid, inherits} from '../index.js';\nimport Disposable from '../Disposable.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getWidth} from '../extent.js';\nimport {TRUE, UNDEFINED} from '../functions.js';\nimport {visibleAtResolution} from '../layer/Layer.js';\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\nimport {compose as composeTransform, invert as invertTransform, setFromArray as transformSetFromArray} from '../transform.js';\n\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/Disposable}\n * @param {module:ol/PluggableMap} map Map.\n * @struct\n */\nconst MapRenderer = function(map) {\n  Disposable.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = map;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/renderer/Layer>}\n   */\n  this.layerRenderers_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/events~EventsKey>}\n   */\n  this.layerRendererListeners_ = {};\n\n  /**\n   * @private\n   * @type {Array.<module:ol/renderer/Layer>}\n   */\n  this.layerRendererConstructors_ = [];\n\n};\n\ninherits(MapRenderer, Disposable);\n\n\n/**\n * Register layer renderer constructors.\n * @param {Array.<module:ol/renderer/Layer>} constructors Layer renderers.\n */\nMapRenderer.prototype.registerLayerRenderers = function(constructors) {\n  this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_, constructors);\n};\n\n\n/**\n * Get the registered layer renderer constructors.\n * @return {Array.<module:ol/renderer/Layer>} Registered layer renderers.\n */\nMapRenderer.prototype.getLayerRendererConstructors = function() {\n  return this.layerRendererConstructors_;\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @protected\n */\nMapRenderer.prototype.calculateMatrices2D = function(frameState) {\n  const viewState = frameState.viewState;\n  const coordinateToPixelTransform = frameState.coordinateToPixelTransform;\n  const pixelToCoordinateTransform = frameState.pixelToCoordinateTransform;\n\n  composeTransform(coordinateToPixelTransform,\n    frameState.size[0] / 2, frameState.size[1] / 2,\n    1 / viewState.resolution, -1 / viewState.resolution,\n    -viewState.rotation,\n    -viewState.center[0], -viewState.center[1]);\n\n  invertTransform(\n    transformSetFromArray(pixelToCoordinateTransform, coordinateToPixelTransform));\n};\n\n\n/**\n * Removes all layer renderers.\n */\nMapRenderer.prototype.removeLayerRenderers = function() {\n  for (const key in this.layerRenderers_) {\n    this.removeLayerRendererByKey_(key).dispose();\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nfunction expireIconCache(map, frameState) {\n  iconImageCache.expire();\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature),\n *     module:ol/layer/Layer): T} callback Feature callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nMapRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n  const viewState = frameState.viewState;\n  const viewResolution = viewState.resolution;\n\n  /**\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n   * @param {module:ol/layer/Layer} layer Layer.\n   * @return {?} Callback result.\n   */\n  function forEachFeatureAtCoordinate(feature, layer) {\n    const key = getUid(feature).toString();\n    const managed = frameState.layerStates[getUid(layer)].managed;\n    if (!(key in frameState.skippedFeatureUids && !managed)) {\n      return callback.call(thisArg, feature, managed ? layer : null);\n    }\n  }\n\n  const projection = viewState.projection;\n\n  let translatedCoordinate = coordinate;\n  if (projection.canWrapX()) {\n    const projectionExtent = projection.getExtent();\n    const worldWidth = getWidth(projectionExtent);\n    const x = coordinate[0];\n    if (x < projectionExtent[0] || x > projectionExtent[2]) {\n      const worldsAway = Math.ceil((projectionExtent[0] - x) / worldWidth);\n      translatedCoordinate = [x + worldWidth * worldsAway, coordinate[1]];\n    }\n  }\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = this.getLayerRenderer(layer);\n      if (layer.getSource()) {\n        result = layerRenderer.forEachFeatureAtCoordinate(\n          layer.getSource().getWrapX() ? translatedCoordinate : coordinate,\n          frameState, hitTolerance, forEachFeatureAtCoordinate, thisArg);\n      }\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @abstract\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg,\n  layerFilter, thisArg2) {};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg Value to use as `this` when executing `layerFilter`.\n * @return {boolean} Is there a feature at the given coordinate?\n * @template U\n */\nMapRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, layerFilter, thisArg) {\n  const hasFeature = this.forEachFeatureAtCoordinate(\n    coordinate, frameState, hitTolerance, TRUE, this, layerFilter, thisArg);\n\n  return hasFeature !== undefined;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @protected\n * @return {module:ol/renderer/Layer} Layer renderer.\n */\nMapRenderer.prototype.getLayerRenderer = function(layer) {\n  const layerKey = getUid(layer).toString();\n  if (layerKey in this.layerRenderers_) {\n    return this.layerRenderers_[layerKey];\n  } else {\n    let renderer;\n    for (let i = 0, ii = this.layerRendererConstructors_.length; i < ii; ++i) {\n      const candidate = this.layerRendererConstructors_[i];\n      if (candidate['handles'](layer)) {\n        renderer = candidate['create'](this, layer);\n        break;\n      }\n    }\n    if (renderer) {\n      this.layerRenderers_[layerKey] = renderer;\n      this.layerRendererListeners_[layerKey] = listen(renderer,\n        EventType.CHANGE, this.handleLayerRendererChange_, this);\n    } else {\n      throw new Error('Unable to create renderer for layer: ' + layer.getType());\n    }\n    return renderer;\n  }\n};\n\n\n/**\n * @param {string} layerKey Layer key.\n * @protected\n * @return {module:ol/renderer/Layer} Layer renderer.\n */\nMapRenderer.prototype.getLayerRendererByKey = function(layerKey) {\n  return this.layerRenderers_[layerKey];\n};\n\n\n/**\n * @protected\n * @return {Object.<string, module:ol/renderer/Layer>} Layer renderers.\n */\nMapRenderer.prototype.getLayerRenderers = function() {\n  return this.layerRenderers_;\n};\n\n\n/**\n * @return {module:ol/PluggableMap} Map.\n */\nMapRenderer.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Handle changes in a layer renderer.\n * @private\n */\nMapRenderer.prototype.handleLayerRendererChange_ = function() {\n  this.map_.render();\n};\n\n\n/**\n * @param {string} layerKey Layer key.\n * @return {module:ol/renderer/Layer} Layer renderer.\n * @private\n */\nMapRenderer.prototype.removeLayerRendererByKey_ = function(layerKey) {\n  const layerRenderer = this.layerRenderers_[layerKey];\n  delete this.layerRenderers_[layerKey];\n\n  unlistenByKey(this.layerRendererListeners_[layerKey]);\n  delete this.layerRendererListeners_[layerKey];\n\n  return layerRenderer;\n};\n\n\n/**\n * Render.\n * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nMapRenderer.prototype.renderFrame = UNDEFINED;\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nMapRenderer.prototype.removeUnusedLayerRenderers_ = function(map, frameState) {\n  for (const layerKey in this.layerRenderers_) {\n    if (!frameState || !(layerKey in frameState.layerStates)) {\n      this.removeLayerRendererByKey_(layerKey).dispose();\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n */\nMapRenderer.prototype.scheduleExpireIconCache = function(frameState) {\n  frameState.postRenderFunctions.push(/** @type {module:ol/PluggableMap~PostRenderFunction} */ (expireIconCache));\n};\n\n\n/**\n * @param {!module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n */\nMapRenderer.prototype.scheduleRemoveUnusedLayerRenderers = function(frameState) {\n  for (const layerKey in this.layerRenderers_) {\n    if (!(layerKey in frameState.layerStates)) {\n      frameState.postRenderFunctions.push(\n        /** @type {module:ol/PluggableMap~PostRenderFunction} */ (this.removeUnusedLayerRenderers_.bind(this))\n      );\n      return;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/layer/Layer~State} state1 First layer state.\n * @param {module:ol/layer/Layer~State} state2 Second layer state.\n * @return {number} The zIndex difference.\n */\nexport function sortByZIndex(state1, state2) {\n  return state1.zIndex - state2.zIndex;\n}\nexport default MapRenderer;\n","/**\n * @module ol/renderer/canvas/Map\n */\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\nimport {inherits} from '../../index.js';\nimport {includes, stableSort} from '../../array.js';\nimport {CLASS_UNSELECTABLE} from '../../css.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {visibleAtResolution} from '../../layer/Layer.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport MapRenderer, {sortByZIndex} from '../Map.js';\nimport SourceState from '../../source/State.js';\n\n\n/**\n * @type {Array.<module:ol/renderer/Layer>}\n */\nexport const layerRendererConstructors = [];\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/Map}\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nconst CanvasMapRenderer = function(map) {\n  MapRenderer.call(this, map);\n\n  const container = map.getViewport();\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = this.context_.canvas;\n\n  this.canvas_.style.width = '100%';\n  this.canvas_.style.height = '100%';\n  this.canvas_.style.display = 'block';\n  this.canvas_.className = CLASS_UNSELECTABLE;\n  container.insertBefore(this.canvas_, container.childNodes[0] || null);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = createTransform();\n\n};\n\ninherits(CanvasMapRenderer, MapRenderer);\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nCanvasMapRenderer.prototype.dispatchComposeEvent_ = function(type, frameState) {\n  const map = this.getMap();\n  const context = this.context_;\n  if (map.hasListener(type)) {\n    const extent = frameState.extent;\n    const pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const rotation = viewState.rotation;\n\n    const transform = this.getTransform(frameState);\n\n    const vectorContext = new CanvasImmediateRenderer(context, pixelRatio,\n      extent, transform, rotation);\n    const composeEvent = new RenderEvent(type, vectorContext,\n      frameState, context, null);\n    map.dispatchEvent(composeEvent);\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n * @return {!module:ol/transform~Transform} Transform.\n */\nCanvasMapRenderer.prototype.getTransform = function(frameState) {\n  const viewState = frameState.viewState;\n  const dx1 = this.canvas_.width / 2;\n  const dy1 = this.canvas_.height / 2;\n  const sx = frameState.pixelRatio / viewState.resolution;\n  const sy = -sx;\n  const angle = -viewState.rotation;\n  const dx2 = -viewState.center[0];\n  const dy2 = -viewState.center[1];\n  return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.renderFrame = function(frameState) {\n\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.canvas_.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const context = this.context_;\n  const pixelRatio = frameState.pixelRatio;\n  const width = Math.round(frameState.size[0] * pixelRatio);\n  const height = Math.round(frameState.size[1] * pixelRatio);\n  if (this.canvas_.width != width || this.canvas_.height != height) {\n    this.canvas_.width = width;\n    this.canvas_.height = height;\n  } else {\n    context.clearRect(0, 0, width, height);\n  }\n\n  const rotation = frameState.viewState.rotation;\n\n  this.calculateMatrices2D(frameState);\n\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, frameState);\n\n  const layerStatesArray = frameState.layerStatesArray;\n  stableSort(layerStatesArray, sortByZIndex);\n\n  if (rotation) {\n    context.save();\n    rotateAtOffset(context, rotation, width / 2, height / 2);\n  }\n\n  const viewResolution = frameState.viewState.resolution;\n  let i, ii, layer, layerRenderer, layerState;\n  for (i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    layerState = layerStatesArray[i];\n    layer = layerState.layer;\n    layerRenderer = /** @type {module:ol/renderer/canvas/Layer} */ (this.getLayerRenderer(layer));\n    if (!visibleAtResolution(layerState, viewResolution) ||\n        layerState.sourceState != SourceState.READY) {\n      continue;\n    }\n    if (layerRenderer.prepareFrame(frameState, layerState)) {\n      layerRenderer.composeFrame(frameState, layerState, context);\n    }\n  }\n\n  if (rotation) {\n    context.restore();\n  }\n\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, frameState);\n\n  if (!this.renderedVisible_) {\n    this.canvas_.style.display = '';\n    this.renderedVisible_ = true;\n  }\n\n  this.scheduleRemoveUnusedLayerRenderers(frameState);\n  this.scheduleExpireIconCache(frameState);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n  const viewState = frameState.viewState;\n  const viewResolution = viewState.resolution;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n\n  const coordinate = applyTransform(\n    frameState.pixelToCoordinateTransform, pixel.slice());\n\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = /** @type {module:ol/renderer/canvas/Layer} */ (this.getLayerRenderer(layer));\n      result = layerRenderer.forEachLayerAtCoordinate(\n        coordinate, frameState, callback, thisArg);\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.registerLayerRenderers = function(constructors) {\n  MapRenderer.prototype.registerLayerRenderers.call(this, constructors);\n  for (let i = 0, ii = constructors.length; i < ii; ++i) {\n    const ctor = constructors[i];\n    if (!includes(layerRendererConstructors, ctor)) {\n      layerRendererConstructors.push(ctor);\n    }\n  }\n};\n\nexport default CanvasMapRenderer;\n","/**\n * @module ol/renderer/Layer\n */\nimport {getUid, inherits} from '../index.js';\nimport ImageState from '../ImageState.js';\nimport Observable from '../Observable.js';\nimport TileState from '../TileState.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {FALSE, UNDEFINED} from '../functions.js';\nimport SourceState from '../source/State.js';\n\n/**\n * @constructor\n * @extends {module:ol/Observable}\n * @param {module:ol/layer/Layer} layer Layer.\n * @struct\n */\nconst LayerRenderer = function(layer) {\n\n  Observable.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/layer/Layer}\n   */\n  this.layer_ = layer;\n\n\n};\n\ninherits(LayerRenderer, Observable);\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature), module:ol/layer/Layer): T}\n *     callback Feature callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T\n */\nLayerRenderer.prototype.forEachFeatureAtCoordinate = UNDEFINED;\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {boolean} Is there a feature at the given coordinate?\n */\nLayerRenderer.prototype.hasFeatureAtCoordinate = FALSE;\n\n\n/**\n * Create a function that adds loaded tiles to the tile lookup.\n * @param {module:ol/source/Tile} source Tile source.\n * @param {module:ol/proj/Projection} projection Projection of the tiles.\n * @param {Object.<number, Object.<string, module:ol/Tile>>} tiles Lookup of loaded tiles by zoom level.\n * @return {function(number, module:ol/TileRange):boolean} A function that can be\n *     called with a zoom level and a tile range to add loaded tiles to the lookup.\n * @protected\n */\nLayerRenderer.prototype.createLoadedTileFinder = function(source, projection, tiles) {\n  return (\n    /**\n     * @param {number} zoom Zoom level.\n     * @param {module:ol/TileRange} tileRange Tile range.\n     * @return {boolean} The tile range is fully loaded.\n     */\n    function(zoom, tileRange) {\n      function callback(tile) {\n        if (!tiles[zoom]) {\n          tiles[zoom] = {};\n        }\n        tiles[zoom][tile.tileCoord.toString()] = tile;\n      }\n      return source.forEachLoadedTile(projection, zoom, tileRange, callback);\n    }\n  );\n};\n\n\n/**\n * @return {module:ol/layer/Layer} Layer.\n */\nLayerRenderer.prototype.getLayer = function() {\n  return this.layer_;\n};\n\n\n/**\n * Handle changes in image state.\n * @param {module:ol/events/Event} event Image change event.\n * @private\n */\nLayerRenderer.prototype.handleImageChange_ = function(event) {\n  const image = /** @type {module:ol/Image} */ (event.target);\n  if (image.getState() === ImageState.LOADED) {\n    this.renderIfReadyAndVisible();\n  }\n};\n\n\n/**\n * Load the image if not already loaded, and register the image change\n * listener if needed.\n * @param {module:ol/ImageBase} image Image.\n * @return {boolean} `true` if the image is already loaded, `false` otherwise.\n * @protected\n */\nLayerRenderer.prototype.loadImage = function(image) {\n  let imageState = image.getState();\n  if (imageState != ImageState.LOADED && imageState != ImageState.ERROR) {\n    listen(image, EventType.CHANGE, this.handleImageChange_, this);\n  }\n  if (imageState == ImageState.IDLE) {\n    image.load();\n    imageState = image.getState();\n  }\n  return imageState == ImageState.LOADED;\n};\n\n\n/**\n * @protected\n */\nLayerRenderer.prototype.renderIfReadyAndVisible = function() {\n  const layer = this.getLayer();\n  if (layer.getVisible() && layer.getSourceState() == SourceState.READY) {\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @protected\n */\nLayerRenderer.prototype.scheduleExpireCache = function(frameState, tileSource) {\n  if (tileSource.canExpireCache()) {\n    /**\n     * @param {module:ol/source/Tile} tileSource Tile source.\n     * @param {module:ol/PluggableMap} map Map.\n     * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n     */\n    const postRenderFunction = function(tileSource, map, frameState) {\n      const tileSourceKey = getUid(tileSource).toString();\n      if (tileSourceKey in frameState.usedTiles) {\n        tileSource.expireCache(frameState.viewState.projection,\n          frameState.usedTiles[tileSourceKey]);\n      }\n    }.bind(null, tileSource);\n\n    frameState.postRenderFunctions.push(\n      /** @type {module:ol/PluggableMap~PostRenderFunction} */ (postRenderFunction)\n    );\n  }\n};\n\n\n/**\n * @param {!Object.<string, !Object.<string, module:ol/TileRange>>} usedTiles Used tiles.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @param {number} z Z.\n * @param {module:ol/TileRange} tileRange Tile range.\n * @protected\n */\nLayerRenderer.prototype.updateUsedTiles = function(usedTiles, tileSource, z, tileRange) {\n  // FIXME should we use tilesToDrawByZ instead?\n  const tileSourceKey = getUid(tileSource).toString();\n  const zKey = z.toString();\n  if (tileSourceKey in usedTiles) {\n    if (zKey in usedTiles[tileSourceKey]) {\n      usedTiles[tileSourceKey][zKey].extend(tileRange);\n    } else {\n      usedTiles[tileSourceKey][zKey] = tileRange;\n    }\n  } else {\n    usedTiles[tileSourceKey] = {};\n    usedTiles[tileSourceKey][zKey] = tileRange;\n  }\n};\n\n\n/**\n * Manage tile pyramid.\n * This function performs a number of functions related to the tiles at the\n * current zoom and lower zoom levels:\n * - registers idle tiles in frameState.wantedTiles so that they are not\n *   discarded by the tile queue\n * - enqueues missing tiles\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} currentZ Current Z.\n * @param {number} preload Load low resolution tiles up to 'preload' levels.\n * @param {function(this: T, module:ol/Tile)=} opt_tileCallback Tile callback.\n * @param {T=} opt_this Object to use as `this` in `opt_tileCallback`.\n * @protected\n * @template T\n */\nLayerRenderer.prototype.manageTilePyramid = function(\n  frameState, tileSource, tileGrid, pixelRatio, projection, extent,\n  currentZ, preload, opt_tileCallback, opt_this) {\n  const tileSourceKey = getUid(tileSource).toString();\n  if (!(tileSourceKey in frameState.wantedTiles)) {\n    frameState.wantedTiles[tileSourceKey] = {};\n  }\n  const wantedTiles = frameState.wantedTiles[tileSourceKey];\n  const tileQueue = frameState.tileQueue;\n  const minZoom = tileGrid.getMinZoom();\n  let tile, tileRange, tileResolution, x, y, z;\n  for (z = minZoom; z <= currentZ; ++z) {\n    tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, tileRange);\n    tileResolution = tileGrid.getResolution(z);\n    for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        if (currentZ - z <= preload) {\n          tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n          if (tile.getState() == TileState.IDLE) {\n            wantedTiles[tile.getKey()] = true;\n            if (!tileQueue.isKeyQueued(tile.getKey())) {\n              tileQueue.enqueue([tile, tileSourceKey,\n                tileGrid.getTileCoordCenter(tile.tileCoord), tileResolution]);\n            }\n          }\n          if (opt_tileCallback !== undefined) {\n            opt_tileCallback.call(opt_this, tile);\n          }\n        } else {\n          tileSource.useTile(z, x, y, projection);\n        }\n      }\n    }\n  }\n};\nexport default LayerRenderer;\n","/**\n * @module ol/renderer/canvas/Layer\n */\nimport {inherits} from '../../index.js';\nimport {getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../../extent.js';\nimport {TRUE} from '../../functions.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport LayerRenderer from '../Layer.js';\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/Layer}\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst CanvasLayerRenderer = function(layer) {\n\n  LayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.renderedResolution;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = createTransform();\n\n};\n\ninherits(CanvasLayerRenderer, LayerRenderer);\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/extent~Extent} extent Clip extent.\n * @protected\n */\nCanvasLayerRenderer.prototype.clip = function(context, frameState, extent) {\n  const pixelRatio = frameState.pixelRatio;\n  const width = frameState.size[0] * pixelRatio;\n  const height = frameState.size[1] * pixelRatio;\n  const rotation = frameState.viewState.rotation;\n  const topLeft = getTopLeft(/** @type {module:ol/extent~Extent} */ (extent));\n  const topRight = getTopRight(/** @type {module:ol/extent~Extent} */ (extent));\n  const bottomRight = getBottomRight(/** @type {module:ol/extent~Extent} */ (extent));\n  const bottomLeft = getBottomLeft(/** @type {module:ol/extent~Extent} */ (extent));\n\n  applyTransform(frameState.coordinateToPixelTransform, topLeft);\n  applyTransform(frameState.coordinateToPixelTransform, topRight);\n  applyTransform(frameState.coordinateToPixelTransform, bottomRight);\n  applyTransform(frameState.coordinateToPixelTransform, bottomLeft);\n\n  context.save();\n  rotateAtOffset(context, -rotation, width / 2, height / 2);\n  context.beginPath();\n  context.moveTo(topLeft[0] * pixelRatio, topLeft[1] * pixelRatio);\n  context.lineTo(topRight[0] * pixelRatio, topRight[1] * pixelRatio);\n  context.lineTo(bottomRight[0] * pixelRatio, bottomRight[1] * pixelRatio);\n  context.lineTo(bottomLeft[0] * pixelRatio, bottomLeft[1] * pixelRatio);\n  context.clip();\n  rotateAtOffset(context, rotation, width / 2, height / 2);\n};\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @private\n */\nCanvasLayerRenderer.prototype.dispatchComposeEvent_ = function(type, context, frameState, opt_transform) {\n  const layer = this.getLayer();\n  if (layer.hasListener(type)) {\n    const width = frameState.size[0] * frameState.pixelRatio;\n    const height = frameState.size[1] * frameState.pixelRatio;\n    const rotation = frameState.viewState.rotation;\n    rotateAtOffset(context, -rotation, width / 2, height / 2);\n    const transform = opt_transform !== undefined ?\n      opt_transform : this.getTransform(frameState, 0);\n    const render = new CanvasImmediateRenderer(\n      context, frameState.pixelRatio, frameState.extent, transform,\n      frameState.viewState.rotation);\n    const composeEvent = new RenderEvent(type, render, frameState,\n      context, null);\n    layer.dispatchEvent(composeEvent);\n    rotateAtOffset(context, rotation, width / 2, height / 2);\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nCanvasLayerRenderer.prototype.forEachLayerAtCoordinate = function(coordinate, frameState, callback, thisArg) {\n  const hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, 0, TRUE, this);\n\n  if (hasFeature) {\n    return callback.call(thisArg, this.getLayer(), null);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.postCompose = function(context, frameState, layerState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.preCompose = function(context, frameState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.dispatchRenderEvent = function(context, frameState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.RENDER, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} offsetX Offset on the x-axis in view coordinates.\n * @protected\n * @return {!module:ol/transform~Transform} Transform.\n */\nCanvasLayerRenderer.prototype.getTransform = function(frameState, offsetX) {\n  const viewState = frameState.viewState;\n  const pixelRatio = frameState.pixelRatio;\n  const dx1 = pixelRatio * frameState.size[0] / 2;\n  const dy1 = pixelRatio * frameState.size[1] / 2;\n  const sx = pixelRatio / viewState.resolution;\n  const sy = -sx;\n  const angle = -viewState.rotation;\n  const dx2 = -viewState.center[0] + offsetX;\n  const dy2 = -viewState.center[1];\n  return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n};\n\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {CanvasRenderingContext2D} context Context.\n */\nCanvasLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {};\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @return {boolean} whether composeFrame should be called.\n */\nCanvasLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {};\nexport default CanvasLayerRenderer;\n","/**\n * @module ol/renderer/canvas/IntermediateCanvas\n */\nimport {inherits} from '../../index.js';\nimport {scale as scaleCoordinate} from '../../coordinate.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, intersects} from '../../extent.js';\nimport {UNDEFINED} from '../../functions.js';\nimport CanvasLayerRenderer from '../canvas/Layer.js';\nimport {create as createTransform, apply as applyTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/canvas/Layer}\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst IntermediateCanvasRenderer = function(layer) {\n\n  CanvasLayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {module:ol/transform~Transform}\n   */\n  this.coordinateToCanvasPixelTransform = createTransform();\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitCanvasContext_ = null;\n\n};\n\ninherits(IntermediateCanvasRenderer, CanvasLayerRenderer);\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n\n  this.preCompose(context, frameState);\n\n  const image = this.getImage();\n  if (image) {\n\n    // clipped rendering if layer extent is set\n    const extent = layerState.extent;\n    const clipped = extent !== undefined &&\n        !containsExtent(extent, frameState.extent) &&\n        intersects(extent, frameState.extent);\n    if (clipped) {\n      this.clip(context, frameState, /** @type {module:ol/extent~Extent} */ (extent));\n    }\n\n    const imageTransform = this.getImageTransform();\n    // for performance reasons, context.save / context.restore is not used\n    // to save and restore the transformation matrix and the opacity.\n    // see http://jsperf.com/context-save-restore-versus-variable\n    const alpha = context.globalAlpha;\n    context.globalAlpha = layerState.opacity;\n\n    // for performance reasons, context.setTransform is only used\n    // when the view is rotated. see http://jsperf.com/canvas-transform\n    const dx = imageTransform[4];\n    const dy = imageTransform[5];\n    const dw = image.width * imageTransform[0];\n    const dh = image.height * imageTransform[3];\n    context.drawImage(image, 0, 0, +image.width, +image.height,\n      Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n    context.globalAlpha = alpha;\n\n    if (clipped) {\n      context.restore();\n    }\n  }\n\n  this.postCompose(context, frameState, layerState);\n};\n\n\n/**\n * @abstract\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Canvas.\n */\nIntermediateCanvasRenderer.prototype.getImage = function() {};\n\n\n/**\n * @abstract\n * @return {!module:ol/transform~Transform} Image transform.\n */\nIntermediateCanvasRenderer.prototype.getImageTransform = function() {};\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const layer = this.getLayer();\n  const source = layer.getSource();\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  const skippedFeatureUids = frameState.skippedFeatureUids;\n  return source.forEachFeatureAtCoordinate(\n    coordinate, resolution, rotation, hitTolerance, skippedFeatureUids,\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {?} Callback result.\n     */\n    function(feature) {\n      return callback.call(thisArg, feature, layer);\n    });\n};\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.forEachLayerAtCoordinate = function(coordinate, frameState, callback, thisArg) {\n  if (!this.getImage()) {\n    return undefined;\n  }\n\n  if (this.getLayer().getSource().forEachFeatureAtCoordinate !== UNDEFINED) {\n    // for ImageCanvas sources use the original hit-detection logic,\n    // so that for example also transparent polygons are detected\n    return CanvasLayerRenderer.prototype.forEachLayerAtCoordinate.apply(this, arguments);\n  } else {\n    const pixel = applyTransform(this.coordinateToCanvasPixelTransform, coordinate.slice());\n    scaleCoordinate(pixel, frameState.viewState.resolution / this.renderedResolution);\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.getImage(), pixel[0], pixel[1], 1, 1, 0, 0, 1, 1);\n\n    const imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(),  imageData);\n    } else {\n      return undefined;\n    }\n  }\n};\nexport default IntermediateCanvasRenderer;\n","/**\n * @module ol/renderer/canvas/ImageLayer\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../../reproj/common.js';\nimport {inherits} from '../../index.js';\nimport ImageCanvas from '../../ImageCanvas.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {equals} from '../../array.js';\nimport {getHeight, getIntersection, getWidth, isEmpty} from '../../extent.js';\nimport VectorRenderType from '../../layer/VectorRenderType.js';\nimport {assign} from '../../obj.js';\nimport {layerRendererConstructors} from './Map.js';\nimport IntermediateCanvasRenderer from '../canvas/IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/IntermediateCanvas}\n * @param {module:ol/layer/Image|module:ol/layer/Vector} imageLayer Image or vector layer.\n * @api\n */\nconst CanvasImageLayerRenderer = function(imageLayer) {\n\n  IntermediateCanvasRenderer.call(this, imageLayer);\n\n  /**\n   * @private\n   * @type {?module:ol/ImageBase}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.imageTransform_ = createTransform();\n\n  /**\n   * @type {!Array.<string>}\n   */\n  this.skippedFeatures_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/renderer/canvas/VectorLayer}\n   */\n  this.vectorRenderer_ = null;\n\n  if (imageLayer.getType() === LayerType.VECTOR) {\n    for (let i = 0, ii = layerRendererConstructors.length; i < ii; ++i) {\n      const ctor = layerRendererConstructors[i];\n      if (ctor !== CanvasImageLayerRenderer && ctor['handles'](imageLayer)) {\n        this.vectorRenderer_ = new ctor(imageLayer);\n        break;\n      }\n    }\n  }\n\n};\n\ninherits(CanvasImageLayerRenderer, IntermediateCanvasRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasImageLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.IMAGE ||\n    layer.getType() === LayerType.VECTOR &&\n    /** @type {module:ol/layer/Vector} */ (layer).getRenderMode() === VectorRenderType.IMAGE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/ImageLayer} The layer renderer.\n */\nCanvasImageLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasImageLayerRenderer(/** @type {module:ol/layer/Image} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.disposeInternal = function() {\n  if (this.vectorRenderer_) {\n    this.vectorRenderer_.dispose();\n  }\n  IntermediateCanvasRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.getImage = function() {\n  return !this.image_ ? null : this.image_.getImage();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.getImageTransform = function() {\n  return this.imageTransform_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n\n  const pixelRatio = frameState.pixelRatio;\n  const size = frameState.size;\n  const viewState = frameState.viewState;\n  const viewCenter = viewState.center;\n  const viewResolution = viewState.resolution;\n\n  let image;\n  const imageLayer = /** @type {module:ol/layer/Image} */ (this.getLayer());\n  const imageSource = imageLayer.getSource();\n\n  const hints = frameState.viewHints;\n\n  const vectorRenderer = this.vectorRenderer_;\n  let renderedExtent = frameState.extent;\n  if (!vectorRenderer && layerState.extent !== undefined) {\n    renderedExtent = getIntersection(renderedExtent, layerState.extent);\n  }\n\n  if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] &&\n      !isEmpty(renderedExtent)) {\n    let projection = viewState.projection;\n    if (!ENABLE_RASTER_REPROJECTION) {\n      const sourceProjection = imageSource.getProjection();\n      if (sourceProjection) {\n        projection = sourceProjection;\n      }\n    }\n    let skippedFeatures = this.skippedFeatures_;\n    if (vectorRenderer) {\n      const context = vectorRenderer.context;\n      const imageFrameState = /** @type {module:ol/PluggableMap~FrameState} */ (assign({}, frameState, {\n        size: [\n          getWidth(renderedExtent) / viewResolution,\n          getHeight(renderedExtent) / viewResolution\n        ],\n        viewState: /** @type {module:ol/View~State} */ (assign({}, frameState.viewState, {\n          rotation: 0\n        }))\n      }));\n      const newSkippedFeatures = Object.keys(imageFrameState.skippedFeatureUids).sort();\n      image = new ImageCanvas(renderedExtent, viewResolution, pixelRatio, context.canvas, function(callback) {\n        if (vectorRenderer.prepareFrame(imageFrameState, layerState) &&\n            (vectorRenderer.replayGroupChanged ||\n            !equals(skippedFeatures, newSkippedFeatures))) {\n          context.canvas.width = imageFrameState.size[0] * pixelRatio;\n          context.canvas.height = imageFrameState.size[1] * pixelRatio;\n          vectorRenderer.compose(context, imageFrameState, layerState);\n          skippedFeatures = newSkippedFeatures;\n          callback();\n        }\n      });\n    } else {\n      image = imageSource.getImage(\n        renderedExtent, viewResolution, pixelRatio, projection);\n    }\n    if (image && this.loadImage(image)) {\n      this.image_ = image;\n      this.skippedFeatures_ = skippedFeatures;\n    }\n  }\n\n  if (this.image_) {\n    image = this.image_;\n    const imageExtent = image.getExtent();\n    const imageResolution = image.getResolution();\n    const imagePixelRatio = image.getPixelRatio();\n    const scale = pixelRatio * imageResolution /\n        (viewResolution * imagePixelRatio);\n    const transform = composeTransform(this.imageTransform_,\n      pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n      scale, scale,\n      0,\n      imagePixelRatio * (imageExtent[0] - viewCenter[0]) / imageResolution,\n      imagePixelRatio * (viewCenter[1] - imageExtent[3]) / imageResolution);\n    composeTransform(this.coordinateToCanvasPixelTransform,\n      pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n      pixelRatio / viewResolution, -pixelRatio / viewResolution,\n      0,\n      -viewCenter[0], -viewCenter[1]);\n\n    this.renderedResolution = imageResolution * pixelRatio / imagePixelRatio;\n  }\n\n  return !!this.image_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (this.vectorRenderer_) {\n    return this.vectorRenderer_.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, thisArg);\n  } else {\n    return IntermediateCanvasRenderer.prototype.forEachFeatureAtCoordinate.call(this, coordinate, frameState, hitTolerance, callback, thisArg);\n  }\n};\n\n\nexport default CanvasImageLayerRenderer;\n","/**\n * @module ol/TileRange\n */\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n *\n * @constructor\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @struct\n */\nconst TileRange = function(minX, maxX, minY, maxY) {\n\n  /**\n   * @type {number}\n   */\n  this.minX = minX;\n\n  /**\n   * @type {number}\n   */\n  this.maxX = maxX;\n\n  /**\n   * @type {number}\n   */\n  this.minY = minY;\n\n  /**\n   * @type {number}\n   */\n  this.maxY = maxY;\n\n};\n\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {module:ol/TileRange=} tileRange TileRange.\n * @return {module:ol/TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  } else {\n    return new TileRange(minX, maxX, minY, maxY);\n  }\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @return {boolean} Contains tile coordinate.\n */\nTileRange.prototype.contains = function(tileCoord) {\n  return this.containsXY(tileCoord[1], tileCoord[2]);\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Contains.\n */\nTileRange.prototype.containsTileRange = function(tileRange) {\n  return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX &&\n      this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;\n};\n\n\n/**\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @return {boolean} Contains coordinate.\n */\nTileRange.prototype.containsXY = function(x, y) {\n  return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Equals.\n */\nTileRange.prototype.equals = function(tileRange) {\n  return this.minX == tileRange.minX && this.minY == tileRange.minY &&\n      this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n */\nTileRange.prototype.extend = function(tileRange) {\n  if (tileRange.minX < this.minX) {\n    this.minX = tileRange.minX;\n  }\n  if (tileRange.maxX > this.maxX) {\n    this.maxX = tileRange.maxX;\n  }\n  if (tileRange.minY < this.minY) {\n    this.minY = tileRange.minY;\n  }\n  if (tileRange.maxY > this.maxY) {\n    this.maxY = tileRange.maxY;\n  }\n};\n\n\n/**\n * @return {number} Height.\n */\nTileRange.prototype.getHeight = function() {\n  return this.maxY - this.minY + 1;\n};\n\n\n/**\n * @return {module:ol/size~Size} Size.\n */\nTileRange.prototype.getSize = function() {\n  return [this.getWidth(), this.getHeight()];\n};\n\n\n/**\n * @return {number} Width.\n */\nTileRange.prototype.getWidth = function() {\n  return this.maxX - this.minX + 1;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Intersects.\n */\nTileRange.prototype.intersects = function(tileRange) {\n  return this.minX <= tileRange.maxX &&\n      this.maxX >= tileRange.minX &&\n      this.minY <= tileRange.maxY &&\n      this.maxY >= tileRange.minY;\n};\nexport default TileRange;\n","/**\n * @module ol/renderer/canvas/TileLayer\n */\nimport {getUid, inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, createEmpty, equals, getIntersection, isEmpty} from '../../extent.js';\nimport IntermediateCanvasRenderer from '../canvas/IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/IntermediateCanvas}\n * @param {module:ol/layer/Tile|module:ol/layer/VectorTile} tileLayer Tile layer.\n * @api\n */\nconst CanvasTileLayerRenderer = function(tileLayer) {\n\n  IntermediateCanvasRenderer.call(this, tileLayer);\n\n  /**\n   * @protected\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = this.context === null ? null : createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.oversampling_;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = null;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.renderedRevision;\n\n  /**\n   * @protected\n   * @type {!Array.<module:ol/Tile>}\n   */\n  this.renderedTiles = [];\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.newTiles_ = false;\n\n  /**\n   * @protected\n   * @type {module:ol/extent~Extent}\n   */\n  this.tmpExtent = createEmpty();\n\n  /**\n   * @private\n   * @type {module:ol/TileRange}\n   */\n  this.tmpTileRange_ = new TileRange(0, 0, 0, 0);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.imageTransform_ = createTransform();\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.zDirection = 0;\n\n};\n\ninherits(CanvasTileLayerRenderer, IntermediateCanvasRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/TileLayer} The layer renderer.\n */\nCanvasTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasTileLayerRenderer(/** @type {module:ol/layer/Tile} */ (layer));\n};\n\n\n/**\n * @private\n * @param {module:ol/Tile} tile Tile.\n * @return {boolean} Tile is drawable.\n */\nCanvasTileLayerRenderer.prototype.isDrawableTile_ = function(tile) {\n  const tileState = tile.getState();\n  const useInterimTilesOnError = this.getLayer().getUseInterimTilesOnError();\n  return tileState == TileState.LOADED ||\n      tileState == TileState.EMPTY ||\n      tileState == TileState.ERROR && !useInterimTilesOnError;\n};\n\n\n/**\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/Tile} Tile.\n */\nCanvasTileLayerRenderer.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const source = /** @type {module:ol/source/Tile} */ (layer.getSource());\n  let tile = source.getTile(z, x, y, pixelRatio, projection);\n  if (tile.getState() == TileState.ERROR) {\n    if (!layer.getUseInterimTilesOnError()) {\n      // When useInterimTilesOnError is false, we consider the error tile as loaded.\n      tile.setState(TileState.LOADED);\n    } else if (layer.getPreload() > 0) {\n      // Preloaded tiles for lower resolutions might have finished loading.\n      this.newTiles_ = true;\n    }\n  }\n  if (!this.isDrawableTile_(tile)) {\n    tile = tile.getInterimTile();\n  }\n  return tile;\n};\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n\n  const pixelRatio = frameState.pixelRatio;\n  const size = frameState.size;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const viewResolution = viewState.resolution;\n  const viewCenter = viewState.center;\n\n  const tileLayer = this.getLayer();\n  const tileSource = /** @type {module:ol/source/Tile} */ (tileLayer.getSource());\n  const sourceRevision = tileSource.getRevision();\n  const tileGrid = tileSource.getTileGridForProjection(projection);\n  const z = tileGrid.getZForResolution(viewResolution, this.zDirection);\n  const tileResolution = tileGrid.getResolution(z);\n  let oversampling = Math.round(viewResolution / tileResolution) || 1;\n  let extent = frameState.extent;\n\n  if (layerState.extent !== undefined) {\n    extent = getIntersection(extent, layerState.extent);\n  }\n  if (isEmpty(extent)) {\n    // Return false to prevent the rendering of the layer.\n    return false;\n  }\n\n  const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n  const imageExtent = tileGrid.getTileRangeExtent(z, tileRange);\n\n  const tilePixelRatio = tileSource.getTilePixelRatio(pixelRatio);\n\n  /**\n   * @type {Object.<number, Object.<string, module:ol/Tile>>}\n   */\n  const tilesToDrawByZ = {};\n  tilesToDrawByZ[z] = {};\n\n  const findLoadedTiles = this.createLoadedTileFinder(\n    tileSource, projection, tilesToDrawByZ);\n\n  const hints = frameState.viewHints;\n  const animatingOrInteracting = hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING];\n\n  const tmpExtent = this.tmpExtent;\n  const tmpTileRange = this.tmpTileRange_;\n  this.newTiles_ = false;\n  let tile, x, y;\n  for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n    for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n      if (Date.now() - frameState.time > 16 && animatingOrInteracting) {\n        continue;\n      }\n      tile = this.getTile(z, x, y, pixelRatio, projection);\n      if (this.isDrawableTile_(tile)) {\n        const uid = getUid(this);\n        if (tile.getState() == TileState.LOADED) {\n          tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n          const inTransition = tile.inTransition(uid);\n          if (!this.newTiles_ && (inTransition || this.renderedTiles.indexOf(tile) === -1)) {\n            this.newTiles_ = true;\n          }\n        }\n        if (tile.getAlpha(uid, frameState.time) === 1) {\n          // don't look for alt tiles if alpha is 1\n          continue;\n        }\n      }\n\n      const childTileRange = tileGrid.getTileCoordChildTileRange(\n        tile.tileCoord, tmpTileRange, tmpExtent);\n      let covered = false;\n      if (childTileRange) {\n        covered = findLoadedTiles(z + 1, childTileRange);\n      }\n      if (!covered) {\n        tileGrid.forEachTileCoordParentTileRange(\n          tile.tileCoord, findLoadedTiles, null, tmpTileRange, tmpExtent);\n      }\n\n    }\n  }\n\n  const renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n  if (!(this.renderedResolution && Date.now() - frameState.time > 16 && animatingOrInteracting) && (\n    this.newTiles_ ||\n        !(this.renderedExtent_ && containsExtent(this.renderedExtent_, extent)) ||\n        this.renderedRevision != sourceRevision ||\n        oversampling != this.oversampling_ ||\n        !animatingOrInteracting && renderedResolution != this.renderedResolution\n  )) {\n\n    const context = this.context;\n    if (context) {\n      const tilePixelSize = tileSource.getTilePixelSize(z, pixelRatio, projection);\n      const width = Math.round(tileRange.getWidth() * tilePixelSize[0] / oversampling);\n      const height = Math.round(tileRange.getHeight() * tilePixelSize[1] / oversampling);\n      const canvas = context.canvas;\n      if (canvas.width != width || canvas.height != height) {\n        this.oversampling_ = oversampling;\n        canvas.width = width;\n        canvas.height = height;\n      } else {\n        if (this.renderedExtent_ && !equals(imageExtent, this.renderedExtent_)) {\n          context.clearRect(0, 0, width, height);\n        }\n        oversampling = this.oversampling_;\n      }\n    }\n\n    this.renderedTiles.length = 0;\n    /** @type {Array.<number>} */\n    const zs = Object.keys(tilesToDrawByZ).map(Number);\n    zs.sort(function(a, b) {\n      if (a === z) {\n        return 1;\n      } else if (b === z) {\n        return -1;\n      } else {\n        return a > b ? 1 : a < b ? -1 : 0;\n      }\n    });\n    let currentResolution, currentScale, currentTilePixelSize, currentZ, i, ii;\n    let tileExtent, tileGutter, tilesToDraw, w, h;\n    for (i = 0, ii = zs.length; i < ii; ++i) {\n      currentZ = zs[i];\n      currentTilePixelSize = tileSource.getTilePixelSize(currentZ, pixelRatio, projection);\n      currentResolution = tileGrid.getResolution(currentZ);\n      currentScale = currentResolution / tileResolution;\n      tileGutter = tilePixelRatio * tileSource.getGutter(projection);\n      tilesToDraw = tilesToDrawByZ[currentZ];\n      for (const tileCoordKey in tilesToDraw) {\n        tile = tilesToDraw[tileCoordKey];\n        tileExtent = tileGrid.getTileCoordExtent(tile.getTileCoord(), tmpExtent);\n        x = (tileExtent[0] - imageExtent[0]) / tileResolution * tilePixelRatio / oversampling;\n        y = (imageExtent[3] - tileExtent[3]) / tileResolution * tilePixelRatio / oversampling;\n        w = currentTilePixelSize[0] * currentScale / oversampling;\n        h = currentTilePixelSize[1] * currentScale / oversampling;\n        this.drawTileImage(tile, frameState, layerState, x, y, w, h, tileGutter, z === currentZ);\n        this.renderedTiles.push(tile);\n      }\n    }\n\n    this.renderedRevision = sourceRevision;\n    this.renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n    this.renderedExtent_ = imageExtent;\n  }\n\n  const scale = this.renderedResolution / viewResolution;\n  const transform = composeTransform(this.imageTransform_,\n    pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n    scale, scale,\n    0,\n    (this.renderedExtent_[0] - viewCenter[0]) / this.renderedResolution * pixelRatio,\n    (viewCenter[1] - this.renderedExtent_[3]) / this.renderedResolution * pixelRatio);\n  composeTransform(this.coordinateToCanvasPixelTransform,\n    pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n    pixelRatio / viewResolution, -pixelRatio / viewResolution,\n    0,\n    -viewCenter[0], -viewCenter[1]);\n\n\n  this.updateUsedTiles(frameState.usedTiles, tileSource, z, tileRange);\n  this.manageTilePyramid(frameState, tileSource, tileGrid, pixelRatio,\n    projection, extent, z, tileLayer.getPreload());\n  this.scheduleExpireCache(frameState, tileSource);\n\n  return this.renderedTiles.length > 0;\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {number} x Left of the tile.\n * @param {number} y Top of the tile.\n * @param {number} w Width of the tile.\n * @param {number} h Height of the tile.\n * @param {number} gutter Tile gutter.\n * @param {boolean} transition Apply an alpha transition.\n */\nCanvasTileLayerRenderer.prototype.drawTileImage = function(tile, frameState, layerState, x, y, w, h, gutter, transition) {\n  const image = tile.getImage(this.getLayer());\n  if (!image) {\n    return;\n  }\n  const uid = getUid(this);\n  const alpha = transition ? tile.getAlpha(uid, frameState.time) : 1;\n  if (alpha === 1 && !this.getLayer().getSource().getOpaque(frameState.viewState.projection)) {\n    this.context.clearRect(x, y, w, h);\n  }\n  const alphaChanged = alpha !== this.context.globalAlpha;\n  if (alphaChanged) {\n    this.context.save();\n    this.context.globalAlpha = alpha;\n  }\n  this.context.drawImage(image, gutter, gutter,\n    image.width - 2 * gutter, image.height - 2 * gutter, x, y, w, h);\n\n  if (alphaChanged) {\n    this.context.restore();\n  }\n  if (alpha !== 1) {\n    frameState.animate = true;\n  } else if (transition) {\n    tile.endTransition(uid);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.getImage = function() {\n  const context = this.context;\n  return context ? context.canvas : null;\n};\n\n\n/**\n * @function\n * @return {module:ol/layer/Tile|module:ol/layer/VectorTile}\n */\nCanvasTileLayerRenderer.prototype.getLayer;\n\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.getImageTransform = function() {\n  return this.imageTransform_;\n};\nexport default CanvasTileLayerRenderer;\n","/**\n * @module ol/render/ReplayGroup\n */\n/**\n * Base class for replay groups.\n * @constructor\n * @abstract\n */\nconst ReplayGroup = function() {};\n\n\n/**\n * @abstract\n * @param {number|undefined} zIndex Z index.\n * @param {module:ol/render/ReplayType} replayType Replay type.\n * @return {module:ol/render/VectorContext} Replay.\n */\nReplayGroup.prototype.getReplay = function(zIndex, replayType) {};\n\n\n/**\n * @abstract\n * @return {boolean} Is empty.\n */\nReplayGroup.prototype.isEmpty = function() {};\nexport default ReplayGroup;\n","/**\n * @module ol/render/ReplayType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CIRCLE: 'Circle',\n  DEFAULT: 'Default',\n  IMAGE: 'Image',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  TEXT: 'Text'\n};\n","/**\n * @module ol/geom/flat/textpath\n */\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Path to put text on.\n * @param {number} offset Start offset of the `flatCoordinates`.\n * @param {number} end End offset of the `flatCoordinates`.\n * @param {number} stride Stride.\n * @param {string} text Text to place on the path.\n * @param {function(string):number} measure Measure function returning the\n * width of the character passed as 1st argument.\n * @param {number} startM m along the path where the text starts.\n * @param {number} maxAngle Max angle between adjacent chars in radians.\n * @return {Array.<Array.<*>>} The result array of null if `maxAngle` was\n * exceeded. Entries of the array are x, y, anchorX, angle, chunk.\n */\nexport function drawTextOnPath(\n  flatCoordinates, offset, end, stride, text, measure, startM, maxAngle) {\n  const result = [];\n\n  // Keep text upright\n  const reverse = flatCoordinates[offset] > flatCoordinates[end - stride];\n\n  const numChars = text.length;\n\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  offset += stride;\n  let x2 = flatCoordinates[offset];\n  let y2 = flatCoordinates[offset + 1];\n  let segmentM = 0;\n  let segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n\n  let chunk = '';\n  let chunkLength = 0;\n  let data, index, previousAngle;\n  for (let i = 0; i < numChars; ++i) {\n    index = reverse ? numChars - i - 1 : i;\n    const char = text.charAt(index);\n    chunk = reverse ? char + chunk : chunk + char;\n    const charLength = measure(chunk) - chunkLength;\n    chunkLength += charLength;\n    const charM = startM + charLength / 2;\n    while (offset < end - stride && segmentM + segmentLength < charM) {\n      x1 = x2;\n      y1 = y2;\n      offset += stride;\n      x2 = flatCoordinates[offset];\n      y2 = flatCoordinates[offset + 1];\n      segmentM += segmentLength;\n      segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    }\n    const segmentPos = charM - segmentM;\n    let angle = Math.atan2(y2 - y1, x2 - x1);\n    if (reverse) {\n      angle += angle > 0 ? -Math.PI : Math.PI;\n    }\n    if (previousAngle !== undefined) {\n      let delta = angle - previousAngle;\n      delta += (delta > Math.PI) ? -2 * Math.PI : (delta < -Math.PI) ? 2 * Math.PI : 0;\n      if (Math.abs(delta) > maxAngle) {\n        return null;\n      }\n    }\n    const interpolate = segmentPos / segmentLength;\n    const x = lerp(x1, x2, interpolate);\n    const y = lerp(y1, y2, interpolate);\n    if (previousAngle == angle) {\n      if (reverse) {\n        data[0] = x;\n        data[1] = y;\n        data[2] = charLength / 2;\n      }\n      data[4] = chunk;\n    } else {\n      chunk = char;\n      chunkLength = charLength;\n      data = [x, y, charLength / 2, angle, chunk];\n      if (reverse) {\n        result.unshift(data);\n      } else {\n        result.push(data);\n      }\n      previousAngle = angle;\n    }\n    startM += charLength;\n  }\n  return result;\n}\n","/**\n * @module ol/render/canvas/Instruction\n */\n\n/**\n * @enum {number}\n */\nconst Instruction = {\n  BEGIN_GEOMETRY: 0,\n  BEGIN_PATH: 1,\n  CIRCLE: 2,\n  CLOSE_PATH: 3,\n  CUSTOM: 4,\n  DRAW_CHARS: 5,\n  DRAW_IMAGE: 6,\n  END_GEOMETRY: 7,\n  FILL: 8,\n  MOVE_TO_LINE_TO: 9,\n  SET_FILL_STYLE: 10,\n  SET_STROKE_STYLE: 11,\n  STROKE: 12\n};\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const fillInstruction = [Instruction.FILL];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const strokeInstruction = [Instruction.STROKE];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const beginPathInstruction = [Instruction.BEGIN_PATH];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const closePathInstruction = [Instruction.CLOSE_PATH];\n\n\nexport default Instruction;\n","/**\n * @module ol/render/replay\n */\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * @const\n * @type {Array.<module:ol/render/ReplayType>}\n */\nexport const ORDER = [\n  ReplayType.POLYGON,\n  ReplayType.CIRCLE,\n  ReplayType.LINE_STRING,\n  ReplayType.IMAGE,\n  ReplayType.TEXT,\n  ReplayType.DEFAULT\n];\n\n/**\n * @const\n * @enum {number}\n */\nexport const TEXT_ALIGN = {};\nTEXT_ALIGN['left'] = 0;\nTEXT_ALIGN['end'] = 0;\nTEXT_ALIGN['center'] = 0.5;\nTEXT_ALIGN['right'] = 1;\nTEXT_ALIGN['start'] = 1;\nTEXT_ALIGN['top'] = 0;\nTEXT_ALIGN['middle'] = 0.5;\nTEXT_ALIGN['hanging'] = 0.2;\nTEXT_ALIGN['alphabetic'] = 0.8;\nTEXT_ALIGN['ideographic'] = 0.8;\nTEXT_ALIGN['bottom'] = 1;\n","/**\n * @module ol/render/canvas/Replay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {UNDEFINED} from '../../functions.js';\nimport {equals, reverseSubArray} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {buffer, clone, coordinateRelationship, createEmpty, createOrUpdate,\n  createOrUpdateEmpty, extend, extendCoordinate, intersects} from '../../extent.js';\nimport Relationship from '../../extent/Relationship.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {inflateCoordinates, inflateCoordinatesArray, inflateMultiCoordinatesArray} from '../../geom/flat/inflate.js';\nimport {lineStringLength} from '../../geom/flat/length.js';\nimport {drawTextOnPath} from '../../geom/flat/textpath.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {isEmpty} from '../../obj.js';\nimport VectorContext from '../VectorContext.js';\nimport {drawImage, resetTransform, defaultPadding, defaultFillStyle, defaultStrokeStyle,\n  defaultMiterLimit, defaultLineWidth, defaultLineJoin, defaultLineDashOffset,\n  defaultLineDash, defaultLineCap} from '../canvas.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  apply as applyTransform,\n  setFromArray as transformSetFromArray\n} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasReplay = function(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  VectorContext.call(this);\n\n  /**\n   * @type {?}\n   */\n  this.declutterTree = declutterTree;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.tolerance = tolerance;\n\n  /**\n   * @protected\n   * @const\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent = maxExtent;\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.overlaps = overlaps;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.pixelRatio = pixelRatio;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.maxLineWidth = 0;\n\n  /**\n   * @protected\n   * @const\n   * @type {number}\n   */\n  this.resolution = resolution;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.alignFill_;\n\n  /**\n   * @private\n   * @type {Array.<*>}\n   */\n  this.beginGeometryInstruction1_ = null;\n\n  /**\n   * @private\n   * @type {Array.<*>}\n   */\n  this.beginGeometryInstruction2_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.bufferedMaxExtent_ = null;\n\n  /**\n   * @protected\n   * @type {Array.<*>}\n   */\n  this.instructions = [];\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.coordinates = [];\n\n  /**\n   * @private\n   * @type {!Object.<number,module:ol/coordinate~Coordinate|Array.<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>>}\n   */\n  this.coordinateCache_ = {};\n\n  /**\n   * @private\n   * @type {!module:ol/transform~Transform}\n   */\n  this.renderedTransform_ = createTransform();\n\n  /**\n   * @protected\n   * @type {Array.<*>}\n   */\n  this.hitDetectionInstructions = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.pixelCoordinates_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/render/canvas~FillStrokeState}\n   */\n  this.state = /** @type {module:ol/render/canvas~FillStrokeState} */ ({});\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.viewRotation_ = 0;\n\n};\n\ninherits(CanvasReplay, VectorContext);\n\n\n/**\n * @type {module:ol/extent~Extent}\n */\nconst tmpExtent = createEmpty();\n\n\n/**\n * @type {!module:ol/transform~Transform}\n */\nconst tmpTransform = createTransform();\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/coordinate~Coordinate} p1 1st point of the background box.\n * @param {module:ol/coordinate~Coordinate} p2 2nd point of the background box.\n * @param {module:ol/coordinate~Coordinate} p3 3rd point of the background box.\n * @param {module:ol/coordinate~Coordinate} p4 4th point of the background box.\n * @param {Array.<*>} fillInstruction Fill instruction.\n * @param {Array.<*>} strokeInstruction Stroke instruction.\n */\nCanvasReplay.prototype.replayTextBackground_ = function(context, p1, p2, p3, p4,\n  fillInstruction, strokeInstruction) {\n  context.beginPath();\n  context.moveTo.apply(context, p1);\n  context.lineTo.apply(context, p2);\n  context.lineTo.apply(context, p3);\n  context.lineTo.apply(context, p4);\n  context.lineTo.apply(context, p1);\n  if (fillInstruction) {\n    this.alignFill_ = /** @type {boolean} */ (fillInstruction[2]);\n    this.fill_(context);\n  }\n  if (strokeInstruction) {\n    this.setStrokeStyle_(context, /** @type {Array.<*>} */ (strokeInstruction));\n    context.stroke();\n  }\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} anchorX Anchor X.\n * @param {number} anchorY Anchor Y.\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n * @param {number} height Height.\n * @param {number} opacity Opacity.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} rotation Rotation.\n * @param {number} scale Scale.\n * @param {boolean} snapToPixel Snap to pixel.\n * @param {number} width Width.\n * @param {Array.<number>} padding Padding.\n * @param {Array.<*>} fillInstruction Fill instruction.\n * @param {Array.<*>} strokeInstruction Stroke instruction.\n */\nCanvasReplay.prototype.replayImage_ = function(context, x, y, image,\n  anchorX, anchorY, declutterGroup, height, opacity, originX, originY,\n  rotation, scale, snapToPixel, width, padding, fillInstruction, strokeInstruction) {\n  const fillStroke = fillInstruction || strokeInstruction;\n  anchorX *= scale;\n  anchorY *= scale;\n  x -= anchorX;\n  y -= anchorY;\n\n  const w = (width + originX > image.width) ? image.width - originX : width;\n  const h = (height + originY > image.height) ? image.height - originY : height;\n  const boxW = padding[3] + w * scale + padding[1];\n  const boxH = padding[0] + h * scale + padding[2];\n  const boxX = x - padding[3];\n  const boxY = y - padding[0];\n\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p1;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p2;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p3;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p4;\n  if (fillStroke || rotation !== 0) {\n    p1 = [boxX, boxY];\n    p2 = [boxX + boxW, boxY];\n    p3 = [boxX + boxW, boxY + boxH];\n    p4 = [boxX, boxY + boxH];\n  }\n\n  let transform = null;\n  if (rotation !== 0) {\n    const centerX = x + anchorX;\n    const centerY = y + anchorY;\n    transform = composeTransform(tmpTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n\n    createOrUpdateEmpty(tmpExtent);\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p1));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p2));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p3));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p4));\n  } else {\n    createOrUpdate(boxX, boxY, boxX + boxW, boxY + boxH, tmpExtent);\n  }\n  const canvas = context.canvas;\n  const strokePadding = strokeInstruction ? (strokeInstruction[2] * scale / 2) : 0;\n  const intersects =\n      tmpExtent[0] - strokePadding <= canvas.width && tmpExtent[2] + strokePadding >= 0 &&\n      tmpExtent[1] - strokePadding <= canvas.height && tmpExtent[3] + strokePadding >= 0;\n\n  if (snapToPixel) {\n    x = Math.round(x);\n    y = Math.round(y);\n  }\n\n  if (declutterGroup) {\n    if (!intersects && declutterGroup[4] == 1) {\n      return;\n    }\n    extend(declutterGroup, tmpExtent);\n    const declutterArgs = intersects ?\n      [context, transform ? transform.slice(0) : null, opacity, image, originX, originY, w, h, x, y, scale] :\n      null;\n    if (declutterArgs && fillStroke) {\n      declutterArgs.push(fillInstruction, strokeInstruction, p1, p2, p3, p4);\n    }\n    declutterGroup.push(declutterArgs);\n  } else if (intersects) {\n    if (fillStroke) {\n      this.replayTextBackground_(context, p1, p2, p3, p4,\n        /** @type {Array.<*>} */ (fillInstruction),\n        /** @type {Array.<*>} */ (strokeInstruction));\n    }\n    drawImage(context, transform, opacity, image, originX, originY, w, h, x, y, scale);\n  }\n};\n\n\n/**\n * @protected\n * @param {Array.<number>} dashArray Dash array.\n * @return {Array.<number>} Dash array with pixel ratio applied\n */\nCanvasReplay.prototype.applyPixelRatio = function(dashArray) {\n  const pixelRatio = this.pixelRatio;\n  return pixelRatio == 1 ? dashArray : dashArray.map(function(dash) {\n    return dash * pixelRatio;\n  });\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {boolean} closed Last input coordinate equals first.\n * @param {boolean} skipFirst Skip first coordinate.\n * @protected\n * @return {number} My end.\n */\nCanvasReplay.prototype.appendFlatCoordinates = function(flatCoordinates, offset, end, stride, closed, skipFirst) {\n\n  let myEnd = this.coordinates.length;\n  const extent = this.getBufferedMaxExtent();\n  if (skipFirst) {\n    offset += stride;\n  }\n  const lastCoord = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n  const nextCoord = [NaN, NaN];\n  let skipped = true;\n\n  let i, lastRel, nextRel;\n  for (i = offset + stride; i < end; i += stride) {\n    nextCoord[0] = flatCoordinates[i];\n    nextCoord[1] = flatCoordinates[i + 1];\n    nextRel = coordinateRelationship(extent, nextCoord);\n    if (nextRel !== lastRel) {\n      if (skipped) {\n        this.coordinates[myEnd++] = lastCoord[0];\n        this.coordinates[myEnd++] = lastCoord[1];\n      }\n      this.coordinates[myEnd++] = nextCoord[0];\n      this.coordinates[myEnd++] = nextCoord[1];\n      skipped = false;\n    } else if (nextRel === Relationship.INTERSECTING) {\n      this.coordinates[myEnd++] = nextCoord[0];\n      this.coordinates[myEnd++] = nextCoord[1];\n      skipped = false;\n    } else {\n      skipped = true;\n    }\n    lastCoord[0] = nextCoord[0];\n    lastCoord[1] = nextCoord[1];\n    lastRel = nextRel;\n  }\n\n  // Last coordinate equals first or only one point to append:\n  if ((closed && skipped) || i === offset + stride) {\n    this.coordinates[myEnd++] = lastCoord[0];\n    this.coordinates[myEnd++] = lastCoord[1];\n  }\n  return myEnd;\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<number>} replayEnds Replay ends.\n * @return {number} Offset.\n */\nCanvasReplay.prototype.drawCustomCoordinates_ = function(flatCoordinates, offset, ends, stride, replayEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const replayEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n    replayEnds.push(replayEnd);\n    offset = end;\n  }\n  return offset;\n};\n\n\n/**\n * @inheritDoc.\n */\nCanvasReplay.prototype.drawCustom = function(geometry, feature, renderer) {\n  this.beginGeometry(geometry, feature);\n  const type = geometry.getType();\n  const stride = geometry.getStride();\n  const replayBegin = this.coordinates.length;\n  let flatCoordinates, replayEnd, replayEnds, replayEndss;\n  let offset;\n  if (type == GeometryType.MULTI_POLYGON) {\n    geometry = /** @type {module:ol/geom/MultiPolygon} */ (geometry);\n    flatCoordinates = geometry.getOrientedFlatCoordinates();\n    replayEndss = [];\n    const endss = geometry.getEndss();\n    offset = 0;\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      const myEnds = [];\n      offset = this.drawCustomCoordinates_(flatCoordinates, offset, endss[i], stride, myEnds);\n      replayEndss.push(myEnds);\n    }\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEndss, geometry, renderer, inflateMultiCoordinatesArray]);\n  } else if (type == GeometryType.POLYGON || type == GeometryType.MULTI_LINE_STRING) {\n    replayEnds = [];\n    flatCoordinates = (type == GeometryType.POLYGON) ?\n      /** @type {module:ol/geom/Polygon} */ (geometry).getOrientedFlatCoordinates() :\n      geometry.getFlatCoordinates();\n    offset = this.drawCustomCoordinates_(flatCoordinates, 0,\n      /** @type {module:ol/geom/Polygon|module:ol/geom/MultiLineString} */ (geometry).getEnds(),\n      stride, replayEnds);\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnds, geometry, renderer, inflateCoordinatesArray]);\n  } else if (type == GeometryType.LINE_STRING || type == GeometryType.MULTI_POINT) {\n    flatCoordinates = geometry.getFlatCoordinates();\n    replayEnd = this.appendFlatCoordinates(\n      flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnd, geometry, renderer, inflateCoordinates]);\n  } else if (type == GeometryType.POINT) {\n    flatCoordinates = geometry.getFlatCoordinates();\n    this.coordinates.push(flatCoordinates[0], flatCoordinates[1]);\n    replayEnd = this.coordinates.length;\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnd, geometry, renderer]);\n  }\n  this.endGeometry(geometry, feature);\n};\n\n\n/**\n * @protected\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.beginGeometry = function(geometry, feature) {\n  this.beginGeometryInstruction1_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n  this.instructions.push(this.beginGeometryInstruction1_);\n  this.beginGeometryInstruction2_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n  this.hitDetectionInstructions.push(this.beginGeometryInstruction2_);\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n */\nCanvasReplay.prototype.fill_ = function(context) {\n  if (this.alignFill_) {\n    const origin = applyTransform(this.renderedTransform_, [0, 0]);\n    const repeatSize = 512 * this.pixelRatio;\n    context.translate(origin[0] % repeatSize, origin[1] % repeatSize);\n    context.rotate(this.viewRotation_);\n  }\n  context.fill();\n  if (this.alignFill_) {\n    context.setTransform.apply(context, resetTransform);\n  }\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n * @param {Array.<*>} instruction Instruction.\n */\nCanvasReplay.prototype.setStrokeStyle_ = function(context, instruction) {\n  context.strokeStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\n  context.lineWidth = /** @type {number} */ (instruction[2]);\n  context.lineCap = /** @type {string} */ (instruction[3]);\n  context.lineJoin = /** @type {string} */ (instruction[4]);\n  context.miterLimit = /** @type {number} */ (instruction[5]);\n  if (CANVAS_LINE_DASH) {\n    context.lineDashOffset = /** @type {number} */ (instruction[7]);\n    context.setLineDash(/** @type {Array.<number>} */ (instruction[6]));\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.renderDeclutter_ = function(declutterGroup, feature) {\n  if (declutterGroup && declutterGroup.length > 5) {\n    const groupCount = declutterGroup[4];\n    if (groupCount == 1 || groupCount == declutterGroup.length - 5) {\n      /** @type {module:ol/structs/RBush~Entry} */\n      const box = {\n        minX: /** @type {number} */ (declutterGroup[0]),\n        minY: /** @type {number} */ (declutterGroup[1]),\n        maxX: /** @type {number} */ (declutterGroup[2]),\n        maxY: /** @type {number} */ (declutterGroup[3]),\n        value: feature\n      };\n      if (!this.declutterTree.collides(box)) {\n        this.declutterTree.insert(box);\n        for (let j = 5, jj = declutterGroup.length; j < jj; ++j) {\n          const declutterData = /** @type {Array} */ (declutterGroup[j]);\n          if (declutterData) {\n            if (declutterData.length > 11) {\n              this.replayTextBackground_(declutterData[0],\n                declutterData[13], declutterData[14], declutterData[15], declutterData[16],\n                declutterData[11], declutterData[12]);\n            }\n            drawImage.apply(undefined, declutterData);\n          }\n        }\n      }\n      declutterGroup.length = 5;\n      createOrUpdateEmpty(declutterGroup);\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n * @param {Array.<*>} instructions Instructions array.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined}\n *     featureCallback Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\n *     extent.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplay.prototype.replay_ = function(\n  context, transform, skippedFeaturesHash,\n  instructions, featureCallback, opt_hitExtent) {\n  /** @type {Array.<number>} */\n  let pixelCoordinates;\n  if (this.pixelCoordinates_ && equals(transform, this.renderedTransform_)) {\n    pixelCoordinates = this.pixelCoordinates_;\n  } else {\n    if (!this.pixelCoordinates_) {\n      this.pixelCoordinates_ = [];\n    }\n    pixelCoordinates = transform2D(\n      this.coordinates, 0, this.coordinates.length, 2,\n      transform, this.pixelCoordinates_);\n    transformSetFromArray(this.renderedTransform_, transform);\n  }\n  const skipFeatures = !isEmpty(skippedFeaturesHash);\n  let i = 0; // instruction index\n  const ii = instructions.length; // end of instructions\n  let d = 0; // data index\n  let dd; // end of per-instruction data\n  let anchorX, anchorY, prevX, prevY, roundX, roundY, declutterGroup, image;\n  let pendingFill = 0;\n  let pendingStroke = 0;\n  let lastFillInstruction = null;\n  let lastStrokeInstruction = null;\n  const coordinateCache = this.coordinateCache_;\n  const viewRotation = this.viewRotation_;\n\n  const state = /** @type {module:ol/render~State} */ ({\n    context: context,\n    pixelRatio: this.pixelRatio,\n    resolution: this.resolution,\n    rotation: viewRotation\n  });\n\n  // When the batch size gets too big, performance decreases. 200 is a good\n  // balance between batch size and number of fill/stroke instructions.\n  const batchSize = this.instructions != instructions || this.overlaps ? 0 : 200;\n  let /** @type {module:ol/Feature|module:ol/render/Feature} */ feature;\n  let x, y;\n  while (i < ii) {\n    const instruction = instructions[i];\n    const type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\n    switch (type) {\n      case CanvasInstruction.BEGIN_GEOMETRY:\n        feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\n        if ((skipFeatures &&\n            skippedFeaturesHash[getUid(feature).toString()]) ||\n            !feature.getGeometry()) {\n          i = /** @type {number} */ (instruction[2]);\n        } else if (opt_hitExtent !== undefined && !intersects(\n          opt_hitExtent, feature.getGeometry().getExtent())) {\n          i = /** @type {number} */ (instruction[2]) + 1;\n        } else {\n          ++i;\n        }\n        break;\n      case CanvasInstruction.BEGIN_PATH:\n        if (pendingFill > batchSize) {\n          this.fill_(context);\n          pendingFill = 0;\n        }\n        if (pendingStroke > batchSize) {\n          context.stroke();\n          pendingStroke = 0;\n        }\n        if (!pendingFill && !pendingStroke) {\n          context.beginPath();\n          prevX = prevY = NaN;\n        }\n        ++i;\n        break;\n      case CanvasInstruction.CIRCLE:\n        d = /** @type {number} */ (instruction[1]);\n        const x1 = pixelCoordinates[d];\n        const y1 = pixelCoordinates[d + 1];\n        const x2 = pixelCoordinates[d + 2];\n        const y2 = pixelCoordinates[d + 3];\n        const dx = x2 - x1;\n        const dy = y2 - y1;\n        const r = Math.sqrt(dx * dx + dy * dy);\n        context.moveTo(x1 + r, y1);\n        context.arc(x1, y1, r, 0, 2 * Math.PI, true);\n        ++i;\n        break;\n      case CanvasInstruction.CLOSE_PATH:\n        context.closePath();\n        ++i;\n        break;\n      case CanvasInstruction.CUSTOM:\n        d = /** @type {number} */ (instruction[1]);\n        dd = instruction[2];\n        const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (instruction[3]);\n        const renderer = instruction[4];\n        const fn = instruction.length == 6 ? instruction[5] : undefined;\n        state.geometry = geometry;\n        state.feature = feature;\n        if (!(i in coordinateCache)) {\n          coordinateCache[i] = [];\n        }\n        const coords = coordinateCache[i];\n        if (fn) {\n          fn(pixelCoordinates, d, dd, 2, coords);\n        } else {\n          coords[0] = pixelCoordinates[d];\n          coords[1] = pixelCoordinates[d + 1];\n          coords.length = 2;\n        }\n        renderer(coords, state);\n        ++i;\n        break;\n      case CanvasInstruction.DRAW_IMAGE:\n        d = /** @type {number} */ (instruction[1]);\n        dd = /** @type {number} */ (instruction[2]);\n        image =  /** @type {HTMLCanvasElement|HTMLVideoElement|Image} */\n            (instruction[3]);\n        // Remaining arguments in DRAW_IMAGE are in alphabetical order\n        anchorX = /** @type {number} */ (instruction[4]);\n        anchorY = /** @type {number} */ (instruction[5]);\n        declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[6]);\n        const height = /** @type {number} */ (instruction[7]);\n        const opacity = /** @type {number} */ (instruction[8]);\n        const originX = /** @type {number} */ (instruction[9]);\n        const originY = /** @type {number} */ (instruction[10]);\n        const rotateWithView = /** @type {boolean} */ (instruction[11]);\n        let rotation = /** @type {number} */ (instruction[12]);\n        const scale = /** @type {number} */ (instruction[13]);\n        const snapToPixel = /** @type {boolean} */ (instruction[14]);\n        const width = /** @type {number} */ (instruction[15]);\n\n        let padding, backgroundFill, backgroundStroke;\n        if (instruction.length > 16) {\n          padding = /** @type {Array.<number>} */ (instruction[16]);\n          backgroundFill = /** @type {boolean} */ (instruction[17]);\n          backgroundStroke = /** @type {boolean} */ (instruction[18]);\n        } else {\n          padding = defaultPadding;\n          backgroundFill = backgroundStroke = false;\n        }\n\n        if (rotateWithView) {\n          rotation += viewRotation;\n        }\n        for (; d < dd; d += 2) {\n          this.replayImage_(context,\n            pixelCoordinates[d], pixelCoordinates[d + 1], image, anchorX, anchorY,\n            declutterGroup, height, opacity, originX, originY, rotation, scale,\n            snapToPixel, width, padding,\n            backgroundFill ? /** @type {Array.<*>} */ (lastFillInstruction) : null,\n            backgroundStroke ? /** @type {Array.<*>} */ (lastStrokeInstruction) : null);\n        }\n        this.renderDeclutter_(declutterGroup, feature);\n        ++i;\n        break;\n      case CanvasInstruction.DRAW_CHARS:\n        const begin = /** @type {number} */ (instruction[1]);\n        const end = /** @type {number} */ (instruction[2]);\n        const baseline = /** @type {number} */ (instruction[3]);\n        declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[4]);\n        const overflow = /** @type {number} */ (instruction[5]);\n        const fillKey = /** @type {string} */ (instruction[6]);\n        const maxAngle = /** @type {number} */ (instruction[7]);\n        const measure = /** @type {function(string):number} */ (instruction[8]);\n        const offsetY = /** @type {number} */ (instruction[9]);\n        const strokeKey = /** @type {string} */ (instruction[10]);\n        const strokeWidth =  /** @type {number} */ (instruction[11]);\n        const text = /** @type {string} */ (instruction[12]);\n        const textKey = /** @type {string} */ (instruction[13]);\n        const textScale = /** @type {number} */ (instruction[14]);\n\n        const pathLength = lineStringLength(pixelCoordinates, begin, end, 2);\n        const textLength = measure(text);\n        if (overflow || textLength <= pathLength) {\n          const textAlign = /** @type {module:ol~render} */ (this).textStates[textKey].textAlign;\n          const startM = (pathLength - textLength) * TEXT_ALIGN[textAlign];\n          const parts = drawTextOnPath(\n            pixelCoordinates, begin, end, 2, text, measure, startM, maxAngle);\n          if (parts) {\n            let c, cc, chars, label, part;\n            if (strokeKey) {\n              for (c = 0, cc = parts.length; c < cc; ++c) {\n                part = parts[c]; // x, y, anchorX, rotation, chunk\n                chars = /** @type {string} */ (part[4]);\n                label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, '', strokeKey);\n                anchorX = /** @type {number} */ (part[2]) + strokeWidth;\n                anchorY = baseline * label.height + (0.5 - baseline) * 2 * strokeWidth - offsetY;\n                this.replayImage_(context,\n                  /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                  anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                  /** @type {number} */ (part[3]), textScale, false, label.width,\n                  defaultPadding, null, null);\n              }\n            }\n            if (fillKey) {\n              for (c = 0, cc = parts.length; c < cc; ++c) {\n                part = parts[c]; // x, y, anchorX, rotation, chunk\n                chars = /** @type {string} */ (part[4]);\n                label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, fillKey, '');\n                anchorX = /** @type {number} */ (part[2]);\n                anchorY = baseline * label.height - offsetY;\n                this.replayImage_(context,\n                  /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                  anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                  /** @type {number} */ (part[3]), textScale, false, label.width,\n                  defaultPadding, null, null);\n              }\n            }\n          }\n        }\n        this.renderDeclutter_(declutterGroup, feature);\n        ++i;\n        break;\n      case CanvasInstruction.END_GEOMETRY:\n        if (featureCallback !== undefined) {\n          feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\n          const result = featureCallback(feature);\n          if (result) {\n            return result;\n          }\n        }\n        ++i;\n        break;\n      case CanvasInstruction.FILL:\n        if (batchSize) {\n          pendingFill++;\n        } else {\n          this.fill_(context);\n        }\n        ++i;\n        break;\n      case CanvasInstruction.MOVE_TO_LINE_TO:\n        d = /** @type {number} */ (instruction[1]);\n        dd = /** @type {number} */ (instruction[2]);\n        x = pixelCoordinates[d];\n        y = pixelCoordinates[d + 1];\n        roundX = (x + 0.5) | 0;\n        roundY = (y + 0.5) | 0;\n        if (roundX !== prevX || roundY !== prevY) {\n          context.moveTo(x, y);\n          prevX = roundX;\n          prevY = roundY;\n        }\n        for (d += 2; d < dd; d += 2) {\n          x = pixelCoordinates[d];\n          y = pixelCoordinates[d + 1];\n          roundX = (x + 0.5) | 0;\n          roundY = (y + 0.5) | 0;\n          if (d == dd - 2 || roundX !== prevX || roundY !== prevY) {\n            context.lineTo(x, y);\n            prevX = roundX;\n            prevY = roundY;\n          }\n        }\n        ++i;\n        break;\n      case CanvasInstruction.SET_FILL_STYLE:\n        lastFillInstruction = instruction;\n        this.alignFill_ = instruction[2];\n\n        if (pendingFill) {\n          this.fill_(context);\n          pendingFill = 0;\n          if (pendingStroke) {\n            context.stroke();\n            pendingStroke = 0;\n          }\n        }\n\n        context.fillStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\n        ++i;\n        break;\n      case CanvasInstruction.SET_STROKE_STYLE:\n        lastStrokeInstruction = instruction;\n        if (pendingStroke) {\n          context.stroke();\n          pendingStroke = 0;\n        }\n        this.setStrokeStyle_(context, /** @type {Array.<*>} */ (instruction));\n        ++i;\n        break;\n      case CanvasInstruction.STROKE:\n        if (batchSize) {\n          pendingStroke++;\n        } else {\n          context.stroke();\n        }\n        ++i;\n        break;\n      default:\n        ++i; // consume the instruction anyway, to avoid an infinite loop\n        break;\n    }\n  }\n  if (pendingFill) {\n    this.fill_(context);\n  }\n  if (pendingStroke) {\n    context.stroke();\n  }\n  return undefined;\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n */\nCanvasReplay.prototype.replay = function(\n  context, transform, viewRotation, skippedFeaturesHash) {\n  this.viewRotation_ = viewRotation;\n  this.replay_(context, transform,\n    skippedFeaturesHash, this.instructions, undefined, undefined);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T=} opt_featureCallback\n *     Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\n *     extent.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplay.prototype.replayHitDetection = function(\n  context, transform, viewRotation, skippedFeaturesHash,\n  opt_featureCallback, opt_hitExtent) {\n  this.viewRotation_ = viewRotation;\n  return this.replay_(context, transform, skippedFeaturesHash,\n    this.hitDetectionInstructions, opt_featureCallback, opt_hitExtent);\n};\n\n\n/**\n * Reverse the hit detection instructions.\n */\nCanvasReplay.prototype.reverseHitDetectionInstructions = function() {\n  const hitDetectionInstructions = this.hitDetectionInstructions;\n  // step 1 - reverse array\n  hitDetectionInstructions.reverse();\n  // step 2 - reverse instructions within geometry blocks\n  let i;\n  const n = hitDetectionInstructions.length;\n  let instruction;\n  let type;\n  let begin = -1;\n  for (i = 0; i < n; ++i) {\n    instruction = hitDetectionInstructions[i];\n    type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\n    if (type == CanvasInstruction.END_GEOMETRY) {\n      begin = i;\n    } else if (type == CanvasInstruction.BEGIN_GEOMETRY) {\n      instruction[2] = i;\n      reverseSubArray(this.hitDetectionInstructions, begin, i);\n      begin = -1;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  const state = this.state;\n  if (fillStyle) {\n    const fillStyleColor = fillStyle.getColor();\n    state.fillStyle = asColorLike(fillStyleColor ?\n      fillStyleColor : defaultFillStyle);\n  } else {\n    state.fillStyle = undefined;\n  }\n  if (strokeStyle) {\n    const strokeStyleColor = strokeStyle.getColor();\n    state.strokeStyle = asColorLike(strokeStyleColor ?\n      strokeStyleColor : defaultStrokeStyle);\n    const strokeStyleLineCap = strokeStyle.getLineCap();\n    state.lineCap = strokeStyleLineCap !== undefined ?\n      strokeStyleLineCap : defaultLineCap;\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    state.lineDash = strokeStyleLineDash ?\n      strokeStyleLineDash.slice() : defaultLineDash;\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    state.lineDashOffset = strokeStyleLineDashOffset ?\n      strokeStyleLineDashOffset : defaultLineDashOffset;\n    const strokeStyleLineJoin = strokeStyle.getLineJoin();\n    state.lineJoin = strokeStyleLineJoin !== undefined ?\n      strokeStyleLineJoin : defaultLineJoin;\n    const strokeStyleWidth = strokeStyle.getWidth();\n    state.lineWidth = strokeStyleWidth !== undefined ?\n      strokeStyleWidth : defaultLineWidth;\n    const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n    state.miterLimit = strokeStyleMiterLimit !== undefined ?\n      strokeStyleMiterLimit : defaultMiterLimit;\n\n    if (state.lineWidth > this.maxLineWidth) {\n      this.maxLineWidth = state.lineWidth;\n      // invalidate the buffered max extent cache\n      this.bufferedMaxExtent_ = null;\n    }\n  } else {\n    state.strokeStyle = undefined;\n    state.lineCap = undefined;\n    state.lineDash = null;\n    state.lineDashOffset = undefined;\n    state.lineJoin = undefined;\n    state.lineWidth = undefined;\n    state.miterLimit = undefined;\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @return {Array.<*>} Fill instruction.\n */\nCanvasReplay.prototype.createFill = function(state, geometry) {\n  const fillStyle = state.fillStyle;\n  const fillInstruction = [CanvasInstruction.SET_FILL_STYLE, fillStyle];\n  if (typeof fillStyle !== 'string') {\n    // Fill is a pattern or gradient - align it!\n    fillInstruction.push(true);\n  }\n  return fillInstruction;\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n */\nCanvasReplay.prototype.applyStroke = function(state) {\n  this.instructions.push(this.createStroke(state));\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @return {Array.<*>} Stroke instruction.\n */\nCanvasReplay.prototype.createStroke = function(state) {\n  return [\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth * this.pixelRatio, state.lineCap,\n    state.lineJoin, state.miterLimit,\n    this.applyPixelRatio(state.lineDash), state.lineDashOffset * this.pixelRatio\n  ];\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState, (module:ol/geom/Geometry|module:ol/render/Feature)):Array.<*>} createFill Create fill.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n */\nCanvasReplay.prototype.updateFillStyle = function(state, createFill, geometry) {\n  const fillStyle = state.fillStyle;\n  if (typeof fillStyle !== 'string' || state.currentFillStyle != fillStyle) {\n    if (fillStyle !== undefined) {\n      this.instructions.push(createFill.call(this, state, geometry));\n    }\n    state.currentFillStyle = fillStyle;\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState)} applyStroke Apply stroke.\n */\nCanvasReplay.prototype.updateStrokeStyle = function(state, applyStroke) {\n  const strokeStyle = state.strokeStyle;\n  const lineCap = state.lineCap;\n  const lineDash = state.lineDash;\n  const lineDashOffset = state.lineDashOffset;\n  const lineJoin = state.lineJoin;\n  const lineWidth = state.lineWidth;\n  const miterLimit = state.miterLimit;\n  if (state.currentStrokeStyle != strokeStyle ||\n      state.currentLineCap != lineCap ||\n      (lineDash != state.currentLineDash && !equals(state.currentLineDash, lineDash)) ||\n      state.currentLineDashOffset != lineDashOffset ||\n      state.currentLineJoin != lineJoin ||\n      state.currentLineWidth != lineWidth ||\n      state.currentMiterLimit != miterLimit) {\n    if (strokeStyle !== undefined) {\n      applyStroke.call(this, state);\n    }\n    state.currentStrokeStyle = strokeStyle;\n    state.currentLineCap = lineCap;\n    state.currentLineDash = lineDash;\n    state.currentLineDashOffset = lineDashOffset;\n    state.currentLineJoin = lineJoin;\n    state.currentLineWidth = lineWidth;\n    state.currentMiterLimit = miterLimit;\n  }\n};\n\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.endGeometry = function(geometry, feature) {\n  this.beginGeometryInstruction1_[2] = this.instructions.length;\n  this.beginGeometryInstruction1_ = null;\n  this.beginGeometryInstruction2_[2] = this.hitDetectionInstructions.length;\n  this.beginGeometryInstruction2_ = null;\n  const endGeometryInstruction = [CanvasInstruction.END_GEOMETRY, feature];\n  this.instructions.push(endGeometryInstruction);\n  this.hitDetectionInstructions.push(endGeometryInstruction);\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nCanvasReplay.prototype.finish = UNDEFINED;\n\n\n/**\n * Get the buffered rendering extent.  Rendering will be clipped to the extent\n * provided to the constructor.  To account for symbolizers that may intersect\n * this extent, we calculate a buffered extent (e.g. based on stroke width).\n * @return {module:ol/extent~Extent} The buffered rendering extent.\n * @protected\n */\nCanvasReplay.prototype.getBufferedMaxExtent = function() {\n  if (!this.bufferedMaxExtent_) {\n    this.bufferedMaxExtent_ = clone(this.maxExtent);\n    if (this.maxLineWidth > 0) {\n      const width = this.resolution * (this.maxLineWidth + 1) / 2;\n      buffer(this.bufferedMaxExtent_, width, this.bufferedMaxExtent_);\n    }\n  }\n  return this.bufferedMaxExtent_;\n};\nexport default CanvasReplay;\n","/**\n * @module ol/render/canvas/ImageReplay\n */\nimport {inherits} from '../../index.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasImageReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   */\n  this.declutterGroup_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.hitDetectionImage_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.anchorX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.anchorY_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.height_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.opacity_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.originX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.originY_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.scale_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.snapToPixel_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.width_ = undefined;\n\n};\n\ninherits(CanvasImageReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n * @return {number} My end.\n */\nCanvasImageReplay.prototype.drawCoordinates_ = function(flatCoordinates, offset, end, stride) {\n  return this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.drawPoint = function(pointGeometry, feature) {\n  if (!this.image_) {\n    return;\n  }\n  this.beginGeometry(pointGeometry, feature);\n  const flatCoordinates = pointGeometry.getFlatCoordinates();\n  const stride = pointGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  const myEnd = this.drawCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  this.instructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_ * this.pixelRatio, this.snapToPixel_, this.width_\n  ]);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_, this.snapToPixel_, this.width_\n  ]);\n  this.endGeometry(pointGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.drawMultiPoint = function(multiPointGeometry, feature) {\n  if (!this.image_) {\n    return;\n  }\n  this.beginGeometry(multiPointGeometry, feature);\n  const flatCoordinates = multiPointGeometry.getFlatCoordinates();\n  const stride = multiPointGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  const myEnd = this.drawCoordinates_(\n    flatCoordinates, 0, flatCoordinates.length, stride);\n  this.instructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_ * this.pixelRatio, this.snapToPixel_, this.width_\n  ]);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_, this.snapToPixel_, this.width_\n  ]);\n  this.endGeometry(multiPointGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.finish = function() {\n  this.reverseHitDetectionInstructions();\n  // FIXME this doesn't really protect us against further calls to draw*Geometry\n  this.anchorX_ = undefined;\n  this.anchorY_ = undefined;\n  this.hitDetectionImage_ = null;\n  this.image_ = null;\n  this.height_ = undefined;\n  this.scale_ = undefined;\n  this.opacity_ = undefined;\n  this.originX_ = undefined;\n  this.originY_ = undefined;\n  this.rotateWithView_ = undefined;\n  this.rotation_ = undefined;\n  this.snapToPixel_ = undefined;\n  this.width_ = undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.setImageStyle = function(imageStyle, declutterGroup) {\n  const anchor = imageStyle.getAnchor();\n  const size = imageStyle.getSize();\n  const hitDetectionImage = imageStyle.getHitDetectionImage(1);\n  const image = imageStyle.getImage(1);\n  const origin = imageStyle.getOrigin();\n  this.anchorX_ = anchor[0];\n  this.anchorY_ = anchor[1];\n  this.declutterGroup_ = /** @type {module:ol/render/canvas~DeclutterGroup} */ (declutterGroup);\n  this.hitDetectionImage_ = hitDetectionImage;\n  this.image_ = image;\n  this.height_ = size[1];\n  this.opacity_ = imageStyle.getOpacity();\n  this.originX_ = origin[0];\n  this.originY_ = origin[1];\n  this.rotateWithView_ = imageStyle.getRotateWithView();\n  this.rotation_ = imageStyle.getRotation();\n  this.scale_ = imageStyle.getScale();\n  this.snapToPixel_ = imageStyle.getSnapToPixel();\n  this.width_ = size[0];\n};\nexport default CanvasImageReplay;\n","/**\n * @module ol/render/canvas/LineStringReplay\n */\nimport {inherits} from '../../index.js';\nimport CanvasInstruction, {strokeInstruction, beginPathInstruction} from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasLineStringReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n};\n\ninherits(CanvasLineStringReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n * @return {number} end.\n */\nCanvasLineStringReplay.prototype.drawFlatCoordinates_ = function(flatCoordinates, offset, end, stride) {\n  const myBegin = this.coordinates.length;\n  const myEnd = this.appendFlatCoordinates(\n    flatCoordinates, offset, end, stride, false, false);\n  const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n  this.instructions.push(moveToLineToInstruction);\n  this.hitDetectionInstructions.push(moveToLineToInstruction);\n  return end;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.drawLineString = function(lineStringGeometry, feature) {\n  const state = this.state;\n  const strokeStyle = state.strokeStyle;\n  const lineWidth = state.lineWidth;\n  if (strokeStyle === undefined || lineWidth === undefined) {\n    return;\n  }\n  this.updateStrokeStyle(state, this.applyStroke);\n  this.beginGeometry(lineStringGeometry, feature);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n    state.miterLimit, state.lineDash, state.lineDashOffset\n  ], beginPathInstruction);\n  const flatCoordinates = lineStringGeometry.getFlatCoordinates();\n  const stride = lineStringGeometry.getStride();\n  this.drawFlatCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  this.hitDetectionInstructions.push(strokeInstruction);\n  this.endGeometry(lineStringGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {\n  const state = this.state;\n  const strokeStyle = state.strokeStyle;\n  const lineWidth = state.lineWidth;\n  if (strokeStyle === undefined || lineWidth === undefined) {\n    return;\n  }\n  this.updateStrokeStyle(state, this.applyStroke);\n  this.beginGeometry(multiLineStringGeometry, feature);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n    state.miterLimit, state.lineDash, state.lineDashOffset\n  ], beginPathInstruction);\n  const ends = multiLineStringGeometry.getEnds();\n  const flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n  const stride = multiLineStringGeometry.getStride();\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    offset = this.drawFlatCoordinates_(flatCoordinates, offset, ends[i], stride);\n  }\n  this.hitDetectionInstructions.push(strokeInstruction);\n  this.endGeometry(multiLineStringGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.finish = function() {\n  const state = this.state;\n  if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n    this.instructions.push(strokeInstruction);\n  }\n  this.reverseHitDetectionInstructions();\n  this.state = null;\n};\n\n\n/**\n * @inheritDoc.\n */\nCanvasLineStringReplay.prototype.applyStroke = function(state) {\n  if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n    this.instructions.push(strokeInstruction);\n    state.lastStroke = this.coordinates.length;\n  }\n  state.lastStroke = 0;\n  CanvasReplay.prototype.applyStroke.call(this, state);\n  this.instructions.push(beginPathInstruction);\n};\nexport default CanvasLineStringReplay;\n","/**\n * @module ol/render/canvas/PolygonReplay\n */\nimport {inherits} from '../../index.js';\nimport {asString} from '../../color.js';\nimport {snap} from '../../geom/flat/simplify.js';\nimport {defaultFillStyle} from '../canvas.js';\nimport CanvasInstruction, {\n  fillInstruction, strokeInstruction, beginPathInstruction, closePathInstruction\n} from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasPolygonReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n};\n\ninherits(CanvasPolygonReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @private\n * @return {number} End.\n */\nCanvasPolygonReplay.prototype.drawFlatCoordinatess_ = function(flatCoordinates, offset, ends, stride) {\n  const state = this.state;\n  const fill = state.fillStyle !== undefined;\n  const stroke = state.strokeStyle != undefined;\n  const numEnds = ends.length;\n  this.instructions.push(beginPathInstruction);\n  this.hitDetectionInstructions.push(beginPathInstruction);\n  for (let i = 0; i < numEnds; ++i) {\n    const end = ends[i];\n    const myBegin = this.coordinates.length;\n    const myEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, true, !stroke);\n    const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n    this.instructions.push(moveToLineToInstruction);\n    this.hitDetectionInstructions.push(moveToLineToInstruction);\n    if (stroke) {\n      // Performance optimization: only call closePath() when we have a stroke.\n      // Otherwise the ring is closed already (see appendFlatCoordinates above).\n      this.instructions.push(closePathInstruction);\n      this.hitDetectionInstructions.push(closePathInstruction);\n    }\n    offset = end;\n  }\n  this.hitDetectionInstructions.push(fillInstruction);\n  if (fill) {\n    this.instructions.push(fillInstruction);\n  }\n  if (stroke) {\n    this.instructions.push(strokeInstruction);\n    this.hitDetectionInstructions.push(strokeInstruction);\n  }\n  return offset;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawCircle = function(circleGeometry, feature) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  const strokeStyle = state.strokeStyle;\n  if (fillStyle === undefined && strokeStyle === undefined) {\n    return;\n  }\n  this.setFillStrokeStyles_(circleGeometry);\n  this.beginGeometry(circleGeometry, feature);\n  // always fill the circle for hit detection\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_FILL_STYLE,\n    asString(defaultFillStyle)\n  ]);\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const flatCoordinates = circleGeometry.getFlatCoordinates();\n  const stride = circleGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  this.appendFlatCoordinates(\n    flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n  const circleInstruction = [CanvasInstruction.CIRCLE, myBegin];\n  this.instructions.push(beginPathInstruction, circleInstruction);\n  this.hitDetectionInstructions.push(beginPathInstruction, circleInstruction);\n  this.hitDetectionInstructions.push(fillInstruction);\n  if (state.fillStyle !== undefined) {\n    this.instructions.push(fillInstruction);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.instructions.push(strokeInstruction);\n    this.hitDetectionInstructions.push(strokeInstruction);\n  }\n  this.endGeometry(circleGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawPolygon = function(polygonGeometry, feature) {\n  const state = this.state;\n  this.setFillStrokeStyles_(polygonGeometry);\n  this.beginGeometry(polygonGeometry, feature);\n  // always fill the polygon for hit detection\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_FILL_STYLE,\n    asString(defaultFillStyle)]\n  );\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const ends = polygonGeometry.getEnds();\n  const flatCoordinates = polygonGeometry.getOrientedFlatCoordinates();\n  const stride = polygonGeometry.getStride();\n  this.drawFlatCoordinatess_(flatCoordinates, 0, ends, stride);\n  this.endGeometry(polygonGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  const strokeStyle = state.strokeStyle;\n  if (fillStyle === undefined && strokeStyle === undefined) {\n    return;\n  }\n  this.setFillStrokeStyles_(multiPolygonGeometry);\n  this.beginGeometry(multiPolygonGeometry, feature);\n  // always fill the multi-polygon for hit detection\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_FILL_STYLE,\n    asString(defaultFillStyle)\n  ]);\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const endss = multiPolygonGeometry.getEndss();\n  const flatCoordinates = multiPolygonGeometry.getOrientedFlatCoordinates();\n  const stride = multiPolygonGeometry.getStride();\n  let offset = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = this.drawFlatCoordinatess_(flatCoordinates, offset, endss[i], stride);\n  }\n  this.endGeometry(multiPolygonGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.finish = function() {\n  this.reverseHitDetectionInstructions();\n  this.state = null;\n  // We want to preserve topology when drawing polygons.  Polygons are\n  // simplified using quantization and point elimination. However, we might\n  // have received a mix of quantized and non-quantized geometries, so ensure\n  // that all are quantized by quantizing all coordinates in the batch.\n  const tolerance = this.tolerance;\n  if (tolerance !== 0) {\n    const coordinates = this.coordinates;\n    for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n      coordinates[i] = snap(coordinates[i], tolerance);\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n */\nCanvasPolygonReplay.prototype.setFillStrokeStyles_ = function(geometry) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  if (fillStyle !== undefined) {\n    this.updateFillStyle(state, this.createFill, geometry);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.updateStrokeStyle(state, this.applyStroke);\n  }\n};\nexport default CanvasPolygonReplay;\n","/**\n * @module ol/geom/flat/straightchunk\n */\n\n\n/**\n * @param {number} maxAngle Maximum acceptable angle delta between segments.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {Array.<number>} Start and end of the first suitable chunk of the\n * given `flatCoordinates`.\n */\nexport function matchingChunk(maxAngle, flatCoordinates, offset, end, stride) {\n  let chunkStart = offset;\n  let chunkEnd = offset;\n  let chunkM = 0;\n  let m = 0;\n  let start = offset;\n  let acos, i, m12, m23, x1, y1, x12, y12, x23, y23;\n  for (i = offset; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    if (x1 !== undefined) {\n      x23 = x2 - x1;\n      y23 = y2 - y1;\n      m23 = Math.sqrt(x23 * x23 + y23 * y23);\n      if (x12 !== undefined) {\n        m += m12;\n        acos = Math.acos((x12 * x23 + y12 * y23) / (m12 * m23));\n        if (acos > maxAngle) {\n          if (m > chunkM) {\n            chunkM = m;\n            chunkStart = start;\n            chunkEnd = i;\n          }\n          m = 0;\n          start = i - stride;\n        }\n      }\n      m12 = m23;\n      x12 = x23;\n      y12 = y23;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  m += m23;\n  return m > chunkM ? [start, i] : [chunkStart, chunkEnd];\n}\n","/**\n * @module ol/render/canvas/TextReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {intersects} from '../../extent.js';\nimport {matchingChunk} from '../../geom/flat/straightchunk.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {labelCache, measureTextWidth, defaultTextAlign, measureTextHeight, defaultPadding, defaultLineCap, defaultLineDashOffset, defaultLineDash, defaultLineJoin, defaultFillStyle, checkFont, defaultFont, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline} from '../canvas.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport TextPlacement from '../../style/TextPlacement.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasTextReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   */\n  this.declutterGroup_;\n\n  /**\n   * @private\n   * @type {Array.<HTMLCanvasElement>}\n   */\n  this.labels_ = null;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.textRotateWithView_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textRotation_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.textFillState_ = null;\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~FillState>}\n   */\n  this.fillStates = {};\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.textStrokeState_ = null;\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~StrokeState>}\n   */\n  this.strokeStates = {};\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~TextState}\n   */\n  this.textState_ = /** @type {module:ol/render/canvas~TextState} */ ({});\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~TextState>}\n   */\n  this.textStates = {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.textKey_ = '';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.fillKey_ = '';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.strokeKey_ = '';\n\n  /**\n   * @private\n   * @type {Object.<string, Object.<string, number>>}\n   */\n  this.widths_ = {};\n\n  labelCache.prune();\n\n};\n\ninherits(CanvasTextReplay, CanvasReplay);\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @param {Array.<string>} lines Lines to measure.\n * @param {Array.<number>} widths Array will be populated with the widths of\n * each line.\n * @return {number} Width of the whole text.\n */\nexport function measureTextWidths(font, lines, widths) {\n  const numLines = lines.length;\n  let width = 0;\n  for (let i = 0; i < numLines; ++i) {\n    const currentWidth = measureTextWidth(font, lines[i]);\n    width = Math.max(width, currentWidth);\n    widths.push(currentWidth);\n  }\n  return width;\n}\n\n\n/**\n * @inheritDoc\n */\nCanvasTextReplay.prototype.drawText = function(geometry, feature) {\n  const fillState = this.textFillState_;\n  const strokeState = this.textStrokeState_;\n  const textState = this.textState_;\n  if (this.text_ === '' || !textState || (!fillState && !strokeState)) {\n    return;\n  }\n\n  let begin = this.coordinates.length;\n\n  const geometryType = geometry.getType();\n  let flatCoordinates = null;\n  let end = 2;\n  let stride = 2;\n  let i, ii;\n\n  if (textState.placement === TextPlacement.LINE) {\n    if (!intersects(this.getBufferedMaxExtent(), geometry.getExtent())) {\n      return;\n    }\n    let ends;\n    flatCoordinates = geometry.getFlatCoordinates();\n    stride = geometry.getStride();\n    if (geometryType == GeometryType.LINE_STRING) {\n      ends = [flatCoordinates.length];\n    } else if (geometryType == GeometryType.MULTI_LINE_STRING) {\n      ends = geometry.getEnds();\n    } else if (geometryType == GeometryType.POLYGON) {\n      ends = geometry.getEnds().slice(0, 1);\n    } else if (geometryType == GeometryType.MULTI_POLYGON) {\n      const endss = geometry.getEndss();\n      ends = [];\n      for (i = 0, ii = endss.length; i < ii; ++i) {\n        ends.push(endss[i][0]);\n      }\n    }\n    this.beginGeometry(geometry, feature);\n    const textAlign = textState.textAlign;\n    let flatOffset = 0;\n    let flatEnd;\n    for (let o = 0, oo = ends.length; o < oo; ++o) {\n      if (textAlign == undefined) {\n        const range = matchingChunk(textState.maxAngle, flatCoordinates, flatOffset, ends[o], stride);\n        flatOffset = range[0];\n        flatEnd = range[1];\n      } else {\n        flatEnd = ends[o];\n      }\n      for (i = flatOffset; i < flatEnd; i += stride) {\n        this.coordinates.push(flatCoordinates[i], flatCoordinates[i + 1]);\n      }\n      end = this.coordinates.length;\n      flatOffset = ends[o];\n      this.drawChars_(begin, end, this.declutterGroup_);\n      begin = end;\n    }\n    this.endGeometry(geometry, feature);\n\n  } else {\n    const label = this.getImage(this.text_, this.textKey_, this.fillKey_, this.strokeKey_);\n    const width = label.width / this.pixelRatio;\n    switch (geometryType) {\n      case GeometryType.POINT:\n      case GeometryType.MULTI_POINT:\n        flatCoordinates = geometry.getFlatCoordinates();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/LineString} */ (geometry).getFlatMidpoint();\n        break;\n      case GeometryType.CIRCLE:\n        flatCoordinates = /** @type {module:ol/geom/Circle} */ (geometry).getCenter();\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/MultiLineString} */ (geometry).getFlatMidpoints();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.POLYGON:\n        flatCoordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getFlatInteriorPoint();\n        if (!textState.overflow && flatCoordinates[2] / this.resolution < width) {\n          return;\n        }\n        stride = 3;\n        break;\n      case GeometryType.MULTI_POLYGON:\n        const interiorPoints = /** @type {module:ol/geom/MultiPolygon} */ (geometry).getFlatInteriorPoints();\n        flatCoordinates = [];\n        for (i = 0, ii = interiorPoints.length; i < ii; i += 3) {\n          if (textState.overflow || interiorPoints[i + 2] / this.resolution >= width) {\n            flatCoordinates.push(interiorPoints[i], interiorPoints[i + 1]);\n          }\n        }\n        end = flatCoordinates.length;\n        if (end == 0) {\n          return;\n        }\n        break;\n      default:\n    }\n    end = this.appendFlatCoordinates(flatCoordinates, 0, end, stride, false, false);\n    if (textState.backgroundFill || textState.backgroundStroke) {\n      this.setFillStrokeStyle(textState.backgroundFill, textState.backgroundStroke);\n      if (textState.backgroundFill) {\n        this.updateFillStyle(this.state, this.createFill, geometry);\n        this.hitDetectionInstructions.push(this.createFill(this.state, geometry));\n      }\n      if (textState.backgroundStroke) {\n        this.updateStrokeStyle(this.state, this.applyStroke);\n        this.hitDetectionInstructions.push(this.createStroke(this.state));\n      }\n    }\n    this.beginGeometry(geometry, feature);\n    this.drawTextImage_(label, begin, end);\n    this.endGeometry(geometry, feature);\n  }\n};\n\n\n/**\n * @param {string} text Text.\n * @param {string} textKey Text style key.\n * @param {string} fillKey Fill style key.\n * @param {string} strokeKey Stroke style key.\n * @return {HTMLCanvasElement} Image.\n */\nCanvasTextReplay.prototype.getImage = function(text, textKey, fillKey, strokeKey) {\n  let label;\n  const key = strokeKey + textKey + text + fillKey + this.pixelRatio;\n\n  if (!labelCache.containsKey(key)) {\n    const strokeState = strokeKey ? this.strokeStates[strokeKey] || this.textStrokeState_ : null;\n    const fillState = fillKey ? this.fillStates[fillKey] || this.textFillState_ : null;\n    const textState = this.textStates[textKey] || this.textState_;\n    const pixelRatio = this.pixelRatio;\n    const scale = textState.scale * pixelRatio;\n    const align =  TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n    const strokeWidth = strokeKey && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n    const lines = text.split('\\n');\n    const numLines = lines.length;\n    const widths = [];\n    const width = measureTextWidths(textState.font, lines, widths);\n    const lineHeight = measureTextHeight(textState.font);\n    const height = lineHeight * numLines;\n    const renderWidth = (width + strokeWidth);\n    const context = createCanvasContext2D(\n      Math.ceil(renderWidth * scale),\n      Math.ceil((height + strokeWidth) * scale));\n    label = context.canvas;\n    labelCache.set(key, label);\n    if (scale != 1) {\n      context.scale(scale, scale);\n    }\n    context.font = textState.font;\n    if (strokeKey) {\n      context.strokeStyle = strokeState.strokeStyle;\n      context.lineWidth = strokeWidth;\n      context.lineCap = strokeState.lineCap;\n      context.lineJoin = strokeState.lineJoin;\n      context.miterLimit = strokeState.miterLimit;\n      if (CANVAS_LINE_DASH && strokeState.lineDash.length) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n    }\n    if (fillKey) {\n      context.fillStyle = fillState.fillStyle;\n    }\n    context.textBaseline = 'middle';\n    context.textAlign = 'center';\n    const leftRight = (0.5 - align);\n    const x = align * label.width / scale + leftRight * strokeWidth;\n    let i;\n    if (strokeKey) {\n      for (i = 0; i < numLines; ++i) {\n        context.strokeText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n      }\n    }\n    if (fillKey) {\n      for (i = 0; i < numLines; ++i) {\n        context.fillText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n      }\n    }\n  }\n  return labelCache.get(key);\n};\n\n\n/**\n * @private\n * @param {HTMLCanvasElement} label Label.\n * @param {number} begin Begin.\n * @param {number} end End.\n */\nCanvasTextReplay.prototype.drawTextImage_ = function(label, begin, end) {\n  const textState = this.textState_;\n  const strokeState = this.textStrokeState_;\n  const pixelRatio = this.pixelRatio;\n  const align = TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n  const baseline = TEXT_ALIGN[textState.textBaseline];\n  const strokeWidth = strokeState && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n  const anchorX = align * label.width / pixelRatio + 2 * (0.5 - align) * strokeWidth;\n  const anchorY = baseline * label.height / pixelRatio + 2 * (0.5 - baseline) * strokeWidth;\n  this.instructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n    label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n    this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n    1, true, label.width,\n    textState.padding == defaultPadding ?\n      defaultPadding : textState.padding.map(function(p) {\n        return p * pixelRatio;\n      }),\n    !!textState.backgroundFill, !!textState.backgroundStroke\n  ]);\n  this.hitDetectionInstructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n    label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n    this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n    1 / pixelRatio, true, label.width, textState.padding,\n    !!textState.backgroundFill, !!textState.backgroundStroke\n  ]);\n};\n\n\n/**\n * @private\n * @param {number} begin Begin.\n * @param {number} end End.\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n */\nCanvasTextReplay.prototype.drawChars_ = function(begin, end, declutterGroup) {\n  const strokeState = this.textStrokeState_;\n  const textState = this.textState_;\n  const fillState = this.textFillState_;\n\n  const strokeKey = this.strokeKey_;\n  if (strokeState) {\n    if (!(strokeKey in this.strokeStates)) {\n      this.strokeStates[strokeKey] = /** @type {module:ol/render/canvas~StrokeState} */ ({\n        strokeStyle: strokeState.strokeStyle,\n        lineCap: strokeState.lineCap,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineWidth: strokeState.lineWidth,\n        lineJoin: strokeState.lineJoin,\n        miterLimit: strokeState.miterLimit,\n        lineDash: strokeState.lineDash\n      });\n    }\n  }\n  const textKey = this.textKey_;\n  if (!(this.textKey_ in this.textStates)) {\n    this.textStates[this.textKey_] = /** @type {module:ol/render/canvas~TextState} */ ({\n      font: textState.font,\n      textAlign: textState.textAlign || defaultTextAlign,\n      scale: textState.scale\n    });\n  }\n  const fillKey = this.fillKey_;\n  if (fillState) {\n    if (!(fillKey in this.fillStates)) {\n      this.fillStates[fillKey] = /** @type {module:ol/render/canvas~FillState} */ ({\n        fillStyle: fillState.fillStyle\n      });\n    }\n  }\n\n  const pixelRatio = this.pixelRatio;\n  const baseline = TEXT_ALIGN[textState.textBaseline];\n\n  const offsetY = this.textOffsetY_ * pixelRatio;\n  const text = this.text_;\n  const font = textState.font;\n  const textScale = textState.scale;\n  const strokeWidth = strokeState ? strokeState.lineWidth * textScale / 2 : 0;\n  let widths = this.widths_[font];\n  if (!widths) {\n    this.widths_[font] = widths = {};\n  }\n  this.instructions.push([CanvasInstruction.DRAW_CHARS,\n    begin, end, baseline, declutterGroup,\n    textState.overflow, fillKey, textState.maxAngle,\n    function(text) {\n      let width = widths[text];\n      if (!width) {\n        width = widths[text] = measureTextWidth(font, text);\n      }\n      return width * textScale * pixelRatio;\n    },\n    offsetY, strokeKey, strokeWidth * pixelRatio, text, textKey, 1\n  ]);\n  this.hitDetectionInstructions.push([CanvasInstruction.DRAW_CHARS,\n    begin, end, baseline, declutterGroup,\n    textState.overflow, fillKey, textState.maxAngle,\n    function(text) {\n      let width = widths[text];\n      if (!width) {\n        width = widths[text] = measureTextWidth(font, text);\n      }\n      return width * textScale;\n    },\n    offsetY, strokeKey, strokeWidth, text, textKey, 1 / pixelRatio\n  ]);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasTextReplay.prototype.setTextStyle = function(textStyle, declutterGroup) {\n  let textState, fillState, strokeState;\n  if (!textStyle) {\n    this.text_ = '';\n  } else {\n    this.declutterGroup_ = /** @type {module:ol/render/canvas~DeclutterGroup} */ (declutterGroup);\n\n    const textFillStyle = textStyle.getFill();\n    if (!textFillStyle) {\n      fillState = this.textFillState_ = null;\n    } else {\n      fillState = this.textFillState_;\n      if (!fillState) {\n        fillState = this.textFillState_ = /** @type {module:ol/render/canvas~FillState} */ ({});\n      }\n      fillState.fillStyle = asColorLike(\n        textFillStyle.getColor() || defaultFillStyle);\n    }\n\n    const textStrokeStyle = textStyle.getStroke();\n    if (!textStrokeStyle) {\n      strokeState = this.textStrokeState_ = null;\n    } else {\n      strokeState = this.textStrokeState_;\n      if (!strokeState) {\n        strokeState = this.textStrokeState_ = /** @type {module:ol/render/canvas~StrokeState} */ ({});\n      }\n      const lineDash = textStrokeStyle.getLineDash();\n      const lineDashOffset = textStrokeStyle.getLineDashOffset();\n      const lineWidth = textStrokeStyle.getWidth();\n      const miterLimit = textStrokeStyle.getMiterLimit();\n      strokeState.lineCap = textStrokeStyle.getLineCap() || defaultLineCap;\n      strokeState.lineDash = lineDash ? lineDash.slice() : defaultLineDash;\n      strokeState.lineDashOffset =\n          lineDashOffset === undefined ? defaultLineDashOffset : lineDashOffset;\n      strokeState.lineJoin = textStrokeStyle.getLineJoin() || defaultLineJoin;\n      strokeState.lineWidth =\n          lineWidth === undefined ? defaultLineWidth : lineWidth;\n      strokeState.miterLimit =\n          miterLimit === undefined ? defaultMiterLimit : miterLimit;\n      strokeState.strokeStyle = asColorLike(\n        textStrokeStyle.getColor() || defaultStrokeStyle);\n    }\n\n    textState = this.textState_;\n    const font = textStyle.getFont() || defaultFont;\n    checkFont(font);\n    const textScale = textStyle.getScale();\n    textState.overflow = textStyle.getOverflow();\n    textState.font = font;\n    textState.maxAngle = textStyle.getMaxAngle();\n    textState.placement = textStyle.getPlacement();\n    textState.textAlign = textStyle.getTextAlign();\n    textState.textBaseline = textStyle.getTextBaseline() || defaultTextBaseline;\n    textState.backgroundFill = textStyle.getBackgroundFill();\n    textState.backgroundStroke = textStyle.getBackgroundStroke();\n    textState.padding = textStyle.getPadding() || defaultPadding;\n    textState.scale = textScale === undefined ? 1 : textScale;\n\n    const textOffsetX = textStyle.getOffsetX();\n    const textOffsetY = textStyle.getOffsetY();\n    const textRotateWithView = textStyle.getRotateWithView();\n    const textRotation = textStyle.getRotation();\n    this.text_ = textStyle.getText() || '';\n    this.textOffsetX_ = textOffsetX === undefined ? 0 : textOffsetX;\n    this.textOffsetY_ = textOffsetY === undefined ? 0 : textOffsetY;\n    this.textRotateWithView_ = textRotateWithView === undefined ? false : textRotateWithView;\n    this.textRotation_ = textRotation === undefined ? 0 : textRotation;\n\n    this.strokeKey_ = strokeState ?\n      (typeof strokeState.strokeStyle == 'string' ? strokeState.strokeStyle : getUid(strokeState.strokeStyle)) +\n      strokeState.lineCap + strokeState.lineDashOffset + '|' + strokeState.lineWidth +\n      strokeState.lineJoin + strokeState.miterLimit + '[' + strokeState.lineDash.join() + ']' :\n      '';\n    this.textKey_ = textState.font + textState.scale + (textState.textAlign || '?');\n    this.fillKey_ = fillState ?\n      (typeof fillState.fillStyle == 'string' ? fillState.fillStyle : ('|' + getUid(fillState.fillStyle))) :\n      '';\n  }\n};\nexport default CanvasTextReplay;\n","/**\n * @module ol/render/canvas/ReplayGroup\n */\nimport {inherits} from '../../index.js';\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {buffer, createEmpty, extendCoordinate} from '../../extent.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {isEmpty} from '../../obj.js';\nimport ReplayGroup from '../ReplayGroup.js';\nimport ReplayType from '../ReplayType.js';\nimport CanvasReplay from '../canvas/Replay.js';\nimport CanvasImageReplay from '../canvas/ImageReplay.js';\nimport CanvasLineStringReplay from '../canvas/LineStringReplay.js';\nimport CanvasPolygonReplay from '../canvas/PolygonReplay.js';\nimport CanvasTextReplay from '../canvas/TextReplay.js';\nimport {ORDER} from '../replay.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n\n/**\n * @type {Object.<module:ol/render/ReplayType,\n *                function(new: module:ol/render/canvas/Replay, number, module:ol/extent~Extent,\n *                number, number, boolean, Array.<module:ol/render/canvas~DeclutterGroup>)>}\n */\nconst BATCH_CONSTRUCTORS = {\n  'Circle': CanvasPolygonReplay,\n  'Default': CanvasReplay,\n  'Image': CanvasImageReplay,\n  'LineString': CanvasLineStringReplay,\n  'Polygon': CanvasPolygonReplay,\n  'Text': CanvasTextReplay\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/render/ReplayGroup}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay group can have overlapping geometries.\n * @param {?} declutterTree Declutter tree\n * for declutter processing in postrender.\n * @param {number=} opt_renderBuffer Optional rendering buffer.\n * @struct\n */\nconst CanvasReplayGroup = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree, opt_renderBuffer) {\n  ReplayGroup.call(this);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = declutterTree;\n\n  /**\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   * @private\n   */\n  this.declutterGroup_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tolerance_ = tolerance;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent_ = maxExtent;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overlaps_ = overlaps;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.resolution_ = resolution;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.renderBuffer_ = opt_renderBuffer;\n\n  /**\n   * @private\n   * @type {!Object.<string, !Object.<module:ol/render/ReplayType, module:ol/render/canvas/Replay>>}\n   */\n  this.replaysByZIndex_ = {};\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitDetectionContext_ = createCanvasContext2D(1, 1);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.hitDetectionTransform_ = createTransform();\n};\n\ninherits(CanvasReplayGroup, ReplayGroup);\n\n\n/**\n * This cache is used for storing calculated pixel circles for increasing performance.\n * It is a static property to allow each Replaygroup to access it.\n * @type {Object.<number, Array.<Array.<(boolean|undefined)>>>}\n */\nconst circleArrayCache = {\n  0: [[true]]\n};\n\n\n/**\n * This method fills a row in the array from the given coordinate to the\n * middle with `true`.\n * @param {Array.<Array.<(boolean|undefined)>>} array The array that will be altered.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n */\nfunction fillCircleArrayRowToMiddle(array, x, y) {\n  let i;\n  const radius = Math.floor(array.length / 2);\n  if (x >= radius) {\n    for (i = radius; i < x; i++) {\n      array[i][y] = true;\n    }\n  } else if (x < radius) {\n    for (i = x + 1; i < radius; i++) {\n      array[i][y] = true;\n    }\n  }\n}\n\n\n/**\n * This methods creates a circle inside a fitting array. Points inside the\n * circle are marked by true, points on the outside are undefined.\n * It uses the midpoint circle algorithm.\n * A cache is used to increase performance.\n * @param {number} radius Radius.\n * @returns {Array.<Array.<(boolean|undefined)>>} An array with marked circle points.\n */\nexport function getCircleArray(radius) {\n  if (circleArrayCache[radius] !== undefined) {\n    return circleArrayCache[radius];\n  }\n\n  const arraySize = radius * 2 + 1;\n  const arr = new Array(arraySize);\n  for (let i = 0; i < arraySize; i++) {\n    arr[i] = new Array(arraySize);\n  }\n\n  let x = radius;\n  let y = 0;\n  let error = 0;\n\n  while (x >= y) {\n    fillCircleArrayRowToMiddle(arr, radius + x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius - y);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + x, radius - y);\n\n    y++;\n    error += 1 + 2 * y;\n    if (2 * (error - x) + 1 > 0) {\n      x -= 1;\n      error += 1 - 2 * x;\n    }\n  }\n\n  circleArrayCache[radius] = arr;\n  return arr;\n}\n\n\n/**\n * @param {!Object.<string, Array.<*>>} declutterReplays Declutter replays.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n */\nexport function replayDeclutter(declutterReplays, context, rotation) {\n  const zs = Object.keys(declutterReplays).map(Number).sort(numberSafeCompareFunction);\n  const skippedFeatureUids = {};\n  for (let z = 0, zz = zs.length; z < zz; ++z) {\n    const replayData = declutterReplays[zs[z].toString()];\n    for (let i = 0, ii = replayData.length; i < ii;) {\n      const replay = replayData[i++];\n      const transform = replayData[i++];\n      replay.replay(context, transform, rotation, skippedFeatureUids);\n    }\n  }\n}\n\n\n/**\n * @param {boolean} group Group with previous replay.\n * @return {module:ol/render/canvas~DeclutterGroup} Declutter instruction group.\n */\nCanvasReplayGroup.prototype.addDeclutter = function(group) {\n  let declutter = null;\n  if (this.declutterTree_) {\n    if (group) {\n      declutter = this.declutterGroup_;\n      /** @type {number} */ (declutter[4])++;\n    } else {\n      declutter = this.declutterGroup_ = createEmpty();\n      declutter.push(1);\n    }\n  }\n  return declutter;\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n */\nCanvasReplayGroup.prototype.clip = function(context, transform) {\n  const flatClipCoords = this.getClipCoords(transform);\n  context.beginPath();\n  context.moveTo(flatClipCoords[0], flatClipCoords[1]);\n  context.lineTo(flatClipCoords[2], flatClipCoords[3]);\n  context.lineTo(flatClipCoords[4], flatClipCoords[5]);\n  context.lineTo(flatClipCoords[6], flatClipCoords[7]);\n  context.clip();\n};\n\n\n/**\n * @param {Array.<module:ol/render/ReplayType>} replays Replays.\n * @return {boolean} Has replays of the provided types.\n */\nCanvasReplayGroup.prototype.hasReplays = function(replays) {\n  for (const zIndex in this.replaysByZIndex_) {\n    const candidates = this.replaysByZIndex_[zIndex];\n    for (let i = 0, ii = replays.length; i < ii; ++i) {\n      if (replays[i] in candidates) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nCanvasReplayGroup.prototype.finish = function() {\n  for (const zKey in this.replaysByZIndex_) {\n    const replays = this.replaysByZIndex_[zKey];\n    for (const replayKey in replays) {\n      replays[replayKey].finish();\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T} callback Feature callback.\n * @param {Object.<string, module:ol/render/canvas~DeclutterGroup>} declutterReplays Declutter replays.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplayGroup.prototype.forEachFeatureAtCoordinate = function(\n  coordinate, resolution, rotation, hitTolerance, skippedFeaturesHash, callback, declutterReplays) {\n\n  hitTolerance = Math.round(hitTolerance);\n  const contextSize = hitTolerance * 2 + 1;\n  const transform = composeTransform(this.hitDetectionTransform_,\n    hitTolerance + 0.5, hitTolerance + 0.5,\n    1 / resolution, -1 / resolution,\n    -rotation,\n    -coordinate[0], -coordinate[1]);\n  const context = this.hitDetectionContext_;\n\n  if (context.canvas.width !== contextSize || context.canvas.height !== contextSize) {\n    context.canvas.width = contextSize;\n    context.canvas.height = contextSize;\n  } else {\n    context.clearRect(0, 0, contextSize, contextSize);\n  }\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  let hitExtent;\n  if (this.renderBuffer_ !== undefined) {\n    hitExtent = createEmpty();\n    extendCoordinate(hitExtent, coordinate);\n    buffer(hitExtent, resolution * (this.renderBuffer_ + hitTolerance), hitExtent);\n  }\n\n  const mask = getCircleArray(hitTolerance);\n  let declutteredFeatures;\n  if (this.declutterTree_) {\n    declutteredFeatures = this.declutterTree_.all().map(function(entry) {\n      return entry.value;\n    });\n  }\n\n  let replayType;\n\n  /**\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n   * @return {?} Callback result.\n   */\n  function featureCallback(feature) {\n    const imageData = context.getImageData(0, 0, contextSize, contextSize).data;\n    for (let i = 0; i < contextSize; i++) {\n      for (let j = 0; j < contextSize; j++) {\n        if (mask[i][j]) {\n          if (imageData[(j * contextSize + i) * 4 + 3] > 0) {\n            let result;\n            if (!(declutteredFeatures && (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) ||\n                declutteredFeatures.indexOf(feature) !== -1) {\n              result = callback(feature);\n            }\n            if (result) {\n              return result;\n            } else {\n              context.clearRect(0, 0, contextSize, contextSize);\n              return undefined;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  let i, j, replays, replay, result;\n  for (i = zs.length - 1; i >= 0; --i) {\n    const zIndexKey = zs[i].toString();\n    replays = this.replaysByZIndex_[zIndexKey];\n    for (j = ORDER.length - 1; j >= 0; --j) {\n      replayType = ORDER[j];\n      replay = replays[replayType];\n      if (replay !== undefined) {\n        if (declutterReplays &&\n            (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n          const declutter = declutterReplays[zIndexKey];\n          if (!declutter) {\n            declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n          } else {\n            declutter.push(replay, transform.slice(0));\n          }\n        } else {\n          result = replay.replayHitDetection(context, transform, rotation,\n            skippedFeaturesHash, featureCallback, hitExtent);\n          if (result) {\n            return result;\n          }\n        }\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @param {module:ol/transform~Transform} transform Transform.\n * @return {Array.<number>} Clip coordinates.\n */\nCanvasReplayGroup.prototype.getClipCoords = function(transform) {\n  const maxExtent = this.maxExtent_;\n  const minX = maxExtent[0];\n  const minY = maxExtent[1];\n  const maxX = maxExtent[2];\n  const maxY = maxExtent[3];\n  const flatClipCoords = [minX, minY, minX, maxY, maxX, maxY, maxX, minY];\n  transform2D(\n    flatClipCoords, 0, 8, 2, transform, flatClipCoords);\n  return flatClipCoords;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplayGroup.prototype.getReplay = function(zIndex, replayType) {\n  const zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n  let replays = this.replaysByZIndex_[zIndexKey];\n  if (replays === undefined) {\n    replays = {};\n    this.replaysByZIndex_[zIndexKey] = replays;\n  }\n  let replay = replays[replayType];\n  if (replay === undefined) {\n    const Constructor = BATCH_CONSTRUCTORS[replayType];\n    replay = new Constructor(this.tolerance_, this.maxExtent_,\n      this.resolution_, this.pixelRatio_, this.overlaps_, this.declutterTree_);\n    replays[replayType] = replay;\n  }\n  return replay;\n};\n\n\n/**\n * @return {Object.<string, Object.<module:ol/render/ReplayType, module:ol/render/canvas/Replay>>} Replays.\n */\nCanvasReplayGroup.prototype.getReplays = function() {\n  return this.replaysByZIndex_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplayGroup.prototype.isEmpty = function() {\n  return isEmpty(this.replaysByZIndex_);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {Array.<module:ol/render/ReplayType>=} opt_replayTypes Ordered replay types to replay.\n *     Default is {@link module:ol/render/replay~ORDER}\n * @param {Object.<string, module:ol/render/canvas~DeclutterGroup>=} opt_declutterReplays Declutter replays.\n */\nCanvasReplayGroup.prototype.replay = function(context,\n  transform, viewRotation, skippedFeaturesHash, opt_replayTypes, opt_declutterReplays) {\n\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  // setup clipping so that the parts of over-simplified geometries are not\n  // visible outside the current extent when panning\n  context.save();\n  this.clip(context, transform);\n\n  const replayTypes = opt_replayTypes ? opt_replayTypes : ORDER;\n  let i, ii, j, jj, replays, replay;\n  for (i = 0, ii = zs.length; i < ii; ++i) {\n    const zIndexKey = zs[i].toString();\n    replays = this.replaysByZIndex_[zIndexKey];\n    for (j = 0, jj = replayTypes.length; j < jj; ++j) {\n      const replayType = replayTypes[j];\n      replay = replays[replayType];\n      if (replay !== undefined) {\n        if (opt_declutterReplays &&\n            (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n          const declutter = opt_declutterReplays[zIndexKey];\n          if (!declutter) {\n            opt_declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n          } else {\n            declutter.push(replay, transform.slice(0));\n          }\n        } else {\n          replay.replay(context, transform, viewRotation, skippedFeaturesHash);\n        }\n      }\n    }\n  }\n\n  context.restore();\n};\n\nexport default CanvasReplayGroup;\n","/**\n * @module ol/renderer/vector\n */\nimport {getUid} from '../index.js';\nimport ImageState from '../ImageState.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nconst SIMPLIFY_TOLERANCE = 0.5;\n\n\n/**\n * @const\n * @type {Object.<module:ol/geom/GeometryType,\n *                function(module:ol/render/ReplayGroup, module:ol/geom/Geometry,\n *                         module:ol/style/Style, Object)>}\n */\nconst GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature1 Feature 1.\n * @param {module:ol/Feature|module:ol/render/Feature} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return getUid(feature1) - getUid(feature2);\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  const tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return SIMPLIFY_TOLERANCE * resolution / pixelRatio;\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderCircleGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const circleReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.CIRCLE);\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {boolean} `true` if style is loading.\n * @template T\n */\nexport function renderFeature(replayGroup, feature, style, squaredTolerance, listener, thisArg) {\n  let loading = false;\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    let imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      imageStyle.unlistenImageChange(listener, thisArg);\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n      imageState = imageStyle.getImageState();\n      imageStyle.listenImageChange(listener, thisArg);\n      loading = true;\n    }\n  }\n  renderFeatureInternal(replayGroup, feature, style, squaredTolerance);\n\n  return loading;\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n */\nfunction renderFeatureInternal(replayGroup, feature, style, squaredTolerance) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  const simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n  const renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature);\n  } else {\n    const geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(replayGroup, simplifiedGeometry, style, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature) {\n  if (geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature);\n    }\n    return;\n  }\n  const replay = replayGroup.getReplay(style.getZIndex(), ReplayType.DEFAULT);\n  replay.drawCustom(/** @type {module:ol/geom/SimpleGeometry} */ (geometry), feature, style.getRenderer());\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderGeometryCollectionGeometry(replayGroup, geometry, style, feature) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    const geometryRenderer =\n        GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(replayGroup, geometries[i], style, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/LineString|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderMultiLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderMultiPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Point|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderMultiPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawMultiPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n","/**\n * @module ol/renderer/canvas/VectorLayer\n */\nimport {getUid, inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, createEmpty, containsExtent, getWidth} from '../../extent.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup from '../../render/canvas/ReplayGroup.js';\nimport CanvasLayerRenderer from '../canvas/Layer.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/Layer}\n * @param {module:ol/layer/Vector} vectorLayer Vector layer.\n * @api\n */\nconst CanvasVectorLayerRenderer = function(vectorLayer) {\n\n  CanvasLayerRenderer.call(this, vectorLayer);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = vectorLayer.getDeclutter() ? rbush(9, undefined) : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedResolution_ = NaN;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {function(module:ol/Feature, module:ol/Feature): number|null}\n   */\n  this.renderedRenderOrder_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas/ReplayGroup}\n   */\n  this.replayGroup_ = null;\n\n  /**\n   * A new replay group had to be created by `prepareFrame()`\n   * @type {boolean}\n   */\n  this.replayGroupChanged = true;\n\n  /**\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = createCanvasContext2D();\n\n  listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n};\n\ninherits(CanvasVectorLayerRenderer, CanvasLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/VectorLayer} The layer renderer.\n */\nCanvasVectorLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorLayerRenderer(/** @type {module:ol/layer/Vector} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.disposeInternal = function() {\n  unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n  CanvasLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n */\nCanvasVectorLayerRenderer.prototype.compose = function(context, frameState, layerState) {\n  const extent = frameState.extent;\n  const pixelRatio = frameState.pixelRatio;\n  const skippedFeatureUids = layerState.managed ?\n    frameState.skippedFeatureUids : {};\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const rotation = viewState.rotation;\n  const projectionExtent = projection.getExtent();\n  const vectorSource = /** @type {module:ol/source/Vector} */ (this.getLayer().getSource());\n\n  let transform = this.getTransform(frameState, 0);\n\n  // clipped rendering if layer extent is set\n  const clipExtent = layerState.extent;\n  const clipped = clipExtent !== undefined;\n  if (clipped) {\n    this.clip(context, frameState,  /** @type {module:ol/extent~Extent} */ (clipExtent));\n  }\n  const replayGroup = this.replayGroup_;\n  if (replayGroup && !replayGroup.isEmpty()) {\n    if (this.declutterTree_) {\n      this.declutterTree_.clear();\n    }\n    const layer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n    let drawOffsetX = 0;\n    let drawOffsetY = 0;\n    let replayContext;\n    const transparentLayer = layerState.opacity !== 1;\n    const hasRenderListeners = layer.hasListener(RenderEventType.RENDER);\n    if (transparentLayer || hasRenderListeners) {\n      let drawWidth = context.canvas.width;\n      let drawHeight = context.canvas.height;\n      if (rotation) {\n        const drawSize = Math.round(Math.sqrt(drawWidth * drawWidth + drawHeight * drawHeight));\n        drawOffsetX = (drawSize - drawWidth) / 2;\n        drawOffsetY = (drawSize - drawHeight) / 2;\n        drawWidth = drawHeight = drawSize;\n      }\n      // resize and clear\n      this.context.canvas.width = drawWidth;\n      this.context.canvas.height = drawHeight;\n      replayContext = this.context;\n    } else {\n      replayContext = context;\n    }\n\n    const alpha = replayContext.globalAlpha;\n    if (!transparentLayer) {\n      // for performance reasons, context.save / context.restore is not used\n      // to save and restore the transformation matrix and the opacity.\n      // see http://jsperf.com/context-save-restore-versus-variable\n      replayContext.globalAlpha = layerState.opacity;\n    }\n\n    if (replayContext != context) {\n      replayContext.translate(drawOffsetX, drawOffsetY);\n    }\n\n    const width = frameState.size[0] * pixelRatio;\n    const height = frameState.size[1] * pixelRatio;\n    rotateAtOffset(replayContext, -rotation,\n      width / 2, height / 2);\n    replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n    if (vectorSource.getWrapX() && projection.canWrapX() &&\n        !containsExtent(projectionExtent, extent)) {\n      let startX = extent[0];\n      const worldWidth = getWidth(projectionExtent);\n      let world = 0;\n      let offsetX;\n      while (startX < projectionExtent[0]) {\n        --world;\n        offsetX = worldWidth * world;\n        transform = this.getTransform(frameState, offsetX);\n        replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n        startX += worldWidth;\n      }\n      world = 0;\n      startX = extent[2];\n      while (startX > projectionExtent[2]) {\n        ++world;\n        offsetX = worldWidth * world;\n        transform = this.getTransform(frameState, offsetX);\n        replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n        startX -= worldWidth;\n      }\n    }\n    rotateAtOffset(replayContext, rotation,\n      width / 2, height / 2);\n\n    if (replayContext != context) {\n      if (hasRenderListeners) {\n        this.dispatchRenderEvent(replayContext, frameState, transform);\n      }\n      if (transparentLayer) {\n        const mainContextAlpha = context.globalAlpha;\n        context.globalAlpha = layerState.opacity;\n        context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n        context.globalAlpha = mainContextAlpha;\n      } else {\n        context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n      }\n      replayContext.translate(-drawOffsetX, -drawOffsetY);\n    }\n\n    if (!transparentLayer) {\n      replayContext.globalAlpha = alpha;\n    }\n  }\n\n  if (clipped) {\n    context.restore();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n  const transform = this.getTransform(frameState, 0);\n  this.preCompose(context, frameState, transform);\n  this.compose(context, frameState, layerState);\n  this.postCompose(context, frameState, layerState, transform);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (!this.replayGroup_) {\n    return undefined;\n  } else {\n    const resolution = frameState.viewState.resolution;\n    const rotation = frameState.viewState.rotation;\n    const layer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n    /** @type {!Object.<string, boolean>} */\n    const features = {};\n    const result = this.replayGroup_.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n      /**\n       * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n       * @return {?} Callback result.\n       */\n      function(feature) {\n        const key = getUid(feature).toString();\n        if (!(key in features)) {\n          features[key] = true;\n          return callback.call(thisArg, feature, layer);\n        }\n      }, null);\n    return result;\n  }\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n */\nCanvasVectorLayerRenderer.prototype.handleFontsChanged_ = function(event) {\n  const layer = this.getLayer();\n  if (layer.getVisible() && this.replayGroup_) {\n    layer.changed();\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nCanvasVectorLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n  const vectorLayer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n  const vectorSource = vectorLayer.getSource();\n\n  const animating = frameState.viewHints[ViewHint.ANIMATING];\n  const interacting = frameState.viewHints[ViewHint.INTERACTING];\n  const updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n  const updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n  if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n      (!updateWhileInteracting && interacting)) {\n    return true;\n  }\n\n  const frameStateExtent = frameState.extent;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const resolution = viewState.resolution;\n  const pixelRatio = frameState.pixelRatio;\n  const vectorLayerRevision = vectorLayer.getRevision();\n  const vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n  let vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n  if (vectorLayerRenderOrder === undefined) {\n    vectorLayerRenderOrder = defaultRenderOrder;\n  }\n\n  const extent = buffer(frameStateExtent,\n    vectorLayerRenderBuffer * resolution);\n  const projectionExtent = viewState.projection.getExtent();\n\n  if (vectorSource.getWrapX() && viewState.projection.canWrapX() &&\n      !containsExtent(projectionExtent, frameState.extent)) {\n    // For the replay group, we need an extent that intersects the real world\n    // (-180° to +180°). To support geometries in a coordinate range from -540°\n    // to +540°, we add at least 1 world width on each side of the projection\n    // extent. If the viewport is wider than the world, we need to add half of\n    // the viewport width to make sure we cover the whole viewport.\n    const worldWidth = getWidth(projectionExtent);\n    const gutter = Math.max(getWidth(extent) / 2, worldWidth);\n    extent[0] = projectionExtent[0] - gutter;\n    extent[2] = projectionExtent[2] + gutter;\n  }\n\n  if (!this.dirty_ &&\n      this.renderedResolution_ == resolution &&\n      this.renderedRevision_ == vectorLayerRevision &&\n      this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n      containsExtent(this.renderedExtent_, extent)) {\n    this.replayGroupChanged = false;\n    return true;\n  }\n\n  this.replayGroup_ = null;\n\n  this.dirty_ = false;\n\n  const replayGroup = new CanvasReplayGroup(\n    getRenderTolerance(resolution, pixelRatio), extent, resolution,\n    pixelRatio, vectorSource.getOverlaps(), this.declutterTree_, vectorLayer.getRenderBuffer());\n  vectorSource.loadFeatures(extent, resolution, projection);\n  /**\n   * @param {module:ol/Feature} feature Feature.\n   * @this {module:ol/renderer/canvas/VectorLayer}\n   */\n  const render = function(feature) {\n    let styles;\n    const styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n    if (styleFunction) {\n      styles = styleFunction(feature, resolution);\n    }\n    if (styles) {\n      const dirty = this.renderFeature(\n        feature, resolution, pixelRatio, styles, replayGroup);\n      this.dirty_ = this.dirty_ || dirty;\n    }\n  }.bind(this);\n  if (vectorLayerRenderOrder) {\n    /** @type {Array.<module:ol/Feature>} */\n    const features = [];\n    vectorSource.forEachFeatureInExtent(extent,\n      /**\n       * @param {module:ol/Feature} feature Feature.\n       */\n      function(feature) {\n        features.push(feature);\n      }, this);\n    features.sort(vectorLayerRenderOrder);\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      render(features[i]);\n    }\n  } else {\n    vectorSource.forEachFeatureInExtent(extent, render, this);\n  }\n  replayGroup.finish();\n\n  this.renderedResolution_ = resolution;\n  this.renderedRevision_ = vectorLayerRevision;\n  this.renderedRenderOrder_ = vectorLayerRenderOrder;\n  this.renderedExtent_ = extent;\n  this.replayGroup_ = replayGroup;\n\n  this.replayGroupChanged = true;\n  return true;\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of styles.\n * @param {module:ol/render/canvas/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nCanvasVectorLayerRenderer.prototype.renderFeature = function(feature, resolution, pixelRatio, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = 0, ii = styles.length; i < ii; ++i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i],\n        getSquaredRenderTolerance(resolution, pixelRatio),\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles,\n      getSquaredRenderTolerance(resolution, pixelRatio),\n      this.handleStyleImageChange_, this);\n  }\n  return loading;\n};\nexport default CanvasVectorLayerRenderer;\n","/**\n * @module ol/layer/VectorTileRenderType\n */\n\n/**\n * @enum {string}\n * Render mode for vector tiles:\n *  * `'image'`: Vector tiles are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'hybrid'`: Polygon and line elements are rendered as images, so pixels\n *    are scaled during zoom animations. Point symbols and texts are accurately\n *    rendered as vectors and can stay upright on rotated views.\n *  * `'vector'`: Vector tiles are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance than the other options.\n * @api\n */\nexport default {\n  IMAGE: 'image',\n  HYBRID: 'hybrid',\n  VECTOR: 'vector'\n};\n","/**\n * @module ol/renderer/canvas/VectorTileLayer\n */\nimport {getUid, inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport TileState from '../../TileState.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, containsCoordinate, equals, getIntersection, getTopLeft, intersects} from '../../extent.js';\nimport VectorTileRenderType from '../../layer/VectorTileRenderType.js';\nimport {equivalent as equivalentProjection} from '../../proj.js';\nimport Units from '../../proj/Units.js';\nimport ReplayType from '../../render/ReplayType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup, {replayDeclutter} from '../../render/canvas/ReplayGroup.js';\nimport {ORDER} from '../../render/replay.js';\nimport CanvasTileLayerRenderer from '../canvas/TileLayer.js';\nimport {getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  reset as resetTransform,\n  scale as scaleTransform,\n  translate as translateTransform\n} from '../../transform.js';\n\n\n/**\n * @type {!Object.<string, Array.<module:ol/render/ReplayType>>}\n */\nconst IMAGE_REPLAYS = {\n  'image': [ReplayType.POLYGON, ReplayType.CIRCLE,\n    ReplayType.LINE_STRING, ReplayType.IMAGE, ReplayType.TEXT],\n  'hybrid': [ReplayType.POLYGON, ReplayType.LINE_STRING]\n};\n\n\n/**\n * @type {!Object.<string, Array.<module:ol/render/ReplayType>>}\n */\nconst VECTOR_REPLAYS = {\n  'image': [ReplayType.DEFAULT],\n  'hybrid': [ReplayType.IMAGE, ReplayType.TEXT, ReplayType.DEFAULT],\n  'vector': ORDER\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/TileLayer}\n * @param {module:ol/layer/VectorTile} layer VectorTile layer.\n * @api\n */\nconst CanvasVectorTileLayerRenderer = function(layer) {\n\n  /**\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = null;\n\n  CanvasTileLayerRenderer.call(this, layer);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = layer.getDeclutter() ? rbush(9, undefined) : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedLayerRevision_;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.tmpTransform_ = createTransform();\n\n  // Use lower resolution for pure vector rendering. Closest resolution otherwise.\n  this.zDirection = layer.getRenderMode() == VectorTileRenderType.VECTOR ? 1 : 0;\n\n  listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n};\n\ninherits(CanvasVectorTileLayerRenderer, CanvasTileLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR_TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/VectorTileLayer} The layer renderer.\n */\nCanvasVectorTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorTileLayerRenderer(/** @type {module:ol/layer/VectorTile} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.disposeInternal = function() {\n  unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n  CanvasTileLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const tile = CanvasTileLayerRenderer.prototype.getTile.call(this, z, x, y, pixelRatio, projection);\n  if (tile.getState() === TileState.LOADED) {\n    this.createReplayGroup_(tile, pixelRatio, projection);\n    if (this.context) {\n      this.renderTileImage_(tile, pixelRatio, projection);\n    }\n  }\n  return tile;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n  const layer = this.getLayer();\n  const layerRevision = layer.getRevision();\n  if (this.renderedLayerRevision_ != layerRevision) {\n    this.renderedTiles.length = 0;\n    const renderMode = layer.getRenderMode();\n    if (!this.context && renderMode != VectorTileRenderType.VECTOR) {\n      this.context = createCanvasContext2D();\n    }\n    if (this.context && renderMode == VectorTileRenderType.VECTOR) {\n      this.context = null;\n    }\n  }\n  this.renderedLayerRevision_ = layerRevision;\n  return CanvasTileLayerRenderer.prototype.prepareFrame.apply(this, arguments);\n};\n\n\n/**\n * @param {module:ol/VectorImageTile} tile Tile.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.createReplayGroup_ = function(tile, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const revision = layer.getRevision();\n  const renderOrder = /** @type {module:ol/render~OrderFunction} */ (layer.getRenderOrder()) || null;\n\n  const replayState = tile.getReplayState(layer);\n  if (!replayState.dirty && replayState.renderedRevision == revision &&\n      replayState.renderedRenderOrder == renderOrder) {\n    return;\n  }\n\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const sourceTileGrid = source.getTileGrid();\n  const tileGrid = source.getTileGridForProjection(projection);\n  const resolution = tileGrid.getResolution(tile.tileCoord[0]);\n  const tileExtent = tile.extent;\n\n  const zIndexKeys = {};\n  for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n    const sourceTile = tile.getTile(tile.tileKeys[t]);\n    if (sourceTile.getState() != TileState.LOADED) {\n      continue;\n    }\n\n    const sourceTileCoord = sourceTile.tileCoord;\n    const sourceTileExtent = sourceTileGrid.getTileCoordExtent(sourceTileCoord);\n    const sharedExtent = getIntersection(tileExtent, sourceTileExtent);\n    const bufferedExtent = equals(sourceTileExtent, sharedExtent) ? null :\n      buffer(sharedExtent, layer.getRenderBuffer() * resolution, this.tmpExtent);\n    const tileProjection = sourceTile.getProjection();\n    let reproject = false;\n    if (!equivalentProjection(projection, tileProjection)) {\n      reproject = true;\n      sourceTile.setProjection(projection);\n    }\n    replayState.dirty = false;\n    const replayGroup = new CanvasReplayGroup(0, sharedExtent, resolution,\n      pixelRatio, source.getOverlaps(), this.declutterTree_, layer.getRenderBuffer());\n    const squaredTolerance = getSquaredRenderTolerance(resolution, pixelRatio);\n\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @this {module:ol/renderer/canvas/VectorTileLayer}\n     */\n    const render = function(feature) {\n      let styles;\n      const styleFunction = feature.getStyleFunction() || layer.getStyleFunction();\n      if (styleFunction) {\n        styles = styleFunction(feature, resolution);\n      }\n      if (styles) {\n        const dirty = this.renderFeature(feature, squaredTolerance, styles, replayGroup);\n        this.dirty_ = this.dirty_ || dirty;\n        replayState.dirty = replayState.dirty || dirty;\n      }\n    };\n\n    const features = sourceTile.getFeatures();\n    if (renderOrder && renderOrder !== replayState.renderedRenderOrder) {\n      features.sort(renderOrder);\n    }\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      const feature = features[i];\n      if (reproject) {\n        if (tileProjection.getUnits() == Units.TILE_PIXELS) {\n          // projected tile extent\n          tileProjection.setWorldExtent(sourceTileExtent);\n          // tile extent in tile pixel space\n          tileProjection.setExtent(sourceTile.getExtent());\n        }\n        feature.getGeometry().transform(tileProjection, projection);\n      }\n      if (!bufferedExtent || intersects(bufferedExtent, feature.getGeometry().getExtent())) {\n        render.call(this, feature);\n      }\n    }\n    replayGroup.finish();\n    for (const r in replayGroup.getReplays()) {\n      zIndexKeys[r] = true;\n    }\n    sourceTile.setReplayGroup(layer, tile.tileCoord.toString(), replayGroup);\n  }\n  replayState.renderedRevision = revision;\n  replayState.renderedRenderOrder = renderOrder;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  hitTolerance = hitTolerance == undefined ? 0 : hitTolerance;\n  const layer = this.getLayer();\n  /** @type {!Object.<string, boolean>} */\n  const features = {};\n\n  /** @type {Array.<module:ol/VectorImageTile>} */\n  const renderedTiles = this.renderedTiles;\n\n  let bufferedExtent, found;\n  let i, ii, replayGroup;\n  for (i = 0, ii = renderedTiles.length; i < ii; ++i) {\n    const tile = renderedTiles[i];\n    bufferedExtent = buffer(tile.extent, hitTolerance * resolution, bufferedExtent);\n    if (!containsCoordinate(bufferedExtent, coordinate)) {\n      continue;\n    }\n    for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n      const sourceTile = tile.getTile(tile.tileKeys[t]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      replayGroup = sourceTile.getReplayGroup(layer, tile.tileCoord.toString());\n      found = found || replayGroup.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @return {?} Callback result.\n         */\n        function(feature) {\n          const key = getUid(feature).toString();\n          if (!(key in features)) {\n            features[key] = true;\n            return callback.call(thisArg, feature, layer);\n          }\n        }, null);\n    }\n  }\n  return found;\n};\n\n\n/**\n * @param {module:ol/VectorTile} tile Tile.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {module:ol/transform~Transform} transform Transform.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.getReplayTransform_ = function(tile, frameState) {\n  const layer = this.getLayer();\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const tileGrid = source.getTileGrid();\n  const tileCoord = tile.tileCoord;\n  const tileResolution = tileGrid.getResolution(tileCoord[0]);\n  const viewState = frameState.viewState;\n  const pixelRatio = frameState.pixelRatio;\n  const renderResolution = viewState.resolution / pixelRatio;\n  const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n  const center = viewState.center;\n  const origin = getTopLeft(tileExtent);\n  const size = frameState.size;\n  const offsetX = Math.round(pixelRatio * size[0] / 2);\n  const offsetY = Math.round(pixelRatio * size[1] / 2);\n  return composeTransform(this.tmpTransform_,\n    offsetX, offsetY,\n    tileResolution / renderResolution, tileResolution / renderResolution,\n    viewState.rotation,\n    (origin[0] - center[0]) / tileResolution,\n    (center[1] - origin[1]) / tileResolution);\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n */\nCanvasVectorTileLayerRenderer.prototype.handleFontsChanged_ = function(event) {\n  const layer = this.getLayer();\n  if (layer.getVisible() && this.renderedLayerRevision_ !== undefined) {\n    layer.changed();\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.postCompose = function(context, frameState, layerState) {\n  const layer = this.getLayer();\n  const declutterReplays = layer.getDeclutter() ? {} : null;\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const renderMode = layer.getRenderMode();\n  const replayTypes = VECTOR_REPLAYS[renderMode];\n  const pixelRatio = frameState.pixelRatio;\n  const rotation = frameState.viewState.rotation;\n  const size = frameState.size;\n  let offsetX, offsetY;\n  if (rotation) {\n    offsetX = Math.round(pixelRatio * size[0] / 2);\n    offsetY = Math.round(pixelRatio * size[1] / 2);\n    rotateAtOffset(context, -rotation, offsetX, offsetY);\n  }\n  if (declutterReplays) {\n    this.declutterTree_.clear();\n  }\n  const tiles = this.renderedTiles;\n  const tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n  const clips = [];\n  const zs = [];\n  for (let i = tiles.length - 1; i >= 0; --i) {\n    const tile = /** @type {module:ol/VectorImageTile} */ (tiles[i]);\n    if (tile.getState() == TileState.ABORT) {\n      continue;\n    }\n    const tileCoord = tile.tileCoord;\n    const worldOffset = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent)[0] - tile.extent[0];\n    let transform = undefined;\n    for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n      const sourceTile = tile.getTile(tile.tileKeys[t]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      const replayGroup = sourceTile.getReplayGroup(layer, tileCoord.toString());\n      if (renderMode != VectorTileRenderType.VECTOR && !replayGroup.hasReplays(replayTypes)) {\n        continue;\n      }\n      if (!transform) {\n        transform = this.getTransform(frameState, worldOffset);\n      }\n      const currentZ = sourceTile.tileCoord[0];\n      const currentClip = replayGroup.getClipCoords(transform);\n      context.save();\n      context.globalAlpha = layerState.opacity;\n      // Create a clip mask for regions in this low resolution tile that are\n      // already filled by a higher resolution tile\n      for (let j = 0, jj = clips.length; j < jj; ++j) {\n        const clip = clips[j];\n        if (currentZ < zs[j]) {\n          context.beginPath();\n          // counter-clockwise (outer ring) for current tile\n          context.moveTo(currentClip[0], currentClip[1]);\n          context.lineTo(currentClip[2], currentClip[3]);\n          context.lineTo(currentClip[4], currentClip[5]);\n          context.lineTo(currentClip[6], currentClip[7]);\n          // clockwise (inner ring) for higher resolution tile\n          context.moveTo(clip[6], clip[7]);\n          context.lineTo(clip[4], clip[5]);\n          context.lineTo(clip[2], clip[3]);\n          context.lineTo(clip[0], clip[1]);\n          context.clip();\n        }\n      }\n      replayGroup.replay(context, transform, rotation, {}, replayTypes, declutterReplays);\n      context.restore();\n      clips.push(currentClip);\n      zs.push(currentZ);\n    }\n  }\n  if (declutterReplays) {\n    replayDeclutter(declutterReplays, context, rotation);\n  }\n  if (rotation) {\n    rotateAtOffset(context, rotation,\n      /** @type {number} */ (offsetX), /** @type {number} */ (offsetY));\n  }\n  CanvasTileLayerRenderer.prototype.postCompose.apply(this, arguments);\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of styles.\n * @param {module:ol/render/canvas/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nCanvasVectorTileLayerRenderer.prototype.renderFeature = function(feature, squaredTolerance, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = 0, ii = styles.length; i < ii; ++i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i], squaredTolerance,\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles, squaredTolerance,\n      this.handleStyleImageChange_, this);\n  }\n  return loading;\n};\n\n\n/**\n * @param {module:ol/VectorImageTile} tile Tile.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.renderTileImage_ = function(\n  tile, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const replayState = tile.getReplayState(layer);\n  const revision = layer.getRevision();\n  const replays = IMAGE_REPLAYS[layer.getRenderMode()];\n  if (replays && replayState.renderedTileRevision !== revision) {\n    replayState.renderedTileRevision = revision;\n    const tileCoord = tile.wrappedTileCoord;\n    const z = tileCoord[0];\n    const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n    const tileGrid = source.getTileGridForProjection(projection);\n    const resolution = tileGrid.getResolution(z);\n    const context = tile.getContext(layer);\n    const size = source.getTilePixelSize(z, pixelRatio, projection);\n    context.canvas.width = size[0];\n    context.canvas.height = size[1];\n    const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n    for (let i = 0, ii = tile.tileKeys.length; i < ii; ++i) {\n      const sourceTile = tile.getTile(tile.tileKeys[i]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      const pixelScale = pixelRatio / resolution;\n      const transform = resetTransform(this.tmpTransform_);\n      scaleTransform(transform, pixelScale, -pixelScale);\n      translateTransform(transform, -tileExtent[0], -tileExtent[3]);\n      const replayGroup = sourceTile.getReplayGroup(layer, tile.tileCoord.toString());\n      replayGroup.replay(context, transform, 0, {}, replays);\n    }\n  }\n};\n\nexport default CanvasVectorTileLayerRenderer;\n","/**\n * @module ol/Map\n */\nimport {inherits} from './index.js';\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control/util.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport CanvasImageLayerRenderer from './renderer/canvas/ImageLayer.js';\nimport CanvasMapRenderer from './renderer/canvas/Map.js';\nimport CanvasTileLayerRenderer from './renderer/canvas/TileLayer.js';\nimport CanvasVectorLayerRenderer from './renderer/canvas/VectorLayer.js';\nimport CanvasVectorTileLayerRenderer from './renderer/canvas/VectorTileLayer.js';\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map';\n *     import View from 'ol/View';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *\n *     var map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~Group}\n * is a subclass of {@link module:ol/layer/Base}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @constructor\n * @extends {module:ol/PluggableMap}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst Map = function(options) {\n  options = assign({}, options);\n  if (!options.controls) {\n    options.controls = defaultControls();\n  }\n  if (!options.interactions) {\n    options.interactions = defaultInteractions();\n  }\n\n  PluggableMap.call(this, options);\n};\n\ninherits(Map, PluggableMap);\n\nMap.prototype.createRenderer = function() {\n  const renderer = new CanvasMapRenderer(this);\n  renderer.registerLayerRenderers([\n    CanvasImageLayerRenderer,\n    CanvasTileLayerRenderer,\n    CanvasVectorLayerRenderer,\n    CanvasVectorTileLayerRenderer\n  ]);\n  return renderer;\n};\n\nexport default Map;\n","/**\n * @module ol/OverlayPositioning\n */\n\n/**\n * Overlay position: `'bottom-left'`, `'bottom-center'`,  `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, `'top-right'`\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_CENTER: 'bottom-center',\n  BOTTOM_RIGHT: 'bottom-right',\n  CENTER_LEFT: 'center-left',\n  CENTER_CENTER: 'center-center',\n  CENTER_RIGHT: 'center-right',\n  TOP_LEFT: 'top-left',\n  TOP_CENTER: 'top-center',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/Overlay\n */\nimport {inherits} from './index.js';\nimport MapEventType from './MapEventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport OverlayPositioning from './OverlayPositioning.js';\nimport {CLASS_SELECTABLE} from './css.js';\nimport {removeNode, removeChildren, outerWidth, outerHeight} from './dom.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {containsExtent} from './extent.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number|string} [id] Set the overlay id. The overlay id can be used\n * with the {@link module:ol/Map~Map#getOverlayById} method.\n * @property {Element} [element] The overlay element.\n * @property {Array.<number>} [offset=[0, 0]] Offsets in pixels used when positioning\n * the overlay. The first element in the\n * array is the horizontal offset. A positive value shifts the overlay right.\n * The second element in the array is the vertical offset. A positive value\n * shifts the overlay down.\n * @property {module:ol/coordinate~Coordinate} [position] The overlay position\n * in map projection.\n * @property {module:ol/OverlayPositioning} [positioning='top-left'] Defines how\n * the overlay is actually positioned with respect to its `position` property.\n * Possible values are `'bottom-left'`, `'bottom-center'`, `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, and `'top-right'`.\n * @property {boolean} [stopEvent=true] Whether event propagation to the map\n * viewport should be stopped. If `true` the overlay is placed in the same\n * container as that of the controls (CSS class name\n * `ol-overlaycontainer-stopevent`); if `false` it is placed in the container\n * with CSS class name specified by the `className` property.\n * @property {boolean} [insertFirst=true] Whether the overlay is inserted first\n * in the overlay container, or appended. If the overlay is placed in the same\n * container as that of the controls (see the `stopEvent` option) you will\n * probably set `insertFirst` to `true` so the overlay is displayed below the\n * controls.\n * @property {boolean} [autoPan=false] If set to `true` the map is panned when\n * calling `setPosition`, so that the overlay is entirely visible in the current\n * viewport.\n * @property {module:ol/Overlay~PanOptions} [autoPanAnimation] The\n * animation options used to pan the overlay into view. This animation is only\n * used when `autoPan` is enabled. A `duration` and `easing` may be provided to\n * customize the animation.\n * @property {number} [autoPanMargin=20] The margin (in pixels) between the\n * overlay and the borders of the map when autopanning.\n * @property {string} [className='ol-overlay-container ol-selectable'] CSS class\n * name.\n */\n\n\n/**\n * @typedef {Object} PanOptions\n * @property {number} [duration=1000] The duration of the animation in\n * milliseconds.\n * @property {function(number):number} [easing] The easing function to use. Can\n * be one from {@link module:ol/easing} or a custom function.\n * Default is {@link module:ol/easing~inAndOut}.\n */\n\n\n/**\n * @enum {string}\n * @protected\n */\nconst Property = {\n  ELEMENT: 'element',\n  MAP: 'map',\n  OFFSET: 'offset',\n  POSITION: 'position',\n  POSITIONING: 'positioning'\n};\n\n\n/**\n * @classdesc\n * An element to be displayed over the map and attached to a single map\n * location.  Like {@link module:ol/control/Control~Control}, Overlays are\n * visible widgets. Unlike Controls, they are not in a fixed position on the\n * screen, but are tied to a geographical coordinate, so panning the map will\n * move an Overlay but not a Control.\n *\n * Example:\n *\n *     import Overlay from 'ol/Overlay';\n *\n *     var popup = new Overlay({\n *       element: document.getElementById('popup')\n *     });\n *     popup.setPosition(coordinate);\n *     map.addOverlay(popup);\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/Overlay~Options} options Overlay options.\n * @api\n */\nconst Overlay = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/Overlay~Options}\n   */\n  this.options = options;\n\n  /**\n   * @protected\n   * @type {number|string|undefined}\n   */\n  this.id = options.id;\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.insertFirst = options.insertFirst !== undefined ?\n    options.insertFirst : true;\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.stopEvent = options.stopEvent !== undefined ? options.stopEvent : true;\n\n  /**\n   * @protected\n   * @type {Element}\n   */\n  this.element = document.createElement('DIV');\n  this.element.className = options.className !== undefined ?\n    options.className : 'ol-overlay-container ' + CLASS_SELECTABLE;\n  this.element.style.position = 'absolute';\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.autoPan = options.autoPan !== undefined ? options.autoPan : false;\n\n  /**\n   * @protected\n   * @type {module:ol/Overlay~PanOptions}\n   */\n  this.autoPanAnimation = options.autoPanAnimation || /** @type {module:ol/Overlay~PanOptions} */ ({});\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.autoPanMargin = options.autoPanMargin !== undefined ?\n    options.autoPanMargin : 20;\n\n  /**\n   * @protected\n   * @type {{bottom_: string,\n   *         left_: string,\n   *         right_: string,\n   *         top_: string,\n   *         visible: boolean}}\n   */\n  this.rendered = {\n    bottom_: '',\n    left_: '',\n    right_: '',\n    top_: '',\n    visible: true\n  };\n\n  /**\n   * @protected\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapPostrenderListenerKey = null;\n\n  listen(\n    this, getChangeEventType(Property.ELEMENT),\n    this.handleElementChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.MAP),\n    this.handleMapChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.OFFSET),\n    this.handleOffsetChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.POSITION),\n    this.handlePositionChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.POSITIONING),\n    this.handlePositioningChanged, this);\n\n  if (options.element !== undefined) {\n    this.setElement(options.element);\n  }\n\n  this.setOffset(options.offset !== undefined ? options.offset : [0, 0]);\n\n  this.setPositioning(options.positioning !== undefined ?\n    /** @type {module:ol/OverlayPositioning} */ (options.positioning) :\n    OverlayPositioning.TOP_LEFT);\n\n  if (options.position !== undefined) {\n    this.setPosition(options.position);\n  }\n\n};\n\ninherits(Overlay, BaseObject);\n\n\n/**\n * Get the DOM element of this overlay.\n * @return {Element|undefined} The Element containing the overlay.\n * @observable\n * @api\n */\nOverlay.prototype.getElement = function() {\n  return /** @type {Element|undefined} */ (this.get(Property.ELEMENT));\n};\n\n\n/**\n * Get the overlay identifier which is set on constructor.\n * @return {number|string|undefined} Id.\n * @api\n */\nOverlay.prototype.getId = function() {\n  return this.id;\n};\n\n\n/**\n * Get the map associated with this overlay.\n * @return {module:ol/PluggableMap|undefined} The map that the\n * overlay is part of.\n * @observable\n * @api\n */\nOverlay.prototype.getMap = function() {\n  return (\n    /** @type {module:ol/PluggableMap|undefined} */ (this.get(Property.MAP))\n  );\n};\n\n\n/**\n * Get the offset of this overlay.\n * @return {Array.<number>} The offset.\n * @observable\n * @api\n */\nOverlay.prototype.getOffset = function() {\n  return /** @type {Array.<number>} */ (this.get(Property.OFFSET));\n};\n\n\n/**\n * Get the current position of this overlay.\n * @return {module:ol/coordinate~Coordinate|undefined} The spatial point that the overlay is\n *     anchored at.\n * @observable\n * @api\n */\nOverlay.prototype.getPosition = function() {\n  return (\n    /** @type {module:ol/coordinate~Coordinate|undefined} */ (this.get(Property.POSITION))\n  );\n};\n\n\n/**\n * Get the current positioning of this overlay.\n * @return {module:ol/OverlayPositioning} How the overlay is positioned\n *     relative to its point on the map.\n * @observable\n * @api\n */\nOverlay.prototype.getPositioning = function() {\n  return (\n    /** @type {module:ol/OverlayPositioning} */ (this.get(Property.POSITIONING))\n  );\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handleElementChanged = function() {\n  removeChildren(this.element);\n  const element = this.getElement();\n  if (element) {\n    this.element.appendChild(element);\n  }\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handleMapChanged = function() {\n  if (this.mapPostrenderListenerKey) {\n    removeNode(this.element);\n    unlistenByKey(this.mapPostrenderListenerKey);\n    this.mapPostrenderListenerKey = null;\n  }\n  const map = this.getMap();\n  if (map) {\n    this.mapPostrenderListenerKey = listen(map,\n      MapEventType.POSTRENDER, this.render, this);\n    this.updatePixelPosition();\n    const container = this.stopEvent ?\n      map.getOverlayContainerStopEvent() : map.getOverlayContainer();\n    if (this.insertFirst) {\n      container.insertBefore(this.element, container.childNodes[0] || null);\n    } else {\n      container.appendChild(this.element);\n    }\n  }\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.render = function() {\n  this.updatePixelPosition();\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handleOffsetChanged = function() {\n  this.updatePixelPosition();\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handlePositionChanged = function() {\n  this.updatePixelPosition();\n  if (this.get(Property.POSITION) && this.autoPan) {\n    this.panIntoView();\n  }\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handlePositioningChanged = function() {\n  this.updatePixelPosition();\n};\n\n\n/**\n * Set the DOM element to be associated with this overlay.\n * @param {Element|undefined} element The Element containing the overlay.\n * @observable\n * @api\n */\nOverlay.prototype.setElement = function(element) {\n  this.set(Property.ELEMENT, element);\n};\n\n\n/**\n * Set the map to be associated with this overlay.\n * @param {module:ol/PluggableMap|undefined} map The map that the\n * overlay is part of.\n * @observable\n * @api\n */\nOverlay.prototype.setMap = function(map) {\n  this.set(Property.MAP, map);\n};\n\n\n/**\n * Set the offset for this overlay.\n * @param {Array.<number>} offset Offset.\n * @observable\n * @api\n */\nOverlay.prototype.setOffset = function(offset) {\n  this.set(Property.OFFSET, offset);\n};\n\n\n/**\n * Set the position for this overlay. If the position is `undefined` the\n * overlay is hidden.\n * @param {module:ol/coordinate~Coordinate|undefined} position The spatial point that the overlay\n *     is anchored at.\n * @observable\n * @api\n */\nOverlay.prototype.setPosition = function(position) {\n  this.set(Property.POSITION, position);\n};\n\n\n/**\n * Pan the map so that the overlay is entirely visible in the current viewport\n * (if necessary).\n * @protected\n */\nOverlay.prototype.panIntoView = function() {\n  const map = this.getMap();\n\n  if (!map || !map.getTargetElement()) {\n    return;\n  }\n\n  const mapRect = this.getRect(map.getTargetElement(), map.getSize());\n  const element = /** @type {!Element} */ (this.getElement());\n  const overlayRect = this.getRect(element, [outerWidth(element), outerHeight(element)]);\n\n  const margin = this.autoPanMargin;\n  if (!containsExtent(mapRect, overlayRect)) {\n    // the overlay is not completely inside the viewport, so pan the map\n    const offsetLeft = overlayRect[0] - mapRect[0];\n    const offsetRight = mapRect[2] - overlayRect[2];\n    const offsetTop = overlayRect[1] - mapRect[1];\n    const offsetBottom = mapRect[3] - overlayRect[3];\n\n    const delta = [0, 0];\n    if (offsetLeft < 0) {\n      // move map to the left\n      delta[0] = offsetLeft - margin;\n    } else if (offsetRight < 0) {\n      // move map to the right\n      delta[0] = Math.abs(offsetRight) + margin;\n    }\n    if (offsetTop < 0) {\n      // move map up\n      delta[1] = offsetTop - margin;\n    } else if (offsetBottom < 0) {\n      // move map down\n      delta[1] = Math.abs(offsetBottom) + margin;\n    }\n\n    if (delta[0] !== 0 || delta[1] !== 0) {\n      const center = /** @type {module:ol/coordinate~Coordinate} */ (map.getView().getCenter());\n      const centerPx = map.getPixelFromCoordinate(center);\n      const newCenterPx = [\n        centerPx[0] + delta[0],\n        centerPx[1] + delta[1]\n      ];\n\n      map.getView().animate({\n        center: map.getCoordinateFromPixel(newCenterPx),\n        duration: this.autoPanAnimation.duration,\n        easing: this.autoPanAnimation.easing\n      });\n    }\n  }\n};\n\n\n/**\n * Get the extent of an element relative to the document\n * @param {Element|undefined} element The element.\n * @param {module:ol/size~Size|undefined} size The size of the element.\n * @return {module:ol/extent~Extent} The extent.\n * @protected\n */\nOverlay.prototype.getRect = function(element, size) {\n  const box = element.getBoundingClientRect();\n  const offsetX = box.left + window.pageXOffset;\n  const offsetY = box.top + window.pageYOffset;\n  return [\n    offsetX,\n    offsetY,\n    offsetX + size[0],\n    offsetY + size[1]\n  ];\n};\n\n\n/**\n * Set the positioning for this overlay.\n * @param {module:ol/OverlayPositioning} positioning how the overlay is\n *     positioned relative to its point on the map.\n * @observable\n * @api\n */\nOverlay.prototype.setPositioning = function(positioning) {\n  this.set(Property.POSITIONING, positioning);\n};\n\n\n/**\n * Modify the visibility of the element.\n * @param {boolean} visible Element visibility.\n * @protected\n */\nOverlay.prototype.setVisible = function(visible) {\n  if (this.rendered.visible !== visible) {\n    this.element.style.display = visible ? '' : 'none';\n    this.rendered.visible = visible;\n  }\n};\n\n\n/**\n * Update pixel position.\n * @protected\n */\nOverlay.prototype.updatePixelPosition = function() {\n  const map = this.getMap();\n  const position = this.getPosition();\n  if (!map || !map.isRendered() || !position) {\n    this.setVisible(false);\n    return;\n  }\n\n  const pixel = map.getPixelFromCoordinate(position);\n  const mapSize = map.getSize();\n  this.updateRenderedPosition(pixel, mapSize);\n};\n\n\n/**\n * @param {module:ol~Pixel} pixel The pixel location.\n * @param {module:ol/size~Size|undefined} mapSize The map size.\n * @protected\n */\nOverlay.prototype.updateRenderedPosition = function(pixel, mapSize) {\n  const style = this.element.style;\n  const offset = this.getOffset();\n\n  const positioning = this.getPositioning();\n\n  this.setVisible(true);\n\n  let offsetX = offset[0];\n  let offsetY = offset[1];\n  if (positioning == OverlayPositioning.BOTTOM_RIGHT ||\n      positioning == OverlayPositioning.CENTER_RIGHT ||\n      positioning == OverlayPositioning.TOP_RIGHT) {\n    if (this.rendered.left_ !== '') {\n      this.rendered.left_ = style.left = '';\n    }\n    const right = Math.round(mapSize[0] - pixel[0] - offsetX) + 'px';\n    if (this.rendered.right_ != right) {\n      this.rendered.right_ = style.right = right;\n    }\n  } else {\n    if (this.rendered.right_ !== '') {\n      this.rendered.right_ = style.right = '';\n    }\n    if (positioning == OverlayPositioning.BOTTOM_CENTER ||\n        positioning == OverlayPositioning.CENTER_CENTER ||\n        positioning == OverlayPositioning.TOP_CENTER) {\n      offsetX -= this.element.offsetWidth / 2;\n    }\n    const left = Math.round(pixel[0] + offsetX) + 'px';\n    if (this.rendered.left_ != left) {\n      this.rendered.left_ = style.left = left;\n    }\n  }\n  if (positioning == OverlayPositioning.BOTTOM_LEFT ||\n      positioning == OverlayPositioning.BOTTOM_CENTER ||\n      positioning == OverlayPositioning.BOTTOM_RIGHT) {\n    if (this.rendered.top_ !== '') {\n      this.rendered.top_ = style.top = '';\n    }\n    const bottom = Math.round(mapSize[1] - pixel[1] - offsetY) + 'px';\n    if (this.rendered.bottom_ != bottom) {\n      this.rendered.bottom_ = style.bottom = bottom;\n    }\n  } else {\n    if (this.rendered.bottom_ !== '') {\n      this.rendered.bottom_ = style.bottom = '';\n    }\n    if (positioning == OverlayPositioning.CENTER_LEFT ||\n        positioning == OverlayPositioning.CENTER_CENTER ||\n        positioning == OverlayPositioning.CENTER_RIGHT) {\n      offsetY -= this.element.offsetHeight / 2;\n    }\n    const top = Math.round(pixel[1] + offsetY) + 'px';\n    if (this.rendered.top_ != top) {\n      this.rendered.top_ = style.top = top;\n    }\n  }\n};\n\n\n/**\n * returns the options this Overlay has been created with\n * @return {module:ol/Overlay~Options} overlay options\n */\nOverlay.prototype.getOptions = function() {\n  return this.options;\n};\n\nexport default Overlay;\n","/**\n * @module ol/VectorTile\n */\nimport {getUid, inherits} from './index.js';\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\n\n/**\n * @typedef {function(new: module:ol/VectorTile, module:ol/tilecoord~TileCoord,\n * module:ol/TileState, string, ?string, module:ol/Tile~LoadFunction)} TileClass\n * @api\n */\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {string} src Data source url.\n * @param {module:ol/format/Feature} format Feature format.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @param {module:ol/Tile~Options=} opt_options Tile options.\n */\nconst VectorTile = function(tileCoord, state, src, format, tileLoadFunction, opt_options) {\n\n  Tile.call(this, tileCoord, state, opt_options);\n\n  /**\n   * @type {number}\n   */\n  this.consumers = 0;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/format/Feature}\n   */\n  this.format_ = format;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/Feature>}\n   */\n  this.features_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/featureloader~FeatureLoader}\n   */\n  this.loader_;\n\n  /**\n   * Data projection\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = null;\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/render/ReplayGroup>}\n   */\n  this.replayGroups_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/Tile~LoadFunction}\n   */\n  this.tileLoadFunction_ = tileLoadFunction;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.url_ = src;\n\n};\n\ninherits(VectorTile, Tile);\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nconst DEFAULT_EXTENT = [0, 0, 4096, 4096];\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.disposeInternal = function() {\n  this.features_ = null;\n  this.replayGroups_ = {};\n  this.state = TileState.ABORT;\n  this.changed();\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Gets the extent of the vector tile.\n * @return {module:ol/extent~Extent} The extent.\n * @api\n */\nVectorTile.prototype.getExtent = function() {\n  return this.extent_ || DEFAULT_EXTENT;\n};\n\n\n/**\n * Get the feature format assigned for reading this tile's features.\n * @return {module:ol/format/Feature} Feature format.\n * @api\n */\nVectorTile.prototype.getFormat = function() {\n  return this.format_;\n};\n\n\n/**\n * Get the features for this tile. Geometries will be in the projection returned\n * by {@link module:ol/VectorTile~VectorTile#getProjection}.\n * @return {Array.<module:ol/Feature|module:ol/render/Feature>} Features.\n * @api\n */\nVectorTile.prototype.getFeatures = function() {\n  return this.features_;\n};\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.getKey = function() {\n  return this.url_;\n};\n\n\n/**\n * Get the feature projection of features returned by\n * {@link module:ol/VectorTile~VectorTile#getFeatures}.\n * @return {module:ol/proj/Projection} Feature projection.\n * @api\n */\nVectorTile.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @param {string} key Key.\n * @return {module:ol/render/ReplayGroup} Replay group.\n */\nVectorTile.prototype.getReplayGroup = function(layer, key) {\n  return this.replayGroups_[getUid(layer) + ',' + key];\n};\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.load = function() {\n  if (this.state == TileState.IDLE) {\n    this.setState(TileState.LOADING);\n    this.tileLoadFunction_(this, this.url_);\n    this.loader_(null, NaN, null);\n  }\n};\n\n\n/**\n * Handler for successful tile load.\n * @param {Array.<module:ol/Feature>} features The loaded features.\n * @param {module:ol/proj/Projection} dataProjection Data projection.\n * @param {module:ol/extent~Extent} extent Extent.\n */\nVectorTile.prototype.onLoad = function(features, dataProjection, extent) {\n  this.setProjection(dataProjection);\n  this.setFeatures(features);\n  this.setExtent(extent);\n};\n\n\n/**\n * Handler for tile load errors.\n */\nVectorTile.prototype.onError = function() {\n  this.setState(TileState.ERROR);\n};\n\n\n/**\n * Function for use in an {@link module:ol/source/VectorTile~VectorTile}'s\n * `tileLoadFunction`. Sets the extent of the vector tile. This is only required\n * for tiles in projections with `tile-pixels` as units. The extent should be\n * set to `[0, 0, tilePixelSize, tilePixelSize]`, where `tilePixelSize` is\n * calculated by multiplying the tile size with the tile pixel ratio. For\n * sources using {@link module:ol/format/MVT~MVT} as feature format, the\n * {@link module:ol/format/MVT~MVT#getLastExtent} method will return the correct\n * extent. The default is `[0, 0, 4096, 4096]`.\n * @param {module:ol/extent~Extent} extent The extent.\n * @api\n */\nVectorTile.prototype.setExtent = function(extent) {\n  this.extent_ = extent;\n};\n\n\n/**\n * Function for use in an {@link module:ol/source/VectorTile~VectorTile}'s `tileLoadFunction`.\n * Sets the features for the tile.\n * @param {Array.<module:ol/Feature>} features Features.\n * @api\n */\nVectorTile.prototype.setFeatures = function(features) {\n  this.features_ = features;\n  this.setState(TileState.LOADED);\n};\n\n\n/**\n * Function for use in an {@link module:ol/source/VectorTile~VectorTile}'s `tileLoadFunction`.\n * Sets the projection of the features that were added with\n * {@link module:ol/VectorTile~VectorTile#setFeatures}.\n * @param {module:ol/proj/Projection} projection Feature projection.\n * @api\n */\nVectorTile.prototype.setProjection = function(projection) {\n  this.projection_ = projection;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @param {string} key Key.\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n */\nVectorTile.prototype.setReplayGroup = function(layer, key, replayGroup) {\n  this.replayGroups_[getUid(layer) + ',' + key] = replayGroup;\n};\n\n\n/**\n * Set the feature loader for reading this tile's features.\n * @param {module:ol/featureloader~FeatureLoader} loader Feature loader.\n * @api\n */\nVectorTile.prototype.setLoader = function(loader) {\n  this.loader_ = loader;\n};\n\nexport default VectorTile;\n","/**\n * @module ol/control/FullScreen\n */\nimport {inherits} from '../index.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_UNSUPPORTED} from '../css.js';\nimport {replaceNode} from '../dom.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\n\n\n/**\n * @return {string} Change type.\n */\nconst getChangeType = (function() {\n  let changeType;\n  return function() {\n    if (!changeType) {\n      const body = document.body;\n      if (body.webkitRequestFullscreen) {\n        changeType = 'webkitfullscreenchange';\n      } else if (body.mozRequestFullScreen) {\n        changeType = 'mozfullscreenchange';\n      } else if (body.msRequestFullscreen) {\n        changeType = 'MSFullscreenChange';\n      } else if (body.requestFullscreen) {\n        changeType = 'fullscreenchange';\n      }\n    }\n    return changeType;\n  };\n})();\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-full-screen'] CSS class name.\n * @property {string|Element} [label='\\u2922'] Text label to use for the button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [labelActive='\\u00d7'] Text label to use for the\n * button when full-screen is active.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Toggle full-screen'] Text label to use for the button tip.\n * @property {boolean} [keys=false] Full keyboard access.\n * @property {Element|string} [target] Specify a target if you want the\n * control to be rendered outside of the map's viewport.\n * @property {Element|string} [source] The element to be displayed\n * fullscreen. When not provided, the element containing the map viewport will\n * be displayed fullscreen.\n */\n\n\n/**\n * @classdesc\n * Provides a button that when clicked fills up the full screen with the map.\n * The full screen source element is by default the element containing the map viewport unless\n * overridden by providing the `source` option. In which case, the dom\n * element introduced using this parameter will be displayed in full screen.\n *\n * When in full screen mode, a close button is shown to exit full screen mode.\n * The [Fullscreen API](http://www.w3.org/TR/fullscreen/) is used to\n * toggle the map in full screen mode.\n *\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/FullScreen~Options=} opt_options Options.\n * @api\n */\nconst FullScreen = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.cssClassName_ = options.className !== undefined ? options.className :\n    'ol-full-screen';\n\n  const label = options.label !== undefined ? options.label : '\\u2922';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.labelNode_ = typeof label === 'string' ?\n    document.createTextNode(label) : label;\n\n  const labelActive = options.labelActive !== undefined ? options.labelActive : '\\u00d7';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.labelActiveNode_ = typeof labelActive === 'string' ?\n    document.createTextNode(labelActive) : labelActive;\n\n  const tipLabel = options.tipLabel ? options.tipLabel : 'Toggle full-screen';\n  const button = document.createElement('button');\n  button.className = this.cssClassName_ + '-' + isFullScreen();\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(this.labelNode_);\n\n  listen(button, EventType.CLICK,\n    this.handleClick_, this);\n\n  const cssClasses = this.cssClassName_ + ' ' + CLASS_UNSELECTABLE +\n      ' ' + CLASS_CONTROL + ' ' +\n      (!isFullScreenSupported() ? CLASS_UNSUPPORTED : '');\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.keys_ = options.keys !== undefined ? options.keys : false;\n\n  /**\n   * @private\n   * @type {Element|string|undefined}\n   */\n  this.source_ = options.source;\n\n};\n\ninherits(FullScreen, Control);\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nFullScreen.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleFullScreen_();\n};\n\n\n/**\n * @private\n */\nFullScreen.prototype.handleFullScreen_ = function() {\n  if (!isFullScreenSupported()) {\n    return;\n  }\n  const map = this.getMap();\n  if (!map) {\n    return;\n  }\n  if (isFullScreen()) {\n    exitFullScreen();\n  } else {\n    let element;\n    if (this.source_) {\n      element = typeof this.source_ === 'string' ?\n        document.getElementById(this.source_) :\n        this.source_;\n    } else {\n      element = map.getTargetElement();\n    }\n    if (this.keys_) {\n      requestFullScreenWithKeys(element);\n\n    } else {\n      requestFullScreen(element);\n    }\n  }\n};\n\n\n/**\n * @private\n */\nFullScreen.prototype.handleFullScreenChange_ = function() {\n  const button = this.element.firstElementChild;\n  const map = this.getMap();\n  if (isFullScreen()) {\n    button.className = this.cssClassName_ + '-true';\n    replaceNode(this.labelActiveNode_, this.labelNode_);\n  } else {\n    button.className = this.cssClassName_ + '-false';\n    replaceNode(this.labelNode_, this.labelActiveNode_);\n  }\n  if (map) {\n    map.updateSize();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nFullScreen.prototype.setMap = function(map) {\n  Control.prototype.setMap.call(this, map);\n  if (map) {\n    this.listenerKeys.push(listen(document,\n      getChangeType(),\n      this.handleFullScreenChange_, this)\n    );\n  }\n};\n\n/**\n * @return {boolean} Fullscreen is supported by the current platform.\n */\nfunction isFullScreenSupported() {\n  const body = document.body;\n  return !!(\n    body.webkitRequestFullscreen ||\n    (body.mozRequestFullScreen && document.mozFullScreenEnabled) ||\n    (body.msRequestFullscreen && document.msFullscreenEnabled) ||\n    (body.requestFullscreen && document.fullscreenEnabled)\n  );\n}\n\n/**\n * @return {boolean} Element is currently in fullscreen.\n */\nfunction isFullScreen() {\n  return !!(\n    document.webkitIsFullScreen || document.mozFullScreen ||\n    document.msFullscreenElement || document.fullscreenElement\n  );\n}\n\n/**\n * Request to fullscreen an element.\n * @param {Element} element Element to request fullscreen\n */\nfunction requestFullScreen(element) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.msRequestFullscreen) {\n    element.msRequestFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  }\n}\n\n/**\n * Request to fullscreen an element with keyboard input.\n * @param {Element} element Element to request fullscreen\n */\nfunction requestFullScreenWithKeys(element) {\n  if (element.mozRequestFullScreenWithKeys) {\n    element.mozRequestFullScreenWithKeys();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n  } else {\n    requestFullScreen(element);\n  }\n}\n\n/**\n * Exit fullscreen.\n */\nfunction exitFullScreen() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.msExitFullscreen) {\n    document.msExitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  }\n}\n\nexport default FullScreen;\n","/**\n * @module ol/control/OverviewMap\n */\nimport {inherits} from '../index.js';\nimport Collection from '../Collection.js';\nimport Map from '../Map.js';\nimport MapEventType from '../MapEventType.js';\nimport MapProperty from '../MapProperty.js';\nimport {getChangeEventType} from '../Object.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport Overlay from '../Overlay.js';\nimport OverlayPositioning from '../OverlayPositioning.js';\nimport ViewProperty from '../ViewProperty.js';\nimport Control from '../control/Control.js';\nimport {rotate as rotateCoordinate, add as addCoordinate} from '../coordinate.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_COLLAPSED} from '../css.js';\nimport {replaceNode} from '../dom.js';\nimport {listen, listenOnce, unlisten} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, getBottomLeft, getBottomRight, getTopLeft, getTopRight, scaleFromCenter} from '../extent.js';\n\n\n/**\n * Maximum width and/or height extent ratio that determines when the overview\n * map should be zoomed out.\n * @type {number}\n */\nconst MAX_RATIO = 0.75;\n\n\n/**\n * Minimum width and/or height extent ratio that determines when the overview\n * map should be zoomed in.\n * @type {number}\n */\nconst MIN_RATIO = 0.1;\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-overviewmap'] CSS class name.\n * @property {boolean} [collapsed=true] Whether the control should start collapsed or not (expanded).\n * @property {string|Element} [collapseLabel='«'] Text label to use for the\n * expanded overviewmap button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {boolean} [collapsible=true] Whether the control can be collapsed or not.\n * @property {string|Element} [label='»'] Text label to use for the collapsed\n * overviewmap button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {Array.<module:ol/layer/Layer>|module:ol/Collection.<module:ol/layer/Layer>} [layers]\n * Layers for the overview map. If not set, then all main map layers are used\n * instead.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {Element|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {string} [tipLabel='Overview map'] Text label to use for the button tip.\n * @property {module:ol/View} [view] Custom view for the overview map. If not provided,\n * a default view with an EPSG:3857 projection will be used.\n */\n\n\n/**\n * Create a new control with a map acting as an overview map for an other\n * defined map.\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/OverviewMap~Options=} opt_options OverviewMap options.\n * @api\n */\nconst OverviewMap = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.collapsed_ = options.collapsed !== undefined ? options.collapsed : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsible_ = options.collapsible !== undefined ?\n    options.collapsible : true;\n\n  if (!this.collapsible_) {\n    this.collapsed_ = false;\n  }\n\n  const className = options.className !== undefined ? options.className : 'ol-overviewmap';\n\n  const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Overview map';\n\n  const collapseLabel = options.collapseLabel !== undefined ? options.collapseLabel : '\\u00AB';\n\n  if (typeof collapseLabel === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.collapseLabel_ = document.createElement('span');\n    this.collapseLabel_.textContent = collapseLabel;\n  } else {\n    this.collapseLabel_ = collapseLabel;\n  }\n\n  const label = options.label !== undefined ? options.label : '\\u00BB';\n\n\n  if (typeof label === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.label_ = document.createElement('span');\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n  }\n\n  const activeLabel = (this.collapsible_ && !this.collapsed_) ?\n    this.collapseLabel_ : this.label_;\n  const button = document.createElement('button');\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(activeLabel);\n\n  listen(button, EventType.CLICK,\n    this.handleClick_, this);\n\n  /**\n   * @type {Element}\n   * @private\n   */\n  this.ovmapDiv_ = document.createElement('DIV');\n  this.ovmapDiv_.className = 'ol-overviewmap-map';\n\n  /**\n   * @type {module:ol/Map}\n   * @private\n   */\n  this.ovmap_ = new Map({\n    controls: new Collection(),\n    interactions: new Collection(),\n    view: options.view\n  });\n  const ovmap = this.ovmap_;\n\n  if (options.layers) {\n    options.layers.forEach(\n      /**\n       * @param {module:ol/layer/Layer} layer Layer.\n       */\n      (function(layer) {\n        ovmap.addLayer(layer);\n      }).bind(this));\n  }\n\n  const box = document.createElement('DIV');\n  box.className = 'ol-overviewmap-box';\n  box.style.boxSizing = 'border-box';\n\n  /**\n   * @type {module:ol/Overlay}\n   * @private\n   */\n  this.boxOverlay_ = new Overlay({\n    position: [0, 0],\n    positioning: OverlayPositioning.BOTTOM_LEFT,\n    element: box\n  });\n  this.ovmap_.addOverlay(this.boxOverlay_);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL +\n      (this.collapsed_ && this.collapsible_ ? ' ' + CLASS_COLLAPSED : '') +\n      (this.collapsible_ ? '' : ' ol-uncollapsible');\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(this.ovmapDiv_);\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /* Interactive map */\n\n  const scope = this;\n\n  const overlay = this.boxOverlay_;\n  const overlayBox = this.boxOverlay_.getElement();\n\n  /* Functions definition */\n\n  const computeDesiredMousePosition = function(mousePosition) {\n    return {\n      clientX: mousePosition.clientX - (overlayBox.offsetWidth / 2),\n      clientY: mousePosition.clientY + (overlayBox.offsetHeight / 2)\n    };\n  };\n\n  const move = function(event) {\n    const coordinates = ovmap.getEventCoordinate(computeDesiredMousePosition(event));\n\n    overlay.setPosition(coordinates);\n  };\n\n  const endMoving = function(event) {\n    const coordinates = ovmap.getEventCoordinate(event);\n\n    scope.getMap().getView().setCenter(coordinates);\n\n    window.removeEventListener('mousemove', move);\n    window.removeEventListener('mouseup', endMoving);\n  };\n\n  /* Binding */\n\n  overlayBox.addEventListener('mousedown', function() {\n    window.addEventListener('mousemove', move);\n    window.addEventListener('mouseup', endMoving);\n  });\n};\n\ninherits(OverviewMap, Control);\n\n\n/**\n * @inheritDoc\n * @api\n */\nOverviewMap.prototype.setMap = function(map) {\n  const oldMap = this.getMap();\n  if (map === oldMap) {\n    return;\n  }\n  if (oldMap) {\n    const oldView = oldMap.getView();\n    if (oldView) {\n      this.unbindView_(oldView);\n    }\n    this.ovmap_.setTarget(null);\n  }\n  Control.prototype.setMap.call(this, map);\n\n  if (map) {\n    this.ovmap_.setTarget(this.ovmapDiv_);\n    this.listenerKeys.push(listen(\n      map, ObjectEventType.PROPERTYCHANGE,\n      this.handleMapPropertyChange_, this));\n\n    // TODO: to really support map switching, this would need to be reworked\n    if (this.ovmap_.getLayers().getLength() === 0) {\n      this.ovmap_.setLayerGroup(map.getLayerGroup());\n    }\n\n    const view = map.getView();\n    if (view) {\n      this.bindView_(view);\n      if (view.isDef()) {\n        this.ovmap_.updateSize();\n        this.resetExtent_();\n      }\n    }\n  }\n};\n\n\n/**\n * Handle map property changes.  This only deals with changes to the map's view.\n * @param {module:ol/Object~ObjectEvent} event The propertychange event.\n * @private\n */\nOverviewMap.prototype.handleMapPropertyChange_ = function(event) {\n  if (event.key === MapProperty.VIEW) {\n    const oldView = /** @type {module:ol/View} */ (event.oldValue);\n    if (oldView) {\n      this.unbindView_(oldView);\n    }\n    const newView = this.getMap().getView();\n    this.bindView_(newView);\n  }\n};\n\n\n/**\n * Register listeners for view property changes.\n * @param {module:ol/View} view The view.\n * @private\n */\nOverviewMap.prototype.bindView_ = function(view) {\n  listen(view,\n    getChangeEventType(ViewProperty.ROTATION),\n    this.handleRotationChanged_, this);\n};\n\n\n/**\n * Unregister listeners for view property changes.\n * @param {module:ol/View} view The view.\n * @private\n */\nOverviewMap.prototype.unbindView_ = function(view) {\n  unlisten(view,\n    getChangeEventType(ViewProperty.ROTATION),\n    this.handleRotationChanged_, this);\n};\n\n\n/**\n * Handle rotation changes to the main map.\n * TODO: This should rotate the extent rectrangle instead of the\n * overview map's view.\n * @private\n */\nOverviewMap.prototype.handleRotationChanged_ = function() {\n  this.ovmap_.getView().setRotation(this.getMap().getView().getRotation());\n};\n\n\n/**\n * Update the overview map element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/OverviewMap}\n * @api\n */\nexport function render(mapEvent) {\n  this.validateExtent_();\n  this.updateBox_();\n}\n\n\n/**\n * Reset the overview map extent if the box size (width or\n * height) is less than the size of the overview map size times minRatio\n * or is greater than the size of the overview size times maxRatio.\n *\n * If the map extent was not reset, the box size can fits in the defined\n * ratio sizes. This method then checks if is contained inside the overview\n * map current extent. If not, recenter the overview map to the current\n * main map center location.\n * @private\n */\nOverviewMap.prototype.validateExtent_ = function() {\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  if (!map.isRendered() || !ovmap.isRendered()) {\n    return;\n  }\n\n  const mapSize = /** @type {module:ol/size~Size} */ (map.getSize());\n\n  const view = map.getView();\n  const extent = view.calculateExtent(mapSize);\n\n  const ovmapSize = /** @type {module:ol/size~Size} */ (ovmap.getSize());\n\n  const ovview = ovmap.getView();\n  const ovextent = ovview.calculateExtent(ovmapSize);\n\n  const topLeftPixel =\n      ovmap.getPixelFromCoordinate(getTopLeft(extent));\n  const bottomRightPixel =\n      ovmap.getPixelFromCoordinate(getBottomRight(extent));\n\n  const boxWidth = Math.abs(topLeftPixel[0] - bottomRightPixel[0]);\n  const boxHeight = Math.abs(topLeftPixel[1] - bottomRightPixel[1]);\n\n  const ovmapWidth = ovmapSize[0];\n  const ovmapHeight = ovmapSize[1];\n\n  if (boxWidth < ovmapWidth * MIN_RATIO ||\n      boxHeight < ovmapHeight * MIN_RATIO ||\n      boxWidth > ovmapWidth * MAX_RATIO ||\n      boxHeight > ovmapHeight * MAX_RATIO) {\n    this.resetExtent_();\n  } else if (!containsExtent(ovextent, extent)) {\n    this.recenter_();\n  }\n};\n\n\n/**\n * Reset the overview map extent to half calculated min and max ratio times\n * the extent of the main map.\n * @private\n */\nOverviewMap.prototype.resetExtent_ = function() {\n  if (MAX_RATIO === 0 || MIN_RATIO === 0) {\n    return;\n  }\n\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  const mapSize = /** @type {module:ol/size~Size} */ (map.getSize());\n\n  const view = map.getView();\n  const extent = view.calculateExtent(mapSize);\n\n  const ovview = ovmap.getView();\n\n  // get how many times the current map overview could hold different\n  // box sizes using the min and max ratio, pick the step in the middle used\n  // to calculate the extent from the main map to set it to the overview map,\n  const steps = Math.log(\n    MAX_RATIO / MIN_RATIO) / Math.LN2;\n  const ratio = 1 / (Math.pow(2, steps / 2) * MIN_RATIO);\n  scaleFromCenter(extent, ratio);\n  ovview.fit(extent);\n};\n\n\n/**\n * Set the center of the overview map to the map center without changing its\n * resolution.\n * @private\n */\nOverviewMap.prototype.recenter_ = function() {\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  const view = map.getView();\n\n  const ovview = ovmap.getView();\n\n  ovview.setCenter(view.getCenter());\n};\n\n\n/**\n * Update the box using the main map extent\n * @private\n */\nOverviewMap.prototype.updateBox_ = function() {\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  if (!map.isRendered() || !ovmap.isRendered()) {\n    return;\n  }\n\n  const mapSize = /** @type {module:ol/size~Size} */ (map.getSize());\n\n  const view = map.getView();\n\n  const ovview = ovmap.getView();\n\n  const rotation = view.getRotation();\n\n  const overlay = this.boxOverlay_;\n  const box = this.boxOverlay_.getElement();\n  const extent = view.calculateExtent(mapSize);\n  const ovresolution = ovview.getResolution();\n  const bottomLeft = getBottomLeft(extent);\n  const topRight = getTopRight(extent);\n\n  // set position using bottom left coordinates\n  const rotateBottomLeft = this.calculateCoordinateRotate_(rotation, bottomLeft);\n  overlay.setPosition(rotateBottomLeft);\n\n  // set box size calculated from map extent size and overview map resolution\n  if (box) {\n    box.style.width = Math.abs((bottomLeft[0] - topRight[0]) / ovresolution) + 'px';\n    box.style.height = Math.abs((topRight[1] - bottomLeft[1]) / ovresolution) + 'px';\n  }\n};\n\n\n/**\n * @param {number} rotation Target rotation.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {module:ol/coordinate~Coordinate|undefined} Coordinate for rotation and center anchor.\n * @private\n */\nOverviewMap.prototype.calculateCoordinateRotate_ = function(\n  rotation, coordinate) {\n  let coordinateRotate;\n\n  const map = this.getMap();\n  const view = map.getView();\n\n  const currentCenter = view.getCenter();\n\n  if (currentCenter) {\n    coordinateRotate = [\n      coordinate[0] - currentCenter[0],\n      coordinate[1] - currentCenter[1]\n    ];\n    rotateCoordinate(coordinateRotate, rotation);\n    addCoordinate(coordinateRotate, currentCenter);\n  }\n  return coordinateRotate;\n};\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nOverviewMap.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleToggle_();\n};\n\n\n/**\n * @private\n */\nOverviewMap.prototype.handleToggle_ = function() {\n  this.element.classList.toggle(CLASS_COLLAPSED);\n  if (this.collapsed_) {\n    replaceNode(this.collapseLabel_, this.label_);\n  } else {\n    replaceNode(this.label_, this.collapseLabel_);\n  }\n  this.collapsed_ = !this.collapsed_;\n\n  // manage overview map if it had not been rendered before and control\n  // is expanded\n  const ovmap = this.ovmap_;\n  if (!this.collapsed_ && !ovmap.isRendered()) {\n    ovmap.updateSize();\n    this.resetExtent_();\n    listenOnce(ovmap, MapEventType.POSTRENDER,\n      function(event) {\n        this.updateBox_();\n      },\n      this);\n  }\n};\n\n\n/**\n * Return `true` if the overview map is collapsible, `false` otherwise.\n * @return {boolean} True if the widget is collapsible.\n * @api\n */\nOverviewMap.prototype.getCollapsible = function() {\n  return this.collapsible_;\n};\n\n\n/**\n * Set whether the overview map should be collapsible.\n * @param {boolean} collapsible True if the widget is collapsible.\n * @api\n */\nOverviewMap.prototype.setCollapsible = function(collapsible) {\n  if (this.collapsible_ === collapsible) {\n    return;\n  }\n  this.collapsible_ = collapsible;\n  this.element.classList.toggle('ol-uncollapsible');\n  if (!collapsible && this.collapsed_) {\n    this.handleToggle_();\n  }\n};\n\n\n/**\n * Collapse or expand the overview map according to the passed parameter. Will\n * not do anything if the overview map isn't collapsible or if the current\n * collapsed state is already the one requested.\n * @param {boolean} collapsed True if the widget is collapsed.\n * @api\n */\nOverviewMap.prototype.setCollapsed = function(collapsed) {\n  if (!this.collapsible_ || this.collapsed_ === collapsed) {\n    return;\n  }\n  this.handleToggle_();\n};\n\n\n/**\n * Determine if the overview map is collapsed.\n * @return {boolean} The overview map is collapsed.\n * @api\n */\nOverviewMap.prototype.getCollapsed = function() {\n  return this.collapsed_;\n};\n\n\n/**\n * Return the overview map.\n * @return {module:ol/PluggableMap} Overview map.\n * @api\n */\nOverviewMap.prototype.getOverviewMap = function() {\n  return this.ovmap_;\n};\nexport default OverviewMap;\n","/**\n * @module ol/control/ScaleLine\n */\nimport {inherits} from '../index.js';\nimport {getChangeEventType} from '../Object.js';\nimport {assert} from '../asserts.js';\nimport Control from '../control/Control.js';\nimport {CLASS_UNSELECTABLE} from '../css.js';\nimport {listen} from '../events.js';\nimport {getPointResolution, METERS_PER_UNIT} from '../proj.js';\nimport ProjUnits from '../proj/Units.js';\n\n\n/**\n * @type {string}\n */\nconst UNITS_PROP = 'units';\n\n/**\n * Units for the scale line. Supported values are `'degrees'`, `'imperial'`,\n * `'nautical'`, `'metric'`, `'us'`.\n * @enum {string}\n */\nexport const Units = {\n  DEGREES: 'degrees',\n  IMPERIAL: 'imperial',\n  NAUTICAL: 'nautical',\n  METRIC: 'metric',\n  US: 'us'\n};\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nconst LEADING_DIGITS = [1, 2, 5];\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-scale-line'] CSS Class name.\n * @property {number} [minWidth=64] Minimum width in pixels.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {Element|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {module:ol/control/ScaleLine~Units|string} [units='metric'] Units.\n */\n\n\n/**\n * @classdesc\n * A control displaying rough y-axis distances, calculated for the center of the\n * viewport. For conformal projections (e.g. EPSG:3857, the default view\n * projection in OpenLayers), the scale is valid for all directions.\n * No scale line will be shown when the y-axis distance of a pixel at the\n * viewport center cannot be calculated in the view projection.\n * By default the scale line will show in the bottom left portion of the map,\n * but this can be changed by using the css selector `.ol-scale-line`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/ScaleLine~Options=} opt_options Scale line options.\n * @api\n */\nconst ScaleLine = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-scale-line';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.innerElement_ = document.createElement('DIV');\n  this.innerElement_.className = className + '-inner';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.element_ = document.createElement('DIV');\n  this.element_.className = className + ' ' + CLASS_UNSELECTABLE;\n  this.element_.appendChild(this.innerElement_);\n\n  /**\n   * @private\n   * @type {?module:ol/View~State}\n   */\n  this.viewState_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minWidth_ = options.minWidth !== undefined ? options.minWidth : 64;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = false;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.renderedWidth_ = undefined;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.renderedHTML_ = '';\n\n  Control.call(this, {\n    element: this.element_,\n    render: options.render || render,\n    target: options.target\n  });\n\n  listen(\n    this, getChangeEventType(UNITS_PROP),\n    this.handleUnitsChanged_, this);\n\n  this.setUnits(/** @type {module:ol/control/ScaleLine~Units} */ (options.units) ||\n      Units.METRIC);\n\n};\n\ninherits(ScaleLine, Control);\n\n\n/**\n * Return the units to use in the scale line.\n * @return {module:ol/control/ScaleLine~Units|undefined} The units\n * to use in the scale line.\n * @observable\n * @api\n */\nScaleLine.prototype.getUnits = function() {\n  return (\n    /** @type {module:ol/control/ScaleLine~Units|undefined} */ (this.get(UNITS_PROP))\n  );\n};\n\n\n/**\n * Update the scale line element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/ScaleLine}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    this.viewState_ = null;\n  } else {\n    this.viewState_ = frameState.viewState;\n  }\n  this.updateElement_();\n}\n\n\n/**\n * @private\n */\nScaleLine.prototype.handleUnitsChanged_ = function() {\n  this.updateElement_();\n};\n\n\n/**\n * Set the units to use in the scale line.\n * @param {module:ol/control/ScaleLine~Units} units The units to use in the scale line.\n * @observable\n * @api\n */\nScaleLine.prototype.setUnits = function(units) {\n  this.set(UNITS_PROP, units);\n};\n\n\n/**\n * @private\n */\nScaleLine.prototype.updateElement_ = function() {\n  const viewState = this.viewState_;\n\n  if (!viewState) {\n    if (this.renderedVisible_) {\n      this.element_.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const center = viewState.center;\n  const projection = viewState.projection;\n  const units = this.getUnits();\n  const pointResolutionUnits = units == Units.DEGREES ?\n    ProjUnits.DEGREES :\n    ProjUnits.METERS;\n  let pointResolution =\n      getPointResolution(projection, viewState.resolution, center, pointResolutionUnits);\n  if (projection.getUnits() != ProjUnits.DEGREES && projection.getMetersPerUnit()\n    && pointResolutionUnits == ProjUnits.METERS) {\n    pointResolution *= projection.getMetersPerUnit();\n  }\n\n  let nominalCount = this.minWidth_ * pointResolution;\n  let suffix = '';\n  if (units == Units.DEGREES) {\n    const metersPerDegree = METERS_PER_UNIT[ProjUnits.DEGREES];\n    if (projection.getUnits() == ProjUnits.DEGREES) {\n      nominalCount *= metersPerDegree;\n    } else {\n      pointResolution /= metersPerDegree;\n    }\n    if (nominalCount < metersPerDegree / 60) {\n      suffix = '\\u2033'; // seconds\n      pointResolution *= 3600;\n    } else if (nominalCount < metersPerDegree) {\n      suffix = '\\u2032'; // minutes\n      pointResolution *= 60;\n    } else {\n      suffix = '\\u00b0'; // degrees\n    }\n  } else if (units == Units.IMPERIAL) {\n    if (nominalCount < 0.9144) {\n      suffix = 'in';\n      pointResolution /= 0.0254;\n    } else if (nominalCount < 1609.344) {\n      suffix = 'ft';\n      pointResolution /= 0.3048;\n    } else {\n      suffix = 'mi';\n      pointResolution /= 1609.344;\n    }\n  } else if (units == Units.NAUTICAL) {\n    pointResolution /= 1852;\n    suffix = 'nm';\n  } else if (units == Units.METRIC) {\n    if (nominalCount < 0.001) {\n      suffix = 'μm';\n      pointResolution *= 1000000;\n    } else if (nominalCount < 1) {\n      suffix = 'mm';\n      pointResolution *= 1000;\n    } else if (nominalCount < 1000) {\n      suffix = 'm';\n    } else {\n      suffix = 'km';\n      pointResolution /= 1000;\n    }\n  } else if (units == Units.US) {\n    if (nominalCount < 0.9144) {\n      suffix = 'in';\n      pointResolution *= 39.37;\n    } else if (nominalCount < 1609.344) {\n      suffix = 'ft';\n      pointResolution /= 0.30480061;\n    } else {\n      suffix = 'mi';\n      pointResolution /= 1609.3472;\n    }\n  } else {\n    assert(false, 33); // Invalid units\n  }\n\n  let i = 3 * Math.floor(\n    Math.log(this.minWidth_ * pointResolution) / Math.log(10));\n  let count, width;\n  while (true) {\n    count = LEADING_DIGITS[((i % 3) + 3) % 3] *\n        Math.pow(10, Math.floor(i / 3));\n    width = Math.round(count / pointResolution);\n    if (isNaN(width)) {\n      this.element_.style.display = 'none';\n      this.renderedVisible_ = false;\n      return;\n    } else if (width >= this.minWidth_) {\n      break;\n    }\n    ++i;\n  }\n\n  const html = count + ' ' + suffix;\n  if (this.renderedHTML_ != html) {\n    this.innerElement_.innerHTML = html;\n    this.renderedHTML_ = html;\n  }\n\n  if (this.renderedWidth_ != width) {\n    this.innerElement_.style.width = width + 'px';\n    this.renderedWidth_ = width;\n  }\n\n  if (!this.renderedVisible_) {\n    this.element_.style.display = '';\n    this.renderedVisible_ = true;\n  }\n\n};\n\nexport default ScaleLine;\n","/**\n * @module ol/control/ZoomSlider\n */\nimport {inherits} from '../index.js';\nimport ViewHint from '../ViewHint.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\nimport {listen} from '../events.js';\nimport {stopPropagation} from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {clamp} from '../math.js';\nimport PointerEventType from '../pointer/EventType.js';\nimport PointerEventHandler from '../pointer/PointerEventHandler.js';\n\n\n/**\n * The enum for available directions.\n *\n * @enum {number}\n */\nconst Direction = {\n  VERTICAL: 0,\n  HORIZONTAL: 1\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-zoomslider'] CSS class name.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n */\n\n\n/**\n * @classdesc\n * A slider type of control for zooming.\n *\n * Example:\n *\n *     map.addControl(new ZoomSlider());\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/ZoomSlider~Options=} opt_options Zoom slider options.\n * @api\n */\nconst ZoomSlider = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * Will hold the current resolution of the view.\n   *\n   * @type {number|undefined}\n   * @private\n   */\n  this.currentResolution_ = undefined;\n\n  /**\n   * The direction of the slider. Will be determined from actual display of the\n   * container and defaults to Direction.VERTICAL.\n   *\n   * @type {Direction}\n   * @private\n   */\n  this.direction_ = Direction.VERTICAL;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.dragging_;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.heightLimit_ = 0;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.widthLimit_ = 0;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.previousX_;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.previousY_;\n\n  /**\n   * The calculated thumb size (border box plus margins).  Set when initSlider_\n   * is called.\n   * @type {module:ol/size~Size}\n   * @private\n   */\n  this.thumbSize_ = null;\n\n  /**\n   * Whether the slider is initialized.\n   * @type {boolean}\n   * @private\n   */\n  this.sliderInitialized_ = false;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n  const className = options.className !== undefined ? options.className : 'ol-zoomslider';\n  const thumbElement = document.createElement('button');\n  thumbElement.setAttribute('type', 'button');\n  thumbElement.className = className + '-thumb ' + CLASS_UNSELECTABLE;\n  const containerElement = document.createElement('div');\n  containerElement.className = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  containerElement.appendChild(thumbElement);\n  /**\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.dragger_ = new PointerEventHandler(containerElement);\n\n  listen(this.dragger_, PointerEventType.POINTERDOWN,\n    this.handleDraggerStart_, this);\n  listen(this.dragger_, PointerEventType.POINTERMOVE,\n    this.handleDraggerDrag_, this);\n  listen(this.dragger_, PointerEventType.POINTERUP,\n    this.handleDraggerEnd_, this);\n\n  listen(containerElement, EventType.CLICK, this.handleContainerClick_, this);\n  listen(thumbElement, EventType.CLICK, stopPropagation);\n\n  Control.call(this, {\n    element: containerElement,\n    render: options.render || render\n  });\n};\n\ninherits(ZoomSlider, Control);\n\n\n/**\n * @inheritDoc\n */\nZoomSlider.prototype.disposeInternal = function() {\n  this.dragger_.dispose();\n  Control.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nZoomSlider.prototype.setMap = function(map) {\n  Control.prototype.setMap.call(this, map);\n  if (map) {\n    map.render();\n  }\n};\n\n\n/**\n * Initializes the slider element. This will determine and set this controls\n * direction_ and also constrain the dragging of the thumb to always be within\n * the bounds of the container.\n *\n * @private\n */\nZoomSlider.prototype.initSlider_ = function() {\n  const container = this.element;\n  const containerSize = {\n    width: container.offsetWidth, height: container.offsetHeight\n  };\n\n  const thumb = container.firstElementChild;\n  const computedStyle = getComputedStyle(thumb);\n  const thumbWidth = thumb.offsetWidth +\n      parseFloat(computedStyle['marginRight']) +\n      parseFloat(computedStyle['marginLeft']);\n  const thumbHeight = thumb.offsetHeight +\n      parseFloat(computedStyle['marginTop']) +\n      parseFloat(computedStyle['marginBottom']);\n  this.thumbSize_ = [thumbWidth, thumbHeight];\n\n  if (containerSize.width > containerSize.height) {\n    this.direction_ = Direction.HORIZONTAL;\n    this.widthLimit_ = containerSize.width - thumbWidth;\n  } else {\n    this.direction_ = Direction.VERTICAL;\n    this.heightLimit_ = containerSize.height - thumbHeight;\n  }\n  this.sliderInitialized_ = true;\n};\n\n\n/**\n * Update the zoomslider element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/ZoomSlider}\n * @api\n */\nexport function render(mapEvent) {\n  if (!mapEvent.frameState) {\n    return;\n  }\n  if (!this.sliderInitialized_) {\n    this.initSlider_();\n  }\n  const res = mapEvent.frameState.viewState.resolution;\n  if (res !== this.currentResolution_) {\n    this.currentResolution_ = res;\n    this.setThumbPosition_(res);\n  }\n}\n\n\n/**\n * @param {Event} event The browser event to handle.\n * @private\n */\nZoomSlider.prototype.handleContainerClick_ = function(event) {\n  const view = this.getMap().getView();\n\n  const relativePosition = this.getRelativePosition_(\n    event.offsetX - this.thumbSize_[0] / 2,\n    event.offsetY - this.thumbSize_[1] / 2);\n\n  const resolution = this.getResolutionForPosition_(relativePosition);\n\n  view.animate({\n    resolution: view.constrainResolution(resolution),\n    duration: this.duration_,\n    easing: easeOut\n  });\n};\n\n\n/**\n * Handle dragger start events.\n * @param {module:ol/pointer/PointerEvent} event The drag event.\n * @private\n */\nZoomSlider.prototype.handleDraggerStart_ = function(event) {\n  if (!this.dragging_ && event.originalEvent.target === this.element.firstElementChild) {\n    this.getMap().getView().setHint(ViewHint.INTERACTING, 1);\n    this.previousX_ = event.clientX;\n    this.previousY_ = event.clientY;\n    this.dragging_ = true;\n  }\n};\n\n\n/**\n * Handle dragger drag events.\n *\n * @param {module:ol/pointer/PointerEvent|Event} event The drag event.\n * @private\n */\nZoomSlider.prototype.handleDraggerDrag_ = function(event) {\n  if (this.dragging_) {\n    const element = this.element.firstElementChild;\n    const deltaX = event.clientX - this.previousX_ + parseInt(element.style.left, 10);\n    const deltaY = event.clientY - this.previousY_ + parseInt(element.style.top, 10);\n    const relativePosition = this.getRelativePosition_(deltaX, deltaY);\n    this.currentResolution_ = this.getResolutionForPosition_(relativePosition);\n    this.getMap().getView().setResolution(this.currentResolution_);\n    this.setThumbPosition_(this.currentResolution_);\n    this.previousX_ = event.clientX;\n    this.previousY_ = event.clientY;\n  }\n};\n\n\n/**\n * Handle dragger end events.\n * @param {module:ol/pointer/PointerEvent|Event} event The drag event.\n * @private\n */\nZoomSlider.prototype.handleDraggerEnd_ = function(event) {\n  if (this.dragging_) {\n    const view = this.getMap().getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n\n    view.animate({\n      resolution: view.constrainResolution(this.currentResolution_),\n      duration: this.duration_,\n      easing: easeOut\n    });\n\n    this.dragging_ = false;\n    this.previousX_ = undefined;\n    this.previousY_ = undefined;\n  }\n};\n\n\n/**\n * Positions the thumb inside its container according to the given resolution.\n *\n * @param {number} res The res.\n * @private\n */\nZoomSlider.prototype.setThumbPosition_ = function(res) {\n  const position = this.getPositionForResolution_(res);\n  const thumb = this.element.firstElementChild;\n\n  if (this.direction_ == Direction.HORIZONTAL) {\n    thumb.style.left = this.widthLimit_ * position + 'px';\n  } else {\n    thumb.style.top = this.heightLimit_ * position + 'px';\n  }\n};\n\n\n/**\n * Calculates the relative position of the thumb given x and y offsets.  The\n * relative position scales from 0 to 1.  The x and y offsets are assumed to be\n * in pixel units within the dragger limits.\n *\n * @param {number} x Pixel position relative to the left of the slider.\n * @param {number} y Pixel position relative to the top of the slider.\n * @return {number} The relative position of the thumb.\n * @private\n */\nZoomSlider.prototype.getRelativePosition_ = function(x, y) {\n  let amount;\n  if (this.direction_ === Direction.HORIZONTAL) {\n    amount = x / this.widthLimit_;\n  } else {\n    amount = y / this.heightLimit_;\n  }\n  return clamp(amount, 0, 1);\n};\n\n\n/**\n * Calculates the corresponding resolution of the thumb given its relative\n * position (where 0 is the minimum and 1 is the maximum).\n *\n * @param {number} position The relative position of the thumb.\n * @return {number} The corresponding resolution.\n * @private\n */\nZoomSlider.prototype.getResolutionForPosition_ = function(position) {\n  const fn = this.getMap().getView().getResolutionForValueFunction();\n  return fn(1 - position);\n};\n\n\n/**\n * Determines the relative position of the slider for the given resolution.  A\n * relative position of 0 corresponds to the minimum view resolution.  A\n * relative position of 1 corresponds to the maximum view resolution.\n *\n * @param {number} res The resolution.\n * @return {number} The relative position value (between 0 and 1).\n * @private\n */\nZoomSlider.prototype.getPositionForResolution_ = function(res) {\n  const fn = this.getMap().getView().getValueForResolutionFunction();\n  return 1 - fn(res);\n};\n\nexport default ZoomSlider;\n","/**\n * @module ol/control/ZoomToExtent\n */\nimport {inherits} from '../index.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-zoom-extent'] Class name.\n * @property {Element|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {string|Element} [label='E'] Text label to use for the button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Fit to extent'] Text label to use for the button tip.\n * @property {module:ol/extent~Extent} [extent] The extent to zoom to. If undefined the validity\n * extent of the view projection is used.\n */\n\n\n/**\n * @classdesc\n * A button control which, when pressed, changes the map view to a specific\n * extent. To style this control use the css selector `.ol-zoom-extent`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/ZoomToExtent~Options=} opt_options Options.\n * @api\n */\nconst ZoomToExtent = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/extent~Extent}\n   * @protected\n   */\n  this.extent = options.extent ? options.extent : null;\n\n  const className = options.className !== undefined ? options.className : 'ol-zoom-extent';\n\n  const label = options.label !== undefined ? options.label : 'E';\n  const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Fit to extent';\n  const button = document.createElement('button');\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(\n    typeof label === 'string' ? document.createTextNode(label) : label\n  );\n\n  listen(button, EventType.CLICK, this.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    target: options.target\n  });\n};\n\ninherits(ZoomToExtent, Control);\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nZoomToExtent.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleZoomToExtent();\n};\n\n\n/**\n * @protected\n */\nZoomToExtent.prototype.handleZoomToExtent = function() {\n  const map = this.getMap();\n  const view = map.getView();\n  const extent = !this.extent ? view.getProjection().getExtent() : this.extent;\n  view.fit(extent);\n};\nexport default ZoomToExtent;\n","/**\n * @module ol/webgl/Shader\n */\nimport {FALSE} from '../functions.js';\n\n/**\n * @constructor\n * @abstract\n * @param {string} source Source.\n * @struct\n */\nconst WebGLShader = function(source) {\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.source_ = source;\n\n};\n\n\n/**\n * @abstract\n * @return {number} Type.\n */\nWebGLShader.prototype.getType = function() {};\n\n\n/**\n * @return {string} Source.\n */\nWebGLShader.prototype.getSource = function() {\n  return this.source_;\n};\n\n\n/**\n * @return {boolean} Is animated?\n */\nWebGLShader.prototype.isAnimated = FALSE;\nexport default WebGLShader;\n","/**\n * @module ol/webgl/Fragment\n */\nimport {inherits} from '../index.js';\nimport {FRAGMENT_SHADER} from '../webgl.js';\nimport WebGLShader from '../webgl/Shader.js';\n\n/**\n * @constructor\n * @extends {module:ol/webgl/Shader}\n * @param {string} source Source.\n * @struct\n */\nconst WebGLFragment = function(source) {\n  WebGLShader.call(this, source);\n};\n\ninherits(WebGLFragment, WebGLShader);\n\n\n/**\n * @inheritDoc\n */\nWebGLFragment.prototype.getType = function() {\n  return FRAGMENT_SHADER;\n};\nexport default WebGLFragment;\n","/**\n * @module ol/webgl/Vertex\n */\nimport {inherits} from '../index.js';\nimport {VERTEX_SHADER} from '../webgl.js';\nimport WebGLShader from '../webgl/Shader.js';\n\n/**\n * @constructor\n * @extends {module:ol/webgl/Shader}\n * @param {string} source Source.\n * @struct\n */\nconst WebGLVertex = function(source) {\n  WebGLShader.call(this, source);\n};\n\ninherits(WebGLVertex, WebGLShader);\n\n\n/**\n * @inheritDoc\n */\nWebGLVertex.prototype.getType = function() {\n  return VERTEX_SHADER;\n};\nexport default WebGLVertex;\n","/**\n * @module ol/render/webgl/circlereplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../index.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_center;\\nvarying vec2 v_offset;\\nvarying float v_halfWidth;\\nvarying float v_pixelRatio;\\n\\n\\n\\nuniform float u_opacity;\\nuniform vec4 u_fillColor;\\nuniform vec4 u_strokeColor;\\nuniform vec2 u_size;\\n\\nvoid main(void) {\\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\\n  float radius = length(windowCenter - windowOffset);\\n  float dist = length(windowCenter - gl_FragCoord.xy);\\n  if (dist > radius + v_halfWidth) {\\n    if (u_strokeColor.a == 0.0) {\\n      gl_FragColor = u_fillColor;\\n    } else {\\n      gl_FragColor = u_strokeColor;\\n    }\\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\\n  } else if (u_fillColor.a == 0.0) {\\n    // Hooray, no fill, just stroke. We can use real antialiasing.\\n    gl_FragColor = u_strokeColor;\\n    if (dist < radius - v_halfWidth) {\\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\\n    }\\n  } else {\\n    gl_FragColor = u_fillColor;\\n    float strokeDist = radius - v_halfWidth;\\n    float antialias = 2.0 * v_pixelRatio;\\n    if (dist > strokeDist) {\\n      gl_FragColor = u_strokeColor;\\n    } else if (dist >= strokeDist - antialias) {\\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\\n    }\\n  }\\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\\n  if (gl_FragColor.a <= 0.0) {\\n    discard;\\n  }\\n}\\n' :\n  'precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_center;\\nvarying vec2 v_offset;\\nvarying float v_halfWidth;\\nvarying float v_pixelRatio;\\n\\n\\nattribute vec2 a_position;\\nattribute float a_instruction;\\nattribute float a_radius;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\nuniform float u_lineWidth;\\nuniform float u_pixelRatio;\\n\\nvoid main(void) {\\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\\n  v_pixelRatio = u_pixelRatio;\\n  float lineWidth = u_lineWidth * u_pixelRatio;\\n  v_halfWidth = lineWidth / 2.0;\\n  if (lineWidth == 0.0) {\\n    lineWidth = 2.0 * u_pixelRatio;\\n  }\\n  vec2 offset;\\n  // Radius with anitaliasing (roughly).\\n  float radius = a_radius + 3.0 * u_pixelRatio;\\n  // Until we get gl_VertexID in WebGL, we store an instruction.\\n  if (a_instruction == 0.0) {\\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\\n    offset = vec2(-1.0, 1.0);\\n  } else if (a_instruction == 1.0) {\\n    offset = vec2(-1.0, -1.0);\\n  } else if (a_instruction == 2.0) {\\n    offset = vec2(1.0, -1.0);\\n  } else {\\n    offset = vec2(1.0, 1.0);\\n  }\\n\\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\\n      0.0, 1.0)).xy;\\n\\n  if (distance(v_center, v_offset) > 20000.0) {\\n    gl_Position = vec4(v_center, 0.0, 1.0);\\n  }\\n}\\n\\n\\n' :\n  'varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}');\n","/**\n * @module ol/render/webgl/circlereplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../../index.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'h');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'i');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'j');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_lineWidth = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_lineWidth' : 'k');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_pixelRatio = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_pixelRatio' : 'l');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'm');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_fillColor = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_fillColor' : 'n');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_strokeColor = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_strokeColor' : 'o');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_size = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_size' : 'p');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_instruction = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_instruction' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_radius = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_radius' : 'g');\n};\n\nexport default Locations;\n","/**\n * @module ol/vec/mat4\n */\n\n\n/**\n * @return {Array.<number>} 4x4 matrix representing a 3D identity transform.\n */\nexport function create() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\n\n\n/**\n * @param {Array.<number>} mat4 Flattened 4x4 matrix receiving the result.\n * @param {module:ol/transform~Transform} transform Transformation matrix.\n * @return {Array.<number>} 2D transformation matrix as flattened 4x4 matrix.\n */\nexport function fromTransform(mat4, transform) {\n  mat4[0] = transform[0];\n  mat4[1] = transform[1];\n  mat4[4] = transform[2];\n  mat4[5] = transform[3];\n  mat4[12] = transform[4];\n  mat4[13] = transform[5];\n  return mat4;\n}\n","/**\n * @module ol/render/webgl/Replay\n */\nimport {inherits} from '../../index.js';\nimport {getCenter} from '../../extent.js';\nimport VectorContext from '../VectorContext.js';\nimport {\n  create as createTransform,\n  reset as resetTransform,\n  rotate as rotateTransform,\n  scale as scaleTransform,\n  translate as translateTransform\n} from '../../transform.js';\nimport {create, fromTransform} from '../../vec/mat4.js';\nimport {ARRAY_BUFFER, ELEMENT_ARRAY_BUFFER, TRIANGLES,\n  UNSIGNED_INT, UNSIGNED_SHORT} from '../../webgl.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/render/VectorContext}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLReplay = function(tolerance, maxExtent) {\n  VectorContext.call(this);\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.tolerance = tolerance;\n\n  /**\n   * @protected\n   * @const\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent = maxExtent;\n\n  /**\n   * The origin of the coordinate system for the point coordinates sent to\n   * the GPU. To eliminate jitter caused by precision problems in the GPU\n   * we use the \"Rendering Relative to Eye\" technique described in the \"3D\n   * Engine Design for Virtual Globes\" book.\n   * @protected\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.origin = getCenter(maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.projectionMatrix_ = createTransform();\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.offsetRotateMatrix_ = createTransform();\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.offsetScaleMatrix_ = createTransform();\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.tmpMat4_ = create();\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.indices = [];\n\n  /**\n   * @protected\n   * @type {?module:ol/webgl/Buffer}\n   */\n  this.indicesBuffer = null;\n\n  /**\n   * Start index per feature (the index).\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.startIndices = [];\n\n  /**\n   * Start index per feature (the feature).\n   * @protected\n   * @type {Array.<module:ol/Feature|module:ol/render/Feature>}\n   */\n  this.startIndicesFeature = [];\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.vertices = [];\n\n  /**\n   * @protected\n   * @type {?module:ol/webgl/Buffer}\n   */\n  this.verticesBuffer = null;\n\n  /**\n   * Optional parameter for PolygonReplay instances.\n   * @protected\n   * @type {module:ol/render/webgl/LineStringReplay|undefined}\n   */\n  this.lineStringReplay = undefined;\n\n};\n\ninherits(WebGLReplay, VectorContext);\n\n\n/**\n * @abstract\n * @param {module:ol/webgl/Context} context WebGL context.\n * @return {function()} Delete resources function.\n */\nWebGLReplay.prototype.getDeleteResourcesFunction = function(context) {};\n\n\n/**\n * @abstract\n * @param {module:ol/webgl/Context} context Context.\n */\nWebGLReplay.prototype.finish = function(context) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @return {module:ol/render/webgl/circlereplay/defaultshader/Locations|\n            module:ol/render/webgl/linestringreplay/defaultshader/Locations|\n            module:ol/render/webgl/polygonreplay/defaultshader/Locations|\n            module:ol/render/webgl/texturereplay/defaultshader/Locations} Locations.\n */\nWebGLReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/render/webgl/circlereplay/defaultshader/Locations|\n           module:ol/render/webgl/linestringreplay/defaultshader/Locations|\n           module:ol/render/webgl/polygonreplay/defaultshader/Locations|\n           module:ol/render/webgl/texturereplay/defaultshader/Locations} locations Locations.\n */\nWebGLReplay.prototype.shutDownProgram = function(gl, locations) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {boolean} hitDetection Hit detection mode.\n */\nWebGLReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash, featureCallback, opt_hitExtent) {};\n\n\n/**\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting\n *  this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.drawHitDetectionReplay = function(gl, context, skippedFeaturesHash,\n  featureCallback, oneByOne, opt_hitExtent) {\n  if (!oneByOne) {\n    // draw all hit-detection features in \"once\" (by texture group)\n    return this.drawHitDetectionReplayAll(gl, context,\n      skippedFeaturesHash, featureCallback);\n  } else {\n    // draw hit-detection features one by one\n    return this.drawHitDetectionReplayOneByOne(gl, context,\n      skippedFeaturesHash, featureCallback, opt_hitExtent);\n  }\n};\n\n\n/**\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.drawHitDetectionReplayAll = function(gl, context, skippedFeaturesHash,\n  featureCallback) {\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n  this.drawReplay(gl, context, skippedFeaturesHash, true);\n\n  const result = featureCallback(null);\n  if (result) {\n    return result;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting\n *  this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.replay = function(context,\n  center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash,\n  featureCallback, oneByOne, opt_hitExtent) {\n  const gl = context.getGL();\n  let tmpStencil, tmpStencilFunc, tmpStencilMaskVal, tmpStencilRef, tmpStencilMask,\n      tmpStencilOpFail, tmpStencilOpPass, tmpStencilOpZFail;\n\n  if (this.lineStringReplay) {\n    tmpStencil = gl.isEnabled(gl.STENCIL_TEST);\n    tmpStencilFunc = gl.getParameter(gl.STENCIL_FUNC);\n    tmpStencilMaskVal = gl.getParameter(gl.STENCIL_VALUE_MASK);\n    tmpStencilRef = gl.getParameter(gl.STENCIL_REF);\n    tmpStencilMask = gl.getParameter(gl.STENCIL_WRITEMASK);\n    tmpStencilOpFail = gl.getParameter(gl.STENCIL_FAIL);\n    tmpStencilOpPass = gl.getParameter(gl.STENCIL_PASS_DEPTH_PASS);\n    tmpStencilOpZFail = gl.getParameter(gl.STENCIL_PASS_DEPTH_FAIL);\n\n    gl.enable(gl.STENCIL_TEST);\n    gl.clear(gl.STENCIL_BUFFER_BIT);\n    gl.stencilMask(255);\n    gl.stencilFunc(gl.ALWAYS, 1, 255);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n\n    this.lineStringReplay.replay(context,\n      center, resolution, rotation, size, pixelRatio,\n      opacity, skippedFeaturesHash,\n      featureCallback, oneByOne, opt_hitExtent);\n\n    gl.stencilMask(0);\n    gl.stencilFunc(gl.NOTEQUAL, 1, 255);\n  }\n\n  context.bindBuffer(ARRAY_BUFFER, this.verticesBuffer);\n\n  context.bindBuffer(ELEMENT_ARRAY_BUFFER, this.indicesBuffer);\n\n  const locations = this.setUpProgram(gl, context, size, pixelRatio);\n\n  // set the \"uniform\" values\n  const projectionMatrix = resetTransform(this.projectionMatrix_);\n  scaleTransform(projectionMatrix, 2 / (resolution * size[0]), 2 / (resolution * size[1]));\n  rotateTransform(projectionMatrix, -rotation);\n  translateTransform(projectionMatrix, -(center[0] - this.origin[0]), -(center[1] - this.origin[1]));\n\n  const offsetScaleMatrix = resetTransform(this.offsetScaleMatrix_);\n  scaleTransform(offsetScaleMatrix, 2 / size[0], 2 / size[1]);\n\n  const offsetRotateMatrix = resetTransform(this.offsetRotateMatrix_);\n  if (rotation !== 0) {\n    rotateTransform(offsetRotateMatrix, -rotation);\n  }\n\n  gl.uniformMatrix4fv(locations.u_projectionMatrix, false,\n    fromTransform(this.tmpMat4_, projectionMatrix));\n  gl.uniformMatrix4fv(locations.u_offsetScaleMatrix, false,\n    fromTransform(this.tmpMat4_, offsetScaleMatrix));\n  gl.uniformMatrix4fv(locations.u_offsetRotateMatrix, false,\n    fromTransform(this.tmpMat4_, offsetRotateMatrix));\n  gl.uniform1f(locations.u_opacity, opacity);\n\n  // draw!\n  let result;\n  if (featureCallback === undefined) {\n    this.drawReplay(gl, context, skippedFeaturesHash, false);\n  } else {\n    // draw feature by feature for the hit-detection\n    result = this.drawHitDetectionReplay(gl, context, skippedFeaturesHash,\n      featureCallback, oneByOne, opt_hitExtent);\n  }\n\n  // disable the vertex attrib arrays\n  this.shutDownProgram(gl, locations);\n\n  if (this.lineStringReplay) {\n    if (!tmpStencil) {\n      gl.disable(gl.STENCIL_TEST);\n    }\n    gl.clear(gl.STENCIL_BUFFER_BIT);\n    gl.stencilFunc(/** @type {number} */ (tmpStencilFunc),\n      /** @type {number} */ (tmpStencilRef), /** @type {number} */ (tmpStencilMaskVal));\n    gl.stencilMask(/** @type {number} */ (tmpStencilMask));\n    gl.stencilOp(/** @type {number} */ (tmpStencilOpFail),\n      /** @type {number} */ (tmpStencilOpZFail), /** @type {number} */ (tmpStencilOpPass));\n  }\n\n  return result;\n};\n\n/**\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {number} start Start index.\n * @param {number} end End index.\n */\nWebGLReplay.prototype.drawElements = function(\n  gl, context, start, end) {\n  const elementType = context.hasOESElementIndexUint ?\n    UNSIGNED_INT : UNSIGNED_SHORT;\n  const elementSize = context.hasOESElementIndexUint ? 4 : 2;\n\n  const numItems = end - start;\n  const offsetInBytes = start * elementSize;\n  gl.drawElements(TRIANGLES, numItems, elementType, offsetInBytes);\n};\nexport default WebGLReplay;\n","/**\n * @module ol/render/webgl\n */\n\n\n/**\n * @const\n * @type {string}\n */\nexport const DEFAULT_FONT = '10px sans-serif';\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const DEFAULT_FILLSTYLE = [0.0, 0.0, 0.0, 1.0];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const DEFAULT_LINECAP = 'round';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const DEFAULT_LINEDASH = [];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_LINEDASHOFFSET = 0;\n\n\n/**\n * @const\n * @type {string}\n */\nexport const DEFAULT_LINEJOIN = 'round';\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_MITERLIMIT = 10;\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const DEFAULT_STROKESTYLE = [0.0, 0.0, 0.0, 1.0];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_TEXTALIGN = 0.5;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_TEXTBASELINE = 0.5;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_LINEWIDTH = 1;\n\n/**\n * @const\n * @type {number}\n */\nexport const EPSILON = Number.EPSILON || 2.220446049250313e-16;\n\n/**\n * Calculates the orientation of a triangle based on the determinant method.\n * @param {number} x1 First X coordinate.\n * @param {number} y1 First Y coordinate.\n * @param {number} x2 Second X coordinate.\n * @param {number} y2 Second Y coordinate.\n * @param {number} x3 Third X coordinate.\n * @param {number} y3 Third Y coordinate.\n * @return {boolean|undefined} Triangle is clockwise.\n */\nexport const triangleIsCounterClockwise = function(x1, y1, x2, y2, x3, y3) {\n  const area = (x2 - x1) * (y3 - y1) - (x3 - x1) * (y2 - y1);\n  return (area <= EPSILON && area >= -EPSILON) ?\n    undefined : area > 0;\n};\n\n","/**\n * @module ol/webgl/Buffer\n */\nimport {STATIC_DRAW, STREAM_DRAW, DYNAMIC_DRAW} from '../webgl.js';\n\n/**\n * @enum {number}\n */\nconst BufferUsage = {\n  STATIC_DRAW: STATIC_DRAW,\n  STREAM_DRAW: STREAM_DRAW,\n  DYNAMIC_DRAW: DYNAMIC_DRAW\n};\n\n/**\n * @constructor\n * @param {Array.<number>=} opt_arr Array.\n * @param {number=} opt_usage Usage.\n * @struct\n */\nconst WebGLBuffer = function(opt_arr, opt_usage) {\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.arr_ = opt_arr !== undefined ? opt_arr : [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.usage_ = opt_usage !== undefined ? opt_usage : BufferUsage.STATIC_DRAW;\n\n};\n\n\n/**\n * @return {Array.<number>} Array.\n */\nWebGLBuffer.prototype.getArray = function() {\n  return this.arr_;\n};\n\n\n/**\n * @return {number} Usage.\n */\nWebGLBuffer.prototype.getUsage = function() {\n  return this.usage_;\n};\n\nexport default WebGLBuffer;\n","/**\n * @module ol/render/webgl/CircleReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {equals} from '../../array.js';\nimport {asArray} from '../../color.js';\nimport {intersects} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {translate} from '../../geom/flat/transform.js';\nimport {fragment, vertex} from '../webgl/circlereplay/defaultshader.js';\nimport Locations from '../webgl/circlereplay/defaultshader/Locations.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {DEFAULT_LINEDASH, DEFAULT_LINEDASHOFFSET, DEFAULT_STROKESTYLE,\n  DEFAULT_FILLSTYLE, DEFAULT_LINEWIDTH} from '../webgl.js';\nimport {FLOAT} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLCircleReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/circlereplay/defaultshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n  /**\n   * @private\n   * @type {Array.<Array.<Array.<number>|number>>}\n   */\n  this.styles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.styleIndices_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.radius_ = 0;\n\n  /**\n   * @private\n   * @type {{fillColor: (Array.<number>|null),\n   *         strokeColor: (Array.<number>|null),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineWidth: (number|undefined),\n   *         changed: boolean}|null}\n   */\n  this.state_ = {\n    fillColor: null,\n    strokeColor: null,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineWidth: undefined,\n    changed: false\n  };\n\n};\n\ninherits(WebGLCircleReplay, WebGLReplay);\n\n\n/**\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nWebGLCircleReplay.prototype.drawCoordinates_ = function(\n  flatCoordinates, offset, end, stride) {\n  let numVertices = this.vertices.length;\n  let numIndices = this.indices.length;\n  let n = numVertices / 4;\n  let i, ii;\n  for (i = offset, ii = end; i < ii; i += stride) {\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 0;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 1;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 2;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 3;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n + 2;\n\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 3;\n    this.indices[numIndices++] = n;\n\n    n += 4;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.drawCircle = function(circleGeometry, feature) {\n  const radius = circleGeometry.getRadius();\n  const stride = circleGeometry.getStride();\n  if (radius) {\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n    if (this.state_.changed) {\n      this.styleIndices_.push(this.indices.length);\n      this.state_.changed = false;\n    }\n\n    this.radius_ = radius;\n    let flatCoordinates = circleGeometry.getFlatCoordinates();\n    flatCoordinates = translate(flatCoordinates, 0, 2,\n      stride, -this.origin[0], -this.origin[1]);\n    this.drawCoordinates_(flatCoordinates, 0, 2, stride);\n  } else {\n    if (this.state_.changed) {\n      this.styles_.pop();\n      if (this.styles_.length) {\n        const lastState = this.styles_[this.styles_.length - 1];\n        this.state_.fillColor =  /** @type {Array.<number>} */ (lastState[0]);\n        this.state_.strokeColor = /** @type {Array.<number>} */ (lastState[1]);\n        this.state_.lineWidth = /** @type {number} */ (lastState[2]);\n        this.state_.changed = false;\n      }\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n **/\nWebGLCircleReplay.prototype.finish = function(context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  this.startIndices.push(this.indices.length);\n\n  //Clean up, if there is nothing to draw\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.getDeleteResourcesFunction = function(context) {\n  // We only delete our stuff here. The shaders and the program may\n  // be used by other CircleReplay instances (for other layers). And\n  // they will be deleted when disposing of the module:ol/webgl/Context~WebGLContext\n  // object.\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  return function() {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 16, 0);\n\n  gl.enableVertexAttribArray(locations.a_instruction);\n  gl.vertexAttribPointer(locations.a_instruction, 1, FLOAT,\n    false, 16, 8);\n\n  gl.enableVertexAttribArray(locations.a_radius);\n  gl.vertexAttribPointer(locations.a_radius, 1, FLOAT,\n    false, 16, 12);\n\n  // Enable renderer specific uniforms.\n  gl.uniform2fv(locations.u_size, size);\n  gl.uniform1f(locations.u_pixelRatio, pixelRatio);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_instruction);\n  gl.disableVertexAttribArray(locations.a_radius);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    let i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n      this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n        /** @type {number} */ (nextStyle[2]));\n      this.drawElements(gl, context, start, end);\n      end = start;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n    this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n      /** @type {number} */ (nextStyle[2]));\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n\n      }\n      featureIndex--;\n      end = start;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\nWebGLCircleReplay.prototype.drawReplaySkipping_ = function(gl, context, skippedFeaturesHash) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n    this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n      /** @type {number} */ (nextStyle[2]));\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n        }\n        end = featureStart;\n      }\n      featureIndex--;\n      start = featureStart;\n    }\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n    }\n    start = end = groupStart;\n  }\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n */\nWebGLCircleReplay.prototype.setFillStyle_ = function(gl, color) {\n  gl.uniform4fv(this.defaultLocations_.u_fillColor, color);\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n * @param {number} lineWidth Line width.\n */\nWebGLCircleReplay.prototype.setStrokeStyle_ = function(gl, color, lineWidth) {\n  gl.uniform4fv(this.defaultLocations_.u_strokeColor, color);\n  gl.uniform1f(this.defaultLocations_.u_lineWidth, lineWidth);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  let strokeStyleColor, strokeStyleWidth;\n  if (strokeStyle) {\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    this.state_.lineDash = strokeStyleLineDash ?\n      strokeStyleLineDash : DEFAULT_LINEDASH;\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    this.state_.lineDashOffset = strokeStyleLineDashOffset ?\n      strokeStyleLineDashOffset : DEFAULT_LINEDASHOFFSET;\n    strokeStyleColor = strokeStyle.getColor();\n    if (!(strokeStyleColor instanceof CanvasGradient) &&\n        !(strokeStyleColor instanceof CanvasPattern)) {\n      strokeStyleColor = asArray(strokeStyleColor).map(function(c, i) {\n        return i != 3 ? c / 255 : c;\n      }) || DEFAULT_STROKESTYLE;\n    } else {\n      strokeStyleColor = DEFAULT_STROKESTYLE;\n    }\n    strokeStyleWidth = strokeStyle.getWidth();\n    strokeStyleWidth = strokeStyleWidth !== undefined ?\n      strokeStyleWidth : DEFAULT_LINEWIDTH;\n  } else {\n    strokeStyleColor = [0, 0, 0, 0];\n    strokeStyleWidth = 0;\n  }\n  let fillStyleColor = fillStyle ? fillStyle.getColor() : [0, 0, 0, 0];\n  if (!(fillStyleColor instanceof CanvasGradient) &&\n      !(fillStyleColor instanceof CanvasPattern)) {\n    fillStyleColor = asArray(fillStyleColor).map(function(c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || DEFAULT_FILLSTYLE;\n  } else {\n    fillStyleColor = DEFAULT_FILLSTYLE;\n  }\n  if (!this.state_.strokeColor || !equals(this.state_.strokeColor, strokeStyleColor) ||\n      !this.state_.fillColor || !equals(this.state_.fillColor, fillStyleColor) ||\n      this.state_.lineWidth !== strokeStyleWidth) {\n    this.state_.changed = true;\n    this.state_.fillColor = fillStyleColor;\n    this.state_.strokeColor = strokeStyleColor;\n    this.state_.lineWidth = strokeStyleWidth;\n    this.styles_.push([fillStyleColor, strokeStyleColor, strokeStyleWidth]);\n  }\n};\nexport default WebGLCircleReplay;\n","/**\n * @module ol/render/webgl/texturereplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../index.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_texCoord;\\nvarying float v_opacity;\\n\\nuniform float u_opacity;\\nuniform sampler2D u_image;\\n\\nvoid main(void) {\\n  vec4 texColor = texture2D(u_image, v_texCoord);\\n  gl_FragColor.rgb = texColor.rgb;\\n  float alpha = texColor.a * v_opacity * u_opacity;\\n  if (alpha == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor.a = alpha;\\n}\\n' :\n  'precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_texCoord;\\nvarying float v_opacity;\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texCoord;\\nattribute vec2 a_offsets;\\nattribute float a_opacity;\\nattribute float a_rotateWithView;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\n\\nvoid main(void) {\\n  mat4 offsetMatrix = u_offsetScaleMatrix;\\n  if (a_rotateWithView == 1.0) {\\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\\n  }\\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\\n  v_texCoord = a_texCoord;\\n  v_opacity = a_opacity;\\n}\\n\\n\\n' :\n  'varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}');\n","/**\n * @module ol/render/webgl/texturereplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../../index.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'h');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'i');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'j');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'k');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_image = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_image' : 'l');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'c');\n\n  /**\n   * @type {number}\n   */\n  this.a_texCoord = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_texCoord' : 'd');\n\n  /**\n   * @type {number}\n   */\n  this.a_offsets = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_offsets' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_opacity = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_opacity' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_rotateWithView = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_rotateWithView' : 'g');\n};\n\nexport default Locations;\n","/**\n * @module ol/webgl/ContextEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LOST: 'webglcontextlost',\n  RESTORED: 'webglcontextrestored'\n};\n","/**\n * @module ol/webgl/Context\n */\nimport {WEBGL_EXTENSIONS, getUid, inherits} from '../index.js';\nimport Disposable from '../Disposable.js';\nimport {includes} from '../array.js';\nimport {listen, unlistenAll} from '../events.js';\nimport {clear} from '../obj.js';\nimport {ARRAY_BUFFER, ELEMENT_ARRAY_BUFFER, TEXTURE_2D, TEXTURE_WRAP_S, TEXTURE_WRAP_T} from '../webgl.js';\nimport ContextEventType from '../webgl/ContextEventType.js';\n\n\n/**\n * @typedef {Object} BufferCacheEntry\n * @property {module:ol/webgl/Buffer} buf\n * @property {WebGLBuffer} buffer\n */\n\n\n/**\n * @classdesc\n * A WebGL context for accessing low-level WebGL capabilities.\n *\n * @constructor\n * @extends {module:ol/Disposable}\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {WebGLRenderingContext} gl GL.\n */\nconst WebGLContext = function(canvas, gl) {\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = canvas;\n\n  /**\n   * @private\n   * @type {WebGLRenderingContext}\n   */\n  this.gl_ = gl;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/webgl/Context~BufferCacheEntry>}\n   */\n  this.bufferCache_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, WebGLShader>}\n   */\n  this.shaderCache_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, WebGLProgram>}\n   */\n  this.programCache_ = {};\n\n  /**\n   * @private\n   * @type {WebGLProgram}\n   */\n  this.currentProgram_ = null;\n\n  /**\n   * @private\n   * @type {WebGLFramebuffer}\n   */\n  this.hitDetectionFramebuffer_ = null;\n\n  /**\n   * @private\n   * @type {WebGLTexture}\n   */\n  this.hitDetectionTexture_ = null;\n\n  /**\n   * @private\n   * @type {WebGLRenderbuffer}\n   */\n  this.hitDetectionRenderbuffer_ = null;\n\n  /**\n   * @type {boolean}\n   */\n  this.hasOESElementIndexUint = includes(WEBGL_EXTENSIONS, 'OES_element_index_uint');\n\n  // use the OES_element_index_uint extension if available\n  if (this.hasOESElementIndexUint) {\n    gl.getExtension('OES_element_index_uint');\n  }\n\n  listen(this.canvas_, ContextEventType.LOST,\n    this.handleWebGLContextLost, this);\n  listen(this.canvas_, ContextEventType.RESTORED,\n    this.handleWebGLContextRestored, this);\n\n};\n\ninherits(WebGLContext, Disposable);\n\n\n/**\n * Just bind the buffer if it's in the cache. Otherwise create\n * the WebGL buffer, bind it, populate it, and add an entry to\n * the cache.\n * @param {number} target Target.\n * @param {module:ol/webgl/Buffer} buf Buffer.\n */\nWebGLContext.prototype.bindBuffer = function(target, buf) {\n  const gl = this.getGL();\n  const arr = buf.getArray();\n  const bufferKey = String(getUid(buf));\n  if (bufferKey in this.bufferCache_) {\n    const bufferCacheEntry = this.bufferCache_[bufferKey];\n    gl.bindBuffer(target, bufferCacheEntry.buffer);\n  } else {\n    const buffer = gl.createBuffer();\n    gl.bindBuffer(target, buffer);\n    let /** @type {ArrayBufferView} */ arrayBuffer;\n    if (target == ARRAY_BUFFER) {\n      arrayBuffer = new Float32Array(arr);\n    } else if (target == ELEMENT_ARRAY_BUFFER) {\n      arrayBuffer = this.hasOESElementIndexUint ?\n        new Uint32Array(arr) : new Uint16Array(arr);\n    }\n    gl.bufferData(target, arrayBuffer, buf.getUsage());\n    this.bufferCache_[bufferKey] = {\n      buf: buf,\n      buffer: buffer\n    };\n  }\n};\n\n\n/**\n * @param {module:ol/webgl/Buffer} buf Buffer.\n */\nWebGLContext.prototype.deleteBuffer = function(buf) {\n  const gl = this.getGL();\n  const bufferKey = String(getUid(buf));\n  const bufferCacheEntry = this.bufferCache_[bufferKey];\n  if (!gl.isContextLost()) {\n    gl.deleteBuffer(bufferCacheEntry.buffer);\n  }\n  delete this.bufferCache_[bufferKey];\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLContext.prototype.disposeInternal = function() {\n  unlistenAll(this.canvas_);\n  const gl = this.getGL();\n  if (!gl.isContextLost()) {\n    for (const key in this.bufferCache_) {\n      gl.deleteBuffer(this.bufferCache_[key].buffer);\n    }\n    for (const key in this.programCache_) {\n      gl.deleteProgram(this.programCache_[key]);\n    }\n    for (const key in this.shaderCache_) {\n      gl.deleteShader(this.shaderCache_[key]);\n    }\n    // delete objects for hit-detection\n    gl.deleteFramebuffer(this.hitDetectionFramebuffer_);\n    gl.deleteRenderbuffer(this.hitDetectionRenderbuffer_);\n    gl.deleteTexture(this.hitDetectionTexture_);\n  }\n};\n\n\n/**\n * @return {HTMLCanvasElement} Canvas.\n */\nWebGLContext.prototype.getCanvas = function() {\n  return this.canvas_;\n};\n\n\n/**\n * Get the WebGL rendering context\n * @return {WebGLRenderingContext} The rendering context.\n * @api\n */\nWebGLContext.prototype.getGL = function() {\n  return this.gl_;\n};\n\n\n/**\n * Get the frame buffer for hit detection.\n * @return {WebGLFramebuffer} The hit detection frame buffer.\n */\nWebGLContext.prototype.getHitDetectionFramebuffer = function() {\n  if (!this.hitDetectionFramebuffer_) {\n    this.initHitDetectionFramebuffer_();\n  }\n  return this.hitDetectionFramebuffer_;\n};\n\n\n/**\n * Get shader from the cache if it's in the cache. Otherwise, create\n * the WebGL shader, compile it, and add entry to cache.\n * @param {module:ol/webgl/Shader} shaderObject Shader object.\n * @return {WebGLShader} Shader.\n */\nWebGLContext.prototype.getShader = function(shaderObject) {\n  const shaderKey = String(getUid(shaderObject));\n  if (shaderKey in this.shaderCache_) {\n    return this.shaderCache_[shaderKey];\n  } else {\n    const gl = this.getGL();\n    const shader = gl.createShader(shaderObject.getType());\n    gl.shaderSource(shader, shaderObject.getSource());\n    gl.compileShader(shader);\n    this.shaderCache_[shaderKey] = shader;\n    return shader;\n  }\n};\n\n\n/**\n * Get the program from the cache if it's in the cache. Otherwise create\n * the WebGL program, attach the shaders to it, and add an entry to the\n * cache.\n * @param {module:ol/webgl/Fragment} fragmentShaderObject Fragment shader.\n * @param {module:ol/webgl/Vertex} vertexShaderObject Vertex shader.\n * @return {WebGLProgram} Program.\n */\nWebGLContext.prototype.getProgram = function(fragmentShaderObject, vertexShaderObject) {\n  const programKey = getUid(fragmentShaderObject) + '/' + getUid(vertexShaderObject);\n  if (programKey in this.programCache_) {\n    return this.programCache_[programKey];\n  } else {\n    const gl = this.getGL();\n    const program = gl.createProgram();\n    gl.attachShader(program, this.getShader(fragmentShaderObject));\n    gl.attachShader(program, this.getShader(vertexShaderObject));\n    gl.linkProgram(program);\n    this.programCache_[programKey] = program;\n    return program;\n  }\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nWebGLContext.prototype.handleWebGLContextLost = function() {\n  clear(this.bufferCache_);\n  clear(this.shaderCache_);\n  clear(this.programCache_);\n  this.currentProgram_ = null;\n  this.hitDetectionFramebuffer_ = null;\n  this.hitDetectionTexture_ = null;\n  this.hitDetectionRenderbuffer_ = null;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nWebGLContext.prototype.handleWebGLContextRestored = function() {\n};\n\n\n/**\n * Creates a 1x1 pixel framebuffer for the hit-detection.\n * @private\n */\nWebGLContext.prototype.initHitDetectionFramebuffer_ = function() {\n  const gl = this.gl_;\n  const framebuffer = gl.createFramebuffer();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n\n  const texture = createEmptyTexture(gl, 1, 1);\n  const renderbuffer = gl.createRenderbuffer();\n  gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n  gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, 1, 1);\n  gl.framebufferTexture2D(\n    gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n  gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT,\n    gl.RENDERBUFFER, renderbuffer);\n\n  gl.bindTexture(gl.TEXTURE_2D, null);\n  gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n  gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n  this.hitDetectionFramebuffer_ = framebuffer;\n  this.hitDetectionTexture_ = texture;\n  this.hitDetectionRenderbuffer_ = renderbuffer;\n};\n\n\n/**\n * Use a program.  If the program is already in use, this will return `false`.\n * @param {WebGLProgram} program Program.\n * @return {boolean} Changed.\n * @api\n */\nWebGLContext.prototype.useProgram = function(program) {\n  if (program == this.currentProgram_) {\n    return false;\n  } else {\n    const gl = this.getGL();\n    gl.useProgram(program);\n    this.currentProgram_ = program;\n    return true;\n  }\n};\n\n\n/**\n * @param {WebGLRenderingContext} gl WebGL rendering context.\n * @param {number=} opt_wrapS wrapS.\n * @param {number=} opt_wrapT wrapT.\n * @return {WebGLTexture} The texture.\n */\nfunction createTextureInternal(gl, opt_wrapS, opt_wrapT) {\n  const texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\n  if (opt_wrapS !== undefined) {\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_WRAP_S, opt_wrapS);\n  }\n  if (opt_wrapT !== undefined) {\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_WRAP_T, opt_wrapT);\n  }\n\n  return texture;\n}\n\n\n/**\n * @param {WebGLRenderingContext} gl WebGL rendering context.\n * @param {number} width Width.\n * @param {number} height Height.\n * @param {number=} opt_wrapS wrapS.\n * @param {number=} opt_wrapT wrapT.\n * @return {WebGLTexture} The texture.\n */\nexport function createEmptyTexture(gl, width, height, opt_wrapS, opt_wrapT) {\n  const texture = createTextureInternal(gl, opt_wrapS, opt_wrapT);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n  return texture;\n}\n\n\n/**\n * @param {WebGLRenderingContext} gl WebGL rendering context.\n * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image.\n * @param {number=} opt_wrapS wrapS.\n * @param {number=} opt_wrapT wrapT.\n * @return {WebGLTexture} The texture.\n */\nexport function createTexture(gl, image, opt_wrapS, opt_wrapT) {\n  const texture = createTextureInternal(gl, opt_wrapS, opt_wrapT);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n  return texture;\n}\n\nexport default WebGLContext;\n","/**\n * @module ol/render/webgl/TextureReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {intersects} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {fragment, vertex} from '../webgl/texturereplay/defaultshader.js';\nimport Locations from '../webgl/texturereplay/defaultshader/Locations.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {CLAMP_TO_EDGE, FLOAT, TEXTURE_2D} from '../../webgl.js';\nimport {createTexture} from '../../webgl/Context.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLTextureReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.anchorX = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.anchorY = undefined;\n\n  /**\n   * @type {Array.<number>}\n   * @protected\n   */\n  this.groupIndices = [];\n\n  /**\n   * @type {Array.<number>}\n   * @protected\n   */\n  this.hitDetectionGroupIndices = [];\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.height = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.imageHeight = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.imageWidth = undefined;\n\n  /**\n   * @protected\n   * @type {module:ol/render/webgl/texturereplay/defaultshader/Locations}\n   */\n  this.defaultLocations = null;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.opacity = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.originX = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.originY = undefined;\n\n  /**\n   * @protected\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView = undefined;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.rotation = undefined;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.scale = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.width = undefined;\n};\n\ninherits(WebGLTextureReplay, WebGLReplay);\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.getDeleteResourcesFunction = function(context) {\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  const textures = this.getTextures(true);\n  const gl = context.getGL();\n  return function() {\n    if (!gl.isContextLost()) {\n      let i, ii;\n      for (i = 0, ii = textures.length; i < ii; ++i) {\n        gl.deleteTexture(textures[i]);\n      }\n    }\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} My end.\n * @protected\n */\nWebGLTextureReplay.prototype.drawCoordinates = function(flatCoordinates, offset, end, stride) {\n  const anchorX = /** @type {number} */ (this.anchorX);\n  const anchorY = /** @type {number} */ (this.anchorY);\n  const height = /** @type {number} */ (this.height);\n  const imageHeight = /** @type {number} */ (this.imageHeight);\n  const imageWidth = /** @type {number} */ (this.imageWidth);\n  const opacity = /** @type {number} */ (this.opacity);\n  const originX = /** @type {number} */ (this.originX);\n  const originY = /** @type {number} */ (this.originY);\n  const rotateWithView = this.rotateWithView ? 1.0 : 0.0;\n  // this.rotation_ is anti-clockwise, but rotation is clockwise\n  const rotation = /** @type {number} */ (-this.rotation);\n  const scale = /** @type {number} */ (this.scale);\n  const width = /** @type {number} */ (this.width);\n  const cos = Math.cos(rotation);\n  const sin = Math.sin(rotation);\n  let numIndices = this.indices.length;\n  let numVertices = this.vertices.length;\n  let i, n, offsetX, offsetY, x, y;\n  for (i = offset; i < end; i += stride) {\n    x = flatCoordinates[i] - this.origin[0];\n    y = flatCoordinates[i + 1] - this.origin[1];\n\n    // There are 4 vertices per [x, y] point, one for each corner of the\n    // rectangle we're going to draw. We'd use 1 vertex per [x, y] point if\n    // WebGL supported Geometry Shaders (which can emit new vertices), but that\n    // is not currently the case.\n    //\n    // And each vertex includes 8 values: the x and y coordinates, the x and\n    // y offsets used to calculate the position of the corner, the u and\n    // v texture coordinates for the corner, the opacity, and whether the\n    // the image should be rotated with the view (rotateWithView).\n\n    n = numVertices / 8;\n\n    // bottom-left corner\n    offsetX = -scale * anchorX;\n    offsetY = -scale * (height - anchorY);\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = originX / imageWidth;\n    this.vertices[numVertices++] = (originY + height) / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    // bottom-right corner\n    offsetX = scale * (width - anchorX);\n    offsetY = -scale * (height - anchorY);\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = (originX + width) / imageWidth;\n    this.vertices[numVertices++] = (originY + height) / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    // top-right corner\n    offsetX = scale * (width - anchorX);\n    offsetY = scale * anchorY;\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = (originX + width) / imageWidth;\n    this.vertices[numVertices++] = originY / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    // top-left corner\n    offsetX = -scale * anchorX;\n    offsetY = scale * anchorY;\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = originX / imageWidth;\n    this.vertices[numVertices++] = originY / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 3;\n  }\n\n  return numVertices;\n};\n\n\n/**\n * @protected\n * @param {Array.<WebGLTexture>} textures Textures.\n * @param {Array.<HTMLCanvasElement|HTMLImageElement|HTMLVideoElement>} images Images.\n * @param {!Object.<string, WebGLTexture>} texturePerImage Texture cache.\n * @param {WebGLRenderingContext} gl Gl.\n */\nWebGLTextureReplay.prototype.createTextures = function(textures, images, texturePerImage, gl) {\n  let texture, image, uid, i;\n  const ii = images.length;\n  for (i = 0; i < ii; ++i) {\n    image = images[i];\n\n    uid = getUid(image).toString();\n    if (uid in texturePerImage) {\n      texture = texturePerImage[uid];\n    } else {\n      texture = createTexture(\n        gl, image, CLAMP_TO_EDGE, CLAMP_TO_EDGE);\n      texturePerImage[uid] = texture;\n    }\n    textures[i] = texture;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations) {\n    locations = new Locations(gl, program);\n    this.defaultLocations = locations;\n  } else {\n    locations = this.defaultLocations;\n  }\n\n  // use the program (FIXME: use the return value)\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 32, 0);\n\n  gl.enableVertexAttribArray(locations.a_offsets);\n  gl.vertexAttribPointer(locations.a_offsets, 2, FLOAT,\n    false, 32, 8);\n\n  gl.enableVertexAttribArray(locations.a_texCoord);\n  gl.vertexAttribPointer(locations.a_texCoord, 2, FLOAT,\n    false, 32, 16);\n\n  gl.enableVertexAttribArray(locations.a_opacity);\n  gl.vertexAttribPointer(locations.a_opacity, 1, FLOAT,\n    false, 32, 24);\n\n  gl.enableVertexAttribArray(locations.a_rotateWithView);\n  gl.vertexAttribPointer(locations.a_rotateWithView, 1, FLOAT,\n    false, 32, 28);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_offsets);\n  gl.disableVertexAttribArray(locations.a_texCoord);\n  gl.disableVertexAttribArray(locations.a_opacity);\n  gl.disableVertexAttribArray(locations.a_rotateWithView);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  const textures = hitDetection ? this.getHitDetectionTextures() : this.getTextures();\n  const groupIndices = hitDetection ? this.hitDetectionGroupIndices : this.groupIndices;\n\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping(gl, context, skippedFeaturesHash, textures, groupIndices);\n  } else {\n    let i, ii, start;\n    for (i = 0, ii = textures.length, start = 0; i < ii; ++i) {\n      gl.bindTexture(TEXTURE_2D, textures[i]);\n      const end = groupIndices[i];\n      this.drawElements(gl, context, start, end);\n      start = end;\n    }\n  }\n};\n\n\n/**\n * Draw the replay while paying attention to skipped features.\n *\n * This functions creates groups of features that can be drawn to together,\n * so that the number of `drawElements` calls is minimized.\n *\n * For example given the following texture groups:\n *\n *    Group 1: A B C\n *    Group 2: D [E] F G\n *\n * If feature E should be skipped, the following `drawElements` calls will be\n * made:\n *\n *    drawElements with feature A, B and C\n *    drawElements with feature D\n *    drawElements with feature F and G\n *\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *  to skip.\n * @param {Array.<WebGLTexture>} textures Textures.\n * @param {Array.<number>} groupIndices Texture group indices.\n */\nWebGLTextureReplay.prototype.drawReplaySkipping = function(gl, context, skippedFeaturesHash, textures,\n  groupIndices) {\n  let featureIndex = 0;\n\n  let i, ii;\n  for (i = 0, ii = textures.length; i < ii; ++i) {\n    gl.bindTexture(TEXTURE_2D, textures[i]);\n    const groupStart = (i > 0) ? groupIndices[i - 1] : 0;\n    const groupEnd = groupIndices[i];\n\n    let start = groupStart;\n    let end = groupStart;\n    while (featureIndex < this.startIndices.length &&\n        this.startIndices[featureIndex] <= groupEnd) {\n      const feature = this.startIndicesFeature[featureIndex];\n\n      const featureUid = getUid(feature).toString();\n      if (skippedFeaturesHash[featureUid] !== undefined) {\n        // feature should be skipped\n        if (start !== end) {\n          // draw the features so far\n          this.drawElements(gl, context, start, end);\n        }\n        // continue with the next feature\n        start = (featureIndex === this.startIndices.length - 1) ?\n          groupEnd : this.startIndices[featureIndex + 1];\n        end = start;\n      } else {\n        // the feature is not skipped, augment the end index\n        end = (featureIndex === this.startIndices.length - 1) ?\n          groupEnd : this.startIndices[featureIndex + 1];\n      }\n      featureIndex++;\n    }\n\n    if (start !== end) {\n      // draw the remaining features (in case there was no skipped feature\n      // in this texture group, all features of a group are drawn together)\n      this.drawElements(gl, context, start, end);\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, groupStart, start, end, feature, featureUid;\n  let featureIndex = this.startIndices.length - 1;\n  const hitDetectionTextures = this.getHitDetectionTextures();\n  for (i = hitDetectionTextures.length - 1; i >= 0; --i) {\n    gl.bindTexture(TEXTURE_2D, hitDetectionTextures[i]);\n    groupStart = (i > 0) ? this.hitDetectionGroupIndices[i - 1] : 0;\n    end = this.hitDetectionGroupIndices[i];\n\n    // draw all features for this texture group\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n        if (result) {\n          return result;\n        }\n      }\n\n      end = start;\n      featureIndex--;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.finish = function(context) {\n  this.anchorX = undefined;\n  this.anchorY = undefined;\n  this.height = undefined;\n  this.imageHeight = undefined;\n  this.imageWidth = undefined;\n  this.indices = null;\n  this.opacity = undefined;\n  this.originX = undefined;\n  this.originY = undefined;\n  this.rotateWithView = undefined;\n  this.rotation = undefined;\n  this.scale = undefined;\n  this.vertices = null;\n  this.width = undefined;\n};\n\n\n/**\n * @abstract\n * @protected\n * @param {boolean=} opt_all Return hit detection textures with regular ones.\n * @returns {Array.<WebGLTexture>} Textures.\n */\nWebGLTextureReplay.prototype.getTextures = function(opt_all) {};\n\n\n/**\n * @abstract\n * @protected\n * @returns {Array.<WebGLTexture>} Textures.\n */\nWebGLTextureReplay.prototype.getHitDetectionTextures = function() {};\nexport default WebGLTextureReplay;\n","/**\n * @module ol/render/webgl/ImageReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport WebGLTextureReplay from '../webgl/TextureReplay.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/TextureReplay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLImageReplay = function(tolerance, maxExtent) {\n  WebGLTextureReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @type {Array.<HTMLCanvasElement|HTMLImageElement|HTMLVideoElement>}\n   * @protected\n   */\n  this.images_ = [];\n\n  /**\n   * @type {Array.<HTMLCanvasElement|HTMLImageElement|HTMLVideoElement>}\n   * @protected\n   */\n  this.hitDetectionImages_ = [];\n\n  /**\n   * @type {Array.<WebGLTexture>}\n   * @private\n   */\n  this.textures_ = [];\n\n  /**\n   * @type {Array.<WebGLTexture>}\n   * @private\n   */\n  this.hitDetectionTextures_ = [];\n\n};\n\ninherits(WebGLImageReplay, WebGLTextureReplay);\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.drawMultiPoint = function(multiPointGeometry, feature) {\n  this.startIndices.push(this.indices.length);\n  this.startIndicesFeature.push(feature);\n  const flatCoordinates = multiPointGeometry.getFlatCoordinates();\n  const stride = multiPointGeometry.getStride();\n  this.drawCoordinates(\n    flatCoordinates, 0, flatCoordinates.length, stride);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.drawPoint = function(pointGeometry, feature) {\n  this.startIndices.push(this.indices.length);\n  this.startIndicesFeature.push(feature);\n  const flatCoordinates = pointGeometry.getFlatCoordinates();\n  const stride = pointGeometry.getStride();\n  this.drawCoordinates(\n    flatCoordinates, 0, flatCoordinates.length, stride);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.finish = function(context) {\n  const gl = context.getGL();\n\n  this.groupIndices.push(this.indices.length);\n  this.hitDetectionGroupIndices.push(this.indices.length);\n\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  const indices = this.indices;\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(indices);\n\n  // create textures\n  /** @type {Object.<string, WebGLTexture>} */\n  const texturePerImage = {};\n\n  this.createTextures(this.textures_, this.images_, texturePerImage, gl);\n\n  this.createTextures(this.hitDetectionTextures_, this.hitDetectionImages_,\n    texturePerImage, gl);\n\n  this.images_ = null;\n  this.hitDetectionImages_ = null;\n  WebGLTextureReplay.prototype.finish.call(this, context);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.setImageStyle = function(imageStyle) {\n  const anchor = imageStyle.getAnchor();\n  const image = imageStyle.getImage(1);\n  const imageSize = imageStyle.getImageSize();\n  const hitDetectionImage = imageStyle.getHitDetectionImage(1);\n  const opacity = imageStyle.getOpacity();\n  const origin = imageStyle.getOrigin();\n  const rotateWithView = imageStyle.getRotateWithView();\n  const rotation = imageStyle.getRotation();\n  const size = imageStyle.getSize();\n  const scale = imageStyle.getScale();\n\n  let currentImage;\n  if (this.images_.length === 0) {\n    this.images_.push(image);\n  } else {\n    currentImage = this.images_[this.images_.length - 1];\n    if (getUid(currentImage) != getUid(image)) {\n      this.groupIndices.push(this.indices.length);\n      this.images_.push(image);\n    }\n  }\n\n  if (this.hitDetectionImages_.length === 0) {\n    this.hitDetectionImages_.push(hitDetectionImage);\n  } else {\n    currentImage =\n        this.hitDetectionImages_[this.hitDetectionImages_.length - 1];\n    if (getUid(currentImage) != getUid(hitDetectionImage)) {\n      this.hitDetectionGroupIndices.push(this.indices.length);\n      this.hitDetectionImages_.push(hitDetectionImage);\n    }\n  }\n\n  this.anchorX = anchor[0];\n  this.anchorY = anchor[1];\n  this.height = size[1];\n  this.imageHeight = imageSize[1];\n  this.imageWidth = imageSize[0];\n  this.opacity = opacity;\n  this.originX = origin[0];\n  this.originY = origin[1];\n  this.rotation = rotation;\n  this.rotateWithView = rotateWithView;\n  this.scale = scale;\n  this.width = size[0];\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.getTextures = function(opt_all) {\n  return opt_all ? this.textures_.concat(this.hitDetectionTextures_) : this.textures_;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.getHitDetectionTextures = function() {\n  return this.hitDetectionTextures_;\n};\nexport default WebGLImageReplay;\n","/**\n * @module ol/geom/flat/topology\n */\nimport {linearRing as linearRingArea} from '../flat/area.js';\n\n/**\n * Check if the linestring is a boundary.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} The linestring is a boundary.\n */\nexport function lineStringIsClosed(flatCoordinates, offset, end, stride) {\n  const lastCoord = end - stride;\n  if (flatCoordinates[offset] === flatCoordinates[lastCoord] &&\n      flatCoordinates[offset + 1] === flatCoordinates[lastCoord + 1] && (end - offset) / stride > 3) {\n    return !!linearRingArea(flatCoordinates, offset, end, stride);\n  }\n  return false;\n}\n","/**\n * @module ol/render/webgl/linestringreplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../index.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying float v_round;\\nvarying vec2 v_roundVertex;\\nvarying float v_halfWidth;\\n\\n\\n\\nuniform float u_opacity;\\nuniform vec4 u_color;\\nuniform vec2 u_size;\\nuniform float u_pixelRatio;\\n\\nvoid main(void) {\\n  if (v_round > 0.0) {\\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\\n      discard;\\n    }\\n  }\\n  gl_FragColor = u_color;\\n  float alpha = u_color.a * u_opacity;\\n  if (alpha == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor.a = alpha;\\n}\\n' :\n  'precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying float v_round;\\nvarying vec2 v_roundVertex;\\nvarying float v_halfWidth;\\n\\n\\nattribute vec2 a_lastPos;\\nattribute vec2 a_position;\\nattribute vec2 a_nextPos;\\nattribute float a_direction;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\nuniform float u_lineWidth;\\nuniform float u_miterLimit;\\n\\nbool nearlyEquals(in float value, in float ref) {\\n  float epsilon = 0.000000000001;\\n  return value >= ref - epsilon && value <= ref + epsilon;\\n}\\n\\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\\n  vec2 dirVect = nextP - a_position;\\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\\n  offset = u_lineWidth / 2.0 * normal * direction;\\n}\\n\\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\\n  float halfWidth = u_lineWidth / 2.0;\\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\\n  vec2 normal = vec2(-tangent.y, tangent.x);\\n  vec2 dirVect = a_nextPos - a_position;\\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\\n  offset = normal * direction * miterLength;\\n  round = 0.0;\\n  if (isRound) {\\n    round = 1.0;\\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\\n    offset = halfWidth * tmpNormal * direction;\\n  }\\n}\\n\\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\\n  bool degenerate = false;\\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\\n  vec2 normal = vec2(-tangent.y, tangent.x);\\n  vec2 dirVect = a_lastPos - a_position;\\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\\n  vec2 longOffset, shortOffset, longVertex;\\n  vec4 shortProjVertex;\\n  float halfWidth = u_lineWidth / 2.0;\\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\\n    longOffset = tmpNormal * direction * halfWidth;\\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\\n    longVertex = a_nextPos;\\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\\n  } else {\\n    shortOffset = tmpNormal * direction * halfWidth;\\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\\n    longVertex = a_lastPos;\\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\\n  }\\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\\n  float epsilon = 0.000000000001;\\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\\n    offset = shortProjVertex.xy;\\n    degenerate = true;\\n  } else {\\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\\n    offset = normal * direction * miterLength;\\n  }\\n  return degenerate;\\n}\\n\\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\\n    in float turnDir, in float direction) {\\n  round = 0.0;\\n  vec2 dirVect = a_position - nextP;\\n  vec2 firstNormal = normalize(dirVect);\\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\\n  offset = normal * length;\\n  if (isRound) {\\n    round = 1.0;\\n  }\\n}\\n\\nvoid main(void) {\\n  bool degenerate = false;\\n  float direction = float(sign(a_direction));\\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\\n  vec2 offset;\\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\\n\\n  v_round = 0.0;\\n  v_halfWidth = u_lineWidth / 2.0;\\n  v_roundVertex = projPos.xy;\\n\\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\\n    alongNormal(offset, a_nextPos, 1.0, direction);\\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\\n    alongNormal(offset, a_lastPos, -1.0, direction);\\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\\n    miterUp(offset, v_round, round, direction);\\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\\n  }\\n  if (!degenerate) {\\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\\n    gl_Position = projPos + offsets;\\n  } else {\\n    gl_Position = vec4(offset, 0.0, 1.0);\\n  }\\n}\\n\\n\\n' :\n  'varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}');\n","/**\n * @module ol/render/webgl/linestringreplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../../index.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'h');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'i');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'j');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_lineWidth = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_lineWidth' : 'k');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_miterLimit = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_miterLimit' : 'l');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'm');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_color = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_color' : 'n');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_size = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_size' : 'o');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_pixelRatio = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_pixelRatio' : 'p');\n\n  /**\n   * @type {number}\n   */\n  this.a_lastPos = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_lastPos' : 'd');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_nextPos = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_nextPos' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_direction = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_direction' : 'g');\n};\n\nexport default Locations;\n","/**\n * @module ol/render/webgl/LineStringReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {equals} from '../../array.js';\nimport {asArray} from '../../color.js';\nimport {intersects} from '../../extent.js';\nimport {linearRingIsClockwise} from '../../geom/flat/orient.js';\nimport {translate} from '../../geom/flat/transform.js';\nimport {lineStringIsClosed} from '../../geom/flat/topology.js';\nimport {isEmpty} from '../../obj.js';\nimport {DEFAULT_LINECAP, DEFAULT_LINEDASH, DEFAULT_LINEDASHOFFSET,\n  DEFAULT_LINEJOIN, DEFAULT_LINEWIDTH, DEFAULT_MITERLIMIT, DEFAULT_STROKESTYLE,\n  triangleIsCounterClockwise} from '../webgl.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {fragment, vertex} from '../webgl/linestringreplay/defaultshader.js';\nimport Locations from '../webgl/linestringreplay/defaultshader/Locations.js';\nimport {FLOAT} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n\n/**\n * @enum {number}\n */\nconst Instruction = {\n  ROUND: 2,\n  BEGIN_LINE: 3,\n  END_LINE: 5,\n  BEGIN_LINE_CAP: 7,\n  END_LINE_CAP: 11,\n  BEVEL_FIRST: 13,\n  BEVEL_SECOND: 17,\n  MITER_BOTTOM: 19,\n  MITER_TOP: 23\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLLineStringReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/linestringreplay/defaultshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n  /**\n   * @private\n   * @type {Array.<Array.<?>>}\n   */\n  this.styles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.styleIndices_ = [];\n\n  /**\n   * @private\n   * @type {{strokeColor: (Array.<number>|null),\n   *         lineCap: (string|undefined),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineJoin: (string|undefined),\n   *         lineWidth: (number|undefined),\n   *         miterLimit: (number|undefined),\n   *         changed: boolean}|null}\n   */\n  this.state_ = {\n    strokeColor: null,\n    lineCap: undefined,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineJoin: undefined,\n    lineWidth: undefined,\n    miterLimit: undefined,\n    changed: false\n  };\n\n};\n\ninherits(WebGLLineStringReplay, WebGLReplay);\n\n\n/**\n * Draw one segment.\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nWebGLLineStringReplay.prototype.drawCoordinates_ = function(flatCoordinates, offset, end, stride) {\n\n  let i, ii;\n  let numVertices = this.vertices.length;\n  let numIndices = this.indices.length;\n  //To save a vertex, the direction of a point is a product of the sign (1 or -1), a prime from\n  //Instruction, and a rounding factor (1 or 2). If the product is even,\n  //we round it. If it is odd, we don't.\n  const lineJoin = this.state_.lineJoin === 'bevel' ? 0 :\n    this.state_.lineJoin === 'miter' ? 1 : 2;\n  const lineCap = this.state_.lineCap === 'butt' ? 0 :\n    this.state_.lineCap === 'square' ? 1 : 2;\n  const closed = lineStringIsClosed(flatCoordinates, offset, end, stride);\n  let startCoords, sign, n;\n  let lastIndex = numIndices;\n  let lastSign = 1;\n  //We need the adjacent vertices to define normals in joins. p0 = last, p1 = current, p2 = next.\n  let p0, p1, p2;\n\n  for (i = offset, ii = end; i < ii; i += stride) {\n\n    n = numVertices / 7;\n\n    p0 = p1;\n    p1 = p2 || [flatCoordinates[i], flatCoordinates[i + 1]];\n    //First vertex.\n    if (i === offset) {\n      p2 = [flatCoordinates[i + stride], flatCoordinates[i + stride + 1]];\n      if (end - offset === stride * 2 && equals(p1, p2)) {\n        break;\n      }\n      if (closed) {\n        //A closed line! Complete the circle.\n        p0 = [flatCoordinates[end - stride * 2],\n          flatCoordinates[end - stride * 2 + 1]];\n\n        startCoords = p2;\n      } else {\n        //Add the first two/four vertices.\n\n        if (lineCap) {\n          numVertices = this.addVertices_([0, 0], p1, p2,\n            lastSign * Instruction.BEGIN_LINE_CAP * lineCap, numVertices);\n\n          numVertices = this.addVertices_([0, 0], p1, p2,\n            -lastSign * Instruction.BEGIN_LINE_CAP * lineCap, numVertices);\n\n          this.indices[numIndices++] = n + 2;\n          this.indices[numIndices++] = n;\n          this.indices[numIndices++] = n + 1;\n\n          this.indices[numIndices++] = n + 1;\n          this.indices[numIndices++] = n + 3;\n          this.indices[numIndices++] = n + 2;\n\n        }\n\n        numVertices = this.addVertices_([0, 0], p1, p2,\n          lastSign * Instruction.BEGIN_LINE * (lineCap || 1), numVertices);\n\n        numVertices = this.addVertices_([0, 0], p1, p2,\n          -lastSign * Instruction.BEGIN_LINE * (lineCap || 1), numVertices);\n\n        lastIndex = numVertices / 7 - 1;\n\n        continue;\n      }\n    } else if (i === end - stride) {\n      //Last vertex.\n      if (closed) {\n        //Same as the first vertex.\n        p2 = startCoords;\n        break;\n      } else {\n        p0 = p0 || [0, 0];\n\n        numVertices = this.addVertices_(p0, p1, [0, 0],\n          lastSign * Instruction.END_LINE * (lineCap || 1), numVertices);\n\n        numVertices = this.addVertices_(p0, p1, [0, 0],\n          -lastSign * Instruction.END_LINE * (lineCap || 1), numVertices);\n\n        this.indices[numIndices++] = n;\n        this.indices[numIndices++] = lastIndex - 1;\n        this.indices[numIndices++] = lastIndex;\n\n        this.indices[numIndices++] = lastIndex;\n        this.indices[numIndices++] = n + 1;\n        this.indices[numIndices++] = n;\n\n        if (lineCap) {\n          numVertices = this.addVertices_(p0, p1, [0, 0],\n            lastSign * Instruction.END_LINE_CAP * lineCap, numVertices);\n\n          numVertices = this.addVertices_(p0, p1, [0, 0],\n            -lastSign * Instruction.END_LINE_CAP * lineCap, numVertices);\n\n          this.indices[numIndices++] = n + 2;\n          this.indices[numIndices++] = n;\n          this.indices[numIndices++] = n + 1;\n\n          this.indices[numIndices++] = n + 1;\n          this.indices[numIndices++] = n + 3;\n          this.indices[numIndices++] = n + 2;\n\n        }\n\n        break;\n      }\n    } else {\n      p2 = [flatCoordinates[i + stride], flatCoordinates[i + stride + 1]];\n    }\n\n    // We group CW and straight lines, thus the not so inituitive CCW checking function.\n    sign = triangleIsCounterClockwise(p0[0], p0[1], p1[0], p1[1], p2[0], p2[1])\n      ? -1 : 1;\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      sign * Instruction.BEVEL_FIRST * (lineJoin || 1), numVertices);\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      sign * Instruction.BEVEL_SECOND * (lineJoin || 1), numVertices);\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      -sign * Instruction.MITER_BOTTOM * (lineJoin || 1), numVertices);\n\n    if (i > offset) {\n      this.indices[numIndices++] = n;\n      this.indices[numIndices++] = lastIndex - 1;\n      this.indices[numIndices++] = lastIndex;\n\n      this.indices[numIndices++] = n + 2;\n      this.indices[numIndices++] = n;\n      this.indices[numIndices++] = lastSign * sign > 0 ? lastIndex : lastIndex - 1;\n    }\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 1;\n\n    lastIndex = n + 2;\n    lastSign = sign;\n\n    //Add miter\n    if (lineJoin) {\n      numVertices = this.addVertices_(p0, p1, p2,\n        sign * Instruction.MITER_TOP * lineJoin, numVertices);\n\n      this.indices[numIndices++] = n + 1;\n      this.indices[numIndices++] = n + 3;\n      this.indices[numIndices++] = n;\n    }\n  }\n\n  if (closed) {\n    n = n || numVertices / 7;\n    sign = linearRingIsClockwise([p0[0], p0[1], p1[0], p1[1], p2[0], p2[1]], 0, 6, 2)\n      ? 1 : -1;\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      sign * Instruction.BEVEL_FIRST * (lineJoin || 1), numVertices);\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      -sign * Instruction.MITER_BOTTOM * (lineJoin || 1), numVertices);\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = lastIndex - 1;\n    this.indices[numIndices++] = lastIndex;\n\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = lastSign * sign > 0 ? lastIndex : lastIndex - 1;\n  }\n};\n\n/**\n * @param {Array.<number>} p0 Last coordinates.\n * @param {Array.<number>} p1 Current coordinates.\n * @param {Array.<number>} p2 Next coordinates.\n * @param {number} product Sign, instruction, and rounding product.\n * @param {number} numVertices Vertex counter.\n * @return {number} Vertex counter.\n * @private\n */\nWebGLLineStringReplay.prototype.addVertices_ = function(p0, p1, p2, product, numVertices) {\n  this.vertices[numVertices++] = p0[0];\n  this.vertices[numVertices++] = p0[1];\n  this.vertices[numVertices++] = p1[0];\n  this.vertices[numVertices++] = p1[1];\n  this.vertices[numVertices++] = p2[0];\n  this.vertices[numVertices++] = p2[1];\n  this.vertices[numVertices++] = product;\n\n  return numVertices;\n};\n\n/**\n * Check if the linestring can be drawn (i. e. valid).\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} The linestring can be drawn.\n * @private\n */\nWebGLLineStringReplay.prototype.isValid_ = function(flatCoordinates, offset, end, stride) {\n  const range = end - offset;\n  if (range < stride * 2) {\n    return false;\n  } else if (range === stride * 2) {\n    const firstP = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n    const lastP = [flatCoordinates[offset + stride], flatCoordinates[offset + stride + 1]];\n    return !equals(firstP, lastP);\n  }\n\n  return true;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawLineString = function(lineStringGeometry, feature) {\n  let flatCoordinates = lineStringGeometry.getFlatCoordinates();\n  const stride = lineStringGeometry.getStride();\n  if (this.isValid_(flatCoordinates, 0, flatCoordinates.length, stride)) {\n    flatCoordinates = translate(flatCoordinates, 0, flatCoordinates.length,\n      stride, -this.origin[0], -this.origin[1]);\n    if (this.state_.changed) {\n      this.styleIndices_.push(this.indices.length);\n      this.state_.changed = false;\n    }\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n    this.drawCoordinates_(\n      flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {\n  const indexCount = this.indices.length;\n  const ends = multiLineStringGeometry.getEnds();\n  ends.unshift(0);\n  const flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n  const stride = multiLineStringGeometry.getStride();\n  let i, ii;\n  if (ends.length > 1) {\n    for (i = 1, ii = ends.length; i < ii; ++i) {\n      if (this.isValid_(flatCoordinates, ends[i - 1], ends[i], stride)) {\n        const lineString = translate(flatCoordinates, ends[i - 1], ends[i],\n          stride, -this.origin[0], -this.origin[1]);\n        this.drawCoordinates_(\n          lineString, 0, lineString.length, stride);\n      }\n    }\n  }\n  if (this.indices.length > indexCount) {\n    this.startIndices.push(indexCount);\n    this.startIndicesFeature.push(feature);\n    if (this.state_.changed) {\n      this.styleIndices_.push(indexCount);\n      this.state_.changed = false;\n    }\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<Array.<number>>} holeFlatCoordinates Hole flat coordinates.\n * @param {number} stride Stride.\n */\nWebGLLineStringReplay.prototype.drawPolygonCoordinates = function(\n  flatCoordinates, holeFlatCoordinates, stride) {\n  if (!lineStringIsClosed(flatCoordinates, 0, flatCoordinates.length, stride)) {\n    flatCoordinates.push(flatCoordinates[0]);\n    flatCoordinates.push(flatCoordinates[1]);\n  }\n  this.drawCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  if (holeFlatCoordinates.length) {\n    let i, ii;\n    for (i = 0, ii = holeFlatCoordinates.length; i < ii; ++i) {\n      if (!lineStringIsClosed(holeFlatCoordinates[i], 0, holeFlatCoordinates[i].length, stride)) {\n        holeFlatCoordinates[i].push(holeFlatCoordinates[i][0]);\n        holeFlatCoordinates[i].push(holeFlatCoordinates[i][1]);\n      }\n      this.drawCoordinates_(holeFlatCoordinates[i], 0,\n        holeFlatCoordinates[i].length, stride);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number=} opt_index Index count.\n */\nWebGLLineStringReplay.prototype.setPolygonStyle = function(feature, opt_index) {\n  const index = opt_index === undefined ? this.indices.length : opt_index;\n  this.startIndices.push(index);\n  this.startIndicesFeature.push(feature);\n  if (this.state_.changed) {\n    this.styleIndices_.push(index);\n    this.state_.changed = false;\n  }\n};\n\n\n/**\n * @return {number} Current index.\n */\nWebGLLineStringReplay.prototype.getCurrentIndex = function() {\n  return this.indices.length;\n};\n\n\n/**\n * @inheritDoc\n **/\nWebGLLineStringReplay.prototype.finish = function(context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  this.startIndices.push(this.indices.length);\n\n  //Clean up, if there is nothing to draw\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.getDeleteResourcesFunction = function(context) {\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  return function() {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_lastPos);\n  gl.vertexAttribPointer(locations.a_lastPos, 2, FLOAT,\n    false, 28, 0);\n\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 28, 8);\n\n  gl.enableVertexAttribArray(locations.a_nextPos);\n  gl.vertexAttribPointer(locations.a_nextPos, 2, FLOAT,\n    false, 28, 16);\n\n  gl.enableVertexAttribArray(locations.a_direction);\n  gl.vertexAttribPointer(locations.a_direction, 1, FLOAT,\n    false, 28, 24);\n\n  // Enable renderer specific uniforms.\n  gl.uniform2fv(locations.u_size, size);\n  gl.uniform1f(locations.u_pixelRatio, pixelRatio);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_lastPos);\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_nextPos);\n  gl.disableVertexAttribArray(locations.a_direction);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  //Save GL parameters.\n  const tmpDepthFunc = /** @type {number} */ (gl.getParameter(gl.DEPTH_FUNC));\n  const tmpDepthMask = /** @type {boolean} */ (gl.getParameter(gl.DEPTH_WRITEMASK));\n\n  if (!hitDetection) {\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthMask(true);\n    gl.depthFunc(gl.NOTEQUAL);\n  }\n\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    let i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setStrokeStyle_(gl, nextStyle[0], nextStyle[1], nextStyle[2]);\n      this.drawElements(gl, context, start, end);\n      gl.clear(gl.DEPTH_BUFFER_BIT);\n      end = start;\n    }\n  }\n  if (!hitDetection) {\n    gl.disable(gl.DEPTH_TEST);\n    gl.clear(gl.DEPTH_BUFFER_BIT);\n    //Restore GL parameters.\n    gl.depthMask(tmpDepthMask);\n    gl.depthFunc(tmpDepthFunc);\n  }\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\nWebGLLineStringReplay.prototype.drawReplaySkipping_ = function(gl, context, skippedFeaturesHash) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setStrokeStyle_(gl, nextStyle[0], nextStyle[1], nextStyle[2]);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n          gl.clear(gl.DEPTH_BUFFER_BIT);\n        }\n        end = featureStart;\n      }\n      featureIndex--;\n      start = featureStart;\n    }\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n      gl.clear(gl.DEPTH_BUFFER_BIT);\n    }\n    start = end = groupStart;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setStrokeStyle_(gl, nextStyle[0], nextStyle[1], nextStyle[2]);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n\n      }\n      featureIndex--;\n      end = start;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n * @param {number} lineWidth Line width.\n * @param {number} miterLimit Miter limit.\n */\nWebGLLineStringReplay.prototype.setStrokeStyle_ = function(gl, color, lineWidth, miterLimit) {\n  gl.uniform4fv(this.defaultLocations_.u_color, color);\n  gl.uniform1f(this.defaultLocations_.u_lineWidth, lineWidth);\n  gl.uniform1f(this.defaultLocations_.u_miterLimit, miterLimit);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  const strokeStyleLineCap = strokeStyle.getLineCap();\n  this.state_.lineCap = strokeStyleLineCap !== undefined ?\n    strokeStyleLineCap : DEFAULT_LINECAP;\n  const strokeStyleLineDash = strokeStyle.getLineDash();\n  this.state_.lineDash = strokeStyleLineDash ?\n    strokeStyleLineDash : DEFAULT_LINEDASH;\n  const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n  this.state_.lineDashOffset = strokeStyleLineDashOffset ?\n    strokeStyleLineDashOffset : DEFAULT_LINEDASHOFFSET;\n  const strokeStyleLineJoin = strokeStyle.getLineJoin();\n  this.state_.lineJoin = strokeStyleLineJoin !== undefined ?\n    strokeStyleLineJoin : DEFAULT_LINEJOIN;\n  let strokeStyleColor = strokeStyle.getColor();\n  if (!(strokeStyleColor instanceof CanvasGradient) &&\n      !(strokeStyleColor instanceof CanvasPattern)) {\n    strokeStyleColor = asArray(strokeStyleColor).map(function(c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || DEFAULT_STROKESTYLE;\n  } else {\n    strokeStyleColor = DEFAULT_STROKESTYLE;\n  }\n  let strokeStyleWidth = strokeStyle.getWidth();\n  strokeStyleWidth = strokeStyleWidth !== undefined ?\n    strokeStyleWidth : DEFAULT_LINEWIDTH;\n  let strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n  strokeStyleMiterLimit = strokeStyleMiterLimit !== undefined ?\n    strokeStyleMiterLimit : DEFAULT_MITERLIMIT;\n  if (!this.state_.strokeColor || !equals(this.state_.strokeColor, strokeStyleColor) ||\n      this.state_.lineWidth !== strokeStyleWidth || this.state_.miterLimit !== strokeStyleMiterLimit) {\n    this.state_.changed = true;\n    this.state_.strokeColor = strokeStyleColor;\n    this.state_.lineWidth = strokeStyleWidth;\n    this.state_.miterLimit = strokeStyleMiterLimit;\n    this.styles_.push([strokeStyleColor, strokeStyleWidth, strokeStyleMiterLimit]);\n  }\n};\n\nexport default WebGLLineStringReplay;\n","/**\n * @module ol/render/webgl/polygonreplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../index.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\n\\n\\n\\nuniform vec4 u_color;\\nuniform float u_opacity;\\n\\nvoid main(void) {\\n  gl_FragColor = u_color;\\n  float alpha = u_color.a * u_opacity;\\n  if (alpha == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor.a = alpha;\\n}\\n' :\n  'precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  '\\n\\nattribute vec2 a_position;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\n\\nvoid main(void) {\\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\\n}\\n\\n\\n' :\n  'attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}');\n","/**\n * @module ol/render/webgl/polygonreplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../../index.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'b');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'c');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'd');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_color = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_color' : 'e');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'a');\n};\n\nexport default Locations;\n","/**\n * @module ol/structs/LinkedList\n */\n\n\n/**\n * @typedef {Object} Item\n * @property {module:ol/structs/LinkedList~Item} [prev]\n * @property {module:ol/structs/LinkedList~Item} [next]\n * @property {?} data\n */\n\n\n/**\n * Creates an empty linked list structure.\n *\n * @constructor\n * @struct\n * @param {boolean=} opt_circular The last item is connected to the first one,\n * and the first item to the last one. Default is true.\n */\nconst LinkedList = function(opt_circular) {\n\n  /**\n   * @private\n   * @type {module:ol/structs/LinkedList~Item|undefined}\n   */\n  this.first_;\n\n  /**\n   * @private\n   * @type {module:ol/structs/LinkedList~Item|undefined}\n   */\n  this.last_;\n\n  /**\n   * @private\n   * @type {module:ol/structs/LinkedList~Item|undefined}\n   */\n  this.head_;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.circular_ = opt_circular === undefined ? true : opt_circular;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.length_ = 0;\n};\n\n/**\n * Inserts an item into the linked list right after the current one.\n *\n * @param {?} data Item data.\n */\nLinkedList.prototype.insertItem = function(data) {\n\n  /** @type {module:ol/structs/LinkedList~Item} */\n  const item = {\n    prev: undefined,\n    next: undefined,\n    data: data\n  };\n\n  const head = this.head_;\n\n  //Initialize the list.\n  if (!head) {\n    this.first_ = item;\n    this.last_ = item;\n    if (this.circular_) {\n      item.next = item;\n      item.prev = item;\n    }\n  } else {\n    //Link the new item to the adjacent ones.\n    const next = head.next;\n    item.prev = head;\n    item.next = next;\n    head.next = item;\n    if (next) {\n      next.prev = item;\n    }\n\n    if (head === this.last_) {\n      this.last_ = item;\n    }\n  }\n  this.head_ = item;\n  this.length_++;\n};\n\n/**\n * Removes the current item from the list. Sets the cursor to the next item,\n * if possible.\n */\nLinkedList.prototype.removeItem = function() {\n  const head = this.head_;\n  if (head) {\n    const next = head.next;\n    const prev = head.prev;\n    if (next) {\n      next.prev = prev;\n    }\n    if (prev) {\n      prev.next = next;\n    }\n    this.head_ = next || prev;\n\n    if (this.first_ === this.last_) {\n      this.head_ = undefined;\n      this.first_ = undefined;\n      this.last_ = undefined;\n    } else if (this.first_ === head) {\n      this.first_ = this.head_;\n    } else if (this.last_ === head) {\n      this.last_ = prev ? this.head_.prev : this.head_;\n    }\n    this.length_--;\n  }\n};\n\n/**\n * Sets the cursor to the first item, and returns the associated data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.firstItem = function() {\n  this.head_ = this.first_;\n  if (this.head_) {\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n* Sets the cursor to the last item, and returns the associated data.\n*\n* @return {?} Item data.\n*/\nLinkedList.prototype.lastItem = function() {\n  this.head_ = this.last_;\n  if (this.head_) {\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Sets the cursor to the next item, and returns the associated data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.nextItem = function() {\n  if (this.head_ && this.head_.next) {\n    this.head_ = this.head_.next;\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Returns the next item's data without moving the cursor.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.getNextItem = function() {\n  if (this.head_ && this.head_.next) {\n    return this.head_.next.data;\n  }\n  return undefined;\n};\n\n/**\n * Sets the cursor to the previous item, and returns the associated data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.prevItem = function() {\n  if (this.head_ && this.head_.prev) {\n    this.head_ = this.head_.prev;\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Returns the previous item's data without moving the cursor.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.getPrevItem = function() {\n  if (this.head_ && this.head_.prev) {\n    return this.head_.prev.data;\n  }\n  return undefined;\n};\n\n/**\n * Returns the current item's data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.getCurrItem = function() {\n  if (this.head_) {\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Sets the first item of the list. This only works for circular lists, and sets\n * the last item accordingly.\n */\nLinkedList.prototype.setFirstItem = function() {\n  if (this.circular_ && this.head_) {\n    this.first_ = this.head_;\n    this.last_ = this.head_.prev;\n  }\n};\n\n/**\n * Concatenates two lists.\n * @param {module:ol/structs/LinkedList} list List to merge into the current list.\n */\nLinkedList.prototype.concat = function(list) {\n  if (list.head_) {\n    if (this.head_) {\n      const end = this.head_.next;\n      this.head_.next = list.first_;\n      list.first_.prev = this.head_;\n      end.prev = list.last_;\n      list.last_.next = end;\n      this.length_ += list.length_;\n    } else {\n      this.head_ = list.head_;\n      this.first_ = list.first_;\n      this.last_ = list.last_;\n      this.length_ = list.length_;\n    }\n    list.head_ = undefined;\n    list.first_ = undefined;\n    list.last_ = undefined;\n    list.length_ = 0;\n  }\n};\n\n/**\n * Returns the current length of the list.\n *\n * @return {number} Length.\n */\nLinkedList.prototype.getLength = function() {\n  return this.length_;\n};\nexport default LinkedList;\n","/**\n * @module ol/render/webgl/PolygonReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {equals} from '../../array.js';\nimport {asArray} from '../../color.js';\nimport {intersects} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {linearRingContainsXY} from '../../geom/flat/contains.js';\nimport {linearRingIsClockwise} from '../../geom/flat/orient.js';\nimport {translate} from '../../geom/flat/transform.js';\nimport {fragment, vertex} from '../webgl/polygonreplay/defaultshader.js';\nimport Locations from '../webgl/polygonreplay/defaultshader/Locations.js';\nimport WebGLLineStringReplay from '../webgl/LineStringReplay.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {triangleIsCounterClockwise, EPSILON, DEFAULT_FILLSTYLE} from '../webgl.js';\nimport Stroke from '../../style/Stroke.js';\nimport LinkedList from '../../structs/LinkedList.js';\nimport RBush from '../../structs/RBush.js';\nimport {FLOAT} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n\n/**\n * @typedef {Object} PolygonVertex\n * @property {number} x\n * @property {number} y\n * @property {number} i\n * @property {boolean} [reflex]\n */\n\n/**\n * @typedef {Object} PolygonSegment\n * @property {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0\n * @property {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLPolygonReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  this.lineStringReplay = new WebGLLineStringReplay(\n    tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/polygonreplay/defaultshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n  /**\n   * @private\n   * @type {Array.<Array.<number>>}\n   */\n  this.styles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.styleIndices_ = [];\n\n  /**\n   * @private\n   * @type {{fillColor: (Array.<number>|null),\n   *         changed: boolean}|null}\n   */\n  this.state_ = {\n    fillColor: null,\n    changed: false\n  };\n\n};\n\ninherits(WebGLPolygonReplay, WebGLReplay);\n\n\n/**\n * Draw one polygon.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<Array.<number>>} holeFlatCoordinates Hole flat coordinates.\n * @param {number} stride Stride.\n * @private\n */\nWebGLPolygonReplay.prototype.drawCoordinates_ = function(\n  flatCoordinates, holeFlatCoordinates, stride) {\n  // Triangulate the polygon\n  const outerRing = new LinkedList();\n  const rtree = new RBush();\n  // Initialize the outer ring\n  this.processFlatCoordinates_(flatCoordinates, stride, outerRing, rtree, true);\n  const maxCoords = this.getMaxCoords_(outerRing);\n\n  // Eliminate holes, if there are any\n  if (holeFlatCoordinates.length) {\n    let i, ii;\n    const holeLists = [];\n    for (i = 0, ii = holeFlatCoordinates.length; i < ii; ++i) {\n      const holeList = {\n        list: new LinkedList(),\n        maxCoords: undefined,\n        rtree: new RBush()\n      };\n      holeLists.push(holeList);\n      this.processFlatCoordinates_(holeFlatCoordinates[i],\n        stride, holeList.list, holeList.rtree, false);\n      this.classifyPoints_(holeList.list, holeList.rtree, true);\n      holeList.maxCoords = this.getMaxCoords_(holeList.list);\n    }\n    holeLists.sort(function(a, b) {\n      return b.maxCoords[0] === a.maxCoords[0] ?\n        a.maxCoords[1] - b.maxCoords[1] : b.maxCoords[0] - a.maxCoords[0];\n    });\n    for (i = 0; i < holeLists.length; ++i) {\n      const currList = holeLists[i].list;\n      const start = currList.firstItem();\n      let currItem = start;\n      let intersection;\n      do {\n        //TODO: Triangulate holes when they intersect the outer ring.\n        if (this.getIntersections_(currItem, rtree).length) {\n          intersection = true;\n          break;\n        }\n        currItem = currList.nextItem();\n      } while (start !== currItem);\n      if (!intersection) {\n        if (this.bridgeHole_(currList, holeLists[i].maxCoords[0], outerRing, maxCoords[0], rtree)) {\n          rtree.concat(holeLists[i].rtree);\n          this.classifyPoints_(outerRing, rtree, false);\n        }\n      }\n    }\n  } else {\n    this.classifyPoints_(outerRing, rtree, false);\n  }\n  this.triangulate_(outerRing, rtree);\n};\n\n\n/**\n * Inserts flat coordinates in a linked list and adds them to the vertex buffer.\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} stride Stride.\n * @param {module:ol/structs/LinkedList} list Linked list.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean} clockwise Coordinate order should be clockwise.\n */\nWebGLPolygonReplay.prototype.processFlatCoordinates_ = function(\n  flatCoordinates, stride, list, rtree, clockwise) {\n  const isClockwise = linearRingIsClockwise(flatCoordinates,\n    0, flatCoordinates.length, stride);\n  let i, ii;\n  let n = this.vertices.length / 2;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let start;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let p0;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let p1;\n  const extents = [];\n  const segments = [];\n  if (clockwise === isClockwise) {\n    start = this.createPoint_(flatCoordinates[0], flatCoordinates[1], n++);\n    p0 = start;\n    for (i = stride, ii = flatCoordinates.length; i < ii; i += stride) {\n      p1 = this.createPoint_(flatCoordinates[i], flatCoordinates[i + 1], n++);\n      segments.push(this.insertItem_(p0, p1, list));\n      extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n        Math.max(p0.y, p1.y)]);\n      p0 = p1;\n    }\n    segments.push(this.insertItem_(p1, start, list));\n    extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n      Math.max(p0.y, p1.y)]);\n  } else {\n    const end = flatCoordinates.length - stride;\n    start = this.createPoint_(flatCoordinates[end], flatCoordinates[end + 1], n++);\n    p0 = start;\n    for (i = end - stride, ii = 0; i >= ii; i -= stride) {\n      p1 = this.createPoint_(flatCoordinates[i], flatCoordinates[i + 1], n++);\n      segments.push(this.insertItem_(p0, p1, list));\n      extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n        Math.max(p0.y, p1.y)]);\n      p0 = p1;\n    }\n    segments.push(this.insertItem_(p1, start, list));\n    extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n      Math.max(p0.y, p1.y)]);\n  }\n  rtree.load(extents, segments);\n};\n\n\n/**\n * Returns the rightmost coordinates of a polygon on the X axis.\n * @private\n * @param {module:ol/structs/LinkedList} list Polygons ring.\n * @return {Array.<number>} Max X coordinates.\n */\nWebGLPolygonReplay.prototype.getMaxCoords_ = function(list) {\n  const start = list.firstItem();\n  let seg = start;\n  let maxCoords = [seg.p0.x, seg.p0.y];\n\n  do {\n    seg = list.nextItem();\n    if (seg.p0.x > maxCoords[0]) {\n      maxCoords = [seg.p0.x, seg.p0.y];\n    }\n  } while (seg !== start);\n\n  return maxCoords;\n};\n\n\n/**\n * Classifies the points of a polygon list as convex, reflex. Removes collinear vertices.\n * @private\n * @param {module:ol/structs/LinkedList} list Polygon ring.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean} ccw The orientation of the polygon is counter-clockwise.\n * @return {boolean} There were reclassified points.\n */\nWebGLPolygonReplay.prototype.classifyPoints_ = function(list, rtree, ccw) {\n  let start = list.firstItem();\n  let s0 = start;\n  let s1 = list.nextItem();\n  let pointsReclassified = false;\n  do {\n    const reflex = ccw ? triangleIsCounterClockwise(s1.p1.x,\n      s1.p1.y, s0.p1.x, s0.p1.y, s0.p0.x, s0.p0.y) :\n      triangleIsCounterClockwise(s0.p0.x, s0.p0.y, s0.p1.x,\n        s0.p1.y, s1.p1.x, s1.p1.y);\n    if (reflex === undefined) {\n      this.removeItem_(s0, s1, list, rtree);\n      pointsReclassified = true;\n      if (s1 === start) {\n        start = list.getNextItem();\n      }\n      s1 = s0;\n      list.prevItem();\n    } else if (s0.p1.reflex !== reflex) {\n      s0.p1.reflex = reflex;\n      pointsReclassified = true;\n    }\n    s0 = s1;\n    s1 = list.nextItem();\n  } while (s0 !== start);\n  return pointsReclassified;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} hole Linked list of the hole.\n * @param {number} holeMaxX Maximum X value of the hole.\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {number} listMaxX Maximum X value of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @return {boolean} Bridging was successful.\n */\nWebGLPolygonReplay.prototype.bridgeHole_ = function(hole, holeMaxX,\n  list, listMaxX, rtree) {\n  let seg = hole.firstItem();\n  while (seg.p1.x !== holeMaxX) {\n    seg = hole.nextItem();\n  }\n\n  const p1 = seg.p1;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  const p2 = {x: listMaxX, y: p1.y, i: -1};\n  let minDist = Infinity;\n  let i, ii, bestPoint;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let p5;\n\n  const intersectingSegments = this.getIntersections_({p0: p1, p1: p2}, rtree, true);\n  for (i = 0, ii = intersectingSegments.length; i < ii; ++i) {\n    const currSeg = intersectingSegments[i];\n    const intersection = this.calculateIntersection_(p1, p2, currSeg.p0,\n      currSeg.p1, true);\n    const dist = Math.abs(p1.x - intersection[0]);\n    if (dist < minDist && triangleIsCounterClockwise(p1.x, p1.y,\n      currSeg.p0.x, currSeg.p0.y, currSeg.p1.x, currSeg.p1.y) !== undefined) {\n      minDist = dist;\n      p5 = {x: intersection[0], y: intersection[1], i: -1};\n      seg = currSeg;\n    }\n  }\n  if (minDist === Infinity) {\n    return false;\n  }\n  bestPoint = seg.p1;\n\n  if (minDist > 0) {\n    const pointsInTriangle = this.getPointsInTriangle_(p1, p5, seg.p1, rtree);\n    if (pointsInTriangle.length) {\n      let theta = Infinity;\n      for (i = 0, ii = pointsInTriangle.length; i < ii; ++i) {\n        const currPoint = pointsInTriangle[i];\n        const currTheta = Math.atan2(p1.y - currPoint.y, p2.x - currPoint.x);\n        if (currTheta < theta || (currTheta === theta && currPoint.x < bestPoint.x)) {\n          theta = currTheta;\n          bestPoint = currPoint;\n        }\n      }\n    }\n  }\n\n  seg = list.firstItem();\n  while (seg.p1.x !== bestPoint.x || seg.p1.y !== bestPoint.y) {\n    seg = list.nextItem();\n  }\n\n  //We clone the bridge points as they can have different convexity.\n  const p0Bridge = {x: p1.x, y: p1.y, i: p1.i, reflex: undefined};\n  const p1Bridge = {x: seg.p1.x, y: seg.p1.y, i: seg.p1.i, reflex: undefined};\n\n  hole.getNextItem().p0 = p0Bridge;\n  this.insertItem_(p1, seg.p1, hole, rtree);\n  this.insertItem_(p1Bridge, p0Bridge, hole, rtree);\n  seg.p1 = p1Bridge;\n  hole.setFirstItem();\n  list.concat(hole);\n\n  return true;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n */\nWebGLPolygonReplay.prototype.triangulate_ = function(list, rtree) {\n  let ccw = false;\n  let simple = this.isSimple_(list, rtree);\n\n  // Start clipping ears\n  while (list.getLength() > 3) {\n    if (simple) {\n      if (!this.clipEars_(list, rtree, simple, ccw)) {\n        if (!this.classifyPoints_(list, rtree, ccw)) {\n          // Due to the behavior of OL's PIP algorithm, the ear clipping cannot\n          // introduce touching segments. However, the original data may have some.\n          if (!this.resolveSelfIntersections_(list, rtree, true)) {\n            break;\n          }\n        }\n      }\n    } else {\n      if (!this.clipEars_(list, rtree, simple, ccw)) {\n        // We ran out of ears, try to reclassify.\n        if (!this.classifyPoints_(list, rtree, ccw)) {\n          // We have a bad polygon, try to resolve local self-intersections.\n          if (!this.resolveSelfIntersections_(list, rtree)) {\n            simple = this.isSimple_(list, rtree);\n            if (!simple) {\n              // We have a really bad polygon, try more time consuming methods.\n              this.splitPolygon_(list, rtree);\n              break;\n            } else {\n              ccw = !this.isClockwise_(list);\n              this.classifyPoints_(list, rtree, ccw);\n            }\n          }\n        }\n      }\n    }\n  }\n  if (list.getLength() === 3) {\n    let numIndices = this.indices.length;\n    this.indices[numIndices++] = list.getPrevItem().p0.i;\n    this.indices[numIndices++] = list.getCurrItem().p0.i;\n    this.indices[numIndices++] = list.getNextItem().p0.i;\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean} simple The polygon is simple.\n * @param {boolean} ccw Orientation of the polygon is counter-clockwise.\n * @return {boolean} There were processed ears.\n */\nWebGLPolygonReplay.prototype.clipEars_ = function(list, rtree, simple, ccw) {\n  let numIndices = this.indices.length;\n  let start = list.firstItem();\n  let s0 = list.getPrevItem();\n  let s1 = start;\n  let s2 = list.nextItem();\n  let s3 = list.getNextItem();\n  let p0, p1, p2;\n  let processedEars = false;\n  do {\n    p0 = s1.p0;\n    p1 = s1.p1;\n    p2 = s2.p1;\n    if (p1.reflex === false) {\n      // We might have a valid ear\n      let variableCriterion;\n      if (simple) {\n        variableCriterion = this.getPointsInTriangle_(p0, p1, p2, rtree, true).length === 0;\n      } else {\n        variableCriterion = ccw ? this.diagonalIsInside_(s3.p1, p2, p1, p0,\n          s0.p0) : this.diagonalIsInside_(s0.p0, p0, p1, p2, s3.p1);\n      }\n      if ((simple || this.getIntersections_({p0: p0, p1: p2}, rtree).length === 0) &&\n          variableCriterion) {\n        //The diagonal is completely inside the polygon\n        if (simple || p0.reflex === false || p2.reflex === false ||\n            linearRingIsClockwise([s0.p0.x, s0.p0.y, p0.x,\n              p0.y, p1.x, p1.y, p2.x, p2.y, s3.p1.x, s3.p1.y], 0, 10, 2) === !ccw) {\n          //The diagonal is persumably valid, we have an ear\n          this.indices[numIndices++] = p0.i;\n          this.indices[numIndices++] = p1.i;\n          this.indices[numIndices++] = p2.i;\n          this.removeItem_(s1, s2, list, rtree);\n          if (s2 === start) {\n            start = s3;\n          }\n          processedEars = true;\n        }\n      }\n    }\n    // Else we have a reflex point.\n    s0 = list.getPrevItem();\n    s1 = list.getCurrItem();\n    s2 = list.nextItem();\n    s3 = list.getNextItem();\n  } while (s1 !== start && list.getLength() > 3);\n\n  return processedEars;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean=} opt_touch Resolve touching segments.\n * @return {boolean} There were resolved intersections.\n*/\nWebGLPolygonReplay.prototype.resolveSelfIntersections_ = function(\n  list, rtree, opt_touch) {\n  const start = list.firstItem();\n  list.nextItem();\n  let s0 = start;\n  let s1 = list.nextItem();\n  let resolvedIntersections = false;\n\n  do {\n    const intersection = this.calculateIntersection_(s0.p0, s0.p1, s1.p0, s1.p1,\n      opt_touch);\n    if (intersection) {\n      let breakCond = false;\n      const numVertices = this.vertices.length;\n      let numIndices = this.indices.length;\n      const n = numVertices / 2;\n      const seg = list.prevItem();\n      list.removeItem();\n      rtree.remove(seg);\n      breakCond = (seg === start);\n      let p;\n      if (opt_touch) {\n        if (intersection[0] === s0.p0.x && intersection[1] === s0.p0.y) {\n          list.prevItem();\n          p = s0.p0;\n          s1.p0 = p;\n          rtree.remove(s0);\n          breakCond = breakCond || (s0 === start);\n        } else {\n          p = s1.p1;\n          s0.p1 = p;\n          rtree.remove(s1);\n          breakCond = breakCond || (s1 === start);\n        }\n        list.removeItem();\n      } else {\n        p = this.createPoint_(intersection[0], intersection[1], n);\n        s0.p1 = p;\n        s1.p0 = p;\n        rtree.update([Math.min(s0.p0.x, s0.p1.x), Math.min(s0.p0.y, s0.p1.y),\n          Math.max(s0.p0.x, s0.p1.x), Math.max(s0.p0.y, s0.p1.y)], s0);\n        rtree.update([Math.min(s1.p0.x, s1.p1.x), Math.min(s1.p0.y, s1.p1.y),\n          Math.max(s1.p0.x, s1.p1.x), Math.max(s1.p0.y, s1.p1.y)], s1);\n      }\n\n      this.indices[numIndices++] = seg.p0.i;\n      this.indices[numIndices++] = seg.p1.i;\n      this.indices[numIndices++] = p.i;\n\n      resolvedIntersections = true;\n      if (breakCond) {\n        break;\n      }\n    }\n\n    s0 = list.getPrevItem();\n    s1 = list.nextItem();\n  } while (s0 !== start);\n  return resolvedIntersections;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @return {boolean} The polygon is simple.\n */\nWebGLPolygonReplay.prototype.isSimple_ = function(list, rtree) {\n  const start = list.firstItem();\n  let seg = start;\n  do {\n    if (this.getIntersections_(seg, rtree).length) {\n      return false;\n    }\n    seg = list.nextItem();\n  } while (seg !== start);\n  return true;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @return {boolean} Orientation is clockwise.\n */\nWebGLPolygonReplay.prototype.isClockwise_ = function(list) {\n  const length = list.getLength() * 2;\n  const flatCoordinates = new Array(length);\n  const start = list.firstItem();\n  let seg = start;\n  let i = 0;\n  do {\n    flatCoordinates[i++] = seg.p0.x;\n    flatCoordinates[i++] = seg.p0.y;\n    seg = list.nextItem();\n  } while (seg !== start);\n  return linearRingIsClockwise(flatCoordinates, 0, length, 2);\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n */\nWebGLPolygonReplay.prototype.splitPolygon_ = function(list, rtree) {\n  const start = list.firstItem();\n  let s0 = start;\n  do {\n    const intersections = this.getIntersections_(s0, rtree);\n    if (intersections.length) {\n      const s1 = intersections[0];\n      const n = this.vertices.length / 2;\n      const intersection = this.calculateIntersection_(s0.p0,\n        s0.p1, s1.p0, s1.p1);\n      const p = this.createPoint_(intersection[0], intersection[1], n);\n      const newPolygon = new LinkedList();\n      const newRtree = new RBush();\n      this.insertItem_(p, s0.p1, newPolygon, newRtree);\n      s0.p1 = p;\n      rtree.update([Math.min(s0.p0.x, p.x), Math.min(s0.p0.y, p.y),\n        Math.max(s0.p0.x, p.x), Math.max(s0.p0.y, p.y)], s0);\n      let currItem = list.nextItem();\n      while (currItem !== s1) {\n        this.insertItem_(currItem.p0, currItem.p1, newPolygon, newRtree);\n        rtree.remove(currItem);\n        list.removeItem();\n        currItem = list.getCurrItem();\n      }\n      this.insertItem_(s1.p0, p, newPolygon, newRtree);\n      s1.p0 = p;\n      rtree.update([Math.min(s1.p1.x, p.x), Math.min(s1.p1.y, p.y),\n        Math.max(s1.p1.x, p.x), Math.max(s1.p1.y, p.y)], s1);\n      this.classifyPoints_(list, rtree, false);\n      this.triangulate_(list, rtree);\n      this.classifyPoints_(newPolygon, newRtree, false);\n      this.triangulate_(newPolygon, newRtree);\n      break;\n    }\n    s0 = list.nextItem();\n  } while (s0 !== start);\n};\n\n\n/**\n * @private\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @param {number} i Index.\n * @return {module:ol/render/webgl/PolygonReplay~PolygonVertex} List item.\n */\nWebGLPolygonReplay.prototype.createPoint_ = function(x, y, i) {\n  let numVertices = this.vertices.length;\n  this.vertices[numVertices++] = x;\n  this.vertices[numVertices++] = y;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  const p = {\n    x: x,\n    y: y,\n    i: i,\n    reflex: undefined\n  };\n  return p;\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 First point of segment.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Second point of segment.\n * @param {module:ol/structs/LinkedList} list Polygon ring.\n * @param {module:ol/structs/RBush=} opt_rtree Insert the segment into the R-Tree.\n * @return {module:ol/render/webgl/PolygonReplay~PolygonSegment} segment.\n */\nWebGLPolygonReplay.prototype.insertItem_ = function(p0, p1, list, opt_rtree) {\n  const seg = {\n    p0: p0,\n    p1: p1\n  };\n  list.insertItem(seg);\n  if (opt_rtree) {\n    opt_rtree.insert([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y),\n      Math.max(p0.x, p1.x), Math.max(p0.y, p1.y)], seg);\n  }\n  return seg;\n};\n\n\n/**\n  * @private\n  * @param {module:ol/render/webgl/PolygonReplay~PolygonSegment} s0 Segment before the remove candidate.\n  * @param {module:ol/render/webgl/PolygonReplay~PolygonSegment} s1 Remove candidate segment.\n  * @param {module:ol/structs/LinkedList} list Polygon ring.\n  * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n  */\nWebGLPolygonReplay.prototype.removeItem_ = function(s0, s1, list, rtree) {\n  if (list.getCurrItem() === s1) {\n    list.removeItem();\n    s0.p1 = s1.p1;\n    rtree.remove(s1);\n    rtree.update([Math.min(s0.p0.x, s0.p1.x), Math.min(s0.p0.y, s0.p1.y),\n      Math.max(s0.p0.x, s0.p1.x), Math.max(s0.p0.y, s0.p1.y)], s0);\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 First point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Second point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p2 Third point.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean=} opt_reflex Only include reflex points.\n * @return {Array.<module:ol/render/webgl/PolygonReplay~PolygonVertex>} Points in the triangle.\n */\nWebGLPolygonReplay.prototype.getPointsInTriangle_ = function(p0, p1, p2, rtree, opt_reflex) {\n  const result = [];\n  const segmentsInExtent = rtree.getInExtent([Math.min(p0.x, p1.x, p2.x),\n    Math.min(p0.y, p1.y, p2.y), Math.max(p0.x, p1.x, p2.x), Math.max(p0.y,\n      p1.y, p2.y)]);\n  for (let i = 0, ii = segmentsInExtent.length; i < ii; ++i) {\n    for (const j in segmentsInExtent[i]) {\n      const p = segmentsInExtent[i][j];\n      if (typeof p === 'object' && (!opt_reflex || p.reflex)) {\n        if ((p.x !== p0.x || p.y !== p0.y) && (p.x !== p1.x || p.y !== p1.y) &&\n            (p.x !== p2.x || p.y !== p2.y) && result.indexOf(p) === -1 &&\n            linearRingContainsXY([p0.x, p0.y, p1.x, p1.y, p2.x, p2.y], 0, 6, 2, p.x, p.y)) {\n          result.push(p);\n        }\n      }\n    }\n  }\n  return result;\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonSegment} segment Segment.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean=} opt_touch Touching segments should be considered an intersection.\n * @return {Array.<module:ol/render/webgl/PolygonReplay~PolygonSegment>} Intersecting segments.\n */\nWebGLPolygonReplay.prototype.getIntersections_ = function(segment, rtree, opt_touch) {\n  const p0 = segment.p0;\n  const p1 = segment.p1;\n  const segmentsInExtent = rtree.getInExtent([Math.min(p0.x, p1.x),\n    Math.min(p0.y, p1.y), Math.max(p0.x, p1.x), Math.max(p0.y, p1.y)]);\n  const result = [];\n  for (let i = 0, ii = segmentsInExtent.length; i < ii; ++i) {\n    const currSeg = segmentsInExtent[i];\n    if (segment !== currSeg && (opt_touch || currSeg.p0 !== p1 || currSeg.p1 !== p0) &&\n        this.calculateIntersection_(p0, p1, currSeg.p0, currSeg.p1, opt_touch)) {\n      result.push(currSeg);\n    }\n  }\n  return result;\n};\n\n\n/**\n * Line intersection algorithm by Paul Bourke.\n * @see http://paulbourke.net/geometry/pointlineplane/\n *\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 First point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Second point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p2 Third point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p3 Fourth point.\n * @param {boolean=} opt_touch Touching segments should be considered an intersection.\n * @return {Array.<number>|undefined} Intersection coordinates.\n */\nWebGLPolygonReplay.prototype.calculateIntersection_ = function(p0, p1, p2, p3, opt_touch) {\n  const denom = (p3.y - p2.y) * (p1.x - p0.x) - (p3.x - p2.x) * (p1.y - p0.y);\n  if (denom !== 0) {\n    const ua = ((p3.x - p2.x) * (p0.y - p2.y) - (p3.y - p2.y) * (p0.x - p2.x)) / denom;\n    const ub = ((p1.x - p0.x) * (p0.y - p2.y) - (p1.y - p0.y) * (p0.x - p2.x)) / denom;\n    if ((!opt_touch && ua > EPSILON && ua < 1 - EPSILON &&\n        ub > EPSILON && ub < 1 - EPSILON) || (opt_touch &&\n        ua >= 0 && ua <= 1 && ub >= 0 && ub <= 1)) {\n      return [p0.x + ua * (p1.x - p0.x), p0.y + ua * (p1.y - p0.y)];\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 Point before the start of the diagonal.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Start point of the diagonal.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p2 Ear candidate.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p3 End point of the diagonal.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p4 Point after the end of the diagonal.\n * @return {boolean} Diagonal is inside the polygon.\n */\nWebGLPolygonReplay.prototype.diagonalIsInside_ = function(p0, p1, p2, p3, p4) {\n  if (p1.reflex === undefined || p3.reflex === undefined) {\n    return false;\n  }\n  const p1IsLeftOf = (p2.x - p3.x) * (p1.y - p3.y) > (p2.y - p3.y) * (p1.x - p3.x);\n  const p1IsRightOf = (p4.x - p3.x) * (p1.y - p3.y) < (p4.y - p3.y) * (p1.x - p3.x);\n  const p3IsLeftOf = (p0.x - p1.x) * (p3.y - p1.y) > (p0.y - p1.y) * (p3.x - p1.x);\n  const p3IsRightOf = (p2.x - p1.x) * (p3.y - p1.y) < (p2.y - p1.y) * (p3.x - p1.x);\n  const p1InCone = p3.reflex ? p1IsRightOf || p1IsLeftOf : p1IsRightOf && p1IsLeftOf;\n  const p3InCone = p1.reflex ? p3IsRightOf || p3IsLeftOf : p3IsRightOf && p3IsLeftOf;\n  return p1InCone && p3InCone;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {\n  const endss = multiPolygonGeometry.getEndss();\n  const stride = multiPolygonGeometry.getStride();\n  const currIndex = this.indices.length;\n  const currLineIndex = this.lineStringReplay.getCurrentIndex();\n  const flatCoordinates = multiPolygonGeometry.getFlatCoordinates();\n  let i, ii, j, jj;\n  let start = 0;\n  for (i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (ends.length > 0) {\n      const outerRing = translate(flatCoordinates, start, ends[0],\n        stride, -this.origin[0], -this.origin[1]);\n      if (outerRing.length) {\n        const holes = [];\n        let holeFlatCoords;\n        for (j = 1, jj = ends.length; j < jj; ++j) {\n          if (ends[j] !== ends[j - 1]) {\n            holeFlatCoords = translate(flatCoordinates, ends[j - 1],\n              ends[j], stride, -this.origin[0], -this.origin[1]);\n            holes.push(holeFlatCoords);\n          }\n        }\n        this.lineStringReplay.drawPolygonCoordinates(outerRing, holes, stride);\n        this.drawCoordinates_(outerRing, holes, stride);\n      }\n    }\n    start = ends[ends.length - 1];\n  }\n  if (this.indices.length > currIndex) {\n    this.startIndices.push(currIndex);\n    this.startIndicesFeature.push(feature);\n    if (this.state_.changed) {\n      this.styleIndices_.push(currIndex);\n      this.state_.changed = false;\n    }\n  }\n  if (this.lineStringReplay.getCurrentIndex() > currLineIndex) {\n    this.lineStringReplay.setPolygonStyle(feature, currLineIndex);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawPolygon = function(polygonGeometry, feature) {\n  const ends = polygonGeometry.getEnds();\n  const stride = polygonGeometry.getStride();\n  if (ends.length > 0) {\n    const flatCoordinates = polygonGeometry.getFlatCoordinates().map(Number);\n    const outerRing = translate(flatCoordinates, 0, ends[0],\n      stride, -this.origin[0], -this.origin[1]);\n    if (outerRing.length) {\n      const holes = [];\n      let i, ii, holeFlatCoords;\n      for (i = 1, ii = ends.length; i < ii; ++i) {\n        if (ends[i] !== ends[i - 1]) {\n          holeFlatCoords = translate(flatCoordinates, ends[i - 1],\n            ends[i], stride, -this.origin[0], -this.origin[1]);\n          holes.push(holeFlatCoords);\n        }\n      }\n\n      this.startIndices.push(this.indices.length);\n      this.startIndicesFeature.push(feature);\n      if (this.state_.changed) {\n        this.styleIndices_.push(this.indices.length);\n        this.state_.changed = false;\n      }\n      this.lineStringReplay.setPolygonStyle(feature);\n\n      this.lineStringReplay.drawPolygonCoordinates(outerRing, holes, stride);\n      this.drawCoordinates_(outerRing, holes, stride);\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n **/\nWebGLPolygonReplay.prototype.finish = function(context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  this.startIndices.push(this.indices.length);\n\n  this.lineStringReplay.finish(context);\n\n  //Clean up, if there is nothing to draw\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.getDeleteResourcesFunction = function(context) {\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  const lineDeleter = this.lineStringReplay.getDeleteResourcesFunction(context);\n  return function() {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n    lineDeleter();\n  };\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 8, 0);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  //Save GL parameters.\n  const tmpDepthFunc = /** @type {number} */ (gl.getParameter(gl.DEPTH_FUNC));\n  const tmpDepthMask = /** @type {boolean} */ (gl.getParameter(gl.DEPTH_WRITEMASK));\n\n  if (!hitDetection) {\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthMask(true);\n    gl.depthFunc(gl.NOTEQUAL);\n  }\n\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    let i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl, nextStyle);\n      this.drawElements(gl, context, start, end);\n      end = start;\n    }\n  }\n  if (!hitDetection) {\n    gl.disable(gl.DEPTH_TEST);\n    gl.clear(gl.DEPTH_BUFFER_BIT);\n    //Restore GL parameters.\n    gl.depthMask(tmpDepthMask);\n    gl.depthFunc(tmpDepthFunc);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, nextStyle);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n\n      }\n      featureIndex--;\n      end = start;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\nWebGLPolygonReplay.prototype.drawReplaySkipping_ = function(gl, context, skippedFeaturesHash) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, nextStyle);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n          gl.clear(gl.DEPTH_BUFFER_BIT);\n        }\n        end = featureStart;\n      }\n      featureIndex--;\n      start = featureStart;\n    }\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n      gl.clear(gl.DEPTH_BUFFER_BIT);\n    }\n    start = end = groupStart;\n  }\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n */\nWebGLPolygonReplay.prototype.setFillStyle_ = function(gl, color) {\n  gl.uniform4fv(this.defaultLocations_.u_color, color);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  let fillStyleColor = fillStyle ? fillStyle.getColor() : [0, 0, 0, 0];\n  if (!(fillStyleColor instanceof CanvasGradient) &&\n      !(fillStyleColor instanceof CanvasPattern)) {\n    fillStyleColor = asArray(fillStyleColor).map(function(c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || DEFAULT_FILLSTYLE;\n  } else {\n    fillStyleColor = DEFAULT_FILLSTYLE;\n  }\n  if (!this.state_.fillColor || !equals(fillStyleColor, this.state_.fillColor)) {\n    this.state_.fillColor = fillStyleColor;\n    this.state_.changed = true;\n    this.styles_.push(fillStyleColor);\n  }\n  //Provide a null stroke style, if no strokeStyle is provided. Required for the draw interaction to work.\n  if (strokeStyle) {\n    this.lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n  } else {\n    const nullStrokeStyle = new Stroke({\n      color: [0, 0, 0, 0],\n      lineWidth: 0\n    });\n    this.lineStringReplay.setFillStrokeStyle(null, nullStrokeStyle);\n  }\n};\nexport default WebGLPolygonReplay;\n","/**\n * @module ol/style/Atlas\n */\nimport {createCanvasContext2D} from '../dom.js';\n\n\n/**\n * @typedef {Object} AtlasBlock\n * @property {number} x\n * @property {number} y\n * @property {number} width\n * @property {number} height\n */\n\n/**\n * Provides information for an image inside an atlas.\n * `offsetX` and `offsetY` are the position of the image inside the atlas image `image`.\n * @typedef {Object} AtlasInfo\n * @property {number} offsetX\n * @property {number} offsetY\n * @property {HTMLCanvasElement} image\n */\n\n/**\n * This class facilitates the creation of image atlases.\n *\n * Images added to an atlas will be rendered onto a single\n * atlas canvas. The distribution of images on the canvas is\n * managed with the bin packing algorithm described in:\n * http://www.blackpawn.com/texts/lightmaps/\n *\n * @constructor\n * @struct\n * @param {number} size The size in pixels of the sprite image.\n * @param {number} space The space in pixels between images.\n *    Because texture coordinates are float values, the edges of\n *    images might not be completely correct (in a way that the\n *    edges overlap when being rendered). To avoid this we add a\n *    padding around each image.\n */\nconst Atlas = function(size, space) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.space_ = space;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/style/Atlas~AtlasBlock>}\n   */\n  this.emptyBlocks_ = [{x: 0, y: 0, width: size, height: size}];\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/style/Atlas~AtlasInfo>}\n   */\n  this.entries_ = {};\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = createCanvasContext2D(size, size);\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = this.context_.canvas;\n};\n\n\n/**\n * @param {string} id The identifier of the entry to check.\n * @return {?module:ol/style/Atlas~AtlasInfo} The atlas info.\n */\nAtlas.prototype.get = function(id) {\n  return this.entries_[id] || null;\n};\n\n\n/**\n * @param {string} id The identifier of the entry to add.\n * @param {number} width The width.\n * @param {number} height The height.\n * @param {function(CanvasRenderingContext2D, number, number)} renderCallback\n *    Called to render the new image onto an atlas image.\n * @param {Object=} opt_this Value to use as `this` when executing\n *    `renderCallback`.\n * @return {?module:ol/style/Atlas~AtlasInfo} The position and atlas image for the entry.\n */\nAtlas.prototype.add = function(id, width, height, renderCallback, opt_this) {\n  for (let i = 0, ii = this.emptyBlocks_.length; i < ii; ++i) {\n    const block = this.emptyBlocks_[i];\n    if (block.width >= width + this.space_ &&\n        block.height >= height + this.space_) {\n      // we found a block that is big enough for our entry\n      const entry = {\n        offsetX: block.x + this.space_,\n        offsetY: block.y + this.space_,\n        image: this.canvas_\n      };\n      this.entries_[id] = entry;\n\n      // render the image on the atlas image\n      renderCallback.call(opt_this, this.context_,\n        block.x + this.space_, block.y + this.space_);\n\n      // split the block after the insertion, either horizontally or vertically\n      this.split_(i, block, width + this.space_, height + this.space_);\n\n      return entry;\n    }\n  }\n\n  // there is no space for the new entry in this atlas\n  return null;\n};\n\n\n/**\n * @private\n * @param {number} index The index of the block.\n * @param {module:ol/style/Atlas~AtlasBlock} block The block to split.\n * @param {number} width The width of the entry to insert.\n * @param {number} height The height of the entry to insert.\n */\nAtlas.prototype.split_ = function(index, block, width, height) {\n  const deltaWidth = block.width - width;\n  const deltaHeight = block.height - height;\n\n  /** @type {module:ol/style/Atlas~AtlasBlock} */\n  let newBlock1;\n  /** @type {module:ol/style/Atlas~AtlasBlock} */\n  let newBlock2;\n\n  if (deltaWidth > deltaHeight) {\n    // split vertically\n    // block right of the inserted entry\n    newBlock1 = {\n      x: block.x + width,\n      y: block.y,\n      width: block.width - width,\n      height: block.height\n    };\n\n    // block below the inserted entry\n    newBlock2 = {\n      x: block.x,\n      y: block.y + height,\n      width: width,\n      height: block.height - height\n    };\n    this.updateBlocks_(index, newBlock1, newBlock2);\n  } else {\n    // split horizontally\n    // block right of the inserted entry\n    newBlock1 = {\n      x: block.x + width,\n      y: block.y,\n      width: block.width - width,\n      height: height\n    };\n\n    // block below the inserted entry\n    newBlock2 = {\n      x: block.x,\n      y: block.y + height,\n      width: block.width,\n      height: block.height - height\n    };\n    this.updateBlocks_(index, newBlock1, newBlock2);\n  }\n};\n\n\n/**\n * Remove the old block and insert new blocks at the same array position.\n * The new blocks are inserted at the same position, so that splitted\n * blocks (that are potentially smaller) are filled first.\n * @private\n * @param {number} index The index of the block to remove.\n * @param {module:ol/style/Atlas~AtlasBlock} newBlock1 The 1st block to add.\n * @param {module:ol/style/Atlas~AtlasBlock} newBlock2 The 2nd block to add.\n */\nAtlas.prototype.updateBlocks_ = function(index, newBlock1, newBlock2) {\n  const args = [index, 1];\n  if (newBlock1.width > 0 && newBlock1.height > 0) {\n    args.push(newBlock1);\n  }\n  if (newBlock2.width > 0 && newBlock2.height > 0) {\n    args.push(newBlock2);\n  }\n  this.emptyBlocks_.splice.apply(this.emptyBlocks_, args);\n};\nexport default Atlas;\n","/**\n * @module ol/style/AtlasManager\n */\nimport {WEBGL_MAX_TEXTURE_SIZE} from '../index.js';\nimport {UNDEFINED} from '../functions.js';\nimport Atlas from '../style/Atlas.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [initialSize=256] The size in pixels of the first atlas image.\n * @property {number} [maxSize] The maximum size in pixels of atlas images. Default is\n * `WEBGL_MAX_TEXTURE_SIZE` or 2048 if WebGL is not supported.\n * @property {number} [space=1] The space in pixels between images.\n */\n\n\n/**\n * Provides information for an image inside an atlas manager.\n * `offsetX` and `offsetY` is the position of the image inside\n * the atlas image `image` and the position of the hit-detection image\n * inside the hit-detection atlas image `hitImage`.\n * @typedef {Object} AtlasManagerInfo\n * @property {number} offsetX\n * @property {number} offsetY\n * @property {HTMLCanvasElement} image\n * @property {HTMLCanvasElement} hitImage\n */\n\n\n/**\n * The size in pixels of the first atlas image.\n * @type {number}\n */\nconst INITIAL_ATLAS_SIZE = 256;\n\n/**\n * The maximum size in pixels of atlas images.\n * @type {number}\n */\nconst MAX_ATLAS_SIZE = -1;\n\n\n/**\n * Manages the creation of image atlases.\n *\n * Images added to this manager will be inserted into an atlas, which\n * will be used for rendering.\n * The `size` given in the constructor is the size for the first\n * atlas. After that, when new atlases are created, they will have\n * twice the size as the latest atlas (until `maxSize` is reached).\n *\n * If an application uses many images or very large images, it is recommended\n * to set a higher `size` value to avoid the creation of too many atlases.\n *\n * @constructor\n * @struct\n * @api\n * @param {module:ol/style/AtlasManager~Options=} opt_options Options.\n */\nconst AtlasManager = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * The size in pixels of the latest atlas image.\n   * @private\n   * @type {number}\n   */\n  this.currentSize_ = options.initialSize !== undefined ?\n    options.initialSize : INITIAL_ATLAS_SIZE;\n\n  /**\n   * The maximum size in pixels of atlas images.\n   * @private\n   * @type {number}\n   */\n  this.maxSize_ = options.maxSize !== undefined ?\n    options.maxSize : MAX_ATLAS_SIZE != -1 ?\n      MAX_ATLAS_SIZE : WEBGL_MAX_TEXTURE_SIZE !== undefined ?\n        WEBGL_MAX_TEXTURE_SIZE : 2048;\n\n  /**\n   * The size in pixels between images.\n   * @private\n   * @type {number}\n   */\n  this.space_ = options.space !== undefined ? options.space : 1;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/style/Atlas>}\n   */\n  this.atlases_ = [new Atlas(this.currentSize_, this.space_)];\n\n  /**\n   * The size in pixels of the latest atlas image for hit-detection images.\n   * @private\n   * @type {number}\n   */\n  this.currentHitSize_ = this.currentSize_;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/style/Atlas>}\n   */\n  this.hitAtlases_ = [new Atlas(this.currentHitSize_, this.space_)];\n};\n\n\n/**\n * @param {string} id The identifier of the entry to check.\n * @return {?module:ol/style/AtlasManager~AtlasManagerInfo} The position and atlas image for the\n *    entry, or `null` if the entry is not part of the atlas manager.\n */\nAtlasManager.prototype.getInfo = function(id) {\n  /** @type {?module:ol/style/Atlas~AtlasInfo} */\n  const info = this.getInfo_(this.atlases_, id);\n\n  if (!info) {\n    return null;\n  }\n  const hitInfo = /** @type {module:ol/style/Atlas~AtlasInfo} */ (this.getInfo_(this.hitAtlases_, id));\n\n  return this.mergeInfos_(info, hitInfo);\n};\n\n\n/**\n * @private\n * @param {Array.<module:ol/style/Atlas>} atlases The atlases to search.\n * @param {string} id The identifier of the entry to check.\n * @return {?module:ol/style/Atlas~AtlasInfo} The position and atlas image for the entry,\n *    or `null` if the entry is not part of the atlases.\n */\nAtlasManager.prototype.getInfo_ = function(atlases, id) {\n  for (let i = 0, ii = atlases.length; i < ii; ++i) {\n    const atlas = atlases[i];\n    const info = atlas.get(id);\n    if (info) {\n      return info;\n    }\n  }\n  return null;\n};\n\n\n/**\n * @private\n * @param {module:ol/style/Atlas~AtlasInfo} info The info for the real image.\n * @param {module:ol/style/Atlas~AtlasInfo} hitInfo The info for the hit-detection\n *    image.\n * @return {?module:ol/style/AtlasManager~AtlasManagerInfo} The position and atlas image for the\n *    entry, or `null` if the entry is not part of the atlases.\n */\nAtlasManager.prototype.mergeInfos_ = function(info, hitInfo) {\n  return (\n    /** @type {module:ol/style/AtlasManager~AtlasManagerInfo} */ ({\n      offsetX: info.offsetX,\n      offsetY: info.offsetY,\n      image: info.image,\n      hitImage: hitInfo.image\n    })\n  );\n};\n\n\n/**\n * Add an image to the atlas manager.\n *\n * If an entry for the given id already exists, the entry will\n * be overridden (but the space on the atlas graphic will not be freed).\n *\n * If `renderHitCallback` is provided, the image (or the hit-detection version\n * of the image) will be rendered into a separate hit-detection atlas image.\n *\n * @param {string} id The identifier of the entry to add.\n * @param {number} width The width.\n * @param {number} height The height.\n * @param {function(CanvasRenderingContext2D, number, number)} renderCallback\n *    Called to render the new image onto an atlas image.\n * @param {function(CanvasRenderingContext2D, number, number)=}\n *    opt_renderHitCallback Called to render a hit-detection image onto a hit\n *    detection atlas image.\n * @param {Object=} opt_this Value to use as `this` when executing\n *    `renderCallback` and `renderHitCallback`.\n * @return {?module:ol/style/AtlasManager~AtlasManagerInfo}  The position and atlas image for the\n *    entry, or `null` if the image is too big.\n */\nAtlasManager.prototype.add = function(id, width, height,\n  renderCallback, opt_renderHitCallback, opt_this) {\n  if (width + this.space_ > this.maxSize_ ||\n      height + this.space_ > this.maxSize_) {\n    return null;\n  }\n\n  /** @type {?module:ol/style/Atlas~AtlasInfo} */\n  const info = this.add_(false, id, width, height, renderCallback, opt_this);\n  if (!info) {\n    return null;\n  }\n\n  // even if no hit-detection entry is requested, we insert a fake entry into\n  // the hit-detection atlas, to make sure that the offset is the same for\n  // the original image and the hit-detection image.\n  const renderHitCallback = opt_renderHitCallback !== undefined ?\n    opt_renderHitCallback : UNDEFINED;\n\n  const hitInfo = /** @type {module:ol/style/Atlas~AtlasInfo} */ (this.add_(true,\n    id, width, height, renderHitCallback, opt_this));\n\n  return this.mergeInfos_(info, hitInfo);\n};\n\n\n/**\n * @private\n * @param {boolean} isHitAtlas If the hit-detection atlases are used.\n * @param {string} id The identifier of the entry to add.\n * @param {number} width The width.\n * @param {number} height The height.\n * @param {function(CanvasRenderingContext2D, number, number)} renderCallback\n *    Called to render the new image onto an atlas image.\n * @param {Object=} opt_this Value to use as `this` when executing\n *    `renderCallback` and `renderHitCallback`.\n * @return {?module:ol/style/Atlas~AtlasInfo}  The position and atlas image for the entry,\n *    or `null` if the image is too big.\n */\nAtlasManager.prototype.add_ = function(isHitAtlas, id, width, height, renderCallback, opt_this) {\n  const atlases = (isHitAtlas) ? this.hitAtlases_ : this.atlases_;\n  let atlas, info, i, ii;\n  for (i = 0, ii = atlases.length; i < ii; ++i) {\n    atlas = atlases[i];\n    info = atlas.add(id, width, height, renderCallback, opt_this);\n    if (info) {\n      return info;\n    } else if (!info && i === ii - 1) {\n      // the entry could not be added to one of the existing atlases,\n      // create a new atlas that is twice as big and try to add to this one.\n      let size;\n      if (isHitAtlas) {\n        size = Math.min(this.currentHitSize_ * 2, this.maxSize_);\n        this.currentHitSize_ = size;\n      } else {\n        size = Math.min(this.currentSize_ * 2, this.maxSize_);\n        this.currentSize_ = size;\n      }\n      atlas = new Atlas(size, this.space_);\n      atlases.push(atlas);\n      // run the loop another time\n      ++ii;\n    }\n  }\n  return null;\n};\nexport default AtlasManager;\n","/**\n * @module ol/render/webgl/TextReplay\n */\nimport {getUid, inherits} from '../../index.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport {DEFAULT_FILLSTYLE, DEFAULT_FONT, DEFAULT_LINECAP, DEFAULT_LINEDASH,\n  DEFAULT_LINEDASHOFFSET, DEFAULT_LINEJOIN, DEFAULT_LINEWIDTH, DEFAULT_MITERLIMIT,\n  DEFAULT_STROKESTYLE, DEFAULT_TEXTALIGN, DEFAULT_TEXTBASELINE} from '../webgl.js';\nimport WebGLTextureReplay from '../webgl/TextureReplay.js';\nimport AtlasManager from '../../style/AtlasManager.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @typedef {Object} GlyphAtlas\n * @property {module:ol/style/AtlasManager} atlas\n * @property {Object.<string, number>} width\n * @property {number} height\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/TextureReplay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLTextReplay = function(tolerance, maxExtent) {\n  WebGLTextureReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {Array.<HTMLCanvasElement>}\n   */\n  this.images_ = [];\n\n  /**\n   * @private\n   * @type {Array.<WebGLTexture>}\n   */\n  this.textures_ = [];\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.measureCanvas_ = createCanvasContext2D(0, 0).canvas;\n\n  /**\n   * @private\n   * @type {{strokeColor: (module:ol/colorlike~ColorLike|null),\n   *         lineCap: (string|undefined),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineJoin: (string|undefined),\n   *         lineWidth: number,\n   *         miterLimit: (number|undefined),\n   *         fillColor: (module:ol/colorlike~ColorLike|null),\n   *         font: (string|undefined),\n   *         scale: (number|undefined)}}\n   */\n  this.state_ = {\n    strokeColor: null,\n    lineCap: undefined,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineJoin: undefined,\n    lineWidth: 0,\n    miterLimit: undefined,\n    fillColor: null,\n    font: undefined,\n    scale: undefined\n  };\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.textAlign_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.textBaseline_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.offsetX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.offsetY_ = undefined;\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/render/webgl/TextReplay~GlyphAtlas>}\n   */\n  this.atlases_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/TextReplay~GlyphAtlas|undefined}\n   */\n  this.currAtlas_ = undefined;\n\n  this.scale = 1;\n\n  this.opacity = 1;\n\n};\n\ninherits(WebGLTextReplay, WebGLTextureReplay);\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.drawText = function(geometry, feature) {\n  if (this.text_) {\n    let flatCoordinates = null;\n    const offset = 0;\n    let end = 2;\n    let stride = 2;\n    switch (geometry.getType()) {\n      case GeometryType.POINT:\n      case GeometryType.MULTI_POINT:\n        flatCoordinates = geometry.getFlatCoordinates();\n        end = flatCoordinates.length;\n        stride = geometry.getStride();\n        break;\n      case GeometryType.CIRCLE:\n        flatCoordinates = /** @type {module:ol/geom/Circle} */ (geometry).getCenter();\n        break;\n      case GeometryType.LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/LineString} */ (geometry).getFlatMidpoint();\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/MultiLineString} */ (geometry).getFlatMidpoints();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.POLYGON:\n        flatCoordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getFlatInteriorPoint();\n        break;\n      case GeometryType.MULTI_POLYGON:\n        flatCoordinates = /** @type {module:ol/geom/MultiPolygon} */ (geometry).getFlatInteriorPoints();\n        end = flatCoordinates.length;\n        break;\n      default:\n    }\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n\n    const glyphAtlas = this.currAtlas_;\n    const lines = this.text_.split('\\n');\n    const textSize = this.getTextSize_(lines);\n    let i, ii, j, jj, currX, currY, charArr, charInfo;\n    const anchorX = Math.round(textSize[0] * this.textAlign_ - this.offsetX_);\n    const anchorY = Math.round(textSize[1] * this.textBaseline_ - this.offsetY_);\n    const lineWidth = (this.state_.lineWidth / 2) * this.state_.scale;\n\n    for (i = 0, ii = lines.length; i < ii; ++i) {\n      currX = 0;\n      currY = glyphAtlas.height * i;\n      charArr = lines[i].split('');\n\n      for (j = 0, jj = charArr.length; j < jj; ++j) {\n        charInfo = glyphAtlas.atlas.getInfo(charArr[j]);\n\n        if (charInfo) {\n          const image = charInfo.image;\n\n          this.anchorX = anchorX - currX;\n          this.anchorY = anchorY - currY;\n          this.originX = j === 0 ? charInfo.offsetX - lineWidth : charInfo.offsetX;\n          this.originY = charInfo.offsetY;\n          this.height = glyphAtlas.height;\n          this.width = j === 0 || j === charArr.length - 1 ?\n            glyphAtlas.width[charArr[j]] + lineWidth : glyphAtlas.width[charArr[j]];\n          this.imageHeight = image.height;\n          this.imageWidth = image.width;\n\n          if (this.images_.length === 0) {\n            this.images_.push(image);\n          } else {\n            const currentImage = this.images_[this.images_.length - 1];\n            if (getUid(currentImage) != getUid(image)) {\n              this.groupIndices.push(this.indices.length);\n              this.images_.push(image);\n            }\n          }\n\n          this.drawText_(flatCoordinates, offset, end, stride);\n        }\n        currX += this.width;\n      }\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {Array.<string>} lines Label to draw split to lines.\n * @return {Array.<number>} Size of the label in pixels.\n */\nWebGLTextReplay.prototype.getTextSize_ = function(lines) {\n  const self = this;\n  const glyphAtlas = this.currAtlas_;\n  const textHeight = lines.length * glyphAtlas.height;\n  //Split every line to an array of chars, sum up their width, and select the longest.\n  const textWidth = lines.map(function(str) {\n    let sum = 0;\n    for (let i = 0, ii = str.length; i < ii; ++i) {\n      const curr = str[i];\n      if (!glyphAtlas.width[curr]) {\n        self.addCharToAtlas_(curr);\n      }\n      sum += glyphAtlas.width[curr] ? glyphAtlas.width[curr] : 0;\n    }\n    return sum;\n  }).reduce(function(max, curr) {\n    return Math.max(max, curr);\n  });\n\n  return [textWidth, textHeight];\n};\n\n\n/**\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nWebGLTextReplay.prototype.drawText_ = function(flatCoordinates, offset, end, stride) {\n  for (let i = offset, ii = end; i < ii; i += stride) {\n    this.drawCoordinates(flatCoordinates, offset, end, stride);\n  }\n};\n\n\n/**\n * @private\n * @param {string} char Character.\n */\nWebGLTextReplay.prototype.addCharToAtlas_ = function(char) {\n  if (char.length === 1) {\n    const glyphAtlas = this.currAtlas_;\n    const state = this.state_;\n    const mCtx = this.measureCanvas_.getContext('2d');\n    mCtx.font = state.font;\n    const width = Math.ceil(mCtx.measureText(char).width * state.scale);\n\n    const info = glyphAtlas.atlas.add(char, width, glyphAtlas.height,\n      function(ctx, x, y) {\n        //Parameterize the canvas\n        ctx.font = /** @type {string} */ (state.font);\n        ctx.fillStyle = state.fillColor;\n        ctx.strokeStyle = state.strokeColor;\n        ctx.lineWidth = state.lineWidth;\n        ctx.lineCap = /*** @type {string} */ (state.lineCap);\n        ctx.lineJoin = /** @type {string} */ (state.lineJoin);\n        ctx.miterLimit = /** @type {number} */ (state.miterLimit);\n        ctx.textAlign = 'left';\n        ctx.textBaseline = 'top';\n        if (CANVAS_LINE_DASH && state.lineDash) {\n          //FIXME: use pixelRatio\n          ctx.setLineDash(state.lineDash);\n          ctx.lineDashOffset = /** @type {number} */ (state.lineDashOffset);\n        }\n        if (state.scale !== 1) {\n          //FIXME: use pixelRatio\n          ctx.setTransform(/** @type {number} */ (state.scale), 0, 0,\n            /** @type {number} */ (state.scale), 0, 0);\n        }\n\n        //Draw the character on the canvas\n        if (state.strokeColor) {\n          ctx.strokeText(char, x, y);\n        }\n        if (state.fillColor) {\n          ctx.fillText(char, x, y);\n        }\n      });\n\n    if (info) {\n      glyphAtlas.width[char] = width;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.finish = function(context) {\n  const gl = context.getGL();\n\n  this.groupIndices.push(this.indices.length);\n  this.hitDetectionGroupIndices = this.groupIndices;\n\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  // create textures\n  /** @type {Object.<string, WebGLTexture>} */\n  const texturePerImage = {};\n\n  this.createTextures(this.textures_, this.images_, texturePerImage, gl);\n\n  this.state_ = {\n    strokeColor: null,\n    lineCap: undefined,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineJoin: undefined,\n    lineWidth: 0,\n    miterLimit: undefined,\n    fillColor: null,\n    font: undefined,\n    scale: undefined\n  };\n  this.text_ = '';\n  this.textAlign_ = undefined;\n  this.textBaseline_ = undefined;\n  this.offsetX_ = undefined;\n  this.offsetY_ = undefined;\n  this.images_ = null;\n  this.atlases_ = {};\n  this.currAtlas_ = undefined;\n  WebGLTextureReplay.prototype.finish.call(this, context);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.setTextStyle = function(textStyle) {\n  const state = this.state_;\n  const textFillStyle = textStyle.getFill();\n  const textStrokeStyle = textStyle.getStroke();\n  if (!textStyle || !textStyle.getText() || (!textFillStyle && !textStrokeStyle)) {\n    this.text_ = '';\n  } else {\n    if (!textFillStyle) {\n      state.fillColor = null;\n    } else {\n      const textFillStyleColor = textFillStyle.getColor();\n      state.fillColor = asColorLike(textFillStyleColor ?\n        textFillStyleColor : DEFAULT_FILLSTYLE);\n    }\n    if (!textStrokeStyle) {\n      state.strokeColor = null;\n      state.lineWidth = 0;\n    } else {\n      const textStrokeStyleColor = textStrokeStyle.getColor();\n      state.strokeColor = asColorLike(textStrokeStyleColor ?\n        textStrokeStyleColor : DEFAULT_STROKESTYLE);\n      state.lineWidth = textStrokeStyle.getWidth() || DEFAULT_LINEWIDTH;\n      state.lineCap = textStrokeStyle.getLineCap() || DEFAULT_LINECAP;\n      state.lineDashOffset = textStrokeStyle.getLineDashOffset() || DEFAULT_LINEDASHOFFSET;\n      state.lineJoin = textStrokeStyle.getLineJoin() || DEFAULT_LINEJOIN;\n      state.miterLimit = textStrokeStyle.getMiterLimit() || DEFAULT_MITERLIMIT;\n      const lineDash = textStrokeStyle.getLineDash();\n      state.lineDash = lineDash ? lineDash.slice() : DEFAULT_LINEDASH;\n    }\n    state.font = textStyle.getFont() || DEFAULT_FONT;\n    state.scale = textStyle.getScale() || 1;\n    this.text_ = /** @type {string} */ (textStyle.getText());\n    const textAlign = TEXT_ALIGN[textStyle.getTextAlign()];\n    const textBaseline = TEXT_ALIGN[textStyle.getTextBaseline()];\n    this.textAlign_ = textAlign === undefined ?\n      DEFAULT_TEXTALIGN : textAlign;\n    this.textBaseline_ = textBaseline === undefined ?\n      DEFAULT_TEXTBASELINE : textBaseline;\n    this.offsetX_ = textStyle.getOffsetX() || 0;\n    this.offsetY_ = textStyle.getOffsetY() || 0;\n    this.rotateWithView = !!textStyle.getRotateWithView();\n    this.rotation = textStyle.getRotation() || 0;\n\n    this.currAtlas_ = this.getAtlas_(state);\n  }\n};\n\n\n/**\n * @private\n * @param {Object} state Font attributes.\n * @return {module:ol/render/webgl/TextReplay~GlyphAtlas} Glyph atlas.\n */\nWebGLTextReplay.prototype.getAtlas_ = function(state) {\n  let params = [];\n  for (const i in state) {\n    if (state[i] || state[i] === 0) {\n      if (Array.isArray(state[i])) {\n        params = params.concat(state[i]);\n      } else {\n        params.push(state[i]);\n      }\n    }\n  }\n  const hash = this.calculateHash_(params);\n  if (!this.atlases_[hash]) {\n    const mCtx = this.measureCanvas_.getContext('2d');\n    mCtx.font = state.font;\n    const height = Math.ceil((mCtx.measureText('M').width * 1.5 +\n        state.lineWidth / 2) * state.scale);\n\n    this.atlases_[hash] = {\n      atlas: new AtlasManager({\n        space: state.lineWidth + 1\n      }),\n      width: {},\n      height: height\n    };\n  }\n  return this.atlases_[hash];\n};\n\n\n/**\n * @private\n * @param {Array.<string|number>} params Array of parameters.\n * @return {string} Hash string.\n */\nWebGLTextReplay.prototype.calculateHash_ = function(params) {\n  //TODO: Create a more performant, reliable, general hash function.\n  let hash = '';\n  for (let i = 0, ii = params.length; i < ii; ++i) {\n    hash += params[i];\n  }\n  return hash;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.getTextures = function(opt_all) {\n  return this.textures_;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.getHitDetectionTextures = function() {\n  return this.textures_;\n};\nexport default WebGLTextReplay;\n","/**\n * @module ol/render/webgl/ReplayGroup\n */\nimport {inherits} from '../../index.js';\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {buffer, createOrUpdateFromCoordinate} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {ORDER} from '../replay.js';\nimport ReplayGroup from '../ReplayGroup.js';\nimport WebGLCircleReplay from '../webgl/CircleReplay.js';\nimport WebGLImageReplay from '../webgl/ImageReplay.js';\nimport WebGLLineStringReplay from '../webgl/LineStringReplay.js';\nimport WebGLPolygonReplay from '../webgl/PolygonReplay.js';\nimport WebGLTextReplay from '../webgl/TextReplay.js';\n\n/**\n * @type {Array.<number>}\n */\nconst HIT_DETECTION_SIZE = [1, 1];\n\n/**\n * @type {Object.<module:ol/render/ReplayType,\n *                function(new: module:ol/render/webgl/Replay, number,\n *                module:ol/extent~Extent)>}\n */\nconst BATCH_CONSTRUCTORS = {\n  'Circle': WebGLCircleReplay,\n  'Image': WebGLImageReplay,\n  'LineString': WebGLLineStringReplay,\n  'Polygon': WebGLPolygonReplay,\n  'Text': WebGLTextReplay\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/render/ReplayGroup}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @param {number=} opt_renderBuffer Render buffer.\n * @struct\n */\nconst WebGLReplayGroup = function(tolerance, maxExtent, opt_renderBuffer) {\n  ReplayGroup.call(this);\n\n  /**\n   * @type {module:ol/extent~Extent}\n   * @private\n   */\n  this.maxExtent_ = maxExtent;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.tolerance_ = tolerance;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.renderBuffer_ = opt_renderBuffer;\n\n  /**\n   * @private\n   * @type {!Object.<string,\n   *        Object.<module:ol/render/ReplayType, module:ol/render/webgl/Replay>>}\n   */\n  this.replaysByZIndex_ = {};\n\n};\n\ninherits(WebGLReplayGroup, ReplayGroup);\n\n\n/**\n * @param {module:ol/style/Style} style Style.\n * @param {boolean} group Group with previous replay.\n */\nWebGLReplayGroup.prototype.addDeclutter = function(style, group) {};\n\n\n/**\n * @param {module:ol/webgl/Context} context WebGL context.\n * @return {function()} Delete resources function.\n */\nWebGLReplayGroup.prototype.getDeleteResourcesFunction = function(context) {\n  const functions = [];\n  let zKey;\n  for (zKey in this.replaysByZIndex_) {\n    const replays = this.replaysByZIndex_[zKey];\n    for (const replayKey in replays) {\n      functions.push(\n        replays[replayKey].getDeleteResourcesFunction(context));\n    }\n  }\n  return function() {\n    const length = functions.length;\n    let result;\n    for (let i = 0; i < length; i++) {\n      result = functions[i].apply(this, arguments);\n    }\n    return result;\n  };\n};\n\n\n/**\n * @param {module:ol/webgl/Context} context Context.\n */\nWebGLReplayGroup.prototype.finish = function(context) {\n  let zKey;\n  for (zKey in this.replaysByZIndex_) {\n    const replays = this.replaysByZIndex_[zKey];\n    for (const replayKey in replays) {\n      replays[replayKey].finish(context);\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLReplayGroup.prototype.getReplay = function(zIndex, replayType) {\n  const zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n  let replays = this.replaysByZIndex_[zIndexKey];\n  if (replays === undefined) {\n    replays = {};\n    this.replaysByZIndex_[zIndexKey] = replays;\n  }\n  let replay = replays[replayType];\n  if (replay === undefined) {\n    /**\n     * @type {Function}\n     */\n    const Constructor = BATCH_CONSTRUCTORS[replayType];\n    replay = new Constructor(this.tolerance_, this.maxExtent_);\n    replays[replayType] = replay;\n  }\n  return replay;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLReplayGroup.prototype.isEmpty = function() {\n  return isEmpty(this.replaysByZIndex_);\n};\n\n\n/**\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n */\nWebGLReplayGroup.prototype.replay = function(context,\n  center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash) {\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  let i, ii, j, jj, replays, replay;\n  for (i = 0, ii = zs.length; i < ii; ++i) {\n    replays = this.replaysByZIndex_[zs[i].toString()];\n    for (j = 0, jj = ORDER.length; j < jj; ++j) {\n      replay = replays[ORDER[j]];\n      if (replay !== undefined) {\n        replay.replay(context,\n          center, resolution, rotation, size, pixelRatio,\n          opacity, skippedFeaturesHash,\n          undefined, false);\n      }\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting\n *  this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplayGroup.prototype.replayHitDetection_ = function(context,\n  center, resolution, rotation, size, pixelRatio, opacity,\n  skippedFeaturesHash, featureCallback, oneByOne, opt_hitExtent) {\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(function(a, b) {\n    return b - a;\n  });\n\n  let i, ii, j, replays, replay, result;\n  for (i = 0, ii = zs.length; i < ii; ++i) {\n    replays = this.replaysByZIndex_[zs[i].toString()];\n    for (j = ORDER.length - 1; j >= 0; --j) {\n      replay = replays[ORDER[j]];\n      if (replay !== undefined) {\n        result = replay.replay(context,\n          center, resolution, rotation, size, pixelRatio, opacity,\n          skippedFeaturesHash, featureCallback, oneByOne, opt_hitExtent);\n        if (result) {\n          return result;\n        }\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} callback Feature callback.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplayGroup.prototype.forEachFeatureAtCoordinate = function(\n  coordinate, context, center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash,\n  callback) {\n  const gl = context.getGL();\n  gl.bindFramebuffer(\n    gl.FRAMEBUFFER, context.getHitDetectionFramebuffer());\n\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  let hitExtent;\n  if (this.renderBuffer_ !== undefined) {\n    // build an extent around the coordinate, so that only features that\n    // intersect this extent are checked\n    hitExtent = buffer(createOrUpdateFromCoordinate(coordinate), resolution * this.renderBuffer_);\n  }\n\n  return this.replayHitDetection_(context,\n    coordinate, resolution, rotation, HIT_DETECTION_SIZE,\n    pixelRatio, opacity, skippedFeaturesHash,\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {?} Callback result.\n     */\n    function(feature) {\n      const imageData = new Uint8Array(4);\n      gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n\n      if (imageData[3] > 0) {\n        const result = callback(feature);\n        if (result) {\n          return result;\n        }\n      }\n    }, true, hitExtent);\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @return {boolean} Is there a feature at the given coordinate?\n */\nWebGLReplayGroup.prototype.hasFeatureAtCoordinate = function(\n  coordinate, context, center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash) {\n  const gl = context.getGL();\n  gl.bindFramebuffer(\n    gl.FRAMEBUFFER, context.getHitDetectionFramebuffer());\n\n  const hasFeature = this.replayHitDetection_(context,\n    coordinate, resolution, rotation, HIT_DETECTION_SIZE,\n    pixelRatio, opacity, skippedFeaturesHash,\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {boolean} Is there a feature?\n     */\n    function(feature) {\n      const imageData = new Uint8Array(4);\n      gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n      return imageData[3] > 0;\n    }, false);\n\n  return hasFeature !== undefined;\n};\n\nexport default WebGLReplayGroup;\n","/**\n * @module ol/render/webgl/Immediate\n */\nimport {inherits} from '../../index.js';\nimport {intersects} from '../../extent.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport ReplayType from '../ReplayType.js';\nimport VectorContext from '../VectorContext.js';\nimport WebGLReplayGroup from '../webgl/ReplayGroup.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} pixelRatio Pixel ratio.\n * @struct\n */\nconst WebGLImmediateRenderer = function(context, center, resolution, rotation, size, extent, pixelRatio) {\n  VectorContext.call(this);\n\n  /**\n   * @private\n   */\n  this.context_ = context;\n\n  /**\n   * @private\n   */\n  this.center_ = center;\n\n  /**\n   * @private\n   */\n  this.extent_ = extent;\n\n  /**\n   * @private\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   */\n  this.size_ = size;\n\n  /**\n   * @private\n   */\n  this.rotation_ = rotation;\n\n  /**\n   * @private\n   */\n  this.resolution_ = resolution;\n\n  /**\n   * @private\n   * @type {module:ol/style/Image}\n   */\n  this.imageStyle_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fillStyle_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.strokeStyle_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Text}\n   */\n  this.textStyle_ = null;\n\n};\n\ninherits(WebGLImmediateRenderer, VectorContext);\n\n\n/**\n * @param {module:ol/render/webgl/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @private\n */\nWebGLImmediateRenderer.prototype.drawText_ = function(replayGroup, geometry) {\n  const context = this.context_;\n  const replay = /** @type {module:ol/render/webgl/TextReplay} */ (\n    replayGroup.getReplay(0, ReplayType.TEXT));\n  replay.setTextStyle(this.textStyle_);\n  replay.drawText(geometry, null);\n  replay.finish(context);\n  // default colors\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n};\n\n\n/**\n * Set the rendering style.  Note that since this is an immediate rendering API,\n * any `zIndex` on the provided style will be ignored.\n *\n * @param {module:ol/style/Style} style The rendering style.\n * @override\n * @api\n */\nWebGLImmediateRenderer.prototype.setStyle = function(style) {\n  this.setFillStrokeStyle(style.getFill(), style.getStroke());\n  this.setImageStyle(style.getImage());\n  this.setTextStyle(style.getText());\n};\n\n\n/**\n * Render a geometry into the canvas.  Call\n * {@link ol/render/webgl/Immediate#setStyle} first to set the rendering style.\n *\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry The geometry to render.\n * @override\n * @api\n */\nWebGLImmediateRenderer.prototype.drawGeometry = function(geometry) {\n  const type = geometry.getType();\n  switch (type) {\n    case GeometryType.POINT:\n      this.drawPoint(/** @type {module:ol/geom/Point} */ (geometry), null);\n      break;\n    case GeometryType.LINE_STRING:\n      this.drawLineString(/** @type {module:ol/geom/LineString} */ (geometry), null);\n      break;\n    case GeometryType.POLYGON:\n      this.drawPolygon(/** @type {module:ol/geom/Polygon} */ (geometry), null);\n      break;\n    case GeometryType.MULTI_POINT:\n      this.drawMultiPoint(/** @type {module:ol/geom/MultiPoint} */ (geometry), null);\n      break;\n    case GeometryType.MULTI_LINE_STRING:\n      this.drawMultiLineString(/** @type {module:ol/geom/MultiLineString} */ (geometry), null);\n      break;\n    case GeometryType.MULTI_POLYGON:\n      this.drawMultiPolygon(/** @type {module:ol/geom/MultiPolygon} */ (geometry), null);\n      break;\n    case GeometryType.GEOMETRY_COLLECTION:\n      this.drawGeometryCollection(/** @type {module:ol/geom/GeometryCollection} */ (geometry), null);\n      break;\n    case GeometryType.CIRCLE:\n      this.drawCircle(/** @type {module:ol/geom/Circle} */ (geometry), null);\n      break;\n    default:\n      // pass\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nWebGLImmediateRenderer.prototype.drawFeature = function(feature, style) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  this.setStyle(style);\n  this.drawGeometry(geometry);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawGeometryCollection = function(geometry, data) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    this.drawGeometry(geometries[i]);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawPoint = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/ImageReplay} */ (\n    replayGroup.getReplay(0, ReplayType.IMAGE));\n  replay.setImageStyle(this.imageStyle_);\n  replay.drawPoint(geometry, data);\n  replay.finish(context);\n  // default colors\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawMultiPoint = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/ImageReplay} */ (\n    replayGroup.getReplay(0, ReplayType.IMAGE));\n  replay.setImageStyle(this.imageStyle_);\n  replay.drawMultiPoint(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawLineString = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/LineStringReplay} */ (\n    replayGroup.getReplay(0, ReplayType.LINE_STRING));\n  replay.setFillStrokeStyle(null, this.strokeStyle_);\n  replay.drawLineString(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawMultiLineString = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/LineStringReplay} */ (\n    replayGroup.getReplay(0, ReplayType.LINE_STRING));\n  replay.setFillStrokeStyle(null, this.strokeStyle_);\n  replay.drawMultiLineString(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawPolygon = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/PolygonReplay} */ (\n    replayGroup.getReplay(0, ReplayType.POLYGON));\n  replay.setFillStrokeStyle(this.fillStyle_, this.strokeStyle_);\n  replay.drawPolygon(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawMultiPolygon = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/PolygonReplay} */ (\n    replayGroup.getReplay(0, ReplayType.POLYGON));\n  replay.setFillStrokeStyle(this.fillStyle_, this.strokeStyle_);\n  replay.drawMultiPolygon(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawCircle = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/CircleReplay} */ (\n    replayGroup.getReplay(0, ReplayType.CIRCLE));\n  replay.setFillStrokeStyle(this.fillStyle_, this.strokeStyle_);\n  replay.drawCircle(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.setImageStyle = function(imageStyle) {\n  this.imageStyle_ = imageStyle;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  this.fillStyle_ = fillStyle;\n  this.strokeStyle_ = strokeStyle;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.setTextStyle = function(textStyle) {\n  this.textStyle_ = textStyle;\n};\nexport default WebGLImmediateRenderer;\n","/**\n * @module ol/renderer/webgl/defaultmapshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../index.js';\nimport WebGLFragment from '../../webgl/Fragment.js';\nimport WebGLVertex from '../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_texCoord;\\n\\n\\nuniform float u_opacity;\\nuniform sampler2D u_texture;\\n\\nvoid main(void) {\\n  vec4 texColor = texture2D(u_texture, v_texCoord);\\n  gl_FragColor.rgb = texColor.rgb;\\n  gl_FragColor.a = texColor.a * u_opacity;\\n}\\n' :\n  'precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_texCoord;\\n\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texCoord;\\n\\nuniform mat4 u_texCoordMatrix;\\nuniform mat4 u_projectionMatrix;\\n\\nvoid main(void) {\\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\\n}\\n\\n\\n' :\n  'varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}');\n","/**\n * @module ol/renderer/webgl/defaultmapshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../index.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_texCoordMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_texCoordMatrix' : 'd');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'e');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'f');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_texture = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_texture' : 'g');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'b');\n\n  /**\n   * @type {number}\n   */\n  this.a_texCoord = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_texCoord' : 'c');\n};\n\nexport default Locations;\n","/**\n * @module ol/renderer/webgl/Layer\n */\nimport {inherits} from '../../index.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport WebGLImmediateRenderer from '../../render/webgl/Immediate.js';\nimport LayerRenderer from '../Layer.js';\nimport {fragment, vertex} from '../webgl/defaultmapshader.js';\nimport Locations from '../webgl/defaultmapshader/Locations.js';\nimport {create as createTransform} from '../../transform.js';\nimport {create, fromTransform} from '../../vec/mat4.js';\nimport {ARRAY_BUFFER, FRAMEBUFFER, FLOAT, TEXTURE_2D,\n  TRIANGLE_STRIP, COLOR_ATTACHMENT0} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\nimport {createEmptyTexture} from '../../webgl/Context.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst WebGLLayerRenderer = function(mapRenderer, layer) {\n\n  LayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {module:ol/renderer/webgl/Map}\n   */\n  this.mapRenderer = mapRenderer;\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Buffer}\n   */\n  this.arrayBuffer_ = new WebGLBuffer([\n    -1, -1, 0, 0,\n    1, -1, 1, 0,\n    -1, 1, 0, 1,\n    1, 1, 1, 1\n  ]);\n\n  /**\n   * @protected\n   * @type {WebGLTexture}\n   */\n  this.texture = null;\n\n  /**\n   * @protected\n   * @type {WebGLFramebuffer}\n   */\n  this.framebuffer = null;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.framebufferDimension = undefined;\n\n  /**\n   * @protected\n   * @type {module:ol/transform~Transform}\n   */\n  this.texCoordMatrix = createTransform();\n\n  /**\n   * @protected\n   * @type {module:ol/transform~Transform}\n   */\n  this.projectionMatrix = createTransform();\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.tmpMat4_ = create();\n\n  /**\n   * @private\n   * @type {module:ol/renderer/webgl/defaultmapshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n};\n\ninherits(WebGLLayerRenderer, LayerRenderer);\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} framebufferDimension Framebuffer dimension.\n * @protected\n */\nWebGLLayerRenderer.prototype.bindFramebuffer = function(frameState, framebufferDimension) {\n\n  const gl = this.mapRenderer.getGL();\n\n  if (this.framebufferDimension === undefined ||\n      this.framebufferDimension != framebufferDimension) {\n    /**\n     * @param {WebGLRenderingContext} gl GL.\n     * @param {WebGLFramebuffer} framebuffer Framebuffer.\n     * @param {WebGLTexture} texture Texture.\n     */\n    const postRenderFunction = function(gl, framebuffer, texture) {\n      if (!gl.isContextLost()) {\n        gl.deleteFramebuffer(framebuffer);\n        gl.deleteTexture(texture);\n      }\n    }.bind(null, gl, this.framebuffer, this.texture);\n\n    frameState.postRenderFunctions.push(\n      /** @type {module:ol/PluggableMap~PostRenderFunction} */ (postRenderFunction)\n    );\n\n    const texture = createEmptyTexture(\n      gl, framebufferDimension, framebufferDimension);\n\n    const framebuffer = gl.createFramebuffer();\n    gl.bindFramebuffer(FRAMEBUFFER, framebuffer);\n    gl.framebufferTexture2D(FRAMEBUFFER,\n      COLOR_ATTACHMENT0, TEXTURE_2D, texture, 0);\n\n    this.texture = texture;\n    this.framebuffer = framebuffer;\n    this.framebufferDimension = framebufferDimension;\n\n  } else {\n    gl.bindFramebuffer(FRAMEBUFFER, this.framebuffer);\n  }\n\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {module:ol/webgl/Context} context Context.\n */\nWebGLLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, context, frameState);\n\n  context.bindBuffer(ARRAY_BUFFER, this.arrayBuffer_);\n\n  const gl = context.getGL();\n\n  const program = context.getProgram(fragment, vertex);\n\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  if (context.useProgram(program)) {\n    gl.enableVertexAttribArray(locations.a_position);\n    gl.vertexAttribPointer(\n      locations.a_position, 2, FLOAT, false, 16, 0);\n    gl.enableVertexAttribArray(locations.a_texCoord);\n    gl.vertexAttribPointer(\n      locations.a_texCoord, 2, FLOAT, false, 16, 8);\n    gl.uniform1i(locations.u_texture, 0);\n  }\n\n  gl.uniformMatrix4fv(locations.u_texCoordMatrix, false,\n    fromTransform(this.tmpMat4_, this.getTexCoordMatrix()));\n  gl.uniformMatrix4fv(locations.u_projectionMatrix, false,\n    fromTransform(this.tmpMat4_, this.getProjectionMatrix()));\n  gl.uniform1f(locations.u_opacity, layerState.opacity);\n  gl.bindTexture(TEXTURE_2D, this.getTexture());\n  gl.drawArrays(TRIANGLE_STRIP, 0, 4);\n\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, context, frameState);\n};\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {module:ol/webgl/Context} context WebGL context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nWebGLLayerRenderer.prototype.dispatchComposeEvent_ = function(type, context, frameState) {\n  const layer = this.getLayer();\n  if (layer.hasListener(type)) {\n    const viewState = frameState.viewState;\n    const resolution = viewState.resolution;\n    const pixelRatio = frameState.pixelRatio;\n    const extent = frameState.extent;\n    const center = viewState.center;\n    const rotation = viewState.rotation;\n    const size = frameState.size;\n\n    const render = new WebGLImmediateRenderer(\n      context, center, resolution, rotation, size, extent, pixelRatio);\n    const composeEvent = new RenderEvent(\n      type, render, frameState, null, context);\n    layer.dispatchEvent(composeEvent);\n  }\n};\n\n\n/**\n * @return {!module:ol/transform~Transform} Matrix.\n */\nWebGLLayerRenderer.prototype.getTexCoordMatrix = function() {\n  return this.texCoordMatrix;\n};\n\n\n/**\n * @return {WebGLTexture} Texture.\n */\nWebGLLayerRenderer.prototype.getTexture = function() {\n  return this.texture;\n};\n\n\n/**\n * @return {!module:ol/transform~Transform} Matrix.\n */\nWebGLLayerRenderer.prototype.getProjectionMatrix = function() {\n  return this.projectionMatrix;\n};\n\n\n/**\n * Handle webglcontextlost.\n */\nWebGLLayerRenderer.prototype.handleWebGLContextLost = function() {\n  this.texture = null;\n  this.framebuffer = null;\n  this.framebufferDimension = undefined;\n};\n\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {module:ol/webgl/Context} context Context.\n * @return {boolean} whether composeFrame should be called.\n */\nWebGLLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {};\n\n\n/**\n * @abstract\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nWebGLLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {};\nexport default WebGLLayerRenderer;\n","/**\n * @module ol/renderer/webgl/ImageLayer\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../../reproj/common.js';\nimport {inherits} from '../../index.js';\nimport {TRUE, UNDEFINED} from '../../functions.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {getIntersection, isEmpty} from '../../extent.js';\nimport WebGLLayerRenderer from '../webgl/Layer.js';\nimport {\n  create as createTransform,\n  rotate as rotateTransform,\n  translate as translateTransform,\n  scale as scaleTransform,\n  reset as resetTransform,\n  apply as applyTransform,\n  invert as invertTransform,\n  multiply as multiplyTransform\n} from '../../transform.js';\nimport {CLAMP_TO_EDGE} from '../../webgl.js';\nimport {createTexture} from '../../webgl/Context.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/webgl/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Image} imageLayer Tile layer.\n * @api\n */\nconst WebGLImageLayerRenderer = function(mapRenderer, imageLayer) {\n\n  WebGLLayerRenderer.call(this, mapRenderer, imageLayer);\n\n  /**\n   * The last rendered image.\n   * @private\n   * @type {?module:ol/ImageBase}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitCanvasContext_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/transform~Transform}\n   */\n  this.hitTransformationMatrix_ = null;\n\n};\n\ninherits(WebGLImageLayerRenderer, WebGLLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nWebGLImageLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.IMAGE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/webgl/ImageLayer} The layer renderer.\n */\nWebGLImageLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new WebGLImageLayerRenderer(\n    /** @type {module:ol/renderer/webgl/Map} */ (mapRenderer),\n    /** @type {module:ol/layer/Image} */ (layer)\n  );\n};\n\n\n/**\n * @param {module:ol/ImageBase} image Image.\n * @private\n * @return {WebGLTexture} Texture.\n */\nWebGLImageLayerRenderer.prototype.createTexture_ = function(image) {\n\n  // We meet the conditions to work with non-power of two textures.\n  // http://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\n  // http://learningwebgl.com/blog/?p=2101\n\n  const imageElement = image.getImage();\n  const gl = this.mapRenderer.getGL();\n\n  return createTexture(\n    gl, imageElement, CLAMP_TO_EDGE, CLAMP_TO_EDGE);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const layer = this.getLayer();\n  const source = layer.getSource();\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  const skippedFeatureUids = frameState.skippedFeatureUids;\n  return source.forEachFeatureAtCoordinate(\n    coordinate, resolution, rotation, hitTolerance, skippedFeatureUids,\n\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {?} Callback result.\n     */\n    function(feature) {\n      return callback.call(thisArg, feature, layer);\n    });\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {\n\n  const gl = this.mapRenderer.getGL();\n\n  const pixelRatio = frameState.pixelRatio;\n  const viewState = frameState.viewState;\n  const viewCenter = viewState.center;\n  const viewResolution = viewState.resolution;\n  const viewRotation = viewState.rotation;\n\n  let image = this.image_;\n  let texture = this.texture;\n  const imageLayer = /** @type {module:ol/layer/Image} */ (this.getLayer());\n  const imageSource = imageLayer.getSource();\n\n  const hints = frameState.viewHints;\n\n  let renderedExtent = frameState.extent;\n  if (layerState.extent !== undefined) {\n    renderedExtent = getIntersection(renderedExtent, layerState.extent);\n  }\n  if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] &&\n      !isEmpty(renderedExtent)) {\n    let projection = viewState.projection;\n    if (!ENABLE_RASTER_REPROJECTION) {\n      const sourceProjection = imageSource.getProjection();\n      if (sourceProjection) {\n        projection = sourceProjection;\n      }\n    }\n    const image_ = imageSource.getImage(renderedExtent, viewResolution,\n      pixelRatio, projection);\n    if (image_) {\n      const loaded = this.loadImage(image_);\n      if (loaded) {\n        image = image_;\n        texture = this.createTexture_(image_);\n        if (this.texture) {\n          /**\n           * @param {WebGLRenderingContext} gl GL.\n           * @param {WebGLTexture} texture Texture.\n           */\n          const postRenderFunction = function(gl, texture) {\n            if (!gl.isContextLost()) {\n              gl.deleteTexture(texture);\n            }\n          }.bind(null, gl, this.texture);\n          frameState.postRenderFunctions.push(\n            /** @type {module:ol/PluggableMap~PostRenderFunction} */ (postRenderFunction)\n          );\n        }\n      }\n    }\n  }\n\n  if (image) {\n    const canvas = this.mapRenderer.getContext().getCanvas();\n\n    this.updateProjectionMatrix_(canvas.width, canvas.height,\n      pixelRatio, viewCenter, viewResolution, viewRotation,\n      image.getExtent());\n    this.hitTransformationMatrix_ = null;\n\n    // Translate and scale to flip the Y coord.\n    const texCoordMatrix = this.texCoordMatrix;\n    resetTransform(texCoordMatrix);\n    scaleTransform(texCoordMatrix, 1, -1);\n    translateTransform(texCoordMatrix, 0, -1);\n\n    this.image_ = image;\n    this.texture = texture;\n  }\n\n  return !!image;\n};\n\n\n/**\n * @param {number} canvasWidth Canvas width.\n * @param {number} canvasHeight Canvas height.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/coordinate~Coordinate} viewCenter View center.\n * @param {number} viewResolution View resolution.\n * @param {number} viewRotation View rotation.\n * @param {module:ol/extent~Extent} imageExtent Image extent.\n * @private\n */\nWebGLImageLayerRenderer.prototype.updateProjectionMatrix_ = function(canvasWidth, canvasHeight, pixelRatio,\n  viewCenter, viewResolution, viewRotation, imageExtent) {\n\n  const canvasExtentWidth = canvasWidth * viewResolution;\n  const canvasExtentHeight = canvasHeight * viewResolution;\n\n  const projectionMatrix = this.projectionMatrix;\n  resetTransform(projectionMatrix);\n  scaleTransform(projectionMatrix,\n    pixelRatio * 2 / canvasExtentWidth,\n    pixelRatio * 2 / canvasExtentHeight);\n  rotateTransform(projectionMatrix, -viewRotation);\n  translateTransform(projectionMatrix,\n    imageExtent[0] - viewCenter[0],\n    imageExtent[1] - viewCenter[1]);\n  scaleTransform(projectionMatrix,\n    (imageExtent[2] - imageExtent[0]) / 2,\n    (imageExtent[3] - imageExtent[1]) / 2);\n  translateTransform(projectionMatrix, 1, 1);\n\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState) {\n  const hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, 0, TRUE, this);\n  return hasFeature !== undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {\n  if (!this.image_ || !this.image_.getImage()) {\n    return undefined;\n  }\n\n  if (this.getLayer().getSource().forEachFeatureAtCoordinate !== UNDEFINED) {\n    // for ImageCanvas sources use the original hit-detection logic,\n    // so that for example also transparent polygons are detected\n    const coordinate = applyTransform(\n      frameState.pixelToCoordinateTransform, pixel.slice());\n    const hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, 0, TRUE, this);\n\n    if (hasFeature) {\n      return callback.call(thisArg, this.getLayer(), null);\n    } else {\n      return undefined;\n    }\n  } else {\n    const imageSize =\n        [this.image_.getImage().width, this.image_.getImage().height];\n\n    if (!this.hitTransformationMatrix_) {\n      this.hitTransformationMatrix_ = this.getHitTransformationMatrix_(\n        frameState.size, imageSize);\n    }\n\n    const pixelOnFrameBuffer = applyTransform(\n      this.hitTransformationMatrix_, pixel.slice());\n\n    if (pixelOnFrameBuffer[0] < 0 || pixelOnFrameBuffer[0] > imageSize[0] ||\n        pixelOnFrameBuffer[1] < 0 || pixelOnFrameBuffer[1] > imageSize[1]) {\n      // outside the image, no need to check\n      return undefined;\n    }\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.image_.getImage(),\n      pixelOnFrameBuffer[0], pixelOnFrameBuffer[1], 1, 1, 0, 0, 1, 1);\n\n    const imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(),  imageData);\n    } else {\n      return undefined;\n    }\n  }\n};\n\n\n/**\n * The transformation matrix to get the pixel on the image for a\n * pixel on the map.\n * @param {module:ol/size~Size} mapSize The map size.\n * @param {module:ol/size~Size} imageSize The image size.\n * @return {module:ol/transform~Transform} The transformation matrix.\n * @private\n */\nWebGLImageLayerRenderer.prototype.getHitTransformationMatrix_ = function(mapSize, imageSize) {\n  // the first matrix takes a map pixel, flips the y-axis and scales to\n  // a range between -1 ... 1\n  const mapCoordTransform = createTransform();\n  translateTransform(mapCoordTransform, -1, -1);\n  scaleTransform(mapCoordTransform, 2 / mapSize[0], 2 / mapSize[1]);\n  translateTransform(mapCoordTransform, 0, mapSize[1]);\n  scaleTransform(mapCoordTransform, 1, -1);\n\n  // the second matrix is the inverse of the projection matrix used in the\n  // shader for drawing\n  const projectionMatrixInv = invertTransform(this.projectionMatrix.slice());\n\n  // the third matrix scales to the image dimensions and flips the y-axis again\n  const transform = createTransform();\n  translateTransform(transform, 0, imageSize[1]);\n  scaleTransform(transform, 1, -1);\n  scaleTransform(transform, imageSize[0] / 2, imageSize[1] / 2);\n  translateTransform(transform, 1, 1);\n\n  multiplyTransform(transform, projectionMatrixInv);\n  multiplyTransform(transform, mapCoordTransform);\n\n  return transform;\n};\nexport default WebGLImageLayerRenderer;\n","/**\n * @module ol/renderer/webgl/Map\n */\n\nimport {inherits} from '../../index.js';\nimport {stableSort} from '../../array.js';\nimport {CLASS_UNSELECTABLE} from '../../css.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen} from '../../events.js';\nimport {visibleAtResolution} from '../../layer/Layer.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport WebGLImmediateRenderer from '../../render/webgl/Immediate.js';\nimport MapRenderer, {sortByZIndex} from '../Map.js';\nimport SourceState from '../../source/State.js';\nimport LRUCache from '../../structs/LRUCache.js';\nimport PriorityQueue from '../../structs/PriorityQueue.js';\nimport {BLEND, CLAMP_TO_EDGE, COLOR_BUFFER_BIT, CULL_FACE, DEPTH_TEST, FRAMEBUFFER,\n  getContext, LINEAR, ONE, ONE_MINUS_SRC_ALPHA, RGBA, SCISSOR_TEST, SRC_ALPHA,\n  STENCIL_TEST, TEXTURE0, TEXTURE_2D, TEXTURE_MAG_FILTER, TEXTURE_MIN_FILTER,\n  TEXTURE_WRAP_S, TEXTURE_WRAP_T, UNSIGNED_BYTE} from '../../webgl.js';\nimport WebGLContext from '../../webgl/Context.js';\nimport ContextEventType from '../../webgl/ContextEventType.js';\n\n\n/**\n * @typedef {Object} TextureCacheEntry\n * @property {number} magFilter\n * @property {number} minFilter\n * @property {WebGLTexture} texture\n */\n\n\n/**\n * Texture cache high water mark.\n * @type {number}\n */\nconst WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK = 1024;\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/Map}\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nconst WebGLMapRenderer = function(map) {\n  MapRenderer.call(this, map);\n\n  const container = map.getViewport();\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = /** @type {HTMLCanvasElement} */\n    (document.createElement('CANVAS'));\n  this.canvas_.style.width = '100%';\n  this.canvas_.style.height = '100%';\n  this.canvas_.style.display = 'block';\n  this.canvas_.className = CLASS_UNSELECTABLE;\n  container.insertBefore(this.canvas_, container.childNodes[0] || null);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.clipTileCanvasWidth_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.clipTileCanvasHeight_ = 0;\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.clipTileContext_ = createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n  /**\n   * @private\n   * @type {WebGLRenderingContext}\n   */\n  this.gl_ = getContext(this.canvas_, {\n    antialias: true,\n    depth: true,\n    failIfMajorPerformanceCaveat: true,\n    preserveDrawingBuffer: false,\n    stencil: true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Context}\n   */\n  this.context_ = new WebGLContext(this.canvas_, this.gl_);\n\n  listen(this.canvas_, ContextEventType.LOST,\n    this.handleWebGLContextLost, this);\n  listen(this.canvas_, ContextEventType.RESTORED,\n    this.handleWebGLContextRestored, this);\n\n  /**\n   * @private\n   * @type {module:ol/structs/LRUCache.<module:ol/renderer/webgl/Map~TextureCacheEntry|null>}\n   */\n  this.textureCache_ = new LRUCache();\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.focus_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/structs/PriorityQueue.<Array>}\n   */\n  this.tileTextureQueue_ = new PriorityQueue(\n    /**\n     * @param {Array.<*>} element Element.\n     * @return {number} Priority.\n     * @this {module:ol/renderer/webgl/Map}\n     */\n    (function(element) {\n      const tileCenter = /** @type {module:ol/coordinate~Coordinate} */ (element[1]);\n      const tileResolution = /** @type {number} */ (element[2]);\n      const deltaX = tileCenter[0] - this.focus_[0];\n      const deltaY = tileCenter[1] - this.focus_[1];\n      return 65536 * Math.log(tileResolution) +\n            Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n    }).bind(this),\n    /**\n     * @param {Array.<*>} element Element.\n     * @return {string} Key.\n     */\n    function(element) {\n      return (\n        /** @type {module:ol/Tile} */ (element[0]).getKey()\n      );\n    });\n\n\n  /**\n   * @param {module:ol/PluggableMap} map Map.\n   * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n   * @return {boolean} false.\n   * @this {module:ol/renderer/webgl/Map}\n   */\n  this.loadNextTileTexture_ =\n      function(map, frameState) {\n        if (!this.tileTextureQueue_.isEmpty()) {\n          this.tileTextureQueue_.reprioritize();\n          const element = this.tileTextureQueue_.dequeue();\n          const tile = /** @type {module:ol/Tile} */ (element[0]);\n          const tileSize = /** @type {module:ol/size~Size} */ (element[3]);\n          const tileGutter = /** @type {number} */ (element[4]);\n          this.bindTileTexture(\n            tile, tileSize, tileGutter, LINEAR, LINEAR);\n        }\n        return false;\n      }.bind(this);\n\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textureCacheFrameMarkerCount_ = 0;\n\n  this.initializeGL_();\n};\n\ninherits(WebGLMapRenderer, MapRenderer);\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {module:ol/size~Size} tileSize Tile size.\n * @param {number} tileGutter Tile gutter.\n * @param {number} magFilter Mag filter.\n * @param {number} minFilter Min filter.\n */\nWebGLMapRenderer.prototype.bindTileTexture = function(tile, tileSize, tileGutter, magFilter, minFilter) {\n  const gl = this.getGL();\n  const tileKey = tile.getKey();\n  if (this.textureCache_.containsKey(tileKey)) {\n    const textureCacheEntry = this.textureCache_.get(tileKey);\n    gl.bindTexture(TEXTURE_2D, textureCacheEntry.texture);\n    if (textureCacheEntry.magFilter != magFilter) {\n      gl.texParameteri(\n        TEXTURE_2D, TEXTURE_MAG_FILTER, magFilter);\n      textureCacheEntry.magFilter = magFilter;\n    }\n    if (textureCacheEntry.minFilter != minFilter) {\n      gl.texParameteri(\n        TEXTURE_2D, TEXTURE_MIN_FILTER, minFilter);\n      textureCacheEntry.minFilter = minFilter;\n    }\n  } else {\n    const texture = gl.createTexture();\n    gl.bindTexture(TEXTURE_2D, texture);\n    if (tileGutter > 0) {\n      const clipTileCanvas = this.clipTileContext_.canvas;\n      const clipTileContext = this.clipTileContext_;\n      if (this.clipTileCanvasWidth_ !== tileSize[0] ||\n          this.clipTileCanvasHeight_ !== tileSize[1]) {\n        clipTileCanvas.width = tileSize[0];\n        clipTileCanvas.height = tileSize[1];\n        this.clipTileCanvasWidth_ = tileSize[0];\n        this.clipTileCanvasHeight_ = tileSize[1];\n      } else {\n        clipTileContext.clearRect(0, 0, tileSize[0], tileSize[1]);\n      }\n      clipTileContext.drawImage(tile.getImage(), tileGutter, tileGutter,\n        tileSize[0], tileSize[1], 0, 0, tileSize[0], tileSize[1]);\n      gl.texImage2D(TEXTURE_2D, 0,\n        RGBA, RGBA,\n        UNSIGNED_BYTE, clipTileCanvas);\n    } else {\n      gl.texImage2D(TEXTURE_2D, 0,\n        RGBA, RGBA,\n        UNSIGNED_BYTE, tile.getImage());\n    }\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_MAG_FILTER, magFilter);\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_MIN_FILTER, minFilter);\n    gl.texParameteri(TEXTURE_2D, TEXTURE_WRAP_S,\n      CLAMP_TO_EDGE);\n    gl.texParameteri(TEXTURE_2D, TEXTURE_WRAP_T,\n      CLAMP_TO_EDGE);\n    this.textureCache_.set(tileKey, {\n      texture: texture,\n      magFilter: magFilter,\n      minFilter: minFilter\n    });\n  }\n};\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nWebGLMapRenderer.prototype.dispatchComposeEvent_ = function(type, frameState) {\n  const map = this.getMap();\n  if (map.hasListener(type)) {\n    const context = this.context_;\n\n    const extent = frameState.extent;\n    const size = frameState.size;\n    const viewState = frameState.viewState;\n    const pixelRatio = frameState.pixelRatio;\n\n    const resolution = viewState.resolution;\n    const center = viewState.center;\n    const rotation = viewState.rotation;\n\n    const vectorContext = new WebGLImmediateRenderer(context,\n      center, resolution, rotation, size, extent, pixelRatio);\n    const composeEvent = new RenderEvent(type, vectorContext,\n      frameState, null, context);\n    map.dispatchEvent(composeEvent);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.disposeInternal = function() {\n  const gl = this.getGL();\n  if (!gl.isContextLost()) {\n    this.textureCache_.forEach(\n      /**\n       * @param {?module:ol/renderer/webgl/Map~TextureCacheEntry} textureCacheEntry\n       *     Texture cache entry.\n       */\n      function(textureCacheEntry) {\n        if (textureCacheEntry) {\n          gl.deleteTexture(textureCacheEntry.texture);\n        }\n      });\n  }\n  this.context_.dispose();\n  MapRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nWebGLMapRenderer.prototype.expireCache_ = function(map, frameState) {\n  const gl = this.getGL();\n  let textureCacheEntry;\n  while (this.textureCache_.getCount() - this.textureCacheFrameMarkerCount_ >\n      WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK) {\n    textureCacheEntry = this.textureCache_.peekLast();\n    if (!textureCacheEntry) {\n      if (+this.textureCache_.peekLastKey() == frameState.index) {\n        break;\n      } else {\n        --this.textureCacheFrameMarkerCount_;\n      }\n    } else {\n      gl.deleteTexture(textureCacheEntry.texture);\n    }\n    this.textureCache_.pop();\n  }\n};\n\n\n/**\n * @return {module:ol/webgl/Context} The context.\n */\nWebGLMapRenderer.prototype.getContext = function() {\n  return this.context_;\n};\n\n\n/**\n * @return {WebGLRenderingContext} GL.\n */\nWebGLMapRenderer.prototype.getGL = function() {\n  return this.gl_;\n};\n\n\n/**\n * @return {module:ol/structs/PriorityQueue.<Array>} Tile texture queue.\n */\nWebGLMapRenderer.prototype.getTileTextureQueue = function() {\n  return this.tileTextureQueue_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nWebGLMapRenderer.prototype.handleWebGLContextLost = function(event) {\n  event.preventDefault();\n  this.textureCache_.clear();\n  this.textureCacheFrameMarkerCount_ = 0;\n\n  const renderers = this.getLayerRenderers();\n  for (const id in renderers) {\n    const renderer = /** @type {module:ol/renderer/webgl/Layer} */ (renderers[id]);\n    renderer.handleWebGLContextLost();\n  }\n};\n\n\n/**\n * @protected\n */\nWebGLMapRenderer.prototype.handleWebGLContextRestored = function() {\n  this.initializeGL_();\n  this.getMap().render();\n};\n\n\n/**\n * @private\n */\nWebGLMapRenderer.prototype.initializeGL_ = function() {\n  const gl = this.gl_;\n  gl.activeTexture(TEXTURE0);\n  gl.blendFuncSeparate(\n    SRC_ALPHA, ONE_MINUS_SRC_ALPHA,\n    ONE, ONE_MINUS_SRC_ALPHA);\n  gl.disable(CULL_FACE);\n  gl.disable(DEPTH_TEST);\n  gl.disable(SCISSOR_TEST);\n  gl.disable(STENCIL_TEST);\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @return {boolean} Is tile texture loaded.\n */\nWebGLMapRenderer.prototype.isTileTextureLoaded = function(tile) {\n  return this.textureCache_.containsKey(tile.getKey());\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.renderFrame = function(frameState) {\n\n  const context = this.getContext();\n  const gl = this.getGL();\n\n  if (gl.isContextLost()) {\n    return false;\n  }\n\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.canvas_.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return false;\n  }\n\n  this.focus_ = frameState.focus;\n\n  this.textureCache_.set((-frameState.index).toString(), null);\n  ++this.textureCacheFrameMarkerCount_;\n\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, frameState);\n\n  /** @type {Array.<module:ol/layer/Layer~State>} */\n  const layerStatesToDraw = [];\n  const layerStatesArray = frameState.layerStatesArray;\n  stableSort(layerStatesArray, sortByZIndex);\n\n  const viewResolution = frameState.viewState.resolution;\n  let i, ii, layerRenderer, layerState;\n  for (i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    layerState = layerStatesArray[i];\n    if (visibleAtResolution(layerState, viewResolution) &&\n        layerState.sourceState == SourceState.READY) {\n      layerRenderer = /** @type {module:ol/renderer/webgl/Layer} */ (this.getLayerRenderer(layerState.layer));\n      if (layerRenderer.prepareFrame(frameState, layerState, context)) {\n        layerStatesToDraw.push(layerState);\n      }\n    }\n  }\n\n  const width = frameState.size[0] * frameState.pixelRatio;\n  const height = frameState.size[1] * frameState.pixelRatio;\n  if (this.canvas_.width != width || this.canvas_.height != height) {\n    this.canvas_.width = width;\n    this.canvas_.height = height;\n  }\n\n  gl.bindFramebuffer(FRAMEBUFFER, null);\n\n  gl.clearColor(0, 0, 0, 0);\n  gl.clear(COLOR_BUFFER_BIT);\n  gl.enable(BLEND);\n  gl.viewport(0, 0, this.canvas_.width, this.canvas_.height);\n\n  for (i = 0, ii = layerStatesToDraw.length; i < ii; ++i) {\n    layerState = layerStatesToDraw[i];\n    layerRenderer = /** @type {module:ol/renderer/webgl/Layer} */ (this.getLayerRenderer(layerState.layer));\n    layerRenderer.composeFrame(frameState, layerState, context);\n  }\n\n  if (!this.renderedVisible_) {\n    this.canvas_.style.display = '';\n    this.renderedVisible_ = true;\n  }\n\n  this.calculateMatrices2D(frameState);\n\n  if (this.textureCache_.getCount() - this.textureCacheFrameMarkerCount_ >\n      WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK) {\n    frameState.postRenderFunctions.push(\n      /** @type {module:ol/PluggableMap~PostRenderFunction} */ (this.expireCache_.bind(this))\n    );\n  }\n\n  if (!this.tileTextureQueue_.isEmpty()) {\n    frameState.postRenderFunctions.push(this.loadNextTileTexture_);\n    frameState.animate = true;\n  }\n\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, frameState);\n\n  this.scheduleRemoveUnusedLayerRenderers(frameState);\n  this.scheduleExpireIconCache(frameState);\n\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n\n  if (this.getGL().isContextLost()) {\n    return false;\n  }\n\n  const viewState = frameState.viewState;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewState.resolution) &&\n        layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = this.getLayerRenderer(layer);\n      result = layerRenderer.forEachFeatureAtCoordinate(\n        coordinate, frameState, hitTolerance, callback, thisArg);\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, layerFilter, thisArg) {\n  let hasFeature = false;\n\n  if (this.getGL().isContextLost()) {\n    return false;\n  }\n\n  const viewState = frameState.viewState;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewState.resolution) &&\n        layerFilter.call(thisArg, layer)) {\n      const layerRenderer = this.getLayerRenderer(layer);\n      hasFeature =\n          layerRenderer.hasFeatureAtCoordinate(coordinate, frameState);\n      if (hasFeature) {\n        return true;\n      }\n    }\n  }\n  return hasFeature;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg,\n  layerFilter, thisArg2) {\n  if (this.getGL().isContextLost()) {\n    return false;\n  }\n\n  const viewState = frameState.viewState;\n  let result;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewState.resolution) &&\n        layerFilter.call(thisArg, layer)) {\n      const layerRenderer = /** @type {module:ol/renderer/webgl/Layer} */ (this.getLayerRenderer(layer));\n      result = layerRenderer.forEachLayerAtPixel(\n        pixel, frameState, callback, thisArg);\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\nexport default WebGLMapRenderer;\n","/**\n * @module ol/renderer/webgl/tilelayershader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../index.js';\nimport WebGLFragment from '../../webgl/Fragment.js';\nimport WebGLVertex from '../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_texCoord;\\n\\n\\nuniform sampler2D u_texture;\\n\\nvoid main(void) {\\n  gl_FragColor = texture2D(u_texture, v_texCoord);\\n}\\n' :\n  'precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_texCoord;\\n\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texCoord;\\nuniform vec4 u_tileOffset;\\n\\nvoid main(void) {\\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\\n  v_texCoord = a_texCoord;\\n}\\n\\n\\n' :\n  'varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}');\n","/**\n * @module ol/renderer/webgl/tilelayershader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG_WEBGL} from '../../../index.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_tileOffset = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_tileOffset' : 'd');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_texture = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_texture' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'b');\n\n  /**\n   * @type {number}\n   */\n  this.a_texCoord = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_texCoord' : 'c');\n};\n\nexport default Locations;\n","/**\n * @module ol/renderer/webgl/TileLayer\n */\n// FIXME large resolutions lead to too large framebuffers :-(\n// FIXME animated shaders! check in redraw\n\nimport {inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {createEmpty, intersects} from '../../extent.js';\nimport {roundUpToPowerOfTwo} from '../../math.js';\nimport WebGLLayerRenderer from '../webgl/Layer.js';\nimport {fragment, vertex} from '../webgl/tilelayershader.js';\nimport Locations from '../webgl/tilelayershader/Locations.js';\nimport {toSize} from '../../size.js';\nimport {\n  reset as resetTransform,\n  rotate as rotateTransform,\n  scale as scaleTransform,\n  translate as translateTransform,\n  apply as applyTransform\n} from '../../transform.js';\nimport {COLOR_BUFFER_BIT, BLEND, ARRAY_BUFFER, FLOAT, LINEAR, TRIANGLE_STRIP} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/webgl/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Tile} tileLayer Tile layer.\n * @api\n */\nconst WebGLTileLayerRenderer = function(mapRenderer, tileLayer) {\n\n  WebGLLayerRenderer.call(this, mapRenderer, tileLayer);\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Fragment}\n   */\n  this.fragmentShader_ = fragment;\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Vertex}\n   */\n  this.vertexShader_ = vertex;\n\n  /**\n   * @private\n   * @type {module:ol/renderer/webgl/tilelayershader/Locations}\n   */\n  this.locations_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Buffer}\n   */\n  this.renderArrayBuffer_ = new WebGLBuffer([\n    0, 0, 0, 1,\n    1, 0, 1, 1,\n    0, 1, 0, 0,\n    1, 1, 1, 0\n  ]);\n\n  /**\n   * @private\n   * @type {module:ol/TileRange}\n   */\n  this.renderedTileRange_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedFramebufferExtent_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.tmpSize_ = [0, 0];\n\n};\n\ninherits(WebGLTileLayerRenderer, WebGLLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nWebGLTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/webgl/TileLayer} The layer renderer.\n */\nWebGLTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new WebGLTileLayerRenderer(\n    /** @type {module:ol/renderer/webgl/Map} */ (mapRenderer),\n    /** @type {module:ol/layer/Tile} */ (layer)\n  );\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.disposeInternal = function() {\n  const context = this.mapRenderer.getContext();\n  context.deleteBuffer(this.renderArrayBuffer_);\n  WebGLLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.createLoadedTileFinder = function(source, projection, tiles) {\n  const mapRenderer = this.mapRenderer;\n\n  return (\n    /**\n     * @param {number} zoom Zoom level.\n     * @param {module:ol/TileRange} tileRange Tile range.\n     * @return {boolean} The tile range is fully loaded.\n     */\n    function(zoom, tileRange) {\n      function callback(tile) {\n        const loaded = mapRenderer.isTileTextureLoaded(tile);\n        if (loaded) {\n          if (!tiles[zoom]) {\n            tiles[zoom] = {};\n          }\n          tiles[zoom][tile.tileCoord.toString()] = tile;\n        }\n        return loaded;\n      }\n      return source.forEachLoadedTile(projection, zoom, tileRange, callback);\n    }\n  );\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.handleWebGLContextLost = function() {\n  WebGLLayerRenderer.prototype.handleWebGLContextLost.call(this);\n  this.locations_ = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {\n\n  const mapRenderer = this.mapRenderer;\n  const gl = context.getGL();\n\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n\n  const tileLayer = /** @type {module:ol/layer/Tile} */ (this.getLayer());\n  const tileSource = tileLayer.getSource();\n  const tileGrid = tileSource.getTileGridForProjection(projection);\n  const z = tileGrid.getZForResolution(viewState.resolution);\n  const tileResolution = tileGrid.getResolution(z);\n\n  const tilePixelSize =\n      tileSource.getTilePixelSize(z, frameState.pixelRatio, projection);\n  const pixelRatio = tilePixelSize[0] /\n      toSize(tileGrid.getTileSize(z), this.tmpSize_)[0];\n  const tilePixelResolution = tileResolution / pixelRatio;\n  const tileGutter = tileSource.getTilePixelRatio(pixelRatio) * tileSource.getGutter(projection);\n\n  const center = viewState.center;\n  const extent = frameState.extent;\n  const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n\n  let framebufferExtent;\n  if (this.renderedTileRange_ &&\n      this.renderedTileRange_.equals(tileRange) &&\n      this.renderedRevision_ == tileSource.getRevision()) {\n    framebufferExtent = this.renderedFramebufferExtent_;\n  } else {\n\n    const tileRangeSize = tileRange.getSize();\n\n    const maxDimension = Math.max(\n      tileRangeSize[0] * tilePixelSize[0],\n      tileRangeSize[1] * tilePixelSize[1]);\n    const framebufferDimension = roundUpToPowerOfTwo(maxDimension);\n    const framebufferExtentDimension = tilePixelResolution * framebufferDimension;\n    const origin = tileGrid.getOrigin(z);\n    const minX = origin[0] +\n        tileRange.minX * tilePixelSize[0] * tilePixelResolution;\n    const minY = origin[1] +\n        tileRange.minY * tilePixelSize[1] * tilePixelResolution;\n    framebufferExtent = [\n      minX, minY,\n      minX + framebufferExtentDimension, minY + framebufferExtentDimension\n    ];\n\n    this.bindFramebuffer(frameState, framebufferDimension);\n    gl.viewport(0, 0, framebufferDimension, framebufferDimension);\n\n    gl.clearColor(0, 0, 0, 0);\n    gl.clear(COLOR_BUFFER_BIT);\n    gl.disable(BLEND);\n\n    const program = context.getProgram(this.fragmentShader_, this.vertexShader_);\n    context.useProgram(program);\n    if (!this.locations_) {\n      this.locations_ = new Locations(gl, program);\n    }\n\n    context.bindBuffer(ARRAY_BUFFER, this.renderArrayBuffer_);\n    gl.enableVertexAttribArray(this.locations_.a_position);\n    gl.vertexAttribPointer(\n      this.locations_.a_position, 2, FLOAT, false, 16, 0);\n    gl.enableVertexAttribArray(this.locations_.a_texCoord);\n    gl.vertexAttribPointer(\n      this.locations_.a_texCoord, 2, FLOAT, false, 16, 8);\n    gl.uniform1i(this.locations_.u_texture, 0);\n\n    /**\n     * @type {Object.<number, Object.<string, module:ol/Tile>>}\n     */\n    const tilesToDrawByZ = {};\n    tilesToDrawByZ[z] = {};\n\n    const findLoadedTiles = this.createLoadedTileFinder(\n      tileSource, projection, tilesToDrawByZ);\n\n    const useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();\n    let allTilesLoaded = true;\n    const tmpExtent = createEmpty();\n    const tmpTileRange = new TileRange(0, 0, 0, 0);\n    let childTileRange, drawable, fullyLoaded, tile, tileState;\n    let x, y, tileExtent;\n    for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n\n        tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n        if (layerState.extent !== undefined) {\n          // ignore tiles outside layer extent\n          tileExtent = tileGrid.getTileCoordExtent(tile.tileCoord, tmpExtent);\n          if (!intersects(tileExtent, layerState.extent)) {\n            continue;\n          }\n        }\n        tileState = tile.getState();\n        drawable = tileState == TileState.LOADED ||\n            tileState == TileState.EMPTY ||\n            tileState == TileState.ERROR && !useInterimTilesOnError;\n        if (!drawable) {\n          tile = tile.getInterimTile();\n        }\n        tileState = tile.getState();\n        if (tileState == TileState.LOADED) {\n          if (mapRenderer.isTileTextureLoaded(tile)) {\n            tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n            continue;\n          }\n        } else if (tileState == TileState.EMPTY ||\n                   (tileState == TileState.ERROR &&\n                    !useInterimTilesOnError)) {\n          continue;\n        }\n\n        allTilesLoaded = false;\n        fullyLoaded = tileGrid.forEachTileCoordParentTileRange(\n          tile.tileCoord, findLoadedTiles, null, tmpTileRange, tmpExtent);\n        if (!fullyLoaded) {\n          childTileRange = tileGrid.getTileCoordChildTileRange(\n            tile.tileCoord, tmpTileRange, tmpExtent);\n          if (childTileRange) {\n            findLoadedTiles(z + 1, childTileRange);\n          }\n        }\n\n      }\n\n    }\n\n    /** @type {Array.<number>} */\n    const zs = Object.keys(tilesToDrawByZ).map(Number);\n    zs.sort(numberSafeCompareFunction);\n    const u_tileOffset = new Float32Array(4);\n    for (let i = 0, ii = zs.length; i < ii; ++i) {\n      const tilesToDraw = tilesToDrawByZ[zs[i]];\n      for (const tileKey in tilesToDraw) {\n        tile = tilesToDraw[tileKey];\n        tileExtent = tileGrid.getTileCoordExtent(tile.tileCoord, tmpExtent);\n        u_tileOffset[0] = 2 * (tileExtent[2] - tileExtent[0]) /\n            framebufferExtentDimension;\n        u_tileOffset[1] = 2 * (tileExtent[3] - tileExtent[1]) /\n            framebufferExtentDimension;\n        u_tileOffset[2] = 2 * (tileExtent[0] - framebufferExtent[0]) /\n            framebufferExtentDimension - 1;\n        u_tileOffset[3] = 2 * (tileExtent[1] - framebufferExtent[1]) /\n            framebufferExtentDimension - 1;\n        gl.uniform4fv(this.locations_.u_tileOffset, u_tileOffset);\n        mapRenderer.bindTileTexture(tile, tilePixelSize,\n          tileGutter * pixelRatio, LINEAR, LINEAR);\n        gl.drawArrays(TRIANGLE_STRIP, 0, 4);\n      }\n    }\n\n    if (allTilesLoaded) {\n      this.renderedTileRange_ = tileRange;\n      this.renderedFramebufferExtent_ = framebufferExtent;\n      this.renderedRevision_ = tileSource.getRevision();\n    } else {\n      this.renderedTileRange_ = null;\n      this.renderedFramebufferExtent_ = null;\n      this.renderedRevision_ = -1;\n      frameState.animate = true;\n    }\n\n  }\n\n  this.updateUsedTiles(frameState.usedTiles, tileSource, z, tileRange);\n  const tileTextureQueue = mapRenderer.getTileTextureQueue();\n  this.manageTilePyramid(\n    frameState, tileSource, tileGrid, pixelRatio, projection, extent, z,\n    tileLayer.getPreload(),\n    /**\n     * @param {module:ol/Tile} tile Tile.\n     */\n    function(tile) {\n      if (tile.getState() == TileState.LOADED &&\n            !mapRenderer.isTileTextureLoaded(tile) &&\n            !tileTextureQueue.isKeyQueued(tile.getKey())) {\n        tileTextureQueue.enqueue([\n          tile,\n          tileGrid.getTileCoordCenter(tile.tileCoord),\n          tileGrid.getResolution(tile.tileCoord[0]),\n          tilePixelSize, tileGutter * pixelRatio\n        ]);\n      }\n    }, this);\n  this.scheduleExpireCache(frameState, tileSource);\n\n  const texCoordMatrix = this.texCoordMatrix;\n  resetTransform(texCoordMatrix);\n  translateTransform(texCoordMatrix,\n    (Math.round(center[0] / tileResolution) * tileResolution - framebufferExtent[0]) /\n          (framebufferExtent[2] - framebufferExtent[0]),\n    (Math.round(center[1] / tileResolution) * tileResolution - framebufferExtent[1]) /\n          (framebufferExtent[3] - framebufferExtent[1]));\n  if (viewState.rotation !== 0) {\n    rotateTransform(texCoordMatrix, viewState.rotation);\n  }\n  scaleTransform(texCoordMatrix,\n    frameState.size[0] * viewState.resolution /\n          (framebufferExtent[2] - framebufferExtent[0]),\n    frameState.size[1] * viewState.resolution /\n          (framebufferExtent[3] - framebufferExtent[1]));\n  translateTransform(texCoordMatrix, -0.5, -0.5);\n\n  return true;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {\n  if (!this.framebuffer) {\n    return undefined;\n  }\n\n  const pixelOnMapScaled = [\n    pixel[0] / frameState.size[0],\n    (frameState.size[1] - pixel[1]) / frameState.size[1]];\n\n  const pixelOnFrameBufferScaled = applyTransform(\n    this.texCoordMatrix, pixelOnMapScaled.slice());\n  const pixelOnFrameBuffer = [\n    pixelOnFrameBufferScaled[0] * this.framebufferDimension,\n    pixelOnFrameBufferScaled[1] * this.framebufferDimension];\n\n  const gl = this.mapRenderer.getContext().getGL();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n  const imageData = new Uint8Array(4);\n  gl.readPixels(pixelOnFrameBuffer[0], pixelOnFrameBuffer[1], 1, 1,\n    gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n\n  if (imageData[3] > 0) {\n    return callback.call(thisArg, this.getLayer(), imageData);\n  } else {\n    return undefined;\n  }\n};\nexport default WebGLTileLayerRenderer;\n","/**\n * @module ol/renderer/webgl/VectorLayer\n */\nimport {getUid, inherits} from '../../index.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {buffer, containsExtent, createEmpty} from '../../extent.js';\nimport WebGLReplayGroup from '../../render/webgl/ReplayGroup.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport WebGLLayerRenderer from '../webgl/Layer.js';\nimport {apply as applyTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/webgl/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Vector} vectorLayer Vector layer.\n * @api\n */\nconst WebGLVectorLayerRenderer = function(mapRenderer, vectorLayer) {\n\n  WebGLLayerRenderer.call(this, mapRenderer, vectorLayer);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedResolution_ = NaN;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {function(module:ol/Feature, module:ol/Feature): number|null}\n   */\n  this.renderedRenderOrder_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/ReplayGroup}\n   */\n  this.replayGroup_ = null;\n\n  /**\n   * The last layer state.\n   * @private\n   * @type {?module:ol/layer/Layer~State}\n   */\n  this.layerState_ = null;\n\n};\n\ninherits(WebGLVectorLayerRenderer, WebGLLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nWebGLVectorLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/webgl/VectorLayer} The layer renderer.\n */\nWebGLVectorLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new WebGLVectorLayerRenderer(\n    /** @type {module:ol/renderer/webgl/Map} */ (mapRenderer),\n    /** @type {module:ol/layer/Vector} */ (layer)\n  );\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n  this.layerState_ = layerState;\n  const viewState = frameState.viewState;\n  const replayGroup = this.replayGroup_;\n  const size = frameState.size;\n  const pixelRatio = frameState.pixelRatio;\n  const gl = this.mapRenderer.getGL();\n  if (replayGroup && !replayGroup.isEmpty()) {\n    gl.enable(gl.SCISSOR_TEST);\n    gl.scissor(0, 0, size[0] * pixelRatio, size[1] * pixelRatio);\n    replayGroup.replay(context,\n      viewState.center, viewState.resolution, viewState.rotation,\n      size, pixelRatio, layerState.opacity,\n      layerState.managed ? frameState.skippedFeatureUids : {});\n    gl.disable(gl.SCISSOR_TEST);\n  }\n\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.disposeInternal = function() {\n  const replayGroup = this.replayGroup_;\n  if (replayGroup) {\n    const context = this.mapRenderer.getContext();\n    replayGroup.getDeleteResourcesFunction(context)();\n    this.replayGroup_ = null;\n  }\n  WebGLLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (!this.replayGroup_ || !this.layerState_) {\n    return undefined;\n  } else {\n    const context = this.mapRenderer.getContext();\n    const viewState = frameState.viewState;\n    const layer = this.getLayer();\n    const layerState = this.layerState_;\n    /** @type {!Object.<string, boolean>} */\n    const features = {};\n    return this.replayGroup_.forEachFeatureAtCoordinate(coordinate,\n      context, viewState.center, viewState.resolution, viewState.rotation,\n      frameState.size, frameState.pixelRatio, layerState.opacity,\n      {},\n      /**\n       * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n       * @return {?} Callback result.\n       */\n      function(feature) {\n        const key = getUid(feature).toString();\n        if (!(key in features)) {\n          features[key] = true;\n          return callback.call(thisArg, feature, layer);\n        }\n      });\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState) {\n  if (!this.replayGroup_ || !this.layerState_) {\n    return false;\n  } else {\n    const context = this.mapRenderer.getContext();\n    const viewState = frameState.viewState;\n    const layerState = this.layerState_;\n    return this.replayGroup_.hasFeatureAtCoordinate(coordinate,\n      context, viewState.center, viewState.resolution, viewState.rotation,\n      frameState.size, frameState.pixelRatio, layerState.opacity,\n      frameState.skippedFeatureUids);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {\n  const coordinate = applyTransform(\n    frameState.pixelToCoordinateTransform, pixel.slice());\n  const hasFeature = this.hasFeatureAtCoordinate(coordinate, frameState);\n\n  if (hasFeature) {\n    return callback.call(thisArg, this.getLayer(), null);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nWebGLVectorLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {\n  const vectorLayer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n  const vectorSource = vectorLayer.getSource();\n\n  const animating = frameState.viewHints[ViewHint.ANIMATING];\n  const interacting = frameState.viewHints[ViewHint.INTERACTING];\n  const updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n  const updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n  if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n      (!updateWhileInteracting && interacting)) {\n    return true;\n  }\n\n  const frameStateExtent = frameState.extent;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const resolution = viewState.resolution;\n  const pixelRatio = frameState.pixelRatio;\n  const vectorLayerRevision = vectorLayer.getRevision();\n  const vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n  let vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n  if (vectorLayerRenderOrder === undefined) {\n    vectorLayerRenderOrder = defaultRenderOrder;\n  }\n\n  const extent = buffer(frameStateExtent,\n    vectorLayerRenderBuffer * resolution);\n\n  if (!this.dirty_ &&\n      this.renderedResolution_ == resolution &&\n      this.renderedRevision_ == vectorLayerRevision &&\n      this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n      containsExtent(this.renderedExtent_, extent)) {\n    return true;\n  }\n\n  if (this.replayGroup_) {\n    frameState.postRenderFunctions.push(\n      this.replayGroup_.getDeleteResourcesFunction(context));\n  }\n\n  this.dirty_ = false;\n\n  const replayGroup = new WebGLReplayGroup(\n    getRenderTolerance(resolution, pixelRatio),\n    extent, vectorLayer.getRenderBuffer());\n  vectorSource.loadFeatures(extent, resolution, projection);\n  /**\n   * @param {module:ol/Feature} feature Feature.\n   * @this {module:ol/renderer/webgl/VectorLayer}\n   */\n  const render = function(feature) {\n    let styles;\n    const styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n    if (styleFunction) {\n      styles = styleFunction(feature, resolution);\n    }\n    if (styles) {\n      const dirty = this.renderFeature(\n        feature, resolution, pixelRatio, styles, replayGroup);\n      this.dirty_ = this.dirty_ || dirty;\n    }\n  };\n  if (vectorLayerRenderOrder) {\n    /** @type {Array.<module:ol/Feature>} */\n    const features = [];\n    vectorSource.forEachFeatureInExtent(extent,\n      /**\n       * @param {module:ol/Feature} feature Feature.\n       */\n      function(feature) {\n        features.push(feature);\n      }, this);\n    features.sort(vectorLayerRenderOrder);\n    features.forEach(render.bind(this));\n  } else {\n    vectorSource.forEachFeatureInExtent(extent, render, this);\n  }\n  replayGroup.finish(context);\n\n  this.renderedResolution_ = resolution;\n  this.renderedRevision_ = vectorLayerRevision;\n  this.renderedRenderOrder_ = vectorLayerRenderOrder;\n  this.renderedExtent_ = extent;\n  this.replayGroup_ = replayGroup;\n\n  return true;\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of\n *     styles.\n * @param {module:ol/render/webgl/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nWebGLVectorLayerRenderer.prototype.renderFeature = function(feature, resolution, pixelRatio, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = styles.length - 1, ii = 0; i >= ii; --i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i],\n        getSquaredRenderTolerance(resolution, pixelRatio),\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles,\n      getSquaredRenderTolerance(resolution, pixelRatio),\n      this.handleStyleImageChange_, this) || loading;\n  }\n  return loading;\n};\nexport default WebGLVectorLayerRenderer;\n","/**\n * @module ol/WebGLMap\n */\nimport {inherits} from './index.js';\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport WebGLImageLayerRenderer from './renderer/webgl/ImageLayer.js';\nimport WebGLMapRenderer from './renderer/webgl/Map.js';\nimport WebGLTileLayerRenderer from './renderer/webgl/TileLayer.js';\nimport WebGLVectorLayerRenderer from './renderer/webgl/VectorLayer.js';\n\n\n/**\n * @classdesc\n * The WebGLMap uses WebGL for rendering map layers.  This renderer has limited\n * support for vector data and no support for vector tiles.\n *\n *     import WebGLMap from 'ol/WebGLMap';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *     import View from 'ol/View';\n *\n *     var map = new WebGLMap({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile~Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`.\n * Note that {@link module:ol/layer/Group~Group} is a subclass of\n * {@link module:ol/layer/Base}, so layers entered in the options or added\n * with `addLayer` can be groups, which can contain further groups, and so on.\n *\n * @constructor\n * @extends {module:ol/PluggableMap}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst WebGLMap = function(options) {\n  options = assign({}, options);\n  if (!options.controls) {\n    options.controls = defaultControls();\n  }\n  if (!options.interactions) {\n    options.interactions = defaultInteractions();\n  }\n\n  PluggableMap.call(this, options);\n};\n\ninherits(WebGLMap, PluggableMap);\n\n\nWebGLMap.prototype.createRenderer = function() {\n  const renderer = new WebGLMapRenderer(this);\n  renderer.registerLayerRenderers([\n    WebGLImageLayerRenderer,\n    WebGLTileLayerRenderer,\n    WebGLVectorLayerRenderer\n  ]);\n  return renderer;\n};\n\nexport default WebGLMap;\n","/**\n * @module ol/control/MousePosition\n */\n\nimport {inherits} from '../index.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getChangeEventType} from '../Object.js';\nimport Control from '../control/Control.js';\nimport {getTransformFromProjections, identityTransform, get as getProjection} from '../proj.js';\n\n\n/**\n * @type {string}\n */\nconst PROJECTION = 'projection';\n\n/**\n * @type {string}\n */\nconst COORDINATE_FORMAT = 'coordinateFormat';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-mouse-position'] CSS class name.\n * @property {module:ol/coordinate~CoordinateFormat} [coordinateFormat] Coordinate format.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {function(module:ol/MapEvent)} [render] Function called when the\n * control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n * @property {Element|string} [target] Specify a target if you want the\n * control to be rendered outside of the map's viewport.\n * @property {string} [undefinedHTML='&nbsp;'] Markup to show when coordinates are not\n * available (e.g. when the pointer leaves the map viewport).  By default, the last position\n * will be replaced with `'&nbsp;'` when the pointer leaves the viewport.  To\n * retain the last rendered position, set this option to something falsey (like an empty\n * string `''`).\n */\n\n\n/**\n * @classdesc\n * A control to show the 2D coordinates of the mouse cursor. By default, these\n * are in the view projection, but can be in any supported projection.\n * By default the control is shown in the top right corner of the map, but this\n * can be changed by using the css selector `.ol-mouse-position`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/MousePosition~Options=} opt_options Mouse position\n *     options.\n * @api\n */\nconst MousePosition = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const element = document.createElement('DIV');\n  element.className = options.className !== undefined ? options.className : 'ol-mouse-position';\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  listen(this,\n    getChangeEventType(PROJECTION),\n    this.handleProjectionChanged_, this);\n\n  if (options.coordinateFormat) {\n    this.setCoordinateFormat(options.coordinateFormat);\n  }\n  if (options.projection) {\n    this.setProjection(options.projection);\n  }\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.undefinedHTML_ = 'undefinedHTML' in options ? options.undefinedHTML : '&nbsp;';\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderOnMouseOut_ = !!this.undefinedHTML_;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.renderedHTML_ = element.innerHTML;\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.mapProjection_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/proj~TransformFunction}\n   */\n  this.transform_ = null;\n\n  /**\n   * @private\n   * @type {module:ol~Pixel}\n   */\n  this.lastMouseMovePixel_ = null;\n\n};\n\ninherits(MousePosition, Control);\n\n\n/**\n * Update the mouseposition element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/MousePosition}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    this.mapProjection_ = null;\n  } else {\n    if (this.mapProjection_ != frameState.viewState.projection) {\n      this.mapProjection_ = frameState.viewState.projection;\n      this.transform_ = null;\n    }\n  }\n  this.updateHTML_(this.lastMouseMovePixel_);\n}\n\n\n/**\n * @private\n */\nMousePosition.prototype.handleProjectionChanged_ = function() {\n  this.transform_ = null;\n};\n\n\n/**\n * Return the coordinate format type used to render the current position or\n * undefined.\n * @return {module:ol/coordinate~CoordinateFormat|undefined} The format to render the current\n *     position in.\n * @observable\n * @api\n */\nMousePosition.prototype.getCoordinateFormat = function() {\n  return (\n    /** @type {module:ol/coordinate~CoordinateFormat|undefined} */ (this.get(COORDINATE_FORMAT))\n  );\n};\n\n\n/**\n * Return the projection that is used to report the mouse position.\n * @return {module:ol/proj/Projection|undefined} The projection to report mouse\n *     position in.\n * @observable\n * @api\n */\nMousePosition.prototype.getProjection = function() {\n  return (\n    /** @type {module:ol/proj/Projection|undefined} */ (this.get(PROJECTION))\n  );\n};\n\n\n/**\n * @param {Event} event Browser event.\n * @protected\n */\nMousePosition.prototype.handleMouseMove = function(event) {\n  const map = this.getMap();\n  this.lastMouseMovePixel_ = map.getEventPixel(event);\n  this.updateHTML_(this.lastMouseMovePixel_);\n};\n\n\n/**\n * @param {Event} event Browser event.\n * @protected\n */\nMousePosition.prototype.handleMouseOut = function(event) {\n  this.updateHTML_(null);\n  this.lastMouseMovePixel_ = null;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMousePosition.prototype.setMap = function(map) {\n  Control.prototype.setMap.call(this, map);\n  if (map) {\n    const viewport = map.getViewport();\n    this.listenerKeys.push(\n      listen(viewport, EventType.MOUSEMOVE, this.handleMouseMove, this)\n    );\n    if (this.renderOnMouseOut_) {\n      this.listenerKeys.push(\n        listen(viewport, EventType.MOUSEOUT, this.handleMouseOut, this)\n      );\n    }\n  }\n};\n\n\n/**\n * Set the coordinate format type used to render the current position.\n * @param {module:ol/coordinate~CoordinateFormat} format The format to render the current\n *     position in.\n * @observable\n * @api\n */\nMousePosition.prototype.setCoordinateFormat = function(format) {\n  this.set(COORDINATE_FORMAT, format);\n};\n\n\n/**\n * Set the projection that is used to report the mouse position.\n * @param {module:ol/proj~ProjectionLike} projection The projection to report mouse\n *     position in.\n * @observable\n * @api\n */\nMousePosition.prototype.setProjection = function(projection) {\n  this.set(PROJECTION, getProjection(projection));\n};\n\n\n/**\n * @param {?module:ol~Pixel} pixel Pixel.\n * @private\n */\nMousePosition.prototype.updateHTML_ = function(pixel) {\n  let html = this.undefinedHTML_;\n  if (pixel && this.mapProjection_) {\n    if (!this.transform_) {\n      const projection = this.getProjection();\n      if (projection) {\n        this.transform_ = getTransformFromProjections(\n          this.mapProjection_, projection);\n      } else {\n        this.transform_ = identityTransform;\n      }\n    }\n    const map = this.getMap();\n    const coordinate = map.getCoordinateFromPixel(pixel);\n    if (coordinate) {\n      this.transform_(coordinate, coordinate);\n      const coordinateFormat = this.getCoordinateFormat();\n      if (coordinateFormat) {\n        html = coordinateFormat(coordinate);\n      } else {\n        html = coordinate.toString();\n      }\n    }\n  }\n  if (!this.renderedHTML_ || html !== this.renderedHTML_) {\n    this.element.innerHTML = html;\n    this.renderedHTML_ = html;\n  }\n};\n\n\nexport default MousePosition;\n","/**\n * @module ol/format/Feature\n */\nimport Geometry from '../geom/Geometry.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, equivalent as equivalentProjection, transformExtent} from '../proj.js';\n\n\n/**\n * @typedef {Object} ReadOptions\n * @property {module:ol/proj~ProjectionLike} dataProjection Projection of the data we are reading.\n * If not provided, the projection will be derived from the data (where possible) or\n * the `dataProjection` of the format is assigned (where set). If the projection\n * can not be derived from the data and if no `dataProjection` is set for a format,\n * the features will not be reprojected.\n * @property {module:ol/extent~Extent} extent Tile extent of the tile being read. This is only used and\n * required for {@link module:ol/format/MVT}.\n * @property {module:ol/proj~ProjectionLike} featureProjection Projection of the feature geometries\n * created by the format reader. If not provided, features will be returned in the\n * `dataProjection`.\n */\n\n\n/**\n * @typedef {Object} WriteOptions\n * @property {module:ol/proj~ProjectionLike} dataProjection Projection of the data we are writing.\n * If not provided, the `dataProjection` of the format is assigned (where set).\n * If no `dataProjection` is set for a format, the features will be returned\n * in the `featureProjection`.\n * @property {module:ol/proj~ProjectionLike} featureProjection Projection of the feature geometries\n * that will be serialized by the format writer. If not provided, geometries are assumed\n * to be in the `dataProjection` if that is set; in other words, they are not transformed.\n * @property {boolean} [rightHanded] When writing geometries, follow the right-hand\n * rule for linear ring orientation.  This means that polygons will have counter-clockwise\n * exterior rings and clockwise interior rings.  By default, coordinates are serialized\n * as they are provided at construction.  If `true`, the right-hand rule will\n * be applied.  If `false`, the left-hand rule will be applied (clockwise for\n * exterior and counter-clockwise for interior rings).  Note that not all\n * formats support this.  The GeoJSON format does use this property when writing\n * geometries.\n * @property {number} [decimals] Maximum number of decimal places for coordinates.\n * Coordinates are stored internally as floats, but floating-point arithmetic can create\n * coordinates with a large number of decimal places, not generally wanted on output.\n * Set a number here to round coordinates. Can also be used to ensure that\n * coordinates read in can be written back out with the same number of decimals.\n * Default is no rounding.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for feature formats.\n * {module:ol/format/Feature~FeatureFormat} subclasses provide the ability to decode and encode\n * {@link module:ol/Feature~Feature} objects from a variety of commonly used geospatial\n * file formats.  See the documentation for each format for more details.\n *\n * @constructor\n * @abstract\n * @api\n */\nconst FeatureFormat = function() {\n\n  /**\n   * @protected\n   * @type {module:ol/proj/Projection}\n   */\n  this.dataProjection = null;\n\n  /**\n   * @protected\n   * @type {module:ol/proj/Projection}\n   */\n  this.defaultFeatureProjection = null;\n\n};\n\n\n/**\n * Adds the data projection to the read options.\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @return {module:ol/format/Feature~ReadOptions|undefined} Options.\n * @protected\n */\nFeatureFormat.prototype.getReadOptions = function(source, opt_options) {\n  let options;\n  if (opt_options) {\n    options = {\n      dataProjection: opt_options.dataProjection ?\n        opt_options.dataProjection : this.readProjection(source),\n      featureProjection: opt_options.featureProjection\n    };\n  }\n  return this.adaptOptions(options);\n};\n\n\n/**\n * Sets the `dataProjection` on the options, if no `dataProjection`\n * is set.\n * @param {module:ol/format/Feature~WriteOptions|module:ol/format/Feature~ReadOptions|undefined} options\n *     Options.\n * @protected\n * @return {module:ol/format/Feature~WriteOptions|module:ol/format/Feature~ReadOptions|undefined}\n *     Updated options.\n */\nFeatureFormat.prototype.adaptOptions = function(options) {\n  return assign({\n    dataProjection: this.dataProjection,\n    featureProjection: this.defaultFeatureProjection\n  }, options);\n};\n\n\n/**\n * Get the extent from the source of the last {@link readFeatures} call.\n * @return {module:ol/extent~Extent} Tile extent.\n */\nFeatureFormat.prototype.getLastExtent = function() {\n  return null;\n};\n\n\n/**\n * @abstract\n * @return {module:ol/format/FormatType} Format.\n */\nFeatureFormat.prototype.getType = function() {};\n\n\n/**\n * Read a single feature from a source.\n *\n * @abstract\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n */\nFeatureFormat.prototype.readFeature = function(source, opt_options) {};\n\n\n/**\n * Read all features from a source.\n *\n * @abstract\n * @param {Document|Node|ArrayBuffer|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n */\nFeatureFormat.prototype.readFeatures = function(source, opt_options) {};\n\n\n/**\n * Read a single geometry from a source.\n *\n * @abstract\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n */\nFeatureFormat.prototype.readGeometry = function(source, opt_options) {};\n\n\n/**\n * Read the projection from a source.\n *\n * @abstract\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n */\nFeatureFormat.prototype.readProjection = function(source) {};\n\n\n/**\n * Encode a feature in this format.\n *\n * @abstract\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Result.\n */\nFeatureFormat.prototype.writeFeature = function(feature, opt_options) {};\n\n\n/**\n * Encode an array of features in this format.\n *\n * @abstract\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Result.\n */\nFeatureFormat.prototype.writeFeatures = function(features, opt_options) {};\n\n\n/**\n * Write a single geometry in this format.\n *\n * @abstract\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Result.\n */\nFeatureFormat.prototype.writeGeometry = function(geometry, opt_options) {};\n\nexport default FeatureFormat;\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/extent~Extent} geometry Geometry.\n * @param {boolean} write Set to true for writing, false for reading.\n * @param {(module:ol/format/Feature~WriteOptions|module:ol/format/Feature~ReadOptions)=} opt_options\n *     Options.\n * @return {module:ol/geom/Geometry|module:ol/extent~Extent} Transformed geometry.\n */\nexport function transformWithOptions(geometry, write, opt_options) {\n  const featureProjection = opt_options ?\n    getProjection(opt_options.featureProjection) : null;\n  const dataProjection = opt_options ?\n    getProjection(opt_options.dataProjection) : null;\n  /**\n   * @type {module:ol/geom/Geometry|module:ol/extent~Extent}\n   */\n  let transformed;\n  if (featureProjection && dataProjection &&\n      !equivalentProjection(featureProjection, dataProjection)) {\n    if (geometry instanceof Geometry) {\n      transformed = (write ? geometry.clone() : geometry).transform(\n        write ? featureProjection : dataProjection,\n        write ? dataProjection : featureProjection);\n    } else {\n      // FIXME this is necessary because GML treats extents\n      // as geometries\n      transformed = transformExtent(\n        geometry,\n        dataProjection,\n        featureProjection);\n    }\n  } else {\n    transformed = geometry;\n  }\n  if (write && opt_options && opt_options.decimals !== undefined) {\n    const power = Math.pow(10, opt_options.decimals);\n    // if decimals option on write, round each coordinate appropriately\n    /**\n     * @param {Array.<number>} coordinates Coordinates.\n     * @return {Array.<number>} Transformed coordinates.\n     */\n    const transform = function(coordinates) {\n      for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n        coordinates[i] = Math.round(coordinates[i] * power) / power;\n      }\n      return coordinates;\n    };\n    if (transformed === geometry) {\n      transformed = transformed.clone();\n    }\n    transformed.applyTransform(transform);\n  }\n  return transformed;\n}\n","/**\n * @module ol/format/JSONFeature\n */\nimport {inherits} from '../index.js';\nimport FeatureFormat from '../format/Feature.js';\nimport FormatType from '../format/FormatType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for JSON feature formats.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/format/Feature}\n */\nconst JSONFeature = function() {\n  FeatureFormat.call(this);\n};\n\ninherits(JSONFeature, FeatureFormat);\n\n\n/**\n * @param {Document|Node|Object|string} source Source.\n * @return {Object} Object.\n */\nfunction getObject(source) {\n  if (typeof source === 'string') {\n    const object = JSON.parse(source);\n    return object ? /** @type {Object} */ (object) : null;\n  } else if (source !== null) {\n    return source;\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.getType = function() {\n  return FormatType.JSON;\n};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readFeature = function(source, opt_options) {\n  return this.readFeatureFromObject(\n    getObject(source), this.getReadOptions(source, opt_options));\n};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readFeatures = function(source, opt_options) {\n  return this.readFeaturesFromObject(\n    getObject(source), this.getReadOptions(source, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {module:ol/Feature} Feature.\n */\nJSONFeature.prototype.readFeatureFromObject = function(object, opt_options) {};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {Array.<module:ol/Feature>} Features.\n */\nJSONFeature.prototype.readFeaturesFromObject = function(object, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readGeometry = function(source, opt_options) {\n  return this.readGeometryFromObject(\n    getObject(source), this.getReadOptions(source, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {module:ol/geom/Geometry} Geometry.\n */\nJSONFeature.prototype.readGeometryFromObject = function(object, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.readProjection = function(source) {\n  return this.readProjectionFromObject(getObject(source));\n};\n\n\n/**\n * @abstract\n * @param {Object} object Object.\n * @protected\n * @return {module:ol/proj/Projection} Projection.\n */\nJSONFeature.prototype.readProjectionFromObject = function(object) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.writeFeature = function(feature, opt_options) {\n  return JSON.stringify(this.writeFeatureObject(feature, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} Object.\n */\nJSONFeature.prototype.writeFeatureObject = function(feature, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.writeFeatures = function(features, opt_options) {\n  return JSON.stringify(this.writeFeaturesObject(features, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} Object.\n */\nJSONFeature.prototype.writeFeaturesObject = function(features, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nJSONFeature.prototype.writeGeometry = function(geometry, opt_options) {\n  return JSON.stringify(this.writeGeometryObject(geometry, opt_options));\n};\n\n\n/**\n * @abstract\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} Object.\n */\nJSONFeature.prototype.writeGeometryObject = function(geometry, opt_options) {};\nexport default JSONFeature;\n","/**\n * @module ol/format/EsriJSON\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport {assert} from '../asserts.js';\nimport {containsExtent} from '../extent.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport JSONFeature from '../format/JSONFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {linearRingIsClockwise} from '../geom/flat/orient.js';\nimport {assign, isEmpty} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @const\n * @type {Object.<module:ol/geom/GeometryType, function(EsriJSONGeometry): module:ol/geom/Geometry>}\n */\nconst GEOMETRY_READERS = {};\nGEOMETRY_READERS[GeometryType.POINT] = readPointGeometry;\nGEOMETRY_READERS[GeometryType.LINE_STRING] = readLineStringGeometry;\nGEOMETRY_READERS[GeometryType.POLYGON] = readPolygonGeometry;\nGEOMETRY_READERS[GeometryType.MULTI_POINT] = readMultiPointGeometry;\nGEOMETRY_READERS[GeometryType.MULTI_LINE_STRING] = readMultiLineStringGeometry;\nGEOMETRY_READERS[GeometryType.MULTI_POLYGON] = readMultiPolygonGeometry;\n\n\n/**\n * @const\n * @type {Object.<string, function(module:ol/geom/Geometry, module:ol/format/Feature~WriteOptions=): (EsriJSONGeometry)>}\n */\nconst GEOMETRY_WRITERS = {};\nGEOMETRY_WRITERS[GeometryType.POINT] = writePointGeometry;\nGEOMETRY_WRITERS[GeometryType.LINE_STRING] = writeLineStringGeometry;\nGEOMETRY_WRITERS[GeometryType.POLYGON] = writePolygonGeometry;\nGEOMETRY_WRITERS[GeometryType.MULTI_POINT] = writeMultiPointGeometry;\nGEOMETRY_WRITERS[GeometryType.MULTI_LINE_STRING] = writeMultiLineStringGeometry;\nGEOMETRY_WRITERS[GeometryType.MULTI_POLYGON] = writeMultiPolygonGeometry;\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [geometryName] Geometry name to use when creating features.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the EsriJSON format.\n *\n * @constructor\n * @extends {module:ol/format/JSONFeature}\n * @param {module:ol/format/EsriJSON~Options=} opt_options Options.\n * @api\n */\nconst EsriJSON = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  JSONFeature.call(this);\n\n  /**\n   * Name of the geometry attribute for features.\n   * @type {string|undefined}\n   * @private\n   */\n  this.geometryName_ = options.geometryName;\n\n};\n\ninherits(EsriJSON, JSONFeature);\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n */\nfunction readGeometry(object, opt_options) {\n  if (!object) {\n    return null;\n  }\n  /** @type {module:ol/geom/GeometryType} */\n  let type;\n  if (typeof object.x === 'number' && typeof object.y === 'number') {\n    type = GeometryType.POINT;\n  } else if (object.points) {\n    type = GeometryType.MULTI_POINT;\n  } else if (object.paths) {\n    if (object.paths.length === 1) {\n      type = GeometryType.LINE_STRING;\n    } else {\n      type = GeometryType.MULTI_LINE_STRING;\n    }\n  } else if (object.rings) {\n    const layout = getGeometryLayout(object);\n    const rings = convertRings(object.rings, layout);\n    object = /** @type {EsriJSONGeometry} */(assign({}, object));\n    if (rings.length === 1) {\n      type = GeometryType.POLYGON;\n      object.rings = rings[0];\n    } else {\n      type = GeometryType.MULTI_POLYGON;\n      object.rings = rings;\n    }\n  }\n  const geometryReader = GEOMETRY_READERS[type];\n  return (\n    /** @type {module:ol/geom/Geometry} */ (transformWithOptions(geometryReader(object), false, opt_options))\n  );\n}\n\n\n/**\n * Determines inner and outer rings.\n * Checks if any polygons in this array contain any other polygons in this\n * array. It is used for checking for holes.\n * Logic inspired by: https://github.com/Esri/terraformer-arcgis-parser\n * @param {Array.<!Array.<!Array.<number>>>} rings Rings.\n * @param {module:ol/geom/GeometryLayout} layout Geometry layout.\n * @return {Array.<!Array.<!Array.<number>>>} Transformed rings.\n */\nfunction convertRings(rings, layout) {\n  const flatRing = [];\n  const outerRings = [];\n  const holes = [];\n  let i, ii;\n  for (i = 0, ii = rings.length; i < ii; ++i) {\n    flatRing.length = 0;\n    deflateCoordinates(flatRing, 0, rings[i], layout.length);\n    // is this ring an outer ring? is it clockwise?\n    const clockwise = linearRingIsClockwise(flatRing, 0,\n      flatRing.length, layout.length);\n    if (clockwise) {\n      outerRings.push([rings[i]]);\n    } else {\n      holes.push(rings[i]);\n    }\n  }\n  while (holes.length) {\n    const hole = holes.shift();\n    let matched = false;\n    // loop over all outer rings and see if they contain our hole.\n    for (i = outerRings.length - 1; i >= 0; i--) {\n      const outerRing = outerRings[i][0];\n      const containsHole = containsExtent(\n        new LinearRing(outerRing).getExtent(),\n        new LinearRing(hole).getExtent()\n      );\n      if (containsHole) {\n        // the hole is contained push it into our polygon\n        outerRings[i].push(hole);\n        matched = true;\n        break;\n      }\n    }\n    if (!matched) {\n      // no outer rings contain this hole turn it into and outer\n      // ring (reverse it)\n      outerRings.push([hole.reverse()]);\n    }\n  }\n  return outerRings;\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @return {module:ol/geom/Geometry} Point.\n */\nfunction readPointGeometry(object) {\n  let point;\n  if (object.m !== undefined && object.z !== undefined) {\n    point = new Point([object.x, object.y, object.z, object.m],\n      GeometryLayout.XYZM);\n  } else if (object.z !== undefined) {\n    point = new Point([object.x, object.y, object.z],\n      GeometryLayout.XYZ);\n  } else if (object.m !== undefined) {\n    point = new Point([object.x, object.y, object.m],\n      GeometryLayout.XYM);\n  } else {\n    point = new Point([object.x, object.y]);\n  }\n  return point;\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @return {module:ol/geom/Geometry} LineString.\n */\nfunction readLineStringGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new LineString(object.paths[0], layout);\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @return {module:ol/geom/Geometry} MultiLineString.\n */\nfunction readMultiLineStringGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiLineString(object.paths, layout);\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @return {module:ol/geom/GeometryLayout} The geometry layout to use.\n */\nfunction getGeometryLayout(object) {\n  let layout = GeometryLayout.XY;\n  if (object.hasZ === true && object.hasM === true) {\n    layout = GeometryLayout.XYZM;\n  } else if (object.hasZ === true) {\n    layout = GeometryLayout.XYZ;\n  } else if (object.hasM === true) {\n    layout = GeometryLayout.XYM;\n  }\n  return layout;\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @return {module:ol/geom/Geometry} MultiPoint.\n */\nfunction readMultiPointGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiPoint(object.points, layout);\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @return {module:ol/geom/Geometry} MultiPolygon.\n */\nfunction readMultiPolygonGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiPolygon(\n    /** @type {Array.<Array.<Array.<Array.<number>>>>} */(object.rings),\n    layout);\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @return {module:ol/geom/Geometry} Polygon.\n */\nfunction readPolygonGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new Polygon(object.rings, layout);\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONGeometry} EsriJSON geometry.\n */\nfunction writePointGeometry(geometry, opt_options) {\n  const coordinates = /** @type {module:ol/geom/Point} */ (geometry).getCoordinates();\n  let esriJSON;\n  const layout = /** @type {module:ol/geom/Point} */ (geometry).getLayout();\n  if (layout === GeometryLayout.XYZ) {\n    esriJSON = /** @type {EsriJSONPoint} */ ({\n      x: coordinates[0],\n      y: coordinates[1],\n      z: coordinates[2]\n    });\n  } else if (layout === GeometryLayout.XYM) {\n    esriJSON = /** @type {EsriJSONPoint} */ ({\n      x: coordinates[0],\n      y: coordinates[1],\n      m: coordinates[2]\n    });\n  } else if (layout === GeometryLayout.XYZM) {\n    esriJSON = /** @type {EsriJSONPoint} */ ({\n      x: coordinates[0],\n      y: coordinates[1],\n      z: coordinates[2],\n      m: coordinates[3]\n    });\n  } else if (layout === GeometryLayout.XY) {\n    esriJSON = /** @type {EsriJSONPoint} */ ({\n      x: coordinates[0],\n      y: coordinates[1]\n    });\n  } else {\n    assert(false, 34); // Invalid geometry layout\n  }\n  return /** @type {EsriJSONGeometry} */ (esriJSON);\n}\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @return {Object} Object with boolean hasZ and hasM keys.\n */\nfunction getHasZM(geometry) {\n  const layout = geometry.getLayout();\n  return {\n    hasZ: (layout === GeometryLayout.XYZ ||\n      layout === GeometryLayout.XYZM),\n    hasM: (layout === GeometryLayout.XYM ||\n      layout === GeometryLayout.XYZM)\n  };\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolyline} EsriJSON geometry.\n */\nfunction writeLineStringGeometry(geometry, opt_options) {\n  const hasZM = getHasZM(/** @type {module:ol/geom/LineString} */(geometry));\n  return (\n    /** @type {EsriJSONPolyline} */ {\n      hasZ: hasZM.hasZ,\n      hasM: hasZM.hasM,\n      paths: [\n        /** @type {module:ol/geom/LineString} */ (geometry).getCoordinates()\n      ]\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolygon} EsriJSON geometry.\n */\nfunction writePolygonGeometry(geometry, opt_options) {\n  // Esri geometries use the left-hand rule\n  const hasZM = getHasZM(/** @type {module:ol/geom/Polygon} */(geometry));\n  return (\n    /** @type {EsriJSONPolygon} */ {\n      hasZ: hasZM.hasZ,\n      hasM: hasZM.hasM,\n      rings: /** @type {module:ol/geom/Polygon} */ (geometry).getCoordinates(false)\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolyline} EsriJSON geometry.\n */\nfunction writeMultiLineStringGeometry(geometry, opt_options) {\n  const hasZM = getHasZM(/** @type {module:ol/geom/MultiLineString} */(geometry));\n  return (\n    /** @type {EsriJSONPolyline} */ {\n      hasZ: hasZM.hasZ,\n      hasM: hasZM.hasM,\n      paths: /** @type {module:ol/geom/MultiLineString} */ (geometry).getCoordinates()\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONMultipoint} EsriJSON geometry.\n */\nfunction writeMultiPointGeometry(geometry, opt_options) {\n  const hasZM = getHasZM(/** @type {module:ol/geom/MultiPoint} */(geometry));\n  return (\n    /** @type {EsriJSONMultipoint} */ {\n      hasZ: hasZM.hasZ,\n      hasM: hasZM.hasM,\n      points: /** @type {module:ol/geom/MultiPoint} */ (geometry).getCoordinates()\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolygon} EsriJSON geometry.\n */\nfunction writeMultiPolygonGeometry(geometry, opt_options) {\n  const hasZM = getHasZM(/** @type {module:ol/geom/MultiPolygon} */(geometry));\n  const coordinates = /** @type {module:ol/geom/MultiPolygon} */ (geometry).getCoordinates(false);\n  const output = [];\n  for (let i = 0; i < coordinates.length; i++) {\n    for (let x = coordinates[i].length - 1; x >= 0; x--) {\n      output.push(coordinates[i][x]);\n    }\n  }\n  return /** @type {EsriJSONPolygon} */ ({\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    rings: output\n  });\n}\n\n\n/**\n * Read a feature from a EsriJSON Feature source.  Only works for Feature,\n * use `readFeatures` to read FeatureCollection source.\n *\n * @function\n * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nEsriJSON.prototype.readFeature;\n\n\n/**\n * Read all features from a EsriJSON source.  Works with both Feature and\n * FeatureCollection sources.\n *\n * @function\n * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nEsriJSON.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nEsriJSON.prototype.readFeatureFromObject = function(object, opt_options) {\n  const esriJSONFeature = /** @type {EsriJSONFeature} */ (object);\n  const geometry = readGeometry(esriJSONFeature.geometry, opt_options);\n  const feature = new Feature();\n  if (this.geometryName_) {\n    feature.setGeometryName(this.geometryName_);\n  }\n  feature.setGeometry(geometry);\n  if (opt_options && opt_options.idField &&\n    esriJSONFeature.attributes[opt_options.idField]) {\n    feature.setId(/** @type {number} */(esriJSONFeature.attributes[opt_options.idField]));\n  }\n  if (esriJSONFeature.attributes) {\n    feature.setProperties(esriJSONFeature.attributes);\n  }\n  return feature;\n};\n\n\n/**\n * @inheritDoc\n */\nEsriJSON.prototype.readFeaturesFromObject = function(object, opt_options) {\n  const esriJSONObject = /** @type {EsriJSONObject} */ (object);\n  const options = opt_options ? opt_options : {};\n  if (esriJSONObject.features) {\n    const esriJSONFeatureCollection = /** @type {EsriJSONFeatureCollection} */ (object);\n    /** @type {Array.<module:ol/Feature>} */\n    const features = [];\n    const esriJSONFeatures = esriJSONFeatureCollection.features;\n    options.idField = object.objectIdFieldName;\n    for (let i = 0, ii = esriJSONFeatures.length; i < ii; ++i) {\n      features.push(this.readFeatureFromObject(esriJSONFeatures[i], options));\n    }\n    return features;\n  } else {\n    return [this.readFeatureFromObject(object, options)];\n  }\n};\n\n\n/**\n * Read a geometry from a EsriJSON source.\n *\n * @function\n * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n * @api\n */\nEsriJSON.prototype.readGeometry;\n\n\n/**\n * @inheritDoc\n */\nEsriJSON.prototype.readGeometryFromObject = function(object, opt_options) {\n  return readGeometry(/** @type {EsriJSONGeometry} */(object), opt_options);\n};\n\n\n/**\n * Read the projection from a EsriJSON source.\n *\n * @function\n * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nEsriJSON.prototype.readProjection;\n\n\n/**\n * @inheritDoc\n */\nEsriJSON.prototype.readProjectionFromObject = function(object) {\n  const esriJSONObject = /** @type {EsriJSONObject} */ (object);\n  if (esriJSONObject.spatialReference && esriJSONObject.spatialReference.wkid) {\n    const crs = esriJSONObject.spatialReference.wkid;\n    return getProjection('EPSG:' + crs);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONGeometry} EsriJSON geometry.\n */\nfunction writeGeometry(geometry, opt_options) {\n  const geometryWriter = GEOMETRY_WRITERS[geometry.getType()];\n  return geometryWriter(/** @type {module:ol/geom/Geometry} */(\n    transformWithOptions(geometry, true, opt_options)), opt_options);\n}\n\n\n/**\n * Encode a geometry as a EsriJSON string.\n *\n * @function\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} EsriJSON.\n * @api\n */\nEsriJSON.prototype.writeGeometry;\n\n\n/**\n * Encode a geometry as a EsriJSON object.\n *\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {EsriJSONGeometry} Object.\n * @override\n * @api\n */\nEsriJSON.prototype.writeGeometryObject = function(geometry, opt_options) {\n  return writeGeometry(geometry, this.adaptOptions(opt_options));\n};\n\n\n/**\n * Encode a feature as a EsriJSON Feature string.\n *\n * @function\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} EsriJSON.\n * @api\n */\nEsriJSON.prototype.writeFeature;\n\n\n/**\n * Encode a feature as a esriJSON Feature object.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} Object.\n * @override\n * @api\n */\nEsriJSON.prototype.writeFeatureObject = function(feature, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  const object = {};\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    object['geometry'] = writeGeometry(geometry, opt_options);\n    if (opt_options && opt_options.featureProjection) {\n      object['geometry']['spatialReference'] = /** @type {EsriJSONCRS} */({\n        wkid: getProjection(opt_options.featureProjection).getCode().split(':').pop()\n      });\n    }\n  }\n  const properties = feature.getProperties();\n  delete properties[feature.getGeometryName()];\n  if (!isEmpty(properties)) {\n    object['attributes'] = properties;\n  } else {\n    object['attributes'] = {};\n  }\n  return object;\n};\n\n\n/**\n * Encode an array of features as EsriJSON.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} EsriJSON.\n * @api\n */\nEsriJSON.prototype.writeFeatures;\n\n\n/**\n * Encode an array of features as a EsriJSON object.\n *\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {Object} EsriJSON Object.\n * @override\n * @api\n */\nEsriJSON.prototype.writeFeaturesObject = function(features, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  const objects = [];\n  for (let i = 0, ii = features.length; i < ii; ++i) {\n    objects.push(this.writeFeatureObject(features[i], opt_options));\n  }\n  return /** @type {EsriJSONFeatureCollection} */ ({\n    'features': objects\n  });\n};\n\nexport default EsriJSON;\n","/**\n * @module ol/xml\n */\nimport {extend} from './array.js';\n\n\n/**\n * When using {@link module:ol/xml~makeChildAppender} or\n * {@link module:ol/xml~makeSimpleNodeFactory}, the top `objectStack` item needs\n * to have this structure.\n * @typedef {Object} NodeStackItem\n * @property {Node} node\n */\n\n\n/**\n * @typedef {function(Node, Array.<*>)} Parser\n */\n\n\n/**\n * @typedef {function(Node, *, Array.<*>)} Serializer\n */\n\n\n/**\n * This document should be used when creating nodes for XML serializations. This\n * document is also used by {@link module:ol/xml~createElementNS}\n * @const\n * @type {Document}\n */\nexport const DOCUMENT = document.implementation.createDocument('', '', null);\n\n\n/**\n * @type {string}\n */\nexport const XML_SCHEMA_INSTANCE_URI = 'http://www.w3.org/2001/XMLSchema-instance';\n\n\n/**\n * @param {string} namespaceURI Namespace URI.\n * @param {string} qualifiedName Qualified name.\n * @return {Node} Node.\n */\nexport function createElementNS(namespaceURI, qualifiedName) {\n  return DOCUMENT.createElementNS(namespaceURI, qualifiedName);\n}\n\n\n/**\n * Recursively grab all text content of child nodes into a single string.\n * @param {Node} node Node.\n * @param {boolean} normalizeWhitespace Normalize whitespace: remove all line\n * breaks.\n * @return {string} All text content.\n * @api\n */\nexport function getAllTextContent(node, normalizeWhitespace) {\n  return getAllTextContent_(node, normalizeWhitespace, []).join('');\n}\n\n\n/**\n * Recursively grab all text content of child nodes into a single string.\n * @param {Node} node Node.\n * @param {boolean} normalizeWhitespace Normalize whitespace: remove all line\n * breaks.\n * @param {Array.<string>} accumulator Accumulator.\n * @private\n * @return {Array.<string>} Accumulator.\n */\nexport function getAllTextContent_(node, normalizeWhitespace, accumulator) {\n  if (node.nodeType == Node.CDATA_SECTION_NODE ||\n      node.nodeType == Node.TEXT_NODE) {\n    if (normalizeWhitespace) {\n      accumulator.push(String(node.nodeValue).replace(/(\\r\\n|\\r|\\n)/g, ''));\n    } else {\n      accumulator.push(node.nodeValue);\n    }\n  } else {\n    let n;\n    for (n = node.firstChild; n; n = n.nextSibling) {\n      getAllTextContent_(n, normalizeWhitespace, accumulator);\n    }\n  }\n  return accumulator;\n}\n\n\n/**\n * @param {?} value Value.\n * @return {boolean} Is document.\n */\nexport function isDocument(value) {\n  return value instanceof Document;\n}\n\n\n/**\n * @param {?} value Value.\n * @return {boolean} Is node.\n */\nexport function isNode(value) {\n  return value instanceof Node;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {?string} namespaceURI Namespace URI.\n * @param {string} name Attribute name.\n * @return {string} Value\n */\nexport function getAttributeNS(node, namespaceURI, name) {\n  return node.getAttributeNS(namespaceURI, name) || '';\n}\n\n\n/**\n * Parse an XML string to an XML Document.\n * @param {string} xml XML.\n * @return {Document} Document.\n * @api\n */\nexport function parse(xml) {\n  return new DOMParser().parseFromString(xml, 'application/xml');\n}\n\n\n/**\n * Make an array extender function for extending the array at the top of the\n * object stack.\n * @param {function(this: T, Node, Array.<*>): (Array.<*>|undefined)}\n *     valueReader Value reader.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {module:ol/xml~Parser} Parser.\n * @template T\n */\nexport function makeArrayExtender(valueReader, opt_this) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array.<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const array = /** @type {Array.<*>} */ (objectStack[objectStack.length - 1]);\n        extend(array, value);\n      }\n    }\n  );\n}\n\n\n/**\n * Make an array pusher function for pushing to the array at the top of the\n * object stack.\n * @param {function(this: T, Node, Array.<*>): *} valueReader Value reader.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {module:ol/xml~Parser} Parser.\n * @template T\n */\nexport function makeArrayPusher(valueReader, opt_this) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array.<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const array = /** @type {Array.<*>} */ (objectStack[objectStack.length - 1]);\n        array.push(value);\n      }\n    });\n}\n\n\n/**\n * Make an object stack replacer function for replacing the object at the\n * top of the stack.\n * @param {function(this: T, Node, Array.<*>): *} valueReader Value reader.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {module:ol/xml~Parser} Parser.\n * @template T\n */\nexport function makeReplacer(valueReader, opt_this) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array.<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        objectStack[objectStack.length - 1] = value;\n      }\n    });\n}\n\n\n/**\n * Make an object property pusher function for adding a property to the\n * object at the top of the stack.\n * @param {function(this: T, Node, Array.<*>): *} valueReader Value reader.\n * @param {string=} opt_property Property.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {module:ol/xml~Parser} Parser.\n * @template T\n */\nexport function makeObjectPropertyPusher(valueReader, opt_property, opt_this) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array.<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const object = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n        const property = opt_property !== undefined ? opt_property : node.localName;\n        let array;\n        if (property in object) {\n          array = object[property];\n        } else {\n          array = object[property] = [];\n        }\n        array.push(value);\n      }\n    });\n}\n\n\n/**\n * Make an object property setter function.\n * @param {function(this: T, Node, Array.<*>): *} valueReader Value reader.\n * @param {string=} opt_property Property.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {module:ol/xml~Parser} Parser.\n * @template T\n */\nexport function makeObjectPropertySetter(valueReader, opt_property, opt_this) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array.<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const object = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n        const property = opt_property !== undefined ? opt_property : node.localName;\n        object[property] = value;\n      }\n    });\n}\n\n\n/**\n * Create a serializer that appends nodes written by its `nodeWriter` to its\n * designated parent. The parent is the `node` of the\n * {@link module:ol/xml~NodeStackItem} at the top of the `objectStack`.\n * @param {function(this: T, Node, V, Array.<*>)}\n *     nodeWriter Node writer.\n * @param {T=} opt_this The object to use as `this` in `nodeWriter`.\n * @return {module:ol/xml~Serializer} Serializer.\n * @template T, V\n */\nexport function makeChildAppender(nodeWriter, opt_this) {\n  return function(node, value, objectStack) {\n    nodeWriter.call(opt_this !== undefined ? opt_this : this, node, value, objectStack);\n    const parent = /** @type {module:ol/xml~NodeStackItem} */ (objectStack[objectStack.length - 1]);\n    const parentNode = parent.node;\n    parentNode.appendChild(node);\n  };\n}\n\n\n/**\n * Create a serializer that calls the provided `nodeWriter` from\n * {@link module:ol/xml~serialize}. This can be used by the parent writer to have the\n * 'nodeWriter' called with an array of values when the `nodeWriter` was\n * designed to serialize a single item. An example would be a LineString\n * geometry writer, which could be reused for writing MultiLineString\n * geometries.\n * @param {function(this: T, Node, V, Array.<*>)}\n *     nodeWriter Node writer.\n * @param {T=} opt_this The object to use as `this` in `nodeWriter`.\n * @return {module:ol/xml~Serializer} Serializer.\n * @template T, V\n */\nexport function makeArraySerializer(nodeWriter, opt_this) {\n  let serializersNS, nodeFactory;\n  return function(node, value, objectStack) {\n    if (serializersNS === undefined) {\n      serializersNS = {};\n      const serializers = {};\n      serializers[node.localName] = nodeWriter;\n      serializersNS[node.namespaceURI] = serializers;\n      nodeFactory = makeSimpleNodeFactory(node.localName);\n    }\n    serialize(serializersNS, nodeFactory, value, objectStack);\n  };\n}\n\n\n/**\n * Create a node factory which can use the `opt_keys` passed to\n * {@link module:ol/xml~serialize} or {@link module:ol/xml~pushSerializeAndPop} as node names,\n * or a fixed node name. The namespace of the created nodes can either be fixed,\n * or the parent namespace will be used.\n * @param {string=} opt_nodeName Fixed node name which will be used for all\n *     created nodes. If not provided, the 3rd argument to the resulting node\n *     factory needs to be provided and will be the nodeName.\n * @param {string=} opt_namespaceURI Fixed namespace URI which will be used for\n *     all created nodes. If not provided, the namespace of the parent node will\n *     be used.\n * @return {function(*, Array.<*>, string=): (Node|undefined)} Node factory.\n */\nexport function makeSimpleNodeFactory(opt_nodeName, opt_namespaceURI) {\n  const fixedNodeName = opt_nodeName;\n  return (\n    /**\n     * @param {*} value Value.\n     * @param {Array.<*>} objectStack Object stack.\n     * @param {string=} opt_nodeName Node name.\n     * @return {Node} Node.\n     */\n    function(value, objectStack, opt_nodeName) {\n      const context = /** @type {module:ol/xml~NodeStackItem} */ (objectStack[objectStack.length - 1]);\n      const node = context.node;\n      let nodeName = fixedNodeName;\n      if (nodeName === undefined) {\n        nodeName = opt_nodeName;\n      }\n\n      const namespaceURI = opt_namespaceURI !== undefined ? opt_namespaceURI : node.namespaceURI;\n      return createElementNS(namespaceURI, /** @type {string} */ (nodeName));\n    }\n  );\n}\n\n\n/**\n * A node factory that creates a node using the parent's `namespaceURI` and the\n * `nodeName` passed by {@link module:ol/xml~serialize} or\n * {@link module:ol/xml~pushSerializeAndPop} to the node factory.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nexport const OBJECT_PROPERTY_NODE_FACTORY = makeSimpleNodeFactory();\n\n\n/**\n * Create an array of `values` to be used with {@link module:ol/xml~serialize} or\n * {@link module:ol/xml~pushSerializeAndPop}, where `orderedKeys` has to be provided as\n * `opt_key` argument.\n * @param {Object.<string, V>} object Key-value pairs for the sequence. Keys can\n *     be a subset of the `orderedKeys`.\n * @param {Array.<string>} orderedKeys Keys in the order of the sequence.\n * @return {Array.<V>} Values in the order of the sequence. The resulting array\n *     has the same length as the `orderedKeys` array. Values that are not\n *     present in `object` will be `undefined` in the resulting array.\n * @template V\n */\nexport function makeSequence(object, orderedKeys) {\n  const length = orderedKeys.length;\n  const sequence = new Array(length);\n  for (let i = 0; i < length; ++i) {\n    sequence[i] = object[orderedKeys[i]];\n  }\n  return sequence;\n}\n\n\n/**\n * Create a namespaced structure, using the same values for each namespace.\n * This can be used as a starting point for versioned parsers, when only a few\n * values are version specific.\n * @param {Array.<string>} namespaceURIs Namespace URIs.\n * @param {T} structure Structure.\n * @param {Object.<string, T>=} opt_structureNS Namespaced structure to add to.\n * @return {Object.<string, T>} Namespaced structure.\n * @template T\n */\nexport function makeStructureNS(namespaceURIs, structure, opt_structureNS) {\n  /**\n   * @type {Object.<string, T>}\n   */\n  const structureNS = opt_structureNS !== undefined ? opt_structureNS : {};\n  let i, ii;\n  for (i = 0, ii = namespaceURIs.length; i < ii; ++i) {\n    structureNS[namespaceURIs[i]] = structure;\n  }\n  return structureNS;\n}\n\n\n/**\n * Parse a node using the parsers and object stack.\n * @param {Object.<string, Object.<string, module:ol/xml~Parser>>} parsersNS\n *     Parsers by namespace.\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @param {*=} opt_this The object to use as `this`.\n */\nexport function parseNode(parsersNS, node, objectStack, opt_this) {\n  let n;\n  for (n = node.firstElementChild; n; n = n.nextElementSibling) {\n    const parsers = parsersNS[n.namespaceURI];\n    if (parsers !== undefined) {\n      const parser = parsers[n.localName];\n      if (parser !== undefined) {\n        parser.call(opt_this, n, objectStack);\n      }\n    }\n  }\n}\n\n\n/**\n * Push an object on top of the stack, parse and return the popped object.\n * @param {T} object Object.\n * @param {Object.<string, Object.<string, module:ol/xml~Parser>>} parsersNS\n *     Parsers by namespace.\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @param {*=} opt_this The object to use as `this`.\n * @return {T} Object.\n * @template T\n */\nexport function pushParseAndPop(object, parsersNS, node, objectStack, opt_this) {\n  objectStack.push(object);\n  parseNode(parsersNS, node, objectStack, opt_this);\n  return /** @type {T} */ (objectStack.pop());\n}\n\n\n/**\n * Walk through an array of `values` and call a serializer for each value.\n * @param {Object.<string, Object.<string, module:ol/xml~Serializer>>} serializersNS\n *     Namespaced serializers.\n * @param {function(this: T, *, Array.<*>, (string|undefined)): (Node|undefined)} nodeFactory\n *     Node factory. The `nodeFactory` creates the node whose namespace and name\n *     will be used to choose a node writer from `serializersNS`. This\n *     separation allows us to decide what kind of node to create, depending on\n *     the value we want to serialize. An example for this would be different\n *     geometry writers based on the geometry type.\n * @param {Array.<*>} values Values to serialize. An example would be an array\n *     of {@link module:ol/Feature~Feature} instances.\n * @param {Array.<*>} objectStack Node stack.\n * @param {Array.<string>=} opt_keys Keys of the `values`. Will be passed to the\n *     `nodeFactory`. This is used for serializing object literals where the\n *     node name relates to the property key. The array length of `opt_keys` has\n *     to match the length of `values`. For serializing a sequence, `opt_keys`\n *     determines the order of the sequence.\n * @param {T=} opt_this The object to use as `this` for the node factory and\n *     serializers.\n * @template T\n */\nexport function serialize(\n  serializersNS, nodeFactory, values, objectStack, opt_keys, opt_this) {\n  const length = (opt_keys !== undefined ? opt_keys : values).length;\n  let value, node;\n  for (let i = 0; i < length; ++i) {\n    value = values[i];\n    if (value !== undefined) {\n      node = nodeFactory.call(opt_this !== undefined ? opt_this : this, value, objectStack,\n        opt_keys !== undefined ? opt_keys[i] : undefined);\n      if (node !== undefined) {\n        serializersNS[node.namespaceURI][node.localName]\n          .call(opt_this, node, value, objectStack);\n      }\n    }\n  }\n}\n\n\n/**\n * @param {O} object Object.\n * @param {Object.<string, Object.<string, module:ol/xml~Serializer>>} serializersNS\n *     Namespaced serializers.\n * @param {function(this: T, *, Array.<*>, (string|undefined)): (Node|undefined)} nodeFactory\n *     Node factory. The `nodeFactory` creates the node whose namespace and name\n *     will be used to choose a node writer from `serializersNS`. This\n *     separation allows us to decide what kind of node to create, depending on\n *     the value we want to serialize. An example for this would be different\n *     geometry writers based on the geometry type.\n * @param {Array.<*>} values Values to serialize. An example would be an array\n *     of {@link module:ol/Feature~Feature} instances.\n * @param {Array.<*>} objectStack Node stack.\n * @param {Array.<string>=} opt_keys Keys of the `values`. Will be passed to the\n *     `nodeFactory`. This is used for serializing object literals where the\n *     node name relates to the property key. The array length of `opt_keys` has\n *     to match the length of `values`. For serializing a sequence, `opt_keys`\n *     determines the order of the sequence.\n * @param {T=} opt_this The object to use as `this` for the node factory and\n *     serializers.\n * @return {O|undefined} Object.\n * @template O, T\n */\nexport function pushSerializeAndPop(object, serializersNS, nodeFactory, values, objectStack, opt_keys, opt_this) {\n  objectStack.push(object);\n  serialize(serializersNS, nodeFactory, values, objectStack, opt_keys, opt_this);\n  return /** @type {O|undefined} */ (objectStack.pop());\n}\n","/**\n * @module ol/format/XMLFeature\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport FeatureFormat from '../format/Feature.js';\nimport FormatType from '../format/FormatType.js';\nimport {isDocument, isNode, parse} from '../xml.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for XML feature formats.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/format/Feature}\n */\nconst XMLFeature = function() {\n\n  /**\n   * @type {XMLSerializer}\n   * @private\n   */\n  this.xmlSerializer_ = new XMLSerializer();\n\n  FeatureFormat.call(this);\n};\n\ninherits(XMLFeature, FeatureFormat);\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.getType = function() {\n  return FormatType.XML;\n};\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.readFeature = function(source, opt_options) {\n  if (isDocument(source)) {\n    return this.readFeatureFromDocument(/** @type {Document} */ (source), opt_options);\n  } else if (isNode(source)) {\n    return this.readFeatureFromNode(/** @type {Node} */ (source), opt_options);\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readFeatureFromDocument(doc, opt_options);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * @param {Document} doc Document.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @return {module:ol/Feature} Feature.\n */\nXMLFeature.prototype.readFeatureFromDocument = function(doc, opt_options) {\n  const features = this.readFeaturesFromDocument(doc, opt_options);\n  if (features.length > 0) {\n    return features[0];\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @return {module:ol/Feature} Feature.\n */\nXMLFeature.prototype.readFeatureFromNode = function(node, opt_options) {\n  return null; // not implemented\n};\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.readFeatures = function(source, opt_options) {\n  if (isDocument(source)) {\n    return this.readFeaturesFromDocument(\n      /** @type {Document} */ (source), opt_options);\n  } else if (isNode(source)) {\n    return this.readFeaturesFromNode(/** @type {Node} */ (source), opt_options);\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readFeaturesFromDocument(doc, opt_options);\n  } else {\n    return [];\n  }\n};\n\n\n/**\n * @param {Document} doc Document.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @protected\n * @return {Array.<module:ol/Feature>} Features.\n */\nXMLFeature.prototype.readFeaturesFromDocument = function(doc, opt_options) {\n  /** @type {Array.<module:ol/Feature>} */\n  const features = [];\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      extend(features, this.readFeaturesFromNode(n, opt_options));\n    }\n  }\n  return features;\n};\n\n\n/**\n * @abstract\n * @param {Node} node Node.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @protected\n * @return {Array.<module:ol/Feature>} Features.\n */\nXMLFeature.prototype.readFeaturesFromNode = function(node, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.readGeometry = function(source, opt_options) {\n  if (isDocument(source)) {\n    return this.readGeometryFromDocument(\n      /** @type {Document} */ (source), opt_options);\n  } else if (isNode(source)) {\n    return this.readGeometryFromNode(/** @type {Node} */ (source), opt_options);\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readGeometryFromDocument(doc, opt_options);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * @param {Document} doc Document.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @protected\n * @return {module:ol/geom/Geometry} Geometry.\n */\nXMLFeature.prototype.readGeometryFromDocument = function(doc, opt_options) {\n  return null; // not implemented\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @protected\n * @return {module:ol/geom/Geometry} Geometry.\n */\nXMLFeature.prototype.readGeometryFromNode = function(node, opt_options) {\n  return null; // not implemented\n};\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.readProjection = function(source) {\n  if (isDocument(source)) {\n    return this.readProjectionFromDocument(/** @type {Document} */ (source));\n  } else if (isNode(source)) {\n    return this.readProjectionFromNode(/** @type {Node} */ (source));\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readProjectionFromDocument(doc);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * @param {Document} doc Document.\n * @protected\n * @return {module:ol/proj/Projection} Projection.\n */\nXMLFeature.prototype.readProjectionFromDocument = function(doc) {\n  return this.dataProjection;\n};\n\n\n/**\n * @param {Node} node Node.\n * @protected\n * @return {module:ol/proj/Projection} Projection.\n */\nXMLFeature.prototype.readProjectionFromNode = function(node) {\n  return this.dataProjection;\n};\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.writeFeature = function(feature, opt_options) {\n  const node = this.writeFeatureNode(feature, opt_options);\n  return this.xmlSerializer_.serializeToString(node);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @protected\n * @return {Node} Node.\n */\nXMLFeature.prototype.writeFeatureNode = function(feature, opt_options) {\n  return null; // not implemented\n};\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.writeFeatures = function(features, opt_options) {\n  const node = this.writeFeaturesNode(features, opt_options);\n  return this.xmlSerializer_.serializeToString(node);\n};\n\n\n/**\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {Node} Node.\n */\nXMLFeature.prototype.writeFeaturesNode = function(features, opt_options) {\n  return null; // not implemented\n};\n\n\n/**\n * @inheritDoc\n */\nXMLFeature.prototype.writeGeometry = function(geometry, opt_options) {\n  const node = this.writeGeometryNode(geometry, opt_options);\n  return this.xmlSerializer_.serializeToString(node);\n};\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {Node} Node.\n */\nXMLFeature.prototype.writeGeometryNode = function(geometry, opt_options) {\n  return null; // not implemented\n};\nexport default XMLFeature;\n","/**\n * @module ol/format/GMLBase\n */\n// FIXME Envelopes should not be treated as geometries! readEnvelope_ is part\n// of GEOMETRY_PARSERS_ and methods using GEOMETRY_PARSERS_ do not expect\n// envelopes/extents, only geometries!\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport XMLFeature from '../format/XMLFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\nimport {getAllTextContent, getAttributeNS, makeArrayPusher, makeReplacer, parseNode, pushParseAndPop} from '../xml.js';\n\n\n/**\n * @const\n * @type {string}\n */\nexport const GMLNS = 'http://www.opengis.net/gml';\n\n\n/**\n * @typedef {Object} Options\n * @property {Object.<string, string>|string} [featureNS] Feature\n * namespace. If not defined will be derived from GML. If multiple\n * feature types have been configured which come from different feature\n * namespaces, this will be an object with the keys being the prefixes used\n * in the entries of featureType array. The values of the object will be the\n * feature namespaces themselves. So for instance there might be a featureType\n * item `topp:states` in the `featureType` array and then there will be a key\n * `topp` in the featureNS object with value `http://www.openplans.org/topp`.\n * @property {Array.<string>|string} [featureType] Feature type(s) to parse.\n * If multiple feature types need to be configured\n * which come from different feature namespaces, `featureNS` will be an object\n * with the keys being the prefixes used in the entries of featureType array.\n * The values of the object will be the feature namespaces themselves.\n * So for instance there might be a featureType item `topp:states` and then\n * there will be a key named `topp` in the featureNS object with value\n * `http://www.openplans.org/topp`.\n * @property {string} srsName srsName to use when writing geometries.\n * @property {boolean} [surface=false] Write gml:Surface instead of gml:Polygon\n * elements. This also affects the elements in multi-part geometries.\n * @property {boolean} [curve=false] Write gml:Curve instead of gml:LineString\n * elements. This also affects the elements in multi-part geometries.\n * @property {boolean} [multiCurve=true] Write gml:MultiCurve instead of gml:MultiLineString.\n * Since the latter is deprecated in GML 3.\n * @property {boolean} [multiSurface=true] Write gml:multiSurface instead of\n * gml:MultiPolygon. Since the latter is deprecated in GML 3.\n * @property {string} [schemaLocation] Optional schemaLocation to use when\n * writing out the GML, this will override the default provided.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Feature base format for reading and writing data in the GML format.\n * This class cannot be instantiated, it contains only base content that\n * is shared with versioned format classes GML2 and GML3.\n *\n * @constructor\n * @abstract\n * @param {module:ol/format/GMLBase~Options=} opt_options\n *     Optional configuration object.\n * @extends {module:ol/format/XMLFeature}\n */\nconst GMLBase = function(opt_options) {\n  const options = /** @type {module:ol/format/GMLBase~Options} */ (opt_options ? opt_options : {});\n\n  /**\n   * @protected\n   * @type {Array.<string>|string|undefined}\n   */\n  this.featureType = options.featureType;\n\n  /**\n   * @protected\n   * @type {Object.<string, string>|string|undefined}\n   */\n  this.featureNS = options.featureNS;\n\n  /**\n   * @protected\n   * @type {string}\n   */\n  this.srsName = options.srsName;\n\n  /**\n   * @protected\n   * @type {string}\n   */\n  this.schemaLocation = '';\n\n  /**\n   * @type {Object.<string, Object.<string, Object>>}\n   */\n  this.FEATURE_COLLECTION_PARSERS = {};\n  this.FEATURE_COLLECTION_PARSERS[GMLNS] = {\n    'featureMember': makeReplacer(GMLBase.prototype.readFeaturesInternal),\n    'featureMembers': makeReplacer(GMLBase.prototype.readFeaturesInternal)\n  };\n\n  XMLFeature.call(this);\n};\n\ninherits(GMLBase, XMLFeature);\n\n\n/**\n * A regular expression that matches if a string only contains whitespace\n * characters. It will e.g. match `''`, `' '`, `'\\n'` etc. The non-breaking\n * space (0xa0) is explicitly included as IE doesn't include it in its\n * definition of `\\s`.\n *\n * Information from `goog.string.isEmptyOrWhitespace`: https://github.com/google/closure-library/blob/e877b1e/closure/goog/string/string.js#L156-L160\n *\n * @const\n * @type {RegExp}\n */\nconst ONLY_WHITESPACE_RE = /^[\\s\\xa0]*$/;\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<module:ol/Feature> | undefined} Features.\n */\nGMLBase.prototype.readFeaturesInternal = function(node, objectStack) {\n  const localName = node.localName;\n  let features = null;\n  if (localName == 'FeatureCollection') {\n    if (node.namespaceURI === 'http://www.opengis.net/wfs') {\n      features = pushParseAndPop([],\n        this.FEATURE_COLLECTION_PARSERS, node,\n        objectStack, this);\n    } else {\n      features = pushParseAndPop(null,\n        this.FEATURE_COLLECTION_PARSERS, node,\n        objectStack, this);\n    }\n  } else if (localName == 'featureMembers' || localName == 'featureMember') {\n    const context = objectStack[0];\n    let featureType = context['featureType'];\n    let featureNS = context['featureNS'];\n    const prefix = 'p';\n    const defaultPrefix = 'p0';\n    if (!featureType && node.childNodes) {\n      featureType = [], featureNS = {};\n      for (let i = 0, ii = node.childNodes.length; i < ii; ++i) {\n        const child = node.childNodes[i];\n        if (child.nodeType === 1) {\n          const ft = child.nodeName.split(':').pop();\n          if (featureType.indexOf(ft) === -1) {\n            let key = '';\n            let count = 0;\n            const uri = child.namespaceURI;\n            for (const candidate in featureNS) {\n              if (featureNS[candidate] === uri) {\n                key = candidate;\n                break;\n              }\n              ++count;\n            }\n            if (!key) {\n              key = prefix + count;\n              featureNS[key] = uri;\n            }\n            featureType.push(key + ':' + ft);\n          }\n        }\n      }\n      if (localName != 'featureMember') {\n        // recheck featureType for each featureMember\n        context['featureType'] = featureType;\n        context['featureNS'] = featureNS;\n      }\n    }\n    if (typeof featureNS === 'string') {\n      const ns = featureNS;\n      featureNS = {};\n      featureNS[defaultPrefix] = ns;\n    }\n    const parsersNS = {};\n    const featureTypes = Array.isArray(featureType) ? featureType : [featureType];\n    for (const p in featureNS) {\n      const parsers = {};\n      for (let i = 0, ii = featureTypes.length; i < ii; ++i) {\n        const featurePrefix = featureTypes[i].indexOf(':') === -1 ?\n          defaultPrefix : featureTypes[i].split(':')[0];\n        if (featurePrefix === p) {\n          parsers[featureTypes[i].split(':').pop()] =\n              (localName == 'featureMembers') ?\n                makeArrayPusher(this.readFeatureElement, this) :\n                makeReplacer(this.readFeatureElement, this);\n        }\n      }\n      parsersNS[featureNS[p]] = parsers;\n    }\n    if (localName == 'featureMember') {\n      features = pushParseAndPop(undefined, parsersNS, node, objectStack);\n    } else {\n      features = pushParseAndPop([], parsersNS, node, objectStack);\n    }\n  }\n  if (features === null) {\n    features = [];\n  }\n  return features;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/Geometry|undefined} Geometry.\n */\nGMLBase.prototype.readGeometryElement = function(node, objectStack) {\n  const context = /** @type {Object} */ (objectStack[0]);\n  context['srsName'] = node.firstElementChild.getAttribute('srsName');\n  context['srsDimension'] = node.firstElementChild.getAttribute('srsDimension');\n  /** @type {module:ol/geom/Geometry} */\n  const geometry = pushParseAndPop(null, this.GEOMETRY_PARSERS_, node, objectStack, this);\n  if (geometry) {\n    return (\n      /** @type {module:ol/geom/Geometry} */ (transformWithOptions(geometry, false, context))\n    );\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/Feature} Feature.\n */\nGMLBase.prototype.readFeatureElement = function(node, objectStack) {\n  let n;\n  const fid = node.getAttribute('fid') || getAttributeNS(node, GMLNS, 'id');\n  const values = {};\n  let geometryName;\n  for (n = node.firstElementChild; n; n = n.nextElementSibling) {\n    const localName = n.localName;\n    // Assume attribute elements have one child node and that the child\n    // is a text or CDATA node (to be treated as text).\n    // Otherwise assume it is a geometry node.\n    if (n.childNodes.length === 0 ||\n        (n.childNodes.length === 1 &&\n        (n.firstChild.nodeType === 3 || n.firstChild.nodeType === 4))) {\n      let value = getAllTextContent(n, false);\n      if (ONLY_WHITESPACE_RE.test(value)) {\n        value = undefined;\n      }\n      values[localName] = value;\n    } else {\n      // boundedBy is an extent and must not be considered as a geometry\n      if (localName !== 'boundedBy') {\n        geometryName = localName;\n      }\n      values[localName] = this.readGeometryElement(n, objectStack);\n    }\n  }\n  const feature = new Feature(values);\n  if (geometryName) {\n    feature.setGeometryName(geometryName);\n  }\n  if (fid) {\n    feature.setId(fid);\n  }\n  return feature;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/Point|undefined} Point.\n */\nGMLBase.prototype.readPoint = function(node, objectStack) {\n  const flatCoordinates = this.readFlatCoordinatesFromNode_(node, objectStack);\n  if (flatCoordinates) {\n    const point = new Point(null);\n    point.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates);\n    return point;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/MultiPoint|undefined} MultiPoint.\n */\nGMLBase.prototype.readMultiPoint = function(node, objectStack) {\n  /** @type {Array.<Array.<number>>} */\n  const coordinates = pushParseAndPop([],\n    this.MULTIPOINT_PARSERS_, node, objectStack, this);\n  if (coordinates) {\n    return new MultiPoint(coordinates);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/MultiLineString|undefined} MultiLineString.\n */\nGMLBase.prototype.readMultiLineString = function(node, objectStack) {\n  /** @type {Array.<module:ol/geom/LineString>} */\n  const lineStrings = pushParseAndPop([],\n    this.MULTILINESTRING_PARSERS_, node, objectStack, this);\n  if (lineStrings) {\n    const multiLineString = new MultiLineString(null);\n    multiLineString.setLineStrings(lineStrings);\n    return multiLineString;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/MultiPolygon|undefined} MultiPolygon.\n */\nGMLBase.prototype.readMultiPolygon = function(node, objectStack) {\n  /** @type {Array.<module:ol/geom/Polygon>} */\n  const polygons = pushParseAndPop([], this.MULTIPOLYGON_PARSERS_, node, objectStack, this);\n  if (polygons) {\n    const multiPolygon = new MultiPolygon(null);\n    multiPolygon.setPolygons(polygons);\n    return multiPolygon;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGMLBase.prototype.pointMemberParser_ = function(node, objectStack) {\n  parseNode(this.POINTMEMBER_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGMLBase.prototype.lineStringMemberParser_ = function(node, objectStack) {\n  parseNode(this.LINESTRINGMEMBER_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGMLBase.prototype.polygonMemberParser_ = function(node, objectStack) {\n  parseNode(this.POLYGONMEMBER_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/LineString|undefined} LineString.\n */\nGMLBase.prototype.readLineString = function(node, objectStack) {\n  const flatCoordinates = this.readFlatCoordinatesFromNode_(node, objectStack);\n  if (flatCoordinates) {\n    const lineString = new LineString(null);\n    lineString.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates);\n    return lineString;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<number>|undefined} LinearRing flat coordinates.\n */\nGMLBase.prototype.readFlatLinearRing_ = function(node, objectStack) {\n  const ring = pushParseAndPop(null,\n    this.GEOMETRY_FLAT_COORDINATES_PARSERS_, node,\n    objectStack, this);\n  if (ring) {\n    return ring;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/LinearRing|undefined} LinearRing.\n */\nGMLBase.prototype.readLinearRing = function(node, objectStack) {\n  const flatCoordinates = this.readFlatCoordinatesFromNode_(node, objectStack);\n  if (flatCoordinates) {\n    const ring = new LinearRing(null);\n    ring.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates);\n    return ring;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/Polygon|undefined} Polygon.\n */\nGMLBase.prototype.readPolygon = function(node, objectStack) {\n  /** @type {Array.<Array.<number>>} */\n  const flatLinearRings = pushParseAndPop([null],\n    this.FLAT_LINEAR_RINGS_PARSERS_, node, objectStack, this);\n  if (flatLinearRings && flatLinearRings[0]) {\n    const polygon = new Polygon(null);\n    const flatCoordinates = flatLinearRings[0];\n    const ends = [flatCoordinates.length];\n    let i, ii;\n    for (i = 1, ii = flatLinearRings.length; i < ii; ++i) {\n      extend(flatCoordinates, flatLinearRings[i]);\n      ends.push(flatCoordinates.length);\n    }\n    polygon.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates, ends);\n    return polygon;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<number>} Flat coordinates.\n */\nGMLBase.prototype.readFlatCoordinatesFromNode_ = function(node, objectStack) {\n  return pushParseAndPop(null, this.GEOMETRY_FLAT_COORDINATES_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGMLBase.prototype.MULTIPOINT_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'pointMember': makeArrayPusher(GMLBase.prototype.pointMemberParser_),\n    'pointMembers': makeArrayPusher(GMLBase.prototype.pointMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGMLBase.prototype.MULTILINESTRING_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'lineStringMember': makeArrayPusher(GMLBase.prototype.lineStringMemberParser_),\n    'lineStringMembers': makeArrayPusher(GMLBase.prototype.lineStringMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGMLBase.prototype.MULTIPOLYGON_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'polygonMember': makeArrayPusher(GMLBase.prototype.polygonMemberParser_),\n    'polygonMembers': makeArrayPusher(GMLBase.prototype.polygonMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGMLBase.prototype.POINTMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'Point': makeArrayPusher(GMLBase.prototype.readFlatCoordinatesFromNode_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGMLBase.prototype.LINESTRINGMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'LineString': makeArrayPusher(GMLBase.prototype.readLineString)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGMLBase.prototype.POLYGONMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'Polygon': makeArrayPusher(GMLBase.prototype.readPolygon)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @protected\n */\nGMLBase.prototype.RING_PARSERS = {\n  'http://www.opengis.net/gml': {\n    'LinearRing': makeReplacer(GMLBase.prototype.readFlatLinearRing_)\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nGMLBase.prototype.readGeometryFromNode = function(node, opt_options) {\n  const geometry = this.readGeometryElement(node,\n    [this.getReadOptions(node, opt_options ? opt_options : {})]);\n  return geometry ? geometry : null;\n};\n\n\n/**\n * Read all features from a GML FeatureCollection.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nGMLBase.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nGMLBase.prototype.readFeaturesFromNode = function(node, opt_options) {\n  const options = {\n    featureType: this.featureType,\n    featureNS: this.featureNS\n  };\n  if (opt_options) {\n    assign(options, this.getReadOptions(node, opt_options));\n  }\n  const features = this.readFeaturesInternal(node, [options]);\n  return features || [];\n};\n\n\n/**\n * @inheritDoc\n */\nGMLBase.prototype.readProjectionFromNode = function(node) {\n  return getProjection(this.srsName ? this.srsName : node.firstElementChild.getAttribute('srsName'));\n};\nexport default GMLBase;\n","/**\n * @module ol/format/xsd\n */\nimport {getAllTextContent, DOCUMENT} from '../xml.js';\nimport {padNumber} from '../string.js';\n\n\n/**\n * @param {Node} node Node.\n * @return {boolean|undefined} Boolean.\n */\nexport function readBoolean(node) {\n  const s = getAllTextContent(node, false);\n  return readBooleanString(s);\n}\n\n\n/**\n * @param {string} string String.\n * @return {boolean|undefined} Boolean.\n */\nexport function readBooleanString(string) {\n  const m = /^\\s*(true|1)|(false|0)\\s*$/.exec(string);\n  if (m) {\n    return m[1] !== undefined || false;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} DateTime in seconds.\n */\nexport function readDateTime(node) {\n  const s = getAllTextContent(node, false);\n  const dateTime = Date.parse(s);\n  return isNaN(dateTime) ? undefined : dateTime / 1000;\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Decimal.\n */\nexport function readDecimal(node) {\n  const s = getAllTextContent(node, false);\n  return readDecimalString(s);\n}\n\n\n/**\n * @param {string} string String.\n * @return {number|undefined} Decimal.\n */\nexport function readDecimalString(string) {\n  // FIXME check spec\n  const m = /^\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)\\s*$/i.exec(string);\n  if (m) {\n    return parseFloat(m[1]);\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Non negative integer.\n */\nexport function readNonNegativeInteger(node) {\n  const s = getAllTextContent(node, false);\n  return readNonNegativeIntegerString(s);\n}\n\n\n/**\n * @param {string} string String.\n * @return {number|undefined} Non negative integer.\n */\nexport function readNonNegativeIntegerString(string) {\n  const m = /^\\s*(\\d+)\\s*$/.exec(string);\n  if (m) {\n    return parseInt(m[1], 10);\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {string|undefined} String.\n */\nexport function readString(node) {\n  return getAllTextContent(node, false).trim();\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the boolean to.\n * @param {boolean} bool Boolean.\n */\nexport function writeBooleanTextNode(node, bool) {\n  writeStringTextNode(node, (bool) ? '1' : '0');\n}\n\n\n/**\n * @param {Node} node Node to append a CDATA Section with the string to.\n * @param {string} string String.\n */\nexport function writeCDATASection(node, string) {\n  node.appendChild(DOCUMENT.createCDATASection(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the dateTime to.\n * @param {number} dateTime DateTime in seconds.\n */\nexport function writeDateTimeTextNode(node, dateTime) {\n  const date = new Date(dateTime * 1000);\n  const string = date.getUTCFullYear() + '-' +\n      padNumber(date.getUTCMonth() + 1, 2) + '-' +\n      padNumber(date.getUTCDate(), 2) + 'T' +\n      padNumber(date.getUTCHours(), 2) + ':' +\n      padNumber(date.getUTCMinutes(), 2) + ':' +\n      padNumber(date.getUTCSeconds(), 2) + 'Z';\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the decimal to.\n * @param {number} decimal Decimal.\n */\nexport function writeDecimalTextNode(node, decimal) {\n  const string = decimal.toPrecision();\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the decimal to.\n * @param {number} nonNegativeInteger Non negative integer.\n */\nexport function writeNonNegativeIntegerTextNode(node, nonNegativeInteger) {\n  const string = nonNegativeInteger.toString();\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the string to.\n * @param {string} string String.\n */\nexport function writeStringTextNode(node, string) {\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n","/**\n * @module ol/format/GML3\n */\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport {createOrUpdate} from '../extent.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport GMLBase, {GMLNS} from '../format/GMLBase.js';\nimport {readNonNegativeIntegerString, writeStringTextNode} from '../format/xsd.js';\nimport Geometry from '../geom/Geometry.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Polygon from '../geom/Polygon.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, transformExtent} from '../proj.js';\nimport {createElementNS, getAllTextContent, makeArrayPusher, makeChildAppender,\n  makeReplacer, makeSimpleNodeFactory, OBJECT_PROPERTY_NODE_FACTORY, parseNode,\n  pushParseAndPop, pushSerializeAndPop, XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n\n/**\n * @const\n * @type {string}\n * @private\n */\nconst schemaLocation = GMLNS +\n    ' http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/' +\n    '1.0.0/gmlsf.xsd';\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GML format\n * version 3.1.1.\n * Currently only supports GML 3.1.1 Simple Features profile.\n *\n * @constructor\n * @param {module:ol/format/GMLBase~Options=} opt_options\n *     Optional configuration object.\n * @extends {module:ol/format/GMLBase}\n * @api\n */\nconst GML3 = function(opt_options) {\n  const options = /** @type {module:ol/format/GMLBase~Options} */\n      (opt_options ? opt_options : {});\n\n  GMLBase.call(this, options);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.surface_ = options.surface !== undefined ? options.surface : false;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.curve_ = options.curve !== undefined ? options.curve : false;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.multiCurve_ = options.multiCurve !== undefined ?\n    options.multiCurve : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.multiSurface_ = options.multiSurface !== undefined ?\n    options.multiSurface : true;\n\n  /**\n   * @inheritDoc\n   */\n  this.schemaLocation = options.schemaLocation ?\n    options.schemaLocation : schemaLocation;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hasZ = options.hasZ !== undefined ?\n    options.hasZ : false;\n\n};\n\ninherits(GML3, GMLBase);\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {module:ol/geom/MultiLineString|undefined} MultiLineString.\n */\nGML3.prototype.readMultiCurve_ = function(node, objectStack) {\n  /** @type {Array.<module:ol/geom/LineString>} */\n  const lineStrings = pushParseAndPop([],\n    this.MULTICURVE_PARSERS_, node, objectStack, this);\n  if (lineStrings) {\n    const multiLineString = new MultiLineString(null);\n    multiLineString.setLineStrings(lineStrings);\n    return multiLineString;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {module:ol/geom/MultiPolygon|undefined} MultiPolygon.\n */\nGML3.prototype.readMultiSurface_ = function(node, objectStack) {\n  /** @type {Array.<module:ol/geom/Polygon>} */\n  const polygons = pushParseAndPop([],\n    this.MULTISURFACE_PARSERS_, node, objectStack, this);\n  if (polygons) {\n    const multiPolygon = new MultiPolygon(null);\n    multiPolygon.setPolygons(polygons);\n    return multiPolygon;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGML3.prototype.curveMemberParser_ = function(node, objectStack) {\n  parseNode(this.CURVEMEMBER_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGML3.prototype.surfaceMemberParser_ = function(node, objectStack) {\n  parseNode(this.SURFACEMEMBER_PARSERS_,\n    node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<(Array.<number>)>|undefined} flat coordinates.\n */\nGML3.prototype.readPatch_ = function(node, objectStack) {\n  return pushParseAndPop([null],\n    this.PATCHES_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<number>|undefined} flat coordinates.\n */\nGML3.prototype.readSegment_ = function(node, objectStack) {\n  return pushParseAndPop([null],\n    this.SEGMENTS_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<(Array.<number>)>|undefined} flat coordinates.\n */\nGML3.prototype.readPolygonPatch_ = function(node, objectStack) {\n  return pushParseAndPop([null],\n    this.FLAT_LINEAR_RINGS_PARSERS_, node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<number>|undefined} flat coordinates.\n */\nGML3.prototype.readLineStringSegment_ = function(node, objectStack) {\n  return pushParseAndPop([null],\n    this.GEOMETRY_FLAT_COORDINATES_PARSERS_,\n    node, objectStack, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGML3.prototype.interiorParser_ = function(node, objectStack) {\n  /** @type {Array.<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    this.RING_PARSERS, node, objectStack, this);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array.<Array.<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings.push(flatLinearRing);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGML3.prototype.exteriorParser_ = function(node, objectStack) {\n  /** @type {Array.<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    this.RING_PARSERS, node, objectStack, this);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array.<Array.<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings[0] = flatLinearRing;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {module:ol/geom/Polygon|undefined} Polygon.\n */\nGML3.prototype.readSurface_ = function(node, objectStack) {\n  /** @type {Array.<Array.<number>>} */\n  const flatLinearRings = pushParseAndPop([null],\n    this.SURFACE_PARSERS_, node, objectStack, this);\n  if (flatLinearRings && flatLinearRings[0]) {\n    const polygon = new Polygon(null);\n    const flatCoordinates = flatLinearRings[0];\n    const ends = [flatCoordinates.length];\n    let i, ii;\n    for (i = 1, ii = flatLinearRings.length; i < ii; ++i) {\n      extend(flatCoordinates, flatLinearRings[i]);\n      ends.push(flatCoordinates.length);\n    }\n    polygon.setFlatCoordinates(\n      GeometryLayout.XYZ, flatCoordinates, ends);\n    return polygon;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {module:ol/geom/LineString|undefined} LineString.\n */\nGML3.prototype.readCurve_ = function(node, objectStack) {\n  /** @type {Array.<number>} */\n  const flatCoordinates = pushParseAndPop([null],\n    this.CURVE_PARSERS_, node, objectStack, this);\n  if (flatCoordinates) {\n    const lineString = new LineString(null);\n    lineString.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates);\n    return lineString;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {module:ol/extent~Extent|undefined} Envelope.\n */\nGML3.prototype.readEnvelope_ = function(node, objectStack) {\n  /** @type {Array.<number>} */\n  const flatCoordinates = pushParseAndPop([null],\n    this.ENVELOPE_PARSERS_, node, objectStack, this);\n  return createOrUpdate(flatCoordinates[1][0],\n    flatCoordinates[1][1], flatCoordinates[2][0],\n    flatCoordinates[2][1]);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<number>|undefined} Flat coordinates.\n */\nGML3.prototype.readFlatPos_ = function(node, objectStack) {\n  let s = getAllTextContent(node, false);\n  const re = /^\\s*([+\\-]?\\d*\\.?\\d+(?:[eE][+\\-]?\\d+)?)\\s*/;\n  /** @type {Array.<number>} */\n  const flatCoordinates = [];\n  let m;\n  while ((m = re.exec(s))) {\n    flatCoordinates.push(parseFloat(m[1]));\n    s = s.substr(m[0].length);\n  }\n  if (s !== '') {\n    return undefined;\n  }\n  const context = objectStack[0];\n  const containerSrs = context['srsName'];\n  let axisOrientation = 'enu';\n  if (containerSrs) {\n    const proj = getProjection(containerSrs);\n    axisOrientation = proj.getAxisOrientation();\n  }\n  if (axisOrientation === 'neu') {\n    let i, ii;\n    for (i = 0, ii = flatCoordinates.length; i < ii; i += 3) {\n      const y = flatCoordinates[i];\n      const x = flatCoordinates[i + 1];\n      flatCoordinates[i] = x;\n      flatCoordinates[i + 1] = y;\n    }\n  }\n  const len = flatCoordinates.length;\n  if (len == 2) {\n    flatCoordinates.push(0);\n  }\n  if (len === 0) {\n    return undefined;\n  }\n  return flatCoordinates;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<number>|undefined} Flat coordinates.\n */\nGML3.prototype.readFlatPosList_ = function(node, objectStack) {\n  const s = getAllTextContent(node, false).replace(/^\\s*|\\s*$/g, '');\n  const context = objectStack[0];\n  const containerSrs = context['srsName'];\n  const contextDimension = context['srsDimension'];\n  let axisOrientation = 'enu';\n  if (containerSrs) {\n    const proj = getProjection(containerSrs);\n    axisOrientation = proj.getAxisOrientation();\n  }\n  const coords = s.split(/\\s+/);\n  // The \"dimension\" attribute is from the GML 3.0.1 spec.\n  let dim = 2;\n  if (node.getAttribute('srsDimension')) {\n    dim = readNonNegativeIntegerString(\n      node.getAttribute('srsDimension'));\n  } else if (node.getAttribute('dimension')) {\n    dim = readNonNegativeIntegerString(\n      node.getAttribute('dimension'));\n  } else if (node.parentNode.getAttribute('srsDimension')) {\n    dim = readNonNegativeIntegerString(\n      node.parentNode.getAttribute('srsDimension'));\n  } else if (contextDimension) {\n    dim = readNonNegativeIntegerString(contextDimension);\n  }\n  let x, y, z;\n  const flatCoordinates = [];\n  for (let i = 0, ii = coords.length; i < ii; i += dim) {\n    x = parseFloat(coords[i]);\n    y = parseFloat(coords[i + 1]);\n    z = (dim === 3) ? parseFloat(coords[i + 2]) : 0;\n    if (axisOrientation.substr(0, 2) === 'en') {\n      flatCoordinates.push(x, y, z);\n    } else {\n      flatCoordinates.push(y, x, z);\n    }\n  }\n  return flatCoordinates;\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'pos': makeReplacer(GML3.prototype.readFlatPos_),\n    'posList': makeReplacer(GML3.prototype.readFlatPosList_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.FLAT_LINEAR_RINGS_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'interior': GML3.prototype.interiorParser_,\n    'exterior': GML3.prototype.exteriorParser_\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.GEOMETRY_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'Point': makeReplacer(GMLBase.prototype.readPoint),\n    'MultiPoint': makeReplacer(\n      GMLBase.prototype.readMultiPoint),\n    'LineString': makeReplacer(\n      GMLBase.prototype.readLineString),\n    'MultiLineString': makeReplacer(\n      GMLBase.prototype.readMultiLineString),\n    'LinearRing': makeReplacer(\n      GMLBase.prototype.readLinearRing),\n    'Polygon': makeReplacer(GMLBase.prototype.readPolygon),\n    'MultiPolygon': makeReplacer(\n      GMLBase.prototype.readMultiPolygon),\n    'Surface': makeReplacer(GML3.prototype.readSurface_),\n    'MultiSurface': makeReplacer(\n      GML3.prototype.readMultiSurface_),\n    'Curve': makeReplacer(GML3.prototype.readCurve_),\n    'MultiCurve': makeReplacer(\n      GML3.prototype.readMultiCurve_),\n    'Envelope': makeReplacer(GML3.prototype.readEnvelope_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.MULTICURVE_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'curveMember': makeArrayPusher(\n      GML3.prototype.curveMemberParser_),\n    'curveMembers': makeArrayPusher(\n      GML3.prototype.curveMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.MULTISURFACE_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'surfaceMember': makeArrayPusher(\n      GML3.prototype.surfaceMemberParser_),\n    'surfaceMembers': makeArrayPusher(\n      GML3.prototype.surfaceMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.CURVEMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'LineString': makeArrayPusher(\n      GMLBase.prototype.readLineString),\n    'Curve': makeArrayPusher(GML3.prototype.readCurve_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.SURFACEMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'Polygon': makeArrayPusher(GMLBase.prototype.readPolygon),\n    'Surface': makeArrayPusher(GML3.prototype.readSurface_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.SURFACE_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'patches': makeReplacer(GML3.prototype.readPatch_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.CURVE_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'segments': makeReplacer(GML3.prototype.readSegment_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.ENVELOPE_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'lowerCorner': makeArrayPusher(\n      GML3.prototype.readFlatPosList_),\n    'upperCorner': makeArrayPusher(\n      GML3.prototype.readFlatPosList_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.PATCHES_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'PolygonPatch': makeReplacer(\n      GML3.prototype.readPolygonPatch_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML3.prototype.SEGMENTS_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'LineStringSegment': makeReplacer(\n      GML3.prototype.readLineStringSegment_)\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Point} value Point geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writePos_ = function(node, value, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsDimension = hasZ ? 3 : 2;\n  node.setAttribute('srsDimension', srsDimension);\n  const srsName = context['srsName'];\n  let axisOrientation = 'enu';\n  if (srsName) {\n    axisOrientation = getProjection(srsName).getAxisOrientation();\n  }\n  const point = value.getCoordinates();\n  let coords;\n  // only 2d for simple features profile\n  if (axisOrientation.substr(0, 2) === 'en') {\n    coords = (point[0] + ' ' + point[1]);\n  } else {\n    coords = (point[1] + ' ' + point[0]);\n  }\n  if (hasZ) {\n    // For newly created points, Z can be undefined.\n    const z = point[2] || 0;\n    coords += ' ' + z;\n  }\n  writeStringTextNode(node, coords);\n};\n\n\n/**\n * @param {Array.<number>} point Point geometry.\n * @param {string=} opt_srsName Optional srsName\n * @param {boolean=} opt_hasZ whether the geometry has a Z coordinate (is 3D) or not.\n * @return {string} The coords string.\n * @private\n */\nGML3.prototype.getCoords_ = function(point, opt_srsName, opt_hasZ) {\n  let axisOrientation = 'enu';\n  if (opt_srsName) {\n    axisOrientation = getProjection(opt_srsName).getAxisOrientation();\n  }\n  let coords = ((axisOrientation.substr(0, 2) === 'en') ?\n    point[0] + ' ' + point[1] :\n    point[1] + ' ' + point[0]);\n  if (opt_hasZ) {\n    // For newly created points, Z can be undefined.\n    const z = point[2] || 0;\n    coords += ' ' + z;\n  }\n\n  return coords;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString|module:ol/geom/LinearRing} value Geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writePosList_ = function(node, value, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsDimension = hasZ ? 3 : 2;\n  node.setAttribute('srsDimension', srsDimension);\n  const srsName = context['srsName'];\n  // only 2d for simple features profile\n  const points = value.getCoordinates();\n  const len = points.length;\n  const parts = new Array(len);\n  let point;\n  for (let i = 0; i < len; ++i) {\n    point = points[i];\n    parts[i] = this.getCoords_(point, srsName, hasZ);\n  }\n  writeStringTextNode(node, parts.join(' '));\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Point} geometry Point geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writePoint_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const pos = createElementNS(node.namespaceURI, 'pos');\n  node.appendChild(pos);\n  this.writePos_(pos, geometry, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<*>} objectStack Node stack.\n */\nGML3.prototype.writeEnvelope = function(node, extent, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const keys = ['lowerCorner', 'upperCorner'];\n  const values = [extent[0] + ' ' + extent[1], extent[2] + ' ' + extent[3]];\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    ({node: node}), this.ENVELOPE_SERIALIZERS_,\n    OBJECT_PROPERTY_NODE_FACTORY,\n    values,\n    objectStack, keys, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LinearRing} geometry LinearRing geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeLinearRing_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const posList = createElementNS(node.namespaceURI, 'posList');\n  node.appendChild(posList);\n  this.writePosList_(posList, geometry, objectStack);\n};\n\n\n/**\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node} Node.\n * @private\n */\nGML3.prototype.RING_NODE_FACTORY_ = function(value, objectStack, opt_nodeName) {\n  const context = objectStack[objectStack.length - 1];\n  const parentNode = context.node;\n  const exteriorWritten = context['exteriorWritten'];\n  if (exteriorWritten === undefined) {\n    context['exteriorWritten'] = true;\n  }\n  return createElementNS(parentNode.namespaceURI,\n    exteriorWritten !== undefined ? 'interior' : 'exterior');\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Polygon} geometry Polygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeSurfaceOrPolygon_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  if (node.nodeName !== 'PolygonPatch' && srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  if (node.nodeName === 'Polygon' || node.nodeName === 'PolygonPatch') {\n    const rings = geometry.getLinearRings();\n    pushSerializeAndPop(\n      {node: node, hasZ: hasZ, srsName: srsName},\n      this.RING_SERIALIZERS_,\n      this.RING_NODE_FACTORY_,\n      rings, objectStack, undefined, this);\n  } else if (node.nodeName === 'Surface') {\n    const patches = createElementNS(node.namespaceURI, 'patches');\n    node.appendChild(patches);\n    this.writeSurfacePatches_(\n      patches, geometry, objectStack);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString} geometry LineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeCurveOrLineString_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  if (node.nodeName !== 'LineStringSegment' && srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  if (node.nodeName === 'LineString' ||\n      node.nodeName === 'LineStringSegment') {\n    const posList = createElementNS(node.namespaceURI, 'posList');\n    node.appendChild(posList);\n    this.writePosList_(posList, geometry, objectStack);\n  } else if (node.nodeName === 'Curve') {\n    const segments = createElementNS(node.namespaceURI, 'segments');\n    node.appendChild(segments);\n    this.writeCurveSegments_(segments,\n      geometry, objectStack);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/MultiPolygon} geometry MultiPolygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeMultiSurfaceOrPolygon_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  const surface = context['surface'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const polygons = geometry.getPolygons();\n  pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName, surface: surface},\n    this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,\n    this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_, polygons,\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/MultiPoint} geometry MultiPoint geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeMultiPoint_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  const hasZ = context['hasZ'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const points = geometry.getPoints();\n  pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName},\n    this.POINTMEMBER_SERIALIZERS_,\n    makeSimpleNodeFactory('pointMember'), points,\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/MultiLineString} geometry MultiLineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeMultiCurveOrLineString_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  const curve = context['curve'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const lines = geometry.getLineStrings();\n  pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName, curve: curve},\n    this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,\n    this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_, lines,\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LinearRing} ring LinearRing geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeRing_ = function(node, ring, objectStack) {\n  const linearRing = createElementNS(node.namespaceURI, 'LinearRing');\n  node.appendChild(linearRing);\n  this.writeLinearRing_(linearRing, ring, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Polygon} polygon Polygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeSurfaceOrPolygonMember_ = function(node, polygon, objectStack) {\n  const child = this.GEOMETRY_NODE_FACTORY_(\n    polygon, objectStack);\n  if (child) {\n    node.appendChild(child);\n    this.writeSurfaceOrPolygon_(child, polygon, objectStack);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Point} point Point geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writePointMember_ = function(node, point, objectStack) {\n  const child = createElementNS(node.namespaceURI, 'Point');\n  node.appendChild(child);\n  this.writePoint_(child, point, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString} line LineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeLineStringOrCurveMember_ = function(node, line, objectStack) {\n  const child = this.GEOMETRY_NODE_FACTORY_(line, objectStack);\n  if (child) {\n    node.appendChild(child);\n    this.writeCurveOrLineString_(child, line, objectStack);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Polygon} polygon Polygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeSurfacePatches_ = function(node, polygon, objectStack) {\n  const child = createElementNS(node.namespaceURI, 'PolygonPatch');\n  node.appendChild(child);\n  this.writeSurfaceOrPolygon_(child, polygon, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString} line LineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeCurveSegments_ = function(node, line, objectStack) {\n  const child = createElementNS(node.namespaceURI,\n    'LineStringSegment');\n  node.appendChild(child);\n  this.writeCurveOrLineString_(child, line, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Geometry|module:ol/extent~Extent} geometry Geometry.\n * @param {Array.<*>} objectStack Node stack.\n */\nGML3.prototype.writeGeometryElement = function(node, geometry, objectStack) {\n  const context = /** @type {module:ol/format/Feature~WriteOptions} */ (objectStack[objectStack.length - 1]);\n  const item = assign({}, context);\n  item.node = node;\n  let value;\n  if (Array.isArray(geometry)) {\n    if (context.dataProjection) {\n      value = transformExtent(\n        geometry, context.featureProjection, context.dataProjection);\n    } else {\n      value = geometry;\n    }\n  } else {\n    value = transformWithOptions(/** @type {module:ol/geom/Geometry} */ (geometry), true, context);\n  }\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    (item), this.GEOMETRY_SERIALIZERS_,\n    this.GEOMETRY_NODE_FACTORY_, [value],\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Node stack.\n */\nGML3.prototype.writeFeatureElement = function(node, feature, objectStack) {\n  const fid = feature.getId();\n  if (fid) {\n    node.setAttribute('fid', fid);\n  }\n  const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const featureNS = context['featureNS'];\n  const geometryName = feature.getGeometryName();\n  if (!context.serializers) {\n    context.serializers = {};\n    context.serializers[featureNS] = {};\n  }\n  const properties = feature.getProperties();\n  const keys = [];\n  const values = [];\n  for (const key in properties) {\n    const value = properties[key];\n    if (value !== null) {\n      keys.push(key);\n      values.push(value);\n      if (key == geometryName || value instanceof Geometry) {\n        if (!(key in context.serializers[featureNS])) {\n          context.serializers[featureNS][key] = makeChildAppender(\n            this.writeGeometryElement, this);\n        }\n      } else {\n        if (!(key in context.serializers[featureNS])) {\n          context.serializers[featureNS][key] = makeChildAppender(writeStringTextNode);\n        }\n      }\n    }\n  }\n  const item = assign({}, context);\n  item.node = node;\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    (item), context.serializers,\n    makeSimpleNodeFactory(undefined, featureNS),\n    values,\n    objectStack, keys);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML3.prototype.writeFeatureMembers_ = function(node, features, objectStack) {\n  const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const featureType = context['featureType'];\n  const featureNS = context['featureNS'];\n  const serializers = {};\n  serializers[featureNS] = {};\n  serializers[featureNS][featureType] = makeChildAppender(\n    this.writeFeatureElement, this);\n  const item = assign({}, context);\n  item.node = node;\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    (item),\n    serializers,\n    makeSimpleNodeFactory(featureType, featureNS), features,\n    objectStack);\n};\n\n\n/**\n * @const\n * @type {Object.<string, string>}\n */\nconst MULTIGEOMETRY_TO_MEMBER_NODENAME = {\n  'MultiLineString': 'lineStringMember',\n  'MultiCurve': 'curveMember',\n  'MultiPolygon': 'polygonMember',\n  'MultiSurface': 'surfaceMember'\n};\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n * @private\n */\nGML3.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_ = function(value, objectStack, opt_nodeName) {\n  const parentNode = objectStack[objectStack.length - 1].node;\n  return createElementNS('http://www.opengis.net/gml',\n    MULTIGEOMETRY_TO_MEMBER_NODENAME[parentNode.nodeName]);\n};\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n * @private\n */\nGML3.prototype.GEOMETRY_NODE_FACTORY_ = function(value, objectStack, opt_nodeName) {\n  const context = objectStack[objectStack.length - 1];\n  const multiSurface = context['multiSurface'];\n  const surface = context['surface'];\n  const curve = context['curve'];\n  const multiCurve = context['multiCurve'];\n  let nodeName;\n  if (!Array.isArray(value)) {\n    nodeName = /** @type {module:ol/geom/Geometry} */ (value).getType();\n    if (nodeName === 'MultiPolygon' && multiSurface === true) {\n      nodeName = 'MultiSurface';\n    } else if (nodeName === 'Polygon' && surface === true) {\n      nodeName = 'Surface';\n    } else if (nodeName === 'LineString' && curve === true) {\n      nodeName = 'Curve';\n    } else if (nodeName === 'MultiLineString' && multiCurve === true) {\n      nodeName = 'MultiCurve';\n    }\n  } else {\n    nodeName = 'Envelope';\n  }\n  return createElementNS('http://www.opengis.net/gml',\n    nodeName);\n};\n\n\n/**\n * Encode a geometry in GML 3.1.1 Simple Features.\n *\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {Node} Node.\n * @override\n * @api\n */\nGML3.prototype.writeGeometryNode = function(geometry, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  const geom = createElementNS('http://www.opengis.net/gml', 'geom');\n  const context = {node: geom, hasZ: this.hasZ, srsName: this.srsName,\n    curve: this.curve_, surface: this.surface_,\n    multiSurface: this.multiSurface_, multiCurve: this.multiCurve_};\n  if (opt_options) {\n    assign(context, opt_options);\n  }\n  this.writeGeometryElement(geom, geometry, [context]);\n  return geom;\n};\n\n\n/**\n * Encode an array of features in GML 3.1.1 Simple Features.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {string} Result.\n * @api\n */\nGML3.prototype.writeFeatures;\n\n\n/**\n * Encode an array of features in the GML 3.1.1 format as an XML node.\n *\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {Node} Node.\n * @override\n * @api\n */\nGML3.prototype.writeFeaturesNode = function(features, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  const node = createElementNS('http://www.opengis.net/gml', 'featureMembers');\n  node.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', this.schemaLocation);\n  const context = {\n    srsName: this.srsName,\n    hasZ: this.hasZ,\n    curve: this.curve_,\n    surface: this.surface_,\n    multiSurface: this.multiSurface_,\n    multiCurve: this.multiCurve_,\n    featureNS: this.featureNS,\n    featureType: this.featureType\n  };\n  if (opt_options) {\n    assign(context, opt_options);\n  }\n  this.writeFeatureMembers_(node, features, [context]);\n  return node;\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML3.prototype.RING_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'exterior': makeChildAppender(GML3.prototype.writeRing_),\n    'interior': makeChildAppender(GML3.prototype.writeRing_)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML3.prototype.ENVELOPE_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'lowerCorner': makeChildAppender(writeStringTextNode),\n    'upperCorner': makeChildAppender(writeStringTextNode)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML3.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'surfaceMember': makeChildAppender(\n      GML3.prototype.writeSurfaceOrPolygonMember_),\n    'polygonMember': makeChildAppender(\n      GML3.prototype.writeSurfaceOrPolygonMember_)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML3.prototype.POINTMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'pointMember': makeChildAppender(\n      GML3.prototype.writePointMember_)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML3.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'lineStringMember': makeChildAppender(\n      GML3.prototype.writeLineStringOrCurveMember_),\n    'curveMember': makeChildAppender(\n      GML3.prototype.writeLineStringOrCurveMember_)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML3.prototype.GEOMETRY_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'Curve': makeChildAppender(\n      GML3.prototype.writeCurveOrLineString_),\n    'MultiCurve': makeChildAppender(\n      GML3.prototype.writeMultiCurveOrLineString_),\n    'Point': makeChildAppender(GML3.prototype.writePoint_),\n    'MultiPoint': makeChildAppender(\n      GML3.prototype.writeMultiPoint_),\n    'LineString': makeChildAppender(\n      GML3.prototype.writeCurveOrLineString_),\n    'MultiLineString': makeChildAppender(\n      GML3.prototype.writeMultiCurveOrLineString_),\n    'LinearRing': makeChildAppender(\n      GML3.prototype.writeLinearRing_),\n    'Polygon': makeChildAppender(\n      GML3.prototype.writeSurfaceOrPolygon_),\n    'MultiPolygon': makeChildAppender(\n      GML3.prototype.writeMultiSurfaceOrPolygon_),\n    'Surface': makeChildAppender(\n      GML3.prototype.writeSurfaceOrPolygon_),\n    'MultiSurface': makeChildAppender(\n      GML3.prototype.writeMultiSurfaceOrPolygon_),\n    'Envelope': makeChildAppender(\n      GML3.prototype.writeEnvelope)\n  }\n};\n\n\nexport default GML3;\n","/**\n * @module ol/format/GML\n */\nimport GML3 from '../format/GML3.js';\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GML format\n * version 3.1.1.\n * Currently only supports GML 3.1.1 Simple Features profile.\n *\n * @constructor\n * @param {module:ol/format/GMLBase~Options=} opt_options\n *     Optional configuration object.\n * @extends {module:ol/format/GMLBase}\n * @api\n */\nconst GML = GML3;\n\n\n/**\n * Encode an array of features in GML 3.1.1 Simple Features.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {string} Result.\n * @api\n */\nGML.prototype.writeFeatures;\n\n\n/**\n * Encode an array of features in the GML 3.1.1 format as an XML node.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {Node} Node.\n * @api\n */\nGML.prototype.writeFeaturesNode;\n\nexport default GML;\n","/**\n * @module ol/format/GML2\n */\nimport {inherits} from '../index.js';\nimport {createOrUpdate} from '../extent.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport GMLBase, {GMLNS} from '../format/GMLBase.js';\nimport {writeStringTextNode} from '../format/xsd.js';\nimport Geometry from '../geom/Geometry.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, transformExtent} from '../proj.js';\nimport {createElementNS, getAllTextContent, makeArrayPusher, makeChildAppender,\n  makeReplacer, makeSimpleNodeFactory, OBJECT_PROPERTY_NODE_FACTORY, pushParseAndPop, pushSerializeAndPop} from '../xml.js';\n\n\n/**\n * @const\n * @type {string}\n */\nconst schemaLocation = GMLNS + ' http://schemas.opengis.net/gml/2.1.2/feature.xsd';\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GML format,\n * version 2.1.2.\n *\n * @constructor\n * @param {module:ol/format/GMLBase~Options=} opt_options Optional configuration object.\n * @extends {module:ol/format/GMLBase}\n * @api\n */\nconst GML2 = function(opt_options) {\n  const options = /** @type {module:ol/format/GMLBase~Options} */\n      (opt_options ? opt_options : {});\n\n  GMLBase.call(this, options);\n\n  this.FEATURE_COLLECTION_PARSERS[GMLNS][\n    'featureMember'] =\n      makeArrayPusher(GMLBase.prototype.readFeaturesInternal);\n\n  /**\n   * @inheritDoc\n   */\n  this.schemaLocation = options.schemaLocation ?\n    options.schemaLocation : schemaLocation;\n\n};\n\ninherits(GML2, GMLBase);\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<number>|undefined} Flat coordinates.\n */\nGML2.prototype.readFlatCoordinates_ = function(node, objectStack) {\n  const s = getAllTextContent(node, false).replace(/^\\s*|\\s*$/g, '');\n  const context = /** @type {module:ol/xml~NodeStackItem} */ (objectStack[0]);\n  const containerSrs = context['srsName'];\n  let axisOrientation = 'enu';\n  if (containerSrs) {\n    const proj = getProjection(containerSrs);\n    if (proj) {\n      axisOrientation = proj.getAxisOrientation();\n    }\n  }\n  const coordsGroups = s.trim().split(/\\s+/);\n  const flatCoordinates = [];\n  for (let i = 0, ii = coordsGroups.length; i < ii; i++) {\n    const coords = coordsGroups[i].split(/,+/);\n    const x = parseFloat(coords[0]);\n    const y = parseFloat(coords[1]);\n    const z = (coords.length === 3) ? parseFloat(coords[2]) : 0;\n    if (axisOrientation.substr(0, 2) === 'en') {\n      flatCoordinates.push(x, y, z);\n    } else {\n      flatCoordinates.push(y, x, z);\n    }\n  }\n  return flatCoordinates;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {module:ol/extent~Extent|undefined} Envelope.\n */\nGML2.prototype.readBox_ = function(node, objectStack) {\n  /** @type {Array.<number>} */\n  const flatCoordinates = pushParseAndPop([null],\n    this.BOX_PARSERS_, node, objectStack, this);\n  return createOrUpdate(flatCoordinates[1][0],\n    flatCoordinates[1][1], flatCoordinates[1][3],\n    flatCoordinates[1][4]);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGML2.prototype.innerBoundaryIsParser_ = function(node, objectStack) {\n  /** @type {Array.<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    this.RING_PARSERS, node, objectStack, this);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array.<Array.<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings.push(flatLinearRing);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nGML2.prototype.outerBoundaryIsParser_ = function(node, objectStack) {\n  /** @type {Array.<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    this.RING_PARSERS, node, objectStack, this);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array.<Array.<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings[0] = flatLinearRing;\n  }\n};\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n * @private\n */\nGML2.prototype.GEOMETRY_NODE_FACTORY_ = function(value, objectStack, opt_nodeName) {\n  const context = objectStack[objectStack.length - 1];\n  const multiSurface = context['multiSurface'];\n  const surface = context['surface'];\n  const multiCurve = context['multiCurve'];\n  let nodeName;\n  if (!Array.isArray(value)) {\n    nodeName = /** @type {module:ol/geom/Geometry} */ (value).getType();\n    if (nodeName === 'MultiPolygon' && multiSurface === true) {\n      nodeName = 'MultiSurface';\n    } else if (nodeName === 'Polygon' && surface === true) {\n      nodeName = 'Surface';\n    } else if (nodeName === 'MultiLineString' && multiCurve === true) {\n      nodeName = 'MultiCurve';\n    }\n  } else {\n    nodeName = 'Envelope';\n  }\n  return createElementNS('http://www.opengis.net/gml',\n    nodeName);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Node stack.\n */\nGML2.prototype.writeFeatureElement = function(node, feature, objectStack) {\n  const fid = feature.getId();\n  if (fid) {\n    node.setAttribute('fid', fid);\n  }\n  const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const featureNS = context['featureNS'];\n  const geometryName = feature.getGeometryName();\n  if (!context.serializers) {\n    context.serializers = {};\n    context.serializers[featureNS] = {};\n  }\n  const properties = feature.getProperties();\n  const keys = [];\n  const values = [];\n  for (const key in properties) {\n    const value = properties[key];\n    if (value !== null) {\n      keys.push(key);\n      values.push(value);\n      if (key == geometryName || value instanceof Geometry) {\n        if (!(key in context.serializers[featureNS])) {\n          context.serializers[featureNS][key] = makeChildAppender(\n            this.writeGeometryElement, this);\n        }\n      } else {\n        if (!(key in context.serializers[featureNS])) {\n          context.serializers[featureNS][key] = makeChildAppender(writeStringTextNode);\n        }\n      }\n    }\n  }\n  const item = assign({}, context);\n  item.node = node;\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    (item), context.serializers,\n    makeSimpleNodeFactory(undefined, featureNS),\n    values,\n    objectStack, keys);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString} geometry LineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeCurveOrLineString_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  if (node.nodeName !== 'LineStringSegment' && srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  if (node.nodeName === 'LineString' ||\n      node.nodeName === 'LineStringSegment') {\n    const coordinates = this.createCoordinatesNode_(node.namespaceURI);\n    node.appendChild(coordinates);\n    this.writeCoordinates_(coordinates, geometry, objectStack);\n  } else if (node.nodeName === 'Curve') {\n    const segments = createElementNS(node.namespaceURI, 'segments');\n    node.appendChild(segments);\n    this.writeCurveSegments_(segments,\n      geometry, objectStack);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString} line LineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeLineStringOrCurveMember_ = function(node, line, objectStack) {\n  const child = this.GEOMETRY_NODE_FACTORY_(line, objectStack);\n  if (child) {\n    node.appendChild(child);\n    this.writeCurveOrLineString_(child, line, objectStack);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/MultiLineString} geometry MultiLineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeMultiCurveOrLineString_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  const curve = context['curve'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const lines = geometry.getLineStrings();\n  pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName, curve: curve},\n    this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,\n    this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_, lines,\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Geometry|module:ol/extent~Extent} geometry Geometry.\n * @param {Array.<*>} objectStack Node stack.\n */\nGML2.prototype.writeGeometryElement = function(node, geometry, objectStack) {\n  const context = /** @type {module:ol/format/Feature~WriteOptions} */ (objectStack[objectStack.length - 1]);\n  const item = assign({}, context);\n  item.node = node;\n  let value;\n  if (Array.isArray(geometry)) {\n    if (context.dataProjection) {\n      value = transformExtent(\n        geometry, context.featureProjection, context.dataProjection);\n    } else {\n      value = geometry;\n    }\n  } else {\n    value = transformWithOptions(/** @type {module:ol/geom/Geometry} */ (geometry), true, context);\n  }\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    (item), this.GEOMETRY_SERIALIZERS_,\n    this.GEOMETRY_NODE_FACTORY_, [value],\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {string} namespaceURI XML namespace.\n * @returns {Node} coordinates node.\n * @private\n */\nGML2.prototype.createCoordinatesNode_ = function(namespaceURI) {\n  const coordinates = createElementNS(namespaceURI, 'coordinates');\n  coordinates.setAttribute('decimal', '.');\n  coordinates.setAttribute('cs', ',');\n  coordinates.setAttribute('ts', ' ');\n\n  return coordinates;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString|module:ol/geom/LinearRing} value Geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeCoordinates_ = function(node, value, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  // only 2d for simple features profile\n  const points = value.getCoordinates();\n  const len = points.length;\n  const parts = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    const point = points[i];\n    parts[i] = this.getCoords_(point, srsName, hasZ);\n  }\n  writeStringTextNode(node, parts.join(' '));\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString} line LineString geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeCurveSegments_ = function(node, line, objectStack) {\n  const child = createElementNS(node.namespaceURI, 'LineStringSegment');\n  node.appendChild(child);\n  this.writeCurveOrLineString_(child, line, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Polygon} geometry Polygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeSurfaceOrPolygon_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  if (node.nodeName !== 'PolygonPatch' && srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  if (node.nodeName === 'Polygon' || node.nodeName === 'PolygonPatch') {\n    const rings = geometry.getLinearRings();\n    pushSerializeAndPop(\n      {node: node, hasZ: hasZ, srsName: srsName},\n      this.RING_SERIALIZERS_,\n      this.RING_NODE_FACTORY_,\n      rings, objectStack, undefined, this);\n  } else if (node.nodeName === 'Surface') {\n    const patches = createElementNS(node.namespaceURI, 'patches');\n    node.appendChild(patches);\n    this.writeSurfacePatches_(\n      patches, geometry, objectStack);\n  }\n};\n\n\n/**\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node} Node.\n * @private\n */\nGML2.prototype.RING_NODE_FACTORY_ = function(value, objectStack, opt_nodeName) {\n  const context = objectStack[objectStack.length - 1];\n  const parentNode = context.node;\n  const exteriorWritten = context['exteriorWritten'];\n  if (exteriorWritten === undefined) {\n    context['exteriorWritten'] = true;\n  }\n  return createElementNS(parentNode.namespaceURI,\n    exteriorWritten !== undefined ? 'innerBoundaryIs' : 'outerBoundaryIs');\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Polygon} polygon Polygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeSurfacePatches_ = function(node, polygon, objectStack) {\n  const child = createElementNS(node.namespaceURI, 'PolygonPatch');\n  node.appendChild(child);\n  this.writeSurfaceOrPolygon_(child, polygon, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LinearRing} ring LinearRing geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeRing_ = function(node, ring, objectStack) {\n  const linearRing = createElementNS(node.namespaceURI, 'LinearRing');\n  node.appendChild(linearRing);\n  this.writeLinearRing_(linearRing, ring, objectStack);\n};\n\n\n/**\n * @param {Array.<number>} point Point geometry.\n * @param {string=} opt_srsName Optional srsName\n * @param {boolean=} opt_hasZ whether the geometry has a Z coordinate (is 3D) or not.\n * @return {string} The coords string.\n * @private\n */\nGML2.prototype.getCoords_ = function(point, opt_srsName, opt_hasZ) {\n  let axisOrientation = 'enu';\n  if (opt_srsName) {\n    axisOrientation = getProjection(opt_srsName).getAxisOrientation();\n  }\n  let coords = ((axisOrientation.substr(0, 2) === 'en') ?\n    point[0] + ',' + point[1] :\n    point[1] + ',' + point[0]);\n  if (opt_hasZ) {\n    // For newly created points, Z can be undefined.\n    const z = point[2] || 0;\n    coords += ',' + z;\n  }\n\n  return coords;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Point} geometry Point geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writePoint_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const coordinates = this.createCoordinatesNode_(node.namespaceURI);\n  node.appendChild(coordinates);\n  const point = geometry.getCoordinates();\n  const coord = this.getCoords_(point, srsName, hasZ);\n  writeStringTextNode(coordinates, coord);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/MultiPoint} geometry MultiPoint geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeMultiPoint_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const points = geometry.getPoints();\n  pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName},\n    this.POINTMEMBER_SERIALIZERS_,\n    makeSimpleNodeFactory('pointMember'), points,\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Point} point Point geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writePointMember_ = function(node, point, objectStack) {\n  const child = createElementNS(node.namespaceURI, 'Point');\n  node.appendChild(child);\n  this.writePoint_(child, point, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LinearRing} geometry LinearRing geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeLinearRing_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const coordinates = this.createCoordinatesNode_(node.namespaceURI);\n  node.appendChild(coordinates);\n  this.writeCoordinates_(coordinates, geometry, objectStack);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/MultiPolygon} geometry MultiPolygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeMultiSurfaceOrPolygon_ = function(node, geometry, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const hasZ = context['hasZ'];\n  const srsName = context['srsName'];\n  const surface = context['surface'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const polygons = geometry.getPolygons();\n  pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName, surface: surface},\n    this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,\n    this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_, polygons,\n    objectStack, undefined, this);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Polygon} polygon Polygon geometry.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeSurfaceOrPolygonMember_ = function(node, polygon, objectStack) {\n  const child = this.GEOMETRY_NODE_FACTORY_(\n    polygon, objectStack);\n  if (child) {\n    node.appendChild(child);\n    this.writeSurfaceOrPolygon_(child, polygon, objectStack);\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<*>} objectStack Node stack.\n * @private\n */\nGML2.prototype.writeEnvelope = function(node, extent, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const srsName = context['srsName'];\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  const keys = ['lowerCorner', 'upperCorner'];\n  const values = [extent[0] + ' ' + extent[1], extent[2] + ' ' + extent[3]];\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    ({node: node}), this.ENVELOPE_SERIALIZERS_,\n    OBJECT_PROPERTY_NODE_FACTORY,\n    values,\n    objectStack, keys, this);\n};\n\n\n/**\n * @const\n * @type {Object.<string, string>}\n */\nconst MULTIGEOMETRY_TO_MEMBER_NODENAME = {\n  'MultiLineString': 'lineStringMember',\n  'MultiCurve': 'curveMember',\n  'MultiPolygon': 'polygonMember',\n  'MultiSurface': 'surfaceMember'\n};\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n * @private\n */\nGML2.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_ = function(value, objectStack, opt_nodeName) {\n  const parentNode = objectStack[objectStack.length - 1].node;\n  return createElementNS('http://www.opengis.net/gml',\n    MULTIGEOMETRY_TO_MEMBER_NODENAME[parentNode.nodeName]);\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML2.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'coordinates': makeReplacer(GML2.prototype.readFlatCoordinates_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML2.prototype.FLAT_LINEAR_RINGS_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'innerBoundaryIs': GML2.prototype.innerBoundaryIsParser_,\n    'outerBoundaryIs': GML2.prototype.outerBoundaryIsParser_\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML2.prototype.BOX_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'coordinates': makeArrayPusher(\n      GML2.prototype.readFlatCoordinates_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n * @private\n */\nGML2.prototype.GEOMETRY_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'Point': makeReplacer(GMLBase.prototype.readPoint),\n    'MultiPoint': makeReplacer(\n      GMLBase.prototype.readMultiPoint),\n    'LineString': makeReplacer(\n      GMLBase.prototype.readLineString),\n    'MultiLineString': makeReplacer(\n      GMLBase.prototype.readMultiLineString),\n    'LinearRing': makeReplacer(\n      GMLBase.prototype.readLinearRing),\n    'Polygon': makeReplacer(GMLBase.prototype.readPolygon),\n    'MultiPolygon': makeReplacer(\n      GMLBase.prototype.readMultiPolygon),\n    'Box': makeReplacer(GML2.prototype.readBox_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML2.prototype.GEOMETRY_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'Curve': makeChildAppender(\n      GML2.prototype.writeCurveOrLineString_),\n    'MultiCurve': makeChildAppender(\n      GML2.prototype.writeMultiCurveOrLineString_),\n    'Point': makeChildAppender(GML2.prototype.writePoint_),\n    'MultiPoint': makeChildAppender(\n      GML2.prototype.writeMultiPoint_),\n    'LineString': makeChildAppender(\n      GML2.prototype.writeCurveOrLineString_),\n    'MultiLineString': makeChildAppender(\n      GML2.prototype.writeMultiCurveOrLineString_),\n    'LinearRing': makeChildAppender(\n      GML2.prototype.writeLinearRing_),\n    'Polygon': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygon_),\n    'MultiPolygon': makeChildAppender(\n      GML2.prototype.writeMultiSurfaceOrPolygon_),\n    'Surface': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygon_),\n    'MultiSurface': makeChildAppender(\n      GML2.prototype.writeMultiSurfaceOrPolygon_),\n    'Envelope': makeChildAppender(\n      GML2.prototype.writeEnvelope)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML2.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'lineStringMember': makeChildAppender(\n      GML2.prototype.writeLineStringOrCurveMember_),\n    'curveMember': makeChildAppender(\n      GML2.prototype.writeLineStringOrCurveMember_)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML2.prototype.RING_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'outerBoundaryIs': makeChildAppender(GML2.prototype.writeRing_),\n    'innerBoundaryIs': makeChildAppender(GML2.prototype.writeRing_)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML2.prototype.POINTMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'pointMember': makeChildAppender(\n      GML2.prototype.writePointMember_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML2.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'surfaceMember': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygonMember_),\n    'polygonMember': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygonMember_)\n  }\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n * @private\n */\nGML2.prototype.ENVELOPE_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'lowerCorner': makeChildAppender(writeStringTextNode),\n    'upperCorner': makeChildAppender(writeStringTextNode)\n  }\n};\n\nexport default GML2;\n","/**\n * @module ol/format/GPX\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport {includes} from '../array.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport XMLFeature from '../format/XMLFeature.js';\nimport {readString, readDecimal, readNonNegativeInteger, readDateTime, writeStringTextNode, writeNonNegativeIntegerTextNode, writeDecimalTextNode, writeDateTimeTextNode} from '../format/xsd.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport Point from '../geom/Point.js';\nimport {get as getProjection} from '../proj.js';\nimport {createElementNS, makeArrayPusher, makeArraySerializer, makeChildAppender,\n  makeObjectPropertySetter, makeSequence, makeSimpleNodeFactory, makeStructureNS,\n  OBJECT_PROPERTY_NODE_FACTORY, parseNode, pushParseAndPop, pushSerializeAndPop,\n  XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {function(module:ol/Feature, Node)} [readExtensions] Callback function\n * to process `extensions` nodes. To prevent memory leaks, this callback function must\n * not store any references to the node. Note that the `extensions`\n * node is not allowed in GPX 1.0. Moreover, only `extensions`\n * nodes from `wpt`, `rte` and `trk` can be processed, as those are\n * directly mapped to a feature.\n */\n\n/**\n * @typedef {Object} LayoutOptions\n * @property {boolean} [hasZ]\n * @property {boolean} [hasM]\n */\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GPX format.\n *\n * @constructor\n * @extends {module:ol/format/XMLFeature}\n * @param {module:ol/format/GPX~Options=} opt_options Options.\n * @api\n */\nconst GPX = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  XMLFeature.call(this);\n\n  /**\n   * @inheritDoc\n   */\n  this.dataProjection = getProjection('EPSG:4326');\n\n  /**\n   * @type {function(module:ol/Feature, Node)|undefined}\n   * @private\n   */\n  this.readExtensions_ = options.readExtensions;\n};\n\ninherits(GPX, XMLFeature);\n\n\n/**\n * @const\n * @type {Array.<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://www.topografix.com/GPX/1/0',\n  'http://www.topografix.com/GPX/1/1'\n];\n\n\n/**\n * @const\n * @type {string}\n */\nconst SCHEMA_LOCATION = 'http://www.topografix.com/GPX/1/1 ' +\n    'http://www.topografix.com/GPX/1/1/gpx.xsd';\n\n\n/**\n * @const\n * @type {Object.<string, function(Node, Array.<*>): (module:ol/Feature|undefined)>}\n */\nconst FEATURE_READER = {\n  'rte': readRte,\n  'trk': readTrk,\n  'wpt': readWpt\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst GPX_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'rte': makeArrayPusher(readRte),\n    'trk': makeArrayPusher(readTrk),\n    'wpt': makeArrayPusher(readWpt)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'text': makeObjectPropertySetter(readString, 'linkText'),\n    'type': makeObjectPropertySetter(readString, 'linkType')\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst RTE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeObjectPropertySetter(readString),\n    'cmt': makeObjectPropertySetter(readString),\n    'desc': makeObjectPropertySetter(readString),\n    'src': makeObjectPropertySetter(readString),\n    'link': parseLink,\n    'number': makeObjectPropertySetter(readNonNegativeInteger),\n    'extensions': parseExtensions,\n    'type': makeObjectPropertySetter(readString),\n    'rtept': parseRtePt\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst RTEPT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeObjectPropertySetter(readDecimal),\n    'time': makeObjectPropertySetter(readDateTime)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TRK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeObjectPropertySetter(readString),\n    'cmt': makeObjectPropertySetter(readString),\n    'desc': makeObjectPropertySetter(readString),\n    'src': makeObjectPropertySetter(readString),\n    'link': parseLink,\n    'number': makeObjectPropertySetter(readNonNegativeInteger),\n    'type': makeObjectPropertySetter(readString),\n    'extensions': parseExtensions,\n    'trkseg': parseTrkSeg\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TRKSEG_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'trkpt': parseTrkPt\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TRKPT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeObjectPropertySetter(readDecimal),\n    'time': makeObjectPropertySetter(readDateTime)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst WPT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeObjectPropertySetter(readDecimal),\n    'time': makeObjectPropertySetter(readDateTime),\n    'magvar': makeObjectPropertySetter(readDecimal),\n    'geoidheight': makeObjectPropertySetter(readDecimal),\n    'name': makeObjectPropertySetter(readString),\n    'cmt': makeObjectPropertySetter(readString),\n    'desc': makeObjectPropertySetter(readString),\n    'src': makeObjectPropertySetter(readString),\n    'link': parseLink,\n    'sym': makeObjectPropertySetter(readString),\n    'type': makeObjectPropertySetter(readString),\n    'fix': makeObjectPropertySetter(readString),\n    'sat': makeObjectPropertySetter(readNonNegativeInteger),\n    'hdop': makeObjectPropertySetter(readDecimal),\n    'vdop': makeObjectPropertySetter(readDecimal),\n    'pdop': makeObjectPropertySetter(readDecimal),\n    'ageofdgpsdata': makeObjectPropertySetter(readDecimal),\n    'dgpsid': makeObjectPropertySetter(readNonNegativeInteger),\n    'extensions': parseExtensions\n  });\n\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst LINK_SEQUENCE = ['text', 'type'];\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst LINK_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'text': makeChildAppender(writeStringTextNode),\n    'type': makeChildAppender(writeStringTextNode)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst RTE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'name', 'cmt', 'desc', 'src', 'link', 'number', 'type', 'rtept'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst RTE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeChildAppender(writeStringTextNode),\n    'cmt': makeChildAppender(writeStringTextNode),\n    'desc': makeChildAppender(writeStringTextNode),\n    'src': makeChildAppender(writeStringTextNode),\n    'link': makeChildAppender(writeLink),\n    'number': makeChildAppender(writeNonNegativeIntegerTextNode),\n    'type': makeChildAppender(writeStringTextNode),\n    'rtept': makeArraySerializer(makeChildAppender(writeWptType))\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst RTEPT_TYPE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'ele', 'time'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst TRK_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'name', 'cmt', 'desc', 'src', 'link', 'number', 'type', 'trkseg'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst TRK_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeChildAppender(writeStringTextNode),\n    'cmt': makeChildAppender(writeStringTextNode),\n    'desc': makeChildAppender(writeStringTextNode),\n    'src': makeChildAppender(writeStringTextNode),\n    'link': makeChildAppender(writeLink),\n    'number': makeChildAppender(writeNonNegativeIntegerTextNode),\n    'type': makeChildAppender(writeStringTextNode),\n    'trkseg': makeArraySerializer(makeChildAppender(writeTrkSeg))\n  });\n\n\n/**\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst TRKSEG_NODE_FACTORY = makeSimpleNodeFactory('trkpt');\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst TRKSEG_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'trkpt': makeChildAppender(writeWptType)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst WPT_TYPE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'ele', 'time', 'magvar', 'geoidheight', 'name', 'cmt', 'desc', 'src',\n    'link', 'sym', 'type', 'fix', 'sat', 'hdop', 'vdop', 'pdop',\n    'ageofdgpsdata', 'dgpsid'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst WPT_TYPE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeChildAppender(writeDecimalTextNode),\n    'time': makeChildAppender(writeDateTimeTextNode),\n    'magvar': makeChildAppender(writeDecimalTextNode),\n    'geoidheight': makeChildAppender(writeDecimalTextNode),\n    'name': makeChildAppender(writeStringTextNode),\n    'cmt': makeChildAppender(writeStringTextNode),\n    'desc': makeChildAppender(writeStringTextNode),\n    'src': makeChildAppender(writeStringTextNode),\n    'link': makeChildAppender(writeLink),\n    'sym': makeChildAppender(writeStringTextNode),\n    'type': makeChildAppender(writeStringTextNode),\n    'fix': makeChildAppender(writeStringTextNode),\n    'sat': makeChildAppender(writeNonNegativeIntegerTextNode),\n    'hdop': makeChildAppender(writeDecimalTextNode),\n    'vdop': makeChildAppender(writeDecimalTextNode),\n    'pdop': makeChildAppender(writeDecimalTextNode),\n    'ageofdgpsdata': makeChildAppender(writeDecimalTextNode),\n    'dgpsid': makeChildAppender(writeNonNegativeIntegerTextNode)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, string>}\n */\nconst GEOMETRY_TYPE_TO_NODENAME = {\n  'Point': 'wpt',\n  'LineString': 'rte',\n  'MultiLineString': 'trk'\n};\n\n\n/**\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nfunction GPX_NODE_FACTORY(value, objectStack, opt_nodeName) {\n  const geometry = /** @type {module:ol/Feature} */ (value).getGeometry();\n  if (geometry) {\n    const nodeName = GEOMETRY_TYPE_TO_NODENAME[geometry.getType()];\n    if (nodeName) {\n      const parentNode = objectStack[objectStack.length - 1].node;\n      return createElementNS(parentNode.namespaceURI, nodeName);\n    }\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst GPX_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'rte': makeChildAppender(writeRte),\n    'trk': makeChildAppender(writeTrk),\n    'wpt': makeChildAppender(writeWpt)\n  });\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {module:ol/format/GPX~LayoutOptions} layoutOptions Layout options.\n * @param {Node} node Node.\n * @param {!Object} values Values.\n * @return {Array.<number>} Flat coordinates.\n */\nfunction appendCoordinate(flatCoordinates, layoutOptions, node, values) {\n  flatCoordinates.push(\n    parseFloat(node.getAttribute('lon')),\n    parseFloat(node.getAttribute('lat')));\n  if ('ele' in values) {\n    flatCoordinates.push(/** @type {number} */ (values['ele']));\n    delete values['ele'];\n    layoutOptions.hasZ = true;\n  } else {\n    flatCoordinates.push(0);\n  }\n  if ('time' in values) {\n    flatCoordinates.push(/** @type {number} */ (values['time']));\n    delete values['time'];\n    layoutOptions.hasM = true;\n  } else {\n    flatCoordinates.push(0);\n  }\n  return flatCoordinates;\n}\n\n\n/**\n * Choose GeometryLayout based on flags in layoutOptions and adjust flatCoordinates\n * and ends arrays by shrinking them accordingly (removing unused zero entries).\n *\n * @param {module:ol/format/GPX~LayoutOptions} layoutOptions Layout options.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<number>=} ends Ends.\n * @return {module:ol/geom/GeometryLayout} Layout.\n */\nfunction applyLayoutOptions(layoutOptions, flatCoordinates, ends) {\n  let layout = GeometryLayout.XY;\n  let stride = 2;\n  if (layoutOptions.hasZ && layoutOptions.hasM) {\n    layout = GeometryLayout.XYZM;\n    stride = 4;\n  } else if (layoutOptions.hasZ) {\n    layout = GeometryLayout.XYZ;\n    stride = 3;\n  } else if (layoutOptions.hasM) {\n    layout = GeometryLayout.XYM;\n    stride = 3;\n  }\n  if (stride !== 4) {\n    for (let i = 0, ii = flatCoordinates.length / 4; i < ii; i++) {\n      flatCoordinates[i * stride] = flatCoordinates[i * 4];\n      flatCoordinates[i * stride + 1] = flatCoordinates[i * 4 + 1];\n      if (layoutOptions.hasZ) {\n        flatCoordinates[i * stride + 2] = flatCoordinates[i * 4 + 2];\n      }\n      if (layoutOptions.hasM) {\n        flatCoordinates[i * stride + 2] = flatCoordinates[i * 4 + 3];\n      }\n    }\n    flatCoordinates.length = flatCoordinates.length / 4 * stride;\n    if (ends) {\n      for (let i = 0, ii = ends.length; i < ii; i++) {\n        ends[i] = ends[i] / 4 * stride;\n      }\n    }\n  }\n  return layout;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction parseLink(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const href = node.getAttribute('href');\n  if (href !== null) {\n    values['link'] = href;\n  }\n  parseNode(LINK_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction parseExtensions(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  values['extensionsNode_'] = node;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction parseRtePt(node, objectStack) {\n  const values = pushParseAndPop({}, RTEPT_PARSERS, node, objectStack);\n  if (values) {\n    const rteValues = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n    const flatCoordinates = /** @type {Array.<number>} */ (rteValues['flatCoordinates']);\n    const layoutOptions = /** @type {module:ol/format/GPX~LayoutOptions} */ (rteValues['layoutOptions']);\n    appendCoordinate(flatCoordinates, layoutOptions, node, values);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction parseTrkPt(node, objectStack) {\n  const values = pushParseAndPop({}, TRKPT_PARSERS, node, objectStack);\n  if (values) {\n    const trkValues = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n    const flatCoordinates = /** @type {Array.<number>} */ (trkValues['flatCoordinates']);\n    const layoutOptions = /** @type {module:ol/format/GPX~LayoutOptions} */ (trkValues['layoutOptions']);\n    appendCoordinate(flatCoordinates, layoutOptions, node, values);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction parseTrkSeg(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  parseNode(TRKSEG_PARSERS, node, objectStack);\n  const flatCoordinates = /** @type {Array.<number>} */\n      (values['flatCoordinates']);\n  const ends = /** @type {Array.<number>} */ (values['ends']);\n  ends.push(flatCoordinates.length);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/Feature|undefined} Track.\n */\nfunction readRte(node, objectStack) {\n  const options = /** @type {module:ol/format/Feature~ReadOptions} */ (objectStack[0]);\n  const values = pushParseAndPop({\n    'flatCoordinates': [],\n    'layoutOptions': {}\n  }, RTE_PARSERS, node, objectStack);\n  if (!values) {\n    return undefined;\n  }\n  const flatCoordinates = /** @type {Array.<number>} */\n      (values['flatCoordinates']);\n  delete values['flatCoordinates'];\n  const layoutOptions = /** @type {module:ol/format/GPX~LayoutOptions} */ (values['layoutOptions']);\n  delete values['layoutOptions'];\n  const layout = applyLayoutOptions(layoutOptions, flatCoordinates);\n  const geometry = new LineString(null);\n  geometry.setFlatCoordinates(layout, flatCoordinates);\n  transformWithOptions(geometry, false, options);\n  const feature = new Feature(geometry);\n  feature.setProperties(values);\n  return feature;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/Feature|undefined} Track.\n */\nfunction readTrk(node, objectStack) {\n  const options = /** @type {module:ol/format/Feature~ReadOptions} */ (objectStack[0]);\n  const values = pushParseAndPop({\n    'flatCoordinates': [],\n    'ends': [],\n    'layoutOptions': {}\n  }, TRK_PARSERS, node, objectStack);\n  if (!values) {\n    return undefined;\n  }\n  const flatCoordinates = /** @type {Array.<number>} */\n      (values['flatCoordinates']);\n  delete values['flatCoordinates'];\n  const ends = /** @type {Array.<number>} */ (values['ends']);\n  delete values['ends'];\n  const layoutOptions = /** @type {module:ol/format/GPX~LayoutOptions} */ (values['layoutOptions']);\n  delete values['layoutOptions'];\n  const layout = applyLayoutOptions(layoutOptions, flatCoordinates, ends);\n  const geometry = new MultiLineString(null);\n  geometry.setFlatCoordinates(layout, flatCoordinates, ends);\n  transformWithOptions(geometry, false, options);\n  const feature = new Feature(geometry);\n  feature.setProperties(values);\n  return feature;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/Feature|undefined} Waypoint.\n */\nfunction readWpt(node, objectStack) {\n  const options = /** @type {module:ol/format/Feature~ReadOptions} */ (objectStack[0]);\n  const values = pushParseAndPop({}, WPT_PARSERS, node, objectStack);\n  if (!values) {\n    return undefined;\n  }\n  const layoutOptions = /** @type {module:ol/format/GPX~LayoutOptions} */ ({});\n  const coordinates = appendCoordinate([], layoutOptions, node, values);\n  const layout = applyLayoutOptions(layoutOptions, coordinates);\n  const geometry = new Point(coordinates, layout);\n  transformWithOptions(geometry, false, options);\n  const feature = new Feature(geometry);\n  feature.setProperties(values);\n  return feature;\n}\n\n\n/**\n * @param {Array.<module:ol/Feature>} features List of features.\n * @private\n */\nGPX.prototype.handleReadExtensions_ = function(features) {\n  if (!features) {\n    features = [];\n  }\n  for (let i = 0, ii = features.length; i < ii; ++i) {\n    const feature = features[i];\n    if (this.readExtensions_) {\n      const extensionsNode = feature.get('extensionsNode_') || null;\n      this.readExtensions_(feature, extensionsNode);\n    }\n    feature.set('extensionsNode_', undefined);\n  }\n};\n\n\n/**\n * Read the first feature from a GPX source.\n * Routes (`<rte>`) are converted into LineString geometries, and tracks (`<trk>`)\n * into MultiLineString. Any properties on route and track waypoints are ignored.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nGPX.prototype.readFeature;\n\n\n/**\n * @inheritDoc\n */\nGPX.prototype.readFeatureFromNode = function(node, opt_options) {\n  if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n    return null;\n  }\n  const featureReader = FEATURE_READER[node.localName];\n  if (!featureReader) {\n    return null;\n  }\n  const feature = featureReader(node, [this.getReadOptions(node, opt_options)]);\n  if (!feature) {\n    return null;\n  }\n  this.handleReadExtensions_([feature]);\n  return feature;\n};\n\n\n/**\n * Read all features from a GPX source.\n * Routes (`<rte>`) are converted into LineString geometries, and tracks (`<trk>`)\n * into MultiLineString. Any properties on route and track waypoints are ignored.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nGPX.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nGPX.prototype.readFeaturesFromNode = function(node, opt_options) {\n  if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n    return [];\n  }\n  if (node.localName == 'gpx') {\n    /** @type {Array.<module:ol/Feature>} */\n    const features = pushParseAndPop([], GPX_PARSERS,\n      node, [this.getReadOptions(node, opt_options)]);\n    if (features) {\n      this.handleReadExtensions_(features);\n      return features;\n    } else {\n      return [];\n    }\n  }\n  return [];\n};\n\n\n/**\n * Read the projection from a GPX source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nGPX.prototype.readProjection;\n\n\n/**\n * @param {Node} node Node.\n * @param {string} value Value for the link's `href` attribute.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeLink(node, value, objectStack) {\n  node.setAttribute('href', value);\n  const context = objectStack[objectStack.length - 1];\n  const properties = context['properties'];\n  const link = [\n    properties['linkText'],\n    properties['linkType']\n  ];\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */ ({node: node}),\n    LINK_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    link, objectStack, LINK_SEQUENCE);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeWptType(node, coordinate, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const parentNode = context.node;\n  const namespaceURI = parentNode.namespaceURI;\n  const properties = context['properties'];\n  //FIXME Projection handling\n  node.setAttributeNS(null, 'lat', coordinate[1]);\n  node.setAttributeNS(null, 'lon', coordinate[0]);\n  const geometryLayout = context['geometryLayout'];\n  switch (geometryLayout) {\n    case GeometryLayout.XYZM:\n      if (coordinate[3] !== 0) {\n        properties['time'] = coordinate[3];\n      }\n      // fall through\n    case GeometryLayout.XYZ:\n      if (coordinate[2] !== 0) {\n        properties['ele'] = coordinate[2];\n      }\n      break;\n    case GeometryLayout.XYM:\n      if (coordinate[2] !== 0) {\n        properties['time'] = coordinate[2];\n      }\n      break;\n    default:\n      // pass\n  }\n  const orderedKeys = (node.nodeName == 'rtept') ?\n    RTEPT_TYPE_SEQUENCE[namespaceURI] :\n    WPT_TYPE_SEQUENCE[namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    ({node: node, 'properties': properties}),\n    WPT_TYPE_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeRte(node, feature, objectStack) {\n  const options = /** @type {module:ol/format/Feature~WriteOptions} */ (objectStack[0]);\n  const properties = feature.getProperties();\n  const context = {node: node, 'properties': properties};\n  let geometry = feature.getGeometry();\n  if (geometry) {\n    geometry = /** @type {module:ol/geom/LineString} */ (transformWithOptions(geometry, true, options));\n    context['geometryLayout'] = geometry.getLayout();\n    properties['rtept'] = geometry.getCoordinates();\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = RTE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context,\n    RTE_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeTrk(node, feature, objectStack) {\n  const options = /** @type {module:ol/format/Feature~WriteOptions} */ (objectStack[0]);\n  const properties = feature.getProperties();\n  /** @type {module:ol/xml~NodeStackItem} */\n  const context = {node: node, 'properties': properties};\n  let geometry = feature.getGeometry();\n  if (geometry) {\n    geometry = /** @type {module:ol/geom/MultiLineString} */\n      (transformWithOptions(geometry, true, options));\n    properties['trkseg'] = geometry.getLineStrings();\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = TRK_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context,\n    TRK_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LineString} lineString LineString.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeTrkSeg(node, lineString, objectStack) {\n  /** @type {module:ol/xml~NodeStackItem} */\n  const context = {node: node, 'geometryLayout': lineString.getLayout(),\n    'properties': {}};\n  pushSerializeAndPop(context,\n    TRKSEG_SERIALIZERS, TRKSEG_NODE_FACTORY,\n    lineString.getCoordinates(), objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeWpt(node, feature, objectStack) {\n  const options = /** @type {module:ol/format/Feature~WriteOptions} */ (objectStack[0]);\n  const context = objectStack[objectStack.length - 1];\n  context['properties'] = feature.getProperties();\n  let geometry = feature.getGeometry();\n  if (geometry) {\n    geometry = /** @type {module:ol/geom/Point} */\n      (transformWithOptions(geometry, true, options));\n    context['geometryLayout'] = geometry.getLayout();\n    writeWptType(node, geometry.getCoordinates(), objectStack);\n  }\n}\n\n\n/**\n * Encode an array of features in the GPX format.\n * LineString geometries are output as routes (`<rte>`), and MultiLineString\n * as tracks (`<trk>`).\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Result.\n * @api\n */\nGPX.prototype.writeFeatures;\n\n\n/**\n * Encode an array of features in the GPX format as an XML node.\n * LineString geometries are output as routes (`<rte>`), and MultiLineString\n * as tracks (`<trk>`).\n *\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {Node} Node.\n * @override\n * @api\n */\nGPX.prototype.writeFeaturesNode = function(features, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  //FIXME Serialize metadata\n  const gpx = createElementNS('http://www.topografix.com/GPX/1/1', 'gpx');\n  const xmlnsUri = 'http://www.w3.org/2000/xmlns/';\n  gpx.setAttributeNS(xmlnsUri, 'xmlns:xsi', XML_SCHEMA_INSTANCE_URI);\n  gpx.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', SCHEMA_LOCATION);\n  gpx.setAttribute('version', '1.1');\n  gpx.setAttribute('creator', 'OpenLayers');\n\n  pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */\n    ({node: gpx}), GPX_SERIALIZERS, GPX_NODE_FACTORY, features, [opt_options]);\n  return gpx;\n};\nexport default GPX;\n","/**\n * @module ol/geom/GeometryCollection\n */\nimport {inherits} from '../index.js';\nimport {listen, unlisten} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {createOrUpdateEmpty, closestSquaredDistanceXY, extend, getCenter} from '../extent.js';\nimport Geometry from '../geom/Geometry.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {clear} from '../obj.js';\n\n/**\n * @classdesc\n * An array of {@link module:ol/geom/Geometry} objects.\n *\n * @constructor\n * @extends {module:ol/geom/Geometry}\n * @param {Array.<module:ol/geom/Geometry>=} opt_geometries Geometries.\n * @api\n */\nconst GeometryCollection = function(opt_geometries) {\n\n  Geometry.call(this);\n\n  /**\n   * @private\n   * @type {Array.<module:ol/geom/Geometry>}\n   */\n  this.geometries_ = opt_geometries ? opt_geometries : null;\n\n  this.listenGeometriesChange_();\n};\n\ninherits(GeometryCollection, Geometry);\n\n\n/**\n * @param {Array.<module:ol/geom/Geometry>} geometries Geometries.\n * @return {Array.<module:ol/geom/Geometry>} Cloned geometries.\n */\nfunction cloneGeometries(geometries) {\n  const clonedGeometries = [];\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    clonedGeometries.push(geometries[i].clone());\n  }\n  return clonedGeometries;\n}\n\n\n/**\n * @private\n */\nGeometryCollection.prototype.unlistenGeometriesChange_ = function() {\n  if (!this.geometries_) {\n    return;\n  }\n  for (let i = 0, ii = this.geometries_.length; i < ii; ++i) {\n    unlisten(\n      this.geometries_[i], EventType.CHANGE,\n      this.changed, this);\n  }\n};\n\n\n/**\n * @private\n */\nGeometryCollection.prototype.listenGeometriesChange_ = function() {\n  if (!this.geometries_) {\n    return;\n  }\n  for (let i = 0, ii = this.geometries_.length; i < ii; ++i) {\n    listen(\n      this.geometries_[i], EventType.CHANGE,\n      this.changed, this);\n  }\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/GeometryCollection} Clone.\n * @override\n * @api\n */\nGeometryCollection.prototype.clone = function() {\n  const geometryCollection = new GeometryCollection(null);\n  geometryCollection.setGeometries(this.geometries_);\n  return geometryCollection;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    minSquaredDistance = geometries[i].closestPointXY(\n      x, y, closestPoint, minSquaredDistance);\n  }\n  return minSquaredDistance;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.containsXY = function(x, y) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    if (geometries[i].containsXY(x, y)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.computeExtent = function(extent) {\n  createOrUpdateEmpty(extent);\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    extend(extent, geometries[i].getExtent());\n  }\n  return extent;\n};\n\n\n/**\n * Return the geometries that make up this geometry collection.\n * @return {Array.<module:ol/geom/Geometry>} Geometries.\n * @api\n */\nGeometryCollection.prototype.getGeometries = function() {\n  return cloneGeometries(this.geometries_);\n};\n\n\n/**\n * @return {Array.<module:ol/geom/Geometry>} Geometries.\n */\nGeometryCollection.prototype.getGeometriesArray = function() {\n  return this.geometries_;\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.getSimplifiedGeometry = function(squaredTolerance) {\n  if (this.simplifiedGeometryRevision != this.getRevision()) {\n    clear(this.simplifiedGeometryCache);\n    this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n    this.simplifiedGeometryRevision = this.getRevision();\n  }\n  if (squaredTolerance < 0 ||\n      (this.simplifiedGeometryMaxMinSquaredTolerance !== 0 &&\n       squaredTolerance < this.simplifiedGeometryMaxMinSquaredTolerance)) {\n    return this;\n  }\n  const key = squaredTolerance.toString();\n  if (this.simplifiedGeometryCache.hasOwnProperty(key)) {\n    return this.simplifiedGeometryCache[key];\n  } else {\n    const simplifiedGeometries = [];\n    const geometries = this.geometries_;\n    let simplified = false;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      const geometry = geometries[i];\n      const simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n      simplifiedGeometries.push(simplifiedGeometry);\n      if (simplifiedGeometry !== geometry) {\n        simplified = true;\n      }\n    }\n    if (simplified) {\n      const simplifiedGeometryCollection = new GeometryCollection(null);\n      simplifiedGeometryCollection.setGeometriesArray(simplifiedGeometries);\n      this.simplifiedGeometryCache[key] = simplifiedGeometryCollection;\n      return simplifiedGeometryCollection;\n    } else {\n      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;\n      return this;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.getType = function() {\n  return GeometryType.GEOMETRY_COLLECTION;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.intersectsExtent = function(extent) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    if (geometries[i].intersectsExtent(extent)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nGeometryCollection.prototype.isEmpty = function() {\n  return this.geometries_.length === 0;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.rotate = function(angle, anchor) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].rotate(angle, anchor);\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.scale = function(sx, opt_sy, opt_anchor) {\n  let anchor = opt_anchor;\n  if (!anchor) {\n    anchor = getCenter(this.getExtent());\n  }\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].scale(sx, opt_sy, anchor);\n  }\n  this.changed();\n};\n\n\n/**\n * Set the geometries that make up this geometry collection.\n * @param {Array.<module:ol/geom/Geometry>} geometries Geometries.\n * @api\n */\nGeometryCollection.prototype.setGeometries = function(geometries) {\n  this.setGeometriesArray(cloneGeometries(geometries));\n};\n\n\n/**\n * @param {Array.<module:ol/geom/Geometry>} geometries Geometries.\n */\nGeometryCollection.prototype.setGeometriesArray = function(geometries) {\n  this.unlistenGeometriesChange_();\n  this.geometries_ = geometries;\n  this.listenGeometriesChange_();\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nGeometryCollection.prototype.applyTransform = function(transformFn) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].applyTransform(transformFn);\n  }\n  this.changed();\n};\n\n\n/**\n * Translate the geometry.\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n * @override\n * @api\n */\nGeometryCollection.prototype.translate = function(deltaX, deltaY) {\n  const geometries = this.geometries_;\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    geometries[i].translate(deltaX, deltaY);\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nGeometryCollection.prototype.disposeInternal = function() {\n  this.unlistenGeometriesChange_();\n  Geometry.prototype.disposeInternal.call(this);\n};\nexport default GeometryCollection;\n","/**\n * @module ol/format/GeoJSON\n */\n// TODO: serialize dataProjection as crs member when writing\n// see https://github.com/openlayers/openlayers/issues/2078\n\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport JSONFeature from '../format/JSONFeature.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {assign, isEmpty} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/proj~ProjectionLike} [dataProjection='EPSG:4326'] Default data projection.\n * @property {module:ol/proj~ProjectionLike} [featureProjection] Projection for features read or\n * written by the format.  Options passed to read or write methods will take precedence.\n * @property {string} [geometryName] Geometry name to use when creating features.\n * @property {boolean} [extractGeometryName=false] Certain GeoJSON providers include\n * the geometry_name field in the feature GeoJSON. If set to `true` the GeoJSON reader\n * will look for that field to set the geometry name. If both this field is set to `true`\n * and a `geometryName` is provided, the `geometryName` will take precedence.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GeoJSON format.\n *\n * @constructor\n * @extends {module:ol/format/JSONFeature}\n * @param {module:ol/format/GeoJSON~Options=} opt_options Options.\n * @api\n */\nconst GeoJSON = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  JSONFeature.call(this);\n\n  /**\n   * @inheritDoc\n   */\n  this.dataProjection = getProjection(\n    options.dataProjection ?\n      options.dataProjection : 'EPSG:4326');\n\n  if (options.featureProjection) {\n    this.defaultFeatureProjection = getProjection(options.featureProjection);\n  }\n\n  /**\n   * Name of the geometry attribute for features.\n   * @type {string|undefined}\n   * @private\n   */\n  this.geometryName_ = options.geometryName;\n\n  /**\n   * Look for the geometry name in the feature GeoJSON\n   * @type {boolean|undefined}\n   * @private\n   */\n  this.extractGeometryName_ = options.extractGeometryName;\n\n};\n\ninherits(GeoJSON, JSONFeature);\n\n\n/**\n * @const\n * @type {Object.<string, function(GeoJSONObject): module:ol/geom/Geometry>}\n */\nconst GEOMETRY_READERS = {\n  'Point': readPointGeometry,\n  'LineString': readLineStringGeometry,\n  'Polygon': readPolygonGeometry,\n  'MultiPoint': readMultiPointGeometry,\n  'MultiLineString': readMultiLineStringGeometry,\n  'MultiPolygon': readMultiPolygonGeometry,\n  'GeometryCollection': readGeometryCollectionGeometry\n};\n\n\n/**\n * @const\n * @type {Object.<string, function(module:ol/geom/Geometry, module:ol/format/Feature~WriteOptions=): (GeoJSONGeometry|GeoJSONGeometryCollection)>}\n */\nconst GEOMETRY_WRITERS = {\n  'Point': writePointGeometry,\n  'LineString': writeLineStringGeometry,\n  'Polygon': writePolygonGeometry,\n  'MultiPoint': writeMultiPointGeometry,\n  'MultiLineString': writeMultiLineStringGeometry,\n  'MultiPolygon': writeMultiPolygonGeometry,\n  'GeometryCollection': writeGeometryCollectionGeometry,\n  'Circle': writeEmptyGeometryCollectionGeometry\n};\n\n\n/**\n * @param {GeoJSONGeometry|GeoJSONGeometryCollection} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n */\nfunction readGeometry(object, opt_options) {\n  if (!object) {\n    return null;\n  }\n  const geometryReader = GEOMETRY_READERS[object.type];\n  return (\n    /** @type {module:ol/geom/Geometry} */ (transformWithOptions(geometryReader(object), false, opt_options))\n  );\n}\n\n\n/**\n * @param {GeoJSONGeometryCollection} object Object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/GeometryCollection} Geometry collection.\n */\nfunction readGeometryCollectionGeometry(object, opt_options) {\n  const geometries = object.geometries.map(\n    /**\n     * @param {GeoJSONGeometry} geometry Geometry.\n     * @return {module:ol/geom/Geometry} geometry Geometry.\n     */\n    function(geometry) {\n      return readGeometry(geometry, opt_options);\n    });\n  return new GeometryCollection(geometries);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/Point} Point.\n */\nfunction readPointGeometry(object) {\n  return new Point(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/LineString} LineString.\n */\nfunction readLineStringGeometry(object) {\n  return new LineString(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/MultiLineString} MultiLineString.\n */\nfunction readMultiLineStringGeometry(object) {\n  return new MultiLineString(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/MultiPoint} MultiPoint.\n */\nfunction readMultiPointGeometry(object) {\n  return new MultiPoint(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/MultiPolygon} MultiPolygon.\n */\nfunction readMultiPolygonGeometry(object) {\n  return new MultiPolygon(object.coordinates);\n}\n\n\n/**\n * @param {GeoJSONGeometry} object Object.\n * @return {module:ol/geom/Polygon} Polygon.\n */\nfunction readPolygonGeometry(object) {\n  return new Polygon(object.coordinates);\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry|GeoJSONGeometryCollection} GeoJSON geometry.\n */\nfunction writeGeometry(geometry, opt_options) {\n  const geometryWriter = GEOMETRY_WRITERS[geometry.getType()];\n  return geometryWriter(/** @type {module:ol/geom/Geometry} */ (\n    transformWithOptions(geometry, true, opt_options)), opt_options);\n}\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @return {GeoJSONGeometryCollection} Empty GeoJSON geometry collection.\n */\nfunction writeEmptyGeometryCollectionGeometry(geometry) {\n  return /** @type {GeoJSONGeometryCollection} */ ({\n    type: 'GeometryCollection',\n    geometries: []\n  });\n}\n\n\n/**\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometryCollection} GeoJSON geometry collection.\n */\nfunction writeGeometryCollectionGeometry(geometry, opt_options) {\n  const geometries = geometry.getGeometriesArray().map(function(geometry) {\n    const options = assign({}, opt_options);\n    delete options.featureProjection;\n    return writeGeometry(geometry, options);\n  });\n  return /** @type {GeoJSONGeometryCollection} */ ({\n    type: 'GeometryCollection',\n    geometries: geometries\n  });\n}\n\n\n/**\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeLineStringGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'LineString',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiLineStringGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'MultiLineString',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiPointGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'MultiPoint',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiPolygonGeometry(geometry, opt_options) {\n  let right;\n  if (opt_options) {\n    right = opt_options.rightHanded;\n  }\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'MultiPolygon',\n    coordinates: geometry.getCoordinates(right)\n  });\n}\n\n\n/**\n * @param {module:ol/geom/Point} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writePointGeometry(geometry, opt_options) {\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'Point',\n    coordinates: geometry.getCoordinates()\n  });\n}\n\n\n/**\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writePolygonGeometry(geometry, opt_options) {\n  let right;\n  if (opt_options) {\n    right = opt_options.rightHanded;\n  }\n  return /** @type {GeoJSONGeometry} */ ({\n    type: 'Polygon',\n    coordinates: geometry.getCoordinates(right)\n  });\n}\n\n\n/**\n * Read a feature from a GeoJSON Feature source.  Only works for Feature or\n * geometry types.  Use {@link module:ol/format/GeoJSON#readFeatures} to read\n * FeatureCollection source. If feature at source has an id, it will be used\n * as Feature id by calling {@link module:ol/Feature#setId} internally.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nGeoJSON.prototype.readFeature;\n\n\n/**\n * Read all features from a GeoJSON source.  Works for all GeoJSON types.\n * If the source includes only geometries, features will be created with those\n * geometries.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nGeoJSON.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readFeatureFromObject = function(object, opt_options) {\n  /**\n   * @type {GeoJSONFeature}\n   */\n  let geoJSONFeature = null;\n  if (object.type === 'Feature') {\n    geoJSONFeature = /** @type {GeoJSONFeature} */ (object);\n  } else {\n    geoJSONFeature = /** @type {GeoJSONFeature} */ ({\n      type: 'Feature',\n      geometry: /** @type {GeoJSONGeometry|GeoJSONGeometryCollection} */ (object)\n    });\n  }\n\n  const geometry = readGeometry(geoJSONFeature.geometry, opt_options);\n  const feature = new Feature();\n  if (this.geometryName_) {\n    feature.setGeometryName(this.geometryName_);\n  } else if (this.extractGeometryName_ && geoJSONFeature.geometry_name !== undefined) {\n    feature.setGeometryName(geoJSONFeature.geometry_name);\n  }\n  feature.setGeometry(geometry);\n  if (geoJSONFeature.id !== undefined) {\n    feature.setId(geoJSONFeature.id);\n  }\n  if (geoJSONFeature.properties) {\n    feature.setProperties(geoJSONFeature.properties);\n  }\n  return feature;\n};\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readFeaturesFromObject = function(object, opt_options) {\n  const geoJSONObject = /** @type {GeoJSONObject} */ (object);\n  /** @type {Array.<module:ol/Feature>} */\n  let features = null;\n  if (geoJSONObject.type === 'FeatureCollection') {\n    const geoJSONFeatureCollection = /** @type {GeoJSONFeatureCollection} */ (object);\n    features = [];\n    const geoJSONFeatures = geoJSONFeatureCollection.features;\n    for (let i = 0, ii = geoJSONFeatures.length; i < ii; ++i) {\n      features.push(this.readFeatureFromObject(geoJSONFeatures[i], opt_options));\n    }\n  } else {\n    features = [this.readFeatureFromObject(object, opt_options)];\n  }\n  return features;\n};\n\n\n/**\n * Read a geometry from a GeoJSON source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n * @api\n */\nGeoJSON.prototype.readGeometry;\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readGeometryFromObject = function(object, opt_options) {\n  return readGeometry(/** @type {GeoJSONGeometry} */ (object), opt_options);\n};\n\n\n/**\n * Read the projection from a GeoJSON source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nGeoJSON.prototype.readProjection;\n\n\n/**\n * @inheritDoc\n */\nGeoJSON.prototype.readProjectionFromObject = function(object) {\n  const geoJSONObject = /** @type {GeoJSONObject} */ (object);\n  const crs = geoJSONObject.crs;\n  let projection;\n  if (crs) {\n    if (crs.type == 'name') {\n      projection = getProjection(crs.properties.name);\n    } else {\n      assert(false, 36); // Unknown SRS type\n    }\n  } else {\n    projection = this.dataProjection;\n  }\n  return (\n    /** @type {module:ol/proj/Projection} */ (projection)\n  );\n};\n\n\n/**\n * Encode a feature as a GeoJSON Feature string.\n *\n * @function\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} GeoJSON.\n * @override\n * @api\n */\nGeoJSON.prototype.writeFeature;\n\n\n/**\n * Encode a feature as a GeoJSON Feature object.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONFeature} Object.\n * @override\n * @api\n */\nGeoJSON.prototype.writeFeatureObject = function(feature, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n\n  const object = /** @type {GeoJSONFeature} */ ({\n    'type': 'Feature'\n  });\n  const id = feature.getId();\n  if (id !== undefined) {\n    object.id = id;\n  }\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    object.geometry = writeGeometry(geometry, opt_options);\n  } else {\n    object.geometry = null;\n  }\n  const properties = feature.getProperties();\n  delete properties[feature.getGeometryName()];\n  if (!isEmpty(properties)) {\n    object.properties = properties;\n  } else {\n    object.properties = null;\n  }\n  return object;\n};\n\n\n/**\n * Encode an array of features as GeoJSON.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} GeoJSON.\n * @api\n */\nGeoJSON.prototype.writeFeatures;\n\n\n/**\n * Encode an array of features as a GeoJSON object.\n *\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONFeatureCollection} GeoJSON Object.\n * @override\n * @api\n */\nGeoJSON.prototype.writeFeaturesObject = function(features, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  const objects = [];\n  for (let i = 0, ii = features.length; i < ii; ++i) {\n    objects.push(this.writeFeatureObject(features[i], opt_options));\n  }\n  return /** @type {GeoJSONFeatureCollection} */ ({\n    type: 'FeatureCollection',\n    features: objects\n  });\n};\n\n\n/**\n * Encode a geometry as a GeoJSON string.\n *\n * @function\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} GeoJSON.\n * @api\n */\nGeoJSON.prototype.writeGeometry;\n\n\n/**\n * Encode a geometry as a GeoJSON object.\n *\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry|GeoJSONGeometryCollection} Object.\n * @override\n * @api\n */\nGeoJSON.prototype.writeGeometryObject = function(geometry, opt_options) {\n  return writeGeometry(geometry, this.adaptOptions(opt_options));\n};\nexport default GeoJSON;\n","/**\n * @module ol/format/TextFeature\n */\nimport {inherits} from '../index.js';\nimport FeatureFormat from '../format/Feature.js';\nimport FormatType from '../format/FormatType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for text feature formats.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/format/Feature}\n */\nconst TextFeature = function() {\n  FeatureFormat.call(this);\n};\n\ninherits(TextFeature, FeatureFormat);\n\n\n/**\n * @param {Document|Node|Object|string} source Source.\n * @return {string} Text.\n */\nfunction getText(source) {\n  if (typeof source === 'string') {\n    return source;\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.getType = function() {\n  return FormatType.TEXT;\n};\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.readFeature = function(source, opt_options) {\n  return this.readFeatureFromText(getText(source), this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {string} text Text.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {module:ol/Feature} Feature.\n */\nTextFeature.prototype.readFeatureFromText = function(text, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.readFeatures = function(source, opt_options) {\n  return this.readFeaturesFromText(getText(source), this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {string} text Text.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {Array.<module:ol/Feature>} Features.\n */\nTextFeature.prototype.readFeaturesFromText = function(text, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.readGeometry = function(source, opt_options) {\n  return this.readGeometryFromText(getText(source), this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {string} text Text.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @protected\n * @return {module:ol/geom/Geometry} Geometry.\n */\nTextFeature.prototype.readGeometryFromText = function(text, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.readProjection = function(source) {\n  return this.readProjectionFromText(getText(source));\n};\n\n\n/**\n * @param {string} text Text.\n * @protected\n * @return {module:ol/proj/Projection} Projection.\n */\nTextFeature.prototype.readProjectionFromText = function(text) {\n  return this.dataProjection;\n};\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.writeFeature = function(feature, opt_options) {\n  return this.writeFeatureText(feature, this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {module:ol/Feature} feature Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @protected\n * @return {string} Text.\n */\nTextFeature.prototype.writeFeatureText = function(feature, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.writeFeatures = function(features, opt_options) {\n  return this.writeFeaturesText(features, this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @protected\n * @return {string} Text.\n */\nTextFeature.prototype.writeFeaturesText = function(features, opt_options) {};\n\n\n/**\n * @inheritDoc\n */\nTextFeature.prototype.writeGeometry = function(geometry, opt_options) {\n  return this.writeGeometryText(geometry, this.adaptOptions(opt_options));\n};\n\n\n/**\n * @abstract\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @protected\n * @return {string} Text.\n */\nTextFeature.prototype.writeGeometryText = function(geometry, opt_options) {};\nexport default TextFeature;\n","/**\n * @module ol/format/IGC\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport TextFeature from '../format/TextFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport {get as getProjection} from '../proj.js';\n\n/**\n * IGC altitude/z. One of 'barometric', 'gps', 'none'.\n * @enum {string}\n */\nconst IGCZ = {\n  BAROMETRIC: 'barometric',\n  GPS: 'gps',\n  NONE: 'none'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {IGCZ|string} [altitudeMode='none'] Altitude mode. Possible\n * values are `'barometric'`, `'gps'`, and `'none'`.\n */\n\n\n/**\n * @classdesc\n * Feature format for `*.igc` flight recording files.\n *\n * @constructor\n * @extends {module:ol/format/TextFeature}\n * @param {module:ol/format/IGC~Options=} opt_options Options.\n * @api\n */\nconst IGC = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  TextFeature.call(this);\n\n  /**\n   * @inheritDoc\n   */\n  this.dataProjection = getProjection('EPSG:4326');\n\n  /**\n   * @private\n   * @type {IGCZ}\n   */\n  this.altitudeMode_ = options.altitudeMode ? options.altitudeMode : IGCZ.NONE;\n};\n\ninherits(IGC, TextFeature);\n\n\n/**\n * @const\n * @type {RegExp}\n */\nconst B_RECORD_RE =\n    /^B(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{5})([NS])(\\d{3})(\\d{5})([EW])([AV])(\\d{5})(\\d{5})/;\n\n\n/**\n * @const\n * @type {RegExp}\n */\nconst H_RECORD_RE = /^H.([A-Z]{3}).*?:(.*)/;\n\n\n/**\n * @const\n * @type {RegExp}\n */\nconst HFDTE_RECORD_RE = /^HFDTE(\\d{2})(\\d{2})(\\d{2})/;\n\n\n/**\n * A regular expression matching the newline characters `\\r\\n`, `\\r` and `\\n`.\n *\n * @const\n * @type {RegExp}\n */\nconst NEWLINE_RE = /\\r\\n|\\r|\\n/;\n\n\n/**\n * Read the feature from the IGC source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nIGC.prototype.readFeature;\n\n\n/**\n * @inheritDoc\n */\nIGC.prototype.readFeatureFromText = function(text, opt_options) {\n  const altitudeMode = this.altitudeMode_;\n  const lines = text.split(NEWLINE_RE);\n  /** @type {Object.<string, string>} */\n  const properties = {};\n  const flatCoordinates = [];\n  let year = 2000;\n  let month = 0;\n  let day = 1;\n  let lastDateTime = -1;\n  let i, ii;\n  for (i = 0, ii = lines.length; i < ii; ++i) {\n    const line = lines[i];\n    let m;\n    if (line.charAt(0) == 'B') {\n      m = B_RECORD_RE.exec(line);\n      if (m) {\n        const hour = parseInt(m[1], 10);\n        const minute = parseInt(m[2], 10);\n        const second = parseInt(m[3], 10);\n        let y = parseInt(m[4], 10) + parseInt(m[5], 10) / 60000;\n        if (m[6] == 'S') {\n          y = -y;\n        }\n        let x = parseInt(m[7], 10) + parseInt(m[8], 10) / 60000;\n        if (m[9] == 'W') {\n          x = -x;\n        }\n        flatCoordinates.push(x, y);\n        if (altitudeMode != IGCZ.NONE) {\n          let z;\n          if (altitudeMode == IGCZ.GPS) {\n            z = parseInt(m[11], 10);\n          } else if (altitudeMode == IGCZ.BAROMETRIC) {\n            z = parseInt(m[12], 10);\n          } else {\n            z = 0;\n          }\n          flatCoordinates.push(z);\n        }\n        let dateTime = Date.UTC(year, month, day, hour, minute, second);\n        // Detect UTC midnight wrap around.\n        if (dateTime < lastDateTime) {\n          dateTime = Date.UTC(year, month, day + 1, hour, minute, second);\n        }\n        flatCoordinates.push(dateTime / 1000);\n        lastDateTime = dateTime;\n      }\n    } else if (line.charAt(0) == 'H') {\n      m = HFDTE_RECORD_RE.exec(line);\n      if (m) {\n        day = parseInt(m[1], 10);\n        month = parseInt(m[2], 10) - 1;\n        year = 2000 + parseInt(m[3], 10);\n      } else {\n        m = H_RECORD_RE.exec(line);\n        if (m) {\n          properties[m[1]] = m[2].trim();\n        }\n      }\n    }\n  }\n  if (flatCoordinates.length === 0) {\n    return null;\n  }\n  const lineString = new LineString(null);\n  const layout = altitudeMode == IGCZ.NONE ? GeometryLayout.XYM : GeometryLayout.XYZM;\n  lineString.setFlatCoordinates(layout, flatCoordinates);\n  const feature = new Feature(transformWithOptions(lineString, false, opt_options));\n  feature.setProperties(properties);\n  return feature;\n};\n\n\n/**\n * Read the feature from the source. As IGC sources contain a single\n * feature, this will return the feature in an array.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nIGC.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nIGC.prototype.readFeaturesFromText = function(text, opt_options) {\n  const feature = this.readFeatureFromText(text, opt_options);\n  if (feature) {\n    return [feature];\n  } else {\n    return [];\n  }\n};\n\n\n/**\n * Read the projection from the IGC source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nIGC.prototype.readProjection;\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nIGC.prototype.writeFeatureText = function(feature, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nIGC.prototype.writeFeaturesText = function(features, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nIGC.prototype.writeGeometryText = function(geometry, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nIGC.prototype.readGeometryFromText = function(text, opt_options) {};\nexport default IGC;\n","/**\n * @module ol/style/IconAnchorUnits\n */\n\n/**\n * Icon anchor units. One of 'fraction', 'pixels'.\n * @enum {string}\n */\nexport default {\n  FRACTION: 'fraction',\n  PIXELS: 'pixels'\n};\n","/**\n * @module ol/style/IconImage\n */\nimport {inherits} from '../index.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {listenOnce, unlistenByKey} from '../events.js';\nimport EventTarget from '../events/EventTarget.js';\nimport EventType from '../events/EventType.js';\nimport ImageState from '../ImageState.js';\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\n\n/**\n * @constructor\n * @param {Image|HTMLCanvasElement} image Image.\n * @param {string|undefined} src Src.\n * @param {module:ol/size~Size} size Size.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/ImageState} imageState Image state.\n * @param {module:ol/color~Color} color Color.\n * @extends {module:ol/events/EventTarget}\n */\nconst IconImage = function(image, src, size, crossOrigin, imageState, color) {\n\n  EventTarget.call(this);\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.hitDetectionImage_ = null;\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.image_ = !image ? new Image() : image;\n\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = color ?\n    /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS')) :\n    null;\n\n  /**\n   * @private\n   * @type {module:ol/color~Color}\n   */\n  this.color_ = color;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/ImageState}\n   */\n  this.imageState_ = imageState;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.size_ = size;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.tainting_ = false;\n  if (this.imageState_ == ImageState.LOADED) {\n    this.determineTainting_();\n  }\n\n};\n\ninherits(IconImage, EventTarget);\n\n\n/**\n * @param {Image|HTMLCanvasElement} image Image.\n * @param {string} src Src.\n * @param {module:ol/size~Size} size Size.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/ImageState} imageState Image state.\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/style/IconImage} Icon image.\n */\nexport function get(image, src, size, crossOrigin, imageState, color) {\n  let iconImage = iconImageCache.get(src, crossOrigin, color);\n  if (!iconImage) {\n    iconImage = new IconImage(image, src, size, crossOrigin, imageState, color);\n    iconImageCache.set(src, crossOrigin, color, iconImage);\n  }\n  return iconImage;\n}\n\n\n/**\n * @private\n */\nIconImage.prototype.determineTainting_ = function() {\n  const context = createCanvasContext2D(1, 1);\n  try {\n    context.drawImage(this.image_, 0, 0);\n    context.getImageData(0, 0, 1, 1);\n  } catch (e) {\n    this.tainting_ = true;\n  }\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.dispatchChangeEvent_ = function() {\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.handleImageError_ = function() {\n  this.imageState_ = ImageState.ERROR;\n  this.unlistenImage_();\n  this.dispatchChangeEvent_();\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.handleImageLoad_ = function() {\n  this.imageState_ = ImageState.LOADED;\n  if (this.size_) {\n    this.image_.width = this.size_[0];\n    this.image_.height = this.size_[1];\n  }\n  this.size_ = [this.image_.width, this.image_.height];\n  this.unlistenImage_();\n  this.determineTainting_();\n  this.replaceColor_();\n  this.dispatchChangeEvent_();\n};\n\n\n/**\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image or Canvas element.\n */\nIconImage.prototype.getImage = function(pixelRatio) {\n  return this.canvas_ ? this.canvas_ : this.image_;\n};\n\n\n/**\n * @return {module:ol/ImageState} Image state.\n */\nIconImage.prototype.getImageState = function() {\n  return this.imageState_;\n};\n\n\n/**\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image element.\n */\nIconImage.prototype.getHitDetectionImage = function(pixelRatio) {\n  if (!this.hitDetectionImage_) {\n    if (this.tainting_) {\n      const width = this.size_[0];\n      const height = this.size_[1];\n      const context = createCanvasContext2D(width, height);\n      context.fillRect(0, 0, width, height);\n      this.hitDetectionImage_ = context.canvas;\n    } else {\n      this.hitDetectionImage_ = this.image_;\n    }\n  }\n  return this.hitDetectionImage_;\n};\n\n\n/**\n * @return {module:ol/size~Size} Image size.\n */\nIconImage.prototype.getSize = function() {\n  return this.size_;\n};\n\n\n/**\n * @return {string|undefined} Image src.\n */\nIconImage.prototype.getSrc = function() {\n  return this.src_;\n};\n\n\n/**\n * Load not yet loaded URI.\n */\nIconImage.prototype.load = function() {\n  if (this.imageState_ == ImageState.IDLE) {\n    this.imageState_ = ImageState.LOADING;\n    this.imageListenerKeys_ = [\n      listenOnce(this.image_, EventType.ERROR,\n        this.handleImageError_, this),\n      listenOnce(this.image_, EventType.LOAD,\n        this.handleImageLoad_, this)\n    ];\n    try {\n      this.image_.src = this.src_;\n    } catch (e) {\n      this.handleImageError_();\n    }\n  }\n};\n\n\n/**\n * @private\n */\nIconImage.prototype.replaceColor_ = function() {\n  if (this.tainting_ || this.color_ === null) {\n    return;\n  }\n\n  this.canvas_.width = this.image_.width;\n  this.canvas_.height = this.image_.height;\n\n  const ctx = this.canvas_.getContext('2d');\n  ctx.drawImage(this.image_, 0, 0);\n\n  const imgData = ctx.getImageData(0, 0, this.image_.width, this.image_.height);\n  const data = imgData.data;\n  const r = this.color_[0] / 255.0;\n  const g = this.color_[1] / 255.0;\n  const b = this.color_[2] / 255.0;\n\n  for (let i = 0, ii = data.length; i < ii; i += 4) {\n    data[i] *= r;\n    data[i + 1] *= g;\n    data[i + 2] *= b;\n  }\n  ctx.putImageData(imgData, 0, 0);\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\nIconImage.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\nexport default IconImage;\n","/**\n * @module ol/format/KML\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport {extend, includes} from '../array.js';\nimport {assert} from '../asserts.js';\nimport {asArray} from '../color.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport XMLFeature from '../format/XMLFeature.js';\nimport {readDecimal, readBoolean, readString, writeStringTextNode, writeCDATASection, writeDecimalTextNode, writeBooleanTextNode} from '../format/xsd.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {toRadians} from '../math.js';\nimport {get as getProjection} from '../proj.js';\nimport Fill from '../style/Fill.js';\nimport Icon from '../style/Icon.js';\nimport IconAnchorUnits from '../style/IconAnchorUnits.js';\nimport IconOrigin from '../style/IconOrigin.js';\nimport Stroke from '../style/Stroke.js';\nimport Style from '../style/Style.js';\nimport Text from '../style/Text.js';\nimport {createElementNS, getAllTextContent, isDocument, isNode, makeArrayExtender,\n  makeArrayPusher, makeChildAppender, makeObjectPropertySetter,\n  makeReplacer, makeSequence, makeSimpleNodeFactory, makeStructureNS,\n  OBJECT_PROPERTY_NODE_FACTORY, parse, parseNode, pushParseAndPop,\n  pushSerializeAndPop, XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n/**\n * @typedef {Object} Vec2\n * @property {number} x\n * @property {module:ol/style/IconAnchorUnits} xunits\n * @property {number} y\n * @property {module:ol/style/IconAnchorUnits} yunits\n * @property {module:ol/style/IconOrigin} origin\n */\n\n/**\n * @typedef {Object} GxTrackObject\n * @property {Array.<number>} flatCoordinates\n * @property {Array.<number>} whens\n */\n\n/**\n * @type {module:ol/color~Color}\n */\nlet DEFAULT_COLOR;\n\n/**\n * @type {module:ol/style/Fill}\n */\nlet DEFAULT_FILL_STYLE = null;\n\n/**\n * Get the default fill style (or null if not yet set).\n * @return {module:ol/style/Fill} The default fill style.\n */\nexport function getDefaultFillStyle() {\n  return DEFAULT_FILL_STYLE;\n}\n\n/**\n * @type {module:ol/size~Size}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR;\n\n/**\n * @type {module:ol/style/IconAnchorUnits}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\n\n/**\n * @type {module:ol/style/IconAnchorUnits}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\n\n/**\n * @type {module:ol/size~Size}\n */\nlet DEFAULT_IMAGE_STYLE_SIZE;\n\n/**\n * @type {string}\n */\nlet DEFAULT_IMAGE_STYLE_SRC;\n\n/**\n * @type {number}\n */\nlet DEFAULT_IMAGE_SCALE_MULTIPLIER;\n\n/**\n * @type {module:ol/style/Image}\n */\nlet DEFAULT_IMAGE_STYLE = null;\n\n/**\n * Get the default image style (or null if not yet set).\n * @return {module:ol/style/Image} The default image style.\n */\nexport function getDefaultImageStyle() {\n  return DEFAULT_IMAGE_STYLE;\n}\n\n/**\n * @type {string}\n */\nlet DEFAULT_NO_IMAGE_STYLE;\n\n/**\n * @type {module:ol/style/Stroke}\n */\nlet DEFAULT_STROKE_STYLE = null;\n\n/**\n * Get the default stroke style (or null if not yet set).\n * @return {module:ol/style/Stroke} The default stroke style.\n */\nexport function getDefaultStrokeStyle() {\n  return DEFAULT_STROKE_STYLE;\n}\n\n/**\n * @type {module:ol/style/Stroke}\n */\nlet DEFAULT_TEXT_STROKE_STYLE;\n\n/**\n * @type {module:ol/style/Text}\n */\nlet DEFAULT_TEXT_STYLE = null;\n\n/**\n * Get the default text style (or null if not yet set).\n * @return {module:ol/style/Text} The default text style.\n */\nexport function getDefaultTextStyle() {\n  return DEFAULT_TEXT_STYLE;\n}\n\n/**\n * @type {module:ol/style/Style}\n */\nlet DEFAULT_STYLE = null;\n\n/**\n * Get the default style (or null if not yet set).\n * @return {module:ol/style/Style} The default style.\n */\nexport function getDefaultStyle() {\n  return DEFAULT_STYLE;\n}\n\n/**\n * @type {Array.<module:ol/style/Style>}\n */\nlet DEFAULT_STYLE_ARRAY = null;\n\n/**\n * Get the default style array (or null if not yet set).\n * @return {Array.<module:ol/style/Style>} The default style.\n */\nexport function getDefaultStyleArray() {\n  return DEFAULT_STYLE_ARRAY;\n}\n\n\nfunction createStyleDefaults() {\n\n  DEFAULT_COLOR = [255, 255, 255, 1];\n\n  DEFAULT_FILL_STYLE = new Fill({\n    color: DEFAULT_COLOR\n  });\n\n  DEFAULT_IMAGE_STYLE_ANCHOR = [20, 2]; // FIXME maybe [8, 32] ?\n\n  DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS = IconAnchorUnits.PIXELS;\n\n  DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS = IconAnchorUnits.PIXELS;\n\n  DEFAULT_IMAGE_STYLE_SIZE = [64, 64];\n\n  DEFAULT_IMAGE_STYLE_SRC =\n      'https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png';\n\n  DEFAULT_IMAGE_SCALE_MULTIPLIER = 0.5;\n\n  DEFAULT_IMAGE_STYLE = new Icon({\n    anchor: DEFAULT_IMAGE_STYLE_ANCHOR,\n    anchorOrigin: IconOrigin.BOTTOM_LEFT,\n    anchorXUnits: DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,\n    anchorYUnits: DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,\n    crossOrigin: 'anonymous',\n    rotation: 0,\n    scale: DEFAULT_IMAGE_SCALE_MULTIPLIER,\n    size: DEFAULT_IMAGE_STYLE_SIZE,\n    src: DEFAULT_IMAGE_STYLE_SRC\n  });\n\n  DEFAULT_NO_IMAGE_STYLE = 'NO_IMAGE';\n\n  DEFAULT_STROKE_STYLE = new Stroke({\n    color: DEFAULT_COLOR,\n    width: 1\n  });\n\n  DEFAULT_TEXT_STROKE_STYLE = new Stroke({\n    color: [51, 51, 51, 1],\n    width: 2\n  });\n\n  DEFAULT_TEXT_STYLE = new Text({\n    font: 'bold 16px Helvetica',\n    fill: DEFAULT_FILL_STYLE,\n    stroke: DEFAULT_TEXT_STROKE_STYLE,\n    scale: 0.8\n  });\n\n  DEFAULT_STYLE = new Style({\n    fill: DEFAULT_FILL_STYLE,\n    image: DEFAULT_IMAGE_STYLE,\n    text: DEFAULT_TEXT_STYLE,\n    stroke: DEFAULT_STROKE_STYLE,\n    zIndex: 0\n  });\n\n  DEFAULT_STYLE_ARRAY = [DEFAULT_STYLE];\n\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [extractStyles=true] Extract styles from the KML.\n * @property {boolean} [showPointNames=true] Show names as labels for placemarks which contain points.\n * @property {Array.<module:ol/style/Style>} [defaultStyle] Default style. The\n * default default style is the same as Google Earth.\n * @property {boolean} [writeStyles=true] Write styles into KML.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the KML format.\n *\n * Note that the KML format uses the URL() constructor. Older browsers such as IE\n * which do not support this will need a URL polyfill to be loaded before use.\n *\n * @constructor\n * @extends {module:ol/format/XMLFeature}\n * @param {module:ol/format/KML~Options=} opt_options Options.\n * @api\n */\nconst KML = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  XMLFeature.call(this);\n\n  if (!DEFAULT_STYLE_ARRAY) {\n    createStyleDefaults();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  this.dataProjection = getProjection('EPSG:4326');\n\n  /**\n   * @private\n   * @type {Array.<module:ol/style/Style>}\n   */\n  this.defaultStyle_ = options.defaultStyle ?\n    options.defaultStyle : DEFAULT_STYLE_ARRAY;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.extractStyles_ = options.extractStyles !== undefined ?\n    options.extractStyles : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.writeStyles_ = options.writeStyles !== undefined ?\n    options.writeStyles : true;\n\n  /**\n   * @private\n   * @type {!Object.<string, (Array.<module:ol/style/Style>|string)>}\n   */\n  this.sharedStyles_ = {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.showPointNames_ = options.showPointNames !== undefined ?\n    options.showPointNames : true;\n\n};\n\ninherits(KML, XMLFeature);\n\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst GX_NAMESPACE_URIS = [\n  'http://www.google.com/kml/ext/2.2'\n];\n\n\n/**\n * @const\n * @type {Array.<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://earth.google.com/kml/2.0',\n  'http://earth.google.com/kml/2.1',\n  'http://earth.google.com/kml/2.2',\n  'http://www.opengis.net/kml/2.2'\n];\n\n\n/**\n * @const\n * @type {string}\n */\nconst SCHEMA_LOCATION = 'http://www.opengis.net/kml/2.2 ' +\n    'https://developers.google.com/kml/schema/kml22gx.xsd';\n\n\n/**\n * @type {Object.<string, module:ol/style/IconAnchorUnits>}\n */\nconst ICON_ANCHOR_UNITS_MAP = {\n  'fraction': IconAnchorUnits.FRACTION,\n  'pixels': IconAnchorUnits.PIXELS,\n  'insetPixels': IconAnchorUnits.PIXELS\n};\n\n\n/**\n * @param {module:ol/style/Style|undefined} foundStyle Style.\n * @param {string} name Name.\n * @return {module:ol/style/Style} style Style.\n */\nfunction createNameStyleFunction(foundStyle, name) {\n  let textStyle = null;\n  const textOffset = [0, 0];\n  let textAlign = 'start';\n  if (foundStyle.getImage()) {\n    let imageSize = foundStyle.getImage().getImageSize();\n    if (imageSize === null) {\n      imageSize = DEFAULT_IMAGE_STYLE_SIZE;\n    }\n    if (imageSize.length == 2) {\n      const imageScale = foundStyle.getImage().getScale();\n      // Offset the label to be centered to the right of the icon, if there is\n      // one.\n      textOffset[0] = imageScale * imageSize[0] / 2;\n      textOffset[1] = -imageScale * imageSize[1] / 2;\n      textAlign = 'left';\n    }\n  }\n  if (foundStyle.getText() !== null) {\n    // clone the text style, customizing it with name, alignments and offset.\n    // Note that kml does not support many text options that OpenLayers does (rotation, textBaseline).\n    const foundText = foundStyle.getText();\n    textStyle = foundText.clone();\n    textStyle.setFont(foundText.getFont() || DEFAULT_TEXT_STYLE.getFont());\n    textStyle.setScale(foundText.getScale() || DEFAULT_TEXT_STYLE.getScale());\n    textStyle.setFill(foundText.getFill() || DEFAULT_TEXT_STYLE.getFill());\n    textStyle.setStroke(foundText.getStroke() || DEFAULT_TEXT_STROKE_STYLE);\n  } else {\n    textStyle = DEFAULT_TEXT_STYLE.clone();\n  }\n  textStyle.setText(name);\n  textStyle.setOffsetX(textOffset[0]);\n  textStyle.setOffsetY(textOffset[1]);\n  textStyle.setTextAlign(textAlign);\n\n  const nameStyle = new Style({\n    text: textStyle\n  });\n  return nameStyle;\n}\n\n\n/**\n * @param {Array.<module:ol/style/Style>|undefined} style Style.\n * @param {string} styleUrl Style URL.\n * @param {Array.<module:ol/style/Style>} defaultStyle Default style.\n * @param {!Object.<string, (Array.<module:ol/style/Style>|string)>} sharedStyles Shared styles.\n * @param {boolean|undefined} showPointNames true to show names for point placemarks.\n * @return {module:ol/style/Style~StyleFunction} Feature style function.\n */\nfunction createFeatureStyleFunction(style, styleUrl, defaultStyle, sharedStyles, showPointNames) {\n\n  return (\n    /**\n     * @param {module:ol/Feature} feature feature.\n     * @param {number} resolution Resolution.\n     * @return {Array.<module:ol/style/Style>} Style.\n     */\n    function(feature, resolution) {\n      let drawName = showPointNames;\n      /** @type {module:ol/style/Style|undefined} */\n      let nameStyle;\n      let name = '';\n      if (drawName) {\n        const geometry = feature.getGeometry();\n        if (geometry) {\n          drawName = geometry.getType() === GeometryType.POINT;\n        }\n      }\n\n      if (drawName) {\n        name = /** @type {string} */ (feature.get('name'));\n        drawName = drawName && name;\n      }\n\n      if (style) {\n        if (drawName) {\n          nameStyle = createNameStyleFunction(style[0], name);\n          return style.concat(nameStyle);\n        }\n        return style;\n      }\n      if (styleUrl) {\n        const foundStyle = findStyle(styleUrl, defaultStyle, sharedStyles);\n        if (drawName) {\n          nameStyle = createNameStyleFunction(foundStyle[0], name);\n          return foundStyle.concat(nameStyle);\n        }\n        return foundStyle;\n      }\n      if (drawName) {\n        nameStyle = createNameStyleFunction(defaultStyle[0], name);\n        return defaultStyle.concat(nameStyle);\n      }\n      return defaultStyle;\n    }\n  );\n}\n\n\n/**\n * @param {Array.<module:ol/style/Style>|string|undefined} styleValue Style value.\n * @param {Array.<module:ol/style/Style>} defaultStyle Default style.\n * @param {!Object.<string, (Array.<module:ol/style/Style>|string)>} sharedStyles\n * Shared styles.\n * @return {Array.<module:ol/style/Style>} Style.\n */\nfunction findStyle(styleValue, defaultStyle, sharedStyles) {\n  if (Array.isArray(styleValue)) {\n    return styleValue;\n  } else if (typeof styleValue === 'string') {\n    // KML files in the wild occasionally forget the leading `#` on styleUrls\n    // defined in the same document.  Add a leading `#` if it enables to find\n    // a style.\n    if (!(styleValue in sharedStyles) && ('#' + styleValue in sharedStyles)) {\n      styleValue = '#' + styleValue;\n    }\n    return findStyle(sharedStyles[styleValue], defaultStyle, sharedStyles);\n  } else {\n    return defaultStyle;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {module:ol/color~Color|undefined} Color.\n */\nfunction readColor(node) {\n  const s = getAllTextContent(node, false);\n  // The KML specification states that colors should not include a leading `#`\n  // but we tolerate them.\n  const m = /^\\s*#?\\s*([0-9A-Fa-f]{8})\\s*$/.exec(s);\n  if (m) {\n    const hexColor = m[1];\n    return [\n      parseInt(hexColor.substr(6, 2), 16),\n      parseInt(hexColor.substr(4, 2), 16),\n      parseInt(hexColor.substr(2, 2), 16),\n      parseInt(hexColor.substr(0, 2), 16) / 255\n    ];\n\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {Array.<number>|undefined} Flat coordinates.\n */\nexport function readFlatCoordinates(node) {\n  let s = getAllTextContent(node, false);\n  const flatCoordinates = [];\n  // The KML specification states that coordinate tuples should not include\n  // spaces, but we tolerate them.\n  const re =\n      /^\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)(?:\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?))?\\s*/i;\n  let m;\n  while ((m = re.exec(s))) {\n    const x = parseFloat(m[1]);\n    const y = parseFloat(m[2]);\n    const z = m[3] ? parseFloat(m[3]) : 0;\n    flatCoordinates.push(x, y, z);\n    s = s.substr(m[0].length);\n  }\n  if (s !== '') {\n    return undefined;\n  }\n  return flatCoordinates;\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {string} URI.\n */\nfunction readURI(node) {\n  const s = getAllTextContent(node, false).trim();\n  let baseURI = node.baseURI;\n  if (!baseURI || baseURI == 'about:blank') {\n    baseURI = window.location.href;\n  }\n  if (baseURI) {\n    const url = new URL(s, baseURI);\n    return url.href;\n  } else {\n    return s;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {module:ol/format/KML~Vec2} Vec2.\n */\nfunction readVec2(node) {\n  const xunits = node.getAttribute('xunits');\n  const yunits = node.getAttribute('yunits');\n  let origin;\n  if (xunits !== 'insetPixels') {\n    if (yunits !== 'insetPixels') {\n      origin = IconOrigin.BOTTOM_LEFT;\n    } else {\n      origin = IconOrigin.TOP_LEFT;\n    }\n  } else {\n    if (yunits !== 'insetPixels') {\n      origin = IconOrigin.BOTTOM_RIGHT;\n    } else {\n      origin = IconOrigin.TOP_RIGHT;\n    }\n  }\n  return {\n    x: parseFloat(node.getAttribute('x')),\n    xunits: ICON_ANCHOR_UNITS_MAP[xunits],\n    y: parseFloat(node.getAttribute('y')),\n    yunits: ICON_ANCHOR_UNITS_MAP[yunits],\n    origin: origin\n  };\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Scale.\n */\nfunction readScale(node) {\n  return readDecimal(node);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst STYLE_MAP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Pair': pairDataParser\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<module:ol/style/Style>|string|undefined} StyleMap.\n */\nfunction readStyleMapValue(node, objectStack) {\n  return pushParseAndPop(undefined,\n    STYLE_MAP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst ICON_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Icon': makeObjectPropertySetter(readIcon),\n    'heading': makeObjectPropertySetter(readDecimal),\n    'hotSpot': makeObjectPropertySetter(readVec2),\n    'scale': makeObjectPropertySetter(readScale)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction iconStyleParser(node, objectStack) {\n  // FIXME refreshMode\n  // FIXME refreshInterval\n  // FIXME viewRefreshTime\n  // FIXME viewBoundScale\n  // FIXME viewFormat\n  // FIXME httpQuery\n  const object = pushParseAndPop(\n    {}, ICON_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const IconObject = 'Icon' in object ? object['Icon'] : {};\n  const drawIcon = (!('Icon' in object) || Object.keys(IconObject).length > 0);\n  let src;\n  const href = /** @type {string|undefined} */\n      (IconObject['href']);\n  if (href) {\n    src = href;\n  } else if (drawIcon) {\n    src = DEFAULT_IMAGE_STYLE_SRC;\n  }\n  let anchor, anchorXUnits, anchorYUnits;\n  let anchorOrigin = IconOrigin.BOTTOM_LEFT;\n  const hotSpot = /** @type {module:ol/format/KML~Vec2|undefined} */\n      (object['hotSpot']);\n  if (hotSpot) {\n    anchor = [hotSpot.x, hotSpot.y];\n    anchorXUnits = hotSpot.xunits;\n    anchorYUnits = hotSpot.yunits;\n    anchorOrigin = hotSpot.origin;\n  } else if (src === DEFAULT_IMAGE_STYLE_SRC) {\n    anchor = DEFAULT_IMAGE_STYLE_ANCHOR;\n    anchorXUnits = DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\n    anchorYUnits = DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\n  } else if (/^http:\\/\\/maps\\.(?:google|gstatic)\\.com\\//.test(src)) {\n    anchor = [0.5, 0];\n    anchorXUnits = IconAnchorUnits.FRACTION;\n    anchorYUnits = IconAnchorUnits.FRACTION;\n  }\n\n  let offset;\n  const x = /** @type {number|undefined} */\n      (IconObject['x']);\n  const y = /** @type {number|undefined} */\n      (IconObject['y']);\n  if (x !== undefined && y !== undefined) {\n    offset = [x, y];\n  }\n\n  let size;\n  const w = /** @type {number|undefined} */\n      (IconObject['w']);\n  const h = /** @type {number|undefined} */\n      (IconObject['h']);\n  if (w !== undefined && h !== undefined) {\n    size = [w, h];\n  }\n\n  let rotation;\n  const heading = /** @type {number} */\n      (object['heading']);\n  if (heading !== undefined) {\n    rotation = toRadians(heading);\n  }\n\n  let scale = /** @type {number|undefined} */\n      (object['scale']);\n\n  if (drawIcon) {\n    if (src == DEFAULT_IMAGE_STYLE_SRC) {\n      size = DEFAULT_IMAGE_STYLE_SIZE;\n      if (scale === undefined) {\n        scale = DEFAULT_IMAGE_SCALE_MULTIPLIER;\n      }\n    }\n\n    const imageStyle = new Icon({\n      anchor: anchor,\n      anchorOrigin: anchorOrigin,\n      anchorXUnits: anchorXUnits,\n      anchorYUnits: anchorYUnits,\n      crossOrigin: 'anonymous', // FIXME should this be configurable?\n      offset: offset,\n      offsetOrigin: IconOrigin.BOTTOM_LEFT,\n      rotation: rotation,\n      scale: scale,\n      size: size,\n      src: src\n    });\n    styleObject['imageStyle'] = imageStyle;\n  } else {\n    // handle the case when we explicitly want to draw no icon.\n    styleObject['imageStyle'] = DEFAULT_NO_IMAGE_STYLE;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LABEL_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'scale': makeObjectPropertySetter(readScale)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction labelStyleParser(node, objectStack) {\n  // FIXME colorMode\n  const object = pushParseAndPop(\n    {}, LABEL_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const textStyle = new Text({\n    fill: new Fill({\n      color: /** @type {module:ol/color~Color} */\n          ('color' in object ? object['color'] : DEFAULT_COLOR)\n    }),\n    scale: /** @type {number|undefined} */\n        (object['scale'])\n  });\n  styleObject['textStyle'] = textStyle;\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LINE_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'width': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction lineStyleParser(node, objectStack) {\n  // FIXME colorMode\n  // FIXME gx:outerColor\n  // FIXME gx:outerWidth\n  // FIXME gx:physicalWidth\n  // FIXME gx:labelVisibility\n  const object = pushParseAndPop(\n    {}, LINE_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const strokeStyle = new Stroke({\n    color: /** @type {module:ol/color~Color} */\n        ('color' in object ? object['color'] : DEFAULT_COLOR),\n    width: /** @type {number} */ ('width' in object ? object['width'] : 1)\n  });\n  styleObject['strokeStyle'] = strokeStyle;\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst POLY_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'fill': makeObjectPropertySetter(readBoolean),\n    'outline': makeObjectPropertySetter(readBoolean)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction polyStyleParser(node, objectStack) {\n  // FIXME colorMode\n  const object = pushParseAndPop(\n    {}, POLY_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const fillStyle = new Fill({\n    color: /** @type {module:ol/color~Color} */\n        ('color' in object ? object['color'] : DEFAULT_COLOR)\n  });\n  styleObject['fillStyle'] = fillStyle;\n  const fill = /** @type {boolean|undefined} */ (object['fill']);\n  if (fill !== undefined) {\n    styleObject['fill'] = fill;\n  }\n  const outline = /** @type {boolean|undefined} */ (object['outline']);\n  if (outline !== undefined) {\n    styleObject['outline'] = outline;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst FLAT_LINEAR_RING_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'coordinates': makeReplacer(readFlatCoordinates)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<number>} LinearRing flat coordinates.\n */\nfunction readFlatLinearRing(node, objectStack) {\n  return pushParseAndPop(null,\n    FLAT_LINEAR_RING_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction gxCoordParser(node, objectStack) {\n  const gxTrackObject = /** @type {module:ol/format/KML~GxTrackObject} */\n      (objectStack[objectStack.length - 1]);\n  const flatCoordinates = gxTrackObject.flatCoordinates;\n  const s = getAllTextContent(node, false);\n  const re =\n      /^\\s*([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s*$/i;\n  const m = re.exec(s);\n  if (m) {\n    const x = parseFloat(m[1]);\n    const y = parseFloat(m[2]);\n    const z = parseFloat(m[3]);\n    flatCoordinates.push(x, y, z, 0);\n  } else {\n    flatCoordinates.push(0, 0, 0, 0);\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst GX_MULTITRACK_GEOMETRY_PARSERS = makeStructureNS(\n  GX_NAMESPACE_URIS, {\n    'Track': makeArrayPusher(readGxTrack)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/MultiLineString|undefined} MultiLineString.\n */\nfunction readGxMultiTrack(node, objectStack) {\n  const lineStrings = pushParseAndPop([],\n    GX_MULTITRACK_GEOMETRY_PARSERS, node, objectStack);\n  if (!lineStrings) {\n    return undefined;\n  }\n  const multiLineString = new MultiLineString(null);\n  multiLineString.setLineStrings(lineStrings);\n  return multiLineString;\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst GX_TRACK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'when': whenParser\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'coord': gxCoordParser\n    }));\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/LineString|undefined} LineString.\n */\nfunction readGxTrack(node, objectStack) {\n  const gxTrackObject = pushParseAndPop(\n    /** @type {module:ol/format/KML~GxTrackObject} */ ({\n      flatCoordinates: [],\n      whens: []\n    }), GX_TRACK_PARSERS, node, objectStack);\n  if (!gxTrackObject) {\n    return undefined;\n  }\n  const flatCoordinates = gxTrackObject.flatCoordinates;\n  const whens = gxTrackObject.whens;\n  for (let i = 0, ii = Math.min(flatCoordinates.length, whens.length); i < ii; ++i) {\n    flatCoordinates[4 * i + 3] = whens[i];\n  }\n  const lineString = new LineString(null);\n  lineString.setFlatCoordinates(GeometryLayout.XYZM, flatCoordinates);\n  return lineString;\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst ICON_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeObjectPropertySetter(readURI)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'x': makeObjectPropertySetter(readDecimal),\n      'y': makeObjectPropertySetter(readDecimal),\n      'w': makeObjectPropertySetter(readDecimal),\n      'h': makeObjectPropertySetter(readDecimal)\n    }));\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object} Icon object.\n */\nfunction readIcon(node, objectStack) {\n  const iconObject = pushParseAndPop(\n    {}, ICON_PARSERS, node, objectStack);\n  if (iconObject) {\n    return iconObject;\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst GEOMETRY_FLAT_COORDINATES_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'coordinates': makeReplacer(readFlatCoordinates)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<number>} Flat coordinates.\n */\nfunction readFlatCoordinatesFromNode(node, objectStack) {\n  return pushParseAndPop(null,\n    GEOMETRY_FLAT_COORDINATES_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst EXTRUDE_AND_ALTITUDE_MODE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'extrude': makeObjectPropertySetter(readBoolean),\n    'tessellate': makeObjectPropertySetter(readBoolean),\n    'altitudeMode': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/LineString|undefined} LineString.\n */\nfunction readLineString(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const lineString = new LineString(null);\n    lineString.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates);\n    lineString.setProperties(properties);\n    return lineString;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/Polygon|undefined} Polygon.\n */\nfunction readLinearRing(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const polygon = new Polygon(null);\n    polygon.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates,\n      [flatCoordinates.length]);\n    polygon.setProperties(properties);\n    return polygon;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst MULTI_GEOMETRY_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LineString': makeArrayPusher(readLineString),\n    'LinearRing': makeArrayPusher(readLinearRing),\n    'MultiGeometry': makeArrayPusher(readMultiGeometry),\n    'Point': makeArrayPusher(readPoint),\n    'Polygon': makeArrayPusher(readPolygon)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/Geometry} Geometry.\n */\nfunction readMultiGeometry(node, objectStack) {\n  const geometries = pushParseAndPop([],\n    MULTI_GEOMETRY_PARSERS, node, objectStack);\n  if (!geometries) {\n    return null;\n  }\n  if (geometries.length === 0) {\n    return new GeometryCollection(geometries);\n  }\n  /** @type {module:ol/geom/Geometry} */\n  let multiGeometry;\n  let homogeneous = true;\n  const type = geometries[0].getType();\n  let geometry;\n  for (let i = 1, ii = geometries.length; i < ii; ++i) {\n    geometry = geometries[i];\n    if (geometry.getType() != type) {\n      homogeneous = false;\n      break;\n    }\n  }\n  if (homogeneous) {\n    let layout;\n    let flatCoordinates;\n    if (type == GeometryType.POINT) {\n      const point = geometries[0];\n      layout = point.getLayout();\n      flatCoordinates = point.getFlatCoordinates();\n      for (let i = 1, ii = geometries.length; i < ii; ++i) {\n        geometry = geometries[i];\n        extend(flatCoordinates, geometry.getFlatCoordinates());\n      }\n      multiGeometry = new MultiPoint(null);\n      multiGeometry.setFlatCoordinates(layout, flatCoordinates);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.LINE_STRING) {\n      multiGeometry = new MultiLineString(null);\n      multiGeometry.setLineStrings(geometries);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.POLYGON) {\n      multiGeometry = new MultiPolygon(null);\n      multiGeometry.setPolygons(geometries);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.GEOMETRY_COLLECTION) {\n      multiGeometry = new GeometryCollection(geometries);\n    } else {\n      assert(false, 37); // Unknown geometry type found\n    }\n  } else {\n    multiGeometry = new GeometryCollection(geometries);\n  }\n  return (\n    /** @type {module:ol/geom/Geometry} */ (multiGeometry)\n  );\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/Point|undefined} Point.\n */\nfunction readPoint(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const point = new Point(null);\n    point.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates);\n    point.setProperties(properties);\n    return point;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst FLAT_LINEAR_RINGS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'innerBoundaryIs': innerBoundaryIsParser,\n    'outerBoundaryIs': outerBoundaryIsParser\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/geom/Polygon|undefined} Polygon.\n */\nfunction readPolygon(node, objectStack) {\n  const properties = pushParseAndPop(/** @type {Object<string,*>} */ ({}),\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatLinearRings = pushParseAndPop([null],\n    FLAT_LINEAR_RINGS_PARSERS, node, objectStack);\n  if (flatLinearRings && flatLinearRings[0]) {\n    const polygon = new Polygon(null);\n    const flatCoordinates = flatLinearRings[0];\n    const ends = [flatCoordinates.length];\n    for (let i = 1, ii = flatLinearRings.length; i < ii; ++i) {\n      extend(flatCoordinates, flatLinearRings[i]);\n      ends.push(flatCoordinates.length);\n    }\n    polygon.setFlatCoordinates(GeometryLayout.XYZ, flatCoordinates, ends);\n    polygon.setProperties(properties);\n    return polygon;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'IconStyle': iconStyleParser,\n    'LabelStyle': labelStyleParser,\n    'LineStyle': lineStyleParser,\n    'PolyStyle': polyStyleParser\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<module:ol/style/Style>} Style.\n */\nfunction readStyle(node, objectStack) {\n  const styleObject = pushParseAndPop(\n    {}, STYLE_PARSERS, node, objectStack);\n  if (!styleObject) {\n    return null;\n  }\n  let fillStyle = /** @type {module:ol/style/Fill} */\n      ('fillStyle' in styleObject ?\n        styleObject['fillStyle'] : DEFAULT_FILL_STYLE);\n  const fill = /** @type {boolean|undefined} */ (styleObject['fill']);\n  if (fill !== undefined && !fill) {\n    fillStyle = null;\n  }\n  let imageStyle = /** @type {module:ol/style/Image} */\n      ('imageStyle' in styleObject ?\n        styleObject['imageStyle'] : DEFAULT_IMAGE_STYLE);\n  if (imageStyle == DEFAULT_NO_IMAGE_STYLE) {\n    imageStyle = undefined;\n  }\n  const textStyle = /** @type {module:ol/style/Text} */\n      ('textStyle' in styleObject ?\n        styleObject['textStyle'] : DEFAULT_TEXT_STYLE);\n  let strokeStyle = /** @type {module:ol/style/Stroke} */\n      ('strokeStyle' in styleObject ?\n        styleObject['strokeStyle'] : DEFAULT_STROKE_STYLE);\n  const outline = /** @type {boolean|undefined} */\n      (styleObject['outline']);\n  if (outline !== undefined && !outline) {\n    strokeStyle = null;\n  }\n  return [new Style({\n    fill: fillStyle,\n    image: imageStyle,\n    stroke: strokeStyle,\n    text: textStyle,\n    zIndex: undefined // FIXME\n  })];\n}\n\n\n/**\n * Reads an array of geometries and creates arrays for common geometry\n * properties. Then sets them to the multi geometry.\n * @param {module:ol/geom/MultiPoint|module:ol/geom/MultiLineString|module:ol/geom/MultiPolygon}\n *     multiGeometry A multi-geometry.\n * @param {Array.<module:ol/geom/Geometry>} geometries List of geometries.\n */\nfunction setCommonGeometryProperties(multiGeometry, geometries) {\n  const ii = geometries.length;\n  const extrudes = new Array(geometries.length);\n  const tessellates = new Array(geometries.length);\n  const altitudeModes = new Array(geometries.length);\n  let hasExtrude, hasTessellate, hasAltitudeMode;\n  hasExtrude = hasTessellate = hasAltitudeMode = false;\n  for (let i = 0; i < ii; ++i) {\n    const geometry = geometries[i];\n    extrudes[i] = geometry.get('extrude');\n    tessellates[i] = geometry.get('tessellate');\n    altitudeModes[i] = geometry.get('altitudeMode');\n    hasExtrude = hasExtrude || extrudes[i] !== undefined;\n    hasTessellate = hasTessellate || tessellates[i] !== undefined;\n    hasAltitudeMode = hasAltitudeMode || altitudeModes[i];\n  }\n  if (hasExtrude) {\n    multiGeometry.set('extrude', extrudes);\n  }\n  if (hasTessellate) {\n    multiGeometry.set('tessellate', tessellates);\n  }\n  if (hasAltitudeMode) {\n    multiGeometry.set('altitudeMode', altitudeModes);\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'displayName': makeObjectPropertySetter(readString),\n    'value': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction dataParser(node, objectStack) {\n  const name = node.getAttribute('name');\n  parseNode(DATA_PARSERS, node, objectStack);\n  const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  if (name !== null) {\n    featureObject[name] = featureObject.value;\n  } else if (featureObject.displayName !== null) {\n    featureObject[featureObject.displayName] = featureObject.value;\n  }\n  delete featureObject['value'];\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst EXTENDED_DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Data': dataParser,\n    'SchemaData': schemaDataParser\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction extendedDataParser(node, objectStack) {\n  parseNode(EXTENDED_DATA_PARSERS, node, objectStack);\n}\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst REGION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LatLonAltBox': latLonAltBoxParser,\n    'Lod': lodParser\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction regionParser(node, objectStack) {\n  parseNode(REGION_PARSERS, node, objectStack);\n}\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst PAIR_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Style': makeObjectPropertySetter(readStyle),\n    'key': makeObjectPropertySetter(readString),\n    'styleUrl': makeObjectPropertySetter(readURI)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction pairDataParser(node, objectStack) {\n  const pairObject = pushParseAndPop(\n    {}, PAIR_PARSERS, node, objectStack);\n  if (!pairObject) {\n    return;\n  }\n  const key = /** @type {string|undefined} */\n      (pairObject['key']);\n  if (key && key == 'normal') {\n    const styleUrl = /** @type {string|undefined} */\n        (pairObject['styleUrl']);\n    if (styleUrl) {\n      objectStack[objectStack.length - 1] = styleUrl;\n    }\n    const Style = /** @type {module:ol/style/Style} */\n        (pairObject['Style']);\n    if (Style) {\n      objectStack[objectStack.length - 1] = Style;\n    }\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction placemarkStyleMapParser(node, objectStack) {\n  const styleMapValue = readStyleMapValue(node, objectStack);\n  if (!styleMapValue) {\n    return;\n  }\n  const placemarkObject = objectStack[objectStack.length - 1];\n  if (Array.isArray(styleMapValue)) {\n    placemarkObject['Style'] = styleMapValue;\n  } else if (typeof styleMapValue === 'string') {\n    placemarkObject['styleUrl'] = styleMapValue;\n  } else {\n    assert(false, 38); // `styleMapValue` has an unknown type\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst SCHEMA_DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'SimpleData': simpleDataParser\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction schemaDataParser(node, objectStack) {\n  parseNode(SCHEMA_DATA_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction simpleDataParser(node, objectStack) {\n  const name = node.getAttribute('name');\n  if (name !== null) {\n    const data = readString(node);\n    const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n    featureObject[name] = data;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LAT_LON_ALT_BOX_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'altitudeMode': makeObjectPropertySetter(readString),\n    'minAltitude': makeObjectPropertySetter(readDecimal),\n    'maxAltitude': makeObjectPropertySetter(readDecimal),\n    'north': makeObjectPropertySetter(readDecimal),\n    'south': makeObjectPropertySetter(readDecimal),\n    'east': makeObjectPropertySetter(readDecimal),\n    'west': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction latLonAltBoxParser(node, objectStack) {\n  const object = pushParseAndPop({}, LAT_LON_ALT_BOX_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const regionObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const extent = [\n    parseFloat(object['west']),\n    parseFloat(object['south']),\n    parseFloat(object['east']),\n    parseFloat(object['north'])\n  ];\n  regionObject['extent'] = extent;\n  regionObject['altitudeMode'] = object['altitudeMode'];\n  regionObject['minAltitude'] = parseFloat(object['minAltitude']);\n  regionObject['maxAltitude'] = parseFloat(object['maxAltitude']);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LOD_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'minLodPixels': makeObjectPropertySetter(readDecimal),\n    'maxLodPixels': makeObjectPropertySetter(readDecimal),\n    'minFadeExtent': makeObjectPropertySetter(readDecimal),\n    'maxFadeExtent': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction lodParser(node, objectStack) {\n  const object = pushParseAndPop({}, LOD_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const lodObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  lodObject['minLodPixels'] = parseFloat(object['minLodPixels']);\n  lodObject['maxLodPixels'] = parseFloat(object['maxLodPixels']);\n  lodObject['minFadeExtent'] = parseFloat(object['minFadeExtent']);\n  lodObject['maxFadeExtent'] = parseFloat(object['maxFadeExtent']);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst INNER_BOUNDARY_IS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeReplacer(readFlatLinearRing)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction innerBoundaryIsParser(node, objectStack) {\n  /** @type {Array.<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    INNER_BOUNDARY_IS_PARSERS, node, objectStack);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array.<Array.<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings.push(flatLinearRing);\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst OUTER_BOUNDARY_IS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeReplacer(readFlatLinearRing)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction outerBoundaryIsParser(node, objectStack) {\n  /** @type {Array.<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    OUTER_BOUNDARY_IS_PARSERS, node, objectStack);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array.<Array.<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings[0] = flatLinearRing;\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst NETWORK_LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': extendedDataParser,\n    'Region': regionParser,\n    'Link': linkParser,\n    'address': makeObjectPropertySetter(readString),\n    'description': makeObjectPropertySetter(readString),\n    'name': makeObjectPropertySetter(readString),\n    'open': makeObjectPropertySetter(readBoolean),\n    'phoneNumber': makeObjectPropertySetter(readString),\n    'visibility': makeObjectPropertySetter(readBoolean)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeObjectPropertySetter(readURI)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction linkParser(node, objectStack) {\n  parseNode(LINK_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction whenParser(node, objectStack) {\n  const gxTrackObject = /** @type {module:ol/format/KML~GxTrackObject} */\n      (objectStack[objectStack.length - 1]);\n  const whens = gxTrackObject.whens;\n  const s = getAllTextContent(node, false);\n  const when = Date.parse(s);\n  whens.push(isNaN(when) ? 0 : when);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst PLACEMARK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': extendedDataParser,\n    'Region': regionParser,\n    'MultiGeometry': makeObjectPropertySetter(\n      readMultiGeometry, 'geometry'),\n    'LineString': makeObjectPropertySetter(\n      readLineString, 'geometry'),\n    'LinearRing': makeObjectPropertySetter(\n      readLinearRing, 'geometry'),\n    'Point': makeObjectPropertySetter(\n      readPoint, 'geometry'),\n    'Polygon': makeObjectPropertySetter(\n      readPolygon, 'geometry'),\n    'Style': makeObjectPropertySetter(readStyle),\n    'StyleMap': placemarkStyleMapParser,\n    'address': makeObjectPropertySetter(readString),\n    'description': makeObjectPropertySetter(readString),\n    'name': makeObjectPropertySetter(readString),\n    'open': makeObjectPropertySetter(readBoolean),\n    'phoneNumber': makeObjectPropertySetter(readString),\n    'styleUrl': makeObjectPropertySetter(readURI),\n    'visibility': makeObjectPropertySetter(readBoolean)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'MultiTrack': makeObjectPropertySetter(\n        readGxMultiTrack, 'geometry'),\n      'Track': makeObjectPropertySetter(\n        readGxTrack, 'geometry')\n    }\n  ));\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {Array.<module:ol/Feature>|undefined} Features.\n */\nKML.prototype.readDocumentOrFolder_ = function(node, objectStack) {\n  // FIXME use scope somehow\n  const parsersNS = makeStructureNS(\n    NAMESPACE_URIS, {\n      'Document': makeArrayExtender(this.readDocumentOrFolder_, this),\n      'Folder': makeArrayExtender(this.readDocumentOrFolder_, this),\n      'Placemark': makeArrayPusher(this.readPlacemark_, this),\n      'Style': this.readSharedStyle_.bind(this),\n      'StyleMap': this.readSharedStyleMap_.bind(this)\n    });\n  /** @type {Array.<module:ol/Feature>} */\n  const features = pushParseAndPop([], parsersNS, node, objectStack, this);\n  if (features) {\n    return features;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n * @return {module:ol/Feature|undefined} Feature.\n */\nKML.prototype.readPlacemark_ = function(node, objectStack) {\n  const object = pushParseAndPop({'geometry': null},\n    PLACEMARK_PARSERS, node, objectStack);\n  if (!object) {\n    return undefined;\n  }\n  const feature = new Feature();\n  const id = node.getAttribute('id');\n  if (id !== null) {\n    feature.setId(id);\n  }\n  const options = /** @type {module:ol/format/Feature~ReadOptions} */ (objectStack[0]);\n\n  const geometry = object['geometry'];\n  if (geometry) {\n    transformWithOptions(geometry, false, options);\n  }\n  feature.setGeometry(geometry);\n  delete object['geometry'];\n\n  if (this.extractStyles_) {\n    const style = object['Style'];\n    const styleUrl = object['styleUrl'];\n    const styleFunction = createFeatureStyleFunction(\n      style, styleUrl, this.defaultStyle_, this.sharedStyles_,\n      this.showPointNames_);\n    feature.setStyle(styleFunction);\n  }\n  delete object['Style'];\n  // we do not remove the styleUrl property from the object, so it\n  // gets stored on feature when setProperties is called\n\n  feature.setProperties(object);\n\n  return feature;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nKML.prototype.readSharedStyle_ = function(node, objectStack) {\n  const id = node.getAttribute('id');\n  if (id !== null) {\n    const style = readStyle(node, objectStack);\n    if (style) {\n      let styleUri;\n      let baseURI = node.baseURI;\n      if (!baseURI || baseURI == 'about:blank') {\n        baseURI = window.location.href;\n      }\n      if (baseURI) {\n        const url = new URL('#' + id, baseURI);\n        styleUri = url.href;\n      } else {\n        styleUri = '#' + id;\n      }\n      this.sharedStyles_[styleUri] = style;\n    }\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @private\n */\nKML.prototype.readSharedStyleMap_ = function(node, objectStack) {\n  const id = node.getAttribute('id');\n  if (id === null) {\n    return;\n  }\n  const styleMapValue = readStyleMapValue(node, objectStack);\n  if (!styleMapValue) {\n    return;\n  }\n  let styleUri;\n  let baseURI = node.baseURI;\n  if (!baseURI || baseURI == 'about:blank') {\n    baseURI = window.location.href;\n  }\n  if (baseURI) {\n    const url = new URL('#' + id, baseURI);\n    styleUri = url.href;\n  } else {\n    styleUri = '#' + id;\n  }\n  this.sharedStyles_[styleUri] = styleMapValue;\n};\n\n\n/**\n * Read the first feature from a KML source. MultiGeometries are converted into\n * GeometryCollections if they are a mix of geometry types, and into MultiPoint/\n * MultiLineString/MultiPolygon if they are all of the same type.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nKML.prototype.readFeature;\n\n\n/**\n * @inheritDoc\n */\nKML.prototype.readFeatureFromNode = function(node, opt_options) {\n  if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n    return null;\n  }\n  const feature = this.readPlacemark_(\n    node, [this.getReadOptions(node, opt_options)]);\n  if (feature) {\n    return feature;\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Read all features from a KML source. MultiGeometries are converted into\n * GeometryCollections if they are a mix of geometry types, and into MultiPoint/\n * MultiLineString/MultiPolygon if they are all of the same type.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nKML.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nKML.prototype.readFeaturesFromNode = function(node, opt_options) {\n  if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n    return [];\n  }\n  let features;\n  const localName = node.localName;\n  if (localName == 'Document' || localName == 'Folder') {\n    features = this.readDocumentOrFolder_(\n      node, [this.getReadOptions(node, opt_options)]);\n    if (features) {\n      return features;\n    } else {\n      return [];\n    }\n  } else if (localName == 'Placemark') {\n    const feature = this.readPlacemark_(\n      node, [this.getReadOptions(node, opt_options)]);\n    if (feature) {\n      return [feature];\n    } else {\n      return [];\n    }\n  } else if (localName == 'kml') {\n    features = [];\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      const fs = this.readFeaturesFromNode(n, opt_options);\n      if (fs) {\n        extend(features, fs);\n      }\n    }\n    return features;\n  } else {\n    return [];\n  }\n};\n\n\n/**\n * Read the name of the KML.\n *\n * @param {Document|Node|string} source Source.\n * @return {string|undefined} Name.\n * @api\n */\nKML.prototype.readName = function(source) {\n  if (isDocument(source)) {\n    return this.readNameFromDocument(/** @type {Document} */ (source));\n  } else if (isNode(source)) {\n    return this.readNameFromNode(/** @type {Node} */ (source));\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readNameFromDocument(doc);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Document} doc Document.\n * @return {string|undefined} Name.\n */\nKML.prototype.readNameFromDocument = function(doc) {\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      const name = this.readNameFromNode(n);\n      if (name) {\n        return name;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @param {Node} node Node.\n * @return {string|undefined} Name.\n */\nKML.prototype.readNameFromNode = function(node) {\n  for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n    if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n        n.localName == 'name') {\n      return readString(n);\n    }\n  }\n  for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n    const localName = n.localName;\n    if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n        (localName == 'Document' ||\n         localName == 'Folder' ||\n         localName == 'Placemark' ||\n         localName == 'kml')) {\n      const name = this.readNameFromNode(n);\n      if (name) {\n        return name;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * Read the network links of the KML.\n *\n * @param {Document|Node|string} source Source.\n * @return {Array.<Object>} Network links.\n * @api\n */\nKML.prototype.readNetworkLinks = function(source) {\n  const networkLinks = [];\n  if (isDocument(source)) {\n    extend(networkLinks, this.readNetworkLinksFromDocument(\n      /** @type {Document} */ (source)));\n  } else if (isNode(source)) {\n    extend(networkLinks, this.readNetworkLinksFromNode(\n      /** @type {Node} */ (source)));\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    extend(networkLinks, this.readNetworkLinksFromDocument(doc));\n  }\n  return networkLinks;\n};\n\n\n/**\n * @param {Document} doc Document.\n * @return {Array.<Object>} Network links.\n */\nKML.prototype.readNetworkLinksFromDocument = function(doc) {\n  const networkLinks = [];\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      extend(networkLinks, this.readNetworkLinksFromNode(n));\n    }\n  }\n  return networkLinks;\n};\n\n\n/**\n * @param {Node} node Node.\n * @return {Array.<Object>} Network links.\n */\nKML.prototype.readNetworkLinksFromNode = function(node) {\n  const networkLinks = [];\n  for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n    if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n        n.localName == 'NetworkLink') {\n      const obj = pushParseAndPop({}, NETWORK_LINK_PARSERS,\n        n, []);\n      networkLinks.push(obj);\n    }\n  }\n  for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n    const localName = n.localName;\n    if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n        (localName == 'Document' ||\n         localName == 'Folder' ||\n         localName == 'kml')) {\n      extend(networkLinks, this.readNetworkLinksFromNode(n));\n    }\n  }\n  return networkLinks;\n};\n\n\n/**\n * Read the regions of the KML.\n *\n * @param {Document|Node|string} source Source.\n * @return {Array.<Object>} Regions.\n * @api\n */\nKML.prototype.readRegion = function(source) {\n  const regions = [];\n  if (isDocument(source)) {\n    extend(regions, this.readRegionFromDocument(\n      /** @type {Document} */ (source)));\n  } else if (isNode(source)) {\n    extend(regions, this.readRegionFromNode(\n      /** @type {Node} */ (source)));\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    extend(regions, this.readRegionFromDocument(doc));\n  }\n  return regions;\n};\n\n\n/**\n * @param {Document} doc Document.\n * @return {Array.<Object>} Region.\n */\nKML.prototype.readRegionFromDocument = function(doc) {\n  const regions = [];\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      extend(regions, this.readRegionFromNode(n));\n    }\n  }\n  return regions;\n};\n\n\n/**\n * @param {Node} node Node.\n * @return {Array.<Object>} Region.\n * @api\n */\nKML.prototype.readRegionFromNode = function(node) {\n  const regions = [];\n  for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n    if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n        n.localName == 'Region') {\n      const obj = pushParseAndPop({}, REGION_PARSERS,\n        n, []);\n      regions.push(obj);\n    }\n  }\n  for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n    const localName = n.localName;\n    if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n        (localName == 'Document' ||\n         localName == 'Folder' ||\n         localName == 'kml')) {\n      extend(regions, this.readRegionFromNode(n));\n    }\n  }\n  return regions;\n};\n\n\n/**\n * Read the projection from a KML source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nKML.prototype.readProjection;\n\n\n/**\n * @param {Node} node Node to append a TextNode with the color to.\n * @param {module:ol/color~Color|string} color Color.\n */\nfunction writeColorTextNode(node, color) {\n  const rgba = asArray(color);\n  const opacity = (rgba.length == 4) ? rgba[3] : 1;\n  const abgr = [opacity * 255, rgba[2], rgba[1], rgba[0]];\n  for (let i = 0; i < 4; ++i) {\n    const hex = parseInt(abgr[i], 10).toString(16);\n    abgr[i] = (hex.length == 1) ? '0' + hex : hex;\n  }\n  writeStringTextNode(node, abgr.join(''));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the coordinates to.\n * @param {Array.<number>} coordinates Coordinates.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeCoordinatesTextNode(node, coordinates, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n\n  const layout = context['layout'];\n  const stride = context['stride'];\n\n  let dimension;\n  if (layout == GeometryLayout.XY ||\n      layout == GeometryLayout.XYM) {\n    dimension = 2;\n  } else if (layout == GeometryLayout.XYZ ||\n      layout == GeometryLayout.XYZM) {\n    dimension = 3;\n  } else {\n    assert(false, 34); // Invalid geometry layout\n  }\n\n  const ii = coordinates.length;\n  let text = '';\n  if (ii > 0) {\n    text += coordinates[0];\n    for (let d = 1; d < dimension; ++d) {\n      text += ',' + coordinates[d];\n    }\n    for (let i = stride; i < ii; i += stride) {\n      text += ' ' + coordinates[i];\n      for (let d = 1; d < dimension; ++d) {\n        text += ',' + coordinates[i + d];\n      }\n    }\n  }\n  writeStringTextNode(node, text);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst EXTENDEDDATA_NODE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Data': makeChildAppender(writeDataNode),\n    'value': makeChildAppender(writeDataNodeValue),\n    'displayName': makeChildAppender(writeDataNodeName)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {{name: *, value: *}} pair Name value pair.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeDataNode(node, pair, objectStack) {\n  node.setAttribute('name', pair.name);\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  const value = pair.value;\n\n  if (typeof value == 'object') {\n    if (value !== null && value.displayName) {\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n        OBJECT_PROPERTY_NODE_FACTORY, [value.displayName], objectStack, ['displayName']);\n    }\n\n    if (value !== null && value.value) {\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n        OBJECT_PROPERTY_NODE_FACTORY, [value.value], objectStack, ['value']);\n    }\n  } else {\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n      OBJECT_PROPERTY_NODE_FACTORY, [value], objectStack, ['value']);\n  }\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the name to.\n * @param {string} name DisplayName.\n */\nfunction writeDataNodeName(node, name) {\n  writeCDATASection(node, name);\n}\n\n\n/**\n * @param {Node} node Node to append a CDATA Section with the value to.\n * @param {string} value Value.\n */\nfunction writeDataNodeValue(node, value) {\n  writeStringTextNode(node, value);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst DOCUMENT_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Placemark': makeChildAppender(writePlacemark)\n  });\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst DOCUMENT_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  const parentNode = objectStack[objectStack.length - 1].node;\n  return createElementNS(parentNode.namespaceURI, 'Placemark');\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {Array.<*>} objectStack Object stack.\n * @this {module:ol/format/KML}\n */\nfunction writeDocument(node, features, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context, DOCUMENT_SERIALIZERS,\n    DOCUMENT_NODE_FACTORY, features, objectStack, undefined,\n    this);\n}\n\n\n/**\n * A factory for creating Data nodes.\n * @const\n * @type {function(*, Array.<*>): (Node|undefined)}\n */\nconst DATA_NODE_FACTORY = makeSimpleNodeFactory('Data');\n\n\n/**\n * @param {Node} node Node.\n * @param {{names: Array<string>, values: (Array<*>)}} namesAndValues Names and values.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeExtendedData(node, namesAndValues, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  const names = namesAndValues.names;\n  const values = namesAndValues.values;\n  const length = names.length;\n\n  for (let i = 0; i < length; i++) {\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n      DATA_NODE_FACTORY, [{name: names[i], value: values[i]}], objectStack);\n  }\n}\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst ICON_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'href'\n  ],\n  makeStructureNS(GX_NAMESPACE_URIS, [\n    'x', 'y', 'w', 'h'\n  ]));\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst ICON_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeChildAppender(writeStringTextNode)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'x': makeChildAppender(writeDecimalTextNode),\n      'y': makeChildAppender(writeDecimalTextNode),\n      'w': makeChildAppender(writeDecimalTextNode),\n      'h': makeChildAppender(writeDecimalTextNode)\n    }));\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst GX_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  return createElementNS(GX_NAMESPACE_URIS[0],\n    'gx:' + opt_nodeName);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Object} icon Icon object.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeIcon(node, icon, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  const parentNode = objectStack[objectStack.length - 1].node;\n  let orderedKeys = ICON_SEQUENCE[parentNode.namespaceURI];\n  let values = makeSequence(icon, orderedKeys);\n  pushSerializeAndPop(context,\n    ICON_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n  orderedKeys =\n      ICON_SEQUENCE[GX_NAMESPACE_URIS[0]];\n  values = makeSequence(icon, orderedKeys);\n  pushSerializeAndPop(context, ICON_SERIALIZERS,\n    GX_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst ICON_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'scale', 'heading', 'Icon', 'hotSpot'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst ICON_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Icon': makeChildAppender(writeIcon),\n    'heading': makeChildAppender(writeDecimalTextNode),\n    'hotSpot': makeChildAppender(writeVec2),\n    'scale': makeChildAppender(writeScaleTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/style/Icon} style Icon style.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeIconStyle(node, style, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const src = style.getSrc();\n  const size = style.getSize();\n  const iconImageSize = style.getImageSize();\n  const iconProperties = {\n    'href': src\n  };\n\n  if (size) {\n    iconProperties['w'] = size[0];\n    iconProperties['h'] = size[1];\n    const anchor = style.getAnchor(); // top-left\n    const origin = style.getOrigin(); // top-left\n\n    if (origin && iconImageSize && origin[0] !== 0 && origin[1] !== size[1]) {\n      iconProperties['x'] = origin[0];\n      iconProperties['y'] = iconImageSize[1] - (origin[1] + size[1]);\n    }\n\n    if (anchor && (anchor[0] !== size[0] / 2 || anchor[1] !== size[1] / 2)) {\n      const /** @type {module:ol/format/KML~Vec2} */ hotSpot = {\n        x: anchor[0],\n        xunits: IconAnchorUnits.PIXELS,\n        y: size[1] - anchor[1],\n        yunits: IconAnchorUnits.PIXELS\n      };\n      properties['hotSpot'] = hotSpot;\n    }\n  }\n\n  properties['Icon'] = iconProperties;\n\n  const scale = style.getScale();\n  if (scale !== 1) {\n    properties['scale'] = scale;\n  }\n\n  const rotation = style.getRotation();\n  if (rotation !== 0) {\n    properties['heading'] = rotation; // 0-360\n  }\n\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = ICON_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, ICON_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst LABEL_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'color', 'scale'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst LABEL_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode),\n    'scale': makeChildAppender(writeScaleTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/style/Text} style style.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeLabelStyle(node, style, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const fill = style.getFill();\n  if (fill) {\n    properties['color'] = fill.getColor();\n  }\n  const scale = style.getScale();\n  if (scale && scale !== 1) {\n    properties['scale'] = scale;\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys =\n      LABEL_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, LABEL_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst LINE_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'color', 'width'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst LINE_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode),\n    'width': makeChildAppender(writeDecimalTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/style/Stroke} style style.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeLineStyle(node, style, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  const properties = {\n    'color': style.getColor(),\n    'width': style.getWidth()\n  };\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = LINE_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, LINE_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object.<string, string>}\n */\nconst GEOMETRY_TYPE_TO_NODENAME = {\n  'Point': 'Point',\n  'LineString': 'LineString',\n  'LinearRing': 'LinearRing',\n  'Polygon': 'Polygon',\n  'MultiPoint': 'MultiGeometry',\n  'MultiLineString': 'MultiGeometry',\n  'MultiPolygon': 'MultiGeometry',\n  'GeometryCollection': 'MultiGeometry'\n};\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array.<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst GEOMETRY_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  if (value) {\n    const parentNode = objectStack[objectStack.length - 1].node;\n    return createElementNS(parentNode.namespaceURI,\n      GEOMETRY_TYPE_TO_NODENAME[/** @type {module:ol/geom/Geometry} */ (value).getType()]);\n  }\n};\n\n\n/**\n * A factory for creating Point nodes.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst POINT_NODE_FACTORY = makeSimpleNodeFactory('Point');\n\n\n/**\n * A factory for creating LineString nodes.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst LINE_STRING_NODE_FACTORY = makeSimpleNodeFactory('LineString');\n\n\n/**\n * A factory for creating LinearRing nodes.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst LINEAR_RING_NODE_FACTORY = makeSimpleNodeFactory('LinearRing');\n\n\n/**\n * A factory for creating Polygon nodes.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst POLYGON_NODE_FACTORY = makeSimpleNodeFactory('Polygon');\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst MULTI_GEOMETRY_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LineString': makeChildAppender(\n      writePrimitiveGeometry),\n    'Point': makeChildAppender(\n      writePrimitiveGeometry),\n    'Polygon': makeChildAppender(writePolygon),\n    'GeometryCollection': makeChildAppender(\n      writeMultiGeometry)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeMultiGeometry(node, geometry, objectStack) {\n  /** @type {module:ol/xml~NodeStackItem} */\n  const context = {node: node};\n  const type = geometry.getType();\n  /** @type {Array.<module:ol/geom/Geometry>} */\n  let geometries;\n  /** @type {function(*, Array.<*>, string=): (Node|undefined)} */\n  let factory;\n  if (type == GeometryType.GEOMETRY_COLLECTION) {\n    geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n    factory = GEOMETRY_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_POINT) {\n    geometries = /** @type {module:ol/geom/MultiPoint} */ (geometry).getPoints();\n    factory = POINT_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_LINE_STRING) {\n    geometries =\n        (/** @type {module:ol/geom/MultiLineString} */ (geometry)).getLineStrings();\n    factory = LINE_STRING_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_POLYGON) {\n    geometries =\n        (/** @type {module:ol/geom/MultiPolygon} */ (geometry)).getPolygons();\n    factory = POLYGON_NODE_FACTORY;\n  } else {\n    assert(false, 39); // Unknown geometry type\n  }\n  pushSerializeAndPop(context,\n    MULTI_GEOMETRY_SERIALIZERS, factory,\n    geometries, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst BOUNDARY_IS_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeChildAppender(\n      writePrimitiveGeometry)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/LinearRing} linearRing Linear ring.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeBoundaryIs(node, linearRing, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context,\n    BOUNDARY_IS_SERIALIZERS,\n    LINEAR_RING_NODE_FACTORY, [linearRing], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst PLACEMARK_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': makeChildAppender(writeExtendedData),\n    'MultiGeometry': makeChildAppender(writeMultiGeometry),\n    'LineString': makeChildAppender(writePrimitiveGeometry),\n    'LinearRing': makeChildAppender(writePrimitiveGeometry),\n    'Point': makeChildAppender(writePrimitiveGeometry),\n    'Polygon': makeChildAppender(writePolygon),\n    'Style': makeChildAppender(writeStyle),\n    'address': makeChildAppender(writeStringTextNode),\n    'description': makeChildAppender(writeStringTextNode),\n    'name': makeChildAppender(writeStringTextNode),\n    'open': makeChildAppender(writeBooleanTextNode),\n    'phoneNumber': makeChildAppender(writeStringTextNode),\n    'styleUrl': makeChildAppender(writeStringTextNode),\n    'visibility': makeChildAppender(writeBooleanTextNode)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst PLACEMARK_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'name', 'open', 'visibility', 'address', 'phoneNumber', 'description',\n    'styleUrl', 'Style'\n  ]);\n\n\n/**\n * A factory for creating ExtendedData nodes.\n * @const\n * @type {function(*, Array.<*>): (Node|undefined)}\n */\nconst EXTENDEDDATA_NODE_FACTORY = makeSimpleNodeFactory('ExtendedData');\n\n\n/**\n * FIXME currently we do serialize arbitrary/custom feature properties\n * (ExtendedData).\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Object stack.\n * @this {module:ol/format/KML}\n */\nfunction writePlacemark(node, feature, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n\n  // set id\n  if (feature.getId()) {\n    node.setAttribute('id', feature.getId());\n  }\n\n  // serialize properties (properties unknown to KML are not serialized)\n  const properties = feature.getProperties();\n\n  // don't export these to ExtendedData\n  const filter = {'address': 1, 'description': 1, 'name': 1, 'open': 1,\n    'phoneNumber': 1, 'styleUrl': 1, 'visibility': 1};\n  filter[feature.getGeometryName()] = 1;\n  const keys = Object.keys(properties || {}).sort().filter(function(v) {\n    return !filter[v];\n  });\n\n  if (keys.length > 0) {\n    const sequence = makeSequence(properties, keys);\n    const namesAndValues = {names: keys, values: sequence};\n    pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n      EXTENDEDDATA_NODE_FACTORY, [namesAndValues], objectStack);\n  }\n\n  const styleFunction = feature.getStyleFunction();\n  if (styleFunction) {\n    // FIXME the styles returned by the style function are supposed to be\n    // resolution-independent here\n    const styles = styleFunction(feature, 0);\n    if (styles) {\n      const style = Array.isArray(styles) ? styles[0] : styles;\n      if (this.writeStyles_) {\n        properties['Style'] = style;\n      }\n      const textStyle = style.getText();\n      if (textStyle) {\n        properties['name'] = textStyle.getText();\n      }\n    }\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = PLACEMARK_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n\n  // serialize geometry\n  const options = /** @type {module:ol/format/Feature~WriteOptions} */ (objectStack[0]);\n  let geometry = feature.getGeometry();\n  if (geometry) {\n    geometry = transformWithOptions(geometry, true, options);\n  }\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n    GEOMETRY_NODE_FACTORY, [geometry], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst PRIMITIVE_GEOMETRY_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'extrude', 'tessellate', 'altitudeMode', 'coordinates'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst PRIMITIVE_GEOMETRY_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'extrude': makeChildAppender(writeBooleanTextNode),\n    'tessellate': makeChildAppender(writeBooleanTextNode),\n    'altitudeMode': makeChildAppender(writeStringTextNode),\n    'coordinates': makeChildAppender(writeCoordinatesTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writePrimitiveGeometry(node, geometry, objectStack) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  context['layout'] = geometry.getLayout();\n  context['stride'] = geometry.getStride();\n\n  // serialize properties (properties unknown to KML are not serialized)\n  const properties = geometry.getProperties();\n  properties.coordinates = flatCoordinates;\n\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = PRIMITIVE_GEOMETRY_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, PRIMITIVE_GEOMETRY_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst POLYGON_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'outerBoundaryIs': makeChildAppender(\n      writeBoundaryIs),\n    'innerBoundaryIs': makeChildAppender(\n      writeBoundaryIs)\n  });\n\n\n/**\n * A factory for creating innerBoundaryIs nodes.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst INNER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('innerBoundaryIs');\n\n\n/**\n * A factory for creating outerBoundaryIs nodes.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst OUTER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('outerBoundaryIs');\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/geom/Polygon} polygon Polygon.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writePolygon(node, polygon, objectStack) {\n  const linearRings = polygon.getLinearRings();\n  const outerRing = linearRings.shift();\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  // inner rings\n  pushSerializeAndPop(context,\n    POLYGON_SERIALIZERS,\n    INNER_BOUNDARY_NODE_FACTORY,\n    linearRings, objectStack);\n  // outer ring\n  pushSerializeAndPop(context,\n    POLYGON_SERIALIZERS,\n    OUTER_BOUNDARY_NODE_FACTORY,\n    [outerRing], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst POLY_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode)\n  });\n\n\n/**\n * A factory for creating coordinates nodes.\n * @const\n * @type {function(*, Array.<*>, string=): (Node|undefined)}\n */\nconst COLOR_NODE_FACTORY = makeSimpleNodeFactory('color');\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/style/Fill} style Style.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writePolyStyle(node, style, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context, POLY_STYLE_SERIALIZERS,\n    COLOR_NODE_FACTORY, [style.getColor()], objectStack);\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the scale to.\n * @param {number|undefined} scale Scale.\n */\nfunction writeScaleTextNode(node, scale) {\n  // the Math is to remove any excess decimals created by float arithmetic\n  writeDecimalTextNode(node,\n    Math.round(scale * 1e6) / 1e6);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'IconStyle', 'LabelStyle', 'LineStyle', 'PolyStyle'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'IconStyle': makeChildAppender(writeIconStyle),\n    'LabelStyle': makeChildAppender(writeLabelStyle),\n    'LineStyle': makeChildAppender(writeLineStyle),\n    'PolyStyle': makeChildAppender(writePolyStyle)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/style/Style} style Style.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction writeStyle(node, style, objectStack) {\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  const imageStyle = style.getImage();\n  const textStyle = style.getText();\n  if (imageStyle instanceof Icon) {\n    properties['IconStyle'] = imageStyle;\n  }\n  if (textStyle) {\n    properties['LabelStyle'] = textStyle;\n  }\n  if (strokeStyle) {\n    properties['LineStyle'] = strokeStyle;\n  }\n  if (fillStyle) {\n    properties['PolyStyle'] = fillStyle;\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the Vec2 to.\n * @param {module:ol/format/KML~Vec2} vec2 Vec2.\n */\nfunction writeVec2(node, vec2) {\n  node.setAttribute('x', vec2.x);\n  node.setAttribute('y', vec2.y);\n  node.setAttribute('xunits', vec2.xunits);\n  node.setAttribute('yunits', vec2.yunits);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Array.<string>>}\n */\nconst KML_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'Document', 'Placemark'\n  ]);\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst KML_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Document': makeChildAppender(writeDocument),\n    'Placemark': makeChildAppender(writePlacemark)\n  });\n\n\n/**\n * Encode an array of features in the KML format. GeometryCollections, MultiPoints,\n * MultiLineStrings, and MultiPolygons are output as MultiGeometries.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {string} Result.\n * @api\n */\nKML.prototype.writeFeatures;\n\n\n/**\n * Encode an array of features in the KML format as an XML node. GeometryCollections,\n * MultiPoints, MultiLineStrings, and MultiPolygons are output as MultiGeometries.\n *\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Options.\n * @return {Node} Node.\n * @override\n * @api\n */\nKML.prototype.writeFeaturesNode = function(features, opt_options) {\n  opt_options = this.adaptOptions(opt_options);\n  const kml = createElementNS(NAMESPACE_URIS[4], 'kml');\n  const xmlnsUri = 'http://www.w3.org/2000/xmlns/';\n  kml.setAttributeNS(xmlnsUri, 'xmlns:gx', GX_NAMESPACE_URIS[0]);\n  kml.setAttributeNS(xmlnsUri, 'xmlns:xsi', XML_SCHEMA_INSTANCE_URI);\n  kml.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', SCHEMA_LOCATION);\n\n  const /** @type {module:ol/xml~NodeStackItem} */ context = {node: kml};\n  const properties = {};\n  if (features.length > 1) {\n    properties['Document'] = features;\n  } else if (features.length == 1) {\n    properties['Placemark'] = features[0];\n  }\n  const orderedKeys = KML_SEQUENCE[kml.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, KML_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, [opt_options], orderedKeys,\n    this);\n  return kml;\n};\n\nexport default KML;\n","/**\n * @module ol/style/IconOrigin\n */\n\n/**\n * Icon origin. One of 'bottom-left', 'bottom-right', 'top-left', 'top-right'.\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/style/Icon\n */\nimport {getUid, inherits} from '../index.js';\nimport ImageState from '../ImageState.js';\nimport {assert} from '../asserts.js';\nimport {asArray} from '../color.js';\nimport {listen, unlisten} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport IconAnchorUnits from '../style/IconAnchorUnits.js';\nimport {get as getIconImage} from '../style/IconImage.js';\nimport IconOrigin from '../style/IconOrigin.js';\nimport ImageStyle from '../style/Image.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array.<number>} [anchor=[0.5, 0.5]] Anchor. Default value is the icon center.\n * @property {module:ol/style/IconOrigin} [anchorOrigin] Origin of the anchor: `bottom-left`, `bottom-right`,\n * `top-left` or `top-right`. Default is `top-left`.\n * @property {module:ol/style/IconAnchorUnits} [anchorXUnits] Units in which the anchor x value is\n * specified. A value of `'fraction'` indicates the x value is a fraction of the icon. A value of `'pixels'` indicates\n * the x value in pixels. Default is `'fraction'`.\n * @property {module:ol/style/IconAnchorUnits} [anchorYUnits] Units in which the anchor y value is\n * specified. A value of `'fraction'` indicates the y value is a fraction of the icon. A value of `'pixels'` indicates\n * the y value in pixels. Default is `'fraction'`.\n * @property {module:ol/color~Color|string} [color] Color to tint the icon. If not specified,\n * the icon will be left as is.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images. Note that you must provide a\n * `crossOrigin` value if you are using the WebGL renderer or if you want to access pixel data with the Canvas renderer.\n * See {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {Image|HTMLCanvasElement} [img] Image object for the icon. If the `src` option is not provided then the\n * provided image must already be loaded. And in that case, it is required\n * to provide the size of the image, with the `imgSize` option.\n * @property {Array.<number>} [offset=[0, 0]] Offset, which, together with the size and the offset origin, define the\n * sub-rectangle to use from the original icon image.\n * @property {module:ol/style/IconOrigin} [offsetOrigin] Origin of the offset: `bottom-left`, `bottom-right`,\n * `top-left` or `top-right`. Default is `top-left`.\n * @property {number} [opacity=1] Opacity of the icon.\n * @property {number} [scale=1] Scale.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the icon in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the icon's position is animated. Without it, the icon may jitter noticeably.\n * @property {boolean} [rotateWithView=false] Whether to rotate the icon with the view.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {module:ol/size~Size} [size] Icon size in pixel. Can be used together with `offset` to define the\n * sub-rectangle to use from the origin (sprite) icon image.\n * @property {module:ol/size~Size} [imgSize] Image size in pixels. Only required if `img` is set and `src` is not, and\n * for SVG images in Internet Explorer 11. The provided `imgSize` needs to match the actual size of the image.\n * @property {string} [src] Image source URI.\n */\n\n\n/**\n * @classdesc\n * Set icon style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Icon~Options=} opt_options Options.\n * @extends {module:ol/style/Image}\n * @api\n */\nconst Icon = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.anchor_ = options.anchor !== undefined ? options.anchor : [0.5, 0.5];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.normalizedAnchor_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconOrigin}\n   */\n  this.anchorOrigin_ = options.anchorOrigin !== undefined ?\n    options.anchorOrigin : IconOrigin.TOP_LEFT;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconAnchorUnits}\n   */\n  this.anchorXUnits_ = options.anchorXUnits !== undefined ?\n    options.anchorXUnits : IconAnchorUnits.FRACTION;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconAnchorUnits}\n   */\n  this.anchorYUnits_ = options.anchorYUnits !== undefined ?\n    options.anchorYUnits : IconAnchorUnits.FRACTION;\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @type {Image|HTMLCanvasElement}\n   */\n  const image = options.img !== undefined ? options.img : null;\n\n  /**\n   * @type {module:ol/size~Size}\n   */\n  const imgSize = options.imgSize !== undefined ? options.imgSize : null;\n\n  /**\n   * @type {string|undefined}\n   */\n  let src = options.src;\n\n  assert(!(src !== undefined && image),\n    4); // `image` and `src` cannot be provided at the same time\n  assert(!image || (image && imgSize),\n    5); // `imgSize` must be set when `image` is provided\n\n  if ((src === undefined || src.length === 0) && image) {\n    src = image.src || getUid(image).toString();\n  }\n  assert(src !== undefined && src.length > 0,\n    6); // A defined and non-empty `src` or `image` must be provided\n\n  /**\n   * @type {module:ol/ImageState}\n   */\n  const imageState = options.src !== undefined ?\n    ImageState.IDLE : ImageState.LOADED;\n\n  /**\n   * @private\n   * @type {module:ol/color~Color}\n   */\n  this.color_ = options.color !== undefined ? asArray(options.color) : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/IconImage}\n   */\n  this.iconImage_ = getIconImage(\n    image, /** @type {string} */ (src), imgSize, this.crossOrigin_, imageState, this.color_);\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.offset_ = options.offset !== undefined ? options.offset : [0, 0];\n\n  /**\n   * @private\n   * @type {module:ol/style/IconOrigin}\n   */\n  this.offsetOrigin_ = options.offsetOrigin !== undefined ?\n    options.offsetOrigin : IconOrigin.TOP_LEFT;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.origin_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.size_ = options.size !== undefined ? options.size : null;\n\n  /**\n   * @type {number}\n   */\n  const opacity = options.opacity !== undefined ? options.opacity : 1;\n\n  /**\n   * @type {boolean}\n   */\n  const rotateWithView = options.rotateWithView !== undefined ?\n    options.rotateWithView : false;\n\n  /**\n   * @type {number}\n   */\n  const rotation = options.rotation !== undefined ? options.rotation : 0;\n\n  /**\n   * @type {number}\n   */\n  const scale = options.scale !== undefined ? options.scale : 1;\n\n  /**\n   * @type {boolean}\n   */\n  const snapToPixel = options.snapToPixel !== undefined ?\n    options.snapToPixel : true;\n\n  ImageStyle.call(this, {\n    opacity: opacity,\n    rotation: rotation,\n    scale: scale,\n    snapToPixel: snapToPixel,\n    rotateWithView: rotateWithView\n  });\n\n};\n\ninherits(Icon, ImageStyle);\n\n\n/**\n * Clones the style. The underlying Image/HTMLCanvasElement is not cloned.\n * @return {module:ol/style/Icon} The cloned style.\n * @api\n */\nIcon.prototype.clone = function() {\n  return new Icon({\n    anchor: this.anchor_.slice(),\n    anchorOrigin: this.anchorOrigin_,\n    anchorXUnits: this.anchorXUnits_,\n    anchorYUnits: this.anchorYUnits_,\n    crossOrigin: this.crossOrigin_,\n    color: (this.color_ && this.color_.slice) ? this.color_.slice() : this.color_ || undefined,\n    src: this.getSrc(),\n    offset: this.offset_.slice(),\n    offsetOrigin: this.offsetOrigin_,\n    size: this.size_ !== null ? this.size_.slice() : undefined,\n    opacity: this.getOpacity(),\n    scale: this.getScale(),\n    snapToPixel: this.getSnapToPixel(),\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView()\n  });\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nIcon.prototype.getAnchor = function() {\n  if (this.normalizedAnchor_) {\n    return this.normalizedAnchor_;\n  }\n  let anchor = this.anchor_;\n  const size = this.getSize();\n  if (this.anchorXUnits_ == IconAnchorUnits.FRACTION ||\n      this.anchorYUnits_ == IconAnchorUnits.FRACTION) {\n    if (!size) {\n      return null;\n    }\n    anchor = this.anchor_.slice();\n    if (this.anchorXUnits_ == IconAnchorUnits.FRACTION) {\n      anchor[0] *= size[0];\n    }\n    if (this.anchorYUnits_ == IconAnchorUnits.FRACTION) {\n      anchor[1] *= size[1];\n    }\n  }\n\n  if (this.anchorOrigin_ != IconOrigin.TOP_LEFT) {\n    if (!size) {\n      return null;\n    }\n    if (anchor === this.anchor_) {\n      anchor = this.anchor_.slice();\n    }\n    if (this.anchorOrigin_ == IconOrigin.TOP_RIGHT ||\n        this.anchorOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      anchor[0] = -anchor[0] + size[0];\n    }\n    if (this.anchorOrigin_ == IconOrigin.BOTTOM_LEFT ||\n        this.anchorOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      anchor[1] = -anchor[1] + size[1];\n    }\n  }\n  this.normalizedAnchor_ = anchor;\n  return this.normalizedAnchor_;\n};\n\n\n/**\n * Get the icon color.\n * @return {module:ol/color~Color} Color.\n * @api\n */\nIcon.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Get the image icon.\n * @param {number} pixelRatio Pixel ratio.\n * @return {Image|HTMLCanvasElement} Image or Canvas element.\n * @override\n * @api\n */\nIcon.prototype.getImage = function(pixelRatio) {\n  return this.iconImage_.getImage(pixelRatio);\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getImageSize = function() {\n  return this.iconImage_.getSize();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getHitDetectionImageSize = function() {\n  return this.getImageSize();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getImageState = function() {\n  return this.iconImage_.getImageState();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.getHitDetectionImage = function(pixelRatio) {\n  return this.iconImage_.getHitDetectionImage(pixelRatio);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nIcon.prototype.getOrigin = function() {\n  if (this.origin_) {\n    return this.origin_;\n  }\n  let offset = this.offset_;\n\n  if (this.offsetOrigin_ != IconOrigin.TOP_LEFT) {\n    const size = this.getSize();\n    const iconImageSize = this.iconImage_.getSize();\n    if (!size || !iconImageSize) {\n      return null;\n    }\n    offset = offset.slice();\n    if (this.offsetOrigin_ == IconOrigin.TOP_RIGHT ||\n        this.offsetOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      offset[0] = iconImageSize[0] - size[0] - offset[0];\n    }\n    if (this.offsetOrigin_ == IconOrigin.BOTTOM_LEFT ||\n        this.offsetOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n      offset[1] = iconImageSize[1] - size[1] - offset[1];\n    }\n  }\n  this.origin_ = offset;\n  return this.origin_;\n};\n\n\n/**\n * Get the image URL.\n * @return {string|undefined} Image src.\n * @api\n */\nIcon.prototype.getSrc = function() {\n  return this.iconImage_.getSrc();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nIcon.prototype.getSize = function() {\n  return !this.size_ ? this.iconImage_.getSize() : this.size_;\n};\n\n\n/**\n * @override\n */\nIcon.prototype.listenImageChange = function(listener, thisArg) {\n  return listen(this.iconImage_, EventType.CHANGE,\n    listener, thisArg);\n};\n\n\n/**\n * Load not yet loaded URI.\n * When rendering a feature with an icon style, the vector renderer will\n * automatically call this method. However, you might want to call this\n * method yourself for preloading or other purposes.\n * @override\n * @api\n */\nIcon.prototype.load = function() {\n  this.iconImage_.load();\n};\n\n\n/**\n * @override\n */\nIcon.prototype.unlistenImageChange = function(listener, thisArg) {\n  unlisten(this.iconImage_, EventType.CHANGE,\n    listener, thisArg);\n};\nexport default Icon;\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","'use strict';\n\nmodule.exports = Pbf;\n\nvar ieee754 = require('ieee754');\n\nfunction Pbf(buf) {\n    this.buf = ArrayBuffer.isView && ArrayBuffer.isView(buf) ? buf : new Uint8Array(buf || 0);\n    this.pos = 0;\n    this.type = 0;\n    this.length = this.buf.length;\n}\n\nPbf.Varint  = 0; // varint: int32, int64, uint32, uint64, sint32, sint64, bool, enum\nPbf.Fixed64 = 1; // 64-bit: double, fixed64, sfixed64\nPbf.Bytes   = 2; // length-delimited: string, bytes, embedded messages, packed repeated fields\nPbf.Fixed32 = 5; // 32-bit: float, fixed32, sfixed32\n\nvar SHIFT_LEFT_32 = (1 << 16) * (1 << 16),\n    SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32;\n\nPbf.prototype = {\n\n    destroy: function() {\n        this.buf = null;\n    },\n\n    // === READING =================================================================\n\n    readFields: function(readField, result, end) {\n        end = end || this.length;\n\n        while (this.pos < end) {\n            var val = this.readVarint(),\n                tag = val >> 3,\n                startPos = this.pos;\n\n            this.type = val & 0x7;\n            readField(tag, result, this);\n\n            if (this.pos === startPos) this.skip(val);\n        }\n        return result;\n    },\n\n    readMessage: function(readField, result) {\n        return this.readFields(readField, result, this.readVarint() + this.pos);\n    },\n\n    readFixed32: function() {\n        var val = readUInt32(this.buf, this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    readSFixed32: function() {\n        var val = readInt32(this.buf, this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    // 64-bit int handling is based on github.com/dpw/node-buffer-more-ints (MIT-licensed)\n\n    readFixed64: function() {\n        var val = readUInt32(this.buf, this.pos) + readUInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readSFixed64: function() {\n        var val = readUInt32(this.buf, this.pos) + readInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readFloat: function() {\n        var val = ieee754.read(this.buf, this.pos, true, 23, 4);\n        this.pos += 4;\n        return val;\n    },\n\n    readDouble: function() {\n        var val = ieee754.read(this.buf, this.pos, true, 52, 8);\n        this.pos += 8;\n        return val;\n    },\n\n    readVarint: function(isSigned) {\n        var buf = this.buf,\n            val, b;\n\n        b = buf[this.pos++]; val  =  b & 0x7f;        if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 7;  if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 14; if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 21; if (b < 0x80) return val;\n        b = buf[this.pos];   val |= (b & 0x0f) << 28;\n\n        return readVarintRemainder(val, isSigned, this);\n    },\n\n    readVarint64: function() { // for compatibility with v2.0.1\n        return this.readVarint(true);\n    },\n\n    readSVarint: function() {\n        var num = this.readVarint();\n        return num % 2 === 1 ? (num + 1) / -2 : num / 2; // zigzag encoding\n    },\n\n    readBoolean: function() {\n        return Boolean(this.readVarint());\n    },\n\n    readString: function() {\n        var end = this.readVarint() + this.pos,\n            str = readUtf8(this.buf, this.pos, end);\n        this.pos = end;\n        return str;\n    },\n\n    readBytes: function() {\n        var end = this.readVarint() + this.pos,\n            buffer = this.buf.subarray(this.pos, end);\n        this.pos = end;\n        return buffer;\n    },\n\n    // verbose for performance reasons; doesn't affect gzipped size\n\n    readPackedVarint: function(arr, isSigned) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readVarint(isSigned));\n        return arr;\n    },\n    readPackedSVarint: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSVarint());\n        return arr;\n    },\n    readPackedBoolean: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readBoolean());\n        return arr;\n    },\n    readPackedFloat: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFloat());\n        return arr;\n    },\n    readPackedDouble: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readDouble());\n        return arr;\n    },\n    readPackedFixed32: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFixed32());\n        return arr;\n    },\n    readPackedSFixed32: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSFixed32());\n        return arr;\n    },\n    readPackedFixed64: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFixed64());\n        return arr;\n    },\n    readPackedSFixed64: function(arr) {\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSFixed64());\n        return arr;\n    },\n\n    skip: function(val) {\n        var type = val & 0x7;\n        if (type === Pbf.Varint) while (this.buf[this.pos++] > 0x7f) {}\n        else if (type === Pbf.Bytes) this.pos = this.readVarint() + this.pos;\n        else if (type === Pbf.Fixed32) this.pos += 4;\n        else if (type === Pbf.Fixed64) this.pos += 8;\n        else throw new Error('Unimplemented type: ' + type);\n    },\n\n    // === WRITING =================================================================\n\n    writeTag: function(tag, type) {\n        this.writeVarint((tag << 3) | type);\n    },\n\n    realloc: function(min) {\n        var length = this.length || 16;\n\n        while (length < this.pos + min) length *= 2;\n\n        if (length !== this.length) {\n            var buf = new Uint8Array(length);\n            buf.set(this.buf);\n            this.buf = buf;\n            this.length = length;\n        }\n    },\n\n    finish: function() {\n        this.length = this.pos;\n        this.pos = 0;\n        return this.buf.subarray(0, this.length);\n    },\n\n    writeFixed32: function(val) {\n        this.realloc(4);\n        writeInt32(this.buf, val, this.pos);\n        this.pos += 4;\n    },\n\n    writeSFixed32: function(val) {\n        this.realloc(4);\n        writeInt32(this.buf, val, this.pos);\n        this.pos += 4;\n    },\n\n    writeFixed64: function(val) {\n        this.realloc(8);\n        writeInt32(this.buf, val & -1, this.pos);\n        writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeSFixed64: function(val) {\n        this.realloc(8);\n        writeInt32(this.buf, val & -1, this.pos);\n        writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeVarint: function(val) {\n        val = +val || 0;\n\n        if (val > 0xfffffff || val < 0) {\n            writeBigVarint(val, this);\n            return;\n        }\n\n        this.realloc(4);\n\n        this.buf[this.pos++] =           val & 0x7f  | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] =   (val >>> 7) & 0x7f;\n    },\n\n    writeSVarint: function(val) {\n        this.writeVarint(val < 0 ? -val * 2 - 1 : val * 2);\n    },\n\n    writeBoolean: function(val) {\n        this.writeVarint(Boolean(val));\n    },\n\n    writeString: function(str) {\n        str = String(str);\n        this.realloc(str.length * 4);\n\n        this.pos++; // reserve 1 byte for short string length\n\n        var startPos = this.pos;\n        // write the string directly to the buffer and see how much was written\n        this.pos = writeUtf8(this.buf, str, this.pos);\n        var len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    },\n\n    writeFloat: function(val) {\n        this.realloc(4);\n        ieee754.write(this.buf, val, this.pos, true, 23, 4);\n        this.pos += 4;\n    },\n\n    writeDouble: function(val) {\n        this.realloc(8);\n        ieee754.write(this.buf, val, this.pos, true, 52, 8);\n        this.pos += 8;\n    },\n\n    writeBytes: function(buffer) {\n        var len = buffer.length;\n        this.writeVarint(len);\n        this.realloc(len);\n        for (var i = 0; i < len; i++) this.buf[this.pos++] = buffer[i];\n    },\n\n    writeRawMessage: function(fn, obj) {\n        this.pos++; // reserve 1 byte for short message length\n\n        // write the message directly to the buffer and see how much was written\n        var startPos = this.pos;\n        fn(obj, this);\n        var len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    },\n\n    writeMessage: function(tag, fn, obj) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeRawMessage(fn, obj);\n    },\n\n    writePackedVarint:   function(tag, arr) { this.writeMessage(tag, writePackedVarint, arr);   },\n    writePackedSVarint:  function(tag, arr) { this.writeMessage(tag, writePackedSVarint, arr);  },\n    writePackedBoolean:  function(tag, arr) { this.writeMessage(tag, writePackedBoolean, arr);  },\n    writePackedFloat:    function(tag, arr) { this.writeMessage(tag, writePackedFloat, arr);    },\n    writePackedDouble:   function(tag, arr) { this.writeMessage(tag, writePackedDouble, arr);   },\n    writePackedFixed32:  function(tag, arr) { this.writeMessage(tag, writePackedFixed32, arr);  },\n    writePackedSFixed32: function(tag, arr) { this.writeMessage(tag, writePackedSFixed32, arr); },\n    writePackedFixed64:  function(tag, arr) { this.writeMessage(tag, writePackedFixed64, arr);  },\n    writePackedSFixed64: function(tag, arr) { this.writeMessage(tag, writePackedSFixed64, arr); },\n\n    writeBytesField: function(tag, buffer) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeBytes(buffer);\n    },\n    writeFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFixed32(val);\n    },\n    writeSFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeSFixed32(val);\n    },\n    writeFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeFixed64(val);\n    },\n    writeSFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeSFixed64(val);\n    },\n    writeVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeVarint(val);\n    },\n    writeSVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeSVarint(val);\n    },\n    writeStringField: function(tag, str) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeString(str);\n    },\n    writeFloatField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFloat(val);\n    },\n    writeDoubleField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeDouble(val);\n    },\n    writeBooleanField: function(tag, val) {\n        this.writeVarintField(tag, Boolean(val));\n    }\n};\n\nfunction readVarintRemainder(l, s, p) {\n    var buf = p.buf,\n        h, b;\n\n    b = buf[p.pos++]; h  = (b & 0x70) >> 4;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 3;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 10; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 17; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 24; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x01) << 31; if (b < 0x80) return toNum(l, h, s);\n\n    throw new Error('Expected varint not more than 10 bytes');\n}\n\nfunction readPackedEnd(pbf) {\n    return pbf.type === Pbf.Bytes ?\n        pbf.readVarint() + pbf.pos : pbf.pos + 1;\n}\n\nfunction toNum(low, high, isSigned) {\n    if (isSigned) {\n        return high * 0x100000000 + (low >>> 0);\n    }\n\n    return ((high >>> 0) * 0x100000000) + (low >>> 0);\n}\n\nfunction writeBigVarint(val, pbf) {\n    var low, high;\n\n    if (val >= 0) {\n        low  = (val % 0x100000000) | 0;\n        high = (val / 0x100000000) | 0;\n    } else {\n        low  = ~(-val % 0x100000000);\n        high = ~(-val / 0x100000000);\n\n        if (low ^ 0xffffffff) {\n            low = (low + 1) | 0;\n        } else {\n            low = 0;\n            high = (high + 1) | 0;\n        }\n    }\n\n    if (val >= 0x10000000000000000 || val < -0x10000000000000000) {\n        throw new Error('Given varint doesn\\'t fit into 10 bytes');\n    }\n\n    pbf.realloc(10);\n\n    writeBigVarintLow(low, high, pbf);\n    writeBigVarintHigh(high, pbf);\n}\n\nfunction writeBigVarintLow(low, high, pbf) {\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos]   = low & 0x7f;\n}\n\nfunction writeBigVarintHigh(high, pbf) {\n    var lsb = (high & 0x07) << 4;\n\n    pbf.buf[pbf.pos++] |= lsb         | ((high >>>= 3) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f;\n}\n\nfunction makeRoomForExtraLength(startPos, len, pbf) {\n    var extraLen =\n        len <= 0x3fff ? 1 :\n        len <= 0x1fffff ? 2 :\n        len <= 0xfffffff ? 3 : Math.ceil(Math.log(len) / (Math.LN2 * 7));\n\n    // if 1 byte isn't enough for encoding message length, shift the data to the right\n    pbf.realloc(extraLen);\n    for (var i = pbf.pos - 1; i >= startPos; i--) pbf.buf[i + extraLen] = pbf.buf[i];\n}\n\nfunction writePackedVarint(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeVarint(arr[i]);   }\nfunction writePackedSVarint(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeSVarint(arr[i]);  }\nfunction writePackedFloat(arr, pbf)    { for (var i = 0; i < arr.length; i++) pbf.writeFloat(arr[i]);    }\nfunction writePackedDouble(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeDouble(arr[i]);   }\nfunction writePackedBoolean(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeBoolean(arr[i]);  }\nfunction writePackedFixed32(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed32(arr[i]);  }\nfunction writePackedSFixed32(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed32(arr[i]); }\nfunction writePackedFixed64(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed64(arr[i]);  }\nfunction writePackedSFixed64(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed64(arr[i]); }\n\n// Buffer code below from https://github.com/feross/buffer, MIT-licensed\n\nfunction readUInt32(buf, pos) {\n    return ((buf[pos]) |\n        (buf[pos + 1] << 8) |\n        (buf[pos + 2] << 16)) +\n        (buf[pos + 3] * 0x1000000);\n}\n\nfunction writeInt32(buf, val, pos) {\n    buf[pos] = val;\n    buf[pos + 1] = (val >>> 8);\n    buf[pos + 2] = (val >>> 16);\n    buf[pos + 3] = (val >>> 24);\n}\n\nfunction readInt32(buf, pos) {\n    return ((buf[pos]) |\n        (buf[pos + 1] << 8) |\n        (buf[pos + 2] << 16)) +\n        (buf[pos + 3] << 24);\n}\n\nfunction readUtf8(buf, pos, end) {\n    var str = '';\n    var i = pos;\n\n    while (i < end) {\n        var b0 = buf[i];\n        var c = null; // codepoint\n        var bytesPerSequence =\n            b0 > 0xEF ? 4 :\n            b0 > 0xDF ? 3 :\n            b0 > 0xBF ? 2 : 1;\n\n        if (i + bytesPerSequence > end) break;\n\n        var b1, b2, b3;\n\n        if (bytesPerSequence === 1) {\n            if (b0 < 0x80) {\n                c = b0;\n            }\n        } else if (bytesPerSequence === 2) {\n            b1 = buf[i + 1];\n            if ((b1 & 0xC0) === 0x80) {\n                c = (b0 & 0x1F) << 0x6 | (b1 & 0x3F);\n                if (c <= 0x7F) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 3) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0xC | (b1 & 0x3F) << 0x6 | (b2 & 0x3F);\n                if (c <= 0x7FF || (c >= 0xD800 && c <= 0xDFFF)) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 4) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            b3 = buf[i + 3];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0x12 | (b1 & 0x3F) << 0xC | (b2 & 0x3F) << 0x6 | (b3 & 0x3F);\n                if (c <= 0xFFFF || c >= 0x110000) {\n                    c = null;\n                }\n            }\n        }\n\n        if (c === null) {\n            c = 0xFFFD;\n            bytesPerSequence = 1;\n\n        } else if (c > 0xFFFF) {\n            c -= 0x10000;\n            str += String.fromCharCode(c >>> 10 & 0x3FF | 0xD800);\n            c = 0xDC00 | c & 0x3FF;\n        }\n\n        str += String.fromCharCode(c);\n        i += bytesPerSequence;\n    }\n\n    return str;\n}\n\nfunction writeUtf8(buf, str, pos) {\n    for (var i = 0, c, lead; i < str.length; i++) {\n        c = str.charCodeAt(i); // code point\n\n        if (c > 0xD7FF && c < 0xE000) {\n            if (lead) {\n                if (c < 0xDC00) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                    lead = c;\n                    continue;\n                } else {\n                    c = lead - 0xD800 << 10 | c - 0xDC00 | 0x10000;\n                    lead = null;\n                }\n            } else {\n                if (c > 0xDBFF || (i + 1 === str.length)) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                } else {\n                    lead = c;\n                }\n                continue;\n            }\n        } else if (lead) {\n            buf[pos++] = 0xEF;\n            buf[pos++] = 0xBF;\n            buf[pos++] = 0xBD;\n            lead = null;\n        }\n\n        if (c < 0x80) {\n            buf[pos++] = c;\n        } else {\n            if (c < 0x800) {\n                buf[pos++] = c >> 0x6 | 0xC0;\n            } else {\n                if (c < 0x10000) {\n                    buf[pos++] = c >> 0xC | 0xE0;\n                } else {\n                    buf[pos++] = c >> 0x12 | 0xF0;\n                    buf[pos++] = c >> 0xC & 0x3F | 0x80;\n                }\n                buf[pos++] = c >> 0x6 & 0x3F | 0x80;\n            }\n            buf[pos++] = c & 0x3F | 0x80;\n        }\n    }\n    return pos;\n}\n","/**\n * @module ol/render/Feature\n */\nimport {UNDEFINED} from '../functions.js';\nimport {extend} from '../array.js';\nimport {createOrUpdateFromCoordinate, createOrUpdateFromFlatCoordinates, getCenter, getHeight} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {linearRingss as linearRingssCenter} from '../geom/flat/center.js';\nimport {getInteriorPointOfArray, getInteriorPointsOfMultiArray} from '../geom/flat/interiorpoint.js';\nimport {interpolatePoint} from '../geom/flat/interpolate.js';\nimport {get as getProjection} from '../proj.js';\nimport {transform2D} from '../geom/flat/transform.js';\nimport {create as createTransform, compose as composeTransform} from '../transform.js';\n\n/**\n * Lightweight, read-only, {@link module:ol/Feature~Feature} and {@link module:ol/geom/Geometry~Geometry} like\n * structure, optimized for vector tile rendering and styling. Geometry access\n * through the API is limited to getting the type and extent of the geometry.\n *\n * @constructor\n * @param {module:ol/geom/GeometryType} type Geometry type.\n * @param {Array.<number>} flatCoordinates Flat coordinates. These always need\n *     to be right-handed for polygons.\n * @param {Array.<number>|Array.<Array.<number>>} ends Ends or Endss.\n * @param {Object.<string, *>} properties Properties.\n * @param {number|string|undefined} id Feature id.\n */\nconst RenderFeature = function(type, flatCoordinates, ends, properties, id) {\n  /**\n   * @private\n   * @type {module:ol/extent~Extent|undefined}\n   */\n  this.extent_;\n\n  /**\n   * @private\n   * @type {number|string|undefined}\n   */\n  this.id_ = id;\n\n  /**\n   * @private\n   * @type {module:ol/geom/GeometryType}\n   */\n  this.type_ = type;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.flatCoordinates_ = flatCoordinates;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.flatInteriorPoints_ = null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.flatMidpoints_ = null;\n\n  /**\n   * @private\n   * @type {Array.<number>|Array.<Array.<number>>}\n   */\n  this.ends_ = ends;\n\n  /**\n   * @private\n   * @type {Object.<string, *>}\n   */\n  this.properties_ = properties;\n\n};\n\n\n/**\n * @type {module:ol/transform~Transform}\n */\nconst tmpTransform = createTransform();\n\n\n/**\n * Get a feature property by its key.\n * @param {string} key Key\n * @return {*} Value for the requested key.\n * @api\n */\nRenderFeature.prototype.get = function(key) {\n  return this.properties_[key];\n};\n\n\n/**\n * @return {Array.<number>|Array.<Array.<number>>} Ends or endss.\n */\nRenderFeature.prototype.getEnds =\nRenderFeature.prototype.getEndss = function() {\n  return this.ends_;\n};\n\n\n/**\n * Get the extent of this feature's geometry.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nRenderFeature.prototype.getExtent = function() {\n  if (!this.extent_) {\n    this.extent_ = this.type_ === GeometryType.POINT ?\n      createOrUpdateFromCoordinate(this.flatCoordinates_) :\n      createOrUpdateFromFlatCoordinates(\n        this.flatCoordinates_, 0, this.flatCoordinates_.length, 2);\n\n  }\n  return this.extent_;\n};\n\n\n/**\n * @return {Array.<number>} Flat interior points.\n */\nRenderFeature.prototype.getFlatInteriorPoint = function() {\n  if (!this.flatInteriorPoints_) {\n    const flatCenter = getCenter(this.getExtent());\n    this.flatInteriorPoints_ = getInteriorPointOfArray(\n      this.flatCoordinates_, 0, this.ends_, 2, flatCenter, 0);\n  }\n  return this.flatInteriorPoints_;\n};\n\n\n/**\n * @return {Array.<number>} Flat interior points.\n */\nRenderFeature.prototype.getFlatInteriorPoints = function() {\n  if (!this.flatInteriorPoints_) {\n    const flatCenters = linearRingssCenter(\n      this.flatCoordinates_, 0, this.ends_, 2);\n    this.flatInteriorPoints_ = getInteriorPointsOfMultiArray(\n      this.flatCoordinates_, 0, this.ends_, 2, flatCenters);\n  }\n  return this.flatInteriorPoints_;\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoint.\n */\nRenderFeature.prototype.getFlatMidpoint = function() {\n  if (!this.flatMidpoints_) {\n    this.flatMidpoints_ = interpolatePoint(\n      this.flatCoordinates_, 0, this.flatCoordinates_.length, 2, 0.5);\n  }\n  return this.flatMidpoints_;\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoints.\n */\nRenderFeature.prototype.getFlatMidpoints = function() {\n  if (!this.flatMidpoints_) {\n    this.flatMidpoints_ = [];\n    const flatCoordinates = this.flatCoordinates_;\n    let offset = 0;\n    const ends = this.ends_;\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      const end = ends[i];\n      const midpoint = interpolatePoint(\n        flatCoordinates, offset, end, 2, 0.5);\n      extend(this.flatMidpoints_, midpoint);\n      offset = end;\n    }\n  }\n  return this.flatMidpoints_;\n};\n\n/**\n * Get the feature identifier.  This is a stable identifier for the feature and\n * is set when reading data from a remote source.\n * @return {number|string|undefined} Id.\n * @api\n */\nRenderFeature.prototype.getId = function() {\n  return this.id_;\n};\n\n\n/**\n * @return {Array.<number>} Flat coordinates.\n */\nRenderFeature.prototype.getOrientedFlatCoordinates = function() {\n  return this.flatCoordinates_;\n};\n\n\n/**\n * @return {Array.<number>} Flat coordinates.\n */\nRenderFeature.prototype.getFlatCoordinates =\n    RenderFeature.prototype.getOrientedFlatCoordinates;\n\n\n/**\n * For API compatibility with {@link module:ol/Feature~Feature}, this method is useful when\n * determining the geometry type in style function (see {@link #getType}).\n * @return {module:ol/render/Feature} Feature.\n * @api\n */\nRenderFeature.prototype.getGeometry = function() {\n  return this;\n};\n\n\n/**\n * Get the feature properties.\n * @return {Object.<string, *>} Feature properties.\n * @api\n */\nRenderFeature.prototype.getProperties = function() {\n  return this.properties_;\n};\n\n\n/**\n * Get the feature for working with its geometry.\n * @return {module:ol/render/Feature} Feature.\n */\nRenderFeature.prototype.getSimplifiedGeometry =\n    RenderFeature.prototype.getGeometry;\n\n\n/**\n * @return {number} Stride.\n */\nRenderFeature.prototype.getStride = function() {\n  return 2;\n};\n\n\n/**\n * @return {undefined}\n */\nRenderFeature.prototype.getStyleFunction = UNDEFINED;\n\n\n/**\n * Get the type of this feature's geometry.\n * @return {module:ol/geom/GeometryType} Geometry type.\n * @api\n */\nRenderFeature.prototype.getType = function() {\n  return this.type_;\n};\n\n/**\n * Transform geometry coordinates from tile pixel space to projected.\n * The SRS of the source and destination are expected to be the same.\n *\n * @param {module:ol/proj~ProjectionLike} source The current projection\n * @param {module:ol/proj~ProjectionLike} destination The desired projection.\n */\nRenderFeature.prototype.transform = function(source, destination) {\n  source = getProjection(source);\n  const pixelExtent = source.getExtent();\n  const projectedExtent = source.getWorldExtent();\n  const scale = getHeight(projectedExtent) / getHeight(pixelExtent);\n  composeTransform(tmpTransform,\n    projectedExtent[0], projectedExtent[3],\n    scale, -scale, 0,\n    0, 0);\n  transform2D(this.flatCoordinates_, 0, this.flatCoordinates_.length, 2,\n    tmpTransform, this.flatCoordinates_);\n};\nexport default RenderFeature;\n","/**\n * @module ol/format/MVT\n */\n//FIXME Implement projection handling\n\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport PBF from 'pbf';\nimport FeatureFormat, {transformWithOptions} from '../format/Feature.js';\nimport FormatType from '../format/FormatType.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {linearRingIsClockwise} from '../geom/flat/orient.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\nimport RenderFeature from '../render/Feature.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {function((module:ol/geom/Geometry|Object.<string,*>)=)|function(module:ol/geom/GeometryType,Array.<number>,(Array.<number>|Array.<Array.<number>>),Object.<string,*>,number)} [featureClass]\n * Class for features returned by {@link module:ol/format/MVT#readFeatures}. Set to\n * {@link module:ol/Feature~Feature} to get full editing and geometry support at the cost of\n * decreased rendering performance. The default is {@link module:ol/render/Feature~RenderFeature},\n * which is optimized for rendering and hit detection.\n * @property {string} [geometryName='geometry'] Geometry name to use when creating\n * features.\n * @property {string} [layerName='layer'] Name of the feature attribute that\n * holds the layer name.\n * @property {Array.<string>} [layers] Layers to read features from. If not\n * provided, features will be read from all layers.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading data in the Mapbox MVT format.\n *\n * @constructor\n * @extends {module:ol/format/Feature}\n * @param {module:ol/format/MVT~Options=} opt_options Options.\n * @api\n */\nconst MVT = function(opt_options) {\n\n  FeatureFormat.call(this);\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/proj/Projection}\n   */\n  this.dataProjection = new Projection({\n    code: '',\n    units: Units.TILE_PIXELS\n  });\n\n  /**\n   * @private\n   * @type {function((module:ol/geom/Geometry|Object.<string,*>)=)|\n   *     function(module:ol/geom/GeometryType,Array.<number>,\n   *         (Array.<number>|Array.<Array.<number>>),Object.<string,*>,number)}\n   */\n  this.featureClass_ = options.featureClass ?\n    options.featureClass : RenderFeature;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.geometryName_ = options.geometryName;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.layerName_ = options.layerName ? options.layerName : 'layer';\n\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.layers_ = options.layers ? options.layers : null;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = null;\n\n};\n\ninherits(MVT, FeatureFormat);\n\n\n/**\n * Reader callback for parsing layers.\n * @param {number} tag The tag.\n * @param {Object} layers The layers object.\n * @param {Object} pbf The PBF.\n */\nfunction layersPBFReader(tag, layers, pbf) {\n  if (tag === 3) {\n    const layer = {\n      keys: [],\n      values: [],\n      features: []\n    };\n    const end = pbf.readVarint() + pbf.pos;\n    pbf.readFields(layerPBFReader, layer, end);\n    layer.length = layer.features.length;\n    if (layer.length) {\n      layers[layer.name] = layer;\n    }\n  }\n}\n\n/**\n * Reader callback for parsing layer.\n * @param {number} tag The tag.\n * @param {Object} layer The layer object.\n * @param {Object} pbf The PBF.\n */\nfunction layerPBFReader(tag, layer, pbf) {\n  if (tag === 15) {\n    layer.version = pbf.readVarint();\n  } else if (tag === 1) {\n    layer.name = pbf.readString();\n  } else if (tag === 5) {\n    layer.extent = pbf.readVarint();\n  } else if (tag === 2) {\n    layer.features.push(pbf.pos);\n  } else if (tag === 3) {\n    layer.keys.push(pbf.readString());\n  } else if (tag === 4) {\n    let value = null;\n    const end = pbf.readVarint() + pbf.pos;\n    while (pbf.pos < end) {\n      tag = pbf.readVarint() >> 3;\n      value = tag === 1 ? pbf.readString() :\n        tag === 2 ? pbf.readFloat() :\n          tag === 3 ? pbf.readDouble() :\n            tag === 4 ? pbf.readVarint64() :\n              tag === 5 ? pbf.readVarint() :\n                tag === 6 ? pbf.readSVarint() :\n                  tag === 7 ? pbf.readBoolean() : null;\n    }\n    layer.values.push(value);\n  }\n}\n\n/**\n * Reader callback for parsing feature.\n * @param {number} tag The tag.\n * @param {Object} feature The feature object.\n * @param {Object} pbf The PBF.\n */\nfunction featurePBFReader(tag, feature, pbf) {\n  if (tag == 1) {\n    feature.id = pbf.readVarint();\n  } else if (tag == 2) {\n    const end = pbf.readVarint() + pbf.pos;\n    while (pbf.pos < end) {\n      const key = feature.layer.keys[pbf.readVarint()];\n      const value = feature.layer.values[pbf.readVarint()];\n      feature.properties[key] = value;\n    }\n  } else if (tag == 3) {\n    feature.type = pbf.readVarint();\n  } else if (tag == 4) {\n    feature.geometry = pbf.pos;\n  }\n}\n\n\n/**\n * Read a raw feature from the pbf offset stored at index `i` in the raw layer.\n * @suppress {missingProperties}\n * @param {Object} pbf PBF.\n * @param {Object} layer Raw layer.\n * @param {number} i Index of the feature in the raw layer's `features` array.\n * @return {Object} Raw feature.\n */\nfunction readRawFeature(pbf, layer, i) {\n  pbf.pos = layer.features[i];\n  const end = pbf.readVarint() + pbf.pos;\n\n  const feature = {\n    layer: layer,\n    type: 0,\n    properties: {}\n  };\n  pbf.readFields(featurePBFReader, feature, end);\n  return feature;\n}\n\n\n/**\n * Read the raw geometry from the pbf offset stored in a raw feature's geometry\n * property.\n * @suppress {missingProperties}\n * @param {Object} pbf PBF.\n * @param {Object} feature Raw feature.\n * @param {Array.<number>} flatCoordinates Array to store flat coordinates in.\n * @param {Array.<number>} ends Array to store ends in.\n * @private\n */\nMVT.prototype.readRawGeometry_ = function(pbf, feature, flatCoordinates, ends) {\n  pbf.pos = feature.geometry;\n\n  const end = pbf.readVarint() + pbf.pos;\n  let cmd = 1;\n  let length = 0;\n  let x = 0;\n  let y = 0;\n  let coordsLen = 0;\n  let currentEnd = 0;\n\n  while (pbf.pos < end) {\n    if (!length) {\n      const cmdLen = pbf.readVarint();\n      cmd = cmdLen & 0x7;\n      length = cmdLen >> 3;\n    }\n\n    length--;\n\n    if (cmd === 1 || cmd === 2) {\n      x += pbf.readSVarint();\n      y += pbf.readSVarint();\n\n      if (cmd === 1) { // moveTo\n        if (coordsLen > currentEnd) {\n          ends.push(coordsLen);\n          currentEnd = coordsLen;\n        }\n      }\n\n      flatCoordinates.push(x, y);\n      coordsLen += 2;\n\n    } else if (cmd === 7) {\n\n      if (coordsLen > currentEnd) {\n        // close polygon\n        flatCoordinates.push(\n          flatCoordinates[currentEnd], flatCoordinates[currentEnd + 1]);\n        coordsLen += 2;\n      }\n\n    } else {\n      assert(false, 59); // Invalid command found in the PBF\n    }\n  }\n\n  if (coordsLen > currentEnd) {\n    ends.push(coordsLen);\n    currentEnd = coordsLen;\n  }\n\n};\n\n\n/**\n * @suppress {missingProperties}\n * @param {number} type The raw feature's geometry type\n * @param {number} numEnds Number of ends of the flat coordinates of the\n * geometry.\n * @return {module:ol/geom/GeometryType} The geometry type.\n */\nfunction getGeometryType(type, numEnds) {\n  /** @type {module:ol/geom/GeometryType} */\n  let geometryType;\n  if (type === 1) {\n    geometryType = numEnds === 1 ?\n      GeometryType.POINT : GeometryType.MULTI_POINT;\n  } else if (type === 2) {\n    geometryType = numEnds === 1 ?\n      GeometryType.LINE_STRING :\n      GeometryType.MULTI_LINE_STRING;\n  } else if (type === 3) {\n    geometryType = GeometryType.POLYGON;\n    // MultiPolygon not relevant for rendering - winding order determines\n    // outer rings of polygons.\n  }\n  return geometryType;\n}\n\n/**\n * @private\n * @param {Object} pbf PBF\n * @param {Object} rawFeature Raw Mapbox feature.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature|module:ol/render/Feature} Feature.\n */\nMVT.prototype.createFeature_ = function(pbf, rawFeature, opt_options) {\n  const type = rawFeature.type;\n  if (type === 0) {\n    return null;\n  }\n\n  let feature;\n  const id = rawFeature.id;\n  const values = rawFeature.properties;\n  values[this.layerName_] = rawFeature.layer.name;\n\n  const flatCoordinates = [];\n  let ends = [];\n  this.readRawGeometry_(pbf, rawFeature, flatCoordinates, ends);\n\n  const geometryType = getGeometryType(type, ends.length);\n\n  if (this.featureClass_ === RenderFeature) {\n    feature = new this.featureClass_(geometryType, flatCoordinates, ends, values, id);\n  } else {\n    let geom;\n    if (geometryType == GeometryType.POLYGON) {\n      const endss = [];\n      let offset = 0;\n      let prevEndIndex = 0;\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        const end = ends[i];\n        if (!linearRingIsClockwise(flatCoordinates, offset, end, 2)) {\n          endss.push(ends.slice(prevEndIndex, i));\n          prevEndIndex = i;\n        }\n        offset = end;\n      }\n      if (endss.length > 1) {\n        ends = endss;\n        geom = new MultiPolygon(null);\n      } else {\n        geom = new Polygon(null);\n      }\n    } else {\n      geom = geometryType === GeometryType.POINT ? new Point(null) :\n        geometryType === GeometryType.LINE_STRING ? new LineString(null) :\n          geometryType === GeometryType.POLYGON ? new Polygon(null) :\n            geometryType === GeometryType.MULTI_POINT ? new MultiPoint (null) :\n              geometryType === GeometryType.MULTI_LINE_STRING ? new MultiLineString(null) :\n                null;\n    }\n    geom.setFlatCoordinates(GeometryLayout.XY, flatCoordinates, ends);\n    feature = new this.featureClass_();\n    if (this.geometryName_) {\n      feature.setGeometryName(this.geometryName_);\n    }\n    const geometry = transformWithOptions(geom, false, this.adaptOptions(opt_options));\n    feature.setGeometry(geometry);\n    feature.setId(id);\n    feature.setProperties(values);\n  }\n\n  return feature;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMVT.prototype.getLastExtent = function() {\n  return this.extent_;\n};\n\n\n/**\n * @inheritDoc\n */\nMVT.prototype.getType = function() {\n  return FormatType.ARRAY_BUFFER;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMVT.prototype.readFeatures = function(source, opt_options) {\n  const layers = this.layers_;\n\n  const pbf = new PBF(/** @type {ArrayBuffer} */ (source));\n  const pbfLayers = pbf.readFields(layersPBFReader, {});\n  /** @type {Array.<module:ol/Feature|module:ol/render/Feature>} */\n  const features = [];\n  for (const name in pbfLayers) {\n    if (layers && layers.indexOf(name) == -1) {\n      continue;\n    }\n    const pbfLayer = pbfLayers[name];\n\n    for (let i = 0, ii = pbfLayer.length; i < ii; ++i) {\n      const rawFeature = readRawFeature(pbf, pbfLayer, i);\n      features.push(this.createFeature_(pbf, rawFeature));\n    }\n    this.extent_ = pbfLayer ? [0, 0, pbfLayer.extent, pbfLayer.extent] : null;\n  }\n\n  return features;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMVT.prototype.readProjection = function(source) {\n  return this.dataProjection;\n};\n\n\n/**\n * Sets the layers that features will be read from.\n * @param {Array.<string>} layers Layers.\n * @api\n */\nMVT.prototype.setLayers = function(layers) {\n  this.layers_ = layers;\n};\n\n\n/**\n * Not implemented.\n * @override\n */\nMVT.prototype.readFeature = function() {};\n\n\n/**\n * Not implemented.\n * @override\n */\nMVT.prototype.readGeometry = function() {};\n\n\n/**\n * Not implemented.\n * @override\n */\nMVT.prototype.writeFeature = function() {};\n\n\n/**\n * Not implemented.\n * @override\n */\nMVT.prototype.writeGeometry = function() {};\n\n\n/**\n * Not implemented.\n * @override\n */\nMVT.prototype.writeFeatures = function() {};\nexport default MVT;\n","/**\n * @module ol/format/OSMXML\n */\n// FIXME add typedef for stack state objects\nimport {inherits} from '../index.js';\nimport {extend} from '../array.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport XMLFeature from '../format/XMLFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {isEmpty} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\nimport {pushParseAndPop, makeStructureNS} from '../xml.js';\n\n/**\n * @classdesc\n * Feature format for reading data in the\n * [OSMXML format](http://wiki.openstreetmap.org/wiki/OSM_XML).\n *\n * @constructor\n * @extends {module:ol/format/XMLFeature}\n * @api\n */\nconst OSMXML = function() {\n  XMLFeature.call(this);\n\n  /**\n   * @inheritDoc\n   */\n  this.dataProjection = getProjection('EPSG:4326');\n};\n\ninherits(OSMXML, XMLFeature);\n\n\n/**\n * @const\n * @type {Array.<null>}\n */\nconst NAMESPACE_URIS = [null];\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst WAY_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'nd': readNd,\n    'tag': readTag\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'node': readNode,\n    'way': readWay\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst NODE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'tag': readTag\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction readNode(node, objectStack) {\n  const options = /** @type {module:ol/format/Feature~ReadOptions} */ (objectStack[0]);\n  const state = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const id = node.getAttribute('id');\n  /** @type {module:ol/coordinate~Coordinate} */\n  const coordinates = [\n    parseFloat(node.getAttribute('lon')),\n    parseFloat(node.getAttribute('lat'))\n  ];\n  state.nodes[id] = coordinates;\n\n  const values = pushParseAndPop({\n    tags: {}\n  }, NODE_PARSERS, node, objectStack);\n  if (!isEmpty(values.tags)) {\n    const geometry = new Point(coordinates);\n    transformWithOptions(geometry, false, options);\n    const feature = new Feature(geometry);\n    feature.setId(id);\n    feature.setProperties(values.tags);\n    state.features.push(feature);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction readWay(node, objectStack) {\n  const id = node.getAttribute('id');\n  const values = pushParseAndPop({\n    id: id,\n    ndrefs: [],\n    tags: {}\n  }, WAY_PARSERS, node, objectStack);\n  const state = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  state.ways.push(values);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction readNd(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  values.ndrefs.push(node.getAttribute('ref'));\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction readTag(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  values.tags[node.getAttribute('k')] = node.getAttribute('v');\n}\n\n\n/**\n * Read all features from an OSM source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nOSMXML.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nOSMXML.prototype.readFeaturesFromNode = function(node, opt_options) {\n  const options = this.getReadOptions(node, opt_options);\n  if (node.localName == 'osm') {\n    const state = pushParseAndPop({\n      nodes: {},\n      ways: [],\n      features: []\n    }, PARSERS, node, [options]);\n    // parse nodes in ways\n    for (let j = 0; j < state.ways.length; j++) {\n      const values = /** @type {Object} */ (state.ways[j]);\n      /** @type {Array.<number>} */\n      const flatCoordinates = [];\n      for (let i = 0, ii = values.ndrefs.length; i < ii; i++) {\n        const point = state.nodes[values.ndrefs[i]];\n        extend(flatCoordinates, point);\n      }\n      let geometry;\n      if (values.ndrefs[0] == values.ndrefs[values.ndrefs.length - 1]) {\n        // closed way\n        geometry = new Polygon(null);\n        geometry.setFlatCoordinates(GeometryLayout.XY, flatCoordinates,\n          [flatCoordinates.length]);\n      } else {\n        geometry = new LineString(null);\n        geometry.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n      }\n      transformWithOptions(geometry, false, options);\n      const feature = new Feature(geometry);\n      feature.setId(values.id);\n      feature.setProperties(values.tags);\n      state.features.push(feature);\n    }\n    if (state.features) {\n      return state.features;\n    }\n  }\n  return [];\n};\n\n\n/**\n * Read the projection from an OSM source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nOSMXML.prototype.readProjection;\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nOSMXML.prototype.writeFeatureNode = function(feature, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nOSMXML.prototype.writeFeaturesNode = function(features, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nOSMXML.prototype.writeGeometryNode = function(geometry, opt_options) {};\nexport default OSMXML;\n","/**\n * @module ol/geom/flat/flip\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {Array.<number>=} opt_dest Destination.\n * @param {number=} opt_destOffset Destination offset.\n * @return {Array.<number>} Flat coordinates.\n */\nexport function flipXY(flatCoordinates, offset, end, stride, opt_dest, opt_destOffset) {\n  let dest, destOffset;\n  if (opt_dest !== undefined) {\n    dest = opt_dest;\n    destOffset = opt_destOffset !== undefined ? opt_destOffset : 0;\n  } else {\n    dest = [];\n    destOffset = 0;\n  }\n  let j = offset;\n  while (j < end) {\n    const x = flatCoordinates[j++];\n    dest[destOffset++] = flatCoordinates[j++];\n    dest[destOffset++] = x;\n    for (let k = 2; k < stride; ++k) {\n      dest[destOffset++] = flatCoordinates[j++];\n    }\n  }\n  dest.length = destOffset;\n  return dest;\n}\n","/**\n * @module ol/format/Polyline\n */\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport TextFeature from '../format/TextFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport {getStrideForLayout} from '../geom/SimpleGeometry.js';\nimport {flipXY} from '../geom/flat/flip.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [factor=1e5] The factor by which the coordinates values will be scaled.\n * @property {module:ol/geom/GeometryLayout} [geometryLayout='XY'] Layout of the\n * feature geometries created by the format reader.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the Encoded\n * Polyline Algorithm Format.\n *\n * @constructor\n * @extends {module:ol/format/TextFeature}\n * @param {module:ol/format/Polyline~Options=} opt_options Optional configuration object.\n * @api\n */\nconst Polyline = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  TextFeature.call(this);\n\n  /**\n   * @inheritDoc\n   */\n  this.dataProjection = getProjection('EPSG:4326');\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.factor_ = options.factor ? options.factor : 1e5;\n\n  /**\n   * @private\n   * @type {module:ol/geom/GeometryLayout}\n   */\n  this.geometryLayout_ = options.geometryLayout ?\n    options.geometryLayout : GeometryLayout.XY;\n};\n\ninherits(Polyline, TextFeature);\n\n\n/**\n * Encode a list of n-dimensional points and return an encoded string\n *\n * Attention: This function will modify the passed array!\n *\n * @param {Array.<number>} numbers A list of n-dimensional points.\n * @param {number} stride The number of dimension of the points in the list.\n * @param {number=} opt_factor The factor by which the numbers will be\n *     multiplied. The remaining decimal places will get rounded away.\n *     Default is `1e5`.\n * @return {string} The encoded string.\n * @api\n */\nexport function encodeDeltas(numbers, stride, opt_factor) {\n  const factor = opt_factor ? opt_factor : 1e5;\n  let d;\n\n  const lastNumbers = new Array(stride);\n  for (d = 0; d < stride; ++d) {\n    lastNumbers[d] = 0;\n  }\n\n  for (let i = 0, ii = numbers.length; i < ii;) {\n    for (d = 0; d < stride; ++d, ++i) {\n      const num = numbers[i];\n      const delta = num - lastNumbers[d];\n      lastNumbers[d] = num;\n\n      numbers[i] = delta;\n    }\n  }\n\n  return encodeFloats(numbers, factor);\n}\n\n\n/**\n * Decode a list of n-dimensional points from an encoded string\n *\n * @param {string} encoded An encoded string.\n * @param {number} stride The number of dimension of the points in the\n *     encoded string.\n * @param {number=} opt_factor The factor by which the resulting numbers will\n *     be divided. Default is `1e5`.\n * @return {Array.<number>} A list of n-dimensional points.\n * @api\n */\nexport function decodeDeltas(encoded, stride, opt_factor) {\n  const factor = opt_factor ? opt_factor : 1e5;\n  let d;\n\n  /** @type {Array.<number>} */\n  const lastNumbers = new Array(stride);\n  for (d = 0; d < stride; ++d) {\n    lastNumbers[d] = 0;\n  }\n\n  const numbers = decodeFloats(encoded, factor);\n\n  for (let i = 0, ii = numbers.length; i < ii;) {\n    for (d = 0; d < stride; ++d, ++i) {\n      lastNumbers[d] += numbers[i];\n\n      numbers[i] = lastNumbers[d];\n    }\n  }\n\n  return numbers;\n}\n\n\n/**\n * Encode a list of floating point numbers and return an encoded string\n *\n * Attention: This function will modify the passed array!\n *\n * @param {Array.<number>} numbers A list of floating point numbers.\n * @param {number=} opt_factor The factor by which the numbers will be\n *     multiplied. The remaining decimal places will get rounded away.\n *     Default is `1e5`.\n * @return {string} The encoded string.\n * @api\n */\nexport function encodeFloats(numbers, opt_factor) {\n  const factor = opt_factor ? opt_factor : 1e5;\n  for (let i = 0, ii = numbers.length; i < ii; ++i) {\n    numbers[i] = Math.round(numbers[i] * factor);\n  }\n\n  return encodeSignedIntegers(numbers);\n}\n\n\n/**\n * Decode a list of floating point numbers from an encoded string\n *\n * @param {string} encoded An encoded string.\n * @param {number=} opt_factor The factor by which the result will be divided.\n *     Default is `1e5`.\n * @return {Array.<number>} A list of floating point numbers.\n * @api\n */\nexport function decodeFloats(encoded, opt_factor) {\n  const factor = opt_factor ? opt_factor : 1e5;\n  const numbers = decodeSignedIntegers(encoded);\n  for (let i = 0, ii = numbers.length; i < ii; ++i) {\n    numbers[i] /= factor;\n  }\n  return numbers;\n}\n\n\n/**\n * Encode a list of signed integers and return an encoded string\n *\n * Attention: This function will modify the passed array!\n *\n * @param {Array.<number>} numbers A list of signed integers.\n * @return {string} The encoded string.\n */\nexport function encodeSignedIntegers(numbers) {\n  for (let i = 0, ii = numbers.length; i < ii; ++i) {\n    const num = numbers[i];\n    numbers[i] = (num < 0) ? ~(num << 1) : (num << 1);\n  }\n  return encodeUnsignedIntegers(numbers);\n}\n\n\n/**\n * Decode a list of signed integers from an encoded string\n *\n * @param {string} encoded An encoded string.\n * @return {Array.<number>} A list of signed integers.\n */\nexport function decodeSignedIntegers(encoded) {\n  const numbers = decodeUnsignedIntegers(encoded);\n  for (let i = 0, ii = numbers.length; i < ii; ++i) {\n    const num = numbers[i];\n    numbers[i] = (num & 1) ? ~(num >> 1) : (num >> 1);\n  }\n  return numbers;\n}\n\n\n/**\n * Encode a list of unsigned integers and return an encoded string\n *\n * @param {Array.<number>} numbers A list of unsigned integers.\n * @return {string} The encoded string.\n */\nexport function encodeUnsignedIntegers(numbers) {\n  let encoded = '';\n  for (let i = 0, ii = numbers.length; i < ii; ++i) {\n    encoded += encodeUnsignedInteger(numbers[i]);\n  }\n  return encoded;\n}\n\n\n/**\n * Decode a list of unsigned integers from an encoded string\n *\n * @param {string} encoded An encoded string.\n * @return {Array.<number>} A list of unsigned integers.\n */\nexport function decodeUnsignedIntegers(encoded) {\n  const numbers = [];\n  let current = 0;\n  let shift = 0;\n  for (let i = 0, ii = encoded.length; i < ii; ++i) {\n    const b = encoded.charCodeAt(i) - 63;\n    current |= (b & 0x1f) << shift;\n    if (b < 0x20) {\n      numbers.push(current);\n      current = 0;\n      shift = 0;\n    } else {\n      shift += 5;\n    }\n  }\n  return numbers;\n}\n\n\n/**\n * Encode one single unsigned integer and return an encoded string\n *\n * @param {number} num Unsigned integer that should be encoded.\n * @return {string} The encoded string.\n */\nexport function encodeUnsignedInteger(num) {\n  let value, encoded = '';\n  while (num >= 0x20) {\n    value = (0x20 | (num & 0x1f)) + 63;\n    encoded += String.fromCharCode(value);\n    num >>= 5;\n  }\n  value = num + 63;\n  encoded += String.fromCharCode(value);\n  return encoded;\n}\n\n\n/**\n * Read the feature from the Polyline source. The coordinates are assumed to be\n * in two dimensions and in latitude, longitude order.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nPolyline.prototype.readFeature;\n\n\n/**\n * @inheritDoc\n */\nPolyline.prototype.readFeatureFromText = function(text, opt_options) {\n  const geometry = this.readGeometryFromText(text, opt_options);\n  return new Feature(geometry);\n};\n\n\n/**\n * Read the feature from the source. As Polyline sources contain a single\n * feature, this will return the feature in an array.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nPolyline.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nPolyline.prototype.readFeaturesFromText = function(text, opt_options) {\n  const feature = this.readFeatureFromText(text, opt_options);\n  return [feature];\n};\n\n\n/**\n * Read the geometry from the source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n * @api\n */\nPolyline.prototype.readGeometry;\n\n\n/**\n * @inheritDoc\n */\nPolyline.prototype.readGeometryFromText = function(text, opt_options) {\n  const stride = getStrideForLayout(this.geometryLayout_);\n  const flatCoordinates = decodeDeltas(text, stride, this.factor_);\n  flipXY(flatCoordinates, 0, flatCoordinates.length, stride, flatCoordinates);\n  const coordinates = inflateCoordinates(flatCoordinates, 0, flatCoordinates.length, stride);\n\n  return (\n    /** @type {module:ol/geom/Geometry} */ (transformWithOptions(\n      new LineString(coordinates, this.geometryLayout_),\n      false,\n      this.adaptOptions(opt_options)\n    ))\n  );\n};\n\n\n/**\n * Read the projection from a Polyline source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nPolyline.prototype.readProjection;\n\n\n/**\n * @inheritDoc\n */\nPolyline.prototype.writeFeatureText = function(feature, opt_options) {\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    return this.writeGeometryText(geometry, opt_options);\n  } else {\n    assert(false, 40); // Expected `feature` to have a geometry\n    return '';\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nPolyline.prototype.writeFeaturesText = function(features, opt_options) {\n  return this.writeFeatureText(features[0], opt_options);\n};\n\n\n/**\n * Write a single geometry in Polyline format.\n *\n * @function\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} Geometry.\n * @api\n */\nPolyline.prototype.writeGeometry;\n\n\n/**\n * @inheritDoc\n */\nPolyline.prototype.writeGeometryText = function(geometry, opt_options) {\n  geometry = /** @type {module:ol/geom/LineString} */\n    (transformWithOptions(geometry, true, this.adaptOptions(opt_options)));\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const stride = geometry.getStride();\n  flipXY(flatCoordinates, 0, flatCoordinates.length, stride, flatCoordinates);\n  return encodeDeltas(flatCoordinates, stride, this.factor_);\n};\nexport default Polyline;\n","/**\n * @module ol/format/TopoJSON\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport JSONFeature from '../format/JSONFeature.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/proj~ProjectionLike} [dataProjection='EPSG:4326'] Default data projection.\n * @property {string} [layerName] Set the name of the TopoJSON topology\n * `objects`'s children as feature property with the specified name. This means\n * that when set to `'layer'`, a topology like\n * ```\n * {\n *   \"type\": \"Topology\",\n *   \"objects\": {\n *     \"example\": {\n *       \"type\": \"GeometryCollection\",\n *       \"geometries\": []\n *     }\n *   }\n * }\n * ```\n * will result in features that have a property `'layer'` set to `'example'`.\n * When not set, no property will be added to features.\n * @property {Array.<string>} [layers] Names of the TopoJSON topology's\n * `objects`'s children to read features from.  If not provided, features will\n * be read from all children.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading data in the TopoJSON format.\n *\n * @constructor\n * @extends {module:ol/format/JSONFeature}\n * @param {module:ol/format/TopoJSON~Options=} opt_options Options.\n * @api\n */\nconst TopoJSON = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  JSONFeature.call(this);\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.layerName_ = options.layerName;\n\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.layers_ = options.layers ? options.layers : null;\n\n  /**\n   * @inheritDoc\n   */\n  this.dataProjection = getProjection(\n    options.dataProjection ?\n      options.dataProjection : 'EPSG:4326');\n\n};\n\ninherits(TopoJSON, JSONFeature);\n\n\n/**\n * @const\n * @type {Object.<string, function(TopoJSONGeometry, Array, ...Array): module:ol/geom/Geometry>}\n */\nconst GEOMETRY_READERS = {\n  'Point': readPointGeometry,\n  'LineString': readLineStringGeometry,\n  'Polygon': readPolygonGeometry,\n  'MultiPoint': readMultiPointGeometry,\n  'MultiLineString': readMultiLineStringGeometry,\n  'MultiPolygon': readMultiPolygonGeometry\n};\n\n\n/**\n * Concatenate arcs into a coordinate array.\n * @param {Array.<number>} indices Indices of arcs to concatenate.  Negative\n *     values indicate arcs need to be reversed.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs (already\n *     transformed).\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates array.\n */\nfunction concatenateArcs(indices, arcs) {\n  /** @type {Array.<module:ol/coordinate~Coordinate>} */\n  const coordinates = [];\n  let index, arc;\n  for (let i = 0, ii = indices.length; i < ii; ++i) {\n    index = indices[i];\n    if (i > 0) {\n      // splicing together arcs, discard last point\n      coordinates.pop();\n    }\n    if (index >= 0) {\n      // forward arc\n      arc = arcs[index];\n    } else {\n      // reverse arc\n      arc = arcs[~index].slice().reverse();\n    }\n    coordinates.push.apply(coordinates, arc);\n  }\n  // provide fresh copies of coordinate arrays\n  for (let j = 0, jj = coordinates.length; j < jj; ++j) {\n    coordinates[j] = coordinates[j].slice();\n  }\n  return coordinates;\n}\n\n\n/**\n * Create a point from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON object.\n * @param {Array.<number>} scale Scale for each dimension.\n * @param {Array.<number>} translate Translation for each dimension.\n * @return {module:ol/geom/Point} Geometry.\n */\nfunction readPointGeometry(object, scale, translate) {\n  const coordinates = object.coordinates;\n  if (scale && translate) {\n    transformVertex(coordinates, scale, translate);\n  }\n  return new Point(coordinates);\n}\n\n\n/**\n * Create a multi-point from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON object.\n * @param {Array.<number>} scale Scale for each dimension.\n * @param {Array.<number>} translate Translation for each dimension.\n * @return {module:ol/geom/MultiPoint} Geometry.\n */\nfunction readMultiPointGeometry(object, scale, translate) {\n  const coordinates = object.coordinates;\n  if (scale && translate) {\n    for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n      transformVertex(coordinates[i], scale, translate);\n    }\n  }\n  return new MultiPoint(coordinates);\n}\n\n\n/**\n * Create a linestring from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON object.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs.\n * @return {module:ol/geom/LineString} Geometry.\n */\nfunction readLineStringGeometry(object, arcs) {\n  const coordinates = concatenateArcs(object.arcs, arcs);\n  return new LineString(coordinates);\n}\n\n\n/**\n * Create a multi-linestring from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON object.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs.\n * @return {module:ol/geom/MultiLineString} Geometry.\n */\nfunction readMultiLineStringGeometry(object, arcs) {\n  const coordinates = [];\n  for (let i = 0, ii = object.arcs.length; i < ii; ++i) {\n    coordinates[i] = concatenateArcs(object.arcs[i], arcs);\n  }\n  return new MultiLineString(coordinates);\n}\n\n\n/**\n * Create a polygon from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON object.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs.\n * @return {module:ol/geom/Polygon} Geometry.\n */\nfunction readPolygonGeometry(object, arcs) {\n  const coordinates = [];\n  for (let i = 0, ii = object.arcs.length; i < ii; ++i) {\n    coordinates[i] = concatenateArcs(object.arcs[i], arcs);\n  }\n  return new Polygon(coordinates);\n}\n\n\n/**\n * Create a multi-polygon from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON object.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs.\n * @return {module:ol/geom/MultiPolygon} Geometry.\n */\nfunction readMultiPolygonGeometry(object, arcs) {\n  const coordinates = [];\n  for (let i = 0, ii = object.arcs.length; i < ii; ++i) {\n    // for each polygon\n    const polyArray = object.arcs[i];\n    const ringCoords = [];\n    for (let j = 0, jj = polyArray.length; j < jj; ++j) {\n      // for each ring\n      ringCoords[j] = concatenateArcs(polyArray[j], arcs);\n    }\n    coordinates[i] = ringCoords;\n  }\n  return new MultiPolygon(coordinates);\n}\n\n\n/**\n * Create features from a TopoJSON GeometryCollection object.\n *\n * @param {TopoJSONGeometryCollection} collection TopoJSON Geometry\n *     object.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs.\n * @param {Array.<number>} scale Scale for each dimension.\n * @param {Array.<number>} translate Translation for each dimension.\n * @param {string|undefined} property Property to set the `GeometryCollection`'s parent\n *     object to.\n * @param {string} name Name of the `Topology`'s child object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Array of features.\n */\nfunction readFeaturesFromGeometryCollection(collection, arcs, scale, translate, property, name, opt_options) {\n  const geometries = collection.geometries;\n  const features = [];\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    features[i] = readFeatureFromGeometry(\n      geometries[i], arcs, scale, translate, property, name, opt_options);\n  }\n  return features;\n}\n\n\n/**\n * Create a feature from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON geometry object.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs.\n * @param {Array.<number>} scale Scale for each dimension.\n * @param {Array.<number>} translate Translation for each dimension.\n * @param {string|undefined} property Property to set the `GeometryCollection`'s parent\n *     object to.\n * @param {string} name Name of the `Topology`'s child object.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n */\nfunction readFeatureFromGeometry(object, arcs, scale, translate, property, name, opt_options) {\n  let geometry;\n  const type = object.type;\n  const geometryReader = GEOMETRY_READERS[type];\n  if ((type === 'Point') || (type === 'MultiPoint')) {\n    geometry = geometryReader(object, scale, translate);\n  } else {\n    geometry = geometryReader(object, arcs);\n  }\n  const feature = new Feature();\n  feature.setGeometry(/** @type {module:ol/geom/Geometry} */ (\n    transformWithOptions(geometry, false, opt_options)));\n  if (object.id !== undefined) {\n    feature.setId(object.id);\n  }\n  let properties = object.properties;\n  if (property) {\n    if (!properties) {\n      properties = {};\n    }\n    properties[property] = name;\n  }\n  if (properties) {\n    feature.setProperties(properties);\n  }\n  return feature;\n}\n\n\n/**\n * Read all features from a TopoJSON source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nTopoJSON.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nTopoJSON.prototype.readFeaturesFromObject = function(object, opt_options) {\n  if (object.type == 'Topology') {\n    const topoJSONTopology = /** @type {TopoJSONTopology} */ (object);\n    let transform, scale = null, translate = null;\n    if (topoJSONTopology.transform) {\n      transform = topoJSONTopology.transform;\n      scale = transform.scale;\n      translate = transform.translate;\n    }\n    const arcs = topoJSONTopology.arcs;\n    if (transform) {\n      transformArcs(arcs, scale, translate);\n    }\n    /** @type {Array.<module:ol/Feature>} */\n    const features = [];\n    const topoJSONFeatures = topoJSONTopology.objects;\n    const property = this.layerName_;\n    let feature;\n    for (const objectName in topoJSONFeatures) {\n      if (this.layers_ && this.layers_.indexOf(objectName) == -1) {\n        continue;\n      }\n      if (topoJSONFeatures[objectName].type === 'GeometryCollection') {\n        feature = /** @type {TopoJSONGeometryCollection} */ (topoJSONFeatures[objectName]);\n        features.push.apply(features, readFeaturesFromGeometryCollection(\n          feature, arcs, scale, translate, property, objectName, opt_options));\n      } else {\n        feature = /** @type {TopoJSONGeometry} */ (topoJSONFeatures[objectName]);\n        features.push(readFeatureFromGeometry(\n          feature, arcs, scale, translate, property, objectName, opt_options));\n      }\n    }\n    return features;\n  } else {\n    return [];\n  }\n};\n\n\n/**\n * Apply a linear transform to array of arcs.  The provided array of arcs is\n * modified in place.\n *\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} arcs Array of arcs.\n * @param {Array.<number>} scale Scale for each dimension.\n * @param {Array.<number>} translate Translation for each dimension.\n */\nfunction transformArcs(arcs, scale, translate) {\n  for (let i = 0, ii = arcs.length; i < ii; ++i) {\n    transformArc(arcs[i], scale, translate);\n  }\n}\n\n\n/**\n * Apply a linear transform to an arc.  The provided arc is modified in place.\n *\n * @param {Array.<module:ol/coordinate~Coordinate>} arc Arc.\n * @param {Array.<number>} scale Scale for each dimension.\n * @param {Array.<number>} translate Translation for each dimension.\n */\nfunction transformArc(arc, scale, translate) {\n  let x = 0;\n  let y = 0;\n  for (let i = 0, ii = arc.length; i < ii; ++i) {\n    const vertex = arc[i];\n    x += vertex[0];\n    y += vertex[1];\n    vertex[0] = x;\n    vertex[1] = y;\n    transformVertex(vertex, scale, translate);\n  }\n}\n\n\n/**\n * Apply a linear transform to a vertex.  The provided vertex is modified in\n * place.\n *\n * @param {module:ol/coordinate~Coordinate} vertex Vertex.\n * @param {Array.<number>} scale Scale for each dimension.\n * @param {Array.<number>} translate Translation for each dimension.\n */\nfunction transformVertex(vertex, scale, translate) {\n  vertex[0] = vertex[0] * scale[0] + translate[0];\n  vertex[1] = vertex[1] * scale[1] + translate[1];\n}\n\n\n/**\n * Read the projection from a TopoJSON source.\n *\n * @param {Document|Node|Object|string} object Source.\n * @return {module:ol/proj/Projection} Projection.\n * @override\n * @api\n */\nTopoJSON.prototype.readProjection;\n\n\n/**\n * @inheritDoc\n */\nTopoJSON.prototype.readProjectionFromObject = function(object) {\n  return this.dataProjection;\n};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nTopoJSON.prototype.writeFeatureObject = function(feature, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nTopoJSON.prototype.writeFeaturesObject = function(features, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nTopoJSON.prototype.writeGeometryObject = function(geometry, opt_options) {};\n\n\n/**\n * Not implemented.\n * @override\n */\nTopoJSON.prototype.readGeometryFromObject = function() {};\n\n\n/**\n * Not implemented.\n * @override\n */\nTopoJSON.prototype.readFeatureFromObject = function() {};\nexport default TopoJSON;\n","/**\n * @module ol/format/filter/Filter\n */\n\n\n/**\n * @classdesc\n * Abstract class; normally only used for creating subclasses and not instantiated in apps.\n * Base class for WFS GetFeature filters.\n *\n * @constructor\n * @abstract\n * @param {!string} tagName The XML tag name for this filter.\n * @struct\n */\nconst Filter = function(tagName) {\n\n  /**\n   * @private\n   * @type {!string}\n   */\n  this.tagName_ = tagName;\n};\n\n/**\n * The XML tag name for a filter.\n * @returns {!string} Name.\n */\nFilter.prototype.getTagName = function() {\n  return this.tagName_;\n};\n\nexport default Filter;\n","/**\n * @module ol/format/filter/LogicalNary\n */\nimport {inherits} from '../../index.js';\nimport {assert} from '../../asserts.js';\nimport Filter from '../filter/Filter.js';\n\n/**\n * @classdesc\n * Abstract class; normally only used for creating subclasses and not instantiated in apps.\n * Base class for WFS GetFeature n-ary logical filters.\n *\n * @constructor\n * @abstract\n * @param {!string} tagName The XML tag name for this filter.\n * @param {...module:ol/format/filter/Filter} conditions Conditions.\n * @extends {module:ol/format/filter/Filter}\n */\nconst LogicalNary = function(tagName, conditions) {\n\n  Filter.call(this, tagName);\n\n  /**\n   * @type {Array.<module:ol/format/filter/Filter>}\n   */\n  this.conditions = Array.prototype.slice.call(arguments, 1);\n  assert(this.conditions.length >= 2, 57); // At least 2 conditions are required.\n};\n\ninherits(LogicalNary, Filter);\nexport default LogicalNary;\n","/**\n * @module ol/format/filter/And\n */\nimport {inherits} from '../../index.js';\nimport LogicalNary from '../filter/LogicalNary.js';\n\n/**\n * @classdesc\n * Represents a logical `<And>` operator between two or more filter conditions.\n *\n * @constructor\n * @abstract\n * @param {...module:ol/format/filter/Filter} conditions Conditions.\n * @extends {module:ol/format/filter/LogicalNary}\n */\nconst And = function(conditions) {\n  const params = ['And'].concat(Array.prototype.slice.call(arguments));\n  LogicalNary.apply(this, params);\n};\n\ninherits(And, LogicalNary);\n\nexport default And;\n","/**\n * @module ol/format/filter/Bbox\n */\nimport {inherits} from '../../index.js';\nimport Filter from '../filter/Filter.js';\n\n/**\n * @classdesc\n * Represents a `<BBOX>` operator to test whether a geometry-valued property\n * intersects a fixed bounding box\n *\n * @constructor\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/extent~Extent} extent Extent.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @extends {module:ol/format/filter/Filter}\n * @api\n */\nconst Bbox = function(geometryName, extent, opt_srsName) {\n\n  Filter.call(this, 'BBOX');\n\n  /**\n   * @type {!string}\n   */\n  this.geometryName = geometryName;\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent = extent;\n\n  /**\n   * @type {string|undefined}\n   */\n  this.srsName = opt_srsName;\n};\n\ninherits(Bbox, Filter);\n\nexport default Bbox;\n","/**\n * @module ol/format/filter/Spatial\n */\nimport {inherits} from '../../index.js';\nimport Filter from '../filter/Filter.js';\n\n/**\n * @classdesc\n * Abstract class; normally only used for creating subclasses and not instantiated in apps.\n * Represents a spatial operator to test whether a geometry-valued property\n * relates to a given geometry.\n *\n * @constructor\n * @abstract\n * @param {!string} tagName The XML tag name for this filter.\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/geom/Geometry} geometry Geometry.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @extends {module:ol/format/filter/Filter}\n */\nconst Spatial = function(tagName, geometryName, geometry, opt_srsName) {\n\n  Filter.call(this, tagName);\n\n  /**\n   * @type {!string}\n   */\n  this.geometryName = geometryName || 'the_geom';\n\n  /**\n   * @type {module:ol/geom/Geometry}\n   */\n  this.geometry = geometry;\n\n  /**\n   * @type {string|undefined}\n   */\n  this.srsName = opt_srsName;\n};\n\ninherits(Spatial, Filter);\n\nexport default Spatial;\n","/**\n * @module ol/format/filter/Contains\n */\nimport {inherits} from '../../index.js';\nimport Spatial from '../filter/Spatial.js';\n\n/**\n * @classdesc\n * Represents a `<Contains>` operator to test whether a geometry-valued property\n * contains a given geometry.\n *\n * @constructor\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/geom/Geometry} geometry Geometry.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @extends {module:ol/format/filter/Spatial}\n * @api\n */\nconst Contains = function(geometryName, geometry, opt_srsName) {\n\n  Spatial.call(this, 'Contains', geometryName, geometry, opt_srsName);\n\n};\n\ninherits(Contains, Spatial);\nexport default Contains;\n","/**\n * @module ol/format/filter/Comparison\n */\nimport {inherits} from '../../index.js';\nimport Filter from '../filter/Filter.js';\n\n/**\n * @classdesc\n * Abstract class; normally only used for creating subclasses and not instantiated in apps.\n * Base class for WFS GetFeature property comparison filters.\n *\n * @constructor\n * @abstract\n * @param {!string} tagName The XML tag name for this filter.\n * @param {!string} propertyName Name of the context property to compare.\n * @extends {module:ol/format/filter/Filter}\n */\nconst Comparison = function(tagName, propertyName) {\n\n  Filter.call(this, tagName);\n\n  /**\n   * @type {!string}\n   */\n  this.propertyName = propertyName;\n};\n\ninherits(Comparison, Filter);\n\nexport default Comparison;\n","/**\n * @module ol/format/filter/During\n */\nimport {inherits} from '../../index.js';\nimport Comparison from '../filter/Comparison.js';\n\n/**\n * @classdesc\n * Represents a `<During>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!string} begin The begin date in ISO-8601 format.\n * @param {!string} end The end date in ISO-8601 format.\n * @extends {module:ol/format/filter/Comparison}\n * @api\n */\nconst During = function(propertyName, begin, end) {\n  Comparison.call(this, 'During', propertyName);\n\n  /**\n   * @type {!string}\n   */\n  this.begin = begin;\n\n  /**\n   * @type {!string}\n   */\n  this.end = end;\n};\n\ninherits(During, Comparison);\nexport default During;\n","/**\n * @module ol/format/filter/ComparisonBinary\n */\nimport {inherits} from '../../index.js';\nimport Comparison from '../filter/Comparison.js';\n\n/**\n * @classdesc\n * Abstract class; normally only used for creating subclasses and not instantiated in apps.\n * Base class for WFS GetFeature property binary comparison filters.\n *\n * @constructor\n * @abstract\n * @param {!string} tagName The XML tag name for this filter.\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!(string|number)} expression The value to compare.\n * @param {boolean=} opt_matchCase Case-sensitive?\n * @extends {module:ol/format/filter/Comparison}\n */\nconst ComparisonBinary = function(tagName, propertyName, expression, opt_matchCase) {\n\n  Comparison.call(this, tagName, propertyName);\n\n  /**\n   * @type {!(string|number)}\n   */\n  this.expression = expression;\n\n  /**\n   * @type {boolean|undefined}\n   */\n  this.matchCase = opt_matchCase;\n};\n\ninherits(ComparisonBinary, Comparison);\nexport default ComparisonBinary;\n","/**\n * @module ol/format/filter/EqualTo\n */\nimport {inherits} from '../../index.js';\nimport ComparisonBinary from '../filter/ComparisonBinary.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsEqualTo>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!(string|number)} expression The value to compare.\n * @param {boolean=} opt_matchCase Case-sensitive?\n * @extends {module:ol/format/filter/ComparisonBinary}\n * @api\n */\nconst EqualTo = function(propertyName, expression, opt_matchCase) {\n  ComparisonBinary.call(this, 'PropertyIsEqualTo', propertyName, expression, opt_matchCase);\n};\n\ninherits(EqualTo, ComparisonBinary);\nexport default EqualTo;\n","/**\n * @module ol/format/filter/GreaterThan\n */\nimport {inherits} from '../../index.js';\nimport ComparisonBinary from '../filter/ComparisonBinary.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsGreaterThan>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @extends {module:ol/format/filter/ComparisonBinary}\n * @api\n */\nconst GreaterThan = function(propertyName, expression) {\n  ComparisonBinary.call(this, 'PropertyIsGreaterThan', propertyName, expression);\n};\n\ninherits(GreaterThan, ComparisonBinary);\nexport default GreaterThan;\n","/**\n * @module ol/format/filter/GreaterThanOrEqualTo\n */\nimport {inherits} from '../../index.js';\nimport ComparisonBinary from '../filter/ComparisonBinary.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsGreaterThanOrEqualTo>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @extends {module:ol/format/filter/ComparisonBinary}\n * @api\n */\nconst GreaterThanOrEqualTo = function(propertyName, expression) {\n  ComparisonBinary.call(this, 'PropertyIsGreaterThanOrEqualTo', propertyName, expression);\n};\n\ninherits(GreaterThanOrEqualTo, ComparisonBinary);\nexport default GreaterThanOrEqualTo;\n","/**\n * @module ol/format/filter/Intersects\n */\nimport {inherits} from '../../index.js';\nimport Spatial from '../filter/Spatial.js';\n\n/**\n * @classdesc\n * Represents a `<Intersects>` operator to test whether a geometry-valued property\n * intersects a given geometry.\n *\n * @constructor\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/geom/Geometry} geometry Geometry.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @extends {module:ol/format/filter/Spatial}\n * @api\n */\nconst Intersects = function(geometryName, geometry, opt_srsName) {\n\n  Spatial.call(this, 'Intersects', geometryName, geometry, opt_srsName);\n\n};\n\ninherits(Intersects, Spatial);\nexport default Intersects;\n","/**\n * @module ol/format/filter/IsBetween\n */\nimport {inherits} from '../../index.js';\nimport Comparison from '../filter/Comparison.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsBetween>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} lowerBoundary The lower bound of the range.\n * @param {!number} upperBoundary The upper bound of the range.\n * @extends {module:ol/format/filter/Comparison}\n * @api\n */\nconst IsBetween = function(propertyName, lowerBoundary, upperBoundary) {\n  Comparison.call(this, 'PropertyIsBetween', propertyName);\n\n  /**\n   * @type {!number}\n   */\n  this.lowerBoundary = lowerBoundary;\n\n  /**\n   * @type {!number}\n   */\n  this.upperBoundary = upperBoundary;\n};\n\ninherits(IsBetween, Comparison);\nexport default IsBetween;\n","/**\n * @module ol/format/filter/IsLike\n */\nimport {inherits} from '../../index.js';\nimport Comparison from '../filter/Comparison.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsLike>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!string} pattern Text pattern.\n * @param {string=} opt_wildCard Pattern character which matches any sequence of\n *    zero or more string characters. Default is '*'.\n * @param {string=} opt_singleChar pattern character which matches any single\n *    string character. Default is '.'.\n * @param {string=} opt_escapeChar Escape character which can be used to escape\n *    the pattern characters. Default is '!'.\n * @param {boolean=} opt_matchCase Case-sensitive?\n * @extends {module:ol/format/filter/Comparison}\n * @api\n */\nconst IsLike = function(propertyName, pattern, opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase) {\n  Comparison.call(this, 'PropertyIsLike', propertyName);\n\n  /**\n   * @type {!string}\n   */\n  this.pattern = pattern;\n\n  /**\n   * @type {!string}\n   */\n  this.wildCard = (opt_wildCard !== undefined) ? opt_wildCard : '*';\n\n  /**\n   * @type {!string}\n   */\n  this.singleChar = (opt_singleChar !== undefined) ? opt_singleChar : '.';\n\n  /**\n   * @type {!string}\n   */\n  this.escapeChar = (opt_escapeChar !== undefined) ? opt_escapeChar : '!';\n\n  /**\n   * @type {boolean|undefined}\n   */\n  this.matchCase = opt_matchCase;\n};\n\ninherits(IsLike, Comparison);\nexport default IsLike;\n","/**\n * @module ol/format/filter/IsNull\n */\nimport {inherits} from '../../index.js';\nimport Comparison from '../filter/Comparison.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsNull>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @extends {module:ol/format/filter/Comparison}\n * @api\n */\nconst IsNull = function(propertyName) {\n  Comparison.call(this, 'PropertyIsNull', propertyName);\n};\n\ninherits(IsNull, Comparison);\nexport default IsNull;\n","/**\n * @module ol/format/filter/LessThan\n */\nimport {inherits} from '../../index.js';\nimport ComparisonBinary from '../filter/ComparisonBinary.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsLessThan>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @extends {module:ol/format/filter/ComparisonBinary}\n * @api\n */\nconst LessThan = function(propertyName, expression) {\n  ComparisonBinary.call(this, 'PropertyIsLessThan', propertyName, expression);\n};\n\ninherits(LessThan, ComparisonBinary);\nexport default LessThan;\n","/**\n * @module ol/format/filter/LessThanOrEqualTo\n */\nimport {inherits} from '../../index.js';\nimport ComparisonBinary from '../filter/ComparisonBinary.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsLessThanOrEqualTo>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @extends {module:ol/format/filter/ComparisonBinary}\n * @api\n */\nconst LessThanOrEqualTo = function(propertyName, expression) {\n  ComparisonBinary.call(this, 'PropertyIsLessThanOrEqualTo', propertyName, expression);\n};\n\ninherits(LessThanOrEqualTo, ComparisonBinary);\nexport default LessThanOrEqualTo;\n","/**\n * @module ol/format/filter/Not\n */\nimport {inherits} from '../../index.js';\nimport Filter from '../filter/Filter.js';\n\n/**\n * @classdesc\n * Represents a logical `<Not>` operator for a filter condition.\n *\n * @constructor\n * @param {!module:ol/format/filter/Filter} condition Filter condition.\n * @extends {module:ol/format/filter/Filter}\n * @api\n */\nconst Not = function(condition) {\n\n  Filter.call(this, 'Not');\n\n  /**\n   * @type {!module:ol/format/filter/Filter}\n   */\n  this.condition = condition;\n};\n\ninherits(Not, Filter);\nexport default Not;\n","/**\n * @module ol/format/filter/NotEqualTo\n */\nimport {inherits} from '../../index.js';\nimport ComparisonBinary from '../filter/ComparisonBinary.js';\n\n/**\n * @classdesc\n * Represents a `<PropertyIsNotEqualTo>` comparison operator.\n *\n * @constructor\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!(string|number)} expression The value to compare.\n * @param {boolean=} opt_matchCase Case-sensitive?\n * @extends {module:ol/format/filter/ComparisonBinary}\n * @api\n */\nconst NotEqualTo = function(propertyName, expression, opt_matchCase) {\n  ComparisonBinary.call(this, 'PropertyIsNotEqualTo', propertyName, expression, opt_matchCase);\n};\n\ninherits(NotEqualTo, ComparisonBinary);\nexport default NotEqualTo;\n","/**\n * @module ol/format/filter/Or\n */\nimport {inherits} from '../../index.js';\nimport LogicalNary from '../filter/LogicalNary.js';\n\n/**\n * @classdesc\n * Represents a logical `<Or>` operator between two ore more filter conditions.\n *\n * @constructor\n * @param {...module:ol/format/filter/Filter} conditions Conditions.\n * @extends {module:ol/format/filter/LogicalNary}\n * @api\n */\nconst Or = function(conditions) {\n  const params = ['Or'].concat(Array.prototype.slice.call(arguments));\n  LogicalNary.apply(this, params);\n};\n\ninherits(Or, LogicalNary);\nexport default Or;\n","/**\n * @module ol/format/filter/Within\n */\nimport {inherits} from '../../index.js';\nimport Spatial from '../filter/Spatial.js';\n\n/**\n * @classdesc\n * Represents a `<Within>` operator to test whether a geometry-valued property\n * is within a given geometry.\n *\n * @constructor\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/geom/Geometry} geometry Geometry.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @extends {module:ol/format/filter/Spatial}\n * @api\n */\nconst Within = function(geometryName, geometry, opt_srsName) {\n\n  Spatial.call(this, 'Within', geometryName, geometry, opt_srsName);\n\n};\n\ninherits(Within, Spatial);\nexport default Within;\n","/**\n * @module ol/format/filter\n */\nimport And from '../format/filter/And.js';\nimport Bbox from '../format/filter/Bbox.js';\nimport Contains from '../format/filter/Contains.js';\nimport During from '../format/filter/During.js';\nimport EqualTo from '../format/filter/EqualTo.js';\nimport GreaterThan from '../format/filter/GreaterThan.js';\nimport GreaterThanOrEqualTo from '../format/filter/GreaterThanOrEqualTo.js';\nimport Intersects from '../format/filter/Intersects.js';\nimport IsBetween from '../format/filter/IsBetween.js';\nimport IsLike from '../format/filter/IsLike.js';\nimport IsNull from '../format/filter/IsNull.js';\nimport LessThan from '../format/filter/LessThan.js';\nimport LessThanOrEqualTo from '../format/filter/LessThanOrEqualTo.js';\nimport Not from '../format/filter/Not.js';\nimport NotEqualTo from '../format/filter/NotEqualTo.js';\nimport Or from '../format/filter/Or.js';\nimport Within from '../format/filter/Within.js';\n\n\n/**\n * Create a logical `<And>` operator between two or more filter conditions.\n *\n * @param {...module:ol/format/filter/Filter} conditions Filter conditions.\n * @returns {!module:ol/format/filter/And} `<And>` operator.\n * @api\n */\nexport function and(conditions) {\n  const params = [null].concat(Array.prototype.slice.call(arguments));\n  return new (Function.prototype.bind.apply(And, params));\n}\n\n\n/**\n * Create a logical `<Or>` operator between two or more filter conditions.\n *\n * @param {...module:ol/format/filter/Filter} conditions Filter conditions.\n * @returns {!module:ol/format/filter/Or} `<Or>` operator.\n * @api\n */\nexport function or(conditions) {\n  const params = [null].concat(Array.prototype.slice.call(arguments));\n  return new (Function.prototype.bind.apply(Or, params));\n}\n\n\n/**\n * Represents a logical `<Not>` operator for a filter condition.\n *\n * @param {!module:ol/format/filter/Filter} condition Filter condition.\n * @returns {!module:ol/format/filter/Not} `<Not>` operator.\n * @api\n */\nexport function not(condition) {\n  return new Not(condition);\n}\n\n\n/**\n * Create a `<BBOX>` operator to test whether a geometry-valued property\n * intersects a fixed bounding box\n *\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/extent~Extent} extent Extent.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @returns {!module:ol/format/filter/Bbox} `<BBOX>` operator.\n * @api\n */\nexport function bbox(geometryName, extent, opt_srsName) {\n  return new Bbox(geometryName, extent, opt_srsName);\n}\n\n/**\n * Create a `<Contains>` operator to test whether a geometry-valued property\n * contains a given geometry.\n *\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/geom/Geometry} geometry Geometry.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @returns {!module:ol/format/filter/Contains} `<Contains>` operator.\n * @api\n */\nexport function contains(geometryName, geometry, opt_srsName) {\n  return new Contains(geometryName, geometry, opt_srsName);\n}\n\n/**\n * Create a `<Intersects>` operator to test whether a geometry-valued property\n * intersects a given geometry.\n *\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/geom/Geometry} geometry Geometry.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @returns {!module:ol/format/filter/Intersects} `<Intersects>` operator.\n * @api\n */\nexport function intersects(geometryName, geometry, opt_srsName) {\n  return new Intersects(geometryName, geometry, opt_srsName);\n}\n\n/**\n * Create a `<Within>` operator to test whether a geometry-valued property\n * is within a given geometry.\n *\n * @param {!string} geometryName Geometry name to use.\n * @param {!module:ol/geom/Geometry} geometry Geometry.\n * @param {string=} opt_srsName SRS name. No srsName attribute will be\n *    set on geometries when this is not provided.\n * @returns {!module:ol/format/filter/Within} `<Within>` operator.\n * @api\n */\nexport function within(geometryName, geometry, opt_srsName) {\n  return new Within(geometryName, geometry, opt_srsName);\n}\n\n\n/**\n * Creates a `<PropertyIsEqualTo>` comparison operator.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!(string|number)} expression The value to compare.\n * @param {boolean=} opt_matchCase Case-sensitive?\n * @returns {!module:ol/format/filter/EqualTo} `<PropertyIsEqualTo>` operator.\n * @api\n */\nexport function equalTo(propertyName, expression, opt_matchCase) {\n  return new EqualTo(propertyName, expression, opt_matchCase);\n}\n\n\n/**\n * Creates a `<PropertyIsNotEqualTo>` comparison operator.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!(string|number)} expression The value to compare.\n * @param {boolean=} opt_matchCase Case-sensitive?\n * @returns {!module:ol/format/filter/NotEqualTo} `<PropertyIsNotEqualTo>` operator.\n * @api\n */\nexport function notEqualTo(propertyName, expression, opt_matchCase) {\n  return new NotEqualTo(propertyName, expression, opt_matchCase);\n}\n\n\n/**\n * Creates a `<PropertyIsLessThan>` comparison operator.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @returns {!module:ol/format/filter/LessThan} `<PropertyIsLessThan>` operator.\n * @api\n */\nexport function lessThan(propertyName, expression) {\n  return new LessThan(propertyName, expression);\n}\n\n\n/**\n * Creates a `<PropertyIsLessThanOrEqualTo>` comparison operator.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @returns {!module:ol/format/filter/LessThanOrEqualTo} `<PropertyIsLessThanOrEqualTo>` operator.\n * @api\n */\nexport function lessThanOrEqualTo(propertyName, expression) {\n  return new LessThanOrEqualTo(propertyName, expression);\n}\n\n\n/**\n * Creates a `<PropertyIsGreaterThan>` comparison operator.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @returns {!module:ol/format/filter/GreaterThan} `<PropertyIsGreaterThan>` operator.\n * @api\n */\nexport function greaterThan(propertyName, expression) {\n  return new GreaterThan(propertyName, expression);\n}\n\n\n/**\n * Creates a `<PropertyIsGreaterThanOrEqualTo>` comparison operator.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} expression The value to compare.\n * @returns {!module:ol/format/filter/GreaterThanOrEqualTo} `<PropertyIsGreaterThanOrEqualTo>` operator.\n * @api\n */\nexport function greaterThanOrEqualTo(propertyName, expression) {\n  return new GreaterThanOrEqualTo(propertyName, expression);\n}\n\n\n/**\n * Creates a `<PropertyIsNull>` comparison operator to test whether a property value\n * is null.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @returns {!module:ol/format/filter/IsNull} `<PropertyIsNull>` operator.\n * @api\n */\nexport function isNull(propertyName) {\n  return new IsNull(propertyName);\n}\n\n\n/**\n * Creates a `<PropertyIsBetween>` comparison operator to test whether an expression\n * value lies within a range given by a lower and upper bound (inclusive).\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!number} lowerBoundary The lower bound of the range.\n * @param {!number} upperBoundary The upper bound of the range.\n * @returns {!module:ol/format/filter/IsBetween} `<PropertyIsBetween>` operator.\n * @api\n */\nexport function between(propertyName, lowerBoundary, upperBoundary) {\n  return new IsBetween(propertyName, lowerBoundary, upperBoundary);\n}\n\n\n/**\n * Represents a `<PropertyIsLike>` comparison operator that matches a string property\n * value against a text pattern.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!string} pattern Text pattern.\n * @param {string=} opt_wildCard Pattern character which matches any sequence of\n *    zero or more string characters. Default is '*'.\n * @param {string=} opt_singleChar pattern character which matches any single\n *    string character. Default is '.'.\n * @param {string=} opt_escapeChar Escape character which can be used to escape\n *    the pattern characters. Default is '!'.\n * @param {boolean=} opt_matchCase Case-sensitive?\n * @returns {!module:ol/format/filter/IsLike} `<PropertyIsLike>` operator.\n * @api\n */\nexport function like(propertyName, pattern,\n  opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase) {\n  return new IsLike(propertyName, pattern,\n    opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase);\n}\n\n\n/**\n * Create a `<During>` temporal operator.\n *\n * @param {!string} propertyName Name of the context property to compare.\n * @param {!string} begin The begin date in ISO-8601 format.\n * @param {!string} end The end date in ISO-8601 format.\n * @returns {!module:ol/format/filter/During} `<During>` operator.\n * @api\n */\nexport function during(propertyName, begin, end) {\n  return new During(propertyName, begin, end);\n}\n","/**\n * @module ol/format/WFS\n */\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport GML2 from '../format/GML2.js';\nimport GML3 from '../format/GML3.js';\nimport GMLBase, {GMLNS} from '../format/GMLBase.js';\nimport {and as andFilter, bbox as bboxFilter} from '../format/filter.js';\nimport XMLFeature from '../format/XMLFeature.js';\nimport {readNonNegativeIntegerString, readNonNegativeInteger, writeStringTextNode} from '../format/xsd.js';\nimport Geometry from '../geom/Geometry.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\nimport {createElementNS, isDocument, isNode, makeArrayPusher, makeChildAppender,\n  makeObjectPropertySetter, makeSimpleNodeFactory, parse, parseNode,\n  pushParseAndPop, pushSerializeAndPop, XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Object.<string, string>|string} [featureNS] The namespace URI used for features.\n * @property {Array.<string>|string} [featureType] The feature type to parse. Only used for read operations.\n * @property {module:ol/format/GMLBase} [gmlFormat] The GML format to use to parse the response. Default is `ol/format/GML3`.\n * @property {string} [schemaLocation] Optional schemaLocation to use for serialization, this will override the default.\n */\n\n\n/**\n * @typedef {Object} WriteGetFeatureOptions\n * @property {string} featureNS The namespace URI used for features.\n * @property {string} featurePrefix The prefix for the feature namespace.\n * @property {Array.<string>} featureTypes The feature type names.\n * @property {string} [srsName] SRS name. No srsName attribute will be set on\n * geometries when this is not provided.\n * @property {string} [handle] Handle.\n * @property {string} [outputFormat] Output format.\n * @property {number} [maxFeatures] Maximum number of features to fetch.\n * @property {string} [geometryName] Geometry name to use in a BBOX filter.\n * @property {Array.<string>} [propertyNames] Optional list of property names to serialize.\n * @property {number} [startIndex] Start index to use for WFS paging. This is a\n * WFS 2.0 feature backported to WFS 1.1.0 by some Web Feature Services.\n * @property {number} [count] Number of features to retrieve when paging. This is a\n * WFS 2.0 feature backported to WFS 1.1.0 by some Web Feature Services. Please note that some\n * Web Feature Services have repurposed `maxfeatures` instead.\n * @property {module:ol/extent~Extent} [bbox] Extent to use for the BBOX filter.\n * @property {module:ol/format/filter/Filter} [filter] Filter condition. See\n * {@link module:ol/format/Filter} for more information.\n * @property {string} [resultType] Indicates what response should be returned,\n * E.g. `hits` only includes the `numberOfFeatures` attribute in the response and no features.\n */\n\n\n/**\n * @typedef {Object} WriteTransactionOptions\n * @property {string} featureNS The namespace URI used for features.\n * @property {string} featurePrefix The prefix for the feature namespace.\n * @property {string} featureType The feature type name.\n * @property {string} [srsName] SRS name. No srsName attribute will be set on\n * geometries when this is not provided.\n * @property {string} [handle] Handle.\n * @property {boolean} [hasZ] Must be set to true if the transaction is for\n * a 3D layer. This will allow the Z coordinate to be included in the transaction.\n * @property {Array.<Object>} nativeElements Native elements. Currently not supported.\n * @property {module:ol/format/GMLBase~Options} [gmlOptions] GML options for the WFS transaction writer.\n * @property {string} [version='1.1.0'] WFS version to use for the transaction. Can be either `1.0.0` or `1.1.0`.\n */\n\n\n/**\n * Number of features; bounds/extent.\n * @typedef {Object} FeatureCollectionMetadata\n * @property {number} numberOfFeatures\n * @property {module:ol/extent~Extent} bounds\n */\n\n\n/**\n * Total deleted; total inserted; total updated; array of insert ids.\n * @typedef {Object} TransactionResponse\n * @property {number} totalDeleted\n * @property {number} totalInserted\n * @property {number} totalUpdated\n * @property {Array.<string>} insertIds\n */\n\n\n/**\n * @type {string}\n */\nconst FEATURE_PREFIX = 'feature';\n\n\n/**\n * @type {string}\n */\nconst XMLNS = 'http://www.w3.org/2000/xmlns/';\n\n\n/**\n * @type {string}\n */\nconst OGCNS = 'http://www.opengis.net/ogc';\n\n\n/**\n * @type {string}\n */\nconst WFSNS = 'http://www.opengis.net/wfs';\n\n\n/**\n * @type {string}\n */\nconst FESNS = 'http://www.opengis.net/fes';\n\n\n/**\n * @type {Object.<string, string>}\n */\nconst SCHEMA_LOCATIONS = {\n  '1.1.0': 'http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd',\n  '1.0.0': 'http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd'\n};\n\n\n/**\n * @const\n * @type {string}\n */\nconst DEFAULT_VERSION = '1.1.0';\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the WFS format.\n * By default, supports WFS version 1.1.0. You can pass a GML format\n * as option if you want to read a WFS that contains GML2 (WFS 1.0.0).\n * Also see {@link module:ol/format/GMLBase~GMLBase} which is used by this format.\n *\n * @constructor\n * @param {module:ol/format/WFS~Options=} opt_options Optional configuration object.\n * @extends {module:ol/format/XMLFeature}\n * @api\n */\nconst WFS = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {Array.<string>|string|undefined}\n   */\n  this.featureType_ = options.featureType;\n\n  /**\n   * @private\n   * @type {Object.<string, string>|string|undefined}\n   */\n  this.featureNS_ = options.featureNS;\n\n  /**\n   * @private\n   * @type {module:ol/format/GMLBase}\n   */\n  this.gmlFormat_ = options.gmlFormat ?\n    options.gmlFormat : new GML3();\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.schemaLocation_ = options.schemaLocation ?\n    options.schemaLocation : SCHEMA_LOCATIONS[DEFAULT_VERSION];\n\n  XMLFeature.call(this);\n};\n\ninherits(WFS, XMLFeature);\n\n\n/**\n * @return {Array.<string>|string|undefined} featureType\n */\nWFS.prototype.getFeatureType = function() {\n  return this.featureType_;\n};\n\n\n/**\n * @param {Array.<string>|string|undefined} featureType Feature type(s) to parse.\n */\nWFS.prototype.setFeatureType = function(featureType) {\n  this.featureType_ = featureType;\n};\n\n\n/**\n * Read all features from a WFS FeatureCollection.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nWFS.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nWFS.prototype.readFeaturesFromNode = function(node, opt_options) {\n  const context = /** @type {module:ol/xml~NodeStackItem} */ ({\n    'featureType': this.featureType_,\n    'featureNS': this.featureNS_\n  });\n  assign(context, this.getReadOptions(node, opt_options ? opt_options : {}));\n  const objectStack = [context];\n  this.gmlFormat_.FEATURE_COLLECTION_PARSERS[GMLNS][\n    'featureMember'] =\n      makeArrayPusher(GMLBase.prototype.readFeaturesInternal);\n  let features = pushParseAndPop([],\n    this.gmlFormat_.FEATURE_COLLECTION_PARSERS, node,\n    objectStack, this.gmlFormat_);\n  if (!features) {\n    features = [];\n  }\n  return features;\n};\n\n\n/**\n * Read transaction response of the source.\n *\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/format/WFS~TransactionResponse|undefined} Transaction response.\n * @api\n */\nWFS.prototype.readTransactionResponse = function(source) {\n  if (isDocument(source)) {\n    return this.readTransactionResponseFromDocument(\n      /** @type {Document} */ (source));\n  } else if (isNode(source)) {\n    return this.readTransactionResponseFromNode(/** @type {Node} */ (source));\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readTransactionResponseFromDocument(doc);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * Read feature collection metadata of the source.\n *\n * @param {Document|Node|Object|string} source Source.\n * @return {module:ol/format/WFS~FeatureCollectionMetadata|undefined}\n *     FeatureCollection metadata.\n * @api\n */\nWFS.prototype.readFeatureCollectionMetadata = function(source) {\n  if (isDocument(source)) {\n    return this.readFeatureCollectionMetadataFromDocument(\n      /** @type {Document} */ (source));\n  } else if (isNode(source)) {\n    return this.readFeatureCollectionMetadataFromNode(\n      /** @type {Node} */ (source));\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readFeatureCollectionMetadataFromDocument(doc);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {Document} doc Document.\n * @return {module:ol/format/WFS~FeatureCollectionMetadata|undefined}\n *     FeatureCollection metadata.\n */\nWFS.prototype.readFeatureCollectionMetadataFromDocument = function(doc) {\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      return this.readFeatureCollectionMetadataFromNode(n);\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst FEATURE_COLLECTION_PARSERS = {\n  'http://www.opengis.net/gml': {\n    'boundedBy': makeObjectPropertySetter(\n      GMLBase.prototype.readGeometryElement, 'bounds')\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @return {module:ol/format/WFS~FeatureCollectionMetadata|undefined}\n *     FeatureCollection metadata.\n */\nWFS.prototype.readFeatureCollectionMetadataFromNode = function(node) {\n  const result = {};\n  const value = readNonNegativeIntegerString(\n    node.getAttribute('numberOfFeatures'));\n  result['numberOfFeatures'] = value;\n  return pushParseAndPop(\n    /** @type {module:ol/format/WFS~FeatureCollectionMetadata} */ (result),\n    FEATURE_COLLECTION_PARSERS, node, [], this.gmlFormat_);\n};\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TRANSACTION_SUMMARY_PARSERS = {\n  'http://www.opengis.net/wfs': {\n    'totalInserted': makeObjectPropertySetter(readNonNegativeInteger),\n    'totalUpdated': makeObjectPropertySetter(readNonNegativeInteger),\n    'totalDeleted': makeObjectPropertySetter(readNonNegativeInteger)\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Transaction Summary.\n */\nfunction readTransactionSummary(node, objectStack) {\n  return pushParseAndPop(\n    {}, TRANSACTION_SUMMARY_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst OGC_FID_PARSERS = {\n  'http://www.opengis.net/ogc': {\n    'FeatureId': makeArrayPusher(function(node, objectStack) {\n      return node.getAttribute('fid');\n    })\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n */\nfunction fidParser(node, objectStack) {\n  parseNode(OGC_FID_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst INSERT_RESULTS_PARSERS = {\n  'http://www.opengis.net/wfs': {\n    'Feature': fidParser\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<string>|undefined} Insert results.\n */\nfunction readInsertResults(node, objectStack) {\n  return pushParseAndPop(\n    [], INSERT_RESULTS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TRANSACTION_RESPONSE_PARSERS = {\n  'http://www.opengis.net/wfs': {\n    'TransactionSummary': makeObjectPropertySetter(\n      readTransactionSummary, 'transactionSummary'),\n    'InsertResults': makeObjectPropertySetter(\n      readInsertResults, 'insertIds')\n  }\n};\n\n\n/**\n * @param {Document} doc Document.\n * @return {module:ol/format/WFS~TransactionResponse|undefined} Transaction response.\n */\nWFS.prototype.readTransactionResponseFromDocument = function(doc) {\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      return this.readTransactionResponseFromNode(n);\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @param {Node} node Node.\n * @return {module:ol/format/WFS~TransactionResponse|undefined} Transaction response.\n */\nWFS.prototype.readTransactionResponseFromNode = function(node) {\n  return pushParseAndPop(\n    /** @type {module:ol/format/WFS~TransactionResponse} */({}),\n    TRANSACTION_RESPONSE_PARSERS, node, []);\n};\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst QUERY_SERIALIZERS = {\n  'http://www.opengis.net/wfs': {\n    'PropertyName': makeChildAppender(writeStringTextNode)\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeFeature(node, feature, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const featureType = context['featureType'];\n  const featureNS = context['featureNS'];\n  const gmlVersion = context['gmlVersion'];\n  const child = createElementNS(featureNS, featureType);\n  node.appendChild(child);\n  if (gmlVersion === 2) {\n    GML2.prototype.writeFeatureElement(child, feature, objectStack);\n  } else {\n    GML3.prototype.writeFeatureElement(child, feature, objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {number|string} fid Feature identifier.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeOgcFidFilter(node, fid, objectStack) {\n  const filter = createElementNS(OGCNS, 'Filter');\n  const child = createElementNS(OGCNS, 'FeatureId');\n  filter.appendChild(child);\n  child.setAttribute('fid', fid);\n  node.appendChild(filter);\n}\n\n\n/**\n * @param {string|undefined} featurePrefix The prefix of the feature.\n * @param {string} featureType The type of the feature.\n * @returns {string} The value of the typeName property.\n */\nfunction getTypeName(featurePrefix, featureType) {\n  featurePrefix = featurePrefix ? featurePrefix : FEATURE_PREFIX;\n  const prefix = featurePrefix + ':';\n  // The featureType already contains the prefix.\n  if (featureType.indexOf(prefix) === 0) {\n    return featureType;\n  } else {\n    return prefix + featureType;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeDelete(node, feature, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  assert(feature.getId() !== undefined, 26); // Features must have an id set\n  const featureType = context['featureType'];\n  const featurePrefix = context['featurePrefix'];\n  const featureNS = context['featureNS'];\n  const typeName = getTypeName(featurePrefix, featureType);\n  node.setAttribute('typeName', typeName);\n  node.setAttributeNS(XMLNS, 'xmlns:' + featurePrefix, featureNS);\n  const fid = feature.getId();\n  if (fid !== undefined) {\n    writeOgcFidFilter(node, fid, objectStack);\n  }\n}\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst TRANSACTION_SERIALIZERS = {\n  'http://www.opengis.net/wfs': {\n    'Insert': makeChildAppender(writeFeature),\n    'Update': makeChildAppender(writeUpdate),\n    'Delete': makeChildAppender(writeDelete),\n    'Property': makeChildAppender(writeProperty),\n    'Native': makeChildAppender(writeNative)\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/Feature} feature Feature.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeUpdate(node, feature, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  assert(feature.getId() !== undefined, 27); // Features must have an id set\n  const featureType = context['featureType'];\n  const featurePrefix = context['featurePrefix'];\n  const featureNS = context['featureNS'];\n  const typeName = getTypeName(featurePrefix, featureType);\n  const geometryName = feature.getGeometryName();\n  node.setAttribute('typeName', typeName);\n  node.setAttributeNS(XMLNS, 'xmlns:' + featurePrefix, featureNS);\n  const fid = feature.getId();\n  if (fid !== undefined) {\n    const keys = feature.getKeys();\n    const values = [];\n    for (let i = 0, ii = keys.length; i < ii; i++) {\n      const value = feature.get(keys[i]);\n      if (value !== undefined) {\n        let name = keys[i];\n        if (value instanceof Geometry) {\n          name = geometryName;\n        }\n        values.push({name: name, value: value});\n      }\n    }\n    pushSerializeAndPop(/** @type {module:ol/xml~NodeStackItem} */ (\n      {'gmlVersion': context['gmlVersion'], node: node,\n        'hasZ': context['hasZ'], 'srsName': context['srsName']}),\n    TRANSACTION_SERIALIZERS,\n    makeSimpleNodeFactory('Property'), values,\n    objectStack);\n    writeOgcFidFilter(node, fid, objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Object} pair Property name and value.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeProperty(node, pair, objectStack) {\n  const name = createElementNS(WFSNS, 'Name');\n  const context = objectStack[objectStack.length - 1];\n  const gmlVersion = context['gmlVersion'];\n  node.appendChild(name);\n  writeStringTextNode(name, pair.name);\n  if (pair.value !== undefined && pair.value !== null) {\n    const value = createElementNS(WFSNS, 'Value');\n    node.appendChild(value);\n    if (pair.value instanceof Geometry) {\n      if (gmlVersion === 2) {\n        GML2.prototype.writeGeometryElement(value,\n          pair.value, objectStack);\n      } else {\n        GML3.prototype.writeGeometryElement(value,\n          pair.value, objectStack);\n      }\n    } else {\n      writeStringTextNode(value, pair.value);\n    }\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {{vendorId: string, safeToIgnore: boolean, value: string}}\n *     nativeElement The native element.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeNative(node, nativeElement, objectStack) {\n  if (nativeElement.vendorId) {\n    node.setAttribute('vendorId', nativeElement.vendorId);\n  }\n  if (nativeElement.safeToIgnore !== undefined) {\n    node.setAttribute('safeToIgnore', nativeElement.safeToIgnore);\n  }\n  if (nativeElement.value !== undefined) {\n    writeStringTextNode(node, nativeElement.value);\n  }\n}\n\n\n/**\n * @type {Object.<string, Object.<string, module:ol/xml~Serializer>>}\n */\nconst GETFEATURE_SERIALIZERS = {\n  'http://www.opengis.net/wfs': {\n    'Query': makeChildAppender(writeQuery)\n  },\n  'http://www.opengis.net/ogc': {\n    'During': makeChildAppender(writeDuringFilter),\n    'And': makeChildAppender(writeLogicalFilter),\n    'Or': makeChildAppender(writeLogicalFilter),\n    'Not': makeChildAppender(writeNotFilter),\n    'BBOX': makeChildAppender(writeBboxFilter),\n    'Contains': makeChildAppender(writeContainsFilter),\n    'Intersects': makeChildAppender(writeIntersectsFilter),\n    'Within': makeChildAppender(writeWithinFilter),\n    'PropertyIsEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsNotEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsLessThan': makeChildAppender(writeComparisonFilter),\n    'PropertyIsLessThanOrEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsGreaterThan': makeChildAppender(writeComparisonFilter),\n    'PropertyIsGreaterThanOrEqualTo': makeChildAppender(writeComparisonFilter),\n    'PropertyIsNull': makeChildAppender(writeIsNullFilter),\n    'PropertyIsBetween': makeChildAppender(writeIsBetweenFilter),\n    'PropertyIsLike': makeChildAppender(writeIsLikeFilter)\n  }\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {string} featureType Feature type.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeQuery(node, featureType, objectStack) {\n  const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const featurePrefix = context['featurePrefix'];\n  const featureNS = context['featureNS'];\n  const propertyNames = context['propertyNames'];\n  const srsName = context['srsName'];\n  let typeName;\n  // If feature prefix is not defined, we must not use the default prefix.\n  if (featurePrefix) {\n    typeName = getTypeName(featurePrefix, featureType);\n  } else {\n    typeName = featureType;\n  }\n  node.setAttribute('typeName', typeName);\n  if (srsName) {\n    node.setAttribute('srsName', srsName);\n  }\n  if (featureNS) {\n    node.setAttributeNS(XMLNS, 'xmlns:' + featurePrefix, featureNS);\n  }\n  const item = /** @type {module:ol/xml~NodeStackItem} */ (assign({}, context));\n  item.node = node;\n  pushSerializeAndPop(item,\n    QUERY_SERIALIZERS,\n    makeSimpleNodeFactory('PropertyName'), propertyNames,\n    objectStack);\n  const filter = context['filter'];\n  if (filter) {\n    const child = createElementNS(OGCNS, 'Filter');\n    node.appendChild(child);\n    writeFilterCondition(child, filter, objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/Filter} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeFilterCondition(node, filter, objectStack) {\n  /** @type {module:ol/xml~NodeStackItem} */\n  const item = {node: node};\n  pushSerializeAndPop(item,\n    GETFEATURE_SERIALIZERS,\n    makeSimpleNodeFactory(filter.getTagName()),\n    [filter], objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/Bbox} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeBboxFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.extent, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/Contains} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeContainsFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.geometry, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/Intersects} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeIntersectsFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.geometry, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/Within} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeWithinFilter(node, filter, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  context['srsName'] = filter.srsName;\n\n  writeOgcPropertyName(node, filter.geometryName);\n  GML3.prototype.writeGeometryElement(node, filter.geometry, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/During} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeDuringFilter(node, filter, objectStack) {\n\n  const valueReference = createElementNS(FESNS, 'ValueReference');\n  writeStringTextNode(valueReference, filter.propertyName);\n  node.appendChild(valueReference);\n\n  const timePeriod = createElementNS(GMLNS, 'TimePeriod');\n\n  node.appendChild(timePeriod);\n\n  const begin = createElementNS(GMLNS, 'begin');\n  timePeriod.appendChild(begin);\n  writeTimeInstant(begin, filter.begin);\n\n  const end = createElementNS(GMLNS, 'end');\n  timePeriod.appendChild(end);\n  writeTimeInstant(end, filter.end);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/LogicalNary} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeLogicalFilter(node, filter, objectStack) {\n  /** @type {module:ol/xml~NodeStackItem} */\n  const item = {node: node};\n  const conditions = filter.conditions;\n  for (let i = 0, ii = conditions.length; i < ii; ++i) {\n    const condition = conditions[i];\n    pushSerializeAndPop(item,\n      GETFEATURE_SERIALIZERS,\n      makeSimpleNodeFactory(condition.getTagName()),\n      [condition], objectStack);\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/Not} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeNotFilter(node, filter, objectStack) {\n  /** @type {module:ol/xml~NodeStackItem} */\n  const item = {node: node};\n  const condition = filter.condition;\n  pushSerializeAndPop(item,\n    GETFEATURE_SERIALIZERS,\n    makeSimpleNodeFactory(condition.getTagName()),\n    [condition], objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/ComparisonBinary} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeComparisonFilter(node, filter, objectStack) {\n  if (filter.matchCase !== undefined) {\n    node.setAttribute('matchCase', filter.matchCase.toString());\n  }\n  writeOgcPropertyName(node, filter.propertyName);\n  writeOgcLiteral(node, '' + filter.expression);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/IsNull} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeIsNullFilter(node, filter, objectStack) {\n  writeOgcPropertyName(node, filter.propertyName);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/IsBetween} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeIsBetweenFilter(node, filter, objectStack) {\n  writeOgcPropertyName(node, filter.propertyName);\n\n  const lowerBoundary = createElementNS(OGCNS, 'LowerBoundary');\n  node.appendChild(lowerBoundary);\n  writeOgcLiteral(lowerBoundary, '' + filter.lowerBoundary);\n\n  const upperBoundary = createElementNS(OGCNS, 'UpperBoundary');\n  node.appendChild(upperBoundary);\n  writeOgcLiteral(upperBoundary, '' + filter.upperBoundary);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {module:ol/format/filter/IsLike} filter Filter.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeIsLikeFilter(node, filter, objectStack) {\n  node.setAttribute('wildCard', filter.wildCard);\n  node.setAttribute('singleChar', filter.singleChar);\n  node.setAttribute('escapeChar', filter.escapeChar);\n  if (filter.matchCase !== undefined) {\n    node.setAttribute('matchCase', filter.matchCase.toString());\n  }\n  writeOgcPropertyName(node, filter.propertyName);\n  writeOgcLiteral(node, '' + filter.pattern);\n}\n\n\n/**\n * @param {string} tagName Tag name.\n * @param {Node} node Node.\n * @param {string} value Value.\n */\nfunction writeOgcExpression(tagName, node, value) {\n  const property = createElementNS(OGCNS, tagName);\n  writeStringTextNode(property, value);\n  node.appendChild(property);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {string} value PropertyName value.\n */\nfunction writeOgcPropertyName(node, value) {\n  writeOgcExpression('PropertyName', node, value);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {string} value PropertyName value.\n */\nfunction writeOgcLiteral(node, value) {\n  writeOgcExpression('Literal', node, value);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {string} time PropertyName value.\n */\nfunction writeTimeInstant(node, time) {\n  const timeInstant = createElementNS(GMLNS, 'TimeInstant');\n  node.appendChild(timeInstant);\n\n  const timePosition = createElementNS(GMLNS, 'timePosition');\n  timeInstant.appendChild(timePosition);\n  writeStringTextNode(timePosition, time);\n}\n\n\n/**\n * Encode filter as WFS `Filter` and return the Node.\n *\n * @param {module:ol/format/filter/Filter} filter Filter.\n * @return {Node} Result.\n * @api\n */\nexport function writeFilter(filter) {\n  const child = createElementNS(OGCNS, 'Filter');\n  writeFilterCondition(child, filter, []);\n  return child;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<string>} featureTypes Feature types.\n * @param {Array.<*>} objectStack Node stack.\n */\nfunction writeGetFeature(node, featureTypes, objectStack) {\n  const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const item = /** @type {module:ol/xml~NodeStackItem} */ (assign({}, context));\n  item.node = node;\n  pushSerializeAndPop(item,\n    GETFEATURE_SERIALIZERS,\n    makeSimpleNodeFactory('Query'), featureTypes,\n    objectStack);\n}\n\n\n/**\n * Encode format as WFS `GetFeature` and return the Node.\n *\n * @param {module:ol/format/WFS~WriteGetFeatureOptions} options Options.\n * @return {Node} Result.\n * @api\n */\nWFS.prototype.writeGetFeature = function(options) {\n  const node = createElementNS(WFSNS, 'GetFeature');\n  node.setAttribute('service', 'WFS');\n  node.setAttribute('version', '1.1.0');\n  let filter;\n  if (options) {\n    if (options.handle) {\n      node.setAttribute('handle', options.handle);\n    }\n    if (options.outputFormat) {\n      node.setAttribute('outputFormat', options.outputFormat);\n    }\n    if (options.maxFeatures !== undefined) {\n      node.setAttribute('maxFeatures', options.maxFeatures);\n    }\n    if (options.resultType) {\n      node.setAttribute('resultType', options.resultType);\n    }\n    if (options.startIndex !== undefined) {\n      node.setAttribute('startIndex', options.startIndex);\n    }\n    if (options.count !== undefined) {\n      node.setAttribute('count', options.count);\n    }\n    filter = options.filter;\n    if (options.bbox) {\n      assert(options.geometryName,\n        12); // `options.geometryName` must also be provided when `options.bbox` is set\n      const bbox = bboxFilter(\n        /** @type {string} */ (options.geometryName), options.bbox, options.srsName);\n      if (filter) {\n        // if bbox and filter are both set, combine the two into a single filter\n        filter = andFilter(filter, bbox);\n      } else {\n        filter = bbox;\n      }\n    }\n  }\n  node.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', this.schemaLocation_);\n  /** @type {module:ol/xml~NodeStackItem} */\n  const context = {\n    node: node,\n    'srsName': options.srsName,\n    'featureNS': options.featureNS ? options.featureNS : this.featureNS_,\n    'featurePrefix': options.featurePrefix,\n    'geometryName': options.geometryName,\n    'filter': filter,\n    'propertyNames': options.propertyNames ? options.propertyNames : []\n  };\n  assert(Array.isArray(options.featureTypes),\n    11); // `options.featureTypes` should be an Array\n  writeGetFeature(node, /** @type {!Array.<string>} */ (options.featureTypes), [context]);\n  return node;\n};\n\n\n/**\n * Encode format as WFS `Transaction` and return the Node.\n *\n * @param {Array.<module:ol/Feature>} inserts The features to insert.\n * @param {Array.<module:ol/Feature>} updates The features to update.\n * @param {Array.<module:ol/Feature>} deletes The features to delete.\n * @param {module:ol/format/WFS~WriteTransactionOptions} options Write options.\n * @return {Node} Result.\n * @api\n */\nWFS.prototype.writeTransaction = function(inserts, updates, deletes, options) {\n  const objectStack = [];\n  const node = createElementNS(WFSNS, 'Transaction');\n  const version = options.version ? options.version : DEFAULT_VERSION;\n  const gmlVersion = version === '1.0.0' ? 2 : 3;\n  node.setAttribute('service', 'WFS');\n  node.setAttribute('version', version);\n  let baseObj;\n  /** @type {module:ol/xml~NodeStackItem} */\n  let obj;\n  if (options) {\n    baseObj = options.gmlOptions ? options.gmlOptions : {};\n    if (options.handle) {\n      node.setAttribute('handle', options.handle);\n    }\n  }\n  const schemaLocation = SCHEMA_LOCATIONS[version];\n  node.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', schemaLocation);\n  const featurePrefix = options.featurePrefix ? options.featurePrefix : FEATURE_PREFIX;\n  if (inserts) {\n    obj = {node: node, 'featureNS': options.featureNS,\n      'featureType': options.featureType, 'featurePrefix': featurePrefix,\n      'gmlVersion': gmlVersion, 'hasZ': options.hasZ, 'srsName': options.srsName};\n    assign(obj, baseObj);\n    pushSerializeAndPop(obj,\n      TRANSACTION_SERIALIZERS,\n      makeSimpleNodeFactory('Insert'), inserts,\n      objectStack);\n  }\n  if (updates) {\n    obj = {node: node, 'featureNS': options.featureNS,\n      'featureType': options.featureType, 'featurePrefix': featurePrefix,\n      'gmlVersion': gmlVersion, 'hasZ': options.hasZ, 'srsName': options.srsName};\n    assign(obj, baseObj);\n    pushSerializeAndPop(obj,\n      TRANSACTION_SERIALIZERS,\n      makeSimpleNodeFactory('Update'), updates,\n      objectStack);\n  }\n  if (deletes) {\n    pushSerializeAndPop({node: node, 'featureNS': options.featureNS,\n      'featureType': options.featureType, 'featurePrefix': featurePrefix,\n      'gmlVersion': gmlVersion, 'srsName': options.srsName},\n    TRANSACTION_SERIALIZERS,\n    makeSimpleNodeFactory('Delete'), deletes,\n    objectStack);\n  }\n  if (options.nativeElements) {\n    pushSerializeAndPop({node: node, 'featureNS': options.featureNS,\n      'featureType': options.featureType, 'featurePrefix': featurePrefix,\n      'gmlVersion': gmlVersion, 'srsName': options.srsName},\n    TRANSACTION_SERIALIZERS,\n    makeSimpleNodeFactory('Native'), options.nativeElements,\n    objectStack);\n  }\n  return node;\n};\n\n\n/**\n * Read the projection from a WFS source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @return {?module:ol/proj/Projection} Projection.\n * @api\n */\nWFS.prototype.readProjection;\n\n\n/**\n * @inheritDoc\n */\nWFS.prototype.readProjectionFromDocument = function(doc) {\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      return this.readProjectionFromNode(n);\n    }\n  }\n  return null;\n};\n\n\n/**\n * @inheritDoc\n */\nWFS.prototype.readProjectionFromNode = function(node) {\n  if (node.firstElementChild &&\n      node.firstElementChild.firstElementChild) {\n    node = node.firstElementChild.firstElementChild;\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      if (!(n.childNodes.length === 0 ||\n          (n.childNodes.length === 1 &&\n          n.firstChild.nodeType === 3))) {\n        const objectStack = [{}];\n        this.gmlFormat_.readGeometryElement(n, objectStack);\n        return getProjection(objectStack.pop().srsName);\n      }\n    }\n  }\n\n  return null;\n};\nexport default WFS;\n","/**\n * @module ol/format/WKT\n */\nimport {inherits} from '../index.js';\nimport Feature from '../Feature.js';\nimport {transformWithOptions} from '../format/Feature.js';\nimport TextFeature from '../format/TextFeature.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [splitCollection=false] Whether to split GeometryCollections into\n * multiple features on reading.\n */\n\n/**\n * @typedef {Object} Token\n * @property {number} type\n * @property {number|string} [value]\n * @property {number} position\n */\n\n/**\n * @const\n * @type {string}\n */\nconst EMPTY = 'EMPTY';\n\n\n/**\n * @const\n * @type {string}\n */\nconst Z = 'Z';\n\n\n/**\n * @const\n * @type {string}\n */\nconst M = 'M';\n\n\n/**\n * @const\n * @type {string}\n */\nconst ZM = 'ZM';\n\n\n/**\n * @const\n * @enum {number}\n */\nconst TokenType = {\n  TEXT: 1,\n  LEFT_PAREN: 2,\n  RIGHT_PAREN: 3,\n  NUMBER: 4,\n  COMMA: 5,\n  EOF: 6\n};\n\n\n/**\n * Class to tokenize a WKT string.\n * @param {string} wkt WKT string.\n * @constructor\n */\nconst Lexer = function(wkt) {\n\n  /**\n   * @type {string}\n   */\n  this.wkt = wkt;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.index_ = -1;\n};\n\n\n/**\n * @param {string} c Character.\n * @return {boolean} Whether the character is alphabetic.\n * @private\n */\nLexer.prototype.isAlpha_ = function(c) {\n  return c >= 'a' && c <= 'z' || c >= 'A' && c <= 'Z';\n};\n\n\n/**\n * @param {string} c Character.\n * @param {boolean=} opt_decimal Whether the string number\n *     contains a dot, i.e. is a decimal number.\n * @return {boolean} Whether the character is numeric.\n * @private\n */\nLexer.prototype.isNumeric_ = function(c, opt_decimal) {\n  const decimal = opt_decimal !== undefined ? opt_decimal : false;\n  return c >= '0' && c <= '9' || c == '.' && !decimal;\n};\n\n\n/**\n * @param {string} c Character.\n * @return {boolean} Whether the character is whitespace.\n * @private\n */\nLexer.prototype.isWhiteSpace_ = function(c) {\n  return c == ' ' || c == '\\t' || c == '\\r' || c == '\\n';\n};\n\n\n/**\n * @return {string} Next string character.\n * @private\n */\nLexer.prototype.nextChar_ = function() {\n  return this.wkt.charAt(++this.index_);\n};\n\n\n/**\n * Fetch and return the next token.\n * @return {!module:ol/format/WKT~Token} Next string token.\n */\nLexer.prototype.nextToken = function() {\n  const c = this.nextChar_();\n  const token = {position: this.index_, value: c};\n\n  if (c == '(') {\n    token.type = TokenType.LEFT_PAREN;\n  } else if (c == ',') {\n    token.type = TokenType.COMMA;\n  } else if (c == ')') {\n    token.type = TokenType.RIGHT_PAREN;\n  } else if (this.isNumeric_(c) || c == '-') {\n    token.type = TokenType.NUMBER;\n    token.value = this.readNumber_();\n  } else if (this.isAlpha_(c)) {\n    token.type = TokenType.TEXT;\n    token.value = this.readText_();\n  } else if (this.isWhiteSpace_(c)) {\n    return this.nextToken();\n  } else if (c === '') {\n    token.type = TokenType.EOF;\n  } else {\n    throw new Error('Unexpected character: ' + c);\n  }\n\n  return token;\n};\n\n\n/**\n * @return {number} Numeric token value.\n * @private\n */\nLexer.prototype.readNumber_ = function() {\n  let c;\n  const index = this.index_;\n  let decimal = false;\n  let scientificNotation = false;\n  do {\n    if (c == '.') {\n      decimal = true;\n    } else if (c == 'e' || c == 'E') {\n      scientificNotation = true;\n    }\n    c = this.nextChar_();\n  } while (\n    this.isNumeric_(c, decimal) ||\n      // if we haven't detected a scientific number before, 'e' or 'E'\n      // hint that we should continue to read\n      !scientificNotation && (c == 'e' || c == 'E') ||\n      // once we know that we have a scientific number, both '-' and '+'\n      // are allowed\n      scientificNotation && (c == '-' || c == '+')\n  );\n  return parseFloat(this.wkt.substring(index, this.index_--));\n};\n\n\n/**\n * @return {string} String token value.\n * @private\n */\nLexer.prototype.readText_ = function() {\n  let c;\n  const index = this.index_;\n  do {\n    c = this.nextChar_();\n  } while (this.isAlpha_(c));\n  return this.wkt.substring(index, this.index_--).toUpperCase();\n};\n\n\n/**\n * Class to parse the tokens from the WKT string.\n * @param {module:ol/format/WKT~Lexer} lexer The lexer.\n * @constructor\n */\nconst Parser = function(lexer) {\n\n  /**\n   * @type {module:ol/format/WKT~Lexer}\n   * @private\n   */\n  this.lexer_ = lexer;\n\n  /**\n   * @type {module:ol/format/WKT~Token}\n   * @private\n   */\n  this.token_;\n\n  /**\n   * @type {module:ol/geom/GeometryLayout}\n   * @private\n   */\n  this.layout_ = GeometryLayout.XY;\n};\n\n\n/**\n * Fetch the next token form the lexer and replace the active token.\n * @private\n */\nParser.prototype.consume_ = function() {\n  this.token_ = this.lexer_.nextToken();\n};\n\n/**\n * Tests if the given type matches the type of the current token.\n * @param {module:ol/format/WKT~TokenType} type Token type.\n * @return {boolean} Whether the token matches the given type.\n */\nParser.prototype.isTokenType = function(type) {\n  const isMatch = this.token_.type == type;\n  return isMatch;\n};\n\n\n/**\n * If the given type matches the current token, consume it.\n * @param {module:ol/format/WKT~TokenType} type Token type.\n * @return {boolean} Whether the token matches the given type.\n */\nParser.prototype.match = function(type) {\n  const isMatch = this.isTokenType(type);\n  if (isMatch) {\n    this.consume_();\n  }\n  return isMatch;\n};\n\n\n/**\n * Try to parse the tokens provided by the lexer.\n * @return {module:ol/geom/Geometry} The geometry.\n */\nParser.prototype.parse = function() {\n  this.consume_();\n  const geometry = this.parseGeometry_();\n  return geometry;\n};\n\n\n/**\n * Try to parse the dimensional info.\n * @return {module:ol/geom/GeometryLayout} The layout.\n * @private\n */\nParser.prototype.parseGeometryLayout_ = function() {\n  let layout = GeometryLayout.XY;\n  const dimToken = this.token_;\n  if (this.isTokenType(TokenType.TEXT)) {\n    const dimInfo = dimToken.value;\n    if (dimInfo === Z) {\n      layout = GeometryLayout.XYZ;\n    } else if (dimInfo === M) {\n      layout = GeometryLayout.XYM;\n    } else if (dimInfo === ZM) {\n      layout = GeometryLayout.XYZM;\n    }\n    if (layout !== GeometryLayout.XY) {\n      this.consume_();\n    }\n  }\n  return layout;\n};\n\n\n/**\n * @return {!Array.<module:ol/geom/Geometry>} A collection of geometries.\n * @private\n */\nParser.prototype.parseGeometryCollectionText_ = function() {\n  if (this.match(TokenType.LEFT_PAREN)) {\n    const geometries = [];\n    do {\n      geometries.push(this.parseGeometry_());\n    } while (this.match(TokenType.COMMA));\n    if (this.match(TokenType.RIGHT_PAREN)) {\n      return geometries;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {Array.<number>} All values in a point.\n * @private\n */\nParser.prototype.parsePointText_ = function() {\n  if (this.match(TokenType.LEFT_PAREN)) {\n    const coordinates = this.parsePoint_();\n    if (this.match(TokenType.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return null;\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All points in a linestring.\n * @private\n */\nParser.prototype.parseLineStringText_ = function() {\n  if (this.match(TokenType.LEFT_PAREN)) {\n    const coordinates = this.parsePointList_();\n    if (this.match(TokenType.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All points in a polygon.\n * @private\n */\nParser.prototype.parsePolygonText_ = function() {\n  if (this.match(TokenType.LEFT_PAREN)) {\n    const coordinates = this.parseLineStringTextList_();\n    if (this.match(TokenType.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All points in a multipoint.\n * @private\n */\nParser.prototype.parseMultiPointText_ = function() {\n  if (this.match(TokenType.LEFT_PAREN)) {\n    let coordinates;\n    if (this.token_.type == TokenType.LEFT_PAREN) {\n      coordinates = this.parsePointTextList_();\n    } else {\n      coordinates = this.parsePointList_();\n    }\n    if (this.match(TokenType.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All linestring points\n *                                        in a multilinestring.\n * @private\n */\nParser.prototype.parseMultiLineStringText_ = function() {\n  if (this.match(TokenType.LEFT_PAREN)) {\n    const coordinates = this.parseLineStringTextList_();\n    if (this.match(TokenType.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} All polygon points in a multipolygon.\n * @private\n */\nParser.prototype.parseMultiPolygonText_ = function() {\n  if (this.match(TokenType.LEFT_PAREN)) {\n    const coordinates = this.parsePolygonTextList_();\n    if (this.match(TokenType.RIGHT_PAREN)) {\n      return coordinates;\n    }\n  } else if (this.isEmptyGeometry_()) {\n    return [];\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<number>} A point.\n * @private\n */\nParser.prototype.parsePoint_ = function() {\n  const coordinates = [];\n  const dimensions = this.layout_.length;\n  for (let i = 0; i < dimensions; ++i) {\n    const token = this.token_;\n    if (this.match(TokenType.NUMBER)) {\n      coordinates.push(token.value);\n    } else {\n      break;\n    }\n  }\n  if (coordinates.length == dimensions) {\n    return coordinates;\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\nParser.prototype.parsePointList_ = function() {\n  const coordinates = [this.parsePoint_()];\n  while (this.match(TokenType.COMMA)) {\n    coordinates.push(this.parsePoint_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\nParser.prototype.parsePointTextList_ = function() {\n  const coordinates = [this.parsePointText_()];\n  while (this.match(TokenType.COMMA)) {\n    coordinates.push(this.parsePointText_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\nParser.prototype.parseLineStringTextList_ = function() {\n  const coordinates = [this.parseLineStringText_()];\n  while (this.match(TokenType.COMMA)) {\n    coordinates.push(this.parseLineStringText_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {!Array.<!Array.<number>>} An array of points.\n * @private\n */\nParser.prototype.parsePolygonTextList_ = function() {\n  const coordinates = [this.parsePolygonText_()];\n  while (this.match(TokenType.COMMA)) {\n    coordinates.push(this.parsePolygonText_());\n  }\n  return coordinates;\n};\n\n\n/**\n * @return {boolean} Whether the token implies an empty geometry.\n * @private\n */\nParser.prototype.isEmptyGeometry_ = function() {\n  const isEmpty = this.isTokenType(TokenType.TEXT) &&\n      this.token_.value == EMPTY;\n  if (isEmpty) {\n    this.consume_();\n  }\n  return isEmpty;\n};\n\n\n/**\n * Create an error message for an unexpected token error.\n * @return {string} Error message.\n * @private\n */\nParser.prototype.formatErrorMessage_ = function() {\n  return 'Unexpected `' + this.token_.value + '` at position ' +\n      this.token_.position + ' in `' + this.lexer_.wkt + '`';\n};\n\n\n/**\n * @classdesc\n * Geometry format for reading and writing data in the `WellKnownText` (WKT)\n * format.\n *\n * @constructor\n * @extends {module:ol/format/TextFeature}\n * @param {module:ol/format/WKT~Options=} opt_options Options.\n * @api\n */\nconst WKT = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  TextFeature.call(this);\n\n  /**\n   * Split GeometryCollection into multiple features.\n   * @type {boolean}\n   * @private\n   */\n  this.splitCollection_ = options.splitCollection !== undefined ?\n    options.splitCollection : false;\n\n};\n\ninherits(WKT, TextFeature);\n\n\n/**\n * @param {module:ol/geom/Point} geom Point geometry.\n * @return {string} Coordinates part of Point as WKT.\n */\nfunction encodePointGeometry(geom) {\n  const coordinates = geom.getCoordinates();\n  if (coordinates.length === 0) {\n    return '';\n  }\n  return coordinates.join(' ');\n}\n\n\n/**\n * @param {module:ol/geom/MultiPoint} geom MultiPoint geometry.\n * @return {string} Coordinates part of MultiPoint as WKT.\n */\nfunction encodeMultiPointGeometry(geom) {\n  const array = [];\n  const components = geom.getPoints();\n  for (let i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + encodePointGeometry(components[i]) + ')');\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {module:ol/geom/GeometryCollection} geom GeometryCollection geometry.\n * @return {string} Coordinates part of GeometryCollection as WKT.\n */\nfunction encodeGeometryCollectionGeometry(geom) {\n  const array = [];\n  const geoms = geom.getGeometries();\n  for (let i = 0, ii = geoms.length; i < ii; ++i) {\n    array.push(encode(geoms[i]));\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {module:ol/geom/LineString|module:ol/geom/LinearRing} geom LineString geometry.\n * @return {string} Coordinates part of LineString as WKT.\n */\nfunction encodeLineStringGeometry(geom) {\n  const coordinates = geom.getCoordinates();\n  const array = [];\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    array.push(coordinates[i].join(' '));\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {module:ol/geom/MultiLineString} geom MultiLineString geometry.\n * @return {string} Coordinates part of MultiLineString as WKT.\n */\nfunction encodeMultiLineStringGeometry(geom) {\n  const array = [];\n  const components = geom.getLineStrings();\n  for (let i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + encodeLineStringGeometry(components[i]) + ')');\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {module:ol/geom/Polygon} geom Polygon geometry.\n * @return {string} Coordinates part of Polygon as WKT.\n */\nfunction encodePolygonGeometry(geom) {\n  const array = [];\n  const rings = geom.getLinearRings();\n  for (let i = 0, ii = rings.length; i < ii; ++i) {\n    array.push('(' + encodeLineStringGeometry(rings[i]) + ')');\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {module:ol/geom/MultiPolygon} geom MultiPolygon geometry.\n * @return {string} Coordinates part of MultiPolygon as WKT.\n */\nfunction encodeMultiPolygonGeometry(geom) {\n  const array = [];\n  const components = geom.getPolygons();\n  for (let i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + encodePolygonGeometry(components[i]) + ')');\n  }\n  return array.join(',');\n}\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geom SimpleGeometry geometry.\n * @return {string} Potential dimensional information for WKT type.\n */\nfunction encodeGeometryLayout(geom) {\n  const layout = geom.getLayout();\n  let dimInfo = '';\n  if (layout === GeometryLayout.XYZ || layout === GeometryLayout.XYZM) {\n    dimInfo += Z;\n  }\n  if (layout === GeometryLayout.XYM || layout === GeometryLayout.XYZM) {\n    dimInfo += M;\n  }\n  return dimInfo;\n}\n\n\n/**\n * @const\n * @type {Object.<string, function(module:ol/geom/Geometry): string>}\n */\nconst GeometryEncoder = {\n  'Point': encodePointGeometry,\n  'LineString': encodeLineStringGeometry,\n  'Polygon': encodePolygonGeometry,\n  'MultiPoint': encodeMultiPointGeometry,\n  'MultiLineString': encodeMultiLineStringGeometry,\n  'MultiPolygon': encodeMultiPolygonGeometry,\n  'GeometryCollection': encodeGeometryCollectionGeometry\n};\n\n\n/**\n * Encode a geometry as WKT.\n * @param {module:ol/geom/Geometry} geom The geometry to encode.\n * @return {string} WKT string for the geometry.\n */\nfunction encode(geom) {\n  let type = geom.getType();\n  const geometryEncoder = GeometryEncoder[type];\n  const enc = geometryEncoder(geom);\n  type = type.toUpperCase();\n  if (geom instanceof SimpleGeometry) {\n    const dimInfo = encodeGeometryLayout(geom);\n    if (dimInfo.length > 0) {\n      type += ' ' + dimInfo;\n    }\n  }\n  if (enc.length === 0) {\n    return type + ' ' + EMPTY;\n  }\n  return type + '(' + enc + ')';\n}\n\n\n/**\n * Parse a WKT string.\n * @param {string} wkt WKT string.\n * @return {module:ol/geom/Geometry|undefined}\n *     The geometry created.\n * @private\n */\nWKT.prototype.parse_ = function(wkt) {\n  const lexer = new Lexer(wkt);\n  const parser = new Parser(lexer);\n  return parser.parse();\n};\n\n\n/**\n * Read a feature from a WKT source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/Feature} Feature.\n * @api\n */\nWKT.prototype.readFeature;\n\n\n/**\n * @inheritDoc\n */\nWKT.prototype.readFeatureFromText = function(text, opt_options) {\n  const geom = this.readGeometryFromText(text, opt_options);\n  if (geom) {\n    const feature = new Feature();\n    feature.setGeometry(geom);\n    return feature;\n  }\n  return null;\n};\n\n\n/**\n * Read all features from a WKT source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nWKT.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nWKT.prototype.readFeaturesFromText = function(text, opt_options) {\n  let geometries = [];\n  const geometry = this.readGeometryFromText(text, opt_options);\n  if (this.splitCollection_ &&\n      geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    geometries = (/** @type {module:ol/geom/GeometryCollection} */ (geometry))\n      .getGeometriesArray();\n  } else {\n    geometries = [geometry];\n  }\n  const features = [];\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    const feature = new Feature();\n    feature.setGeometry(geometries[i]);\n    features.push(feature);\n  }\n  return features;\n};\n\n\n/**\n * Read a single geometry from a WKT source.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Read options.\n * @return {module:ol/geom/Geometry} Geometry.\n * @api\n */\nWKT.prototype.readGeometry;\n\n\n/**\n * @inheritDoc\n */\nWKT.prototype.readGeometryFromText = function(text, opt_options) {\n  const geometry = this.parse_(text);\n  if (geometry) {\n    return (\n      /** @type {module:ol/geom/Geometry} */ (transformWithOptions(geometry, false, opt_options))\n    );\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * @enum {function (new:module:ol/geom/Geometry, Array, module:ol/geom/GeometryLayout)}\n */\nconst GeometryConstructor = {\n  'POINT': Point,\n  'LINESTRING': LineString,\n  'POLYGON': Polygon,\n  'MULTIPOINT': MultiPoint,\n  'MULTILINESTRING': MultiLineString,\n  'MULTIPOLYGON': MultiPolygon\n};\n\n\n/**\n * @enum {(function(): Array)}\n */\nconst GeometryParser = {\n  'POINT': Parser.prototype.parsePointText_,\n  'LINESTRING': Parser.prototype.parseLineStringText_,\n  'POLYGON': Parser.prototype.parsePolygonText_,\n  'MULTIPOINT': Parser.prototype.parseMultiPointText_,\n  'MULTILINESTRING': Parser.prototype.parseMultiLineStringText_,\n  'MULTIPOLYGON': Parser.prototype.parseMultiPolygonText_\n};\n\n\n/**\n * @return {!module:ol/geom/Geometry} The geometry.\n * @private\n */\nParser.prototype.parseGeometry_ = function() {\n  const token = this.token_;\n  if (this.match(TokenType.TEXT)) {\n    const geomType = token.value;\n    this.layout_ = this.parseGeometryLayout_();\n    if (geomType == GeometryType.GEOMETRY_COLLECTION.toUpperCase()) {\n      const geometries = this.parseGeometryCollectionText_();\n      return new GeometryCollection(geometries);\n    } else {\n      const parser = GeometryParser[geomType];\n      const ctor = GeometryConstructor[geomType];\n      if (!parser || !ctor) {\n        throw new Error('Invalid geometry type: ' + geomType);\n      }\n      const coordinates = parser.call(this);\n      return new ctor(coordinates, this.layout_);\n    }\n  }\n  throw new Error(this.formatErrorMessage_());\n};\n\n\n/**\n * Encode a feature as a WKT string.\n *\n * @function\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} WKT string.\n * @api\n */\nWKT.prototype.writeFeature;\n\n\n/**\n * @inheritDoc\n */\nWKT.prototype.writeFeatureText = function(feature, opt_options) {\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    return this.writeGeometryText(geometry, opt_options);\n  }\n  return '';\n};\n\n\n/**\n * Encode an array of features as a WKT string.\n *\n * @function\n * @param {Array.<module:ol/Feature>} features Features.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} WKT string.\n * @api\n */\nWKT.prototype.writeFeatures;\n\n\n/**\n * @inheritDoc\n */\nWKT.prototype.writeFeaturesText = function(features, opt_options) {\n  if (features.length == 1) {\n    return this.writeFeatureText(features[0], opt_options);\n  }\n  const geometries = [];\n  for (let i = 0, ii = features.length; i < ii; ++i) {\n    geometries.push(features[i].getGeometry());\n  }\n  const collection = new GeometryCollection(geometries);\n  return this.writeGeometryText(collection, opt_options);\n};\n\n\n/**\n * Write a single geometry as a WKT string.\n *\n * @function\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/format/Feature~WriteOptions=} opt_options Write options.\n * @return {string} WKT string.\n * @api\n */\nWKT.prototype.writeGeometry;\n\n\n/**\n * @inheritDoc\n */\nWKT.prototype.writeGeometryText = function(geometry, opt_options) {\n  return encode(/** @type {module:ol/geom/Geometry} */ (\n    transformWithOptions(geometry, true, opt_options)));\n};\n\n\nexport default WKT;\n","/**\n * @module ol/format/XLink\n */\n\n\n/**\n * @const\n * @type {string}\n */\nconst NAMESPACE_URI = 'http://www.w3.org/1999/xlink';\n\n\n/**\n * @param {Node} node Node.\n * @return {boolean|undefined} Boolean.\n */\nexport function readHref(node) {\n  return node.getAttributeNS(NAMESPACE_URI, 'href');\n}\n","/**\n * @module ol/format/XML\n */\nimport {isDocument, isNode, parse} from '../xml.js';\n\n/**\n * @classdesc\n * Generic format for reading non-feature XML data\n *\n * @constructor\n * @abstract\n * @struct\n */\nconst XML = function() {\n};\n\n\n/**\n * @param {Document|Node|string} source Source.\n * @return {Object} The parsed result.\n */\nXML.prototype.read = function(source) {\n  if (isDocument(source)) {\n    return this.readFromDocument(/** @type {Document} */ (source));\n  } else if (isNode(source)) {\n    return this.readFromNode(/** @type {Node} */ (source));\n  } else if (typeof source === 'string') {\n    const doc = parse(source);\n    return this.readFromDocument(doc);\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * @abstract\n * @param {Document} doc Document.\n * @return {Object} Object\n */\nXML.prototype.readFromDocument = function(doc) {};\n\n\n/**\n * @abstract\n * @param {Node} node Node.\n * @return {Object} Object\n */\nXML.prototype.readFromNode = function(node) {};\nexport default XML;\n","/**\n * @module ol/format/WMSCapabilities\n */\nimport {inherits} from '../index.js';\nimport {readHref} from '../format/XLink.js';\nimport XML from '../format/XML.js';\nimport {readDecimalString, readString, readNonNegativeInteger, readDecimal, readBooleanString, readNonNegativeIntegerString} from '../format/xsd.js';\nimport {makeArrayPusher, makeObjectPropertyPusher, makeObjectPropertySetter,\n  makeStructureNS, pushParseAndPop} from '../xml.js';\n\n\n/**\n * @classdesc\n * Format for reading WMS capabilities data\n *\n * @constructor\n * @extends {module:ol/format/XML}\n * @api\n */\nconst WMSCapabilities = function() {\n\n  XML.call(this);\n\n  /**\n   * @type {string|undefined}\n   */\n  this.version = undefined;\n};\n\ninherits(WMSCapabilities, XML);\n\n\n/**\n * @const\n * @type {Array.<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://www.opengis.net/wms'\n];\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Service': makeObjectPropertySetter(readService),\n    'Capability': makeObjectPropertySetter(readCapability)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst CAPABILITY_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Request': makeObjectPropertySetter(readRequest),\n    'Exception': makeObjectPropertySetter(readException),\n    'Layer': makeObjectPropertySetter(readCapabilityLayer)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst SERVICE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Name': makeObjectPropertySetter(readString),\n    'Title': makeObjectPropertySetter(readString),\n    'Abstract': makeObjectPropertySetter(readString),\n    'KeywordList': makeObjectPropertySetter(readKeywordList),\n    'OnlineResource': makeObjectPropertySetter(readHref),\n    'ContactInformation': makeObjectPropertySetter(readContactInformation),\n    'Fees': makeObjectPropertySetter(readString),\n    'AccessConstraints': makeObjectPropertySetter(readString),\n    'LayerLimit': makeObjectPropertySetter(readNonNegativeInteger),\n    'MaxWidth': makeObjectPropertySetter(readNonNegativeInteger),\n    'MaxHeight': makeObjectPropertySetter(readNonNegativeInteger)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst CONTACT_INFORMATION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ContactPersonPrimary': makeObjectPropertySetter(readContactPersonPrimary),\n    'ContactPosition': makeObjectPropertySetter(readString),\n    'ContactAddress': makeObjectPropertySetter(readContactAddress),\n    'ContactVoiceTelephone': makeObjectPropertySetter(readString),\n    'ContactFacsimileTelephone': makeObjectPropertySetter(readString),\n    'ContactElectronicMailAddress': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst CONTACT_PERSON_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ContactPerson': makeObjectPropertySetter(readString),\n    'ContactOrganization': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst CONTACT_ADDRESS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'AddressType': makeObjectPropertySetter(readString),\n    'Address': makeObjectPropertySetter(readString),\n    'City': makeObjectPropertySetter(readString),\n    'StateOrProvince': makeObjectPropertySetter(readString),\n    'PostCode': makeObjectPropertySetter(readString),\n    'Country': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst EXCEPTION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Format': makeArrayPusher(readString)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LAYER_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Name': makeObjectPropertySetter(readString),\n    'Title': makeObjectPropertySetter(readString),\n    'Abstract': makeObjectPropertySetter(readString),\n    'KeywordList': makeObjectPropertySetter(readKeywordList),\n    'CRS': makeObjectPropertyPusher(readString),\n    'EX_GeographicBoundingBox': makeObjectPropertySetter(readEXGeographicBoundingBox),\n    'BoundingBox': makeObjectPropertyPusher(readBoundingBox),\n    'Dimension': makeObjectPropertyPusher(readDimension),\n    'Attribution': makeObjectPropertySetter(readAttribution),\n    'AuthorityURL': makeObjectPropertyPusher(readAuthorityURL),\n    'Identifier': makeObjectPropertyPusher(readString),\n    'MetadataURL': makeObjectPropertyPusher(readMetadataURL),\n    'DataURL': makeObjectPropertyPusher(readFormatOnlineresource),\n    'FeatureListURL': makeObjectPropertyPusher(readFormatOnlineresource),\n    'Style': makeObjectPropertyPusher(readStyle),\n    'MinScaleDenominator': makeObjectPropertySetter(readDecimal),\n    'MaxScaleDenominator': makeObjectPropertySetter(readDecimal),\n    'Layer': makeObjectPropertyPusher(readLayer)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst ATTRIBUTION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Title': makeObjectPropertySetter(readString),\n    'OnlineResource': makeObjectPropertySetter(readHref),\n    'LogoURL': makeObjectPropertySetter(readSizedFormatOnlineresource)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS =\n    makeStructureNS(NAMESPACE_URIS, {\n      'westBoundLongitude': makeObjectPropertySetter(readDecimal),\n      'eastBoundLongitude': makeObjectPropertySetter(readDecimal),\n      'southBoundLatitude': makeObjectPropertySetter(readDecimal),\n      'northBoundLatitude': makeObjectPropertySetter(readDecimal)\n    });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst REQUEST_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'GetCapabilities': makeObjectPropertySetter(readOperationType),\n    'GetMap': makeObjectPropertySetter(readOperationType),\n    'GetFeatureInfo': makeObjectPropertySetter(readOperationType)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst OPERATIONTYPE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Format': makeObjectPropertyPusher(readString),\n    'DCPType': makeObjectPropertyPusher(readDCPType)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst DCPTYPE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'HTTP': makeObjectPropertySetter(readHTTP)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst HTTP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Get': makeObjectPropertySetter(readFormatOnlineresource),\n    'Post': makeObjectPropertySetter(readFormatOnlineresource)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Name': makeObjectPropertySetter(readString),\n    'Title': makeObjectPropertySetter(readString),\n    'Abstract': makeObjectPropertySetter(readString),\n    'LegendURL': makeObjectPropertyPusher(readSizedFormatOnlineresource),\n    'StyleSheetURL': makeObjectPropertySetter(readFormatOnlineresource),\n    'StyleURL': makeObjectPropertySetter(readFormatOnlineresource)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst FORMAT_ONLINERESOURCE_PARSERS =\n    makeStructureNS(NAMESPACE_URIS, {\n      'Format': makeObjectPropertySetter(readString),\n      'OnlineResource': makeObjectPropertySetter(readHref)\n    });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst KEYWORDLIST_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Keyword': makeArrayPusher(readString)\n  });\n\n\n/**\n * Read a WMS capabilities document.\n *\n * @function\n * @param {Document|Node|string} source The XML source.\n * @return {Object} An object representing the WMS capabilities.\n * @api\n */\nWMSCapabilities.prototype.read;\n\n\n/**\n * @inheritDoc\n */\nWMSCapabilities.prototype.readFromDocument = function(doc) {\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      return this.readFromNode(n);\n    }\n  }\n  return null;\n};\n\n\n/**\n * @inheritDoc\n */\nWMSCapabilities.prototype.readFromNode = function(node) {\n  this.version = node.getAttribute('version').trim();\n  const wmsCapabilityObject = pushParseAndPop({\n    'version': this.version\n  }, PARSERS, node, []);\n  return wmsCapabilityObject ? wmsCapabilityObject : null;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Attribution object.\n */\nfunction readAttribution(node, objectStack) {\n  return pushParseAndPop({}, ATTRIBUTION_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object} Bounding box object.\n */\nfunction readBoundingBox(node, objectStack) {\n  const extent = [\n    readDecimalString(node.getAttribute('minx')),\n    readDecimalString(node.getAttribute('miny')),\n    readDecimalString(node.getAttribute('maxx')),\n    readDecimalString(node.getAttribute('maxy'))\n  ];\n\n  const resolutions = [\n    readDecimalString(node.getAttribute('resx')),\n    readDecimalString(node.getAttribute('resy'))\n  ];\n\n  return {\n    'crs': node.getAttribute('CRS'),\n    'extent': extent,\n    'res': resolutions\n  };\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {module:ol/extent~Extent|undefined} Bounding box object.\n */\nfunction readEXGeographicBoundingBox(node, objectStack) {\n  const geographicBoundingBox = pushParseAndPop(\n    {},\n    EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS,\n    node, objectStack);\n  if (!geographicBoundingBox) {\n    return undefined;\n  }\n  const westBoundLongitude = /** @type {number|undefined} */\n        (geographicBoundingBox['westBoundLongitude']);\n  const southBoundLatitude = /** @type {number|undefined} */\n        (geographicBoundingBox['southBoundLatitude']);\n  const eastBoundLongitude = /** @type {number|undefined} */\n        (geographicBoundingBox['eastBoundLongitude']);\n  const northBoundLatitude = /** @type {number|undefined} */\n        (geographicBoundingBox['northBoundLatitude']);\n  if (westBoundLongitude === undefined || southBoundLatitude === undefined ||\n        eastBoundLongitude === undefined || northBoundLatitude === undefined) {\n    return undefined;\n  }\n  return [\n    westBoundLongitude, southBoundLatitude,\n    eastBoundLongitude, northBoundLatitude\n  ];\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Capability object.\n */\nfunction readCapability(node, objectStack) {\n  return pushParseAndPop({}, CAPABILITY_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Service object.\n */\nfunction readService(node, objectStack) {\n  return pushParseAndPop({}, SERVICE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Contact information object.\n */\nfunction readContactInformation(node, objectStack) {\n  return pushParseAndPop({}, CONTACT_INFORMATION_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Contact person object.\n */\nfunction readContactPersonPrimary(node, objectStack) {\n  return pushParseAndPop({}, CONTACT_PERSON_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Contact address object.\n */\nfunction readContactAddress(node, objectStack) {\n  return pushParseAndPop({}, CONTACT_ADDRESS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<string>|undefined} Format array.\n */\nfunction readException(node, objectStack) {\n  return pushParseAndPop([], EXCEPTION_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Layer object.\n */\nfunction readCapabilityLayer(node, objectStack) {\n  return pushParseAndPop({}, LAYER_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Layer object.\n */\nfunction readLayer(node, objectStack) {\n  const parentLayerObject = /**  @type {!Object.<string,*>} */ (objectStack[objectStack.length - 1]);\n\n  const layerObject = pushParseAndPop({}, LAYER_PARSERS, node, objectStack);\n\n  if (!layerObject) {\n    return undefined;\n  }\n  let queryable = readBooleanString(node.getAttribute('queryable'));\n  if (queryable === undefined) {\n    queryable = parentLayerObject['queryable'];\n  }\n  layerObject['queryable'] = queryable !== undefined ? queryable : false;\n\n  let cascaded = readNonNegativeIntegerString(\n    node.getAttribute('cascaded'));\n  if (cascaded === undefined) {\n    cascaded = parentLayerObject['cascaded'];\n  }\n  layerObject['cascaded'] = cascaded;\n\n  let opaque = readBooleanString(node.getAttribute('opaque'));\n  if (opaque === undefined) {\n    opaque = parentLayerObject['opaque'];\n  }\n  layerObject['opaque'] = opaque !== undefined ? opaque : false;\n\n  let noSubsets = readBooleanString(node.getAttribute('noSubsets'));\n  if (noSubsets === undefined) {\n    noSubsets = parentLayerObject['noSubsets'];\n  }\n  layerObject['noSubsets'] = noSubsets !== undefined ? noSubsets : false;\n\n  let fixedWidth = readDecimalString(node.getAttribute('fixedWidth'));\n  if (!fixedWidth) {\n    fixedWidth = parentLayerObject['fixedWidth'];\n  }\n  layerObject['fixedWidth'] = fixedWidth;\n\n  let fixedHeight = readDecimalString(node.getAttribute('fixedHeight'));\n  if (!fixedHeight) {\n    fixedHeight = parentLayerObject['fixedHeight'];\n  }\n  layerObject['fixedHeight'] = fixedHeight;\n\n  // See 7.2.4.8\n  const addKeys = ['Style', 'CRS', 'AuthorityURL'];\n  addKeys.forEach(function(key) {\n    if (key in parentLayerObject) {\n      const childValue = layerObject[key] || [];\n      layerObject[key] = childValue.concat(parentLayerObject[key]);\n    }\n  });\n\n  const replaceKeys = ['EX_GeographicBoundingBox', 'BoundingBox', 'Dimension',\n    'Attribution', 'MinScaleDenominator', 'MaxScaleDenominator'];\n  replaceKeys.forEach(function(key) {\n    if (!(key in layerObject)) {\n      const parentValue = parentLayerObject[key];\n      layerObject[key] = parentValue;\n    }\n  });\n\n  return layerObject;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object} Dimension object.\n */\nfunction readDimension(node, objectStack) {\n  const dimensionObject = {\n    'name': node.getAttribute('name'),\n    'units': node.getAttribute('units'),\n    'unitSymbol': node.getAttribute('unitSymbol'),\n    'default': node.getAttribute('default'),\n    'multipleValues': readBooleanString(node.getAttribute('multipleValues')),\n    'nearestValue': readBooleanString(node.getAttribute('nearestValue')),\n    'current': readBooleanString(node.getAttribute('current')),\n    'values': readString(node)\n  };\n  return dimensionObject;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Online resource object.\n */\nfunction readFormatOnlineresource(node, objectStack) {\n  return pushParseAndPop({}, FORMAT_ONLINERESOURCE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Request object.\n */\nfunction readRequest(node, objectStack) {\n  return pushParseAndPop({}, REQUEST_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} DCP type object.\n */\nfunction readDCPType(node, objectStack) {\n  return pushParseAndPop({}, DCPTYPE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} HTTP object.\n */\nfunction readHTTP(node, objectStack) {\n  return pushParseAndPop({}, HTTP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Operation type object.\n */\nfunction readOperationType(node, objectStack) {\n  return pushParseAndPop({}, OPERATIONTYPE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Online resource object.\n */\nfunction readSizedFormatOnlineresource(node, objectStack) {\n  const formatOnlineresource = readFormatOnlineresource(node, objectStack);\n  if (formatOnlineresource) {\n    const size = [\n      readNonNegativeIntegerString(node.getAttribute('width')),\n      readNonNegativeIntegerString(node.getAttribute('height'))\n    ];\n    formatOnlineresource['size'] = size;\n    return formatOnlineresource;\n  }\n  return undefined;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Authority URL object.\n */\nfunction readAuthorityURL(node, objectStack) {\n  const authorityObject = readFormatOnlineresource(node, objectStack);\n  if (authorityObject) {\n    authorityObject['name'] = node.getAttribute('name');\n    return authorityObject;\n  }\n  return undefined;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Metadata URL object.\n */\nfunction readMetadataURL(node, objectStack) {\n  const metadataObject = readFormatOnlineresource(node, objectStack);\n  if (metadataObject) {\n    metadataObject['type'] = node.getAttribute('type');\n    return metadataObject;\n  }\n  return undefined;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Style object.\n */\nfunction readStyle(node, objectStack) {\n  return pushParseAndPop({}, STYLE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<string>|undefined} Keyword list.\n */\nfunction readKeywordList(node, objectStack) {\n  return pushParseAndPop([], KEYWORDLIST_PARSERS, node, objectStack);\n}\n\n\nexport default WMSCapabilities;\n","/**\n * @module ol/format/WMSGetFeatureInfo\n */\nimport {inherits} from '../index.js';\nimport {extend, includes} from '../array.js';\nimport GML2 from '../format/GML2.js';\nimport XMLFeature from '../format/XMLFeature.js';\nimport {assign} from '../obj.js';\nimport {makeArrayPusher, makeStructureNS, pushParseAndPop} from '../xml.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array.<string>} [layers] If set, only features of the given layers will be returned by the format when read.\n */\n\n\n/**\n * @classdesc\n * Format for reading WMSGetFeatureInfo format. It uses\n * {@link module:ol/format/GML2~GML2} to read features.\n *\n * @constructor\n * @extends {module:ol/format/XMLFeature}\n * @param {module:ol/format/WMSGetFeatureInfo~Options=} opt_options Options.\n * @api\n */\nconst WMSGetFeatureInfo = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.featureNS_ = 'http://mapserver.gis.umn.edu/mapserver';\n\n\n  /**\n   * @private\n   * @type {module:ol/format/GML2}\n   */\n  this.gmlFormat_ = new GML2();\n\n\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.layers_ = options.layers ? options.layers : null;\n\n  XMLFeature.call(this);\n};\n\ninherits(WMSGetFeatureInfo, XMLFeature);\n\n\n/**\n * @const\n * @type {string}\n */\nconst featureIdentifier = '_feature';\n\n\n/**\n * @const\n * @type {string}\n */\nconst layerIdentifier = '_layer';\n\n\n/**\n * @return {Array.<string>} layers\n */\nWMSGetFeatureInfo.prototype.getLayers = function() {\n  return this.layers_;\n};\n\n\n/**\n * @param {Array.<string>} layers Layers to parse.\n */\nWMSGetFeatureInfo.prototype.setLayers = function(layers) {\n  this.layers_ = layers;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Array.<module:ol/Feature>} Features.\n * @private\n */\nWMSGetFeatureInfo.prototype.readFeatures_ = function(node, objectStack) {\n  node.setAttribute('namespaceURI', this.featureNS_);\n  const localName = node.localName;\n  /** @type {Array.<module:ol/Feature>} */\n  let features = [];\n  if (node.childNodes.length === 0) {\n    return features;\n  }\n  if (localName == 'msGMLOutput') {\n    for (let i = 0, ii = node.childNodes.length; i < ii; i++) {\n      const layer = node.childNodes[i];\n      if (layer.nodeType !== Node.ELEMENT_NODE) {\n        continue;\n      }\n      const context = objectStack[0];\n\n      const toRemove = layerIdentifier;\n      const layerName = layer.localName.replace(toRemove, '');\n\n      if (this.layers_ && !includes(this.layers_, layerName)) {\n        continue;\n      }\n\n      const featureType = layerName +\n          featureIdentifier;\n\n      context['featureType'] = featureType;\n      context['featureNS'] = this.featureNS_;\n\n      const parsers = {};\n      parsers[featureType] = makeArrayPusher(\n        this.gmlFormat_.readFeatureElement, this.gmlFormat_);\n      const parsersNS = makeStructureNS(\n        [context['featureNS'], null], parsers);\n      layer.setAttribute('namespaceURI', this.featureNS_);\n      const layerFeatures = pushParseAndPop(\n        [], parsersNS, layer, objectStack, this.gmlFormat_);\n      if (layerFeatures) {\n        extend(features, layerFeatures);\n      }\n    }\n  }\n  if (localName == 'FeatureCollection') {\n    const gmlFeatures = pushParseAndPop([],\n      this.gmlFormat_.FEATURE_COLLECTION_PARSERS, node,\n      [{}], this.gmlFormat_);\n    if (gmlFeatures) {\n      features = gmlFeatures;\n    }\n  }\n  return features;\n};\n\n\n/**\n * Read all features from a WMSGetFeatureInfo response.\n *\n * @function\n * @param {Document|Node|Object|string} source Source.\n * @param {module:ol/format/Feature~ReadOptions=} opt_options Options.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nWMSGetFeatureInfo.prototype.readFeatures;\n\n\n/**\n * @inheritDoc\n */\nWMSGetFeatureInfo.prototype.readFeaturesFromNode = function(node, opt_options) {\n  const options = {};\n  if (opt_options) {\n    assign(options, this.getReadOptions(node, opt_options));\n  }\n  return this.readFeatures_(node, [options]);\n};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nWMSGetFeatureInfo.prototype.writeFeatureNode = function(feature, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nWMSGetFeatureInfo.prototype.writeFeaturesNode = function(features, opt_options) {};\n\n\n/**\n * Not implemented.\n * @inheritDoc\n */\nWMSGetFeatureInfo.prototype.writeGeometryNode = function(geometry, opt_options) {};\nexport default WMSGetFeatureInfo;\n","/**\n * @module ol/format/OWS\n */\nimport {inherits} from '../index.js';\nimport {readHref} from '../format/XLink.js';\nimport XML from '../format/XML.js';\nimport {readString} from '../format/xsd.js';\nimport {makeObjectPropertyPusher, makeObjectPropertySetter, makeStructureNS, pushParseAndPop} from '../xml.js';\n\n/**\n * @constructor\n * @extends {module:ol/format/XML}\n */\nconst OWS = function() {\n  XML.call(this);\n};\n\ninherits(OWS, XML);\n\n\n/**\n * @const\n * @type {Array.<null|string>}\n */\nconst NAMESPACE_URIS = [null, 'http://www.opengis.net/ows/1.1'];\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ServiceIdentification': makeObjectPropertySetter(readServiceIdentification),\n    'ServiceProvider': makeObjectPropertySetter(readServiceProvider),\n    'OperationsMetadata': makeObjectPropertySetter(readOperationsMetadata)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst ADDRESS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'DeliveryPoint': makeObjectPropertySetter(readString),\n    'City': makeObjectPropertySetter(readString),\n    'AdministrativeArea': makeObjectPropertySetter(readString),\n    'PostalCode': makeObjectPropertySetter(readString),\n    'Country': makeObjectPropertySetter(readString),\n    'ElectronicMailAddress': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst ALLOWED_VALUES_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Value': makeObjectPropertyPusher(readValue)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst CONSTRAINT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'AllowedValues': makeObjectPropertySetter(readAllowedValues)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst CONTACT_INFO_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Phone': makeObjectPropertySetter(readPhone),\n    'Address': makeObjectPropertySetter(readAddress)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst DCP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'HTTP': makeObjectPropertySetter(readHttp)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst HTTP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Get': makeObjectPropertyPusher(readGet),\n    'Post': undefined // TODO\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst OPERATION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'DCP': makeObjectPropertySetter(readDcp)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst OPERATIONS_METADATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Operation': readOperation\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst PHONE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Voice': makeObjectPropertySetter(readString),\n    'Facsimile': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst REQUEST_METHOD_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Constraint': makeObjectPropertyPusher(readConstraint)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst SERVICE_CONTACT_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'IndividualName': makeObjectPropertySetter(readString),\n        'PositionName': makeObjectPropertySetter(readString),\n        'ContactInfo': makeObjectPropertySetter(readContactInfo)\n      });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst SERVICE_IDENTIFICATION_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'Abstract': makeObjectPropertySetter(readString),\n        'AccessConstraints': makeObjectPropertySetter(readString),\n        'Fees': makeObjectPropertySetter(readString),\n        'Title': makeObjectPropertySetter(readString),\n        'ServiceTypeVersion': makeObjectPropertySetter(readString),\n        'ServiceType': makeObjectPropertySetter(readString)\n      });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst SERVICE_PROVIDER_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'ProviderName': makeObjectPropertySetter(readString),\n        'ProviderSite': makeObjectPropertySetter(readHref),\n        'ServiceContact': makeObjectPropertySetter(readServiceContact)\n      });\n\n\n/**\n * @inheritDoc\n */\nOWS.prototype.readFromDocument = function(doc) {\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      return this.readFromNode(n);\n    }\n  }\n  return null;\n};\n\n\n/**\n * @inheritDoc\n */\nOWS.prototype.readFromNode = function(node) {\n  const owsObject = pushParseAndPop({},\n    PARSERS, node, []);\n  return owsObject ? owsObject : null;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The address.\n */\nfunction readAddress(node, objectStack) {\n  return pushParseAndPop({},\n    ADDRESS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The values.\n */\nfunction readAllowedValues(node, objectStack) {\n  return pushParseAndPop({},\n    ALLOWED_VALUES_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The constraint.\n */\nfunction readConstraint(node, objectStack) {\n  const name = node.getAttribute('name');\n  if (!name) {\n    return undefined;\n  }\n  return pushParseAndPop({'name': name},\n    CONSTRAINT_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The contact info.\n */\nfunction readContactInfo(node, objectStack) {\n  return pushParseAndPop({},\n    CONTACT_INFO_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The DCP.\n */\nfunction readDcp(node, objectStack) {\n  return pushParseAndPop({},\n    DCP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The GET object.\n */\nfunction readGet(node, objectStack) {\n  const href = readHref(node);\n  if (!href) {\n    return undefined;\n  }\n  return pushParseAndPop({'href': href},\n    REQUEST_METHOD_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The HTTP object.\n */\nfunction readHttp(node, objectStack) {\n  return pushParseAndPop({}, HTTP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The operation.\n */\nfunction readOperation(node, objectStack) {\n  const name = node.getAttribute('name');\n  const value = pushParseAndPop({},\n    OPERATION_PARSERS, node, objectStack);\n  if (!value) {\n    return undefined;\n  }\n  const object = /** @type {Object} */\n      (objectStack[objectStack.length - 1]);\n  object[name] = value;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The operations metadata.\n */\nfunction readOperationsMetadata(node, objectStack) {\n  return pushParseAndPop({},\n    OPERATIONS_METADATA_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The phone.\n */\nfunction readPhone(node, objectStack) {\n  return pushParseAndPop({},\n    PHONE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The service identification.\n */\nfunction readServiceIdentification(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_IDENTIFICATION_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The service contact.\n */\nfunction readServiceContact(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_CONTACT_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} The service provider.\n */\nfunction readServiceProvider(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_PROVIDER_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {string|undefined} The value.\n */\nfunction readValue(node, objectStack) {\n  return readString(node);\n}\n\n\nexport default OWS;\n","/**\n * @module ol/format/WMTSCapabilities\n */\nimport {inherits} from '../index.js';\nimport {boundingExtent} from '../extent.js';\nimport OWS from '../format/OWS.js';\nimport {readHref} from '../format/XLink.js';\nimport XML from '../format/XML.js';\nimport {readString, readNonNegativeInteger, readDecimal} from '../format/xsd.js';\nimport {pushParseAndPop, makeStructureNS,\n  makeObjectPropertySetter, makeObjectPropertyPusher, makeArrayPusher} from '../xml.js';\n\n/**\n * @classdesc\n * Format for reading WMTS capabilities data.\n *\n * @constructor\n * @extends {module:ol/format/XML}\n * @api\n */\nconst WMTSCapabilities = function() {\n  XML.call(this);\n\n  /**\n   * @type {module:ol/format/OWS}\n   * @private\n   */\n  this.owsParser_ = new OWS();\n};\n\ninherits(WMTSCapabilities, XML);\n\n\n/**\n * @const\n * @type {Array.<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://www.opengis.net/wmts/1.0'\n];\n\n\n/**\n * @const\n * @type {Array.<null|string>}\n */\nconst OWS_NAMESPACE_URIS = [\n  null,\n  'http://www.opengis.net/ows/1.1'\n];\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Contents': makeObjectPropertySetter(readContents)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst CONTENTS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Layer': makeObjectPropertyPusher(readLayer),\n    'TileMatrixSet': makeObjectPropertyPusher(readTileMatrixSet)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst LAYER_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Style': makeObjectPropertyPusher(readStyle),\n    'Format': makeObjectPropertyPusher(readString),\n    'TileMatrixSetLink': makeObjectPropertyPusher(readTileMatrixSetLink),\n    'Dimension': makeObjectPropertyPusher(readDimensions),\n    'ResourceURL': makeObjectPropertyPusher(readResourceUrl)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Title': makeObjectPropertySetter(readString),\n    'Abstract': makeObjectPropertySetter(readString),\n    'WGS84BoundingBox': makeObjectPropertySetter(readWgs84BoundingBox),\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LegendURL': makeObjectPropertyPusher(readLegendUrl)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Title': makeObjectPropertySetter(readString),\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TMS_LINKS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TileMatrixSet': makeObjectPropertySetter(readString),\n    'TileMatrixSetLimits': makeObjectPropertySetter(readTileMatrixLimitsList)\n  });\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TMS_LIMITS_LIST_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TileMatrixLimits': makeArrayPusher(readTileMatrixLimits)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TMS_LIMITS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TileMatrix': makeObjectPropertySetter(readString),\n    'MinTileRow': makeObjectPropertySetter(readNonNegativeInteger),\n    'MaxTileRow': makeObjectPropertySetter(readNonNegativeInteger),\n    'MinTileCol': makeObjectPropertySetter(readNonNegativeInteger),\n    'MaxTileCol': makeObjectPropertySetter(readNonNegativeInteger)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst DIMENSION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Default': makeObjectPropertySetter(readString),\n    'Value': makeObjectPropertyPusher(readString)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst WGS84_BBOX_READERS = makeStructureNS(\n  OWS_NAMESPACE_URIS, {\n    'LowerCorner': makeArrayPusher(readCoordinates),\n    'UpperCorner': makeArrayPusher(readCoordinates)\n  });\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TMS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'WellKnownScaleSet': makeObjectPropertySetter(readString),\n    'TileMatrix': makeObjectPropertyPusher(readTileMatrix)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'SupportedCRS': makeObjectPropertySetter(readString),\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object.<string, Object.<string, module:ol/xml~Parser>>}\n */\nconst TM_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TopLeftCorner': makeObjectPropertySetter(readCoordinates),\n    'ScaleDenominator': makeObjectPropertySetter(readDecimal),\n    'TileWidth': makeObjectPropertySetter(readNonNegativeInteger),\n    'TileHeight': makeObjectPropertySetter(readNonNegativeInteger),\n    'MatrixWidth': makeObjectPropertySetter(readNonNegativeInteger),\n    'MatrixHeight': makeObjectPropertySetter(readNonNegativeInteger)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * Read a WMTS capabilities document.\n *\n * @function\n * @param {Document|Node|string} source The XML source.\n * @return {Object} An object representing the WMTS capabilities.\n * @api\n */\nWMTSCapabilities.prototype.read;\n\n\n/**\n * @inheritDoc\n */\nWMTSCapabilities.prototype.readFromDocument = function(doc) {\n  for (let n = doc.firstChild; n; n = n.nextSibling) {\n    if (n.nodeType == Node.ELEMENT_NODE) {\n      return this.readFromNode(n);\n    }\n  }\n  return null;\n};\n\n\n/**\n * @inheritDoc\n */\nWMTSCapabilities.prototype.readFromNode = function(node) {\n  const version = node.getAttribute('version').trim();\n  let WMTSCapabilityObject = this.owsParser_.readFromNode(node);\n  if (!WMTSCapabilityObject) {\n    return null;\n  }\n  WMTSCapabilityObject['version'] = version;\n  WMTSCapabilityObject = pushParseAndPop(WMTSCapabilityObject, PARSERS, node, []);\n  return WMTSCapabilityObject ? WMTSCapabilityObject : null;\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Attribution object.\n */\nfunction readContents(node, objectStack) {\n  return pushParseAndPop({}, CONTENTS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Layers object.\n */\nfunction readLayer(node, objectStack) {\n  return pushParseAndPop({}, LAYER_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Tile Matrix Set object.\n */\nfunction readTileMatrixSet(node, objectStack) {\n  return pushParseAndPop({}, TMS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Style object.\n */\nfunction readStyle(node, objectStack) {\n  const style = pushParseAndPop({}, STYLE_PARSERS, node, objectStack);\n  if (!style) {\n    return undefined;\n  }\n  const isDefault = node.getAttribute('isDefault') === 'true';\n  style['isDefault'] = isDefault;\n  return style;\n\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Tile Matrix Set Link object.\n */\nfunction readTileMatrixSetLink(node, objectStack) {\n  return pushParseAndPop({}, TMS_LINKS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Dimension object.\n */\nfunction readDimensions(node, objectStack) {\n  return pushParseAndPop({}, DIMENSION_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Resource URL object.\n */\nfunction readResourceUrl(node, objectStack) {\n  const format = node.getAttribute('format');\n  const template = node.getAttribute('template');\n  const resourceType = node.getAttribute('resourceType');\n  const resource = {};\n  if (format) {\n    resource['format'] = format;\n  }\n  if (template) {\n    resource['template'] = template;\n  }\n  if (resourceType) {\n    resource['resourceType'] = resourceType;\n  }\n  return resource;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} WGS84 BBox object.\n */\nfunction readWgs84BoundingBox(node, objectStack) {\n  const coordinates = pushParseAndPop([], WGS84_BBOX_READERS, node, objectStack);\n  if (coordinates.length != 2) {\n    return undefined;\n  }\n  return boundingExtent(coordinates);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Legend object.\n */\nfunction readLegendUrl(node, objectStack) {\n  const legend = {};\n  legend['format'] = node.getAttribute('format');\n  legend['href'] = readHref(node);\n  return legend;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} Coordinates object.\n */\nfunction readCoordinates(node, objectStack) {\n  const coordinates = readString(node).split(' ');\n  if (!coordinates || coordinates.length != 2) {\n    return undefined;\n  }\n  const x = +coordinates[0];\n  const y = +coordinates[1];\n  if (isNaN(x) || isNaN(y)) {\n    return undefined;\n  }\n  return [x, y];\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrix object.\n */\nfunction readTileMatrix(node, objectStack) {\n  return pushParseAndPop({}, TM_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrixSetLimits Object.\n */\nfunction readTileMatrixLimitsList(node, objectStack) {\n  return pushParseAndPop([], TMS_LIMITS_LIST_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array.<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrixLimits Array.\n */\nfunction readTileMatrixLimits(node, objectStack) {\n  return pushParseAndPop({}, TMS_LIMITS_PARSERS, node, objectStack);\n}\n\n\nexport default WMTSCapabilities;\n","/**\n * @module ol/layer/Heatmap\n */\nimport {listen} from '../events.js';\nimport {inherits} from '../index.js';\nimport {getChangeEventType} from '../Object.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport VectorLayer from '../layer/Vector.js';\nimport {clamp} from '../math.js';\nimport {assign} from '../obj.js';\nimport RenderEventType from '../render/EventType.js';\nimport Icon from '../style/Icon.js';\nimport Style from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {Array.<string>} [gradient=['#00f', '#0ff', '#0f0', '#ff0', '#f00']] The color gradient\n * of the heatmap, specified as an array of CSS color strings.\n * @property {number} [radius=8] Radius size in pixels.\n * @property {number} [blur=15] Blur size in pixels.\n * @property {number} [shadow=250] Shadow size in pixels.\n * @property {string|function(module:ol/Feature):number} [weight='weight'] The feature\n * attribute to use for the weight or a function that returns a weight from a feature. Weight values\n * should range from 0 to 1 (and values outside will be clamped to that range).\n * @property {module:ol/source/Vector} [source] Source.\n */\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  BLUR: 'blur',\n  GRADIENT: 'gradient',\n  RADIUS: 'radius'\n};\n\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst DEFAULT_GRADIENT = ['#00f', '#0ff', '#0f0', '#ff0', '#f00'];\n\n\n/**\n * @classdesc\n * Layer for rendering vector data as a heatmap.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Vector}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Heatmap~Options=} opt_options Options.\n * @api\n */\nconst Heatmap = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  const baseOptions = assign({}, options);\n\n  delete baseOptions.gradient;\n  delete baseOptions.radius;\n  delete baseOptions.blur;\n  delete baseOptions.shadow;\n  delete baseOptions.weight;\n  VectorLayer.call(this, /** @type {module:ol/layer/Vector~Options} */ (baseOptions));\n\n  /**\n   * @private\n   * @type {Uint8ClampedArray}\n   */\n  this.gradient_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.shadow_ = options.shadow !== undefined ? options.shadow : 250;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.circleImage_ = undefined;\n\n  /**\n   * @private\n   * @type {Array.<Array.<module:ol/style/Style>>}\n   */\n  this.styleCache_ = null;\n\n  listen(this,\n    getChangeEventType(Property.GRADIENT),\n    this.handleGradientChanged_, this);\n\n  this.setGradient(options.gradient ? options.gradient : DEFAULT_GRADIENT);\n\n  this.setBlur(options.blur !== undefined ? options.blur : 15);\n\n  this.setRadius(options.radius !== undefined ? options.radius : 8);\n\n  listen(this,\n    getChangeEventType(Property.BLUR),\n    this.handleStyleChanged_, this);\n  listen(this,\n    getChangeEventType(Property.RADIUS),\n    this.handleStyleChanged_, this);\n\n  this.handleStyleChanged_();\n\n  const weight = options.weight ? options.weight : 'weight';\n  let weightFunction;\n  if (typeof weight === 'string') {\n    weightFunction = function(feature) {\n      return feature.get(weight);\n    };\n  } else {\n    weightFunction = weight;\n  }\n\n  this.setStyle(function(feature, resolution) {\n    const weight = weightFunction(feature);\n    const opacity = weight !== undefined ? clamp(weight, 0, 1) : 1;\n    // cast to 8 bits\n    const index = (255 * opacity) | 0;\n    let style = this.styleCache_[index];\n    if (!style) {\n      style = [\n        new Style({\n          image: new Icon({\n            opacity: opacity,\n            src: this.circleImage_\n          })\n        })\n      ];\n      this.styleCache_[index] = style;\n    }\n    return style;\n  }.bind(this));\n\n  // For performance reasons, don't sort the features before rendering.\n  // The render order is not relevant for a heatmap representation.\n  this.setRenderOrder(null);\n\n  listen(this, RenderEventType.RENDER, this.handleRender_, this);\n};\n\ninherits(Heatmap, VectorLayer);\n\n\n/**\n * @param {Array.<string>} colors A list of colored.\n * @return {Uint8ClampedArray} An array.\n * @private\n */\nconst createGradient = function(colors) {\n  const width = 1;\n  const height = 256;\n  const context = createCanvasContext2D(width, height);\n\n  const gradient = context.createLinearGradient(0, 0, width, height);\n  const step = 1 / (colors.length - 1);\n  for (let i = 0, ii = colors.length; i < ii; ++i) {\n    gradient.addColorStop(i * step, colors[i]);\n  }\n\n  context.fillStyle = gradient;\n  context.fillRect(0, 0, width, height);\n\n  return context.getImageData(0, 0, width, height).data;\n};\n\n\n/**\n * @return {string} Data URL for a circle.\n * @private\n */\nHeatmap.prototype.createCircle_ = function() {\n  const radius = this.getRadius();\n  const blur = this.getBlur();\n  const halfSize = radius + blur + 1;\n  const size = 2 * halfSize;\n  const context = createCanvasContext2D(size, size);\n  context.shadowOffsetX = context.shadowOffsetY = this.shadow_;\n  context.shadowBlur = blur;\n  context.shadowColor = '#000';\n  context.beginPath();\n  const center = halfSize - this.shadow_;\n  context.arc(center, center, radius, 0, Math.PI * 2, true);\n  context.fill();\n  return context.canvas.toDataURL();\n};\n\n\n/**\n * Return the blur size in pixels.\n * @return {number} Blur size in pixels.\n * @api\n * @observable\n */\nHeatmap.prototype.getBlur = function() {\n  return /** @type {number} */ (this.get(Property.BLUR));\n};\n\n\n/**\n * Return the gradient colors as array of strings.\n * @return {Array.<string>} Colors.\n * @api\n * @observable\n */\nHeatmap.prototype.getGradient = function() {\n  return /** @type {Array.<string>} */ (this.get(Property.GRADIENT));\n};\n\n\n/**\n * Return the size of the radius in pixels.\n * @return {number} Radius size in pixel.\n * @api\n * @observable\n */\nHeatmap.prototype.getRadius = function() {\n  return /** @type {number} */ (this.get(Property.RADIUS));\n};\n\n\n/**\n * @private\n */\nHeatmap.prototype.handleGradientChanged_ = function() {\n  this.gradient_ = createGradient(this.getGradient());\n};\n\n\n/**\n * @private\n */\nHeatmap.prototype.handleStyleChanged_ = function() {\n  this.circleImage_ = this.createCircle_();\n  this.styleCache_ = new Array(256);\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/render/Event} event Post compose event\n * @private\n */\nHeatmap.prototype.handleRender_ = function(event) {\n  const context = event.context;\n  const canvas = context.canvas;\n  const image = context.getImageData(0, 0, canvas.width, canvas.height);\n  const view8 = image.data;\n  for (let i = 0, ii = view8.length; i < ii; i += 4) {\n    const alpha = view8[i + 3] * 4;\n    if (alpha) {\n      view8[i] = this.gradient_[alpha];\n      view8[i + 1] = this.gradient_[alpha + 1];\n      view8[i + 2] = this.gradient_[alpha + 2];\n    }\n  }\n  context.putImageData(image, 0, 0);\n};\n\n\n/**\n * Set the blur size in pixels.\n * @param {number} blur Blur size in pixels.\n * @api\n * @observable\n */\nHeatmap.prototype.setBlur = function(blur) {\n  this.set(Property.BLUR, blur);\n};\n\n\n/**\n * Set the gradient colors as array of strings.\n * @param {Array.<string>} colors Gradient.\n * @api\n * @observable\n */\nHeatmap.prototype.setGradient = function(colors) {\n  this.set(Property.GRADIENT, colors);\n};\n\n\n/**\n * Set the size of the radius in pixels.\n * @param {number} radius Radius size in pixel.\n * @api\n * @observable\n */\nHeatmap.prototype.setRadius = function(radius) {\n  this.set(Property.RADIUS, radius);\n};\n\nexport default Heatmap;\n","/**\n * @module ol/layer/Image\n */\nimport {inherits} from '../index.js';\nimport LayerType from '../LayerType.js';\nimport Layer from '../layer/Layer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/PluggableMap} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {module:ol/source/Image} [source] Source for this layer.\n */\n\n\n/**\n * @classdesc\n * Server-rendered images that are available for arbitrary extents and\n * resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Layer}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Image~Options=} opt_options Layer options.\n * @api\n */\nconst ImageLayer = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n  Layer.call(this,  /** @type {module:ol/layer/Layer~Options} */ (options));\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {module:ol/LayerType}\n   */\n  this.type = LayerType.IMAGE;\n\n};\n\ninherits(ImageLayer, Layer);\n\n\n/**\n * Return the associated {@link module:ol/source/Image source} of the image layer.\n * @function\n * @return {module:ol/source/Image} Source.\n * @api\n */\nImageLayer.prototype.getSource;\nexport default ImageLayer;\n","/**\n * @module ol/layer/TileProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  PRELOAD: 'preload',\n  USE_INTERIM_TILES_ON_ERROR: 'useInterimTilesOnError'\n};\n","/**\n * @module ol/layer/Tile\n */\nimport {inherits} from '../index.js';\nimport LayerType from '../LayerType.js';\nimport Layer from '../layer/Layer.js';\nimport TileProperty from '../layer/TileProperty.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [preload=0] Preload. Load low-resolution tiles up to `preload` levels. `0`\n * means no preloading.\n * @property {module:ol/source/Tile} [source] Source for this layer.\n * @property {module:ol/PluggableMap} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [useInterimTilesOnError=true] Use interim tiles on error.\n */\n\n\n/**\n * @classdesc\n * For layer sources that provide pre-rendered, tiled images in grids that are\n * organized by zoom levels for specific resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Layer}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Tile~Options=} opt_options Tile layer options.\n * @api\n */\nconst TileLayer = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  const baseOptions = assign({}, options);\n\n  delete baseOptions.preload;\n  delete baseOptions.useInterimTilesOnError;\n  Layer.call(this,  /** @type {module:ol/layer/Layer~Options} */ (baseOptions));\n\n  this.setPreload(options.preload !== undefined ? options.preload : 0);\n  this.setUseInterimTilesOnError(options.useInterimTilesOnError !== undefined ?\n    options.useInterimTilesOnError : true);\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {module:ol/LayerType}\n   */\n  this.type = LayerType.TILE;\n\n};\n\ninherits(TileLayer, Layer);\n\n\n/**\n * Return the level as number to which we will preload tiles up to.\n * @return {number} The level to preload tiles up to.\n * @observable\n * @api\n */\nTileLayer.prototype.getPreload = function() {\n  return /** @type {number} */ (this.get(TileProperty.PRELOAD));\n};\n\n\n/**\n * Return the associated {@link module:ol/source/Tile tilesource} of the layer.\n * @function\n * @return {module:ol/source/Tile} Source.\n * @api\n */\nTileLayer.prototype.getSource;\n\n\n/**\n * Set the level as number to which we will preload tiles up to.\n * @param {number} preload The level to preload tiles up to.\n * @observable\n * @api\n */\nTileLayer.prototype.setPreload = function(preload) {\n  this.set(TileProperty.PRELOAD, preload);\n};\n\n\n/**\n * Whether we use interim tiles on error.\n * @return {boolean} Use interim tiles on error.\n * @observable\n * @api\n */\nTileLayer.prototype.getUseInterimTilesOnError = function() {\n  return /** @type {boolean} */ (this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR));\n};\n\n\n/**\n * Set whether we use interim tiles on error.\n * @param {boolean} useInterimTilesOnError Use interim tiles on error.\n * @observable\n * @api\n */\nTileLayer.prototype.setUseInterimTilesOnError = function(useInterimTilesOnError) {\n  this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR, useInterimTilesOnError);\n};\nexport default TileLayer;\n","/**\n * @module ol/layer/VectorTile\n */\nimport {inherits} from '../index.js';\nimport LayerType from '../LayerType.js';\nimport {assert} from '../asserts.js';\nimport TileProperty from '../layer/TileProperty.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorTileRenderType from '../layer/VectorTileRenderType.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @enum {string}\n * Render mode for vector tiles:\n *  * `'image'`: Vector tiles are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'hybrid'`: Polygon and line elements are rendered as images, so pixels\n *    are scaled during zoom animations. Point symbols and texts are accurately\n *    rendered as vectors and can stay upright on rotated views.\n *  * `'vector'`: Vector tiles are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance than the other options.\n * @api\n */\nexport const RenderType = {\n  IMAGE: 'image',\n  HYBRID: 'hybrid',\n  VECTOR: 'vector'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/render~OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created. Use\n * `null` to avoid the sort, but get an undefined draw order.\n * @property {number} [renderBuffer=100] The buffer in pixels around the tile extent used by the\n * renderer when getting features from the vector tile for the rendering or hit-detection.\n * Recommended value: Vector tiles are usually generated with a buffer, so this value should match\n * the largest possible buffer of the used tiles. It should be at least the size of the largest\n * point symbol or line width.\n * @property {module:ol/layer/VectorTileRenderType|string} [renderMode='hybrid'] Render mode for vector tiles:\n *  * `'image'`: Vector tiles are rendered as images. Great performance, but point symbols and texts\n *    are always rotated with the view and pixels are scaled during zoom animations.\n *  * `'hybrid'`: Polygon and line elements are rendered as images, so pixels are scaled during zoom\n *    animations. Point symbols and texts are accurately rendered as vectors and can stay upright on\n *    rotated views.\n *  * `'vector'`: Vector tiles are rendered as vectors. Most accurate rendering even during\n *    animations, but slower performance than the other options.\n *\n * When `declutter` is set to `true`, `'hybrid'` will be used instead of `'image'`.\n * @property {module:ol/source/VectorTile} [source] Source.\n * @property {module:ol/PluggableMap} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [declutter=false] Declutter images and text. Decluttering is applied to all\n * image and text styles, and the priority is defined by the z-index of the style. Lower z-index\n * means higher priority. When set to `true`, a `renderMode` of `'image'` will be overridden with\n * `'hybrid'`.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {boolean} [updateWhileAnimating=false] When set to `true`, feature batches will be\n * recreated during animations. This means that no vectors will be shown clipped, but the setting\n * will have a performance impact for large amounts of vector data. When set to `false`, batches\n * will be recreated when no animation is active.\n * @property {boolean} [updateWhileInteracting=false] When set to `true`, feature batches will be\n * recreated during interactions. See also `updateWhileAnimating`.\n * @property {number} [preload=0] Preload. Load low-resolution tiles up to `preload` levels. `0`\n * means no preloading.\n * @property {module:ol/render~OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created.\n * @property {(module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction)} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {boolean} [useInterimTilesOnError=true] Use interim tiles on error.\n */\n\n\n/**\n * @classdesc\n * Layer for vector tile data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Vector}\n * @param {module:ol/layer/VectorTile~Options=} opt_options Options.\n * @api\n */\nconst VectorTileLayer = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  let renderMode = options.renderMode || VectorTileRenderType.HYBRID;\n  assert(renderMode == undefined ||\n      renderMode == VectorTileRenderType.IMAGE ||\n      renderMode == VectorTileRenderType.HYBRID ||\n      renderMode == VectorTileRenderType.VECTOR,\n  28); // `renderMode` must be `'image'`, `'hybrid'` or `'vector'`\n  if (options.declutter && renderMode == VectorTileRenderType.IMAGE) {\n    renderMode = VectorTileRenderType.HYBRID;\n  }\n  options.renderMode = renderMode;\n\n  const baseOptions = assign({}, options);\n\n  delete baseOptions.preload;\n  delete baseOptions.useInterimTilesOnError;\n  VectorLayer.call(this,  /** @type {module:ol/layer/Vector~Options} */ (baseOptions));\n\n  this.setPreload(options.preload ? options.preload : 0);\n  this.setUseInterimTilesOnError(options.useInterimTilesOnError !== undefined ?\n    options.useInterimTilesOnError : true);\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {module:ol/LayerType}\n   */\n  this.type = LayerType.VECTOR_TILE;\n\n};\n\ninherits(VectorTileLayer, VectorLayer);\n\n\n/**\n * Return the level as number to which we will preload tiles up to.\n * @return {number} The level to preload tiles up to.\n * @observable\n * @api\n */\nVectorTileLayer.prototype.getPreload = function() {\n  return /** @type {number} */ (this.get(TileProperty.PRELOAD));\n};\n\n\n/**\n * Whether we use interim tiles on error.\n * @return {boolean} Use interim tiles on error.\n * @observable\n * @api\n */\nVectorTileLayer.prototype.getUseInterimTilesOnError = function() {\n  return /** @type {boolean} */ (this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR));\n};\n\n\n/**\n * Set the level as number to which we will preload tiles up to.\n * @param {number} preload The level to preload tiles up to.\n * @observable\n * @api\n */\nVectorTileLayer.prototype.setPreload = function(preload) {\n  this.set(TileProperty.PRELOAD, preload);\n};\n\n\n/**\n * Set whether we use interim tiles on error.\n * @param {boolean} useInterimTilesOnError Use interim tiles on error.\n * @observable\n * @api\n */\nVectorTileLayer.prototype.setUseInterimTilesOnError = function(useInterimTilesOnError) {\n  this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR, useInterimTilesOnError);\n};\n\n\n/**\n * Return the associated {@link module:ol/source/VectorTile vectortilesource} of the layer.\n * @function\n * @return {module:ol/source/VectorTile} Source.\n * @api\n */\nVectorTileLayer.prototype.getSource;\nexport default VectorTileLayer;\n","/**\n * @module ol/tilecoord\n */\n\n\n/**\n * An array of three numbers representing the location of a tile in a tile\n * grid. The order is `z`, `x`, and `y`. `z` is the zoom level.\n * @typedef {Array.<number>} TileCoord\n * @api\n */\n\n\n/**\n * @param {number} z Z.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Tile coordinate.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n */\nexport function createOrUpdate(z, x, y, opt_tileCoord) {\n  if (opt_tileCoord !== undefined) {\n    opt_tileCoord[0] = z;\n    opt_tileCoord[1] = x;\n    opt_tileCoord[2] = y;\n    return opt_tileCoord;\n  } else {\n    return [z, x, y];\n  }\n}\n\n\n/**\n * @param {number} z Z.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {string} Key.\n */\nexport function getKeyZXY(z, x, y) {\n  return z + '/' + x + '/' + y;\n}\n\n\n/**\n * Get the key for a tile coord.\n * @param {module:ol/tilecoord~TileCoord} tileCoord The tile coord.\n * @return {string} Key.\n */\nexport function getKey(tileCoord) {\n  return getKeyZXY(tileCoord[0], tileCoord[1], tileCoord[2]);\n}\n\n\n/**\n * Get a tile coord given a key.\n * @param {string} key The tile coord key.\n * @return {module:ol/tilecoord~TileCoord} The tile coord.\n */\nexport function fromKey(key) {\n  return key.split('/').map(Number);\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coord.\n * @return {number} Hash.\n */\nexport function hash(tileCoord) {\n  return (tileCoord[1] << tileCoord[0]) + tileCoord[2];\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coord.\n * @return {string} Quad key.\n */\nexport function quadKey(tileCoord) {\n  const z = tileCoord[0];\n  const digits = new Array(z);\n  let mask = 1 << (z - 1);\n  let i, charCode;\n  for (i = 0; i < z; ++i) {\n    // 48 is charCode for 0 - '0'.charCodeAt(0)\n    charCode = 48;\n    if (tileCoord[1] & mask) {\n      charCode += 1;\n    }\n    if (tileCoord[2] & mask) {\n      charCode += 2;\n    }\n    digits[i] = String.fromCharCode(charCode);\n    mask >>= 1;\n  }\n  return digits.join('');\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {!module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {boolean} Tile coordinate is within extent and zoom level range.\n */\nexport function withinExtentAndZ(tileCoord, tileGrid) {\n  const z = tileCoord[0];\n  const x = tileCoord[1];\n  const y = tileCoord[2];\n\n  if (tileGrid.getMinZoom() > z || z > tileGrid.getMaxZoom()) {\n    return false;\n  }\n  const extent = tileGrid.getExtent();\n  let tileRange;\n  if (!extent) {\n    tileRange = tileGrid.getFullTileRange(z);\n  } else {\n    tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n  }\n  if (!tileRange) {\n    return true;\n  } else {\n    return tileRange.containsXY(x, y);\n  }\n}\n","/**\n * @module ol/tileurlfunction\n */\nimport {assert} from './asserts.js';\nimport {modulo} from './math.js';\nimport {hash as tileCoordHash} from './tilecoord.js';\n\n\n/**\n * @param {string} template Template.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {module:ol/Tile~UrlFunction} Tile URL function.\n */\nexport function createFromTemplate(template, tileGrid) {\n  const zRegEx = /\\{z\\}/g;\n  const xRegEx = /\\{x\\}/g;\n  const yRegEx = /\\{y\\}/g;\n  const dashYRegEx = /\\{-y\\}/g;\n  return (\n    /**\n     * @param {module:ol/tilecoord~TileCoord} tileCoord Tile Coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {module:ol/proj/Projection} projection Projection.\n     * @return {string|undefined} Tile URL.\n     */\n    function(tileCoord, pixelRatio, projection) {\n      if (!tileCoord) {\n        return undefined;\n      } else {\n        return template.replace(zRegEx, tileCoord[0].toString())\n          .replace(xRegEx, tileCoord[1].toString())\n          .replace(yRegEx, function() {\n            const y = -tileCoord[2] - 1;\n            return y.toString();\n          })\n          .replace(dashYRegEx, function() {\n            const z = tileCoord[0];\n            const range = tileGrid.getFullTileRange(z);\n            assert(range, 55); // The {-y} placeholder requires a tile grid with extent\n            const y = range.getHeight() + tileCoord[2];\n            return y.toString();\n          });\n      }\n    }\n  );\n}\n\n\n/**\n * @param {Array.<string>} templates Templates.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {module:ol/Tile~UrlFunction} Tile URL function.\n */\nexport function createFromTemplates(templates, tileGrid) {\n  const len = templates.length;\n  const tileUrlFunctions = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    tileUrlFunctions[i] = createFromTemplate(templates[i], tileGrid);\n  }\n  return createFromTileUrlFunctions(tileUrlFunctions);\n}\n\n\n/**\n * @param {Array.<module:ol/Tile~UrlFunction>} tileUrlFunctions Tile URL Functions.\n * @return {module:ol/Tile~UrlFunction} Tile URL function.\n */\nexport function createFromTileUrlFunctions(tileUrlFunctions) {\n  if (tileUrlFunctions.length === 1) {\n    return tileUrlFunctions[0];\n  }\n  return (\n    /**\n     * @param {module:ol/tilecoord~TileCoord} tileCoord Tile Coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {module:ol/proj/Projection} projection Projection.\n     * @return {string|undefined} Tile URL.\n     */\n    function(tileCoord, pixelRatio, projection) {\n      if (!tileCoord) {\n        return undefined;\n      } else {\n        const h = tileCoordHash(tileCoord);\n        const index = modulo(h, tileUrlFunctions.length);\n        return tileUrlFunctions[index](tileCoord, pixelRatio, projection);\n      }\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {string|undefined} Tile URL.\n */\nexport function nullTileUrlFunction(tileCoord, pixelRatio, projection) {\n  return undefined;\n}\n\n\n/**\n * @param {string} url URL.\n * @return {Array.<string>} Array of urls.\n */\nexport function expandUrl(url) {\n  const urls = [];\n  let match = /\\{([a-z])-([a-z])\\}/.exec(url);\n  if (match) {\n    // char range\n    const startCharCode = match[1].charCodeAt(0);\n    const stopCharCode = match[2].charCodeAt(0);\n    let charCode;\n    for (charCode = startCharCode; charCode <= stopCharCode; ++charCode) {\n      urls.push(url.replace(match[0], String.fromCharCode(charCode)));\n    }\n    return urls;\n  }\n  match = match = /\\{(\\d+)-(\\d+)\\}/.exec(url);\n  if (match) {\n    // number range\n    const stop = parseInt(match[2], 10);\n    for (let i = parseInt(match[1], 10); i <= stop; i++) {\n      urls.push(url.replace(match[0], i.toString()));\n    }\n    return urls;\n  }\n  urls.push(url);\n  return urls;\n}\n","/**\n * @module ol/net\n */\nimport {getUid} from './index.js';\n\n\n/**\n * Simple JSONP helper. Supports error callbacks and a custom callback param.\n * The error callback will be called when no JSONP is executed after 10 seconds.\n *\n * @param {string} url Request url. A 'callback' query parameter will be\n *     appended.\n * @param {Function} callback Callback on success.\n * @param {function()=} opt_errback Callback on error.\n * @param {string=} opt_callbackParam Custom query parameter for the JSONP\n *     callback. Default is 'callback'.\n */\nexport function jsonp(url, callback, opt_errback, opt_callbackParam) {\n  const script = document.createElement('script');\n  const key = 'olc_' + getUid(callback);\n  function cleanup() {\n    delete window[key];\n    script.parentNode.removeChild(script);\n  }\n  script.async = true;\n  script.src = url + (url.indexOf('?') == -1 ? '?' : '&') +\n      (opt_callbackParam || 'callback') + '=' + key;\n  const timer = setTimeout(function() {\n    cleanup();\n    if (opt_errback) {\n      opt_errback();\n    }\n  }, 10000);\n  window[key] = function(data) {\n    clearTimeout(timer);\n    cleanup();\n    callback(data);\n  };\n  document.getElementsByTagName('head')[0].appendChild(script);\n}\n","/**\n * @module ol/TileCache\n */\nimport {inherits} from './index.js';\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\n/**\n * @constructor\n * @extends {module:ol/structs/LRUCache.<module:ol/Tile>}\n * @param {number=} opt_highWaterMark High water mark.\n * @struct\n */\nconst TileCache = function(opt_highWaterMark) {\n\n  LRUCache.call(this, opt_highWaterMark);\n\n};\n\ninherits(TileCache, LRUCache);\n\n\n/**\n * @param {!Object.<string, module:ol/TileRange>} usedTiles Used tiles.\n */\nTileCache.prototype.expireCache = function(usedTiles) {\n  while (this.canExpireCache()) {\n    const tile = this.peekLast();\n    const zKey = tile.tileCoord[0].toString();\n    if (zKey in usedTiles && usedTiles[zKey].contains(tile.tileCoord)) {\n      break;\n    } else {\n      this.pop().dispose();\n    }\n  }\n};\n\n\n/**\n * Prune all tiles from the cache that don't have the same z as the newest tile.\n */\nTileCache.prototype.pruneExceptNewestZ = function() {\n  if (this.getCount() === 0) {\n    return;\n  }\n  const key = this.peekFirstKey();\n  const tileCoord = fromKey(key);\n  const z = tileCoord[0];\n  this.forEach(function(tile) {\n    if (tile.tileCoord[0] !== z) {\n      this.remove(getKey(tile.tileCoord));\n      tile.dispose();\n    }\n  }, this);\n};\nexport default TileCache;\n","/**\n * @module ol/reproj\n */\nimport {createCanvasContext2D} from './dom.js';\nimport {containsCoordinate, createEmpty, extend, getHeight, getTopLeft, getWidth} from './extent.js';\nimport {solveLinearSystem} from './math.js';\nimport {getPointResolution, transform} from './proj.js';\n\n\n/**\n * Calculates ideal resolution to use from the source in order to achieve\n * pixel mapping as close as possible to 1:1 during reprojection.\n * The resolution is calculated regardless of what resolutions\n * are actually available in the dataset (TileGrid, Image, ...).\n *\n * @param {module:ol/proj/Projection} sourceProj Source projection.\n * @param {module:ol/proj/Projection} targetProj Target projection.\n * @param {module:ol/coordinate~Coordinate} targetCenter Target center.\n * @param {number} targetResolution Target resolution.\n * @return {number} The best resolution to use. Can be +-Infinity, NaN or 0.\n */\nexport function calculateSourceResolution(sourceProj, targetProj,\n  targetCenter, targetResolution) {\n\n  const sourceCenter = transform(targetCenter, targetProj, sourceProj);\n\n  // calculate the ideal resolution of the source data\n  let sourceResolution = getPointResolution(targetProj, targetResolution, targetCenter);\n\n  const targetMetersPerUnit = targetProj.getMetersPerUnit();\n  if (targetMetersPerUnit !== undefined) {\n    sourceResolution *= targetMetersPerUnit;\n  }\n  const sourceMetersPerUnit = sourceProj.getMetersPerUnit();\n  if (sourceMetersPerUnit !== undefined) {\n    sourceResolution /= sourceMetersPerUnit;\n  }\n\n  // Based on the projection properties, the point resolution at the specified\n  // coordinates may be slightly different. We need to reverse-compensate this\n  // in order to achieve optimal results.\n\n  const sourceExtent = sourceProj.getExtent();\n  if (!sourceExtent || containsCoordinate(sourceExtent, sourceCenter)) {\n    const compensationFactor = getPointResolution(sourceProj, sourceResolution, sourceCenter) /\n        sourceResolution;\n    if (isFinite(compensationFactor) && compensationFactor > 0) {\n      sourceResolution /= compensationFactor;\n    }\n  }\n\n  return sourceResolution;\n}\n\n\n/**\n * Enlarge the clipping triangle point by 1 pixel to ensure the edges overlap\n * in order to mask gaps caused by antialiasing.\n *\n * @param {number} centroidX Centroid of the triangle (x coordinate in pixels).\n * @param {number} centroidY Centroid of the triangle (y coordinate in pixels).\n * @param {number} x X coordinate of the point (in pixels).\n * @param {number} y Y coordinate of the point (in pixels).\n * @return {module:ol/coordinate~Coordinate} New point 1 px farther from the centroid.\n */\nfunction enlargeClipPoint(centroidX, centroidY, x, y) {\n  const dX = x - centroidX;\n  const dY = y - centroidY;\n  const distance = Math.sqrt(dX * dX + dY * dY);\n  return [Math.round(x + dX / distance), Math.round(y + dY / distance)];\n}\n\n\n/**\n * Renders the source data into new canvas based on the triangulation.\n *\n * @param {number} width Width of the canvas.\n * @param {number} height Height of the canvas.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} sourceResolution Source resolution.\n * @param {module:ol/extent~Extent} sourceExtent Extent of the data source.\n * @param {number} targetResolution Target resolution.\n * @param {module:ol/extent~Extent} targetExtent Target extent.\n * @param {module:ol/reproj/Triangulation} triangulation\n * Calculated triangulation.\n * @param {Array.<{extent: module:ol/extent~Extent,\n *                 image: (HTMLCanvasElement|Image|HTMLVideoElement)}>} sources\n * Array of sources.\n * @param {number} gutter Gutter of the sources.\n * @param {boolean=} opt_renderEdges Render reprojection edges.\n * @return {HTMLCanvasElement} Canvas with reprojected data.\n */\nexport function render(width, height, pixelRatio,\n  sourceResolution, sourceExtent, targetResolution, targetExtent,\n  triangulation, sources, gutter, opt_renderEdges) {\n\n  const context = createCanvasContext2D(Math.round(pixelRatio * width),\n    Math.round(pixelRatio * height));\n\n  if (sources.length === 0) {\n    return context.canvas;\n  }\n\n  context.scale(pixelRatio, pixelRatio);\n\n  const sourceDataExtent = createEmpty();\n  sources.forEach(function(src, i, arr) {\n    extend(sourceDataExtent, src.extent);\n  });\n\n  const canvasWidthInUnits = getWidth(sourceDataExtent);\n  const canvasHeightInUnits = getHeight(sourceDataExtent);\n  const stitchContext = createCanvasContext2D(\n    Math.round(pixelRatio * canvasWidthInUnits / sourceResolution),\n    Math.round(pixelRatio * canvasHeightInUnits / sourceResolution));\n\n  const stitchScale = pixelRatio / sourceResolution;\n\n  sources.forEach(function(src, i, arr) {\n    const xPos = src.extent[0] - sourceDataExtent[0];\n    const yPos = -(src.extent[3] - sourceDataExtent[3]);\n    const srcWidth = getWidth(src.extent);\n    const srcHeight = getHeight(src.extent);\n\n    stitchContext.drawImage(\n      src.image,\n      gutter, gutter,\n      src.image.width - 2 * gutter, src.image.height - 2 * gutter,\n      xPos * stitchScale, yPos * stitchScale,\n      srcWidth * stitchScale, srcHeight * stitchScale);\n  });\n\n  const targetTopLeft = getTopLeft(targetExtent);\n\n  triangulation.getTriangles().forEach(function(triangle, i, arr) {\n    /* Calculate affine transform (src -> dst)\n     * Resulting matrix can be used to transform coordinate\n     * from `sourceProjection` to destination pixels.\n     *\n     * To optimize number of context calls and increase numerical stability,\n     * we also do the following operations:\n     * trans(-topLeftExtentCorner), scale(1 / targetResolution), scale(1, -1)\n     * here before solving the linear system so [ui, vi] are pixel coordinates.\n     *\n     * Src points: xi, yi\n     * Dst points: ui, vi\n     * Affine coefficients: aij\n     *\n     * | x0 y0 1  0  0 0 |   |a00|   |u0|\n     * | x1 y1 1  0  0 0 |   |a01|   |u1|\n     * | x2 y2 1  0  0 0 | x |a02| = |u2|\n     * |  0  0 0 x0 y0 1 |   |a10|   |v0|\n     * |  0  0 0 x1 y1 1 |   |a11|   |v1|\n     * |  0  0 0 x2 y2 1 |   |a12|   |v2|\n     */\n    const source = triangle.source;\n    const target = triangle.target;\n    let x0 = source[0][0], y0 = source[0][1];\n    let x1 = source[1][0], y1 = source[1][1];\n    let x2 = source[2][0], y2 = source[2][1];\n    const u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n    const v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n    const u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n    const v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n    const u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n    const v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n    // Shift all the source points to improve numerical stability\n    // of all the subsequent calculations. The [x0, y0] is used here.\n    // This is also used to simplify the linear system.\n    const sourceNumericalShiftX = x0;\n    const sourceNumericalShiftY = y0;\n    x0 = 0;\n    y0 = 0;\n    x1 -= sourceNumericalShiftX;\n    y1 -= sourceNumericalShiftY;\n    x2 -= sourceNumericalShiftX;\n    y2 -= sourceNumericalShiftY;\n\n    const augmentedMatrix = [\n      [x1, y1, 0, 0, u1 - u0],\n      [x2, y2, 0, 0, u2 - u0],\n      [0, 0, x1, y1, v1 - v0],\n      [0, 0, x2, y2, v2 - v0]\n    ];\n    const affineCoefs = solveLinearSystem(augmentedMatrix);\n    if (!affineCoefs) {\n      return;\n    }\n\n    context.save();\n    context.beginPath();\n    const centroidX = (u0 + u1 + u2) / 3;\n    const centroidY = (v0 + v1 + v2) / 3;\n    const p0 = enlargeClipPoint(centroidX, centroidY, u0, v0);\n    const p1 = enlargeClipPoint(centroidX, centroidY, u1, v1);\n    const p2 = enlargeClipPoint(centroidX, centroidY, u2, v2);\n\n    context.moveTo(p1[0], p1[1]);\n    context.lineTo(p0[0], p0[1]);\n    context.lineTo(p2[0], p2[1]);\n    context.clip();\n\n    context.transform(\n      affineCoefs[0], affineCoefs[2], affineCoefs[1], affineCoefs[3], u0, v0);\n\n    context.translate(sourceDataExtent[0] - sourceNumericalShiftX,\n      sourceDataExtent[3] - sourceNumericalShiftY);\n\n    context.scale(sourceResolution / pixelRatio,\n      -sourceResolution / pixelRatio);\n\n    context.drawImage(stitchContext.canvas, 0, 0);\n    context.restore();\n  });\n\n  if (opt_renderEdges) {\n    context.save();\n\n    context.strokeStyle = 'black';\n    context.lineWidth = 1;\n\n    triangulation.getTriangles().forEach(function(triangle, i, arr) {\n      const target = triangle.target;\n      const u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n      const v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n      const u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n      const v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n      const u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n      const v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n      context.beginPath();\n      context.moveTo(u1, v1);\n      context.lineTo(u0, v0);\n      context.lineTo(u2, v2);\n      context.closePath();\n      context.stroke();\n    });\n\n    context.restore();\n  }\n  return context.canvas;\n}\n","/**\n * @module ol/reproj/Triangulation\n */\nimport {boundingExtent, createEmpty, extendCoordinate, getBottomLeft, getBottomRight,\n  getTopLeft, getTopRight, getWidth, intersects} from '../extent.js';\nimport {modulo} from '../math.js';\nimport {getTransform} from '../proj.js';\n\n\n/**\n * Single triangle; consists of 3 source points and 3 target points.\n * @typedef {Object} Triangle\n * @property {Array.<module:ol/coordinate~Coordinate>} source\n * @property {Array.<module:ol/coordinate~Coordinate>} target\n */\n\n\n/**\n * Maximum number of subdivision steps during raster reprojection triangulation.\n * Prevents high memory usage and large number of proj4 calls (for certain\n * transformations and areas). At most `2*(2^this)` triangles are created for\n * each triangulated extent (tile/image).\n * @type {number}\n */\nconst MAX_SUBDIVISION = 10;\n\n\n/**\n * Maximum allowed size of triangle relative to world width. When transforming\n * corners of world extent between certain projections, the resulting\n * triangulation seems to have zero error and no subdivision is performed. If\n * the triangle width is more than this (relative to world width; 0-1),\n * subdivison is forced (up to `MAX_SUBDIVISION`). Default is `0.25`.\n * @type {number}\n */\nconst MAX_TRIANGLE_WIDTH = 0.25;\n\n\n/**\n * @classdesc\n * Class containing triangulation of the given target extent.\n * Used for determining source data and the reprojection itself.\n *\n * @param {module:ol/proj/Projection} sourceProj Source projection.\n * @param {module:ol/proj/Projection} targetProj Target projection.\n * @param {module:ol/extent~Extent} targetExtent Target extent to triangulate.\n * @param {module:ol/extent~Extent} maxSourceExtent Maximal source extent that can be used.\n * @param {number} errorThreshold Acceptable error (in source units).\n * @constructor\n */\nconst Triangulation = function(sourceProj, targetProj, targetExtent,\n  maxSourceExtent, errorThreshold) {\n\n  /**\n   * @type {module:ol/proj/Projection}\n   * @private\n   */\n  this.sourceProj_ = sourceProj;\n\n  /**\n   * @type {module:ol/proj/Projection}\n   * @private\n   */\n  this.targetProj_ = targetProj;\n\n  /** @type {!Object.<string, module:ol/coordinate~Coordinate>} */\n  let transformInvCache = {};\n  const transformInv = getTransform(this.targetProj_, this.sourceProj_);\n\n  /**\n   * @param {module:ol/coordinate~Coordinate} c A coordinate.\n   * @return {module:ol/coordinate~Coordinate} Transformed coordinate.\n   * @private\n   */\n  this.transformInv_ = function(c) {\n    const key = c[0] + '/' + c[1];\n    if (!transformInvCache[key]) {\n      transformInvCache[key] = transformInv(c);\n    }\n    return transformInvCache[key];\n  };\n\n  /**\n   * @type {module:ol/extent~Extent}\n   * @private\n   */\n  this.maxSourceExtent_ = maxSourceExtent;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.errorThresholdSquared_ = errorThreshold * errorThreshold;\n\n  /**\n   * @type {Array.<module:ol/reproj/Triangulation~Triangle>}\n   * @private\n   */\n  this.triangles_ = [];\n\n  /**\n   * Indicates that the triangulation crosses edge of the source projection.\n   * @type {boolean}\n   * @private\n   */\n  this.wrapsXInSource_ = false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.canWrapXInSource_ = this.sourceProj_.canWrapX() &&\n      !!maxSourceExtent &&\n      !!this.sourceProj_.getExtent() &&\n      (getWidth(maxSourceExtent) == getWidth(this.sourceProj_.getExtent()));\n\n  /**\n   * @type {?number}\n   * @private\n   */\n  this.sourceWorldWidth_ = this.sourceProj_.getExtent() ?\n    getWidth(this.sourceProj_.getExtent()) : null;\n\n  /**\n   * @type {?number}\n   * @private\n   */\n  this.targetWorldWidth_ = this.targetProj_.getExtent() ?\n    getWidth(this.targetProj_.getExtent()) : null;\n\n  const destinationTopLeft = getTopLeft(targetExtent);\n  const destinationTopRight = getTopRight(targetExtent);\n  const destinationBottomRight = getBottomRight(targetExtent);\n  const destinationBottomLeft = getBottomLeft(targetExtent);\n  const sourceTopLeft = this.transformInv_(destinationTopLeft);\n  const sourceTopRight = this.transformInv_(destinationTopRight);\n  const sourceBottomRight = this.transformInv_(destinationBottomRight);\n  const sourceBottomLeft = this.transformInv_(destinationBottomLeft);\n\n  this.addQuad_(\n    destinationTopLeft, destinationTopRight,\n    destinationBottomRight, destinationBottomLeft,\n    sourceTopLeft, sourceTopRight, sourceBottomRight, sourceBottomLeft,\n    MAX_SUBDIVISION);\n\n  if (this.wrapsXInSource_) {\n    let leftBound = Infinity;\n    this.triangles_.forEach(function(triangle, i, arr) {\n      leftBound = Math.min(leftBound,\n        triangle.source[0][0], triangle.source[1][0], triangle.source[2][0]);\n    });\n\n    // Shift triangles to be as close to `leftBound` as possible\n    // (if the distance is more than `worldWidth / 2` it can be closer.\n    this.triangles_.forEach(function(triangle) {\n      if (Math.max(triangle.source[0][0], triangle.source[1][0],\n        triangle.source[2][0]) - leftBound > this.sourceWorldWidth_ / 2) {\n        const newTriangle = [[triangle.source[0][0], triangle.source[0][1]],\n          [triangle.source[1][0], triangle.source[1][1]],\n          [triangle.source[2][0], triangle.source[2][1]]];\n        if ((newTriangle[0][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[0][0] -= this.sourceWorldWidth_;\n        }\n        if ((newTriangle[1][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[1][0] -= this.sourceWorldWidth_;\n        }\n        if ((newTriangle[2][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[2][0] -= this.sourceWorldWidth_;\n        }\n\n        // Rarely (if the extent contains both the dateline and prime meridian)\n        // the shift can in turn break some triangles.\n        // Detect this here and don't shift in such cases.\n        const minX = Math.min(\n          newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n        const maxX = Math.max(\n          newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n        if ((maxX - minX) < this.sourceWorldWidth_ / 2) {\n          triangle.source = newTriangle;\n        }\n      }\n    }.bind(this));\n  }\n\n  transformInvCache = {};\n};\n\n\n/**\n * Adds triangle to the triangulation.\n * @param {module:ol/coordinate~Coordinate} a The target a coordinate.\n * @param {module:ol/coordinate~Coordinate} b The target b coordinate.\n * @param {module:ol/coordinate~Coordinate} c The target c coordinate.\n * @param {module:ol/coordinate~Coordinate} aSrc The source a coordinate.\n * @param {module:ol/coordinate~Coordinate} bSrc The source b coordinate.\n * @param {module:ol/coordinate~Coordinate} cSrc The source c coordinate.\n * @private\n */\nTriangulation.prototype.addTriangle_ = function(a, b, c,\n  aSrc, bSrc, cSrc) {\n  this.triangles_.push({\n    source: [aSrc, bSrc, cSrc],\n    target: [a, b, c]\n  });\n};\n\n\n/**\n * Adds quad (points in clock-wise order) to the triangulation\n * (and reprojects the vertices) if valid.\n * Performs quad subdivision if needed to increase precision.\n *\n * @param {module:ol/coordinate~Coordinate} a The target a coordinate.\n * @param {module:ol/coordinate~Coordinate} b The target b coordinate.\n * @param {module:ol/coordinate~Coordinate} c The target c coordinate.\n * @param {module:ol/coordinate~Coordinate} d The target d coordinate.\n * @param {module:ol/coordinate~Coordinate} aSrc The source a coordinate.\n * @param {module:ol/coordinate~Coordinate} bSrc The source b coordinate.\n * @param {module:ol/coordinate~Coordinate} cSrc The source c coordinate.\n * @param {module:ol/coordinate~Coordinate} dSrc The source d coordinate.\n * @param {number} maxSubdivision Maximal allowed subdivision of the quad.\n * @private\n */\nTriangulation.prototype.addQuad_ = function(a, b, c, d,\n  aSrc, bSrc, cSrc, dSrc, maxSubdivision) {\n\n  const sourceQuadExtent = boundingExtent([aSrc, bSrc, cSrc, dSrc]);\n  const sourceCoverageX = this.sourceWorldWidth_ ?\n    getWidth(sourceQuadExtent) / this.sourceWorldWidth_ : null;\n  const sourceWorldWidth = /** @type {number} */ (this.sourceWorldWidth_);\n\n  // when the quad is wrapped in the source projection\n  // it covers most of the projection extent, but not fully\n  const wrapsX = this.sourceProj_.canWrapX() &&\n               sourceCoverageX > 0.5 && sourceCoverageX < 1;\n\n  let needsSubdivision = false;\n\n  if (maxSubdivision > 0) {\n    if (this.targetProj_.isGlobal() && this.targetWorldWidth_) {\n      const targetQuadExtent = boundingExtent([a, b, c, d]);\n      const targetCoverageX = getWidth(targetQuadExtent) / this.targetWorldWidth_;\n      needsSubdivision |=\n          targetCoverageX > MAX_TRIANGLE_WIDTH;\n    }\n    if (!wrapsX && this.sourceProj_.isGlobal() && sourceCoverageX) {\n      needsSubdivision |=\n          sourceCoverageX > MAX_TRIANGLE_WIDTH;\n    }\n  }\n\n  if (!needsSubdivision && this.maxSourceExtent_) {\n    if (!intersects(sourceQuadExtent, this.maxSourceExtent_)) {\n      // whole quad outside source projection extent -> ignore\n      return;\n    }\n  }\n\n  if (!needsSubdivision) {\n    if (!isFinite(aSrc[0]) || !isFinite(aSrc[1]) ||\n        !isFinite(bSrc[0]) || !isFinite(bSrc[1]) ||\n        !isFinite(cSrc[0]) || !isFinite(cSrc[1]) ||\n        !isFinite(dSrc[0]) || !isFinite(dSrc[1])) {\n      if (maxSubdivision > 0) {\n        needsSubdivision = true;\n      } else {\n        return;\n      }\n    }\n  }\n\n  if (maxSubdivision > 0) {\n    if (!needsSubdivision) {\n      const center = [(a[0] + c[0]) / 2, (a[1] + c[1]) / 2];\n      const centerSrc = this.transformInv_(center);\n\n      let dx;\n      if (wrapsX) {\n        const centerSrcEstimX =\n            (modulo(aSrc[0], sourceWorldWidth) +\n             modulo(cSrc[0], sourceWorldWidth)) / 2;\n        dx = centerSrcEstimX -\n            modulo(centerSrc[0], sourceWorldWidth);\n      } else {\n        dx = (aSrc[0] + cSrc[0]) / 2 - centerSrc[0];\n      }\n      const dy = (aSrc[1] + cSrc[1]) / 2 - centerSrc[1];\n      const centerSrcErrorSquared = dx * dx + dy * dy;\n      needsSubdivision = centerSrcErrorSquared > this.errorThresholdSquared_;\n    }\n    if (needsSubdivision) {\n      if (Math.abs(a[0] - c[0]) <= Math.abs(a[1] - c[1])) {\n        // split horizontally (top & bottom)\n        const bc = [(b[0] + c[0]) / 2, (b[1] + c[1]) / 2];\n        const bcSrc = this.transformInv_(bc);\n        const da = [(d[0] + a[0]) / 2, (d[1] + a[1]) / 2];\n        const daSrc = this.transformInv_(da);\n\n        this.addQuad_(\n          a, b, bc, da, aSrc, bSrc, bcSrc, daSrc, maxSubdivision - 1);\n        this.addQuad_(\n          da, bc, c, d, daSrc, bcSrc, cSrc, dSrc, maxSubdivision - 1);\n      } else {\n        // split vertically (left & right)\n        const ab = [(a[0] + b[0]) / 2, (a[1] + b[1]) / 2];\n        const abSrc = this.transformInv_(ab);\n        const cd = [(c[0] + d[0]) / 2, (c[1] + d[1]) / 2];\n        const cdSrc = this.transformInv_(cd);\n\n        this.addQuad_(\n          a, ab, cd, d, aSrc, abSrc, cdSrc, dSrc, maxSubdivision - 1);\n        this.addQuad_(\n          ab, b, c, cd, abSrc, bSrc, cSrc, cdSrc, maxSubdivision - 1);\n      }\n      return;\n    }\n  }\n\n  if (wrapsX) {\n    if (!this.canWrapXInSource_) {\n      return;\n    }\n    this.wrapsXInSource_ = true;\n  }\n\n  this.addTriangle_(a, c, d, aSrc, cSrc, dSrc);\n  this.addTriangle_(a, b, c, aSrc, bSrc, cSrc);\n};\n\n\n/**\n * Calculates extent of the 'source' coordinates from all the triangles.\n *\n * @return {module:ol/extent~Extent} Calculated extent.\n */\nTriangulation.prototype.calculateSourceExtent = function() {\n  const extent = createEmpty();\n\n  this.triangles_.forEach(function(triangle, i, arr) {\n    const src = triangle.source;\n    extendCoordinate(extent, src[0]);\n    extendCoordinate(extent, src[1]);\n    extendCoordinate(extent, src[2]);\n  });\n\n  return extent;\n};\n\n\n/**\n * @return {Array.<module:ol/reproj/Triangulation~Triangle>} Array of the calculated triangles.\n */\nTriangulation.prototype.getTriangles = function() {\n  return this.triangles_;\n};\nexport default Triangulation;\n","/**\n * @module ol/reproj/Tile\n */\nimport {ERROR_THRESHOLD} from './common.js';\nimport {inherits} from '../index.js';\nimport Tile from '../Tile.js';\nimport TileState from '../TileState.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getArea, getCenter, getIntersection} from '../extent.js';\nimport {clamp} from '../math.js';\nimport {calculateSourceResolution, render as renderReprojected} from '../reproj.js';\nimport Triangulation from '../reproj/Triangulation.js';\n\n\n/**\n * @typedef {function(number, number, number, number) : module:ol/Tile} FunctionType\n */\n\n\n/**\n * @classdesc\n * Class encapsulating single reprojected tile.\n * See {@link module:ol/source/TileImage~TileImage}.\n *\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/proj/Projection} sourceProj Source projection.\n * @param {module:ol/tilegrid/TileGrid} sourceTileGrid Source tile grid.\n * @param {module:ol/proj/Projection} targetProj Target projection.\n * @param {module:ol/tilegrid/TileGrid} targetTileGrid Target tile grid.\n * @param {module:ol/tilecoord~TileCoord} tileCoord Coordinate of the tile.\n * @param {module:ol/tilecoord~TileCoord} wrappedTileCoord Coordinate of the tile wrapped in X.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} gutter Gutter of the source tiles.\n * @param {module:ol/reproj/Tile~FunctionType} getTileFunction\n *     Function returning source tiles (z, x, y, pixelRatio).\n * @param {number=} opt_errorThreshold Acceptable reprojection error (in px).\n * @param {boolean=} opt_renderEdges Render reprojection edges.\n */\nconst ReprojTile = function(sourceProj, sourceTileGrid,\n  targetProj, targetTileGrid, tileCoord, wrappedTileCoord,\n  pixelRatio, gutter, getTileFunction,\n  opt_errorThreshold, opt_renderEdges) {\n  Tile.call(this, tileCoord, TileState.IDLE);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderEdges_ = opt_renderEdges !== undefined ? opt_renderEdges : false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.gutter_ = gutter;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.sourceTileGrid_ = sourceTileGrid;\n\n  /**\n   * @private\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.targetTileGrid_ = targetTileGrid;\n\n  /**\n   * @private\n   * @type {module:ol/tilecoord~TileCoord}\n   */\n  this.wrappedTileCoord_ = wrappedTileCoord ? wrappedTileCoord : tileCoord;\n\n  /**\n   * @private\n   * @type {!Array.<module:ol/Tile>}\n   */\n  this.sourceTiles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.sourcesListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.sourceZ_ = 0;\n\n  const targetExtent = targetTileGrid.getTileCoordExtent(this.wrappedTileCoord_);\n  const maxTargetExtent = this.targetTileGrid_.getExtent();\n  let maxSourceExtent = this.sourceTileGrid_.getExtent();\n\n  const limitedTargetExtent = maxTargetExtent ?\n    getIntersection(targetExtent, maxTargetExtent) : targetExtent;\n\n  if (getArea(limitedTargetExtent) === 0) {\n    // Tile is completely outside range -> EMPTY\n    // TODO: is it actually correct that the source even creates the tile ?\n    this.state = TileState.EMPTY;\n    return;\n  }\n\n  const sourceProjExtent = sourceProj.getExtent();\n  if (sourceProjExtent) {\n    if (!maxSourceExtent) {\n      maxSourceExtent = sourceProjExtent;\n    } else {\n      maxSourceExtent = getIntersection(maxSourceExtent, sourceProjExtent);\n    }\n  }\n\n  const targetResolution = targetTileGrid.getResolution(\n    this.wrappedTileCoord_[0]);\n\n  const targetCenter = getCenter(limitedTargetExtent);\n  const sourceResolution = calculateSourceResolution(\n    sourceProj, targetProj, targetCenter, targetResolution);\n\n  if (!isFinite(sourceResolution) || sourceResolution <= 0) {\n    // invalid sourceResolution -> EMPTY\n    // probably edges of the projections when no extent is defined\n    this.state = TileState.EMPTY;\n    return;\n  }\n\n  const errorThresholdInPixels = opt_errorThreshold !== undefined ?\n    opt_errorThreshold : ERROR_THRESHOLD;\n\n  /**\n   * @private\n   * @type {!module:ol/reproj/Triangulation}\n   */\n  this.triangulation_ = new Triangulation(\n    sourceProj, targetProj, limitedTargetExtent, maxSourceExtent,\n    sourceResolution * errorThresholdInPixels);\n\n  if (this.triangulation_.getTriangles().length === 0) {\n    // no valid triangles -> EMPTY\n    this.state = TileState.EMPTY;\n    return;\n  }\n\n  this.sourceZ_ = sourceTileGrid.getZForResolution(sourceResolution);\n  let sourceExtent = this.triangulation_.calculateSourceExtent();\n\n  if (maxSourceExtent) {\n    if (sourceProj.canWrapX()) {\n      sourceExtent[1] = clamp(\n        sourceExtent[1], maxSourceExtent[1], maxSourceExtent[3]);\n      sourceExtent[3] = clamp(\n        sourceExtent[3], maxSourceExtent[1], maxSourceExtent[3]);\n    } else {\n      sourceExtent = getIntersection(sourceExtent, maxSourceExtent);\n    }\n  }\n\n  if (!getArea(sourceExtent)) {\n    this.state = TileState.EMPTY;\n  } else {\n    const sourceRange = sourceTileGrid.getTileRangeForExtentAndZ(\n      sourceExtent, this.sourceZ_);\n\n    for (let srcX = sourceRange.minX; srcX <= sourceRange.maxX; srcX++) {\n      for (let srcY = sourceRange.minY; srcY <= sourceRange.maxY; srcY++) {\n        const tile = getTileFunction(this.sourceZ_, srcX, srcY, pixelRatio);\n        if (tile) {\n          this.sourceTiles_.push(tile);\n        }\n      }\n    }\n\n    if (this.sourceTiles_.length === 0) {\n      this.state = TileState.EMPTY;\n    }\n  }\n};\n\ninherits(ReprojTile, Tile);\n\n\n/**\n * @inheritDoc\n */\nReprojTile.prototype.disposeInternal = function() {\n  if (this.state == TileState.LOADING) {\n    this.unlistenSources_();\n  }\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Get the HTML Canvas element for this tile.\n * @return {HTMLCanvasElement} Canvas.\n */\nReprojTile.prototype.getImage = function() {\n  return this.canvas_;\n};\n\n\n/**\n * @private\n */\nReprojTile.prototype.reproject_ = function() {\n  const sources = [];\n  this.sourceTiles_.forEach(function(tile, i, arr) {\n    if (tile && tile.getState() == TileState.LOADED) {\n      sources.push({\n        extent: this.sourceTileGrid_.getTileCoordExtent(tile.tileCoord),\n        image: tile.getImage()\n      });\n    }\n  }.bind(this));\n  this.sourceTiles_.length = 0;\n\n  if (sources.length === 0) {\n    this.state = TileState.ERROR;\n  } else {\n    const z = this.wrappedTileCoord_[0];\n    const size = this.targetTileGrid_.getTileSize(z);\n    const width = typeof size === 'number' ? size : size[0];\n    const height = typeof size === 'number' ? size : size[1];\n    const targetResolution = this.targetTileGrid_.getResolution(z);\n    const sourceResolution = this.sourceTileGrid_.getResolution(this.sourceZ_);\n\n    const targetExtent = this.targetTileGrid_.getTileCoordExtent(\n      this.wrappedTileCoord_);\n    this.canvas_ = renderReprojected(width, height, this.pixelRatio_,\n      sourceResolution, this.sourceTileGrid_.getExtent(),\n      targetResolution, targetExtent, this.triangulation_, sources,\n      this.gutter_, this.renderEdges_);\n\n    this.state = TileState.LOADED;\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nReprojTile.prototype.load = function() {\n  if (this.state == TileState.IDLE) {\n    this.state = TileState.LOADING;\n    this.changed();\n\n    let leftToLoad = 0;\n\n    this.sourcesListenerKeys_ = [];\n    this.sourceTiles_.forEach(function(tile, i, arr) {\n      const state = tile.getState();\n      if (state == TileState.IDLE || state == TileState.LOADING) {\n        leftToLoad++;\n\n        const sourceListenKey = listen(tile, EventType.CHANGE,\n          function(e) {\n            const state = tile.getState();\n            if (state == TileState.LOADED ||\n                  state == TileState.ERROR ||\n                  state == TileState.EMPTY) {\n              unlistenByKey(sourceListenKey);\n              leftToLoad--;\n              if (leftToLoad === 0) {\n                this.unlistenSources_();\n                this.reproject_();\n              }\n            }\n          }, this);\n        this.sourcesListenerKeys_.push(sourceListenKey);\n      }\n    }.bind(this));\n\n    this.sourceTiles_.forEach(function(tile, i, arr) {\n      const state = tile.getState();\n      if (state == TileState.IDLE) {\n        tile.load();\n      }\n    });\n\n    if (leftToLoad === 0) {\n      setTimeout(this.reproject_.bind(this), 0);\n    }\n  }\n};\n\n\n/**\n * @private\n */\nReprojTile.prototype.unlistenSources_ = function() {\n  this.sourcesListenerKeys_.forEach(unlistenByKey);\n  this.sourcesListenerKeys_ = null;\n};\nexport default ReprojTile;\n","/**\n * @module ol/tilegrid/TileGrid\n */\nimport {DEFAULT_TILE_SIZE} from './common.js';\nimport {assert} from '../asserts.js';\nimport TileRange, {createOrUpdate as createOrUpdateTileRange} from '../TileRange.js';\nimport {isSorted, linearFindNearest} from '../array.js';\nimport {createOrUpdate, getTopLeft} from '../extent.js';\nimport {clamp} from '../math.js';\nimport {toSize} from '../size.js';\nimport {createOrUpdate as createOrUpdateTileCoord} from '../tilecoord.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/extent~Extent} [extent] Extent for the tile grid. No tiles outside this\n * extent will be requested by {@link module:ol/source/Tile} sources. When no `origin` or\n * `origins` are configured, the `origin` will be set to the top-left corner of the extent.\n * @property {number} [minZoom=0] Minimum zoom.\n * @property {module:ol/coordinate~Coordinate} [origin] The tile grid origin, i.e. where the `x`\n * and `y` axes meet (`[z, 0, 0]`). Tile coordinates increase left to right and upwards. If not\n * specified, `extent` or `origins` must be provided.\n * @property {Array.<module:ol/coordinate~Coordinate>} [origins] Tile grid origins, i.e. where\n * the `x` and `y` axes meet (`[z, 0, 0]`), for each zoom level. If given, the array length\n * should match the length of the `resolutions` array, i.e. each resolution can have a different\n * origin. Tile coordinates increase left to right and upwards. If not specified, `extent` or\n * `origin` must be provided.\n * @property {!Array.<number>} resolutions Resolutions. The array index of each resolution needs\n * to match the zoom level. This means that even if a `minZoom` is configured, the resolutions\n * array will have a length of `maxZoom + 1`.\n * @property {Array.<module:ol/size~Size>} [sizes] Sizes.\n * @property {number|module:ol/size~Size} [tileSize] Tile size.\n * Default is `[256, 256]`.\n * @property {Array.<module:ol/size~Size>} [tileSizes] Tile sizes. If given, the array length\n * should match the length of the `resolutions` array, i.e. each resolution can have a different\n * tile size.\n */\n\n\n/**\n * @classdesc\n * Base class for setting the grid pattern for sources accessing tiled-image\n * servers.\n *\n * @constructor\n * @param {module:ol/tilegrid/TileGrid~Options} options Tile grid options.\n * @struct\n * @api\n */\nconst TileGrid = function(options) {\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.minZoom = options.minZoom !== undefined ? options.minZoom : 0;\n\n  /**\n   * @private\n   * @type {!Array.<number>}\n   */\n  this.resolutions_ = options.resolutions;\n  assert(isSorted(this.resolutions_, function(a, b) {\n    return b - a;\n  }, true), 17); // `resolutions` must be sorted in descending order\n\n\n  // check if we've got a consistent zoom factor and origin\n  let zoomFactor;\n  if (!options.origins) {\n    for (let i = 0, ii = this.resolutions_.length - 1; i < ii; ++i) {\n      if (!zoomFactor) {\n        zoomFactor = this.resolutions_[i] / this.resolutions_[i + 1];\n      } else {\n        if (this.resolutions_[i] / this.resolutions_[i + 1] !== zoomFactor) {\n          zoomFactor = undefined;\n          break;\n        }\n      }\n    }\n  }\n\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.zoomFactor_ = zoomFactor;\n\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.maxZoom = this.resolutions_.length - 1;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.origin_ = options.origin !== undefined ? options.origin : null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/coordinate~Coordinate>}\n   */\n  this.origins_ = null;\n  if (options.origins !== undefined) {\n    this.origins_ = options.origins;\n    assert(this.origins_.length == this.resolutions_.length,\n      20); // Number of `origins` and `resolutions` must be equal\n  }\n\n  const extent = options.extent;\n\n  if (extent !== undefined &&\n      !this.origin_ && !this.origins_) {\n    this.origin_ = getTopLeft(extent);\n  }\n\n  assert(\n    (!this.origin_ && this.origins_) || (this.origin_ && !this.origins_),\n    18); // Either `origin` or `origins` must be configured, never both\n\n  /**\n   * @private\n   * @type {Array.<number|module:ol/size~Size>}\n   */\n  this.tileSizes_ = null;\n  if (options.tileSizes !== undefined) {\n    this.tileSizes_ = options.tileSizes;\n    assert(this.tileSizes_.length == this.resolutions_.length,\n      19); // Number of `tileSizes` and `resolutions` must be equal\n  }\n\n  /**\n   * @private\n   * @type {number|module:ol/size~Size}\n   */\n  this.tileSize_ = options.tileSize !== undefined ?\n    options.tileSize :\n    !this.tileSizes_ ? DEFAULT_TILE_SIZE : null;\n  assert(\n    (!this.tileSize_ && this.tileSizes_) ||\n      (this.tileSize_ && !this.tileSizes_),\n    22); // Either `tileSize` or `tileSizes` must be configured, never both\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = extent !== undefined ? extent : null;\n\n\n  /**\n   * @private\n   * @type {Array.<module:ol/TileRange>}\n   */\n  this.fullTileRanges_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.tmpSize_ = [0, 0];\n\n  if (options.sizes !== undefined) {\n    this.fullTileRanges_ = options.sizes.map(function(size, z) {\n      const tileRange = new TileRange(\n        Math.min(0, size[0]), Math.max(size[0] - 1, -1),\n        Math.min(0, size[1]), Math.max(size[1] - 1, -1));\n      return tileRange;\n    }, this);\n  } else if (extent) {\n    this.calculateTileRanges_(extent);\n  }\n\n};\n\n\n/**\n * @private\n * @type {module:ol/tilecoord~TileCoord}\n */\nconst tmpTileCoord = [0, 0, 0];\n\n\n/**\n * Call a function with each tile coordinate for a given extent and zoom level.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} zoom Integer zoom level.\n * @param {function(module:ol/tilecoord~TileCoord)} callback Function called with each tile coordinate.\n * @api\n */\nTileGrid.prototype.forEachTileCoord = function(extent, zoom, callback) {\n  const tileRange = this.getTileRangeForExtentAndZ(extent, zoom);\n  for (let i = tileRange.minX, ii = tileRange.maxX; i <= ii; ++i) {\n    for (let j = tileRange.minY, jj = tileRange.maxY; j <= jj; ++j) {\n      callback([zoom, i, j]);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {function(this: T, number, module:ol/TileRange): boolean} callback Callback.\n * @param {T=} opt_this The object to use as `this` in `callback`.\n * @param {module:ol/TileRange=} opt_tileRange Temporary module:ol/TileRange object.\n * @param {module:ol/extent~Extent=} opt_extent Temporary module:ol/extent~Extent object.\n * @return {boolean} Callback succeeded.\n * @template T\n */\nTileGrid.prototype.forEachTileCoordParentTileRange = function(tileCoord, callback, opt_this, opt_tileRange, opt_extent) {\n  let tileRange, x, y;\n  let tileCoordExtent = null;\n  let z = tileCoord[0] - 1;\n  if (this.zoomFactor_ === 2) {\n    x = tileCoord[1];\n    y = tileCoord[2];\n  } else {\n    tileCoordExtent = this.getTileCoordExtent(tileCoord, opt_extent);\n  }\n  while (z >= this.minZoom) {\n    if (this.zoomFactor_ === 2) {\n      x = Math.floor(x / 2);\n      y = Math.floor(y / 2);\n      tileRange = createOrUpdateTileRange(x, x, y, y, opt_tileRange);\n    } else {\n      tileRange = this.getTileRangeForExtentAndZ(tileCoordExtent, z, opt_tileRange);\n    }\n    if (callback.call(opt_this, z, tileRange)) {\n      return true;\n    }\n    --z;\n  }\n  return false;\n};\n\n\n/**\n * Get the extent for this tile grid, if it was configured.\n * @return {module:ol/extent~Extent} Extent.\n */\nTileGrid.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n\n/**\n * Get the maximum zoom level for the grid.\n * @return {number} Max zoom.\n * @api\n */\nTileGrid.prototype.getMaxZoom = function() {\n  return this.maxZoom;\n};\n\n\n/**\n * Get the minimum zoom level for the grid.\n * @return {number} Min zoom.\n * @api\n */\nTileGrid.prototype.getMinZoom = function() {\n  return this.minZoom;\n};\n\n\n/**\n * Get the origin for the grid at the given zoom level.\n * @param {number} z Integer zoom level.\n * @return {module:ol/coordinate~Coordinate} Origin.\n * @api\n */\nTileGrid.prototype.getOrigin = function(z) {\n  if (this.origin_) {\n    return this.origin_;\n  } else {\n    return this.origins_[z];\n  }\n};\n\n\n/**\n * Get the resolution for the given zoom level.\n * @param {number} z Integer zoom level.\n * @return {number} Resolution.\n * @api\n */\nTileGrid.prototype.getResolution = function(z) {\n  return this.resolutions_[z];\n};\n\n\n/**\n * Get the list of resolutions for the tile grid.\n * @return {Array.<number>} Resolutions.\n * @api\n */\nTileGrid.prototype.getResolutions = function() {\n  return this.resolutions_;\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileRange=} opt_tileRange Temporary module:ol/TileRange object.\n * @param {module:ol/extent~Extent=} opt_extent Temporary module:ol/extent~Extent object.\n * @return {module:ol/TileRange} Tile range.\n */\nTileGrid.prototype.getTileCoordChildTileRange = function(tileCoord, opt_tileRange, opt_extent) {\n  if (tileCoord[0] < this.maxZoom) {\n    if (this.zoomFactor_ === 2) {\n      const minX = tileCoord[1] * 2;\n      const minY = tileCoord[2] * 2;\n      return createOrUpdateTileRange(minX, minX + 1, minY, minY + 1, opt_tileRange);\n    }\n    const tileCoordExtent = this.getTileCoordExtent(tileCoord, opt_extent);\n    return this.getTileRangeForExtentAndZ(\n      tileCoordExtent, tileCoord[0] + 1, opt_tileRange);\n  }\n  return null;\n};\n\n\n/**\n * Get the extent for a tile range.\n * @param {number} z Integer zoom level.\n * @param {module:ol/TileRange} tileRange Tile range.\n * @param {module:ol/extent~Extent=} opt_extent Temporary module:ol/extent~Extent object.\n * @return {module:ol/extent~Extent} Extent.\n */\nTileGrid.prototype.getTileRangeExtent = function(z, tileRange, opt_extent) {\n  const origin = this.getOrigin(z);\n  const resolution = this.getResolution(z);\n  const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n  const minX = origin[0] + tileRange.minX * tileSize[0] * resolution;\n  const maxX = origin[0] + (tileRange.maxX + 1) * tileSize[0] * resolution;\n  const minY = origin[1] + tileRange.minY * tileSize[1] * resolution;\n  const maxY = origin[1] + (tileRange.maxY + 1) * tileSize[1] * resolution;\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n};\n\n\n/**\n * Get a tile range for the given extent and integer zoom level.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} z Integer zoom level.\n * @param {module:ol/TileRange=} opt_tileRange Temporary tile range object.\n * @return {module:ol/TileRange} Tile range.\n */\nTileGrid.prototype.getTileRangeForExtentAndZ = function(extent, z, opt_tileRange) {\n  const tileCoord = tmpTileCoord;\n  this.getTileCoordForXYAndZ_(extent[0], extent[1], z, false, tileCoord);\n  const minX = tileCoord[1];\n  const minY = tileCoord[2];\n  this.getTileCoordForXYAndZ_(extent[2], extent[3], z, true, tileCoord);\n  return createOrUpdateTileRange(minX, tileCoord[1], minY, tileCoord[2], opt_tileRange);\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @return {module:ol/coordinate~Coordinate} Tile center.\n */\nTileGrid.prototype.getTileCoordCenter = function(tileCoord) {\n  const origin = this.getOrigin(tileCoord[0]);\n  const resolution = this.getResolution(tileCoord[0]);\n  const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);\n  return [\n    origin[0] + (tileCoord[1] + 0.5) * tileSize[0] * resolution,\n    origin[1] + (tileCoord[2] + 0.5) * tileSize[1] * resolution\n  ];\n};\n\n\n/**\n * Get the extent of a tile coordinate.\n *\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/extent~Extent=} opt_extent Temporary extent object.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nTileGrid.prototype.getTileCoordExtent = function(tileCoord, opt_extent) {\n  const origin = this.getOrigin(tileCoord[0]);\n  const resolution = this.getResolution(tileCoord[0]);\n  const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);\n  const minX = origin[0] + tileCoord[1] * tileSize[0] * resolution;\n  const minY = origin[1] + tileCoord[2] * tileSize[1] * resolution;\n  const maxX = minX + tileSize[0] * resolution;\n  const maxY = minY + tileSize[1] * resolution;\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n};\n\n\n/**\n * Get the tile coordinate for the given map coordinate and resolution.  This\n * method considers that coordinates that intersect tile boundaries should be\n * assigned the higher tile coordinate.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Destination module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @api\n */\nTileGrid.prototype.getTileCoordForCoordAndResolution = function(coordinate, resolution, opt_tileCoord) {\n  return this.getTileCoordForXYAndResolution_(\n    coordinate[0], coordinate[1], resolution, false, opt_tileCoord);\n};\n\n\n/**\n * Note that this method should not be called for resolutions that correspond\n * to an integer zoom level.  Instead call the `getTileCoordForXYAndZ_` method.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} resolution Resolution (for a non-integer zoom level).\n * @param {boolean} reverseIntersectionPolicy Instead of letting edge\n *     intersections go to the higher tile coordinate, let edge intersections\n *     go to the lower tile coordinate.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Temporary module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @private\n */\nTileGrid.prototype.getTileCoordForXYAndResolution_ = function(\n  x, y, resolution, reverseIntersectionPolicy, opt_tileCoord) {\n  const z = this.getZForResolution(resolution);\n  const scale = resolution / this.getResolution(z);\n  const origin = this.getOrigin(z);\n  const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n\n  const adjustX = reverseIntersectionPolicy ? 0.5 : 0;\n  const adjustY = reverseIntersectionPolicy ? 0 : 0.5;\n  const xFromOrigin = Math.floor((x - origin[0]) / resolution + adjustX);\n  const yFromOrigin = Math.floor((y - origin[1]) / resolution + adjustY);\n  let tileCoordX = scale * xFromOrigin / tileSize[0];\n  let tileCoordY = scale * yFromOrigin / tileSize[1];\n\n  if (reverseIntersectionPolicy) {\n    tileCoordX = Math.ceil(tileCoordX) - 1;\n    tileCoordY = Math.ceil(tileCoordY) - 1;\n  } else {\n    tileCoordX = Math.floor(tileCoordX);\n    tileCoordY = Math.floor(tileCoordY);\n  }\n\n  return createOrUpdateTileCoord(z, tileCoordX, tileCoordY, opt_tileCoord);\n};\n\n\n/**\n * Although there is repetition between this method and `getTileCoordForXYAndResolution_`,\n * they should have separate implementations.  This method is for integer zoom\n * levels.  The other method should only be called for resolutions corresponding\n * to non-integer zoom levels.\n * @param {number} x Map x coordinate.\n * @param {number} y Map y coordinate.\n * @param {number} z Integer zoom level.\n * @param {boolean} reverseIntersectionPolicy Instead of letting edge\n *     intersections go to the higher tile coordinate, let edge intersections\n *     go to the lower tile coordinate.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Temporary module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @private\n */\nTileGrid.prototype.getTileCoordForXYAndZ_ = function(x, y, z, reverseIntersectionPolicy, opt_tileCoord) {\n  const origin = this.getOrigin(z);\n  const resolution = this.getResolution(z);\n  const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n\n  const adjustX = reverseIntersectionPolicy ? 0.5 : 0;\n  const adjustY = reverseIntersectionPolicy ? 0 : 0.5;\n  const xFromOrigin = Math.floor((x - origin[0]) / resolution + adjustX);\n  const yFromOrigin = Math.floor((y - origin[1]) / resolution + adjustY);\n  let tileCoordX = xFromOrigin / tileSize[0];\n  let tileCoordY = yFromOrigin / tileSize[1];\n\n  if (reverseIntersectionPolicy) {\n    tileCoordX = Math.ceil(tileCoordX) - 1;\n    tileCoordY = Math.ceil(tileCoordY) - 1;\n  } else {\n    tileCoordX = Math.floor(tileCoordX);\n    tileCoordY = Math.floor(tileCoordY);\n  }\n\n  return createOrUpdateTileCoord(z, tileCoordX, tileCoordY, opt_tileCoord);\n};\n\n\n/**\n * Get a tile coordinate given a map coordinate and zoom level.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} z Zoom level.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Destination module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @api\n */\nTileGrid.prototype.getTileCoordForCoordAndZ = function(coordinate, z, opt_tileCoord) {\n  return this.getTileCoordForXYAndZ_(\n    coordinate[0], coordinate[1], z, false, opt_tileCoord);\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @return {number} Tile resolution.\n */\nTileGrid.prototype.getTileCoordResolution = function(tileCoord) {\n  return this.resolutions_[tileCoord[0]];\n};\n\n\n/**\n * Get the tile size for a zoom level. The type of the return value matches the\n * `tileSize` or `tileSizes` that the tile grid was configured with. To always\n * get an `module:ol/size~Size`, run the result through `module:ol/size~Size.toSize()`.\n * @param {number} z Z.\n * @return {number|module:ol/size~Size} Tile size.\n * @api\n */\nTileGrid.prototype.getTileSize = function(z) {\n  if (this.tileSize_) {\n    return this.tileSize_;\n  } else {\n    return this.tileSizes_[z];\n  }\n};\n\n\n/**\n * @param {number} z Zoom level.\n * @return {module:ol/TileRange} Extent tile range for the specified zoom level.\n */\nTileGrid.prototype.getFullTileRange = function(z) {\n  if (!this.fullTileRanges_) {\n    return null;\n  } else {\n    return this.fullTileRanges_[z];\n  }\n};\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number=} opt_direction If 0, the nearest resolution will be used.\n *     If 1, the nearest lower resolution will be used. If -1, the nearest\n *     higher resolution will be used. Default is 0.\n * @return {number} Z.\n * @api\n */\nTileGrid.prototype.getZForResolution = function(resolution, opt_direction) {\n  const z = linearFindNearest(this.resolutions_, resolution, opt_direction || 0);\n  return clamp(z, this.minZoom, this.maxZoom);\n};\n\n\n/**\n * @param {!module:ol/extent~Extent} extent Extent for this tile grid.\n * @private\n */\nTileGrid.prototype.calculateTileRanges_ = function(extent) {\n  const length = this.resolutions_.length;\n  const fullTileRanges = new Array(length);\n  for (let z = this.minZoom; z < length; ++z) {\n    fullTileRanges[z] = this.getTileRangeForExtentAndZ(extent, z);\n  }\n  this.fullTileRanges_ = fullTileRanges;\n};\nexport default TileGrid;\n","/**\n * @module ol/tilegrid\n */\nimport {DEFAULT_MAX_ZOOM, DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {toSize} from './size.js';\nimport {containsCoordinate, createOrUpdate, getCorner, getHeight, getWidth} from './extent.js';\nimport Corner from './extent/Corner.js';\nimport {assign} from './obj.js';\nimport {get as getProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\nimport TileGrid from './tilegrid/TileGrid.js';\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/tilegrid/TileGrid} Default tile grid for the\n * passed projection.\n */\nexport function getForProjection(projection) {\n  let tileGrid = projection.getDefaultTileGrid();\n  if (!tileGrid) {\n    tileGrid = createForProjection(projection);\n    projection.setDefaultTileGrid(tileGrid);\n  }\n  return tileGrid;\n}\n\n\n/**\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n */\nexport function wrapX(tileGrid, tileCoord, projection) {\n  const z = tileCoord[0];\n  const center = tileGrid.getTileCoordCenter(tileCoord);\n  const projectionExtent = extentFromProjection(projection);\n  if (!containsCoordinate(projectionExtent, center)) {\n    const worldWidth = getWidth(projectionExtent);\n    const worldsAway = Math.ceil((projectionExtent[0] - center[0]) / worldWidth);\n    center[0] += worldWidth * worldsAway;\n    return tileGrid.getTileCoordForCoordAndZ(center, z);\n  } else {\n    return tileCoord;\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|module:ol/size~Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {module:ol/extent/Corner=} opt_corner Extent corner (default is `'top-left'`).\n * @return {!module:ol/tilegrid/TileGrid} TileGrid instance.\n */\nexport function createForExtent(extent, opt_maxZoom, opt_tileSize, opt_corner) {\n  const corner = opt_corner !== undefined ? opt_corner : Corner.TOP_LEFT;\n\n  const resolutions = resolutionsFromExtent(extent, opt_maxZoom, opt_tileSize);\n\n  return new TileGrid({\n    extent: extent,\n    origin: getCorner(extent, corner),\n    resolutions: resolutions,\n    tileSize: opt_tileSize\n  });\n}\n\n\n/**\n * @typedef {Object} XYZOptions\n * @property {module:ol/extent~Extent} [extent] Extent for the tile grid. The origin for an XYZ tile grid is the\n * top-left corner of the extent. The zero level of the grid is defined by the resolution at which one tile fits in the\n * provided extent. If not provided, the extent of the EPSG:3857 projection is used.\n * @property {number} [maxZoom] Maximum zoom. The default is `42`. This determines the number of levels\n * in the grid set. For example, a `maxZoom` of 21 means there are 22 levels in the grid set.\n * @property {number} [minZoom=0] Minimum zoom.\n * @property {number|module:ol/size~Size} [tileSize=[256, 256]] Tile size in pixels.\n */\n\n\n/**\n * Creates a tile grid with a standard XYZ tiling scheme.\n * @param {module:ol/tilegrid~XYZOptions=} opt_options Tile grid options.\n * @return {!module:ol/tilegrid/TileGrid} Tile grid instance.\n * @api\n */\nexport function createXYZ(opt_options) {\n  const options = /** @type {module:ol/tilegrid/TileGrid~Options} */ ({});\n  assign(options, opt_options !== undefined ?\n    opt_options : /** @type {module:ol/tilegrid~XYZOptions} */ ({}));\n  if (options.extent === undefined) {\n    options.extent = getProjection('EPSG:3857').getExtent();\n  }\n  options.resolutions = resolutionsFromExtent(\n    options.extent, options.maxZoom, options.tileSize);\n  delete options.maxZoom;\n\n  return new TileGrid(options);\n}\n\n\n/**\n * Create a resolutions array from an extent.  A zoom factor of 2 is assumed.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|module:ol/size~Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @return {!Array.<number>} Resolutions array.\n */\nfunction resolutionsFromExtent(extent, opt_maxZoom, opt_tileSize) {\n  const maxZoom = opt_maxZoom !== undefined ?\n    opt_maxZoom : DEFAULT_MAX_ZOOM;\n\n  const height = getHeight(extent);\n  const width = getWidth(extent);\n\n  const tileSize = toSize(opt_tileSize !== undefined ?\n    opt_tileSize : DEFAULT_TILE_SIZE);\n  const maxResolution = Math.max(\n    width / tileSize[0], height / tileSize[1]);\n\n  const length = maxZoom + 1;\n  const resolutions = new Array(length);\n  for (let z = 0; z < length; ++z) {\n    resolutions[z] = maxResolution / Math.pow(2, z);\n  }\n  return resolutions;\n}\n\n\n/**\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|module:ol/size~Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {module:ol/extent/Corner=} opt_corner Extent corner (default is `'top-left'`).\n * @return {!module:ol/tilegrid/TileGrid} TileGrid instance.\n */\nexport function createForProjection(projection, opt_maxZoom, opt_tileSize, opt_corner) {\n  const extent = extentFromProjection(projection);\n  return createForExtent(extent, opt_maxZoom, opt_tileSize, opt_corner);\n}\n\n\n/**\n * Generate a tile grid extent from a projection.  If the projection has an\n * extent, it is used.  If not, a global extent is assumed.\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extentFromProjection(projection) {\n  projection = getProjection(projection);\n  let extent = projection.getExtent();\n  if (!extent) {\n    const half = 180 * METERS_PER_UNIT[Units.DEGREES] / projection.getMetersPerUnit();\n    extent = createOrUpdate(-half, -half, half, half);\n  }\n  return extent;\n}\n","/**\n * @module ol/source/Tile\n */\nimport {inherits} from '../index.js';\nimport {UNDEFINED} from '../functions.js';\nimport TileCache from '../TileCache.js';\nimport TileState from '../TileState.js';\nimport Event from '../events/Event.js';\nimport {equivalent} from '../proj.js';\nimport {toSize, scale as scaleSize} from '../size.js';\nimport Source from '../source/Source.js';\nimport {getKeyZXY, withinExtentAndZ} from '../tilecoord.js';\nimport {wrapX, getForProjection as getTileGridForProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {number} [cacheSize]\n * @property {module:ol/extent~Extent} [extent]\n * @property {boolean} [opaque]\n * @property {number} [tilePixelRatio]\n * @property {module:ol/proj~ProjectionLike} [projection]\n * @property {module:ol/source/State} [state]\n * @property {module:ol/tilegrid/TileGrid} [tileGrid]\n * @property {boolean} [wrapX=true]\n * @property {number} [transition]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing images divided into a tile grid.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/source/Source}\n * @param {module:ol/source/Tile~Options=} options SourceTile source options.\n * @api\n */\nconst TileSource = function(options) {\n\n  Source.call(this, {\n    attributions: options.attributions,\n    extent: options.extent,\n    projection: options.projection,\n    state: options.state,\n    wrapX: options.wrapX\n  });\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.opaque_ = options.opaque !== undefined ? options.opaque : false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tilePixelRatio_ = options.tilePixelRatio !== undefined ?\n    options.tilePixelRatio : 1;\n\n  /**\n   * @protected\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.tileGrid = options.tileGrid !== undefined ? options.tileGrid : null;\n\n  /**\n   * @protected\n   * @type {module:ol/TileCache}\n   */\n  this.tileCache = new TileCache(options.cacheSize);\n\n  /**\n   * @protected\n   * @type {module:ol/size~Size}\n   */\n  this.tmpSize = [0, 0];\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.key_ = '';\n\n  /**\n   * @protected\n   * @type {module:ol/Tile~Options}\n   */\n  this.tileOptions = {transition: options.transition};\n\n};\n\ninherits(TileSource, Source);\n\n\n/**\n * @return {boolean} Can expire cache.\n */\nTileSource.prototype.canExpireCache = function() {\n  return this.tileCache.canExpireCache();\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {!Object.<string, module:ol/TileRange>} usedTiles Used tiles.\n */\nTileSource.prototype.expireCache = function(projection, usedTiles) {\n  const tileCache = this.getTileCacheForProjection(projection);\n  if (tileCache) {\n    tileCache.expireCache(usedTiles);\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} z Zoom level.\n * @param {module:ol/TileRange} tileRange Tile range.\n * @param {function(module:ol/Tile):(boolean|undefined)} callback Called with each\n *     loaded tile.  If the callback returns `false`, the tile will not be\n *     considered loaded.\n * @return {boolean} The tile range is fully covered with loaded tiles.\n */\nTileSource.prototype.forEachLoadedTile = function(projection, z, tileRange, callback) {\n  const tileCache = this.getTileCacheForProjection(projection);\n  if (!tileCache) {\n    return false;\n  }\n\n  let covered = true;\n  let tile, tileCoordKey, loaded;\n  for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {\n    for (let y = tileRange.minY; y <= tileRange.maxY; ++y) {\n      tileCoordKey = getKeyZXY(z, x, y);\n      loaded = false;\n      if (tileCache.containsKey(tileCoordKey)) {\n        tile = /** @type {!module:ol/Tile} */ (tileCache.get(tileCoordKey));\n        loaded = tile.getState() === TileState.LOADED;\n        if (loaded) {\n          loaded = (callback(tile) !== false);\n        }\n      }\n      if (!loaded) {\n        covered = false;\n      }\n    }\n  }\n  return covered;\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {number} Gutter.\n */\nTileSource.prototype.getGutter = function(projection) {\n  return 0;\n};\n\n\n/**\n * Return the key to be used for all tiles in the source.\n * @return {string} The key for all tiles.\n * @protected\n */\nTileSource.prototype.getKey = function() {\n  return this.key_;\n};\n\n\n/**\n * Set the value to be used as the key for all tiles in the source.\n * @param {string} key The key for tiles.\n * @protected\n */\nTileSource.prototype.setKey = function(key) {\n  if (this.key_ !== key) {\n    this.key_ = key;\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {boolean} Opaque.\n */\nTileSource.prototype.getOpaque = function(projection) {\n  return this.opaque_;\n};\n\n\n/**\n * @inheritDoc\n */\nTileSource.prototype.getResolutions = function() {\n  return this.tileGrid.getResolutions();\n};\n\n\n/**\n * @abstract\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/Tile} Tile.\n */\nTileSource.prototype.getTile = function(z, x, y, pixelRatio, projection) {};\n\n\n/**\n * Return the tile grid of the tile source.\n * @return {module:ol/tilegrid/TileGrid} Tile grid.\n * @api\n */\nTileSource.prototype.getTileGrid = function() {\n  return this.tileGrid;\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/tilegrid/TileGrid} Tile grid.\n */\nTileSource.prototype.getTileGridForProjection = function(projection) {\n  if (!this.tileGrid) {\n    return getTileGridForProjection(projection);\n  } else {\n    return this.tileGrid;\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/TileCache} Tile cache.\n * @protected\n */\nTileSource.prototype.getTileCacheForProjection = function(projection) {\n  const thisProj = this.getProjection();\n  if (thisProj && !equivalent(thisProj, projection)) {\n    return null;\n  } else {\n    return this.tileCache;\n  }\n};\n\n\n/**\n * Get the tile pixel ratio for this source. Subclasses may override this\n * method, which is meant to return a supported pixel ratio that matches the\n * provided `pixelRatio` as close as possible.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Tile pixel ratio.\n */\nTileSource.prototype.getTilePixelRatio = function(pixelRatio) {\n  return this.tilePixelRatio_;\n};\n\n\n/**\n * @param {number} z Z.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/size~Size} Tile size.\n */\nTileSource.prototype.getTilePixelSize = function(z, pixelRatio, projection) {\n  const tileGrid = this.getTileGridForProjection(projection);\n  const tilePixelRatio = this.getTilePixelRatio(pixelRatio);\n  const tileSize = toSize(tileGrid.getTileSize(z), this.tmpSize);\n  if (tilePixelRatio == 1) {\n    return tileSize;\n  } else {\n    return scaleSize(tileSize, tilePixelRatio, this.tmpSize);\n  }\n};\n\n\n/**\n * Returns a tile coordinate wrapped around the x-axis. When the tile coordinate\n * is outside the resolution and extent range of the tile grid, `null` will be\n * returned.\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/proj/Projection=} opt_projection Projection.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate to be passed to the tileUrlFunction or\n *     null if no tile URL should be created for the passed `tileCoord`.\n */\nTileSource.prototype.getTileCoordForTileUrlFunction = function(tileCoord, opt_projection) {\n  const projection = opt_projection !== undefined ?\n    opt_projection : this.getProjection();\n  const tileGrid = this.getTileGridForProjection(projection);\n  if (this.getWrapX() && projection.isGlobal()) {\n    tileCoord = wrapX(tileGrid, tileCoord, projection);\n  }\n  return withinExtentAndZ(tileCoord, tileGrid) ? tileCoord : null;\n};\n\n\n/**\n * @inheritDoc\n */\nTileSource.prototype.refresh = function() {\n  this.tileCache.clear();\n  this.changed();\n};\n\n\n/**\n * Marks a tile coord as being used, without triggering a load.\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {module:ol/proj/Projection} projection Projection.\n */\nTileSource.prototype.useTile = UNDEFINED;\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Tile~TileSource} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Type.\n * @param {module:ol/Tile} tile The tile.\n */\nexport const TileSourceEvent = function(type, tile) {\n\n  Event.call(this, type);\n\n  /**\n   * The tile related to the event.\n   * @type {module:ol/Tile}\n   * @api\n   */\n  this.tile = tile;\n\n};\ninherits(TileSourceEvent, Event);\n\nexport default TileSource;\n","/**\n * @module ol/source/TileEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered when a tile starts loading.\n   * @event module:ol/source/Tile~TileSourceEvent#tileloadstart\n   * @api\n   */\n  TILELOADSTART: 'tileloadstart',\n\n  /**\n   * Triggered when a tile finishes loading, either when its data is loaded,\n   * or when loading was aborted because the tile is no longer needed.\n   * @event module:ol/source/Tile~TileSourceEvent#tileloadend\n   * @api\n   */\n  TILELOADEND: 'tileloadend',\n\n  /**\n   * Triggered if tile loading results in an error.\n   * @event module:ol/source/Tile~TileSourceEvent#tileloaderror\n   * @api\n   */\n  TILELOADERROR: 'tileloaderror'\n\n};\n","/**\n * @module ol/source/UrlTile\n */\nimport {getUid, inherits} from '../index.js';\nimport TileState from '../TileState.js';\nimport {expandUrl, createFromTemplates, nullTileUrlFunction} from '../tileurlfunction.js';\nimport TileSource, {TileSourceEvent} from '../source/Tile.js';\nimport TileEventType from '../source/TileEventType.js';\nimport {getKeyZXY} from '../tilecoord.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {number} [cacheSize]\n * @property {module:ol/extent~Extent} [extent]\n * @property {boolean} [opaque]\n * @property {module:ol/proj~ProjectionLike} [projection]\n * @property {module:ol/source/State} [state]\n * @property {module:ol/tilegrid/TileGrid} [tileGrid]\n * @property {module:ol/Tile~LoadFunction} tileLoadFunction\n * @property {number} [tilePixelRatio]\n * @property {module:ol/Tile~UrlFunction} [tileUrlFunction]\n * @property {string} [url]\n * @property {Array.<string>} [urls]\n * @property {boolean} [wrapX=true]\n * @property {number} [transition]\n */\n\n\n/**\n * @classdesc\n * Base class for sources providing tiles divided into a tile grid over http.\n *\n * @constructor\n * @abstract\n * @fires module:ol/source/TileEvent\n * @extends {module:ol/source/Tile}\n * @param {module:ol/source/UrlTile~Options=} options Image tile options.\n */\nconst UrlTile = function(options) {\n\n  TileSource.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    extent: options.extent,\n    opaque: options.opaque,\n    projection: options.projection,\n    state: options.state,\n    tileGrid: options.tileGrid,\n    tilePixelRatio: options.tilePixelRatio,\n    wrapX: options.wrapX,\n    transition: options.transition\n  });\n\n  /**\n   * @protected\n   * @type {module:ol/Tile~LoadFunction}\n   */\n  this.tileLoadFunction = options.tileLoadFunction;\n\n  /**\n   * @protected\n   * @type {module:ol/Tile~UrlFunction}\n   */\n  this.tileUrlFunction = this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) : nullTileUrlFunction;\n\n  /**\n   * @protected\n   * @type {!Array.<string>|null}\n   */\n  this.urls = null;\n\n  if (options.urls) {\n    this.setUrls(options.urls);\n  } else if (options.url) {\n    this.setUrl(options.url);\n  }\n  if (options.tileUrlFunction) {\n    this.setTileUrlFunction(options.tileUrlFunction);\n  }\n\n  /**\n   * @private\n   * @type {!Object.<number, boolean>}\n   */\n  this.tileLoadingKeys_ = {};\n\n};\n\ninherits(UrlTile, TileSource);\n\n\n/**\n * @type {module:ol/Tile~UrlFunction|undefined}\n * @protected\n */\nUrlTile.prototype.fixedTileUrlFunction;\n\n/**\n * Return the tile load function of the source.\n * @return {module:ol/Tile~LoadFunction} TileLoadFunction\n * @api\n */\nUrlTile.prototype.getTileLoadFunction = function() {\n  return this.tileLoadFunction;\n};\n\n\n/**\n * Return the tile URL function of the source.\n * @return {module:ol/Tile~UrlFunction} TileUrlFunction\n * @api\n */\nUrlTile.prototype.getTileUrlFunction = function() {\n  return this.tileUrlFunction;\n};\n\n\n/**\n * Return the URLs used for this source.\n * When a tileUrlFunction is used instead of url or urls,\n * null will be returned.\n * @return {!Array.<string>|null} URLs.\n * @api\n */\nUrlTile.prototype.getUrls = function() {\n  return this.urls;\n};\n\n\n/**\n * Handle tile change events.\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nUrlTile.prototype.handleTileChange = function(event) {\n  const tile = /** @type {module:ol/Tile} */ (event.target);\n  const uid = getUid(tile);\n  const tileState = tile.getState();\n  let type;\n  if (tileState == TileState.LOADING) {\n    this.tileLoadingKeys_[uid] = true;\n    type = TileEventType.TILELOADSTART;\n  } else if (uid in this.tileLoadingKeys_) {\n    delete this.tileLoadingKeys_[uid];\n    type = tileState == TileState.ERROR ? TileEventType.TILELOADERROR :\n      (tileState == TileState.LOADED || tileState == TileState.ABORT) ?\n        TileEventType.TILELOADEND : undefined;\n  }\n  if (type != undefined) {\n    this.dispatchEvent(new TileSourceEvent(type, tile));\n  }\n};\n\n\n/**\n * Set the tile load function of the source.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @api\n */\nUrlTile.prototype.setTileLoadFunction = function(tileLoadFunction) {\n  this.tileCache.clear();\n  this.tileLoadFunction = tileLoadFunction;\n  this.changed();\n};\n\n\n/**\n * Set the tile URL function of the source.\n * @param {module:ol/Tile~UrlFunction} tileUrlFunction Tile URL function.\n * @param {string=} opt_key Optional new tile key for the source.\n * @api\n */\nUrlTile.prototype.setTileUrlFunction = function(tileUrlFunction, opt_key) {\n  this.tileUrlFunction = tileUrlFunction;\n  this.tileCache.pruneExceptNewestZ();\n  if (typeof opt_key !== 'undefined') {\n    this.setKey(opt_key);\n  } else {\n    this.changed();\n  }\n};\n\n\n/**\n * Set the URL to use for requests.\n * @param {string} url URL.\n * @api\n */\nUrlTile.prototype.setUrl = function(url) {\n  const urls = this.urls = expandUrl(url);\n  this.setTileUrlFunction(this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) :\n    createFromTemplates(urls, this.tileGrid), url);\n};\n\n\n/**\n * Set the URLs to use for requests.\n * @param {Array.<string>} urls URLs.\n * @api\n */\nUrlTile.prototype.setUrls = function(urls) {\n  this.urls = urls;\n  const key = urls.join('\\n');\n  this.setTileUrlFunction(this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) :\n    createFromTemplates(urls, this.tileGrid), key);\n};\n\n\n/**\n * @inheritDoc\n */\nUrlTile.prototype.useTile = function(z, x, y) {\n  const tileCoordKey = getKeyZXY(z, x, y);\n  if (this.tileCache.containsKey(tileCoordKey)) {\n    this.tileCache.get(tileCoordKey);\n  }\n};\nexport default UrlTile;\n","/**\n * @module ol/source/TileImage\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../reproj/common.js';\nimport {getUid, inherits} from '../index.js';\nimport ImageTile from '../ImageTile.js';\nimport TileCache from '../TileCache.js';\nimport TileState from '../TileState.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {equivalent, get as getProjection} from '../proj.js';\nimport ReprojTile from '../reproj/Tile.js';\nimport UrlTile from '../source/UrlTile.js';\nimport {getKey, getKeyZXY} from '../tilecoord.js';\nimport {getForProjection as getTileGridForProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/source/State} [state] Source state.\n * @property {module:ol/ImageTile~TileClass} [tileClass] Class used to instantiate image tiles.\n * Default is {@link module:ol/ImageTile~ImageTile}.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service. For example, if the tile\n * service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {module:ol/Tile~UrlFunction} [tileUrlFunction] Optional function to get tile URL given a tile coordinate and the projection.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`, may be\n * used instead of defining each one separately in the `urls` option.\n * @property {Array.<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX] Whether to wrap the world horizontally. The default, is to\n * request out-of-bounds tiles from the server. When set to `false`, only one\n * world will be rendered. When set to `true`, tiles will be requested for one\n * world only, but they will be wrapped horizontally to render multiple worlds.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Base class for sources providing images divided into a tile grid.\n *\n * @constructor\n * @fires module:ol/source/Tile~TileSourceEvent\n * @extends {module:ol/source/UrlTile}\n * @param {module:ol/source/TileImage~Options=} options Image tile options.\n * @api\n */\nconst TileImage = function(options) {\n\n  UrlTile.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    extent: options.extent,\n    opaque: options.opaque,\n    projection: options.projection,\n    state: options.state,\n    tileGrid: options.tileGrid,\n    tileLoadFunction: options.tileLoadFunction ?\n      options.tileLoadFunction : defaultTileLoadFunction,\n    tilePixelRatio: options.tilePixelRatio,\n    tileUrlFunction: options.tileUrlFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX,\n    transition: options.transition\n  });\n\n  /**\n   * @protected\n   * @type {?string}\n   */\n  this.crossOrigin =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @protected\n   * @type {function(new: module:ol/ImageTile, module:ol/tilecoord~TileCoord, module:ol/TileState, string,\n   *        ?string, module:ol/Tile~LoadFunction, module:ol/Tile~Options=)}\n   */\n  this.tileClass = options.tileClass !== undefined ?\n    options.tileClass : ImageTile;\n\n  /**\n   * @protected\n   * @type {!Object.<string, module:ol/TileCache>}\n   */\n  this.tileCacheForProjection = {};\n\n  /**\n   * @protected\n   * @type {!Object.<string, module:ol/tilegrid/TileGrid>}\n   */\n  this.tileGridForProjection = {};\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.reprojectionErrorThreshold_ = options.reprojectionErrorThreshold;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderReprojectionEdges_ = false;\n};\n\ninherits(TileImage, UrlTile);\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.canExpireCache = function() {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    return UrlTile.prototype.canExpireCache.call(this);\n  }\n  if (this.tileCache.canExpireCache()) {\n    return true;\n  } else {\n    for (const key in this.tileCacheForProjection) {\n      if (this.tileCacheForProjection[key].canExpireCache()) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.expireCache = function(projection, usedTiles) {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    UrlTile.prototype.expireCache.call(this, projection, usedTiles);\n    return;\n  }\n  const usedTileCache = this.getTileCacheForProjection(projection);\n\n  this.tileCache.expireCache(this.tileCache == usedTileCache ? usedTiles : {});\n  for (const id in this.tileCacheForProjection) {\n    const tileCache = this.tileCacheForProjection[id];\n    tileCache.expireCache(tileCache == usedTileCache ? usedTiles : {});\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getGutter = function(projection) {\n  if (ENABLE_RASTER_REPROJECTION &&\n      this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {\n    return 0;\n  } else {\n    return this.getGutterInternal();\n  }\n};\n\n\n/**\n * @protected\n * @return {number} Gutter.\n */\nTileImage.prototype.getGutterInternal = function() {\n  return 0;\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getOpaque = function(projection) {\n  if (ENABLE_RASTER_REPROJECTION &&\n      this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {\n    return false;\n  } else {\n    return UrlTile.prototype.getOpaque.call(this, projection);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getTileGridForProjection = function(projection) {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    return UrlTile.prototype.getTileGridForProjection.call(this, projection);\n  }\n  const thisProj = this.getProjection();\n  if (this.tileGrid && (!thisProj || equivalent(thisProj, projection))) {\n    return this.tileGrid;\n  } else {\n    const projKey = getUid(projection).toString();\n    if (!(projKey in this.tileGridForProjection)) {\n      this.tileGridForProjection[projKey] = getTileGridForProjection(projection);\n    }\n    return (\n      /** @type {!module:ol/tilegrid/TileGrid} */ (this.tileGridForProjection[projKey])\n    );\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getTileCacheForProjection = function(projection) {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    return UrlTile.prototype.getTileCacheForProjection.call(this, projection);\n  }\n  const thisProj = this.getProjection(); if (!thisProj || equivalent(thisProj, projection)) {\n    return this.tileCache;\n  } else {\n    const projKey = getUid(projection).toString();\n    if (!(projKey in this.tileCacheForProjection)) {\n      this.tileCacheForProjection[projKey] = new TileCache(this.tileCache.highWaterMark);\n    }\n    return this.tileCacheForProjection[projKey];\n  }\n};\n\n\n/**\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {string} key The key set on the tile.\n * @return {!module:ol/Tile} Tile.\n * @private\n */\nTileImage.prototype.createTile_ = function(z, x, y, pixelRatio, projection, key) {\n  const tileCoord = [z, x, y];\n  const urlTileCoord = this.getTileCoordForTileUrlFunction(\n    tileCoord, projection);\n  const tileUrl = urlTileCoord ?\n    this.tileUrlFunction(urlTileCoord, pixelRatio, projection) : undefined;\n  const tile = new this.tileClass(\n    tileCoord,\n    tileUrl !== undefined ? TileState.IDLE : TileState.EMPTY,\n    tileUrl !== undefined ? tileUrl : '',\n    this.crossOrigin,\n    this.tileLoadFunction,\n    this.tileOptions);\n  tile.key = key;\n  listen(tile, EventType.CHANGE,\n    this.handleTileChange, this);\n  return tile;\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const sourceProjection = /** @type {!module:ol/proj/Projection} */ (this.getProjection());\n  if (!ENABLE_RASTER_REPROJECTION ||\n      !sourceProjection || !projection || equivalent(sourceProjection, projection)) {\n    return this.getTileInternal(z, x, y, pixelRatio, sourceProjection || projection);\n  } else {\n    const cache = this.getTileCacheForProjection(projection);\n    const tileCoord = [z, x, y];\n    let tile;\n    const tileCoordKey = getKey(tileCoord);\n    if (cache.containsKey(tileCoordKey)) {\n      tile = /** @type {!module:ol/Tile} */ (cache.get(tileCoordKey));\n    }\n    const key = this.getKey();\n    if (tile && tile.key == key) {\n      return tile;\n    } else {\n      const sourceTileGrid = this.getTileGridForProjection(sourceProjection);\n      const targetTileGrid = this.getTileGridForProjection(projection);\n      const wrappedTileCoord =\n          this.getTileCoordForTileUrlFunction(tileCoord, projection);\n      const newTile = new ReprojTile(\n        sourceProjection, sourceTileGrid,\n        projection, targetTileGrid,\n        tileCoord, wrappedTileCoord, this.getTilePixelRatio(pixelRatio),\n        this.getGutterInternal(),\n        function(z, x, y, pixelRatio) {\n          return this.getTileInternal(z, x, y, pixelRatio, sourceProjection);\n        }.bind(this), this.reprojectionErrorThreshold_,\n        this.renderReprojectionEdges_);\n      newTile.key = key;\n\n      if (tile) {\n        newTile.interimTile = tile;\n        newTile.refreshInterimChain();\n        cache.replace(tileCoordKey, newTile);\n      } else {\n        cache.set(tileCoordKey, newTile);\n      }\n      return newTile;\n    }\n  }\n};\n\n\n/**\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {!module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/Tile} Tile.\n * @protected\n */\nTileImage.prototype.getTileInternal = function(z, x, y, pixelRatio, projection) {\n  let tile = null;\n  const tileCoordKey = getKeyZXY(z, x, y);\n  const key = this.getKey();\n  if (!this.tileCache.containsKey(tileCoordKey)) {\n    tile = this.createTile_(z, x, y, pixelRatio, projection, key);\n    this.tileCache.set(tileCoordKey, tile);\n  } else {\n    tile = this.tileCache.get(tileCoordKey);\n    if (tile.key != key) {\n      // The source's params changed. If the tile has an interim tile and if we\n      // can use it then we use it. Otherwise we create a new tile.  In both\n      // cases we attempt to assign an interim tile to the new tile.\n      const interimTile = tile;\n      tile = this.createTile_(z, x, y, pixelRatio, projection, key);\n\n      //make the new tile the head of the list,\n      if (interimTile.getState() == TileState.IDLE) {\n        //the old tile hasn't begun loading yet, and is now outdated, so we can simply discard it\n        tile.interimTile = interimTile.interimTile;\n      } else {\n        tile.interimTile = interimTile;\n      }\n      tile.refreshInterimChain();\n      this.tileCache.replace(tileCoordKey, tile);\n    }\n  }\n  return tile;\n};\n\n\n/**\n * Sets whether to render reprojection edges or not (usually for debugging).\n * @param {boolean} render Render the edges.\n * @api\n */\nTileImage.prototype.setRenderReprojectionEdges = function(render) {\n  if (!ENABLE_RASTER_REPROJECTION ||\n      this.renderReprojectionEdges_ == render) {\n    return;\n  }\n  this.renderReprojectionEdges_ = render;\n  for (const id in this.tileCacheForProjection) {\n    this.tileCacheForProjection[id].clear();\n  }\n  this.changed();\n};\n\n\n/**\n * Sets the tile grid to use when reprojecting the tiles to the given\n * projection instead of the default tile grid for the projection.\n *\n * This can be useful when the default tile grid cannot be created\n * (e.g. projection has no extent defined) or\n * for optimization reasons (custom tile size, resolutions, ...).\n *\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @param {module:ol/tilegrid/TileGrid} tilegrid Tile grid to use for the projection.\n * @api\n */\nTileImage.prototype.setTileGridForProjection = function(projection, tilegrid) {\n  if (ENABLE_RASTER_REPROJECTION) {\n    const proj = getProjection(projection);\n    if (proj) {\n      const projKey = getUid(proj).toString();\n      if (!(projKey in this.tileGridForProjection)) {\n        this.tileGridForProjection[projKey] = tilegrid;\n      }\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/ImageTile} imageTile Image tile.\n * @param {string} src Source.\n */\nfunction defaultTileLoadFunction(imageTile, src) {\n  imageTile.getImage().src = src;\n}\n\nexport default TileImage;\n","/**\n * @module ol/source/BingMaps\n */\nimport {inherits} from '../index.js';\nimport {createFromTileUrlFunctions} from '../tileurlfunction.js';\nimport {applyTransform, intersects} from '../extent.js';\nimport {jsonp as requestJSONP} from '../net.js';\nimport {get as getProjection, getTransformFromProjections} from '../proj.js';\nimport SourceState from '../source/State.js';\nimport TileImage from '../source/TileImage.js';\nimport {createOrUpdate, quadKey} from '../tilecoord.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {number} [cacheSize=2048] Cache size.\n * @property {boolean} [hidpi=false] If `true` hidpi tiles will be requested.\n * @property {string} [culture='en-us'] Culture code.\n * @property {string} key Bing Maps API key. Get yours at http://www.bingmapsportal.com/.\n * @property {string} imagerySet Type of imagery.\n * @property {number} [maxZoom=21] Max zoom. Default is what's advertized by the BingMaps service.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n/**\n * @classdesc\n * Layer source for Bing Maps tile data.\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/BingMaps~Options=} options Bing Maps options.\n * @api\n */\nconst BingMaps = function(options) {\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hidpi_ = options.hidpi !== undefined ? options.hidpi : false;\n\n  TileImage.call(this, {\n    cacheSize: options.cacheSize,\n    crossOrigin: 'anonymous',\n    opaque: true,\n    projection: getProjection('EPSG:3857'),\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    state: SourceState.LOADING,\n    tileLoadFunction: options.tileLoadFunction,\n    tilePixelRatio: this.hidpi_ ? 2 : 1,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.culture_ = options.culture !== undefined ? options.culture : 'en-us';\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxZoom_ = options.maxZoom !== undefined ? options.maxZoom : -1;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.apiKey_ = options.key;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.imagerySet_ = options.imagerySet;\n\n  const url = 'https://dev.virtualearth.net/REST/v1/Imagery/Metadata/' +\n      this.imagerySet_ +\n      '?uriScheme=https&include=ImageryProviders&key=' + this.apiKey_ +\n      '&c=' + this.culture_;\n\n  requestJSONP(url, this.handleImageryMetadataResponse.bind(this), undefined,\n    'jsonp');\n\n};\n\ninherits(BingMaps, TileImage);\n\n\n/**\n * The attribution containing a link to the Microsoft® Bing™ Maps Platform APIs’\n * Terms Of Use.\n * @const\n * @type {string}\n */\nconst TOS_ATTRIBUTION = '<a class=\"ol-attribution-bing-tos\" ' +\n      'href=\"https://www.microsoft.com/maps/product/terms.html\">' +\n      'Terms of Use</a>';\n\n\n/**\n * Get the api key used for this source.\n *\n * @return {string} The api key.\n * @api\n */\nBingMaps.prototype.getApiKey = function() {\n  return this.apiKey_;\n};\n\n\n/**\n * Get the imagery set associated with this source.\n *\n * @return {string} The imagery set.\n * @api\n */\nBingMaps.prototype.getImagerySet = function() {\n  return this.imagerySet_;\n};\n\n\n/**\n * @param {BingMapsImageryMetadataResponse} response Response.\n */\nBingMaps.prototype.handleImageryMetadataResponse = function(response) {\n  if (response.statusCode != 200 ||\n      response.statusDescription != 'OK' ||\n      response.authenticationResultCode != 'ValidCredentials' ||\n      response.resourceSets.length != 1 ||\n      response.resourceSets[0].resources.length != 1) {\n    this.setState(SourceState.ERROR);\n    return;\n  }\n\n  const resource = response.resourceSets[0].resources[0];\n  const maxZoom = this.maxZoom_ == -1 ? resource.zoomMax : this.maxZoom_;\n\n  const sourceProjection = this.getProjection();\n  const extent = extentFromProjection(sourceProjection);\n  const tileSize = resource.imageWidth == resource.imageHeight ?\n    resource.imageWidth : [resource.imageWidth, resource.imageHeight];\n  const tileGrid = createXYZ({\n    extent: extent,\n    minZoom: resource.zoomMin,\n    maxZoom: maxZoom,\n    tileSize: tileSize / (this.hidpi_ ? 2 : 1)\n  });\n  this.tileGrid = tileGrid;\n\n  const culture = this.culture_;\n  const hidpi = this.hidpi_;\n  this.tileUrlFunction = createFromTileUrlFunctions(\n    resource.imageUrlSubdomains.map(function(subdomain) {\n      const quadKeyTileCoord = [0, 0, 0];\n      const imageUrl = resource.imageUrl\n        .replace('{subdomain}', subdomain)\n        .replace('{culture}', culture);\n      return (\n        /**\n         * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n         * @param {number} pixelRatio Pixel ratio.\n         * @param {module:ol/proj/Projection} projection Projection.\n         * @return {string|undefined} Tile URL.\n         */\n        function(tileCoord, pixelRatio, projection) {\n          if (!tileCoord) {\n            return undefined;\n          } else {\n            createOrUpdate(tileCoord[0], tileCoord[1], -tileCoord[2] - 1, quadKeyTileCoord);\n            let url = imageUrl;\n            if (hidpi) {\n              url += '&dpi=d1&device=mobile';\n            }\n            return url.replace('{quadkey}', quadKey(quadKeyTileCoord));\n          }\n        }\n      );\n    }));\n\n  if (resource.imageryProviders) {\n    const transform = getTransformFromProjections(\n      getProjection('EPSG:4326'), this.getProjection());\n\n    this.setAttributions(function(frameState) {\n      const attributions = [];\n      const zoom = frameState.viewState.zoom;\n      resource.imageryProviders.map(function(imageryProvider) {\n        let intersecting = false;\n        const coverageAreas = imageryProvider.coverageAreas;\n        for (let i = 0, ii = coverageAreas.length; i < ii; ++i) {\n          const coverageArea = coverageAreas[i];\n          if (zoom >= coverageArea.zoomMin && zoom <= coverageArea.zoomMax) {\n            const bbox = coverageArea.bbox;\n            const epsg4326Extent = [bbox[1], bbox[0], bbox[3], bbox[2]];\n            const extent = applyTransform(epsg4326Extent, transform);\n            if (intersects(extent, frameState.extent)) {\n              intersecting = true;\n              break;\n            }\n          }\n        }\n        if (intersecting) {\n          attributions.push(imageryProvider.attribution);\n        }\n      });\n\n      attributions.push(TOS_ATTRIBUTION);\n      return attributions;\n    });\n  }\n\n  this.setState(SourceState.READY);\n};\nexport default BingMaps;\n","/**\n * @module ol/source/XYZ\n */\nimport {inherits} from '../index.js';\nimport TileImage from '../source/TileImage.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857'] Projection.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {number} [maxZoom=18] Optional max zoom level.\n * @property {number} [minZoom=0] Optional min zoom level.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service.\n * For example, if the tile service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {number|module:ol/size~Size} [tileSize=[256, 256]] The tile size used by the tile service.\n * @property {module:ol/Tile~UrlFunction} [tileUrlFunction] Optional function to get\n * tile URL given a tile coordinate and the projection.\n * Required if url or urls are not provided.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`,\n * and `{z}` placeholders. A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`,\n * may be used instead of defining each one separately in the `urls` option.\n * @property {Array.<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data with URLs in a set XYZ format that are\n * defined in a URL template. By default, this follows the widely-used\n * Google grid where `x` 0 and `y` 0 are in the top left. Grids like\n * TMS where `x` 0 and `y` 0 are in the bottom left can be used by\n * using the `{-y}` placeholder in the URL template, so long as the\n * source does not have a custom tile grid. In this case,\n * {@link module:ol/source/TileImage} can be used with a `tileUrlFunction`\n * such as:\n *\n *  tileUrlFunction: function(coordinate) {\n *    return 'http://mapserver.com/' + coordinate[0] + '/' +\n *        coordinate[1] + '/' + coordinate[2] + '.png';\n *    }\n *\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/XYZ~Options=} opt_options XYZ options.\n * @api\n */\nconst XYZ = function(opt_options) {\n  const options = opt_options || {};\n  const projection = options.projection !== undefined ?\n    options.projection : 'EPSG:3857';\n\n  const tileGrid = options.tileGrid !== undefined ? options.tileGrid :\n    createXYZ({\n      extent: extentFromProjection(projection),\n      maxZoom: options.maxZoom,\n      minZoom: options.minZoom,\n      tileSize: options.tileSize\n    });\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    opaque: options.opaque,\n    projection: projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileGrid: tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    tilePixelRatio: options.tilePixelRatio,\n    tileUrlFunction: options.tileUrlFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n};\n\ninherits(XYZ, TileImage);\nexport default XYZ;\n","/**\n * @module ol/source/CartoDB\n */\nimport {inherits} from '../index.js';\nimport {assign} from '../obj.js';\nimport SourceState from '../source/State.js';\nimport XYZ from '../source/XYZ.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857'] Projection.\n * @property {number} [maxZoom=18] Max zoom.\n * @property {number} [minZoom] Minimum zoom.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {Object} [config] If using anonymous maps, the CartoDB config to use. See\n * {@link http://docs.cartodb.com/cartodb-platform/maps-api/anonymous-maps/}\n * for more detail.\n * If using named maps, a key-value lookup with the template parameters.\n * See {@link http://docs.cartodb.com/cartodb-platform/maps-api/named-maps/}\n * for more detail.\n * @property {string} [map] If using named maps, this will be the name of the template to load.\n * See {@link http://docs.cartodb.com/cartodb-platform/maps-api/named-maps/}\n * for more detail.\n * @property {string} account If using named maps, this will be the name of the template to load.\n */\n\n\n/**\n * @classdesc\n * Layer source for the CartoDB Maps API.\n *\n * @constructor\n * @extends {module:ol/source/XYZ}\n * @param {module:ol/source/CartoDB~Options=} options CartoDB options.\n * @api\n */\nconst CartoDB = function(options) {\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.account_ = options.account;\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.mapId_ = options.map || '';\n\n  /**\n   * @type {!Object}\n   * @private\n   */\n  this.config_ = options.config || {};\n\n  /**\n   * @type {!Object.<string, CartoDBLayerInfo>}\n   * @private\n   */\n  this.templateCache_ = {};\n\n  XYZ.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    maxZoom: options.maxZoom !== undefined ? options.maxZoom : 18,\n    minZoom: options.minZoom,\n    projection: options.projection,\n    state: SourceState.LOADING,\n    wrapX: options.wrapX\n  });\n  this.initializeMap_();\n};\n\ninherits(CartoDB, XYZ);\n\n\n/**\n * Returns the current config.\n * @return {!Object} The current configuration.\n * @api\n */\nCartoDB.prototype.getConfig = function() {\n  return this.config_;\n};\n\n\n/**\n * Updates the carto db config.\n * @param {Object} config a key-value lookup. Values will replace current values\n *     in the config.\n * @api\n */\nCartoDB.prototype.updateConfig = function(config) {\n  assign(this.config_, config);\n  this.initializeMap_();\n};\n\n\n/**\n * Sets the CartoDB config\n * @param {Object} config In the case of anonymous maps, a CartoDB configuration\n *     object.\n * If using named maps, a key-value lookup with the template parameters.\n * @api\n */\nCartoDB.prototype.setConfig = function(config) {\n  this.config_ = config || {};\n  this.initializeMap_();\n};\n\n\n/**\n * Issue a request to initialize the CartoDB map.\n * @private\n */\nCartoDB.prototype.initializeMap_ = function() {\n  const paramHash = JSON.stringify(this.config_);\n  if (this.templateCache_[paramHash]) {\n    this.applyTemplate_(this.templateCache_[paramHash]);\n    return;\n  }\n  let mapUrl = 'https://' + this.account_ + '.carto.com/api/v1/map';\n\n  if (this.mapId_) {\n    mapUrl += '/named/' + this.mapId_;\n  }\n\n  const client = new XMLHttpRequest();\n  client.addEventListener('load', this.handleInitResponse_.bind(this, paramHash));\n  client.addEventListener('error', this.handleInitError_.bind(this));\n  client.open('POST', mapUrl);\n  client.setRequestHeader('Content-type', 'application/json');\n  client.send(JSON.stringify(this.config_));\n};\n\n\n/**\n * Handle map initialization response.\n * @param {string} paramHash a hash representing the parameter set that was used\n *     for the request\n * @param {Event} event Event.\n * @private\n */\nCartoDB.prototype.handleInitResponse_ = function(paramHash, event) {\n  const client = /** @type {XMLHttpRequest} */ (event.target);\n  // status will be 0 for file:// urls\n  if (!client.status || client.status >= 200 && client.status < 300) {\n    let response;\n    try {\n      response = /** @type {CartoDBLayerInfo} */(JSON.parse(client.responseText));\n    } catch (err) {\n      this.setState(SourceState.ERROR);\n      return;\n    }\n    this.applyTemplate_(response);\n    this.templateCache_[paramHash] = response;\n    this.setState(SourceState.READY);\n  } else {\n    this.setState(SourceState.ERROR);\n  }\n};\n\n\n/**\n * @private\n * @param {Event} event Event.\n */\nCartoDB.prototype.handleInitError_ = function(event) {\n  this.setState(SourceState.ERROR);\n};\n\n\n/**\n * Apply the new tile urls returned by carto db\n * @param {CartoDBLayerInfo} data Result of carto db call.\n * @private\n */\nCartoDB.prototype.applyTemplate_ = function(data) {\n  const tilesUrl = 'https://' + data.cdn_url.https + '/' + this.account_ +\n      '/api/v1/map/' + data.layergroupid + '/{z}/{x}/{y}.png';\n  this.setUrl(tilesUrl);\n};\nexport default CartoDB;\n","/**\n * @module ol/source/Cluster\n */\n\nimport {getUid, inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport Feature from '../Feature.js';\nimport {scale as scaleCoordinate, add as addCoordinate} from '../coordinate.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {buffer, createEmpty, createOrUpdateFromCoordinate} from '../extent.js';\nimport Point from '../geom/Point.js';\nimport VectorSource from '../source/Vector.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [distance=20] Minimum distance in pixels between clusters.\n * @property {module:ol/extent~Extent} [extent] Extent.\n * @property {function(module:ol/Feature):module:ol/geom/Point} [geometryFunction]\n * Function that takes an {@link module:ol/Feature} as argument and returns an\n * {@link module:ol/geom/Point} as cluster calculation point for the feature. When a\n * feature should not be considered for clustering, the function should return\n * `null`. The default, which works when the underyling source contains point\n * features only, is\n * ```js\n * function(feature) {\n *   return feature.getGeometry();\n * }\n * ```\n * See {@link module:ol/geom/Polygon~Polygon#getInteriorPoint} for a way to get a cluster\n * calculation point for polygons.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {module:ol/source/Vector} source Source.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer source to cluster vector data. Works out of the box with point\n * geometries. For other geometry types, or if not all geometries should be\n * considered for clustering, a custom `geometryFunction` can be defined.\n *\n * @constructor\n * @param {module:ol/source/Cluster~Options=} options Cluster options.\n * @extends {module:ol/source/Vector}\n * @api\n */\nconst Cluster = function(options) {\n  VectorSource.call(this, {\n    attributions: options.attributions,\n    extent: options.extent,\n    projection: options.projection,\n    wrapX: options.wrapX\n  });\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.resolution = undefined;\n\n  /**\n   * @type {number}\n   * @protected\n   */\n  this.distance = options.distance !== undefined ? options.distance : 20;\n\n  /**\n   * @type {Array.<module:ol/Feature>}\n   * @protected\n   */\n  this.features = [];\n\n  /**\n   * @param {module:ol/Feature} feature Feature.\n   * @return {module:ol/geom/Point} Cluster calculation point.\n   * @protected\n   */\n  this.geometryFunction = options.geometryFunction || function(feature) {\n    const geometry = /** @type {module:ol/geom/Point} */ (feature.getGeometry());\n    assert(geometry instanceof Point,\n      10); // The default `geometryFunction` can only handle `module:ol/geom/Point~Point` geometries\n    return geometry;\n  };\n\n  /**\n   * @type {module:ol/source/Vector}\n   * @protected\n   */\n  this.source = options.source;\n\n  listen(this.source, EventType.CHANGE, this.refresh, this);\n};\n\ninherits(Cluster, VectorSource);\n\n\n/**\n * Get the distance in pixels between clusters.\n * @return {number} Distance.\n * @api\n */\nCluster.prototype.getDistance = function() {\n  return this.distance;\n};\n\n\n/**\n * Get a reference to the wrapped source.\n * @return {module:ol/source/Vector} Source.\n * @api\n */\nCluster.prototype.getSource = function() {\n  return this.source;\n};\n\n\n/**\n * @inheritDoc\n */\nCluster.prototype.loadFeatures = function(extent, resolution, projection) {\n  this.source.loadFeatures(extent, resolution, projection);\n  if (resolution !== this.resolution) {\n    this.clear();\n    this.resolution = resolution;\n    this.cluster();\n    this.addFeatures(this.features);\n  }\n};\n\n\n/**\n * Set the distance in pixels between clusters.\n * @param {number} distance The distance in pixels.\n * @api\n */\nCluster.prototype.setDistance = function(distance) {\n  this.distance = distance;\n  this.refresh();\n};\n\n\n/**\n * handle the source changing\n * @override\n */\nCluster.prototype.refresh = function() {\n  this.clear();\n  this.cluster();\n  this.addFeatures(this.features);\n  VectorSource.prototype.refresh.call(this);\n};\n\n\n/**\n * @protected\n */\nCluster.prototype.cluster = function() {\n  if (this.resolution === undefined) {\n    return;\n  }\n  this.features.length = 0;\n  const extent = createEmpty();\n  const mapDistance = this.distance * this.resolution;\n  const features = this.source.getFeatures();\n\n  /**\n   * @type {!Object.<string, boolean>}\n   */\n  const clustered = {};\n\n  for (let i = 0, ii = features.length; i < ii; i++) {\n    const feature = features[i];\n    if (!(getUid(feature).toString() in clustered)) {\n      const geometry = this.geometryFunction(feature);\n      if (geometry) {\n        const coordinates = geometry.getCoordinates();\n        createOrUpdateFromCoordinate(coordinates, extent);\n        buffer(extent, mapDistance, extent);\n\n        let neighbors = this.source.getFeaturesInExtent(extent);\n        neighbors = neighbors.filter(function(neighbor) {\n          const uid = getUid(neighbor).toString();\n          if (!(uid in clustered)) {\n            clustered[uid] = true;\n            return true;\n          } else {\n            return false;\n          }\n        });\n        this.features.push(this.createCluster(neighbors));\n      }\n    }\n  }\n};\n\n\n/**\n * @param {Array.<module:ol/Feature>} features Features\n * @return {module:ol/Feature} The cluster feature.\n * @protected\n */\nCluster.prototype.createCluster = function(features) {\n  const centroid = [0, 0];\n  for (let i = features.length - 1; i >= 0; --i) {\n    const geometry = this.geometryFunction(features[i]);\n    if (geometry) {\n      addCoordinate(centroid, geometry.getCoordinates());\n    } else {\n      features.splice(i, 1);\n    }\n  }\n  scaleCoordinate(centroid, 1 / features.length);\n\n  const cluster = new Feature(new Point(centroid));\n  cluster.set('features', features);\n  return cluster;\n};\nexport default Cluster;\n","/**\n * @module ol/reproj/Image\n */\nimport {ERROR_THRESHOLD} from './common.js';\nimport {inherits} from '../index.js';\nimport ImageBase from '../ImageBase.js';\nimport ImageState from '../ImageState.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getCenter, getIntersection, getHeight, getWidth} from '../extent.js';\nimport {calculateSourceResolution, render as renderReprojected} from '../reproj.js';\nimport Triangulation from '../reproj/Triangulation.js';\n\n\n/**\n * @typedef {function(module:ol/extent~Extent, number, number) : module:ol/ImageBase} FunctionType\n */\n\n\n/**\n * @classdesc\n * Class encapsulating single reprojected image.\n * See {@link module:ol/source/Image~ImageSource}.\n *\n * @constructor\n * @extends {module:ol/ImageBase}\n * @param {module:ol/proj/Projection} sourceProj Source projection (of the data).\n * @param {module:ol/proj/Projection} targetProj Target projection.\n * @param {module:ol/extent~Extent} targetExtent Target extent.\n * @param {number} targetResolution Target resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/reproj/Image~FunctionType} getImageFunction\n *     Function returning source images (extent, resolution, pixelRatio).\n */\nconst ReprojImage = function(sourceProj, targetProj,\n  targetExtent, targetResolution, pixelRatio, getImageFunction) {\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.targetProj_ = targetProj;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxSourceExtent_ = sourceProj.getExtent();\n  const maxTargetExtent = targetProj.getExtent();\n\n  const limitedTargetExtent = maxTargetExtent ?\n    getIntersection(targetExtent, maxTargetExtent) : targetExtent;\n\n  const targetCenter = getCenter(limitedTargetExtent);\n  const sourceResolution = calculateSourceResolution(\n    sourceProj, targetProj, targetCenter, targetResolution);\n\n  const errorThresholdInPixels = ERROR_THRESHOLD;\n\n  /**\n   * @private\n   * @type {!module:ol/reproj/Triangulation}\n   */\n  this.triangulation_ = new Triangulation(\n    sourceProj, targetProj, limitedTargetExtent, this.maxSourceExtent_,\n    sourceResolution * errorThresholdInPixels);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.targetResolution_ = targetResolution;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.targetExtent_ = targetExtent;\n\n  const sourceExtent = this.triangulation_.calculateSourceExtent();\n\n  /**\n   * @private\n   * @type {module:ol/ImageBase}\n   */\n  this.sourceImage_ =\n      getImageFunction(sourceExtent, sourceResolution, pixelRatio);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.sourcePixelRatio_ =\n      this.sourceImage_ ? this.sourceImage_.getPixelRatio() : 1;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.sourceListenerKey_ = null;\n\n\n  let state = ImageState.LOADED;\n\n  if (this.sourceImage_) {\n    state = ImageState.IDLE;\n  }\n\n  ImageBase.call(this, targetExtent, targetResolution, this.sourcePixelRatio_, state);\n};\n\ninherits(ReprojImage, ImageBase);\n\n\n/**\n * @inheritDoc\n */\nReprojImage.prototype.disposeInternal = function() {\n  if (this.state == ImageState.LOADING) {\n    this.unlistenSource_();\n  }\n  ImageBase.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nReprojImage.prototype.getImage = function() {\n  return this.canvas_;\n};\n\n\n/**\n * @return {module:ol/proj/Projection} Projection.\n */\nReprojImage.prototype.getProjection = function() {\n  return this.targetProj_;\n};\n\n\n/**\n * @private\n */\nReprojImage.prototype.reproject_ = function() {\n  const sourceState = this.sourceImage_.getState();\n  if (sourceState == ImageState.LOADED) {\n    const width = getWidth(this.targetExtent_) / this.targetResolution_;\n    const height = getHeight(this.targetExtent_) / this.targetResolution_;\n\n    this.canvas_ = renderReprojected(width, height, this.sourcePixelRatio_,\n      this.sourceImage_.getResolution(), this.maxSourceExtent_,\n      this.targetResolution_, this.targetExtent_, this.triangulation_, [{\n        extent: this.sourceImage_.getExtent(),\n        image: this.sourceImage_.getImage()\n      }], 0);\n  }\n  this.state = sourceState;\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nReprojImage.prototype.load = function() {\n  if (this.state == ImageState.IDLE) {\n    this.state = ImageState.LOADING;\n    this.changed();\n\n    const sourceState = this.sourceImage_.getState();\n    if (sourceState == ImageState.LOADED || sourceState == ImageState.ERROR) {\n      this.reproject_();\n    } else {\n      this.sourceListenerKey_ = listen(this.sourceImage_,\n        EventType.CHANGE, function(e) {\n          const sourceState = this.sourceImage_.getState();\n          if (sourceState == ImageState.LOADED || sourceState == ImageState.ERROR) {\n            this.unlistenSource_();\n            this.reproject_();\n          }\n        }, this);\n      this.sourceImage_.load();\n    }\n  }\n};\n\n\n/**\n * @private\n */\nReprojImage.prototype.unlistenSource_ = function() {\n  unlistenByKey(/** @type {!module:ol/events~EventsKey} */ (this.sourceListenerKey_));\n  this.sourceListenerKey_ = null;\n};\nexport default ReprojImage;\n","/**\n * @module ol/source/Image\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../reproj/common.js';\nimport {inherits} from '../index.js';\nimport ImageState from '../ImageState.js';\nimport {linearFindNearest} from '../array.js';\nimport Event from '../events/Event.js';\nimport {equals} from '../extent.js';\nimport {equivalent} from '../proj.js';\nimport ReprojImage from '../reproj/Image.js';\nimport Source from '../source/Source.js';\n\n\n/**\n * @enum {string}\n */\nconst ImageSourceEventType = {\n\n  /**\n   * Triggered when an image starts loading.\n   * @event ol/source/Image~ImageSourceEvent#imageloadstart\n   * @api\n   */\n  IMAGELOADSTART: 'imageloadstart',\n\n  /**\n   * Triggered when an image finishes loading.\n   * @event ol/source/Image~ImageSourceEvent#imageloadend\n   * @api\n   */\n  IMAGELOADEND: 'imageloadend',\n\n  /**\n   * Triggered if image loading results in an error.\n   * @event ol/source/Image~ImageSourceEvent#imageloaderror\n   * @api\n   */\n  IMAGELOADERROR: 'imageloaderror'\n\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Image~ImageSource} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Type.\n * @param {module:ol/Image} image The image.\n */\nconst ImageSourceEvent = function(type, image) {\n\n  Event.call(this, type);\n\n  /**\n   * The image related to the event.\n   * @type {module:ol/Image}\n   * @api\n   */\n  this.image = image;\n\n};\ninherits(ImageSourceEvent, Event);\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {module:ol/extent~Extent} [extent]\n * @property {module:ol/proj~ProjectionLike} projection\n * @property {Array.<number>} [resolutions]\n * @property {module:ol/source/State} [state]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing a single image.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/source/Source}\n * @param {module:ol/source/Image~Options} options Single image source options.\n * @api\n */\nconst ImageSource = function(options) {\n  Source.call(this, {\n    attributions: options.attributions,\n    extent: options.extent,\n    projection: options.projection,\n    state: options.state\n  });\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.resolutions_ = options.resolutions !== undefined ?\n    options.resolutions : null;\n\n\n  /**\n   * @private\n   * @type {module:ol/reproj/Image}\n   */\n  this.reprojectedImage_ = null;\n\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.reprojectedRevision_ = 0;\n};\n\ninherits(ImageSource, Source);\n\n\n/**\n * @return {Array.<number>} Resolutions.\n * @override\n */\nImageSource.prototype.getResolutions = function() {\n  return this.resolutions_;\n};\n\n\n/**\n * @protected\n * @param {number} resolution Resolution.\n * @return {number} Resolution.\n */\nImageSource.prototype.findNearestResolution = function(resolution) {\n  if (this.resolutions_) {\n    const idx = linearFindNearest(this.resolutions_, resolution, 0);\n    resolution = this.resolutions_[idx];\n  }\n  return resolution;\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/ImageBase} Single image.\n */\nImageSource.prototype.getImage = function(extent, resolution, pixelRatio, projection) {\n  const sourceProjection = this.getProjection();\n  if (!ENABLE_RASTER_REPROJECTION ||\n      !sourceProjection ||\n      !projection ||\n      equivalent(sourceProjection, projection)) {\n    if (sourceProjection) {\n      projection = sourceProjection;\n    }\n    return this.getImageInternal(extent, resolution, pixelRatio, projection);\n  } else {\n    if (this.reprojectedImage_) {\n      if (this.reprojectedRevision_ == this.getRevision() &&\n          equivalent(\n            this.reprojectedImage_.getProjection(), projection) &&\n          this.reprojectedImage_.getResolution() == resolution &&\n          equals(this.reprojectedImage_.getExtent(), extent)) {\n        return this.reprojectedImage_;\n      }\n      this.reprojectedImage_.dispose();\n      this.reprojectedImage_ = null;\n    }\n\n    this.reprojectedImage_ = new ReprojImage(\n      sourceProjection, projection, extent, resolution, pixelRatio,\n      function(extent, resolution, pixelRatio) {\n        return this.getImageInternal(extent, resolution,\n          pixelRatio, sourceProjection);\n      }.bind(this));\n    this.reprojectedRevision_ = this.getRevision();\n\n    return this.reprojectedImage_;\n  }\n};\n\n\n/**\n * @abstract\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/ImageBase} Single image.\n * @protected\n */\nImageSource.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {};\n\n\n/**\n * Handle image change events.\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nImageSource.prototype.handleImageChange = function(event) {\n  const image = /** @type {module:ol/Image} */ (event.target);\n  switch (image.getState()) {\n    case ImageState.LOADING:\n      this.dispatchEvent(\n        new ImageSourceEvent(ImageSourceEventType.IMAGELOADSTART,\n          image));\n      break;\n    case ImageState.LOADED:\n      this.dispatchEvent(\n        new ImageSourceEvent(ImageSourceEventType.IMAGELOADEND,\n          image));\n      break;\n    case ImageState.ERROR:\n      this.dispatchEvent(\n        new ImageSourceEvent(ImageSourceEventType.IMAGELOADERROR,\n          image));\n      break;\n    default:\n      // pass\n  }\n};\n\n\n/**\n * Default image load function for image sources that use module:ol/Image~Image image\n * instances.\n * @param {module:ol/Image} image Image.\n * @param {string} src Source.\n */\nexport function defaultImageLoadFunction(image, src) {\n  image.getImage().src = src;\n}\n\n\nexport default ImageSource;\n","/**\n * @module ol/uri\n */\n\n\n/**\n * Appends query parameters to a URI.\n *\n * @param {string} uri The original URI, which may already have query data.\n * @param {!Object} params An object where keys are URI-encoded parameter keys,\n *     and the values are arbitrary types or arrays.\n * @return {string} The new URI.\n */\nexport function appendParams(uri, params) {\n  const keyParams = [];\n  // Skip any null or undefined parameter values\n  Object.keys(params).forEach(function(k) {\n    if (params[k] !== null && params[k] !== undefined) {\n      keyParams.push(k + '=' + encodeURIComponent(params[k]));\n    }\n  });\n  const qs = keyParams.join('&');\n  // remove any trailing ? or &\n  uri = uri.replace(/[?&]$/, '');\n  // append ? or & depending on whether uri has existing parameters\n  uri = uri.indexOf('?') === -1 ? uri + '?' : uri + '&';\n  return uri + qs;\n}\n","/**\n * @module ol/source/ImageArcGISRest\n */\nimport {inherits} from '../index.js';\nimport ImageWrapper from '../Image.js';\nimport {assert} from '../asserts.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, getHeight, getWidth} from '../extent.js';\nimport {assign} from '../obj.js';\nimport ImageSource, {defaultImageLoadFunction} from '../source/Image.js';\nimport {appendParams} from '../uri.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting the image from\n * the remote server.\n * @property {module:ol/Image~LoadFunction} [imageLoadFunction] Optional function to load an image given\n * a URL.\n * @property {Object.<string,*>} params ArcGIS Rest parameters. This field is optional. Service\n * defaults will be used for any fields not specified. `FORMAT` is `PNG32` by default. `F` is\n * `IMAGE` by default. `TRANSPARENT` is `true` by default.  `BBOX, `SIZE`, `BBOXSR`, and `IMAGESR`\n * will be set dynamically. Set `LAYERS` to override the default service layer visibility. See\n * {@link http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#/Export_Map/02r3000000v7000000/}\n * for further reference.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {number} [ratio=1.5] Ratio. `1` means image requests are the size of the map viewport,\n * `2` means twice the size of the map viewport, and so on.\n * @property {Array.<number>} [resolutions] Resolutions. If specified, requests will be made for\n * these resolutions only.\n * @property {string} [url] ArcGIS Rest service URL for a Map Service or Image Service. The url\n * should include /MapServer or /ImageServer.\n */\n\n\n/**\n * @classdesc\n * Source for data from ArcGIS Rest services providing single, untiled images.\n * Useful when underlying map service has labels.\n *\n * If underlying map service is not using labels,\n * take advantage of ol image caching and use\n * {@link module:ol/source/TileArcGISRest} data source.\n *\n * @constructor\n * @fires ol/source/Image~ImageSourceEvent\n * @extends {module:ol/source/Image}\n * @param {module:ol/source/ImageArcGISRest~Options=} opt_options Image ArcGIS Rest Options.\n * @api\n */\nconst ImageArcGISRest = function(opt_options) {\n\n  const options = opt_options || {};\n\n  ImageSource.call(this, {\n    attributions: options.attributions,\n    projection: options.projection,\n    resolutions: options.resolutions\n  });\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.url_ = options.url;\n\n  /**\n   * @private\n   * @type {module:ol/Image~LoadFunction}\n   */\n  this.imageLoadFunction_ = options.imageLoadFunction !== undefined ?\n    options.imageLoadFunction : defaultImageLoadFunction;\n\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.params_ = options.params || {};\n\n  /**\n   * @private\n   * @type {module:ol/Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.imageSize_ = [0, 0];\n\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.ratio_ = options.ratio !== undefined ? options.ratio : 1.5;\n\n};\n\ninherits(ImageArcGISRest, ImageSource);\n\n\n/**\n * Get the user-provided params, i.e. those passed to the constructor through\n * the \"params\" option, and possibly updated using the updateParams method.\n * @return {Object} Params.\n * @api\n */\nImageArcGISRest.prototype.getParams = function() {\n  return this.params_;\n};\n\n\n/**\n * @inheritDoc\n */\nImageArcGISRest.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {\n\n  if (this.url_ === undefined) {\n    return null;\n  }\n\n  resolution = this.findNearestResolution(resolution);\n  pixelRatio = this.hidpi_ ? pixelRatio : 1;\n\n  const image = this.image_;\n  if (image &&\n      this.renderedRevision_ == this.getRevision() &&\n      image.getResolution() == resolution &&\n      image.getPixelRatio() == pixelRatio &&\n      containsExtent(image.getExtent(), extent)) {\n    return image;\n  }\n\n  const params = {\n    'F': 'image',\n    'FORMAT': 'PNG32',\n    'TRANSPARENT': true\n  };\n  assign(params, this.params_);\n\n  extent = extent.slice();\n  const centerX = (extent[0] + extent[2]) / 2;\n  const centerY = (extent[1] + extent[3]) / 2;\n  if (this.ratio_ != 1) {\n    const halfWidth = this.ratio_ * getWidth(extent) / 2;\n    const halfHeight = this.ratio_ * getHeight(extent) / 2;\n    extent[0] = centerX - halfWidth;\n    extent[1] = centerY - halfHeight;\n    extent[2] = centerX + halfWidth;\n    extent[3] = centerY + halfHeight;\n  }\n\n  const imageResolution = resolution / pixelRatio;\n\n  // Compute an integer width and height.\n  const width = Math.ceil(getWidth(extent) / imageResolution);\n  const height = Math.ceil(getHeight(extent) / imageResolution);\n\n  // Modify the extent to match the integer width and height.\n  extent[0] = centerX - imageResolution * width / 2;\n  extent[2] = centerX + imageResolution * width / 2;\n  extent[1] = centerY - imageResolution * height / 2;\n  extent[3] = centerY + imageResolution * height / 2;\n\n  this.imageSize_[0] = width;\n  this.imageSize_[1] = height;\n\n  const url = this.getRequestUrl_(extent, this.imageSize_, pixelRatio,\n    projection, params);\n\n  this.image_ = new ImageWrapper(extent, resolution, pixelRatio,\n    url, this.crossOrigin_, this.imageLoadFunction_);\n\n  this.renderedRevision_ = this.getRevision();\n\n  listen(this.image_, EventType.CHANGE,\n    this.handleImageChange, this);\n\n  return this.image_;\n\n};\n\n\n/**\n * Return the image load function of the source.\n * @return {module:ol/Image~LoadFunction} The image load function.\n * @api\n */\nImageArcGISRest.prototype.getImageLoadFunction = function() {\n  return this.imageLoadFunction_;\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {Object} params Params.\n * @return {string} Request URL.\n * @private\n */\nImageArcGISRest.prototype.getRequestUrl_ = function(extent, size, pixelRatio, projection, params) {\n  // ArcGIS Server only wants the numeric portion of the projection ID.\n  const srid = projection.getCode().split(':').pop();\n\n  params['SIZE'] = size[0] + ',' + size[1];\n  params['BBOX'] = extent.join(',');\n  params['BBOXSR'] = srid;\n  params['IMAGESR'] = srid;\n  params['DPI'] = Math.round(90 * pixelRatio);\n\n  const url = this.url_;\n\n  const modifiedUrl = url\n    .replace(/MapServer\\/?$/, 'MapServer/export')\n    .replace(/ImageServer\\/?$/, 'ImageServer/exportImage');\n  if (modifiedUrl == url) {\n    assert(false, 50); // `options.featureTypes` should be an Array\n  }\n  return appendParams(modifiedUrl, params);\n};\n\n\n/**\n * Return the URL used for this ArcGIS source.\n * @return {string|undefined} URL.\n * @api\n */\nImageArcGISRest.prototype.getUrl = function() {\n  return this.url_;\n};\n\n\n/**\n * Set the image load function of the source.\n * @param {module:ol/Image~LoadFunction} imageLoadFunction Image load function.\n * @api\n */\nImageArcGISRest.prototype.setImageLoadFunction = function(imageLoadFunction) {\n  this.image_ = null;\n  this.imageLoadFunction_ = imageLoadFunction;\n  this.changed();\n};\n\n\n/**\n * Set the URL to use for requests.\n * @param {string|undefined} url URL.\n * @api\n */\nImageArcGISRest.prototype.setUrl = function(url) {\n  if (url != this.url_) {\n    this.url_ = url;\n    this.image_ = null;\n    this.changed();\n  }\n};\n\n\n/**\n * Update the user-provided params.\n * @param {Object} params Params.\n * @api\n */\nImageArcGISRest.prototype.updateParams = function(params) {\n  assign(this.params_, params);\n  this.image_ = null;\n  this.changed();\n};\nexport default ImageArcGISRest;\n","/**\n * @module ol/source/ImageCanvas\n */\nimport {inherits} from '../index.js';\nimport ImageCanvas from '../ImageCanvas.js';\nimport {containsExtent, getHeight, getWidth, scaleFromCenter} from '../extent.js';\nimport ImageSource from '../source/Image.js';\n\n\n/**\n * A function returning the canvas element (`{HTMLCanvasElement}`)\n * used by the source as an image. The arguments passed to the function are:\n * {@link module:ol/extent~Extent} the image extent, `{number}` the image resolution,\n * `{number}` the device pixel ratio, {@link module:ol/size~Size} the image size, and\n * {@link module:ol/proj/Projection} the image projection. The canvas returned by\n * this function is cached by the source. The this keyword inside the function\n * references the {@link module:ol/source/ImageCanvas}.\n *\n * @typedef {function(this:module:ol/ImageCanvas, module:ol/extent~Extent, number,\n *     number, module:ol/size~Size, module:ol/proj/Projection): HTMLCanvasElement} FunctionType\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {module:ol/source/ImageCanvas~FunctionType} [canvasFunction] Canvas function.\n * The function returning the canvas element used by the source\n * as an image. The arguments passed to the function are: `{module:ol/extent~Extent}` the\n * image extent, `{number}` the image resolution, `{number}` the device pixel\n * ratio, `{module:ol/size~Size}` the image size, and `{module:ol/proj/Projection~Projection}` the image\n * projection. The canvas returned by this function is cached by the source. If\n * the value returned by the function is later changed then\n * `changed` should be called on the source for the source to\n * invalidate the current cached image. See @link: {@link module:ol/Observable~Observable#changed}\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {number} [ratio=1.5] Ratio. 1 means canvases are the size of the map viewport, 2 means twice the\n * width and height of the map viewport, and so on. Must be `1` or higher.\n * @property {Array.<number>} [resolutions] Resolutions.\n * If specified, new canvases will be created for these resolutions\n * @property {module:ol/source/State} [state] Source state.\n */\n\n\n/**\n * @classdesc\n * Base class for image sources where a canvas element is the image.\n *\n * @constructor\n * @extends {module:ol/source/Image}\n * @param {module:ol/source/ImageCanvas~Options=} options ImageCanvas options.\n * @api\n */\nconst ImageCanvasSource = function(options) {\n\n  ImageSource.call(this, {\n    attributions: options.attributions,\n    projection: options.projection,\n    resolutions: options.resolutions,\n    state: options.state\n  });\n\n  /**\n   * @private\n   * @type {module:ol/source/ImageCanvas~FunctionType}\n   */\n  this.canvasFunction_ = options.canvasFunction;\n\n  /**\n   * @private\n   * @type {module:ol/ImageCanvas}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.ratio_ = options.ratio !== undefined ?\n    options.ratio : 1.5;\n\n};\n\ninherits(ImageCanvasSource, ImageSource);\n\n\n/**\n * @inheritDoc\n */\nImageCanvasSource.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {\n  resolution = this.findNearestResolution(resolution);\n\n  let canvas = this.canvas_;\n  if (canvas &&\n      this.renderedRevision_ == this.getRevision() &&\n      canvas.getResolution() == resolution &&\n      canvas.getPixelRatio() == pixelRatio &&\n      containsExtent(canvas.getExtent(), extent)) {\n    return canvas;\n  }\n\n  extent = extent.slice();\n  scaleFromCenter(extent, this.ratio_);\n  const width = getWidth(extent) / resolution;\n  const height = getHeight(extent) / resolution;\n  const size = [width * pixelRatio, height * pixelRatio];\n\n  const canvasElement = this.canvasFunction_(\n    extent, resolution, pixelRatio, size, projection);\n  if (canvasElement) {\n    canvas = new ImageCanvas(extent, resolution, pixelRatio, canvasElement);\n  }\n  this.canvas_ = canvas;\n  this.renderedRevision_ = this.getRevision();\n\n  return canvas;\n};\nexport default ImageCanvasSource;\n","/**\n * @module ol/source/ImageMapGuide\n */\nimport {inherits} from '../index.js';\nimport ImageWrapper from '../Image.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, getCenter, getHeight, getWidth, scaleFromCenter} from '../extent.js';\nimport {assign} from '../obj.js';\nimport ImageSource, {defaultImageLoadFunction} from '../source/Image.js';\nimport {appendParams} from '../uri.js';\n\n/**\n * @typedef {Object} Options\n * @property {string} [url] The mapagent url.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {number} [displayDpi=96] The display resolution.\n * @property {number} [metersPerUnit=1] The meters-per-unit value.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting\n * the image from the remote server.\n * @property {boolean} [useOverlay] If `true`, will use `GETDYNAMICMAPOVERLAYIMAGE`.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {number} [ratio=1] Ratio. `1` means image requests are the size of the map viewport, `2` means\n * twice the width and height of the map viewport, and so on. Must be `1` or higher.\n * @property {Array.<number>} [resolutions] Resolutions.\n * If specified, requests will be made for these resolutions only.\n * @property {module:ol/Image~LoadFunction} [imageLoadFunction] Optional function to load an image given a URL.\n * @property {Object} [params] Additional parameters.\n */\n\n\n/**\n * @classdesc\n * Source for images from Mapguide servers\n *\n * @constructor\n * @fires ol/source/Image~ImageSourceEvent\n * @extends {module:ol/source/Image}\n * @param {module:ol/source/ImageMapGuide~Options=} options ImageMapGuide options.\n * @api\n */\nconst ImageMapGuide = function(options) {\n\n  ImageSource.call(this, {\n    projection: options.projection,\n    resolutions: options.resolutions\n  });\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.displayDpi_ = options.displayDpi !== undefined ?\n    options.displayDpi : 96;\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.params_ = options.params || {};\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.url_ = options.url;\n\n  /**\n   * @private\n   * @type {module:ol/Image~LoadFunction}\n   */\n  this.imageLoadFunction_ = options.imageLoadFunction !== undefined ?\n    options.imageLoadFunction : defaultImageLoadFunction;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.metersPerUnit_ = options.metersPerUnit !== undefined ?\n    options.metersPerUnit : 1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.ratio_ = options.ratio !== undefined ? options.ratio : 1;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.useOverlay_ = options.useOverlay !== undefined ?\n    options.useOverlay : false;\n\n  /**\n   * @private\n   * @type {module:ol/Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = 0;\n\n};\n\ninherits(ImageMapGuide, ImageSource);\n\n\n/**\n * Get the user-provided params, i.e. those passed to the constructor through\n * the \"params\" option, and possibly updated using the updateParams method.\n * @return {Object} Params.\n * @api\n */\nImageMapGuide.prototype.getParams = function() {\n  return this.params_;\n};\n\n\n/**\n * @inheritDoc\n */\nImageMapGuide.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {\n  resolution = this.findNearestResolution(resolution);\n  pixelRatio = this.hidpi_ ? pixelRatio : 1;\n\n  let image = this.image_;\n  if (image &&\n      this.renderedRevision_ == this.getRevision() &&\n      image.getResolution() == resolution &&\n      image.getPixelRatio() == pixelRatio &&\n      containsExtent(image.getExtent(), extent)) {\n    return image;\n  }\n\n  if (this.ratio_ != 1) {\n    extent = extent.slice();\n    scaleFromCenter(extent, this.ratio_);\n  }\n  const width = getWidth(extent) / resolution;\n  const height = getHeight(extent) / resolution;\n  const size = [width * pixelRatio, height * pixelRatio];\n\n  if (this.url_ !== undefined) {\n    const imageUrl = this.getUrl(this.url_, this.params_, extent, size,\n      projection);\n    image = new ImageWrapper(extent, resolution, pixelRatio,\n      imageUrl, this.crossOrigin_,\n      this.imageLoadFunction_);\n    listen(image, EventType.CHANGE,\n      this.handleImageChange, this);\n  } else {\n    image = null;\n  }\n  this.image_ = image;\n  this.renderedRevision_ = this.getRevision();\n\n  return image;\n};\n\n\n/**\n * Return the image load function of the source.\n * @return {module:ol/Image~LoadFunction} The image load function.\n * @api\n */\nImageMapGuide.prototype.getImageLoadFunction = function() {\n  return this.imageLoadFunction_;\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent The map extents.\n * @param {module:ol/size~Size} size The viewport size.\n * @param {number} metersPerUnit The meters-per-unit value.\n * @param {number} dpi The display resolution.\n * @return {number} The computed map scale.\n */\nfunction getScale(extent, size, metersPerUnit, dpi) {\n  const mcsW = getWidth(extent);\n  const mcsH = getHeight(extent);\n  const devW = size[0];\n  const devH = size[1];\n  const mpp = 0.0254 / dpi;\n  if (devH * mcsW > devW * mcsH) {\n    return mcsW * metersPerUnit / (devW * mpp); // width limited\n  } else {\n    return mcsH * metersPerUnit / (devH * mpp); // height limited\n  }\n}\n\n\n/**\n * Update the user-provided params.\n * @param {Object} params Params.\n * @api\n */\nImageMapGuide.prototype.updateParams = function(params) {\n  assign(this.params_, params);\n  this.changed();\n};\n\n\n/**\n * @param {string} baseUrl The mapagent url.\n * @param {Object.<string, string|number>} params Request parameters.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/size~Size} size Size.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {string} The mapagent map image request URL.\n */\nImageMapGuide.prototype.getUrl = function(baseUrl, params, extent, size, projection) {\n  const scale = getScale(extent, size,\n    this.metersPerUnit_, this.displayDpi_);\n  const center = getCenter(extent);\n  const baseParams = {\n    'OPERATION': this.useOverlay_ ? 'GETDYNAMICMAPOVERLAYIMAGE' : 'GETMAPIMAGE',\n    'VERSION': '2.0.0',\n    'LOCALE': 'en',\n    'CLIENTAGENT': 'ol/source/ImageMapGuide source',\n    'CLIP': '1',\n    'SETDISPLAYDPI': this.displayDpi_,\n    'SETDISPLAYWIDTH': Math.round(size[0]),\n    'SETDISPLAYHEIGHT': Math.round(size[1]),\n    'SETVIEWSCALE': scale,\n    'SETVIEWCENTERX': center[0],\n    'SETVIEWCENTERY': center[1]\n  };\n  assign(baseParams, params);\n  return appendParams(baseUrl, baseParams);\n};\n\n\n/**\n * Set the image load function of the MapGuide source.\n * @param {module:ol/Image~LoadFunction} imageLoadFunction Image load function.\n * @api\n */\nImageMapGuide.prototype.setImageLoadFunction = function(imageLoadFunction) {\n  this.image_ = null;\n  this.imageLoadFunction_ = imageLoadFunction;\n  this.changed();\n};\nexport default ImageMapGuide;\n","/**\n * @module ol/source/ImageStatic\n */\nimport {inherits} from '../index.js';\nimport ImageWrapper from '../Image.js';\nimport ImageState from '../ImageState.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {intersects, getHeight, getWidth} from '../extent.js';\nimport {get as getProjection} from '../proj.js';\nimport ImageSource, {defaultImageLoadFunction} from '../source/Image.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {module:ol/extent~Extent} [imageExtent] Extent of the image in map coordinates.\n * This is the [left, bottom, right, top] map coordinates of your image.\n * @property {module:ol/Image~LoadFunction} [imageLoadFunction] Optional function to load an image given a URL.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {module:ol/size~Size} [imageSize] Size of the image in pixels. Usually the image size is auto-detected, so this\n * only needs to be set if auto-detection fails for some reason.\n * @property {string} url Image URL.\n */\n\n\n/**\n * @classdesc\n * A layer source for displaying a single, static image.\n *\n * @constructor\n * @extends {module:ol/source/Image}\n * @param {module:ol/source/ImageStatic~Options=} options ImageStatic options.\n * @api\n */\nconst Static = function(options) {\n  const imageExtent = options.imageExtent;\n\n  const crossOrigin = options.crossOrigin !== undefined ?\n    options.crossOrigin : null;\n\n  const /** @type {module:ol/Image~LoadFunction} */ imageLoadFunction =\n      options.imageLoadFunction !== undefined ?\n        options.imageLoadFunction : defaultImageLoadFunction;\n\n  ImageSource.call(this, {\n    attributions: options.attributions,\n    projection: getProjection(options.projection)\n  });\n\n  /**\n   * @private\n   * @type {module:ol/Image}\n   */\n  this.image_ = new ImageWrapper(imageExtent, undefined, 1, options.url, crossOrigin, imageLoadFunction);\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.imageSize_ = options.imageSize ? options.imageSize : null;\n\n  listen(this.image_, EventType.CHANGE,\n    this.handleImageChange, this);\n\n};\n\ninherits(Static, ImageSource);\n\n\n/**\n * @inheritDoc\n */\nStatic.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {\n  if (intersects(extent, this.image_.getExtent())) {\n    return this.image_;\n  }\n  return null;\n};\n\n\n/**\n * @inheritDoc\n */\nStatic.prototype.handleImageChange = function(evt) {\n  if (this.image_.getState() == ImageState.LOADED) {\n    const imageExtent = this.image_.getExtent();\n    const image = this.image_.getImage();\n    let imageWidth, imageHeight;\n    if (this.imageSize_) {\n      imageWidth = this.imageSize_[0];\n      imageHeight = this.imageSize_[1];\n    } else {\n      imageWidth = image.width;\n      imageHeight = image.height;\n    }\n    const resolution = getHeight(imageExtent) / imageHeight;\n    const targetWidth = Math.ceil(getWidth(imageExtent) / resolution);\n    if (targetWidth != imageWidth) {\n      const context = createCanvasContext2D(targetWidth, imageHeight);\n      const canvas = context.canvas;\n      context.drawImage(image, 0, 0, imageWidth, imageHeight,\n        0, 0, canvas.width, canvas.height);\n      this.image_.setImage(canvas);\n    }\n  }\n  ImageSource.prototype.handleImageChange.call(this, evt);\n};\nexport default Static;\n","/**\n * Default WMS version.\n * @type {string}\n */\nexport const DEFAULT_WMS_VERSION = '1.3.0';\n","/**\n * @module ol/source/WMSServerType\n */\n\n/**\n * Available server types: `'carmentaserver'`, `'geoserver'`, `'mapserver'`,\n *     `'qgis'`. These are servers that have vendor parameters beyond the WMS\n *     specification that OpenLayers can make use of.\n * @enum {string}\n */\nexport default {\n  CARMENTA_SERVER: 'carmentaserver',\n  GEOSERVER: 'geoserver',\n  MAPSERVER: 'mapserver',\n  QGIS: 'qgis'\n};\n","/**\n * @module ol/source/ImageWMS\n */\n\nimport {DEFAULT_WMS_VERSION} from './common.js';\nimport {inherits} from '../index.js';\nimport ImageWrapper from '../Image.js';\nimport {assert} from '../asserts.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, getCenter, getForViewAndSize, getHeight, getWidth} from '../extent.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, transform} from '../proj.js';\nimport {calculateSourceResolution} from '../reproj.js';\nimport ImageSource, {defaultImageLoadFunction} from '../source/Image.js';\nimport WMSServerType from '../source/WMSServerType.js';\nimport {compareVersions} from '../string.js';\nimport {appendParams} from '../uri.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting\n * the image from the remote server.\n * @property {module:ol/source/WMSServerType|string} [serverType] The type of\n * the remote WMS server: `mapserver`, `geoserver` or `qgis`. Only needed if `hidpi` is `true`.\n * @property {module:ol/Image~LoadFunction} [imageLoadFunction] Optional function to load an image given a URL.\n * @property {Object.<string,*>} params WMS request parameters.\n * At least a `LAYERS` param is required. `STYLES` is\n * `''` by default. `VERSION` is `1.3.0` by default. `WIDTH`, `HEIGHT`, `BBOX`\n * and `CRS` (`SRS` for WMS version < 1.3.0) will be set dynamically.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {number} [ratio=1.5] Ratio. `1` means image requests are the size of the map viewport, `2` means\n * twice the width and height of the map viewport, and so on. Must be `1` or\n * higher.\n * @property {Array.<number>} [resolutions] Resolutions.\n * If specified, requests will be made for these resolutions only.\n * @property {string} url WMS service URL.\n */\n\n\n/**\n * @classdesc\n * Source for WMS servers providing single, untiled images.\n *\n * @constructor\n * @fires ol/source/Image~ImageSourceEvent\n * @extends {module:ol/source/Image}\n * @param {module:ol/source/ImageWMS~Options=} [opt_options] ImageWMS options.\n * @api\n */\nconst ImageWMS = function(opt_options) {\n\n  const options = opt_options || {};\n\n  ImageSource.call(this, {\n    attributions: options.attributions,\n    projection: options.projection,\n    resolutions: options.resolutions\n  });\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.url_ = options.url;\n\n  /**\n   * @private\n   * @type {module:ol/Image~LoadFunction}\n   */\n  this.imageLoadFunction_ = options.imageLoadFunction !== undefined ?\n    options.imageLoadFunction : defaultImageLoadFunction;\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.params_ = options.params || {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.v13_ = true;\n  this.updateV13_();\n\n  /**\n   * @private\n   * @type {module:ol/source/WMSServerType|undefined}\n   */\n  this.serverType_ = /** @type {module:ol/source/WMSServerType|undefined} */ (options.serverType);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n  /**\n   * @private\n   * @type {module:ol/Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.imageSize_ = [0, 0];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.ratio_ = options.ratio !== undefined ? options.ratio : 1.5;\n\n};\n\ninherits(ImageWMS, ImageSource);\n\n\n/**\n * @const\n * @type {module:ol/size~Size}\n */\nconst GETFEATUREINFO_IMAGE_SIZE = [101, 101];\n\n\n/**\n * Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n * constructed.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @param {!Object} params GetFeatureInfo params. `INFO_FORMAT` at least should\n *     be provided. If `QUERY_LAYERS` is not provided then the layers specified\n *     in the `LAYERS` parameter will be used. `VERSION` should not be\n *     specified here.\n * @return {string|undefined} GetFeatureInfo URL.\n * @api\n */\nImageWMS.prototype.getGetFeatureInfoUrl = function(coordinate, resolution, projection, params) {\n  if (this.url_ === undefined) {\n    return undefined;\n  }\n  const projectionObj = getProjection(projection);\n  const sourceProjectionObj = this.getProjection();\n\n  if (sourceProjectionObj && sourceProjectionObj !== projectionObj) {\n    resolution = calculateSourceResolution(sourceProjectionObj, projectionObj, coordinate, resolution);\n    coordinate = transform(coordinate, projectionObj, sourceProjectionObj);\n  }\n\n  const extent = getForViewAndSize(coordinate, resolution, 0,\n    GETFEATUREINFO_IMAGE_SIZE);\n\n  const baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetFeatureInfo',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true,\n    'QUERY_LAYERS': this.params_['LAYERS']\n  };\n  assign(baseParams, this.params_, params);\n\n  const x = Math.floor((coordinate[0] - extent[0]) / resolution);\n  const y = Math.floor((extent[3] - coordinate[1]) / resolution);\n  baseParams[this.v13_ ? 'I' : 'X'] = x;\n  baseParams[this.v13_ ? 'J' : 'Y'] = y;\n\n  return this.getRequestUrl_(\n    extent, GETFEATUREINFO_IMAGE_SIZE,\n    1, sourceProjectionObj || projectionObj, baseParams);\n};\n\n\n/**\n * Get the user-provided params, i.e. those passed to the constructor through\n * the \"params\" option, and possibly updated using the updateParams method.\n * @return {Object} Params.\n * @api\n */\nImageWMS.prototype.getParams = function() {\n  return this.params_;\n};\n\n\n/**\n * @inheritDoc\n */\nImageWMS.prototype.getImageInternal = function(extent, resolution, pixelRatio, projection) {\n\n  if (this.url_ === undefined) {\n    return null;\n  }\n\n  resolution = this.findNearestResolution(resolution);\n\n  if (pixelRatio != 1 && (!this.hidpi_ || this.serverType_ === undefined)) {\n    pixelRatio = 1;\n  }\n\n  const imageResolution = resolution / pixelRatio;\n\n  const center = getCenter(extent);\n  const viewWidth = Math.ceil(getWidth(extent) / imageResolution);\n  const viewHeight = Math.ceil(getHeight(extent) / imageResolution);\n  const viewExtent = getForViewAndSize(center, imageResolution, 0,\n    [viewWidth, viewHeight]);\n  const requestWidth = Math.ceil(this.ratio_ * getWidth(extent) / imageResolution);\n  const requestHeight = Math.ceil(this.ratio_ * getHeight(extent) / imageResolution);\n  const requestExtent = getForViewAndSize(center, imageResolution, 0,\n    [requestWidth, requestHeight]);\n\n  const image = this.image_;\n  if (image &&\n      this.renderedRevision_ == this.getRevision() &&\n      image.getResolution() == resolution &&\n      image.getPixelRatio() == pixelRatio &&\n      containsExtent(image.getExtent(), viewExtent)) {\n    return image;\n  }\n\n  const params = {\n    'SERVICE': 'WMS',\n    'VERSION': DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetMap',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true\n  };\n  assign(params, this.params_);\n\n  this.imageSize_[0] = Math.round(getWidth(requestExtent) / imageResolution);\n  this.imageSize_[1] = Math.round(getHeight(requestExtent) / imageResolution);\n\n  const url = this.getRequestUrl_(requestExtent, this.imageSize_, pixelRatio,\n    projection, params);\n\n  this.image_ = new ImageWrapper(requestExtent, resolution, pixelRatio,\n    url, this.crossOrigin_, this.imageLoadFunction_);\n\n  this.renderedRevision_ = this.getRevision();\n\n  listen(this.image_, EventType.CHANGE,\n    this.handleImageChange, this);\n\n  return this.image_;\n\n};\n\n\n/**\n * Return the image load function of the source.\n * @return {module:ol/Image~LoadFunction} The image load function.\n * @api\n */\nImageWMS.prototype.getImageLoadFunction = function() {\n  return this.imageLoadFunction_;\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {Object} params Params.\n * @return {string} Request URL.\n * @private\n */\nImageWMS.prototype.getRequestUrl_ = function(extent, size, pixelRatio, projection, params) {\n\n  assert(this.url_ !== undefined, 9); // `url` must be configured or set using `#setUrl()`\n\n  params[this.v13_ ? 'CRS' : 'SRS'] = projection.getCode();\n\n  if (!('STYLES' in this.params_)) {\n    params['STYLES'] = '';\n  }\n\n  if (pixelRatio != 1) {\n    switch (this.serverType_) {\n      case WMSServerType.GEOSERVER:\n        const dpi = (90 * pixelRatio + 0.5) | 0;\n        if ('FORMAT_OPTIONS' in params) {\n          params['FORMAT_OPTIONS'] += ';dpi:' + dpi;\n        } else {\n          params['FORMAT_OPTIONS'] = 'dpi:' + dpi;\n        }\n        break;\n      case WMSServerType.MAPSERVER:\n        params['MAP_RESOLUTION'] = 90 * pixelRatio;\n        break;\n      case WMSServerType.CARMENTA_SERVER:\n      case WMSServerType.QGIS:\n        params['DPI'] = 90 * pixelRatio;\n        break;\n      default:\n        assert(false, 8); // Unknown `serverType` configured\n        break;\n    }\n  }\n\n  params['WIDTH'] = size[0];\n  params['HEIGHT'] = size[1];\n\n  const axisOrientation = projection.getAxisOrientation();\n  let bbox;\n  if (this.v13_ && axisOrientation.substr(0, 2) == 'ne') {\n    bbox = [extent[1], extent[0], extent[3], extent[2]];\n  } else {\n    bbox = extent;\n  }\n  params['BBOX'] = bbox.join(',');\n\n  return appendParams(/** @type {string} */ (this.url_), params);\n};\n\n\n/**\n * Return the URL used for this WMS source.\n * @return {string|undefined} URL.\n * @api\n */\nImageWMS.prototype.getUrl = function() {\n  return this.url_;\n};\n\n\n/**\n * Set the image load function of the source.\n * @param {module:ol/Image~LoadFunction} imageLoadFunction Image load function.\n * @api\n */\nImageWMS.prototype.setImageLoadFunction = function(imageLoadFunction) {\n  this.image_ = null;\n  this.imageLoadFunction_ = imageLoadFunction;\n  this.changed();\n};\n\n\n/**\n * Set the URL to use for requests.\n * @param {string|undefined} url URL.\n * @api\n */\nImageWMS.prototype.setUrl = function(url) {\n  if (url != this.url_) {\n    this.url_ = url;\n    this.image_ = null;\n    this.changed();\n  }\n};\n\n\n/**\n * Update the user-provided params.\n * @param {Object} params Params.\n * @api\n */\nImageWMS.prototype.updateParams = function(params) {\n  assign(this.params_, params);\n  this.updateV13_();\n  this.image_ = null;\n  this.changed();\n};\n\n\n/**\n * @private\n */\nImageWMS.prototype.updateV13_ = function() {\n  const version = this.params_['VERSION'] || DEFAULT_WMS_VERSION;\n  this.v13_ = compareVersions(version, '1.3') >= 0;\n};\nexport default ImageWMS;\n","/**\n * @module ol/source/OSM\n */\nimport {inherits} from '../index.js';\nimport XYZ from '../source/XYZ.js';\n\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\nexport const ATTRIBUTION = '&copy; ' +\n      '<a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> ' +\n      'contributors.';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {number} [maxZoom=19] Max zoom.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {number} [reprojectionErrorThreshold=1.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url='https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png'] URL template.\n * Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n *\n * @constructor\n * @extends {module:ol/source/XYZ}\n * @param {module:ol/source/OSM~Options=} [opt_options] Open Street Map options.\n * @api\n */\nconst OSM = function(opt_options) {\n\n  const options = opt_options || {};\n\n  let attributions;\n  if (options.attributions !== undefined) {\n    attributions = options.attributions;\n  } else {\n    attributions = [ATTRIBUTION];\n  }\n\n  const crossOrigin = options.crossOrigin !== undefined ?\n    options.crossOrigin : 'anonymous';\n\n  const url = options.url !== undefined ?\n    options.url : 'https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n  XYZ.call(this, {\n    attributions: attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: crossOrigin,\n    opaque: options.opaque !== undefined ? options.opaque : true,\n    maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileLoadFunction: options.tileLoadFunction,\n    url: url,\n    wrapX: options.wrapX\n  });\n\n};\n\ninherits(OSM, XYZ);\n\nexport default OSM;\n","var hasImageData = true;\ntry {\n  new ImageData(10, 10);\n} catch (_) {\n  hasImageData = false;\n}\n\nvar context = document.createElement('canvas').getContext('2d');\n\nfunction newImageData(data, width, height) {\n  if (hasImageData) {\n    return new ImageData(data, width, height);\n  } else {\n    var imageData = context.createImageData(width, height);\n    imageData.data.set(data);\n    return imageData;\n  }\n}\n\nexports.newImageData = newImageData;\n","var newImageData = require('./util').newImageData;\n\n/**\n * Create a function for running operations.  This function is serialized for\n * use in a worker.\n * @param {function(Array, Object):*} operation The operation.\n * @return {function(Object):ArrayBuffer} A function that takes an object with\n * buffers, meta, imageOps, width, and height properties and returns an array\n * buffer.\n */\nfunction createMinion(operation) {\n  var workerHasImageData = true;\n  try {\n    new ImageData(10, 10);\n  } catch (_) {\n    workerHasImageData = false;\n  }\n\n  function newWorkerImageData(data, width, height) {\n    if (workerHasImageData) {\n      return new ImageData(data, width, height);\n    } else {\n      return {data: data, width: width, height: height};\n    }\n  }\n\n  return function(data) {\n    // bracket notation for minification support\n    var buffers = data['buffers'];\n    var meta = data['meta'];\n    var imageOps = data['imageOps'];\n    var width = data['width'];\n    var height = data['height'];\n\n    var numBuffers = buffers.length;\n    var numBytes = buffers[0].byteLength;\n    var output, b;\n\n    if (imageOps) {\n      var images = new Array(numBuffers);\n      for (b = 0; b < numBuffers; ++b) {\n        images[b] = newWorkerImageData(\n            new Uint8ClampedArray(buffers[b]), width, height);\n      }\n      output = operation(images, meta).data;\n    } else {\n      output = new Uint8ClampedArray(numBytes);\n      var arrays = new Array(numBuffers);\n      var pixels = new Array(numBuffers);\n      for (b = 0; b < numBuffers; ++b) {\n        arrays[b] = new Uint8ClampedArray(buffers[b]);\n        pixels[b] = [0, 0, 0, 0];\n      }\n      for (var i = 0; i < numBytes; i += 4) {\n        for (var j = 0; j < numBuffers; ++j) {\n          var array = arrays[j];\n          pixels[j][0] = array[i];\n          pixels[j][1] = array[i + 1];\n          pixels[j][2] = array[i + 2];\n          pixels[j][3] = array[i + 3];\n        }\n        var pixel = operation(pixels, meta);\n        output[i] = pixel[0];\n        output[i + 1] = pixel[1];\n        output[i + 2] = pixel[2];\n        output[i + 3] = pixel[3];\n      }\n    }\n    return output.buffer;\n  };\n}\n\n/**\n * Create a worker for running operations.\n * @param {Object} config Configuration.\n * @param {function(MessageEvent)} onMessage Called with a message event.\n * @return {Worker} The worker.\n */\nfunction createWorker(config, onMessage) {\n  var lib = Object.keys(config.lib || {}).map(function(name) {\n    return 'var ' + name + ' = ' + config.lib[name].toString() + ';';\n  });\n\n  var lines = lib.concat([\n    'var __minion__ = (' + createMinion.toString() + ')(', config.operation.toString(), ');',\n    'self.addEventListener(\"message\", function(event) {',\n    '  var buffer = __minion__(event.data);',\n    '  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);',\n    '});'\n  ]);\n\n  var blob = new Blob(lines, {type: 'text/javascript'});\n  var source = URL.createObjectURL(blob);\n  var worker = new Worker(source);\n  worker.addEventListener('message', onMessage);\n  return worker;\n}\n\n/**\n * Create a faux worker for running operations.\n * @param {Object} config Configuration.\n * @param {function(MessageEvent)} onMessage Called with a message event.\n * @return {Object} The faux worker.\n */\nfunction createFauxWorker(config, onMessage) {\n  var minion = createMinion(config.operation);\n  return {\n    postMessage: function(data) {\n      setTimeout(function() {\n        onMessage({'data': {'buffer': minion(data), 'meta': data['meta']}});\n      }, 0);\n    }\n  };\n}\n\n/**\n * A processor runs pixel or image operations in workers.\n * @param {Object} config Configuration.\n */\nfunction Processor(config) {\n  this._imageOps = !!config.imageOps;\n  var threads;\n  if (config.threads === 0) {\n    threads = 0;\n  } else if (this._imageOps) {\n    threads = 1;\n  } else {\n    threads = config.threads || 1;\n  }\n  var workers = [];\n  if (threads) {\n    for (var i = 0; i < threads; ++i) {\n      workers[i] = createWorker(config, this._onWorkerMessage.bind(this, i));\n    }\n  } else {\n    workers[0] = createFauxWorker(config, this._onWorkerMessage.bind(this, 0));\n  }\n  this._workers = workers;\n  this._queue = [];\n  this._maxQueueLength = config.queue || Infinity;\n  this._running = 0;\n  this._dataLookup = {};\n  this._job = null;\n}\n\n/**\n * Run operation on input data.\n * @param {Array.<Array|ImageData>} inputs Array of pixels or image data\n *     (depending on the operation type).\n * @param {Object} meta A user data object.  This is passed to all operations\n *     and must be serializable.\n * @param {function(Error, ImageData, Object)} callback Called when work\n *     completes.  The first argument is any error.  The second is the ImageData\n *     generated by operations.  The third is the user data object.\n */\nProcessor.prototype.process = function(inputs, meta, callback) {\n  this._enqueue({\n    inputs: inputs,\n    meta: meta,\n    callback: callback\n  });\n  this._dispatch();\n};\n\n/**\n * Stop responding to any completed work and destroy the processor.\n */\nProcessor.prototype.destroy = function() {\n  for (var key in this) {\n    this[key] = null;\n  }\n  this._destroyed = true;\n};\n\n/**\n * Add a job to the queue.\n * @param {Object} job The job.\n */\nProcessor.prototype._enqueue = function(job) {\n  this._queue.push(job);\n  while (this._queue.length > this._maxQueueLength) {\n    this._queue.shift().callback(null, null);\n  }\n};\n\n/**\n * Dispatch a job.\n */\nProcessor.prototype._dispatch = function() {\n  if (this._running === 0 && this._queue.length > 0) {\n    var job = this._job = this._queue.shift();\n    var width = job.inputs[0].width;\n    var height = job.inputs[0].height;\n    var buffers = job.inputs.map(function(input) {\n      return input.data.buffer;\n    });\n    var threads = this._workers.length;\n    this._running = threads;\n    if (threads === 1) {\n      this._workers[0].postMessage({\n        'buffers': buffers,\n        'meta': job.meta,\n        'imageOps': this._imageOps,\n        'width': width,\n        'height': height\n      }, buffers);\n    } else {\n      var length = job.inputs[0].data.length;\n      var segmentLength = 4 * Math.ceil(length / 4 / threads);\n      for (var i = 0; i < threads; ++i) {\n        var offset = i * segmentLength;\n        var slices = [];\n        for (var j = 0, jj = buffers.length; j < jj; ++j) {\n          slices.push(buffers[i].slice(offset, offset + segmentLength));\n        }\n        this._workers[i].postMessage({\n          'buffers': slices,\n          'meta': job.meta,\n          'imageOps': this._imageOps,\n          'width': width,\n          'height': height\n        }, slices);\n      }\n    }\n  }\n};\n\n/**\n * Handle messages from the worker.\n * @param {number} index The worker index.\n * @param {MessageEvent} event The message event.\n */\nProcessor.prototype._onWorkerMessage = function(index, event) {\n  if (this._destroyed) {\n    return;\n  }\n  this._dataLookup[index] = event.data;\n  --this._running;\n  if (this._running === 0) {\n    this._resolveJob();\n  }\n};\n\n/**\n * Resolve a job.  If there are no more worker threads, the processor callback\n * will be called.\n */\nProcessor.prototype._resolveJob = function() {\n  var job = this._job;\n  var threads = this._workers.length;\n  var data, meta;\n  if (threads === 1) {\n    data = new Uint8ClampedArray(this._dataLookup[0]['buffer']);\n    meta = this._dataLookup[0]['meta'];\n  } else {\n    var length = job.inputs[0].data.length;\n    data = new Uint8ClampedArray(length);\n    meta = new Array(length);\n    var segmentLength = 4 * Math.ceil(length / 4 / threads);\n    for (var i = 0; i < threads; ++i) {\n      var buffer = this._dataLookup[i]['buffer'];\n      var offset = i * segmentLength;\n      data.set(new Uint8ClampedArray(buffer), offset);\n      meta[i] = this._dataLookup[i]['meta'];\n    }\n  }\n  this._job = null;\n  this._dataLookup = {};\n  job.callback(null,\n      newImageData(data, job.inputs[0].width, job.inputs[0].height), meta);\n  this._dispatch();\n};\n\nmodule.exports = Processor;\n","/**\n * @module ol/source/Raster\n */\nimport {getUid, inherits} from '../index.js';\nimport ImageCanvas from '../ImageCanvas.js';\nimport TileQueue from '../TileQueue.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {Processor} from 'pixelworks/lib/index';\nimport {equals, getCenter, getHeight, getWidth} from '../extent.js';\nimport LayerType from '../LayerType.js';\nimport Layer from '../layer/Layer.js';\nimport ImageLayer from '../layer/Image.js';\nimport TileLayer from '../layer/Tile.js';\nimport {assign} from '../obj.js';\nimport CanvasImageLayerRenderer from '../renderer/canvas/ImageLayer.js';\nimport CanvasTileLayerRenderer from '../renderer/canvas/TileLayer.js';\nimport ImageSource from '../source/Image.js';\nimport SourceState from '../source/State.js';\nimport TileSource from '../source/Tile.js';\nimport {create as createTransform} from '../transform.js';\n\n\n/**\n * A function that takes an array of input data, performs some operation, and\n * returns an array of output data.\n * For `pixel` type operations, the function will be called with an array of\n * pixels, where each pixel is an array of four numbers (`[r, g, b, a]`) in the\n * range of 0 - 255. It should return a single pixel array.\n * For `'image'` type operations, functions will be called with an array of\n * {@link ImageData https://developer.mozilla.org/en-US/docs/Web/API/ImageData}\n * and should return a single {@link ImageData\n * https://developer.mozilla.org/en-US/docs/Web/API/ImageData}.  The operations\n * are called with a second \"data\" argument, which can be used for storage.  The\n * data object is accessible from raster events, where it can be initialized in\n * \"beforeoperations\" and accessed again in \"afteroperations\".\n *\n * @typedef {function((Array.<Array.<number>>|Array.<ImageData>), Object):\n *     (Array.<number>|ImageData)} Operation\n */\n\n\n/**\n * @enum {string}\n */\nconst RasterEventType = {\n  /**\n   * Triggered before operations are run.\n   * @event ol/source/Raster~RasterSourceEvent#beforeoperations\n   * @api\n   */\n  BEFOREOPERATIONS: 'beforeoperations',\n\n  /**\n   * Triggered after operations are run.\n   * @event ol/source/Raster~RasterSourceEvent#afteroperations\n   * @api\n   */\n  AFTEROPERATIONS: 'afteroperations'\n};\n\n\n/**\n * Raster operation type. Supported values are `'pixel'` and `'image'`.\n * @enum {string}\n */\nconst RasterOperationType = {\n  PIXEL: 'pixel',\n  IMAGE: 'image'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Raster} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Type.\n * @param {module:ol/PluggableMap~FrameState} frameState The frame state.\n * @param {Object} data An object made available to operations.\n */\nconst RasterSourceEvent = function(type, frameState, data) {\n  Event.call(this, type);\n\n  /**\n   * The raster extent.\n   * @type {module:ol/extent~Extent}\n   * @api\n   */\n  this.extent = frameState.extent;\n\n  /**\n   * The pixel resolution (map units per pixel).\n   * @type {number}\n   * @api\n   */\n  this.resolution = frameState.viewState.resolution / frameState.pixelRatio;\n\n  /**\n   * An object made available to all operations.  This can be used by operations\n   * as a storage object (e.g. for calculating statistics).\n   * @type {Object}\n   * @api\n   */\n  this.data = data;\n\n};\ninherits(RasterSourceEvent, Event);\n\n/**\n * @typedef {Object} Options\n * @property {Array.<module:ol/source/Source|module:ol/layer/Layer>} sources Input\n * sources or layers. Vector layers must be configured with `renderMode: 'image'`.\n * @property {module:ol/source/Raster~Operation} [operation] Raster operation.\n * The operation will be called with data from input sources\n * and the output will be assigned to the raster source.\n * @property {Object} [lib] Functions that will be made available to operations run in a worker.\n * @property {number} [threads] By default, operations will be run in a single worker thread.\n * To avoid using workers altogether, set `threads: 0`.  For pixel operations, operations can\n * be run in multiple worker threads.  Note that there is additional overhead in\n * transferring data to multiple workers, and that depending on the user's\n * system, it may not be possible to parallelize the work.\n * @property {module:ol/source/Raster~RasterOperationType} [operationType='pixel'] Operation type.\n * Supported values are `'pixel'` and `'image'`.  By default,\n * `'pixel'` operations are assumed, and operations will be called with an\n * array of pixels from input sources.  If set to `'image'`, operations will\n * be called with an array of ImageData objects from input sources.\n */\n\n\n/**\n * @classdesc\n * A source that transforms data from any number of input sources using an\n * {@link module:ol/source/Raster~Operation} function to transform input pixel values into\n * output pixel values.\n *\n * @constructor\n * @extends {module:ol/source/Image}\n * @fires ol/source/Raster~RasterSourceEvent\n * @param {module:ol/source/Raster~Options=} options Options.\n * @api\n */\nconst RasterSource = function(options) {\n\n  /**\n   * @private\n   * @type {*}\n   */\n  this.worker_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/source/Raster~RasterOperationType}\n   */\n  this.operationType_ = options.operationType !== undefined ?\n    options.operationType : RasterOperationType.PIXEL;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.threads_ = options.threads !== undefined ? options.threads : 1;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/renderer/canvas/Layer>}\n   */\n  this.renderers_ = createRenderers(options.sources);\n\n  for (let r = 0, rr = this.renderers_.length; r < rr; ++r) {\n    listen(this.renderers_[r], EventType.CHANGE,\n      this.changed, this);\n  }\n\n  /**\n   * @private\n   * @type {module:ol/TileQueue}\n   */\n  this.tileQueue_ = new TileQueue(\n    function() {\n      return 1;\n    },\n    this.changed.bind(this));\n\n  const layerStatesArray = getLayerStatesArray(this.renderers_);\n  const layerStates = {};\n  for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    layerStates[getUid(layerStatesArray[i].layer)] = layerStatesArray[i];\n  }\n\n  /**\n   * The most recently requested frame state.\n   * @type {module:ol/PluggableMap~FrameState}\n   * @private\n   */\n  this.requestedFrameState_;\n\n  /**\n   * The most recently rendered image canvas.\n   * @type {module:ol/ImageCanvas}\n   * @private\n   */\n  this.renderedImageCanvas_ = null;\n\n  /**\n   * The most recently rendered revision.\n   * @type {number}\n   */\n  this.renderedRevision_;\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap~FrameState}\n   */\n  this.frameState_ = {\n    animate: false,\n    coordinateToPixelTransform: createTransform(),\n    extent: null,\n    focus: null,\n    index: 0,\n    layerStates: layerStates,\n    layerStatesArray: layerStatesArray,\n    pixelRatio: 1,\n    pixelToCoordinateTransform: createTransform(),\n    postRenderFunctions: [],\n    size: [0, 0],\n    skippedFeatureUids: {},\n    tileQueue: this.tileQueue_,\n    time: Date.now(),\n    usedTiles: {},\n    viewState: /** @type {module:ol/View~State} */ ({\n      rotation: 0\n    }),\n    viewHints: [],\n    wantedTiles: {}\n  };\n\n  ImageSource.call(this, {});\n\n  if (options.operation !== undefined) {\n    this.setOperation(options.operation, options.lib);\n  }\n\n};\n\ninherits(RasterSource, ImageSource);\n\n\n/**\n * Set the operation.\n * @param {module:ol/source/Raster~Operation} operation New operation.\n * @param {Object=} opt_lib Functions that will be available to operations run\n *     in a worker.\n * @api\n */\nRasterSource.prototype.setOperation = function(operation, opt_lib) {\n  this.worker_ = new Processor({\n    operation: operation,\n    imageOps: this.operationType_ === RasterOperationType.IMAGE,\n    queue: 1,\n    lib: opt_lib,\n    threads: this.threads_\n  });\n  this.changed();\n};\n\n\n/**\n * Update the stored frame state.\n * @param {module:ol/extent~Extent} extent The view extent (in map units).\n * @param {number} resolution The view resolution.\n * @param {module:ol/proj/Projection} projection The view projection.\n * @return {module:ol/PluggableMap~FrameState} The updated frame state.\n * @private\n */\nRasterSource.prototype.updateFrameState_ = function(extent, resolution, projection) {\n\n  const frameState = /** @type {module:ol/PluggableMap~FrameState} */ (assign({}, this.frameState_));\n\n  frameState.viewState = /** @type {module:ol/View~State} */ (assign({}, frameState.viewState));\n\n  const center = getCenter(extent);\n\n  frameState.extent = extent.slice();\n  frameState.focus = center;\n  frameState.size[0] = Math.round(getWidth(extent) / resolution);\n  frameState.size[1] = Math.round(getHeight(extent) / resolution);\n  frameState.time = Date.now();\n  frameState.animate = false;\n\n  const viewState = frameState.viewState;\n  viewState.center = center;\n  viewState.projection = projection;\n  viewState.resolution = resolution;\n  return frameState;\n};\n\n\n/**\n * Determine if all sources are ready.\n * @return {boolean} All sources are ready.\n * @private\n */\nRasterSource.prototype.allSourcesReady_ = function() {\n  let ready = true;\n  let source;\n  for (let i = 0, ii = this.renderers_.length; i < ii; ++i) {\n    source = this.renderers_[i].getLayer().getSource();\n    if (source.getState() !== SourceState.READY) {\n      ready = false;\n      break;\n    }\n  }\n  return ready;\n};\n\n\n/**\n * @inheritDoc\n */\nRasterSource.prototype.getImage = function(extent, resolution, pixelRatio, projection) {\n  if (!this.allSourcesReady_()) {\n    return null;\n  }\n\n  const frameState = this.updateFrameState_(extent, resolution, projection);\n  this.requestedFrameState_ = frameState;\n\n  // check if we can't reuse the existing ol/ImageCanvas\n  if (this.renderedImageCanvas_) {\n    const renderedResolution = this.renderedImageCanvas_.getResolution();\n    const renderedExtent = this.renderedImageCanvas_.getExtent();\n    if (resolution !== renderedResolution || !equals(extent, renderedExtent)) {\n      this.renderedImageCanvas_ = null;\n    }\n  }\n\n  if (!this.renderedImageCanvas_ || this.getRevision() !== this.renderedRevision_) {\n    this.processSources_();\n  }\n\n  frameState.tileQueue.loadMoreTiles(16, 16);\n\n  if (frameState.animate) {\n    requestAnimationFrame(this.changed.bind(this));\n  }\n\n  return this.renderedImageCanvas_;\n};\n\n\n/**\n * Start processing source data.\n * @private\n */\nRasterSource.prototype.processSources_ = function() {\n  const frameState = this.requestedFrameState_;\n  const len = this.renderers_.length;\n  const imageDatas = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    const imageData = getImageData(\n      this.renderers_[i], frameState, frameState.layerStatesArray[i]);\n    if (imageData) {\n      imageDatas[i] = imageData;\n    } else {\n      return;\n    }\n  }\n\n  const data = {};\n  this.dispatchEvent(new RasterSourceEvent(RasterEventType.BEFOREOPERATIONS, frameState, data));\n  this.worker_.process(imageDatas, data, this.onWorkerComplete_.bind(this, frameState));\n};\n\n\n/**\n * Called when pixel processing is complete.\n * @param {module:ol/PluggableMap~FrameState} frameState The frame state.\n * @param {Error} err Any error during processing.\n * @param {ImageData} output The output image data.\n * @param {Object} data The user data.\n * @private\n */\nRasterSource.prototype.onWorkerComplete_ = function(frameState, err, output, data) {\n  if (err || !output) {\n    return;\n  }\n\n  // do nothing if extent or resolution changed\n  const extent = frameState.extent;\n  const resolution = frameState.viewState.resolution;\n  if (resolution !== this.requestedFrameState_.viewState.resolution ||\n      !equals(extent, this.requestedFrameState_.extent)) {\n    return;\n  }\n\n  let context;\n  if (this.renderedImageCanvas_) {\n    context = this.renderedImageCanvas_.getImage().getContext('2d');\n  } else {\n    const width = Math.round(getWidth(extent) / resolution);\n    const height = Math.round(getHeight(extent) / resolution);\n    context = createCanvasContext2D(width, height);\n    this.renderedImageCanvas_ = new ImageCanvas(extent, resolution, 1, context.canvas);\n  }\n  context.putImageData(output, 0, 0);\n\n  this.changed();\n  this.renderedRevision_ = this.getRevision();\n\n  this.dispatchEvent(new RasterSourceEvent(RasterEventType.AFTEROPERATIONS, frameState, data));\n};\n\n\n/**\n * A reusable canvas context.\n * @type {CanvasRenderingContext2D}\n * @private\n */\nlet sharedContext = null;\n\n\n/**\n * Get image data from a renderer.\n * @param {module:ol/renderer/canvas/Layer} renderer Layer renderer.\n * @param {module:ol/PluggableMap~FrameState} frameState The frame state.\n * @param {module:ol/layer/Layer~State} layerState The layer state.\n * @return {ImageData} The image data.\n */\nfunction getImageData(renderer, frameState, layerState) {\n  if (!renderer.prepareFrame(frameState, layerState)) {\n    return null;\n  }\n  const width = frameState.size[0];\n  const height = frameState.size[1];\n  if (!sharedContext) {\n    sharedContext = createCanvasContext2D(width, height);\n  } else {\n    const canvas = sharedContext.canvas;\n    if (canvas.width !== width || canvas.height !== height) {\n      sharedContext = createCanvasContext2D(width, height);\n    } else {\n      sharedContext.clearRect(0, 0, width, height);\n    }\n  }\n  renderer.composeFrame(frameState, layerState, sharedContext);\n  return sharedContext.getImageData(0, 0, width, height);\n}\n\n\n/**\n * Get a list of layer states from a list of renderers.\n * @param {Array.<module:ol/renderer/canvas/Layer>} renderers Layer renderers.\n * @return {Array.<module:ol/layer/Layer~State>} The layer states.\n */\nfunction getLayerStatesArray(renderers) {\n  return renderers.map(function(renderer) {\n    return renderer.getLayer().getLayerState();\n  });\n}\n\n\n/**\n * Create renderers for all sources.\n * @param {Array.<module:ol/source/Source>} sources The sources.\n * @return {Array.<module:ol/renderer/canvas/Layer>} Array of layer renderers.\n */\nfunction createRenderers(sources) {\n  const len = sources.length;\n  const renderers = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    renderers[i] = createRenderer(sources[i]);\n  }\n  return renderers;\n}\n\n\n/**\n * Create a renderer for the provided source.\n * @param {module:ol/source/Source} source The source.\n * @return {module:ol/renderer/canvas/Layer} The renderer.\n */\nfunction createRenderer(source) {\n  let renderer = null;\n  if (source instanceof TileSource) {\n    renderer = createTileRenderer(source);\n  } else if (source instanceof ImageSource) {\n    renderer = createImageRenderer(source);\n  } else if (source instanceof TileLayer) {\n    renderer = new CanvasTileLayerRenderer(source);\n  } else if (source instanceof Layer &&\n      (source.getType() == LayerType.IMAGE || source.getType() == LayerType.VECTOR)) {\n    renderer = new CanvasImageLayerRenderer(source);\n  }\n  return renderer;\n}\n\n\n/**\n * Create an image renderer for the provided source.\n * @param {module:ol/source/Image} source The source.\n * @return {module:ol/renderer/canvas/Layer} The renderer.\n */\nfunction createImageRenderer(source) {\n  const layer = new ImageLayer({source: source});\n  return new CanvasImageLayerRenderer(layer);\n}\n\n\n/**\n * Create a tile renderer for the provided source.\n * @param {module:ol/source/Tile} source The source.\n * @return {module:ol/renderer/canvas/Layer} The renderer.\n */\nfunction createTileRenderer(source) {\n  const layer = new TileLayer({source: source});\n  return new CanvasTileLayerRenderer(layer);\n}\n\n\n/**\n * @override\n */\nRasterSource.prototype.getImageInternal = function() {\n  return null; // not implemented\n};\n\n\nexport default RasterSource;\n","/**\n * @module ol/source/Stamen\n */\nimport {inherits} from '../index.js';\nimport {ATTRIBUTION as OSM_ATTRIBUTION} from '../source/OSM.js';\nimport XYZ from '../source/XYZ.js';\n\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst ATTRIBUTIONS = [\n  'Map tiles by <a href=\"https://stamen.com/\">Stamen Design</a>, ' +\n        'under <a href=\"https://creativecommons.org/licenses/by/3.0/\">CC BY' +\n        ' 3.0</a>.',\n  OSM_ATTRIBUTION\n];\n\n\n/**\n * @type {Object.<string, {extension: string, opaque: boolean}>}\n */\nconst LayerConfig = {\n  'terrain': {\n    extension: 'jpg',\n    opaque: true\n  },\n  'terrain-background': {\n    extension: 'jpg',\n    opaque: true\n  },\n  'terrain-labels': {\n    extension: 'png',\n    opaque: false\n  },\n  'terrain-lines': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-background': {\n    extension: 'png',\n    opaque: true\n  },\n  'toner': {\n    extension: 'png',\n    opaque: true\n  },\n  'toner-hybrid': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-labels': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-lines': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-lite': {\n    extension: 'png',\n    opaque: true\n  },\n  'watercolor': {\n    extension: 'jpg',\n    opaque: true\n  }\n};\n\n\n/**\n * @type {Object.<string, {minZoom: number, maxZoom: number}>}\n */\nconst ProviderConfig = {\n  'terrain': {\n    minZoom: 4,\n    maxZoom: 18\n  },\n  'toner': {\n    minZoom: 0,\n    maxZoom: 20\n  },\n  'watercolor': {\n    minZoom: 1,\n    maxZoom: 16\n  }\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [cacheSize=2048] Cache size.\n * @property {string} [layer] Layer.\n * @property {number} [minZoom] Minimum zoom.\n * @property {number} [maxZoom] Maximum zoom.\n * @property {boolean} [opaque] Whether the layer is opaque.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction]\n * Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer source for the Stamen tile server.\n *\n * @constructor\n * @extends {module:ol/source/XYZ}\n * @param {module:ol/source/Stamen~Options=} options Stamen options.\n * @api\n */\nconst Stamen = function(options) {\n  const i = options.layer.indexOf('-');\n  const provider = i == -1 ? options.layer : options.layer.slice(0, i);\n  const providerConfig = ProviderConfig[provider];\n\n  const layerConfig = LayerConfig[options.layer];\n\n  const url = options.url !== undefined ? options.url :\n    'https://stamen-tiles-{a-d}.a.ssl.fastly.net/' + options.layer +\n      '/{z}/{x}/{y}.' + layerConfig.extension;\n\n  XYZ.call(this, {\n    attributions: ATTRIBUTIONS,\n    cacheSize: options.cacheSize,\n    crossOrigin: 'anonymous',\n    maxZoom: options.maxZoom != undefined ? options.maxZoom : providerConfig.maxZoom,\n    minZoom: options.minZoom != undefined ? options.minZoom : providerConfig.minZoom,\n    opaque: layerConfig.opaque,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileLoadFunction: options.tileLoadFunction,\n    url: url,\n    wrapX: options.wrapX\n  });\n};\n\ninherits(Stamen, XYZ);\n\nexport default Stamen;\n","/**\n * @module ol/source/TileArcGISRest\n */\nimport {inherits} from '../index.js';\nimport {createEmpty} from '../extent.js';\nimport {modulo} from '../math.js';\nimport {assign} from '../obj.js';\nimport {toSize, scale as scaleSize} from '../size.js';\nimport TileImage from '../source/TileImage.js';\nimport {hash as tileCoordHash} from '../tilecoord.js';\nimport {appendParams} from '../uri.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.\n * Note that you must provide a `crossOrigin` value if you are using the WebGL renderer\n * or if you want to access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image}\n * for more detail.\n * @property {Object.<string,*>} [params] ArcGIS Rest parameters. This field is optional. Service defaults will be\n * used for any fields not specified. `FORMAT` is `PNG32` by default. `F` is `IMAGE` by\n * default. `TRANSPARENT` is `true` by default.  `BBOX, `SIZE`, `BBOXSR`,\n * and `IMAGESR` will be set dynamically. Set `LAYERS` to\n * override the default service layer visibility. See\n * {@link http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#/Export_Map/02r3000000v7000000/}\n * for further reference.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid. Base this on the resolutions,\n * tilesize and extent supported by the server.\n * If this is not defined, a default grid will be used: if there is a projection\n * extent, the grid will be based on that; if not, a grid based on a global\n * extent with origin at 0,0 will be used.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL.\n * The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url] ArcGIS Rest service URL for a Map Service or Image Service. The\n * url should include /MapServer or /ImageServer.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.  To disable the opacity\n * transition, pass `transition: 0`.\n * @property {Array.<string>} urls ArcGIS Rest service urls. Use this instead of `url` when the ArcGIS\n * Service supports multiple urls for export requests.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data from ArcGIS Rest services. Map and Image\n * Services are supported.\n *\n * For cached ArcGIS services, better performance is available using the\n * {@link module:ol/source/XYZ~XYZ} data source.\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/TileArcGISRest~Options=} opt_options Tile ArcGIS Rest options.\n * @api\n */\nconst TileArcGISRest = function(opt_options) {\n\n  const options = opt_options || {};\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    projection: options.projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileGrid: options.tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.params_ = options.params || {};\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.tmpExtent_ = createEmpty();\n\n  this.setKey(this.getKeyForParams_());\n};\n\ninherits(TileArcGISRest, TileImage);\n\n\n/**\n * @private\n * @return {string} The key for the current params.\n */\nTileArcGISRest.prototype.getKeyForParams_ = function() {\n  let i = 0;\n  const res = [];\n  for (const key in this.params_) {\n    res[i++] = key + '-' + this.params_[key];\n  }\n  return res.join('/');\n};\n\n\n/**\n * Get the user-provided params, i.e. those passed to the constructor through\n * the \"params\" option, and possibly updated using the updateParams method.\n * @return {Object} Params.\n * @api\n */\nTileArcGISRest.prototype.getParams = function() {\n  return this.params_;\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/size~Size} tileSize Tile size.\n * @param {module:ol/extent~Extent} tileExtent Tile extent.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {Object} params Params.\n * @return {string|undefined} Request URL.\n * @private\n */\nTileArcGISRest.prototype.getRequestUrl_ = function(tileCoord, tileSize, tileExtent,\n  pixelRatio, projection, params) {\n\n  const urls = this.urls;\n  if (!urls) {\n    return undefined;\n  }\n\n  // ArcGIS Server only wants the numeric portion of the projection ID.\n  const srid = projection.getCode().split(':').pop();\n\n  params['SIZE'] = tileSize[0] + ',' + tileSize[1];\n  params['BBOX'] = tileExtent.join(',');\n  params['BBOXSR'] = srid;\n  params['IMAGESR'] = srid;\n  params['DPI'] = Math.round(\n    params['DPI'] ? params['DPI'] * pixelRatio : 90 * pixelRatio\n  );\n\n  let url;\n  if (urls.length == 1) {\n    url = urls[0];\n  } else {\n    const index = modulo(tileCoordHash(tileCoord), urls.length);\n    url = urls[index];\n  }\n\n  const modifiedUrl = url\n    .replace(/MapServer\\/?$/, 'MapServer/export')\n    .replace(/ImageServer\\/?$/, 'ImageServer/exportImage');\n  return appendParams(modifiedUrl, params);\n};\n\n\n/**\n * @inheritDoc\n */\nTileArcGISRest.prototype.getTilePixelRatio = function(pixelRatio) {\n  return /** @type {number} */ (pixelRatio);\n};\n\n\n/**\n * @inheritDoc\n */\nTileArcGISRest.prototype.fixedTileUrlFunction = function(tileCoord, pixelRatio, projection) {\n\n  let tileGrid = this.getTileGrid();\n  if (!tileGrid) {\n    tileGrid = this.getTileGridForProjection(projection);\n  }\n\n  if (tileGrid.getResolutions().length <= tileCoord[0]) {\n    return undefined;\n  }\n\n  const tileExtent = tileGrid.getTileCoordExtent(\n    tileCoord, this.tmpExtent_);\n  let tileSize = toSize(\n    tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n  if (pixelRatio != 1) {\n    tileSize = scaleSize(tileSize, pixelRatio, this.tmpSize);\n  }\n\n  // Apply default params and override with user specified values.\n  const baseParams = {\n    'F': 'image',\n    'FORMAT': 'PNG32',\n    'TRANSPARENT': true\n  };\n  assign(baseParams, this.params_);\n\n  return this.getRequestUrl_(tileCoord, tileSize, tileExtent,\n    pixelRatio, projection, baseParams);\n};\n\n\n/**\n * Update the user-provided params.\n * @param {Object} params Params.\n * @api\n */\nTileArcGISRest.prototype.updateParams = function(params) {\n  assign(this.params_, params);\n  this.setKey(this.getKeyForParams_());\n};\nexport default TileArcGISRest;\n","/**\n * @module ol/source/TileDebug\n */\nimport {inherits} from '../index.js';\nimport Tile from '../Tile.js';\nimport TileState from '../TileState.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {toSize} from '../size.js';\nimport TileSource from '../source/Tile.js';\nimport {getKeyZXY} from '../tilecoord.js';\n\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/size~Size} tileSize Tile size.\n * @param {string} text Text.\n */\nconst LabeledTile = function(tileCoord, tileSize, text) {\n\n  Tile.call(this, tileCoord, TileState.LOADED);\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.tileSize_ = tileSize;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = text;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n};\ninherits(LabeledTile, Tile);\n\n\n/**\n * Get the image element for this tile.\n * @return {HTMLCanvasElement} Image.\n */\nLabeledTile.prototype.getImage = function() {\n  if (this.canvas_) {\n    return this.canvas_;\n  } else {\n    const tileSize = this.tileSize_;\n    const context = createCanvasContext2D(tileSize[0], tileSize[1]);\n\n    context.strokeStyle = 'black';\n    context.strokeRect(0.5, 0.5, tileSize[0] + 0.5, tileSize[1] + 0.5);\n\n    context.fillStyle = 'black';\n    context.textAlign = 'center';\n    context.textBaseline = 'middle';\n    context.font = '24px sans-serif';\n    context.fillText(this.text_, tileSize[0] / 2, tileSize[1] / 2);\n\n    this.canvas_ = context.canvas;\n    return context.canvas;\n  }\n};\n\n\n/**\n * @override\n */\nLabeledTile.prototype.load = function() {};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * A pseudo tile source, which does not fetch tiles from a server, but renders\n * a grid outline for the tile grid/projection along with the coordinates for\n * each tile. See examples/canvas-tiles for an example.\n *\n * Uses Canvas context2d, so requires Canvas support.\n *\n * @constructor\n * @extends {module:ol/source/Tile}\n * @param {module:ol/source/TileDebug~Options=} options Debug tile options.\n * @api\n */\nconst TileDebug = function(options) {\n\n  TileSource.call(this, {\n    opaque: false,\n    projection: options.projection,\n    tileGrid: options.tileGrid,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true\n  });\n\n};\n\ninherits(TileDebug, TileSource);\n\n\n/**\n * @inheritDoc\n */\nTileDebug.prototype.getTile = function(z, x, y) {\n  const tileCoordKey = getKeyZXY(z, x, y);\n  if (this.tileCache.containsKey(tileCoordKey)) {\n    return /** @type {!module:ol/source/TileDebug~LabeledTile} */ (this.tileCache.get(tileCoordKey));\n  } else {\n    const tileSize = toSize(this.tileGrid.getTileSize(z));\n    const tileCoord = [z, x, y];\n    const textTileCoord = this.getTileCoordForTileUrlFunction(tileCoord);\n    const text = !textTileCoord ? '' :\n      this.getTileCoordForTileUrlFunction(textTileCoord).toString();\n    const tile = new LabeledTile(tileCoord, tileSize, text);\n    this.tileCache.set(tileCoordKey, tile);\n    return tile;\n  }\n};\n\n\nexport default TileDebug;\n","/**\n * @module ol/source/TileJSON\n */\n// FIXME check order of async callbacks\n\n/**\n * @see http://mapbox.com/developers/api/\n */\n\nimport {inherits} from '../index.js';\nimport {createFromTemplates} from '../tileurlfunction.js';\nimport {assert} from '../asserts.js';\nimport {applyTransform, intersects} from '../extent.js';\nimport {jsonp as requestJSONP} from '../net.js';\nimport {get as getProjection, getTransformFromProjections} from '../proj.js';\nimport SourceState from '../source/State.js';\nimport TileImage from '../source/TileImage.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {boolean} [jsonp=false] Use JSONP with callback to load the TileJSON.\n * Useful when the server does not support CORS..\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {tileJSON} [tileJSON] TileJSON configuration for this source.\n * If not provided, `url` must be configured.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url] URL to the TileJSON file. If not provided, `tileJSON` must be configured.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data in TileJSON format.\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/TileJSON~Options=} options TileJSON options.\n * @api\n */\nconst TileJSON = function(options) {\n\n  /**\n   * @type {TileJSON}\n   * @private\n   */\n  this.tileJSON_ = null;\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    projection: getProjection('EPSG:3857'),\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    state: SourceState.LOADING,\n    tileLoadFunction: options.tileLoadFunction,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n  if (options.url) {\n    if (options.jsonp) {\n      requestJSONP(options.url, this.handleTileJSONResponse.bind(this),\n        this.handleTileJSONError.bind(this));\n    } else {\n      const client = new XMLHttpRequest();\n      client.addEventListener('load', this.onXHRLoad_.bind(this));\n      client.addEventListener('error', this.onXHRError_.bind(this));\n      client.open('GET', options.url);\n      client.send();\n    }\n  } else if (options.tileJSON) {\n    this.handleTileJSONResponse(options.tileJSON);\n  } else {\n    assert(false, 51); // Either `url` or `tileJSON` options must be provided\n  }\n\n};\n\ninherits(TileJSON, TileImage);\n\n\n/**\n * @private\n * @param {Event} event The load event.\n */\nTileJSON.prototype.onXHRLoad_ = function(event) {\n  const client = /** @type {XMLHttpRequest} */ (event.target);\n  // status will be 0 for file:// urls\n  if (!client.status || client.status >= 200 && client.status < 300) {\n    let response;\n    try {\n      response = /** @type {TileJSON} */(JSON.parse(client.responseText));\n    } catch (err) {\n      this.handleTileJSONError();\n      return;\n    }\n    this.handleTileJSONResponse(response);\n  } else {\n    this.handleTileJSONError();\n  }\n};\n\n\n/**\n * @private\n * @param {Event} event The error event.\n */\nTileJSON.prototype.onXHRError_ = function(event) {\n  this.handleTileJSONError();\n};\n\n\n/**\n * @return {TileJSON} The tilejson object.\n * @api\n */\nTileJSON.prototype.getTileJSON = function() {\n  return this.tileJSON_;\n};\n\n\n/**\n * @protected\n * @param {TileJSON} tileJSON Tile JSON.\n */\nTileJSON.prototype.handleTileJSONResponse = function(tileJSON) {\n\n  const epsg4326Projection = getProjection('EPSG:4326');\n\n  const sourceProjection = this.getProjection();\n  let extent;\n  if (tileJSON.bounds !== undefined) {\n    const transform = getTransformFromProjections(\n      epsg4326Projection, sourceProjection);\n    extent = applyTransform(tileJSON.bounds, transform);\n  }\n\n  const minZoom = tileJSON.minzoom || 0;\n  const maxZoom = tileJSON.maxzoom || 22;\n  const tileGrid = createXYZ({\n    extent: extentFromProjection(sourceProjection),\n    maxZoom: maxZoom,\n    minZoom: minZoom\n  });\n  this.tileGrid = tileGrid;\n\n  this.tileUrlFunction = createFromTemplates(tileJSON.tiles, tileGrid);\n\n  if (tileJSON.attribution !== undefined && !this.getAttributions()) {\n    const attributionExtent = extent !== undefined ?\n      extent : epsg4326Projection.getExtent();\n\n    this.setAttributions(function(frameState) {\n      if (intersects(attributionExtent, frameState.extent)) {\n        return [tileJSON.attribution];\n      }\n      return null;\n    });\n\n  }\n  this.tileJSON_ = tileJSON;\n  this.setState(SourceState.READY);\n\n};\n\n\n/**\n * @protected\n */\nTileJSON.prototype.handleTileJSONError = function() {\n  this.setState(SourceState.ERROR);\n};\nexport default TileJSON;\n","/**\n * @module ol/source/TileWMS\n */\n\nimport {DEFAULT_WMS_VERSION} from './common.js';\nimport {inherits} from '../index.js';\nimport {assert} from '../asserts.js';\nimport {buffer, createEmpty} from '../extent.js';\nimport {assign} from '../obj.js';\nimport {modulo} from '../math.js';\nimport {get as getProjection, transform, transformExtent} from '../proj.js';\nimport {calculateSourceResolution} from '../reproj.js';\nimport {toSize, buffer as bufferSize, scale as scaleSize} from '../size.js';\nimport TileImage from '../source/TileImage.js';\nimport WMSServerType from '../source/WMSServerType.js';\nimport {hash as tileCoordHash} from '../tilecoord.js';\nimport {compareVersions} from '../string.js';\nimport {appendParams} from '../uri.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {Object.<string,*>} params WMS request parameters.\n * At least a `LAYERS` param is required. `STYLES` is\n * `''` by default. `VERSION` is `1.3.0` by default. `WIDTH`, `HEIGHT`, `BBOX`\n * and `CRS` (`SRS` for WMS version < 1.3.0) will be set dynamically.\n * @property {number} [gutter=0]\n * The size in pixels of the gutter around image tiles to ignore. By setting\n * this property to a non-zero value, images will be requested that are wider\n * and taller than the tile size by a value of `2 x gutter`.\n * Using a non-zero value allows artifacts of rendering at tile edges to be\n * ignored. If you control the WMS service it is recommended to address\n * \"artifacts at tile edges\" issues by properly configuring the WMS service. For\n * example, MapServer has a `tile_map_edge_buffer` configuration parameter for\n * this. See http://mapserver.org/output/tile_mode.html.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting\n * the image from the remote server.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/ImageTile~TileClass} [tileClass] Class used to instantiate image tiles.\n * Default is {@link module:ol/ImageTile~TileClass}.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid. Base this on the resolutions,\n * tilesize and extent supported by the server.\n * If this is not defined, a default grid will be used: if there is a projection\n * extent, the grid will be based on that; if not, a grid based on a global\n * extent with origin at 0,0 will be used..\n * @property {module:ol/source/WMSServerType|string} [serverType]\n * The type of the remote WMS server. Currently only used when `hidpi` is\n * `true`.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url] WMS service URL.\n * @property {Array.<string>} [urls] WMS service urls.\n * Use this instead of `url` when the WMS supports multiple urls for GetMap requests.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * When set to `false`, only one world\n * will be rendered. When `true`, tiles will be requested for one world only,\n * but they will be wrapped horizontally to render multiple worlds.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data from WMS servers.\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/TileWMS~Options=} [opt_options] Tile WMS options.\n * @api\n */\nconst TileWMS = function(opt_options) {\n\n  const options = opt_options || {};\n\n  const params = options.params || {};\n\n  const transparent = 'TRANSPARENT' in params ? params['TRANSPARENT'] : true;\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    opaque: !transparent,\n    projection: options.projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileClass: options.tileClass,\n    tileGrid: options.tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.gutter_ = options.gutter !== undefined ? options.gutter : 0;\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.params_ = params;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.v13_ = true;\n\n  /**\n   * @private\n   * @type {module:ol/source/WMSServerType|undefined}\n   */\n  this.serverType_ = /** @type {module:ol/source/WMSServerType|undefined} */ (options.serverType);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.tmpExtent_ = createEmpty();\n\n  this.updateV13_();\n  this.setKey(this.getKeyForParams_());\n\n};\n\ninherits(TileWMS, TileImage);\n\n\n/**\n * Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n * constructed.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @param {!Object} params GetFeatureInfo params. `INFO_FORMAT` at least should\n *     be provided. If `QUERY_LAYERS` is not provided then the layers specified\n *     in the `LAYERS` parameter will be used. `VERSION` should not be\n *     specified here.\n * @return {string|undefined} GetFeatureInfo URL.\n * @api\n */\nTileWMS.prototype.getGetFeatureInfoUrl = function(coordinate, resolution, projection, params) {\n  const projectionObj = getProjection(projection);\n  const sourceProjectionObj = this.getProjection();\n\n  let tileGrid = this.getTileGrid();\n  if (!tileGrid) {\n    tileGrid = this.getTileGridForProjection(projectionObj);\n  }\n\n  const tileCoord = tileGrid.getTileCoordForCoordAndResolution(coordinate, resolution);\n\n  if (tileGrid.getResolutions().length <= tileCoord[0]) {\n    return undefined;\n  }\n\n  let tileResolution = tileGrid.getResolution(tileCoord[0]);\n  let tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent_);\n  let tileSize = toSize(tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n\n  const gutter = this.gutter_;\n  if (gutter !== 0) {\n    tileSize = bufferSize(tileSize, gutter, this.tmpSize);\n    tileExtent = buffer(tileExtent, tileResolution * gutter, tileExtent);\n  }\n\n  if (sourceProjectionObj && sourceProjectionObj !== projectionObj) {\n    tileResolution = calculateSourceResolution(sourceProjectionObj, projectionObj, coordinate, tileResolution);\n    tileExtent = transformExtent(tileExtent, projectionObj, sourceProjectionObj);\n    coordinate = transform(coordinate, projectionObj, sourceProjectionObj);\n  }\n\n  const baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetFeatureInfo',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true,\n    'QUERY_LAYERS': this.params_['LAYERS']\n  };\n  assign(baseParams, this.params_, params);\n\n  const x = Math.floor((coordinate[0] - tileExtent[0]) / tileResolution);\n  const y = Math.floor((tileExtent[3] - coordinate[1]) / tileResolution);\n\n  baseParams[this.v13_ ? 'I' : 'X'] = x;\n  baseParams[this.v13_ ? 'J' : 'Y'] = y;\n\n  return this.getRequestUrl_(tileCoord, tileSize, tileExtent,\n    1, sourceProjectionObj || projectionObj, baseParams);\n};\n\n\n/**\n * @inheritDoc\n */\nTileWMS.prototype.getGutterInternal = function() {\n  return this.gutter_;\n};\n\n\n/**\n * Get the user-provided params, i.e. those passed to the constructor through\n * the \"params\" option, and possibly updated using the updateParams method.\n * @return {Object} Params.\n * @api\n */\nTileWMS.prototype.getParams = function() {\n  return this.params_;\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/size~Size} tileSize Tile size.\n * @param {module:ol/extent~Extent} tileExtent Tile extent.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {Object} params Params.\n * @return {string|undefined} Request URL.\n * @private\n */\nTileWMS.prototype.getRequestUrl_ = function(tileCoord, tileSize, tileExtent,\n  pixelRatio, projection, params) {\n\n  const urls = this.urls;\n  if (!urls) {\n    return undefined;\n  }\n\n  params['WIDTH'] = tileSize[0];\n  params['HEIGHT'] = tileSize[1];\n\n  params[this.v13_ ? 'CRS' : 'SRS'] = projection.getCode();\n\n  if (!('STYLES' in this.params_)) {\n    params['STYLES'] = '';\n  }\n\n  if (pixelRatio != 1) {\n    switch (this.serverType_) {\n      case WMSServerType.GEOSERVER:\n        const dpi = (90 * pixelRatio + 0.5) | 0;\n        if ('FORMAT_OPTIONS' in params) {\n          params['FORMAT_OPTIONS'] += ';dpi:' + dpi;\n        } else {\n          params['FORMAT_OPTIONS'] = 'dpi:' + dpi;\n        }\n        break;\n      case WMSServerType.MAPSERVER:\n        params['MAP_RESOLUTION'] = 90 * pixelRatio;\n        break;\n      case WMSServerType.CARMENTA_SERVER:\n      case WMSServerType.QGIS:\n        params['DPI'] = 90 * pixelRatio;\n        break;\n      default:\n        assert(false, 52); // Unknown `serverType` configured\n        break;\n    }\n  }\n\n  const axisOrientation = projection.getAxisOrientation();\n  const bbox = tileExtent;\n  if (this.v13_ && axisOrientation.substr(0, 2) == 'ne') {\n    let tmp;\n    tmp = tileExtent[0];\n    bbox[0] = tileExtent[1];\n    bbox[1] = tmp;\n    tmp = tileExtent[2];\n    bbox[2] = tileExtent[3];\n    bbox[3] = tmp;\n  }\n  params['BBOX'] = bbox.join(',');\n\n  let url;\n  if (urls.length == 1) {\n    url = urls[0];\n  } else {\n    const index = modulo(tileCoordHash(tileCoord), urls.length);\n    url = urls[index];\n  }\n  return appendParams(url, params);\n};\n\n\n/**\n * @inheritDoc\n */\nTileWMS.prototype.getTilePixelRatio = function(pixelRatio) {\n  return (!this.hidpi_ || this.serverType_ === undefined) ? 1 :\n  /** @type {number} */ (pixelRatio);\n};\n\n\n/**\n * @private\n * @return {string} The key for the current params.\n */\nTileWMS.prototype.getKeyForParams_ = function() {\n  let i = 0;\n  const res = [];\n  for (const key in this.params_) {\n    res[i++] = key + '-' + this.params_[key];\n  }\n  return res.join('/');\n};\n\n\n/**\n * @inheritDoc\n */\nTileWMS.prototype.fixedTileUrlFunction = function(tileCoord, pixelRatio, projection) {\n\n  let tileGrid = this.getTileGrid();\n  if (!tileGrid) {\n    tileGrid = this.getTileGridForProjection(projection);\n  }\n\n  if (tileGrid.getResolutions().length <= tileCoord[0]) {\n    return undefined;\n  }\n\n  if (pixelRatio != 1 && (!this.hidpi_ || this.serverType_ === undefined)) {\n    pixelRatio = 1;\n  }\n\n  const tileResolution = tileGrid.getResolution(tileCoord[0]);\n  let tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent_);\n  let tileSize = toSize(\n    tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n  const gutter = this.gutter_;\n  if (gutter !== 0) {\n    tileSize = bufferSize(tileSize, gutter, this.tmpSize);\n    tileExtent = buffer(tileExtent, tileResolution * gutter, tileExtent);\n  }\n\n  if (pixelRatio != 1) {\n    tileSize = scaleSize(tileSize, pixelRatio, this.tmpSize);\n  }\n\n  const baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetMap',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true\n  };\n  assign(baseParams, this.params_);\n\n  return this.getRequestUrl_(tileCoord, tileSize, tileExtent,\n    pixelRatio, projection, baseParams);\n};\n\n/**\n * Update the user-provided params.\n * @param {Object} params Params.\n * @api\n */\nTileWMS.prototype.updateParams = function(params) {\n  assign(this.params_, params);\n  this.updateV13_();\n  this.setKey(this.getKeyForParams_());\n};\n\n\n/**\n * @private\n */\nTileWMS.prototype.updateV13_ = function() {\n  const version = this.params_['VERSION'] || DEFAULT_WMS_VERSION;\n  this.v13_ = compareVersions(version, '1.3') >= 0;\n};\nexport default TileWMS;\n","/**\n * @module ol/source/UTFGrid\n */\nimport {inherits} from '../index.js';\nimport Tile from '../Tile.js';\nimport TileState from '../TileState.js';\nimport {createFromTemplates, nullTileUrlFunction} from '../tileurlfunction.js';\nimport {assert} from '../asserts.js';\nimport {listenOnce} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {applyTransform, intersects} from '../extent.js';\nimport {jsonp as requestJSONP} from '../net.js';\nimport {get as getProjection, getTransformFromProjections} from '../proj.js';\nimport SourceState from '../source/State.js';\nimport TileSource from '../source/Tile.js';\nimport {getKeyZXY} from '../tilecoord.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {string} src Image source URI.\n * @param {module:ol/extent~Extent} extent Extent of the tile.\n * @param {boolean} preemptive Load the tile when visible (before it's needed).\n * @param {boolean} jsonp Load the tile as a script.\n */\nexport const CustomTile = function(tileCoord, state, src, extent, preemptive, jsonp) {\n\n  Tile.call(this, tileCoord, state);\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = extent;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.preemptive_ = preemptive;\n\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.grid_ = null;\n\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.keys_ = null;\n\n  /**\n   * @private\n   * @type {Object.<string, Object>|undefined}\n   */\n  this.data_ = null;\n\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.jsonp_ = jsonp;\n\n};\ninherits(CustomTile, Tile);\n\n\n/**\n * Get the image element for this tile.\n * @return {Image} Image.\n */\nCustomTile.prototype.getImage = function() {\n  return null;\n};\n\n\n/**\n * Synchronously returns data at given coordinate (if available).\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {*} The data.\n */\nCustomTile.prototype.getData = function(coordinate) {\n  if (!this.grid_ || !this.keys_) {\n    return null;\n  }\n  const xRelative = (coordinate[0] - this.extent_[0]) /\n      (this.extent_[2] - this.extent_[0]);\n  const yRelative = (coordinate[1] - this.extent_[1]) /\n      (this.extent_[3] - this.extent_[1]);\n\n  const row = this.grid_[Math.floor((1 - yRelative) * this.grid_.length)];\n\n  if (typeof row !== 'string') {\n    return null;\n  }\n\n  let code = row.charCodeAt(Math.floor(xRelative * row.length));\n  if (code >= 93) {\n    code--;\n  }\n  if (code >= 35) {\n    code--;\n  }\n  code -= 32;\n\n  let data = null;\n  if (code in this.keys_) {\n    const id = this.keys_[code];\n    if (this.data_ && id in this.data_) {\n      data = this.data_[id];\n    } else {\n      data = id;\n    }\n  }\n  return data;\n};\n\n\n/**\n * Calls the callback (synchronously by default) with the available data\n * for given coordinate (or `null` if not yet loaded).\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {function(this: T, *)} callback Callback.\n * @param {T=} opt_this The object to use as `this` in the callback.\n * @param {boolean=} opt_request If `true` the callback is always async.\n *                               The tile data is requested if not yet loaded.\n * @template T\n */\nCustomTile.prototype.forDataAtCoordinate = function(coordinate, callback, opt_this, opt_request) {\n  if (this.state == TileState.IDLE && opt_request === true) {\n    listenOnce(this, EventType.CHANGE, function(e) {\n      callback.call(opt_this, this.getData(coordinate));\n    }, this);\n    this.loadInternal_();\n  } else {\n    if (opt_request === true) {\n      setTimeout(function() {\n        callback.call(opt_this, this.getData(coordinate));\n      }.bind(this), 0);\n    } else {\n      callback.call(opt_this, this.getData(coordinate));\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCustomTile.prototype.getKey = function() {\n  return this.src_;\n};\n\n\n/**\n * @private\n */\nCustomTile.prototype.handleError_ = function() {\n  this.state = TileState.ERROR;\n  this.changed();\n};\n\n\n/**\n * @param {!UTFGridJSON} json UTFGrid data.\n * @private\n */\nCustomTile.prototype.handleLoad_ = function(json) {\n  this.grid_ = json.grid;\n  this.keys_ = json.keys;\n  this.data_ = json.data;\n\n  this.state = TileState.EMPTY;\n  this.changed();\n};\n\n\n/**\n * @private\n */\nCustomTile.prototype.loadInternal_ = function() {\n  if (this.state == TileState.IDLE) {\n    this.state = TileState.LOADING;\n    if (this.jsonp_) {\n      requestJSONP(this.src_, this.handleLoad_.bind(this),\n        this.handleError_.bind(this));\n    } else {\n      const client = new XMLHttpRequest();\n      client.addEventListener('load', this.onXHRLoad_.bind(this));\n      client.addEventListener('error', this.onXHRError_.bind(this));\n      client.open('GET', this.src_);\n      client.send();\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {Event} event The load event.\n */\nCustomTile.prototype.onXHRLoad_ = function(event) {\n  const client = /** @type {XMLHttpRequest} */ (event.target);\n  // status will be 0 for file:// urls\n  if (!client.status || client.status >= 200 && client.status < 300) {\n    let response;\n    try {\n      response = /** @type {!UTFGridJSON} */(JSON.parse(client.responseText));\n    } catch (err) {\n      this.handleError_();\n      return;\n    }\n    this.handleLoad_(response);\n  } else {\n    this.handleError_();\n  }\n};\n\n\n/**\n * @private\n * @param {Event} event The error event.\n */\nCustomTile.prototype.onXHRError_ = function(event) {\n  this.handleError_();\n};\n\n\n/**\n * @override\n */\nCustomTile.prototype.load = function() {\n  if (this.preemptive_) {\n    this.loadInternal_();\n  }\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [preemptive=true]\n * If `true` the UTFGrid source loads the tiles based on their \"visibility\".\n * This improves the speed of response, but increases traffic.\n * Note that if set to `false`, you need to pass `true` as `opt_request`\n * to the `forDataAtCoordinateAndResolution` method otherwise no data\n * will ever be loaded.\n * @property {boolean} [jsonp=false] Use JSONP with callback to load the TileJSON.\n * Useful when the server does not support CORS..\n * @property {tileJSON} [tileJSON] TileJSON configuration for this source.\n * If not provided, `url` must be configured.\n * @property {string} [url] TileJSON endpoint that provides the configuration for this source.\n * Request will be made through JSONP. If not provided, `tileJSON` must be configured.\n */\n\n\n/**\n * @classdesc\n * Layer source for UTFGrid interaction data loaded from TileJSON format.\n *\n * @constructor\n * @extends {module:ol/source/Tile}\n * @param {module:ol/source/UTFGrid~Options=} options Source options.\n * @api\n */\nconst UTFGrid = function(options) {\n  TileSource.call(this, {\n    projection: getProjection('EPSG:3857'),\n    state: SourceState.LOADING\n  });\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.preemptive_ = options.preemptive !== undefined ?\n    options.preemptive : true;\n\n  /**\n   * @private\n   * @type {!module:ol/Tile~UrlFunction}\n   */\n  this.tileUrlFunction_ = nullTileUrlFunction;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.template_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.jsonp_ = options.jsonp || false;\n\n  if (options.url) {\n    if (this.jsonp_) {\n      requestJSONP(options.url, this.handleTileJSONResponse.bind(this),\n        this.handleTileJSONError.bind(this));\n    } else {\n      const client = new XMLHttpRequest();\n      client.addEventListener('load', this.onXHRLoad_.bind(this));\n      client.addEventListener('error', this.onXHRError_.bind(this));\n      client.open('GET', options.url);\n      client.send();\n    }\n  } else if (options.tileJSON) {\n    this.handleTileJSONResponse(options.tileJSON);\n  } else {\n    assert(false, 51); // Either `url` or `tileJSON` options must be provided\n  }\n};\n\ninherits(UTFGrid, TileSource);\n\n\n/**\n * @private\n * @param {Event} event The load event.\n */\nUTFGrid.prototype.onXHRLoad_ = function(event) {\n  const client = /** @type {XMLHttpRequest} */ (event.target);\n  // status will be 0 for file:// urls\n  if (!client.status || client.status >= 200 && client.status < 300) {\n    let response;\n    try {\n      response = /** @type {TileJSON} */(JSON.parse(client.responseText));\n    } catch (err) {\n      this.handleTileJSONError();\n      return;\n    }\n    this.handleTileJSONResponse(response);\n  } else {\n    this.handleTileJSONError();\n  }\n};\n\n\n/**\n * @private\n * @param {Event} event The error event.\n */\nUTFGrid.prototype.onXHRError_ = function(event) {\n  this.handleTileJSONError();\n};\n\n\n/**\n * Return the template from TileJSON.\n * @return {string|undefined} The template from TileJSON.\n * @api\n */\nUTFGrid.prototype.getTemplate = function() {\n  return this.template_;\n};\n\n\n/**\n * Calls the callback (synchronously by default) with the available data\n * for given coordinate and resolution (or `null` if not yet loaded or\n * in case of an error).\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {function(*)} callback Callback.\n * @param {boolean=} opt_request If `true` the callback is always async.\n *                               The tile data is requested if not yet loaded.\n * @api\n */\nUTFGrid.prototype.forDataAtCoordinateAndResolution = function(\n  coordinate, resolution, callback, opt_request) {\n  if (this.tileGrid) {\n    const tileCoord = this.tileGrid.getTileCoordForCoordAndResolution(\n      coordinate, resolution);\n    const tile = /** @type {!module:ol/source/UTFGrid~CustomTile} */(this.getTile(\n      tileCoord[0], tileCoord[1], tileCoord[2], 1, this.getProjection()));\n    tile.forDataAtCoordinate(coordinate, callback, null, opt_request);\n  } else {\n    if (opt_request === true) {\n      setTimeout(function() {\n        callback(null);\n      }, 0);\n    } else {\n      callback(null);\n    }\n  }\n};\n\n\n/**\n * @protected\n */\nUTFGrid.prototype.handleTileJSONError = function() {\n  this.setState(SourceState.ERROR);\n};\n\n\n/**\n * TODO: very similar to ol/source/TileJSON#handleTileJSONResponse\n * @protected\n * @param {TileJSON} tileJSON Tile JSON.\n */\nUTFGrid.prototype.handleTileJSONResponse = function(tileJSON) {\n\n  const epsg4326Projection = getProjection('EPSG:4326');\n\n  const sourceProjection = this.getProjection();\n  let extent;\n  if (tileJSON.bounds !== undefined) {\n    const transform = getTransformFromProjections(\n      epsg4326Projection, sourceProjection);\n    extent = applyTransform(tileJSON.bounds, transform);\n  }\n\n  const minZoom = tileJSON.minzoom || 0;\n  const maxZoom = tileJSON.maxzoom || 22;\n  const tileGrid = createXYZ({\n    extent: extentFromProjection(sourceProjection),\n    maxZoom: maxZoom,\n    minZoom: minZoom\n  });\n  this.tileGrid = tileGrid;\n\n  this.template_ = tileJSON.template;\n\n  const grids = tileJSON.grids;\n  if (!grids) {\n    this.setState(SourceState.ERROR);\n    return;\n  }\n\n  this.tileUrlFunction_ = createFromTemplates(grids, tileGrid);\n\n  if (tileJSON.attribution !== undefined) {\n    const attributionExtent = extent !== undefined ?\n      extent : epsg4326Projection.getExtent();\n\n    this.setAttributions(function(frameState) {\n      if (intersects(attributionExtent, frameState.extent)) {\n        return [tileJSON.attribution];\n      }\n      return null;\n    });\n  }\n\n  this.setState(SourceState.READY);\n\n};\n\n\n/**\n * @inheritDoc\n */\nUTFGrid.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const tileCoordKey = getKeyZXY(z, x, y);\n  if (this.tileCache.containsKey(tileCoordKey)) {\n    return (\n      /** @type {!module:ol/Tile} */ (this.tileCache.get(tileCoordKey))\n    );\n  } else {\n    const tileCoord = [z, x, y];\n    const urlTileCoord =\n        this.getTileCoordForTileUrlFunction(tileCoord, projection);\n    const tileUrl = this.tileUrlFunction_(urlTileCoord, pixelRatio, projection);\n    const tile = new CustomTile(\n      tileCoord,\n      tileUrl !== undefined ? TileState.IDLE : TileState.EMPTY,\n      tileUrl !== undefined ? tileUrl : '',\n      this.tileGrid.getTileCoordExtent(tileCoord),\n      this.preemptive_,\n      this.jsonp_);\n    this.tileCache.set(tileCoordKey, tile);\n    return tile;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nUTFGrid.prototype.useTile = function(z, x, y) {\n  const tileCoordKey = getKeyZXY(z, x, y);\n  if (this.tileCache.containsKey(tileCoordKey)) {\n    this.tileCache.get(tileCoordKey);\n  }\n};\n\n\nexport default UTFGrid;\n","/**\n * @module ol/VectorImageTile\n */\nimport {getUid, inherits} from './index.js';\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {getHeight, getIntersection, getWidth} from './extent.js';\nimport EventType from './events/EventType.js';\nimport {loadFeaturesXhr} from './featureloader.js';\nimport {UNDEFINED} from './functions.js';\n\n\n/**\n * @typedef {Object} ReplayState\n * @property {boolean} dirty\n * @property {null|module:ol/render~OrderFunction} renderedRenderOrder\n * @property {number} renderedTileRevision\n * @property {number} renderedRevision\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {number} sourceRevision Source revision.\n * @param {module:ol/format/Feature} format Feature format.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @param {module:ol/tilecoord~TileCoord} urlTileCoord Wrapped tile coordinate for source urls.\n * @param {module:ol/Tile~UrlFunction} tileUrlFunction Tile url function.\n * @param {module:ol/tilegrid/TileGrid} sourceTileGrid Tile grid of the source.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid of the renderer.\n * @param {Object.<string, module:ol/VectorTile>} sourceTiles Source tiles.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {function(new: module:ol/VectorTile, module:ol/tilecoord~TileCoord, module:ol/TileState, string,\n *     module:ol/format/Feature, module:ol/Tile~LoadFunction)} tileClass Class to\n *     instantiate for source tiles.\n * @param {function(this: module:ol/source/VectorTile, module:ol/events/Event)} handleTileChange\n *     Function to call when a source tile's state changes.\n * @param {number} zoom Integer zoom to render the tile for.\n */\nconst VectorImageTile = function(tileCoord, state, sourceRevision, format,\n  tileLoadFunction, urlTileCoord, tileUrlFunction, sourceTileGrid, tileGrid,\n  sourceTiles, pixelRatio, projection, tileClass, handleTileChange, zoom) {\n\n  Tile.call(this, tileCoord, state, {transition: 0});\n\n  /**\n   * @private\n   * @type {!Object.<string, CanvasRenderingContext2D>}\n   */\n  this.context_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/featureloader~FeatureLoader}\n   */\n  this.loader_;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/VectorImageTile~ReplayState>}\n   */\n  this.replayState_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/VectorTile>}\n   */\n  this.sourceTiles_ = sourceTiles;\n\n  /**\n   * Keys of source tiles used by this tile. Use with {@link #getTile}.\n   * @type {Array.<string>}\n   */\n  this.tileKeys = [];\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent = null;\n\n  /**\n   * @type {number}\n   */\n  this.sourceRevision_ = sourceRevision;\n\n  /**\n   * @type {module:ol/tilecoord~TileCoord}\n   */\n  this.wrappedTileCoord = urlTileCoord;\n\n  /**\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.loadListenerKeys_ = [];\n\n  /**\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.sourceTileListenerKeys_ = [];\n\n  if (urlTileCoord) {\n    const extent = this.extent = tileGrid.getTileCoordExtent(urlTileCoord);\n    const resolution = tileGrid.getResolution(zoom);\n    const sourceZ = sourceTileGrid.getZForResolution(resolution);\n    const useLoadedOnly = zoom != tileCoord[0];\n    let loadCount = 0;\n    sourceTileGrid.forEachTileCoord(extent, sourceZ, function(sourceTileCoord) {\n      let sharedExtent = getIntersection(extent,\n        sourceTileGrid.getTileCoordExtent(sourceTileCoord));\n      const sourceExtent = sourceTileGrid.getExtent();\n      if (sourceExtent) {\n        sharedExtent = getIntersection(sharedExtent, sourceExtent, sharedExtent);\n      }\n      if (getWidth(sharedExtent) / resolution >= 0.5 &&\n          getHeight(sharedExtent) / resolution >= 0.5) {\n        // only include source tile if overlap is at least 1 pixel\n        ++loadCount;\n        const sourceTileKey = sourceTileCoord.toString();\n        let sourceTile = sourceTiles[sourceTileKey];\n        if (!sourceTile && !useLoadedOnly) {\n          const tileUrl = tileUrlFunction(sourceTileCoord, pixelRatio, projection);\n          sourceTile = sourceTiles[sourceTileKey] = new tileClass(sourceTileCoord,\n            tileUrl == undefined ? TileState.EMPTY : TileState.IDLE,\n            tileUrl == undefined ? '' : tileUrl,\n            format, tileLoadFunction);\n          this.sourceTileListenerKeys_.push(\n            listen(sourceTile, EventType.CHANGE, handleTileChange));\n        }\n        if (sourceTile && (!useLoadedOnly || sourceTile.getState() == TileState.LOADED)) {\n          sourceTile.consumers++;\n          this.tileKeys.push(sourceTileKey);\n        }\n      }\n    }.bind(this));\n\n    if (useLoadedOnly && loadCount == this.tileKeys.length) {\n      this.finishLoading_();\n    }\n\n    if (zoom <= tileCoord[0] && this.state != TileState.LOADED) {\n      while (zoom > tileGrid.getMinZoom()) {\n        const tile = new VectorImageTile(tileCoord, state, sourceRevision,\n          format, tileLoadFunction, urlTileCoord, tileUrlFunction,\n          sourceTileGrid, tileGrid, sourceTiles, pixelRatio, projection,\n          tileClass, UNDEFINED, --zoom);\n        if (tile.state == TileState.LOADED) {\n          this.interimTile = tile;\n          break;\n        }\n      }\n    }\n  }\n\n};\n\ninherits(VectorImageTile, Tile);\n\n\n/**\n * @inheritDoc\n */\nVectorImageTile.prototype.disposeInternal = function() {\n  this.state = TileState.ABORT;\n  this.changed();\n  if (this.interimTile) {\n    this.interimTile.dispose();\n  }\n\n  for (let i = 0, ii = this.tileKeys.length; i < ii; ++i) {\n    const sourceTileKey = this.tileKeys[i];\n    const sourceTile = this.getTile(sourceTileKey);\n    sourceTile.consumers--;\n    if (sourceTile.consumers == 0) {\n      delete this.sourceTiles_[sourceTileKey];\n      sourceTile.dispose();\n    }\n  }\n  this.tileKeys.length = 0;\n  this.sourceTiles_ = null;\n  this.loadListenerKeys_.forEach(unlistenByKey);\n  this.loadListenerKeys_.length = 0;\n  this.sourceTileListenerKeys_.forEach(unlistenByKey);\n  this.sourceTileListenerKeys_.length = 0;\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @return {CanvasRenderingContext2D} The rendering context.\n */\nVectorImageTile.prototype.getContext = function(layer) {\n  const key = getUid(layer).toString();\n  if (!(key in this.context_)) {\n    this.context_[key] = createCanvasContext2D();\n  }\n  return this.context_[key];\n};\n\n\n/**\n * Get the Canvas for this tile.\n * @param {module:ol/layer/Layer} layer Layer.\n * @return {HTMLCanvasElement} Canvas.\n */\nVectorImageTile.prototype.getImage = function(layer) {\n  return this.getReplayState(layer).renderedTileRevision == -1 ?\n    null : this.getContext(layer).canvas;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @return {module:ol/VectorImageTile~ReplayState} The replay state.\n */\nVectorImageTile.prototype.getReplayState = function(layer) {\n  const key = getUid(layer).toString();\n  if (!(key in this.replayState_)) {\n    this.replayState_[key] = {\n      dirty: false,\n      renderedRenderOrder: null,\n      renderedRevision: -1,\n      renderedTileRevision: -1\n    };\n  }\n  return this.replayState_[key];\n};\n\n\n/**\n * @inheritDoc\n */\nVectorImageTile.prototype.getKey = function() {\n  return this.tileKeys.join('/') + '-' + this.sourceRevision_;\n};\n\n\n/**\n * @param {string} tileKey Key (tileCoord) of the source tile.\n * @return {module:ol/VectorTile} Source tile.\n */\nVectorImageTile.prototype.getTile = function(tileKey) {\n  return this.sourceTiles_[tileKey];\n};\n\n\n/**\n * @inheritDoc\n */\nVectorImageTile.prototype.load = function() {\n  // Source tiles with LOADED state - we just count them because once they are\n  // loaded, we're no longer listening to state changes.\n  let leftToLoad = 0;\n  // Source tiles with ERROR state - we track them because they can still have\n  // an ERROR state after another load attempt.\n  const errorSourceTiles = {};\n\n  if (this.state == TileState.IDLE) {\n    this.setState(TileState.LOADING);\n  }\n  if (this.state == TileState.LOADING) {\n    this.tileKeys.forEach(function(sourceTileKey) {\n      const sourceTile = this.getTile(sourceTileKey);\n      if (sourceTile.state == TileState.IDLE) {\n        sourceTile.setLoader(this.loader_);\n        sourceTile.load();\n      }\n      if (sourceTile.state == TileState.LOADING) {\n        const key = listen(sourceTile, EventType.CHANGE, function(e) {\n          const state = sourceTile.getState();\n          if (state == TileState.LOADED ||\n              state == TileState.ERROR) {\n            const uid = getUid(sourceTile);\n            if (state == TileState.ERROR) {\n              errorSourceTiles[uid] = true;\n            } else {\n              --leftToLoad;\n              delete errorSourceTiles[uid];\n            }\n            if (leftToLoad - Object.keys(errorSourceTiles).length == 0) {\n              this.finishLoading_();\n            }\n          }\n        }.bind(this));\n        this.loadListenerKeys_.push(key);\n        ++leftToLoad;\n      }\n    }.bind(this));\n  }\n  if (leftToLoad - Object.keys(errorSourceTiles).length == 0) {\n    setTimeout(this.finishLoading_.bind(this), 0);\n  }\n};\n\n\n/**\n * @private\n */\nVectorImageTile.prototype.finishLoading_ = function() {\n  let loaded = this.tileKeys.length;\n  let empty = 0;\n  for (let i = loaded - 1; i >= 0; --i) {\n    const state = this.getTile(this.tileKeys[i]).getState();\n    if (state != TileState.LOADED) {\n      --loaded;\n    }\n    if (state == TileState.EMPTY) {\n      ++empty;\n    }\n  }\n  if (loaded == this.tileKeys.length) {\n    this.loadListenerKeys_.forEach(unlistenByKey);\n    this.loadListenerKeys_.length = 0;\n    this.setState(TileState.LOADED);\n  } else {\n    this.setState(empty == this.tileKeys.length ? TileState.EMPTY : TileState.ERROR);\n  }\n};\n\nexport default VectorImageTile;\n\n/**\n * Sets the loader for a tile.\n * @param {module:ol/VectorTile} tile Vector tile.\n * @param {string} url URL.\n */\nexport function defaultLoadFunction(tile, url) {\n  const loader = loadFeaturesXhr(url, tile.getFormat(), tile.onLoad.bind(tile), tile.onError.bind(tile));\n  tile.setLoader(loader);\n}\n","/**\n * @module ol/source/VectorTile\n */\nimport {inherits} from '../index.js';\nimport TileState from '../TileState.js';\nimport VectorImageTile, {defaultLoadFunction} from '../VectorImageTile.js';\nimport Tile from '../VectorTile.js';\nimport {toSize} from '../size.js';\nimport UrlTile from '../source/UrlTile.js';\nimport {getKeyZXY} from '../tilecoord.js';\nimport {createXYZ, extentFromProjection, createForProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=128] Cache size.\n * @property {module:ol/format/Feature} [format] Feature format for tiles. Used and required by the default.\n * @property {boolean} [overlaps=true] This source may have overlapping geometries. Setting this\n * to `false` (e.g. for sources with polygons that represent administrative\n * boundaries or TopoJSON sources) allows the renderer to optimise fill and\n * stroke operations.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {module:ol/source/State} [state] Source state.\n * @property {module:ol/VectorTile~TileClass} [tileClass] Class used to instantiate image tiles.\n * Default is {@link module:ol/VectorTile}.\n * @property {number} [maxZoom=22] Optional max zoom level.\n * @property {number} [minZoom] Optional min zoom level.\n * @property {number|module:ol/size~Size} [tileSize=512] Optional tile size.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction]\n * Optional function to load a tile given a URL. Could look like this:\n * ```js\n * function(tile, url) {\n *   tile.setLoader(function() {\n *     var data = // ... fetch data\n *     var format = tile.getFormat();\n *     tile.setProjection(format.readProjection(data));\n *     tile.setFeatures(format.readFeatures(data, {\n *       // featureProjection is not required for ol/format/MVT\n *       featureProjection: map.getView().getProjection()\n *     }));\n *     // the line below is only required for ol/format/MVT\n *     tile.setExtent(format.getLastExtent());\n *   };\n * });\n * ```\n * @property {module:ol/Tile~UrlFunction} [tileUrlFunction] Optional function to get tile URL given a tile coordinate and the projection.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`, may be\n * used instead of defining each one separately in the `urls` option.\n * @property {number} [transition] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @property {Array.<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * When set to `false`, only one world\n * will be rendered. When set to `true`, tiles will be wrapped horizontally to\n * render multiple worlds.\n */\n\n\n/**\n * @classdesc\n * Class for layer sources providing vector data divided into a tile grid, to be\n * used with {@link module:ol/layer/VectorTile~VectorTile}. Although this source receives tiles\n * with vector features from the server, it is not meant for feature editing.\n * Features are optimized for rendering, their geometries are clipped at or near\n * tile boundaries and simplified for a view resolution. See\n * {@link module:ol/source/Vector} for vector sources that are suitable for feature\n * editing.\n *\n * @constructor\n * @fires module:ol/source/Tile~TileSourceEvent\n * @extends {module:ol/source/UrlTile}\n * @param {module:ol/source/VectorTile~Options=} options Vector tile options.\n * @api\n */\nconst VectorTile = function(options) {\n  const projection = options.projection || 'EPSG:3857';\n\n  const extent = options.extent || extentFromProjection(projection);\n\n  const tileGrid = options.tileGrid || createXYZ({\n    extent: extent,\n    maxZoom: options.maxZoom || 22,\n    minZoom: options.minZoom,\n    tileSize: options.tileSize || 512\n  });\n\n  UrlTile.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize !== undefined ? options.cacheSize : 128,\n    extent: extent,\n    opaque: false,\n    projection: projection,\n    state: options.state,\n    tileGrid: tileGrid,\n    tileLoadFunction: options.tileLoadFunction ? options.tileLoadFunction : defaultLoadFunction,\n    tileUrlFunction: options.tileUrlFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX === undefined ? true : options.wrapX,\n    transition: options.transition\n  });\n\n  /**\n   * @private\n   * @type {module:ol/format/Feature}\n   */\n  this.format_ = options.format ? options.format : null;\n\n  /**\n     * @private\n     * @type {Object.<string, module:ol/VectorTile>}\n     */\n  this.sourceTiles_ = {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overlaps_ = options.overlaps == undefined ? true : options.overlaps;\n\n  /**\n     * @protected\n     * @type {function(new: module:ol/VectorTile, module:ol/tilecoord~TileCoord, module:ol/TileState, string,\n     *        module:ol/format/Feature, module:ol/Tile~LoadFunction)}\n     */\n  this.tileClass = options.tileClass ? options.tileClass : Tile;\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/tilegrid/TileGrid>}\n   */\n  this.tileGrids_ = {};\n\n};\n\ninherits(VectorTile, UrlTile);\n\n\n/**\n * @return {boolean} The source can have overlapping geometries.\n */\nVectorTile.prototype.getOverlaps = function() {\n  return this.overlaps_;\n};\n\n/**\n * clear {@link module:ol/TileCache~TileCache} and delete all source tiles\n * @api\n */\nVectorTile.prototype.clear = function() {\n  this.tileCache.clear();\n  this.sourceTiles_ = {};\n};\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const tileCoordKey = getKeyZXY(z, x, y);\n  if (this.tileCache.containsKey(tileCoordKey)) {\n    return (\n      /** @type {!module:ol/Tile} */ (this.tileCache.get(tileCoordKey))\n    );\n  } else {\n    const tileCoord = [z, x, y];\n    const urlTileCoord = this.getTileCoordForTileUrlFunction(\n      tileCoord, projection);\n    const tile = new VectorImageTile(\n      tileCoord,\n      urlTileCoord !== null ? TileState.IDLE : TileState.EMPTY,\n      this.getRevision(),\n      this.format_, this.tileLoadFunction, urlTileCoord, this.tileUrlFunction,\n      this.tileGrid, this.getTileGridForProjection(projection),\n      this.sourceTiles_, pixelRatio, projection, this.tileClass,\n      this.handleTileChange.bind(this), tileCoord[0]);\n\n    this.tileCache.set(tileCoordKey, tile);\n    return tile;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.getTileGridForProjection = function(projection) {\n  const code = projection.getCode();\n  let tileGrid = this.tileGrids_[code];\n  if (!tileGrid) {\n    // A tile grid that matches the tile size of the source tile grid is more\n    // likely to have 1:1 relationships between source tiles and rendered tiles.\n    const sourceTileGrid = this.tileGrid;\n    tileGrid = this.tileGrids_[code] = createForProjection(projection, undefined,\n      sourceTileGrid ? sourceTileGrid.getTileSize(sourceTileGrid.getMinZoom()) : undefined);\n  }\n  return tileGrid;\n};\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.getTilePixelRatio = function(pixelRatio) {\n  return pixelRatio;\n};\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.getTilePixelSize = function(z, pixelRatio, projection) {\n  const tileGrid = this.getTileGridForProjection(projection);\n  const tileSize = toSize(tileGrid.getTileSize(z), this.tmpSize);\n  return [Math.round(tileSize[0] * pixelRatio), Math.round(tileSize[1] * pixelRatio)];\n};\nexport default VectorTile;\n","/**\n * @module ol/source/WMTSRequestEncoding\n */\n\n/**\n * Request encoding. One of 'KVP', 'REST'.\n * @enum {string}\n */\nexport default {\n  KVP: 'KVP',  // see spec §8\n  REST: 'REST' // see spec §10\n};\n","/**\n * @module ol/tilegrid/WMTS\n */\nimport {inherits} from '../index.js';\nimport {find} from '../array.js';\nimport {get as getProjection} from '../proj.js';\nimport TileGrid from '../tilegrid/TileGrid.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/extent~Extent} [extent] Extent for the tile grid. No tiles\n * outside this extent will be requested by {@link module:ol/source/Tile} sources.\n * When no `origin` or `origins` are configured, the `origin` will be set to the\n * top-left corner of the extent.\n * @property {module:ol/coordinate~Coordinate} [origin] The tile grid origin, i.e.\n * where the `x` and `y` axes meet (`[z, 0, 0]`). Tile coordinates increase left\n * to right and upwards. If not specified, `extent` or `origins` must be provided.\n * @property {Array.<module:ol/coordinate~Coordinate>} [origins] Tile grid origins,\n * i.e. where the `x` and `y` axes meet (`[z, 0, 0]`), for each zoom level. If\n * given, the array length should match the length of the `resolutions` array, i.e.\n * each resolution can have a different origin. Tile coordinates increase left to\n * right and upwards. If not specified, `extent` or `origin` must be provided.\n * @property {!Array.<number>} resolutions Resolutions. The array index of each\n * resolution needs to match the zoom level. This means that even if a `minZoom`\n * is configured, the resolutions array will have a length of `maxZoom + 1`\n * @property {!Array.<string>} matrixIds matrix IDs. The length of this array needs\n * to match the length of the `resolutions` array.\n * @property {Array.<module:ol/size~Size>} [sizes] Number of tile rows and columns\n * of the grid for each zoom level. The values here are the `TileMatrixWidth` and\n * `TileMatrixHeight` advertised in the GetCapabilities response of the WMTS, and\n * define the grid's extent together with the `origin`.\n * An `extent` can be configured in addition, and will further limit the extent for\n * which tile requests are made by sources. Note that when the top-left corner of\n * the `extent` is used as `origin` or `origins`, then the `y` value must be\n * negative because OpenLayers tile coordinates increase upwards.\n * @property {number|module:ol/size~Size} [tileSize] Tile size.\n * @property {Array.<module:ol/size~Size>} [tileSizes] Tile sizes. The length of\n * this array needs to match the length of the `resolutions` array.\n * @property {Array.<number>} [widths] Number of tile columns that cover the grid's\n * extent for each zoom level. Only required when used with a source that has `wrapX`\n * set to `true`, and only when the grid's origin differs from the one of the\n * projection's extent. The array length has to match the length of the `resolutions`\n * array, i.e. each resolution will have a matching entry here.\n */\n\n\n/**\n * @classdesc\n * Set the grid pattern for sources accessing WMTS tiled-image servers.\n *\n * @constructor\n * @extends {module:ol/tilegrid/TileGrid}\n * @param {module:ol/tilegrid/WMTS~Options} options WMTS options.\n * @struct\n * @api\n */\nconst WMTSTileGrid = function(options) {\n  /**\n   * @private\n   * @type {!Array.<string>}\n   */\n  this.matrixIds_ = options.matrixIds;\n  // FIXME: should the matrixIds become optional?\n\n  TileGrid.call(this, {\n    extent: options.extent,\n    origin: options.origin,\n    origins: options.origins,\n    resolutions: options.resolutions,\n    tileSize: options.tileSize,\n    tileSizes: options.tileSizes,\n    sizes: options.sizes\n  });\n};\n\ninherits(WMTSTileGrid, TileGrid);\n\n\n/**\n * @param {number} z Z.\n * @return {string} MatrixId..\n */\nWMTSTileGrid.prototype.getMatrixId = function(z) {\n  return this.matrixIds_[z];\n};\n\n\n/**\n * Get the list of matrix identifiers.\n * @return {Array.<string>} MatrixIds.\n * @api\n */\nWMTSTileGrid.prototype.getMatrixIds = function() {\n  return this.matrixIds_;\n};\n\nexport default WMTSTileGrid;\n\n/**\n * Create a tile grid from a WMTS capabilities matrix set and an\n * optional TileMatrixSetLimits.\n * @param {Object} matrixSet An object representing a matrixSet in the\n *     capabilities document.\n * @param {module:ol/extent~Extent=} opt_extent An optional extent to restrict the tile\n *     ranges the server provides.\n * @param {Array.<Object>=} opt_matrixLimits An optional object representing\n *     the available matrices for tileGrid.\n * @return {module:ol/tilegrid/WMTS} WMTS tileGrid instance.\n * @api\n */\nexport function createFromCapabilitiesMatrixSet(matrixSet, opt_extent, opt_matrixLimits) {\n\n  /** @type {!Array.<number>} */\n  const resolutions = [];\n  /** @type {!Array.<string>} */\n  const matrixIds = [];\n  /** @type {!Array.<module:ol/coordinate~Coordinate>} */\n  const origins = [];\n  /** @type {!Array.<module:ol/size~Size>} */\n  const tileSizes = [];\n  /** @type {!Array.<module:ol/size~Size>} */\n  const sizes = [];\n\n  const matrixLimits = opt_matrixLimits !== undefined ? opt_matrixLimits : [];\n\n  const supportedCRSPropName = 'SupportedCRS';\n  const matrixIdsPropName = 'TileMatrix';\n  const identifierPropName = 'Identifier';\n  const scaleDenominatorPropName = 'ScaleDenominator';\n  const topLeftCornerPropName = 'TopLeftCorner';\n  const tileWidthPropName = 'TileWidth';\n  const tileHeightPropName = 'TileHeight';\n\n  const code = matrixSet[supportedCRSPropName];\n  const projection = getProjection(code.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n      getProjection(code);\n  const metersPerUnit = projection.getMetersPerUnit();\n  // swap origin x and y coordinates if axis orientation is lat/long\n  const switchOriginXY = projection.getAxisOrientation().substr(0, 2) == 'ne';\n\n  matrixSet[matrixIdsPropName].sort(function(a, b) {\n    return b[scaleDenominatorPropName] - a[scaleDenominatorPropName];\n  });\n\n  matrixSet[matrixIdsPropName].forEach(function(elt) {\n\n    let matrixAvailable;\n    // use of matrixLimits to filter TileMatrices from GetCapabilities\n    // TileMatrixSet from unavailable matrix levels.\n    if (matrixLimits.length > 0) {\n      matrixAvailable = find(matrixLimits, function(elt_ml) {\n        if (elt[identifierPropName] == elt_ml[matrixIdsPropName]) {\n          return true;\n        }\n        // Fallback for tileMatrix identifiers that don't get prefixed\n        // by their tileMatrixSet identifiers.\n        if (elt[identifierPropName].indexOf(':') === -1) {\n          return matrixSet[identifierPropName] + ':' + elt[identifierPropName] === elt_ml[matrixIdsPropName];\n        }\n        return false;\n      });\n    } else {\n      matrixAvailable = true;\n    }\n\n    if (matrixAvailable) {\n      matrixIds.push(elt[identifierPropName]);\n      const resolution = elt[scaleDenominatorPropName] * 0.28E-3 / metersPerUnit;\n      const tileWidth = elt[tileWidthPropName];\n      const tileHeight = elt[tileHeightPropName];\n      if (switchOriginXY) {\n        origins.push([elt[topLeftCornerPropName][1],\n          elt[topLeftCornerPropName][0]]);\n      } else {\n        origins.push(elt[topLeftCornerPropName]);\n      }\n      resolutions.push(resolution);\n      tileSizes.push(tileWidth == tileHeight ?\n        tileWidth : [tileWidth, tileHeight]);\n      // top-left origin, so height is negative\n      sizes.push([elt['MatrixWidth'], -elt['MatrixHeight']]);\n    }\n  });\n\n  return new WMTSTileGrid({\n    extent: opt_extent,\n    origins: origins,\n    resolutions: resolutions,\n    matrixIds: matrixIds,\n    tileSizes: tileSizes,\n    sizes: sizes\n  });\n}\n","/**\n * @module ol/source/WMTS\n */\nimport {inherits} from '../index.js';\nimport {expandUrl, createFromTileUrlFunctions, nullTileUrlFunction} from '../tileurlfunction.js';\nimport {find, findIndex, includes} from '../array.js';\nimport {containsExtent} from '../extent.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, equivalent, transformExtent} from '../proj.js';\nimport TileImage from '../source/TileImage.js';\nimport WMTSRequestEncoding from '../source/WMTSRequestEncoding.js';\nimport {createFromCapabilitiesMatrixSet} from '../tilegrid/WMTS.js';\nimport {appendParams} from '../uri.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {module:ol/tilegrid/WMTS} tileGrid Tile grid.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/source/WMTSRequestEncoding|string} [requestEncoding='KVP'] Request encoding.\n * @property {string} layer Layer name as advertised in the WMTS capabilities.\n * @property {string} style Style name as advertised in the WMTS capabilities.\n * @property {module:ol/ImageTile~TileClass} [tileClass]  Class used to instantiate image tiles. Default is {@link module:ol/ImageTile~ImageTile}.\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service.\n * For example, if the tile service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {string} [version='image/jpeg'] Image format.\n * @property {string} [format='1.0.0'] WMTS version.\n * @property {string} matrixSet Matrix set.\n * @property {!Object} [dimensions] Additional \"dimensions\" for tile requests.\n * This is an object with properties named like the advertised WMTS dimensions.\n * @property {string} [url]  A URL for the service.\n * For the RESTful request encoding, this is a URL\n * template.  For KVP encoding, it is normal URL. A `{?-?}` template pattern,\n * for example `subdomain{a-f}.domain.com`, may be used instead of defining\n * each one separately in the `urls` option.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {Array.<string>} [urls] An array of URLs.\n * Requests will be distributed among the URLs in this array.\n * @property {boolean} [wrapX=false] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data from WMTS servers.\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/WMTS~Options=} options WMTS options.\n * @api\n */\nconst WMTS = function(options) {\n\n  // TODO: add support for TileMatrixLimits\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.version_ = options.version !== undefined ? options.version : '1.0.0';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.format_ = options.format !== undefined ? options.format : 'image/jpeg';\n\n  /**\n   * @private\n   * @type {!Object}\n   */\n  this.dimensions_ = options.dimensions !== undefined ? options.dimensions : {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.layer_ = options.layer;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.matrixSet_ = options.matrixSet;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.style_ = options.style;\n\n  let urls = options.urls;\n  if (urls === undefined && options.url !== undefined) {\n    urls = expandUrl(options.url);\n  }\n\n  // FIXME: should we guess this requestEncoding from options.url(s)\n  //        structure? that would mean KVP only if a template is not provided.\n\n  /**\n   * @private\n   * @type {module:ol/source/WMTSRequestEncoding}\n   */\n  this.requestEncoding_ = options.requestEncoding !== undefined ?\n    /** @type {module:ol/source/WMTSRequestEncoding} */ (options.requestEncoding) :\n    WMTSRequestEncoding.KVP;\n\n  const requestEncoding = this.requestEncoding_;\n\n  // FIXME: should we create a default tileGrid?\n  // we could issue a getCapabilities xhr to retrieve missing configuration\n  const tileGrid = options.tileGrid;\n\n  // context property names are lower case to allow for a case insensitive\n  // replacement as some services use different naming conventions\n  const context = {\n    'layer': this.layer_,\n    'style': this.style_,\n    'tilematrixset': this.matrixSet_\n  };\n\n  if (requestEncoding == WMTSRequestEncoding.KVP) {\n    assign(context, {\n      'Service': 'WMTS',\n      'Request': 'GetTile',\n      'Version': this.version_,\n      'Format': this.format_\n    });\n  }\n\n  const dimensions = this.dimensions_;\n\n  /**\n   * @param {string} template Template.\n   * @return {module:ol/Tile~UrlFunction} Tile URL function.\n   * @private\n   */\n  this.createFromWMTSTemplate_ = function(template) {\n\n    // TODO: we may want to create our own appendParams function so that params\n    // order conforms to wmts spec guidance, and so that we can avoid to escape\n    // special template params\n\n    template = (requestEncoding == WMTSRequestEncoding.KVP) ?\n      appendParams(template, context) :\n      template.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n        return (p.toLowerCase() in context) ? context[p.toLowerCase()] : m;\n      });\n\n    return (\n      /**\n       * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n       * @param {number} pixelRatio Pixel ratio.\n       * @param {module:ol/proj/Projection} projection Projection.\n       * @return {string|undefined} Tile URL.\n       */\n      function(tileCoord, pixelRatio, projection) {\n        if (!tileCoord) {\n          return undefined;\n        } else {\n          const localContext = {\n            'TileMatrix': tileGrid.getMatrixId(tileCoord[0]),\n            'TileCol': tileCoord[1],\n            'TileRow': -tileCoord[2] - 1\n          };\n          assign(localContext, dimensions);\n          let url = template;\n          if (requestEncoding == WMTSRequestEncoding.KVP) {\n            url = appendParams(url, localContext);\n          } else {\n            url = url.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n              return localContext[p];\n            });\n          }\n          return url;\n        }\n      }\n    );\n  };\n\n  const tileUrlFunction = (urls && urls.length > 0) ?\n    createFromTileUrlFunctions(urls.map(this.createFromWMTSTemplate_)) : nullTileUrlFunction;\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    projection: options.projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileClass: options.tileClass,\n    tileGrid: tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    tilePixelRatio: options.tilePixelRatio,\n    tileUrlFunction: tileUrlFunction,\n    urls: urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : false,\n    transition: options.transition\n  });\n\n  this.setKey(this.getKeyForDimensions_());\n\n};\n\ninherits(WMTS, TileImage);\n\n/**\n * Set the URLs to use for requests.\n * URLs may contain OCG conform URL Template Variables: {TileMatrix}, {TileRow}, {TileCol}.\n * @override\n */\nWMTS.prototype.setUrls = function(urls) {\n  this.urls = urls;\n  const key = urls.join('\\n');\n  this.setTileUrlFunction(this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) :\n    createFromTileUrlFunctions(urls.map(this.createFromWMTSTemplate_.bind(this))), key);\n};\n\n/**\n * Get the dimensions, i.e. those passed to the constructor through the\n * \"dimensions\" option, and possibly updated using the updateDimensions\n * method.\n * @return {!Object} Dimensions.\n * @api\n */\nWMTS.prototype.getDimensions = function() {\n  return this.dimensions_;\n};\n\n\n/**\n * Return the image format of the WMTS source.\n * @return {string} Format.\n * @api\n */\nWMTS.prototype.getFormat = function() {\n  return this.format_;\n};\n\n\n/**\n * Return the layer of the WMTS source.\n * @return {string} Layer.\n * @api\n */\nWMTS.prototype.getLayer = function() {\n  return this.layer_;\n};\n\n\n/**\n * Return the matrix set of the WMTS source.\n * @return {string} MatrixSet.\n * @api\n */\nWMTS.prototype.getMatrixSet = function() {\n  return this.matrixSet_;\n};\n\n\n/**\n * Return the request encoding, either \"KVP\" or \"REST\".\n * @return {module:ol/source/WMTSRequestEncoding} Request encoding.\n * @api\n */\nWMTS.prototype.getRequestEncoding = function() {\n  return this.requestEncoding_;\n};\n\n\n/**\n * Return the style of the WMTS source.\n * @return {string} Style.\n * @api\n */\nWMTS.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Return the version of the WMTS source.\n * @return {string} Version.\n * @api\n */\nWMTS.prototype.getVersion = function() {\n  return this.version_;\n};\n\n\n/**\n * @private\n * @return {string} The key for the current dimensions.\n */\nWMTS.prototype.getKeyForDimensions_ = function() {\n  let i = 0;\n  const res = [];\n  for (const key in this.dimensions_) {\n    res[i++] = key + '-' + this.dimensions_[key];\n  }\n  return res.join('/');\n};\n\n\n/**\n * Update the dimensions.\n * @param {Object} dimensions Dimensions.\n * @api\n */\nWMTS.prototype.updateDimensions = function(dimensions) {\n  assign(this.dimensions_, dimensions);\n  this.setKey(this.getKeyForDimensions_());\n};\n\n\n/**\n * Generate source options from a capabilities object.\n * @param {Object} wmtsCap An object representing the capabilities document.\n * @param {!Object} config Configuration properties for the layer.  Defaults for\n *                  the layer will apply if not provided.\n *\n * Required config properties:\n *  - layer - {string} The layer identifier.\n *\n * Optional config properties:\n *  - matrixSet - {string} The matrix set identifier, required if there is\n *       more than one matrix set in the layer capabilities.\n *  - projection - {string} The desired CRS when no matrixSet is specified.\n *       eg: \"EPSG:3857\". If the desired projection is not available,\n *       an error is thrown.\n *  - requestEncoding - {string} url encoding format for the layer. Default is\n *       the first tile url format found in the GetCapabilities response.\n *  - style - {string} The name of the style\n *  - format - {string} Image format for the layer. Default is the first\n *       format returned in the GetCapabilities response.\n *  - crossOrigin - {string|null|undefined} Cross origin. Default is `undefined`.\n * @return {?module:ol/source/WMTS~Options} WMTS source options object or `null` if the layer was not found.\n * @api\n */\nexport function optionsFromCapabilities(wmtsCap, config) {\n  const layers = wmtsCap['Contents']['Layer'];\n  const l = find(layers, function(elt, index, array) {\n    return elt['Identifier'] == config['layer'];\n  });\n  if (l === null) {\n    return null;\n  }\n  const tileMatrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  let idx;\n  if (l['TileMatrixSetLink'].length > 1) {\n    if ('projection' in config) {\n      idx = findIndex(l['TileMatrixSetLink'],\n        function(elt, index, array) {\n          const tileMatrixSet = find(tileMatrixSets, function(el) {\n            return el['Identifier'] == elt['TileMatrixSet'];\n          });\n          const supportedCRS = tileMatrixSet['SupportedCRS'];\n          const proj1 = getProjection(supportedCRS.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n                getProjection(supportedCRS);\n          const proj2 = getProjection(config['projection']);\n          if (proj1 && proj2) {\n            return equivalent(proj1, proj2);\n          } else {\n            return supportedCRS == config['projection'];\n          }\n        });\n    } else {\n      idx = findIndex(l['TileMatrixSetLink'],\n        function(elt, index, array) {\n          return elt['TileMatrixSet'] == config['matrixSet'];\n        });\n    }\n  } else {\n    idx = 0;\n  }\n  if (idx < 0) {\n    idx = 0;\n  }\n  const matrixSet = /** @type {string} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSet']);\n  const matrixLimits = /** @type {Array.<Object>} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSetLimits']);\n\n  let format = /** @type {string} */ (l['Format'][0]);\n  if ('format' in config) {\n    format = config['format'];\n  }\n  idx = findIndex(l['Style'], function(elt, index, array) {\n    if ('style' in config) {\n      return elt['Title'] == config['style'];\n    } else {\n      return elt['isDefault'];\n    }\n  });\n  if (idx < 0) {\n    idx = 0;\n  }\n  const style = /** @type {string} */ (l['Style'][idx]['Identifier']);\n\n  const dimensions = {};\n  if ('Dimension' in l) {\n    l['Dimension'].forEach(function(elt, index, array) {\n      const key = elt['Identifier'];\n      let value = elt['Default'];\n      if (value === undefined) {\n        value = elt['Value'][0];\n      }\n      dimensions[key] = value;\n    });\n  }\n\n  const matrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  const matrixSetObj = find(matrixSets, function(elt, index, array) {\n    return elt['Identifier'] == matrixSet;\n  });\n\n  let projection;\n  const code = matrixSetObj['SupportedCRS'];\n  if (code) {\n    projection = getProjection(code.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n        getProjection(code);\n  }\n  if ('projection' in config) {\n    const projConfig = getProjection(config['projection']);\n    if (projConfig) {\n      if (!projection || equivalent(projConfig, projection)) {\n        projection = projConfig;\n      }\n    }\n  }\n\n  const wgs84BoundingBox = l['WGS84BoundingBox'];\n  let extent, wrapX;\n  if (wgs84BoundingBox !== undefined) {\n    const wgs84ProjectionExtent = getProjection('EPSG:4326').getExtent();\n    wrapX = (wgs84BoundingBox[0] == wgs84ProjectionExtent[0] &&\n        wgs84BoundingBox[2] == wgs84ProjectionExtent[2]);\n    extent = transformExtent(\n      wgs84BoundingBox, 'EPSG:4326', projection);\n    const projectionExtent = projection.getExtent();\n    if (projectionExtent) {\n      // If possible, do a sanity check on the extent - it should never be\n      // bigger than the validity extent of the projection of a matrix set.\n      if (!containsExtent(projectionExtent, extent)) {\n        extent = undefined;\n      }\n    }\n  }\n\n  const tileGrid = createFromCapabilitiesMatrixSet(matrixSetObj, extent, matrixLimits);\n\n  /** @type {!Array.<string>} */\n  const urls = [];\n  let requestEncoding = config['requestEncoding'];\n  requestEncoding = requestEncoding !== undefined ? requestEncoding : '';\n\n  if ('OperationsMetadata' in wmtsCap && 'GetTile' in wmtsCap['OperationsMetadata']) {\n    const gets = wmtsCap['OperationsMetadata']['GetTile']['DCP']['HTTP']['Get'];\n\n    for (let i = 0, ii = gets.length; i < ii; ++i) {\n      if (gets[i]['Constraint']) {\n        const constraint = find(gets[i]['Constraint'], function(element) {\n          return element['name'] == 'GetEncoding';\n        });\n        const encodings = constraint['AllowedValues']['Value'];\n\n        if (requestEncoding === '') {\n          // requestEncoding not provided, use the first encoding from the list\n          requestEncoding = encodings[0];\n        }\n        if (requestEncoding === WMTSRequestEncoding.KVP) {\n          if (includes(encodings, WMTSRequestEncoding.KVP)) {\n            urls.push(/** @type {string} */ (gets[i]['href']));\n          }\n        } else {\n          break;\n        }\n      } else if (gets[i]['href']) {\n        requestEncoding = WMTSRequestEncoding.KVP;\n        urls.push(/** @type {string} */ (gets[i]['href']));\n      }\n    }\n  }\n  if (urls.length === 0) {\n    requestEncoding = WMTSRequestEncoding.REST;\n    l['ResourceURL'].forEach(function(element) {\n      if (element['resourceType'] === 'tile') {\n        format = element['format'];\n        urls.push(/** @type {string} */ (element['template']));\n      }\n    });\n  }\n\n  return {\n    urls: urls,\n    layer: config['layer'],\n    matrixSet: matrixSet,\n    format: format,\n    projection: projection,\n    requestEncoding: requestEncoding,\n    tileGrid: tileGrid,\n    style: style,\n    dimensions: dimensions,\n    wrapX: wrapX,\n    crossOrigin: config['crossOrigin']\n  };\n}\n\nexport default WMTS;\n","/**\n * @module ol/source/Zoomify\n */\nimport {DEFAULT_TILE_SIZE} from '../tilegrid/common.js';\nimport {inherits} from '../index.js';\nimport ImageTile from '../ImageTile.js';\nimport TileState from '../TileState.js';\nimport {expandUrl, createFromTileUrlFunctions} from '../tileurlfunction.js';\nimport {assert} from '../asserts.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {getTopLeft} from '../extent.js';\nimport {toSize} from '../size.js';\nimport TileImage from '../source/TileImage.js';\nimport TileGrid from '../tilegrid/TileGrid.js';\n\n\n/**\n * @enum {string}\n */\nconst TierSizeCalculation = {\n  DEFAULT: 'default',\n  TRUNCATED: 'truncated'\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/ImageTile}\n * @param {module:ol/tilegrid/TileGrid} tileGrid TileGrid that the tile belongs to.\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {string} src Image source URI.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @param {module:ol/Tile~Options=} opt_options Tile options.\n */\nexport const CustomTile = function(\n  tileGrid, tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n\n  ImageTile.call(this, tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options);\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement}\n   */\n  this.zoomifyImage_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.tileSize_ = toSize(tileGrid.getTileSize(tileCoord[0]));\n};\ninherits(CustomTile, ImageTile);\n\n\n/**\n * @inheritDoc\n */\nCustomTile.prototype.getImage = function() {\n  if (this.zoomifyImage_) {\n    return this.zoomifyImage_;\n  }\n  const image = ImageTile.prototype.getImage.call(this);\n  if (this.state == TileState.LOADED) {\n    const tileSize = this.tileSize_;\n    if (image.width == tileSize[0] && image.height == tileSize[1]) {\n      this.zoomifyImage_ = image;\n      return image;\n    } else {\n      const context = createCanvasContext2D(tileSize[0], tileSize[1]);\n      context.drawImage(image, 0, 0);\n      this.zoomifyImage_ = context.canvas;\n      return context.canvas;\n    }\n  } else {\n    return image;\n  }\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {module:ol/proj~ProjectionLike} [projection] Projection.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {string} [url] URL template or base URL of the Zoomify service.\n * A base URL is the fixed part\n * of the URL, excluding the tile group, z, x, and y folder structure, e.g.\n * `http://my.zoomify.info/IMAGE.TIF/`. A URL template must include\n * `{TileGroup}`, `{x}`, `{y}`, and `{z}` placeholders, e.g.\n * `http://my.zoomify.info/IMAGE.TIF/{TileGroup}/{z}-{x}-{y}.jpg`.\n * Internet Imaging Protocol (IIP) with JTL extension can be also used with\n * `{tileIndex}` and `{z}` placeholders, e.g.\n * `http://my.zoomify.info?FIF=IMAGE.TIF&JTL={z},{tileIndex}`.\n * A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`, may be\n * used instead of defining each one separately in the `urls` option.\n * @property {string} [tierSizeCalculation] Tier size calculation method: `default` or `truncated`.\n * @property {module:ol/size~Size} [size] Size of the image.\n * @property {module:ol/extent~Extent} [extent] Extent for the TileGrid that is created.\n * Default sets the TileGrid in the\n * fourth quadrant, meaning extent is `[0, -height, width, 0]`. To change the\n * extent to the first quadrant (the default for OpenLayers 2) set the extent\n * as `[0, 0, width, height]`.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {number} [tileSize=256] Tile size. Same tile size is used for all zoom levels.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data in Zoomify format (both Zoomify and Internet\n * Imaging Protocol are supported).\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/Zoomify~Options=} opt_options Options.\n * @api\n */\nconst Zoomify = function(opt_options) {\n\n  const options = opt_options || {};\n\n  const size = options.size;\n  const tierSizeCalculation = options.tierSizeCalculation !== undefined ?\n    options.tierSizeCalculation :\n    TierSizeCalculation.DEFAULT;\n\n  const imageWidth = size[0];\n  const imageHeight = size[1];\n  const extent = options.extent || [0, -size[1], size[0], 0];\n  const tierSizeInTiles = [];\n  const tileSize = options.tileSize || DEFAULT_TILE_SIZE;\n  let tileSizeForTierSizeCalculation = tileSize;\n\n  switch (tierSizeCalculation) {\n    case TierSizeCalculation.DEFAULT:\n      while (imageWidth > tileSizeForTierSizeCalculation || imageHeight > tileSizeForTierSizeCalculation) {\n        tierSizeInTiles.push([\n          Math.ceil(imageWidth / tileSizeForTierSizeCalculation),\n          Math.ceil(imageHeight / tileSizeForTierSizeCalculation)\n        ]);\n        tileSizeForTierSizeCalculation += tileSizeForTierSizeCalculation;\n      }\n      break;\n    case TierSizeCalculation.TRUNCATED:\n      let width = imageWidth;\n      let height = imageHeight;\n      while (width > tileSizeForTierSizeCalculation || height > tileSizeForTierSizeCalculation) {\n        tierSizeInTiles.push([\n          Math.ceil(width / tileSizeForTierSizeCalculation),\n          Math.ceil(height / tileSizeForTierSizeCalculation)\n        ]);\n        width >>= 1;\n        height >>= 1;\n      }\n      break;\n    default:\n      assert(false, 53); // Unknown `tierSizeCalculation` configured\n      break;\n  }\n\n  tierSizeInTiles.push([1, 1]);\n  tierSizeInTiles.reverse();\n\n  const resolutions = [1];\n  const tileCountUpToTier = [0];\n  for (let i = 1, ii = tierSizeInTiles.length; i < ii; i++) {\n    resolutions.push(1 << i);\n    tileCountUpToTier.push(\n      tierSizeInTiles[i - 1][0] * tierSizeInTiles[i - 1][1] +\n        tileCountUpToTier[i - 1]\n    );\n  }\n  resolutions.reverse();\n\n  const tileGrid = new TileGrid({\n    tileSize: tileSize,\n    extent: extent,\n    origin: getTopLeft(extent),\n    resolutions: resolutions\n  });\n\n  let url = options.url;\n  if (url && url.indexOf('{TileGroup}') == -1 && url.indexOf('{tileIndex}') == -1) {\n    url += '{TileGroup}/{z}-{x}-{y}.jpg';\n  }\n  const urls = expandUrl(url);\n\n  /**\n   * @param {string} template Template.\n   * @return {module:ol/Tile~UrlFunction} Tile URL function.\n   */\n  function createFromTemplate(template) {\n\n    return (\n      /**\n       * @param {module:ol/tilecoord~TileCoord} tileCoord Tile Coordinate.\n       * @param {number} pixelRatio Pixel ratio.\n       * @param {module:ol/proj/Projection} projection Projection.\n       * @return {string|undefined} Tile URL.\n       */\n      function(tileCoord, pixelRatio, projection) {\n        if (!tileCoord) {\n          return undefined;\n        } else {\n          const tileCoordZ = tileCoord[0];\n          const tileCoordX = tileCoord[1];\n          const tileCoordY = -tileCoord[2] - 1;\n          const tileIndex =\n              tileCoordX +\n              tileCoordY * tierSizeInTiles[tileCoordZ][0];\n          const tileSize = tileGrid.getTileSize(tileCoordZ);\n          const tileGroup = ((tileIndex + tileCountUpToTier[tileCoordZ]) / tileSize) | 0;\n          const localContext = {\n            'z': tileCoordZ,\n            'x': tileCoordX,\n            'y': tileCoordY,\n            'tileIndex': tileIndex,\n            'TileGroup': 'TileGroup' + tileGroup\n          };\n          return template.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n            return localContext[p];\n          });\n        }\n      }\n    );\n  }\n\n  const tileUrlFunction = createFromTileUrlFunctions(urls.map(createFromTemplate));\n\n  const ZoomifyTileClass = CustomTile.bind(null, tileGrid);\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    projection: options.projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileClass: ZoomifyTileClass,\n    tileGrid: tileGrid,\n    tileUrlFunction: tileUrlFunction,\n    transition: options.transition\n  });\n\n};\n\ninherits(Zoomify, TileImage);\n\n\nexport default Zoomify;\n","import $ol$Collection from './ol/Collection.js';\nimport $ol$Feature from './ol/Feature.js';\nimport $ol$Geolocation from './ol/Geolocation.js';\nimport $ol$Graticule from './ol/Graticule.js';\nimport $ol$Image from './ol/Image.js';\nimport $ol$ImageTile from './ol/ImageTile.js';\nimport $ol$Kinetic from './ol/Kinetic.js';\nimport $ol$Map from './ol/Map.js';\nimport $ol$MapBrowserEvent from './ol/MapBrowserEvent.js';\nimport $ol$Object from './ol/Object.js';\nimport $ol$Observable from './ol/Observable.js';\nimport $ol$Overlay from './ol/Overlay.js';\nimport $ol$PluggableMap from './ol/PluggableMap.js';\nimport $ol$Tile from './ol/Tile.js';\nimport $ol$VectorTile from './ol/VectorTile.js';\nimport $ol$View from './ol/View.js';\nimport $ol$WebGLMap from './ol/WebGLMap.js';\nimport $ol$control$Attribution from './ol/control/Attribution.js';\nimport $ol$control$Control from './ol/control/Control.js';\nimport $ol$control$FullScreen from './ol/control/FullScreen.js';\nimport $ol$control$MousePosition from './ol/control/MousePosition.js';\nimport $ol$control$OverviewMap from './ol/control/OverviewMap.js';\nimport $ol$control$Rotate from './ol/control/Rotate.js';\nimport $ol$control$ScaleLine from './ol/control/ScaleLine.js';\nimport $ol$control$Zoom from './ol/control/Zoom.js';\nimport $ol$control$ZoomSlider from './ol/control/ZoomSlider.js';\nimport $ol$control$ZoomToExtent from './ol/control/ZoomToExtent.js';\nimport $ol$events$Event from './ol/events/Event.js';\nimport $ol$format$EsriJSON from './ol/format/EsriJSON.js';\nimport $ol$format$Feature from './ol/format/Feature.js';\nimport $ol$format$GML from './ol/format/GML.js';\nimport $ol$format$GML2 from './ol/format/GML2.js';\nimport $ol$format$GML3 from './ol/format/GML3.js';\nimport $ol$format$GMLBase from './ol/format/GMLBase.js';\nimport $ol$format$GPX from './ol/format/GPX.js';\nimport $ol$format$GeoJSON from './ol/format/GeoJSON.js';\nimport $ol$format$IGC from './ol/format/IGC.js';\nimport $ol$format$KML from './ol/format/KML.js';\nimport $ol$format$MVT from './ol/format/MVT.js';\nimport $ol$format$OSMXML from './ol/format/OSMXML.js';\nimport $ol$format$Polyline from './ol/format/Polyline.js';\nimport $ol$format$TopoJSON from './ol/format/TopoJSON.js';\nimport $ol$format$WFS from './ol/format/WFS.js';\nimport $ol$format$WKT from './ol/format/WKT.js';\nimport $ol$format$WMSCapabilities from './ol/format/WMSCapabilities.js';\nimport $ol$format$WMSGetFeatureInfo from './ol/format/WMSGetFeatureInfo.js';\nimport $ol$format$WMTSCapabilities from './ol/format/WMTSCapabilities.js';\nimport $ol$format$filter$Bbox from './ol/format/filter/Bbox.js';\nimport $ol$format$filter$Contains from './ol/format/filter/Contains.js';\nimport $ol$format$filter$During from './ol/format/filter/During.js';\nimport $ol$format$filter$EqualTo from './ol/format/filter/EqualTo.js';\nimport $ol$format$filter$GreaterThan from './ol/format/filter/GreaterThan.js';\nimport $ol$format$filter$GreaterThanOrEqualTo from './ol/format/filter/GreaterThanOrEqualTo.js';\nimport $ol$format$filter$Intersects from './ol/format/filter/Intersects.js';\nimport $ol$format$filter$IsBetween from './ol/format/filter/IsBetween.js';\nimport $ol$format$filter$IsLike from './ol/format/filter/IsLike.js';\nimport $ol$format$filter$IsNull from './ol/format/filter/IsNull.js';\nimport $ol$format$filter$LessThan from './ol/format/filter/LessThan.js';\nimport $ol$format$filter$LessThanOrEqualTo from './ol/format/filter/LessThanOrEqualTo.js';\nimport $ol$format$filter$Not from './ol/format/filter/Not.js';\nimport $ol$format$filter$NotEqualTo from './ol/format/filter/NotEqualTo.js';\nimport $ol$format$filter$Or from './ol/format/filter/Or.js';\nimport $ol$format$filter$Within from './ol/format/filter/Within.js';\nimport $ol$geom$Circle from './ol/geom/Circle.js';\nimport $ol$geom$Geometry from './ol/geom/Geometry.js';\nimport $ol$geom$GeometryCollection from './ol/geom/GeometryCollection.js';\nimport $ol$geom$LineString from './ol/geom/LineString.js';\nimport $ol$geom$LinearRing from './ol/geom/LinearRing.js';\nimport $ol$geom$MultiLineString from './ol/geom/MultiLineString.js';\nimport $ol$geom$MultiPoint from './ol/geom/MultiPoint.js';\nimport $ol$geom$MultiPolygon from './ol/geom/MultiPolygon.js';\nimport $ol$geom$Point from './ol/geom/Point.js';\nimport $ol$geom$Polygon from './ol/geom/Polygon.js';\nimport $ol$geom$SimpleGeometry from './ol/geom/SimpleGeometry.js';\nimport $ol$interaction$DoubleClickZoom from './ol/interaction/DoubleClickZoom.js';\nimport $ol$interaction$DragAndDrop from './ol/interaction/DragAndDrop.js';\nimport $ol$interaction$DragBox from './ol/interaction/DragBox.js';\nimport $ol$interaction$DragPan from './ol/interaction/DragPan.js';\nimport $ol$interaction$DragRotate from './ol/interaction/DragRotate.js';\nimport $ol$interaction$DragRotateAndZoom from './ol/interaction/DragRotateAndZoom.js';\nimport $ol$interaction$DragZoom from './ol/interaction/DragZoom.js';\nimport $ol$interaction$Draw from './ol/interaction/Draw.js';\nimport $ol$interaction$Extent from './ol/interaction/Extent.js';\nimport $ol$interaction$Interaction from './ol/interaction/Interaction.js';\nimport $ol$interaction$KeyboardPan from './ol/interaction/KeyboardPan.js';\nimport $ol$interaction$KeyboardZoom from './ol/interaction/KeyboardZoom.js';\nimport $ol$interaction$Modify from './ol/interaction/Modify.js';\nimport $ol$interaction$MouseWheelZoom from './ol/interaction/MouseWheelZoom.js';\nimport $ol$interaction$PinchRotate from './ol/interaction/PinchRotate.js';\nimport $ol$interaction$PinchZoom from './ol/interaction/PinchZoom.js';\nimport $ol$interaction$Pointer from './ol/interaction/Pointer.js';\nimport $ol$interaction$Select from './ol/interaction/Select.js';\nimport $ol$interaction$Snap from './ol/interaction/Snap.js';\nimport $ol$interaction$Translate from './ol/interaction/Translate.js';\nimport $ol$layer$Base from './ol/layer/Base.js';\nimport $ol$layer$Group from './ol/layer/Group.js';\nimport $ol$layer$Heatmap from './ol/layer/Heatmap.js';\nimport $ol$layer$Image from './ol/layer/Image.js';\nimport $ol$layer$Layer from './ol/layer/Layer.js';\nimport $ol$layer$Tile from './ol/layer/Tile.js';\nimport $ol$layer$Vector from './ol/layer/Vector.js';\nimport $ol$layer$VectorTile from './ol/layer/VectorTile.js';\nimport $ol$proj$Projection from './ol/proj/Projection.js';\nimport $ol$render$Feature from './ol/render/Feature.js';\nimport $ol$render$VectorContext from './ol/render/VectorContext.js';\nimport $ol$render$canvas$Immediate from './ol/render/canvas/Immediate.js';\nimport $ol$render$webgl$Immediate from './ol/render/webgl/Immediate.js';\nimport $ol$renderer$canvas$ImageLayer from './ol/renderer/canvas/ImageLayer.js';\nimport $ol$renderer$canvas$Map from './ol/renderer/canvas/Map.js';\nimport $ol$renderer$canvas$TileLayer from './ol/renderer/canvas/TileLayer.js';\nimport $ol$renderer$canvas$VectorLayer from './ol/renderer/canvas/VectorLayer.js';\nimport $ol$renderer$canvas$VectorTileLayer from './ol/renderer/canvas/VectorTileLayer.js';\nimport $ol$renderer$webgl$ImageLayer from './ol/renderer/webgl/ImageLayer.js';\nimport $ol$renderer$webgl$Map from './ol/renderer/webgl/Map.js';\nimport $ol$renderer$webgl$TileLayer from './ol/renderer/webgl/TileLayer.js';\nimport $ol$renderer$webgl$VectorLayer from './ol/renderer/webgl/VectorLayer.js';\nimport $ol$source$BingMaps from './ol/source/BingMaps.js';\nimport $ol$source$CartoDB from './ol/source/CartoDB.js';\nimport $ol$source$Cluster from './ol/source/Cluster.js';\nimport $ol$source$Image from './ol/source/Image.js';\nimport $ol$source$ImageArcGISRest from './ol/source/ImageArcGISRest.js';\nimport $ol$source$ImageCanvas from './ol/source/ImageCanvas.js';\nimport $ol$source$ImageMapGuide from './ol/source/ImageMapGuide.js';\nimport $ol$source$ImageStatic from './ol/source/ImageStatic.js';\nimport $ol$source$ImageWMS from './ol/source/ImageWMS.js';\nimport $ol$source$OSM from './ol/source/OSM.js';\nimport $ol$source$Raster from './ol/source/Raster.js';\nimport $ol$source$Source from './ol/source/Source.js';\nimport $ol$source$Stamen from './ol/source/Stamen.js';\nimport $ol$source$Tile from './ol/source/Tile.js';\nimport $ol$source$TileArcGISRest from './ol/source/TileArcGISRest.js';\nimport $ol$source$TileDebug from './ol/source/TileDebug.js';\nimport $ol$source$TileImage from './ol/source/TileImage.js';\nimport $ol$source$TileJSON from './ol/source/TileJSON.js';\nimport $ol$source$TileWMS from './ol/source/TileWMS.js';\nimport $ol$source$UTFGrid from './ol/source/UTFGrid.js';\nimport $ol$source$UrlTile from './ol/source/UrlTile.js';\nimport $ol$source$Vector from './ol/source/Vector.js';\nimport $ol$source$VectorTile from './ol/source/VectorTile.js';\nimport $ol$source$WMTS from './ol/source/WMTS.js';\nimport $ol$source$XYZ from './ol/source/XYZ.js';\nimport $ol$source$Zoomify from './ol/source/Zoomify.js';\nimport $ol$structs$LRUCache from './ol/structs/LRUCache.js';\nimport $ol$style$AtlasManager from './ol/style/AtlasManager.js';\nimport $ol$style$Circle from './ol/style/Circle.js';\nimport $ol$style$Fill from './ol/style/Fill.js';\nimport $ol$style$Icon from './ol/style/Icon.js';\nimport $ol$style$IconImageCache from './ol/style/IconImageCache.js';\nimport $ol$style$Image from './ol/style/Image.js';\nimport $ol$style$RegularShape from './ol/style/RegularShape.js';\nimport $ol$style$Stroke from './ol/style/Stroke.js';\nimport $ol$style$Style from './ol/style/Style.js';\nimport $ol$style$Text from './ol/style/Text.js';\nimport $ol$tilegrid$TileGrid from './ol/tilegrid/TileGrid.js';\nimport $ol$tilegrid$WMTS from './ol/tilegrid/WMTS.js';\nimport $ol$webgl$Context from './ol/webgl/Context.js';\nimport * as _ol from './ol/index.js';\nimport * as _ol_Observable from './ol/Observable.js';\nimport * as _ol_color from './ol/color.js';\nimport * as _ol_colorlike from './ol/colorlike.js';\nimport * as _ol_control from './ol/control.js';\nimport * as _ol_control_Attribution from './ol/control/Attribution.js';\nimport * as _ol_control_MousePosition from './ol/control/MousePosition.js';\nimport * as _ol_control_OverviewMap from './ol/control/OverviewMap.js';\nimport * as _ol_control_Rotate from './ol/control/Rotate.js';\nimport * as _ol_control_ScaleLine from './ol/control/ScaleLine.js';\nimport * as _ol_control_ZoomSlider from './ol/control/ZoomSlider.js';\nimport * as _ol_coordinate from './ol/coordinate.js';\nimport * as _ol_easing from './ol/easing.js';\nimport * as _ol_events_condition from './ol/events/condition.js';\nimport * as _ol_extent from './ol/extent.js';\nimport * as _ol_featureloader from './ol/featureloader.js';\nimport * as _ol_format_Polyline from './ol/format/Polyline.js';\nimport * as _ol_format_WFS from './ol/format/WFS.js';\nimport * as _ol_format_filter from './ol/format/filter.js';\nimport * as _ol_geom_Polygon from './ol/geom/Polygon.js';\nimport * as _ol_has from './ol/has.js';\nimport * as _ol_interaction from './ol/interaction.js';\nimport * as _ol_interaction_Draw from './ol/interaction/Draw.js';\nimport * as _ol_interaction_Pointer from './ol/interaction/Pointer.js';\nimport * as _ol_loadingstrategy from './ol/loadingstrategy.js';\nimport * as _ol_proj from './ol/proj.js';\nimport * as _ol_proj_Units from './ol/proj/Units.js';\nimport * as _ol_proj_proj4 from './ol/proj/proj4.js';\nimport * as _ol_render from './ol/render.js';\nimport * as _ol_render_canvas from './ol/render/canvas.js';\nimport * as _ol_size from './ol/size.js';\nimport * as _ol_source_OSM from './ol/source/OSM.js';\nimport * as _ol_source_WMTS from './ol/source/WMTS.js';\nimport * as _ol_sphere from './ol/sphere.js';\nimport * as _ol_style_IconImageCache from './ol/style/IconImageCache.js';\nimport * as _ol_tilegrid from './ol/tilegrid.js';\nimport * as _ol_tilegrid_WMTS from './ol/tilegrid/WMTS.js';\nimport * as _ol_xml from './ol/xml.js';\nconst ol = window['ol'] = {};\nol.color = {};\nol.colorlike = {};\nol.control = {};\nol.coordinate = {};\nol.easing = {};\nol.events = {};\nol.events.condition = {};\nol.extent = {};\nol.featureloader = {};\nol.format = {};\nol.format.filter = {};\nol.geom = {};\nol.has = {};\nol.interaction = {};\nol.layer = {};\nol.loadingstrategy = {};\nol.proj = {};\nol.proj.Units = {};\nol.proj.proj4 = {};\nol.render = {};\nol.render.canvas = {};\nol.renderer = {};\nol.renderer.canvas = {};\nol.renderer.webgl = {};\nol.size = {};\nol.source = {};\nol.sphere = {};\nol.style = {};\nol.style.IconImageCache = {};\nol.tilegrid = {};\nol.xml = {};\nol.Collection = $ol$Collection;\nol.Feature = $ol$Feature;\nol.Geolocation = $ol$Geolocation;\nol.Graticule = $ol$Graticule;\nol.Kinetic = $ol$Kinetic;\nol.Map = $ol$Map;\nol.Object = $ol$Object;\nol.Observable = $ol$Observable;\nol.Observable.unByKey = _ol_Observable.unByKey;\nol.Overlay = $ol$Overlay;\nol.PluggableMap = $ol$PluggableMap;\nol.View = $ol$View;\nol.WebGLMap = $ol$WebGLMap;\nol.color.asArray = _ol_color.asArray;\nol.color.asString = _ol_color.asString;\nol.colorlike.asColorLike = _ol_colorlike.asColorLike;\nol.control.Attribution = $ol$control$Attribution;\nol.control.Attribution.render = _ol_control_Attribution.render;\nol.control.Control = $ol$control$Control;\nol.control.FullScreen = $ol$control$FullScreen;\nol.control.MousePosition = $ol$control$MousePosition;\nol.control.MousePosition.render = _ol_control_MousePosition.render;\nol.control.OverviewMap = $ol$control$OverviewMap;\nol.control.OverviewMap.render = _ol_control_OverviewMap.render;\nol.control.Rotate = $ol$control$Rotate;\nol.control.Rotate.render = _ol_control_Rotate.render;\nol.control.ScaleLine = $ol$control$ScaleLine;\nol.control.ScaleLine.render = _ol_control_ScaleLine.render;\nol.control.Zoom = $ol$control$Zoom;\nol.control.ZoomSlider = $ol$control$ZoomSlider;\nol.control.ZoomSlider.render = _ol_control_ZoomSlider.render;\nol.control.ZoomToExtent = $ol$control$ZoomToExtent;\nol.control.defaults = _ol_control.defaults;\nol.coordinate.add = _ol_coordinate.add;\nol.coordinate.createStringXY = _ol_coordinate.createStringXY;\nol.coordinate.format = _ol_coordinate.format;\nol.coordinate.rotate = _ol_coordinate.rotate;\nol.coordinate.toStringHDMS = _ol_coordinate.toStringHDMS;\nol.coordinate.toStringXY = _ol_coordinate.toStringXY;\nol.easing.easeIn = _ol_easing.easeIn;\nol.easing.easeOut = _ol_easing.easeOut;\nol.easing.inAndOut = _ol_easing.inAndOut;\nol.easing.linear = _ol_easing.linear;\nol.easing.upAndDown = _ol_easing.upAndDown;\nol.events.condition.altKeyOnly = _ol_events_condition.altKeyOnly;\nol.events.condition.altShiftKeysOnly = _ol_events_condition.altShiftKeysOnly;\nol.events.condition.always = _ol_events_condition.always;\nol.events.condition.click = _ol_events_condition.click;\nol.events.condition.doubleClick = _ol_events_condition.doubleClick;\nol.events.condition.focus = _ol_events_condition.focus;\nol.events.condition.mouseOnly = _ol_events_condition.mouseOnly;\nol.events.condition.never = _ol_events_condition.never;\nol.events.condition.noModifierKeys = _ol_events_condition.noModifierKeys;\nol.events.condition.platformModifierKeyOnly = _ol_events_condition.platformModifierKeyOnly;\nol.events.condition.pointerMove = _ol_events_condition.pointerMove;\nol.events.condition.primaryAction = _ol_events_condition.primaryAction;\nol.events.condition.shiftKeyOnly = _ol_events_condition.shiftKeyOnly;\nol.events.condition.singleClick = _ol_events_condition.singleClick;\nol.events.condition.targetNotEditable = _ol_events_condition.targetNotEditable;\nol.extent.applyTransform = _ol_extent.applyTransform;\nol.extent.boundingExtent = _ol_extent.boundingExtent;\nol.extent.buffer = _ol_extent.buffer;\nol.extent.containsCoordinate = _ol_extent.containsCoordinate;\nol.extent.containsExtent = _ol_extent.containsExtent;\nol.extent.containsXY = _ol_extent.containsXY;\nol.extent.createEmpty = _ol_extent.createEmpty;\nol.extent.equals = _ol_extent.equals;\nol.extent.extend = _ol_extent.extend;\nol.extent.getArea = _ol_extent.getArea;\nol.extent.getBottomLeft = _ol_extent.getBottomLeft;\nol.extent.getBottomRight = _ol_extent.getBottomRight;\nol.extent.getCenter = _ol_extent.getCenter;\nol.extent.getHeight = _ol_extent.getHeight;\nol.extent.getIntersection = _ol_extent.getIntersection;\nol.extent.getSize = _ol_extent.getSize;\nol.extent.getTopLeft = _ol_extent.getTopLeft;\nol.extent.getTopRight = _ol_extent.getTopRight;\nol.extent.getWidth = _ol_extent.getWidth;\nol.extent.intersects = _ol_extent.intersects;\nol.extent.isEmpty = _ol_extent.isEmpty;\nol.featureloader.xhr = _ol_featureloader.xhr;\nol.format.EsriJSON = $ol$format$EsriJSON;\nol.format.Feature = $ol$format$Feature;\nol.format.GML = $ol$format$GML;\nol.format.GML2 = $ol$format$GML2;\nol.format.GML3 = $ol$format$GML3;\nol.format.GPX = $ol$format$GPX;\nol.format.GeoJSON = $ol$format$GeoJSON;\nol.format.IGC = $ol$format$IGC;\nol.format.KML = $ol$format$KML;\nol.format.MVT = $ol$format$MVT;\nol.format.OSMXML = $ol$format$OSMXML;\nol.format.Polyline = $ol$format$Polyline;\nol.format.Polyline.decodeDeltas = _ol_format_Polyline.decodeDeltas;\nol.format.Polyline.decodeFloats = _ol_format_Polyline.decodeFloats;\nol.format.Polyline.encodeDeltas = _ol_format_Polyline.encodeDeltas;\nol.format.Polyline.encodeFloats = _ol_format_Polyline.encodeFloats;\nol.format.TopoJSON = $ol$format$TopoJSON;\nol.format.WFS = $ol$format$WFS;\nol.format.WFS.writeFilter = _ol_format_WFS.writeFilter;\nol.format.WKT = $ol$format$WKT;\nol.format.WMSCapabilities = $ol$format$WMSCapabilities;\nol.format.WMSGetFeatureInfo = $ol$format$WMSGetFeatureInfo;\nol.format.WMTSCapabilities = $ol$format$WMTSCapabilities;\nol.format.filter.Bbox = $ol$format$filter$Bbox;\nol.format.filter.Contains = $ol$format$filter$Contains;\nol.format.filter.During = $ol$format$filter$During;\nol.format.filter.EqualTo = $ol$format$filter$EqualTo;\nol.format.filter.GreaterThan = $ol$format$filter$GreaterThan;\nol.format.filter.GreaterThanOrEqualTo = $ol$format$filter$GreaterThanOrEqualTo;\nol.format.filter.Intersects = $ol$format$filter$Intersects;\nol.format.filter.IsBetween = $ol$format$filter$IsBetween;\nol.format.filter.IsLike = $ol$format$filter$IsLike;\nol.format.filter.IsNull = $ol$format$filter$IsNull;\nol.format.filter.LessThan = $ol$format$filter$LessThan;\nol.format.filter.LessThanOrEqualTo = $ol$format$filter$LessThanOrEqualTo;\nol.format.filter.Not = $ol$format$filter$Not;\nol.format.filter.NotEqualTo = $ol$format$filter$NotEqualTo;\nol.format.filter.Or = $ol$format$filter$Or;\nol.format.filter.Within = $ol$format$filter$Within;\nol.format.filter.and = _ol_format_filter.and;\nol.format.filter.bbox = _ol_format_filter.bbox;\nol.format.filter.between = _ol_format_filter.between;\nol.format.filter.contains = _ol_format_filter.contains;\nol.format.filter.during = _ol_format_filter.during;\nol.format.filter.equalTo = _ol_format_filter.equalTo;\nol.format.filter.greaterThan = _ol_format_filter.greaterThan;\nol.format.filter.greaterThanOrEqualTo = _ol_format_filter.greaterThanOrEqualTo;\nol.format.filter.intersects = _ol_format_filter.intersects;\nol.format.filter.isNull = _ol_format_filter.isNull;\nol.format.filter.lessThan = _ol_format_filter.lessThan;\nol.format.filter.lessThanOrEqualTo = _ol_format_filter.lessThanOrEqualTo;\nol.format.filter.like = _ol_format_filter.like;\nol.format.filter.not = _ol_format_filter.not;\nol.format.filter.notEqualTo = _ol_format_filter.notEqualTo;\nol.format.filter.or = _ol_format_filter.or;\nol.format.filter.within = _ol_format_filter.within;\nol.geom.Circle = $ol$geom$Circle;\nol.geom.Geometry = $ol$geom$Geometry;\nol.geom.GeometryCollection = $ol$geom$GeometryCollection;\nol.geom.LineString = $ol$geom$LineString;\nol.geom.LinearRing = $ol$geom$LinearRing;\nol.geom.MultiLineString = $ol$geom$MultiLineString;\nol.geom.MultiPoint = $ol$geom$MultiPoint;\nol.geom.MultiPolygon = $ol$geom$MultiPolygon;\nol.geom.Point = $ol$geom$Point;\nol.geom.Polygon = $ol$geom$Polygon;\nol.geom.Polygon.circular = _ol_geom_Polygon.circular;\nol.geom.Polygon.fromCircle = _ol_geom_Polygon.fromCircle;\nol.geom.Polygon.fromExtent = _ol_geom_Polygon.fromExtent;\nol.geom.SimpleGeometry = $ol$geom$SimpleGeometry;\nol.has.DEVICE_PIXEL_RATIO = _ol_has.DEVICE_PIXEL_RATIO;\nol.has.GEOLOCATION = _ol_has.GEOLOCATION;\nol.has.TOUCH = _ol_has.TOUCH;\nol.has.WEBGL = _ol_has.WEBGL;\nol.inherits = _ol.inherits;\nol.interaction.DoubleClickZoom = $ol$interaction$DoubleClickZoom;\nol.interaction.DragAndDrop = $ol$interaction$DragAndDrop;\nol.interaction.DragBox = $ol$interaction$DragBox;\nol.interaction.DragPan = $ol$interaction$DragPan;\nol.interaction.DragRotate = $ol$interaction$DragRotate;\nol.interaction.DragRotateAndZoom = $ol$interaction$DragRotateAndZoom;\nol.interaction.DragZoom = $ol$interaction$DragZoom;\nol.interaction.Draw = $ol$interaction$Draw;\nol.interaction.Draw.createBox = _ol_interaction_Draw.createBox;\nol.interaction.Draw.createRegularPolygon = _ol_interaction_Draw.createRegularPolygon;\nol.interaction.Draw.handleEvent = _ol_interaction_Draw.handleEvent;\nol.interaction.Extent = $ol$interaction$Extent;\nol.interaction.Interaction = $ol$interaction$Interaction;\nol.interaction.KeyboardPan = $ol$interaction$KeyboardPan;\nol.interaction.KeyboardZoom = $ol$interaction$KeyboardZoom;\nol.interaction.Modify = $ol$interaction$Modify;\nol.interaction.MouseWheelZoom = $ol$interaction$MouseWheelZoom;\nol.interaction.PinchRotate = $ol$interaction$PinchRotate;\nol.interaction.PinchZoom = $ol$interaction$PinchZoom;\nol.interaction.Pointer = $ol$interaction$Pointer;\nol.interaction.Pointer.handleEvent = _ol_interaction_Pointer.handleEvent;\nol.interaction.Select = $ol$interaction$Select;\nol.interaction.Snap = $ol$interaction$Snap;\nol.interaction.Translate = $ol$interaction$Translate;\nol.interaction.defaults = _ol_interaction.defaults;\nol.layer.Base = $ol$layer$Base;\nol.layer.Group = $ol$layer$Group;\nol.layer.Heatmap = $ol$layer$Heatmap;\nol.layer.Image = $ol$layer$Image;\nol.layer.Layer = $ol$layer$Layer;\nol.layer.Tile = $ol$layer$Tile;\nol.layer.Vector = $ol$layer$Vector;\nol.layer.VectorTile = $ol$layer$VectorTile;\nol.loadingstrategy.all = _ol_loadingstrategy.all;\nol.loadingstrategy.bbox = _ol_loadingstrategy.bbox;\nol.loadingstrategy.tile = _ol_loadingstrategy.tile;\nol.proj.Projection = $ol$proj$Projection;\nol.proj.Units.METERS_PER_UNIT = _ol_proj_Units.METERS_PER_UNIT;\nol.proj.addCoordinateTransforms = _ol_proj.addCoordinateTransforms;\nol.proj.addEquivalentProjections = _ol_proj.addEquivalentProjections;\nol.proj.addProjection = _ol_proj.addProjection;\nol.proj.equivalent = _ol_proj.equivalent;\nol.proj.fromLonLat = _ol_proj.fromLonLat;\nol.proj.get = _ol_proj.get;\nol.proj.getPointResolution = _ol_proj.getPointResolution;\nol.proj.getTransform = _ol_proj.getTransform;\nol.proj.proj4.register = _ol_proj_proj4.register;\nol.proj.toLonLat = _ol_proj.toLonLat;\nol.proj.transform = _ol_proj.transform;\nol.proj.transformExtent = _ol_proj.transformExtent;\nol.render.VectorContext = $ol$render$VectorContext;\nol.render.canvas.labelCache = _ol_render_canvas.labelCache;\nol.render.toContext = _ol_render.toContext;\nol.renderer.canvas.ImageLayer = $ol$renderer$canvas$ImageLayer;\nol.renderer.canvas.Map = $ol$renderer$canvas$Map;\nol.renderer.canvas.TileLayer = $ol$renderer$canvas$TileLayer;\nol.renderer.canvas.VectorLayer = $ol$renderer$canvas$VectorLayer;\nol.renderer.canvas.VectorTileLayer = $ol$renderer$canvas$VectorTileLayer;\nol.renderer.webgl.ImageLayer = $ol$renderer$webgl$ImageLayer;\nol.renderer.webgl.Map = $ol$renderer$webgl$Map;\nol.renderer.webgl.TileLayer = $ol$renderer$webgl$TileLayer;\nol.renderer.webgl.VectorLayer = $ol$renderer$webgl$VectorLayer;\nol.size.toSize = _ol_size.toSize;\nol.source.BingMaps = $ol$source$BingMaps;\nol.source.CartoDB = $ol$source$CartoDB;\nol.source.Cluster = $ol$source$Cluster;\nol.source.Image = $ol$source$Image;\nol.source.ImageArcGISRest = $ol$source$ImageArcGISRest;\nol.source.ImageCanvas = $ol$source$ImageCanvas;\nol.source.ImageMapGuide = $ol$source$ImageMapGuide;\nol.source.ImageStatic = $ol$source$ImageStatic;\nol.source.ImageWMS = $ol$source$ImageWMS;\nol.source.OSM = $ol$source$OSM;\nol.source.OSM.ATTRIBUTION = _ol_source_OSM.ATTRIBUTION;\nol.source.Raster = $ol$source$Raster;\nol.source.Source = $ol$source$Source;\nol.source.Stamen = $ol$source$Stamen;\nol.source.Tile = $ol$source$Tile;\nol.source.TileArcGISRest = $ol$source$TileArcGISRest;\nol.source.TileDebug = $ol$source$TileDebug;\nol.source.TileImage = $ol$source$TileImage;\nol.source.TileJSON = $ol$source$TileJSON;\nol.source.TileWMS = $ol$source$TileWMS;\nol.source.UTFGrid = $ol$source$UTFGrid;\nol.source.Vector = $ol$source$Vector;\nol.source.VectorTile = $ol$source$VectorTile;\nol.source.WMTS = $ol$source$WMTS;\nol.source.WMTS.optionsFromCapabilities = _ol_source_WMTS.optionsFromCapabilities;\nol.source.XYZ = $ol$source$XYZ;\nol.source.Zoomify = $ol$source$Zoomify;\nol.sphere.getArea = _ol_sphere.getArea;\nol.sphere.getDistance = _ol_sphere.getDistance;\nol.sphere.getLength = _ol_sphere.getLength;\nol.style.AtlasManager = $ol$style$AtlasManager;\nol.style.Circle = $ol$style$Circle;\nol.style.Fill = $ol$style$Fill;\nol.style.Icon = $ol$style$Icon;\nol.style.IconImageCache.shared = _ol_style_IconImageCache.shared;\nol.style.Image = $ol$style$Image;\nol.style.RegularShape = $ol$style$RegularShape;\nol.style.Stroke = $ol$style$Stroke;\nol.style.Style = $ol$style$Style;\nol.style.Text = $ol$style$Text;\nol.tilegrid.TileGrid = $ol$tilegrid$TileGrid;\nol.tilegrid.WMTS = $ol$tilegrid$WMTS;\nol.tilegrid.WMTS.createFromCapabilitiesMatrixSet = _ol_tilegrid_WMTS.createFromCapabilitiesMatrixSet;\nol.tilegrid.createXYZ = _ol_tilegrid.createXYZ;\nol.xml.getAllTextContent = _ol_xml.getAllTextContent;\nol.xml.parse = _ol_xml.parse;\n","/**\n * @module ol/proj/proj4\n */\nimport {addCoordinateTransforms, addProjection, addEquivalentProjections, get} from '../proj.js';\nimport {get as getTransform} from './transforms.js';\nimport Projection from './Projection.js';\n\n/**\n * Make projections defined in proj4 (with `proj4.defs()`) available in\n * OpenLayers.\n *\n * This function should be called whenever changes are made to the proj4\n * registry, e.g. after calling `proj4.defs()`. Existing transforms will not be\n * modified by this function.\n *\n * @param {?} proj4 Proj4.\n * @api\n */\nexport function register(proj4) {\n  const projCodes = Object.keys(proj4.defs);\n  const len = projCodes.length;\n  let i, j;\n  for (i = 0; i < len; ++i) {\n    const code = projCodes[i];\n    if (!get(code)) {\n      const def = proj4.defs(code);\n      addProjection(new Projection({\n        code: code,\n        axisOrientation: def.axis,\n        metersPerUnit: def.to_meter,\n        units: def.units\n      }));\n    }\n  }\n  for (i = 0; i < len; ++i) {\n    const code1 = projCodes[i];\n    const proj1 = get(code1);\n    for (j = 0; j < len; ++j) {\n      const code2 = projCodes[j];\n      const proj2 = get(code2);\n      if (!getTransform(code1, code2)) {\n        if (proj4.defs[code1] === proj4.defs[code2]) {\n          addEquivalentProjections([proj1, proj2]);\n        } else {\n          const transform = proj4(code1, code2);\n          addCoordinateTransforms(proj1, proj2, transform.forward, transform.inverse);\n        }\n      }\n    }\n  }\n}\n","/**\n * @module ol/render\n */\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport {create as createTransform, scale as scaleTransform} from './transform.js';\nimport CanvasImmediateRenderer from './render/canvas/Immediate.js';\n\n\n/**\n * @typedef {Object} State\n * @property {CanvasRenderingContext2D} context Canvas context that the layer is being rendered to.\n * @property {module:ol/Feature|module:ol/render/Feature} feature\n * @property {module:ol/geom/SimpleGeometry} geometry\n * @property {number} pixelRatio Pixel ratio used by the layer renderer.\n * @property {number} resolution Resolution that the render batch was created and optimized for.\n * This is not the view's resolution that is being rendered.\n * @property {number} rotation Rotation of the rendered layer in radians.\n */\n\n\n/**\n * A function to be used when sorting features before rendering.\n * It takes two instances of {@link module:ol/Feature} or\n * {@link module:ol/render/Feature} and returns a `{number}`.\n *\n * @typedef {function((module:ol/Feature|module:ol/render/Feature),\n *           (module:ol/Feature|module:ol/render/Feature)):number} OrderFunction\n */\n\n\n/**\n * @typedef {Object} ToContextOptions\n * @property {module:ol/size~Size} [size] Desired size of the canvas in css\n * pixels. When provided, both canvas and css size will be set according to the\n * `pixelRatio`. If not provided, the current canvas and css sizes will not be\n * altered.\n * @property {number} [pixelRatio=window.devicePixelRatio] Pixel ratio (canvas\n * pixel to css pixel ratio) for the canvas.\n */\n\n\n/**\n * Binds a Canvas Immediate API to a canvas context, to allow drawing geometries\n * to the context's canvas.\n *\n * The units for geometry coordinates are css pixels relative to the top left\n * corner of the canvas element.\n * ```js\n * import {toContext} from 'ol/render';\n * import Fill from 'ol/style/Fill';\n * import Polygon from 'ol/geom/Polygon';\n *\n * var canvas = document.createElement('canvas');\n * var render = toContext(canvas.getContext('2d'),\n *     { size: [100, 100] });\n * render.setFillStrokeStyle(new Fill({ color: blue }));\n * render.drawPolygon(\n *     new Polygon([[[0, 0], [100, 100], [100, 0], [0, 0]]]));\n * ```\n *\n * @param {CanvasRenderingContext2D} context Canvas context.\n * @param {module:ol/render~ToContextOptions=} opt_options Options.\n * @return {module:ol/render/canvas/Immediate} Canvas Immediate.\n * @api\n */\nexport function toContext(context, opt_options) {\n  const canvas = context.canvas;\n  const options = opt_options ? opt_options : {};\n  const pixelRatio = options.pixelRatio || DEVICE_PIXEL_RATIO;\n  const size = options.size;\n  if (size) {\n    canvas.width = size[0] * pixelRatio;\n    canvas.height = size[1] * pixelRatio;\n    canvas.style.width = size[0] + 'px';\n    canvas.style.height = size[1] + 'px';\n  }\n  const extent = [0, 0, canvas.width, canvas.height];\n  const transform = scaleTransform(createTransform(), pixelRatio, pixelRatio);\n  return new CanvasImmediateRenderer(context, pixelRatio, extent, transform, 0);\n}\n"],"names":["const","WEBGL_MAX_TEXTURE_SIZE","WEBGL_EXTENSIONS","ARRAY_BUFFER","FLOAT","RGBA","LINEAR","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_2D","CLAMP_TO_EDGE","FRAMEBUFFER","CONTEXT_IDS","getContext","canvas","opt_attributes","ii","length","i","context","e","let","HAS_WEBGL","window","gl","document","createElement","failIfMajorPerformanceCaveat","getParameter","MAX_TEXTURE_SIZE","getSupportedExtensions","inherits","childCtor","parentCtor","prototype","Object","create","constructor","uidCounter_","getUid","obj","ol_uid","AssertionError","code","path","split","this","message","name","Error","assign","target","var_sources","undefined","TypeError","output","arguments","source","key","hasOwnProperty","clear","object","property","getValues","values","push","isEmpty","findListener","listeners","listener","opt_this","opt_setDeleteIndex","listenerObj","bindTo","deleteIndex","getListeners","type","listenerMap","ol_lm","getListenerMap","removeListeners","removeEventListener","boundListener","keys","listen","opt_once","callOnce","addEventListener","evt","unlistenByKey","call","listenOnce","unlisten","indexOf","splice","unlistenAll","TRUE","FALSE","UNDEFINED","Disposable","disposed_","dispose","disposeInternal","Event","propagationStopped","stopPropagation","preventDefault","EventTarget","pendingRemovals_","dispatching_","listeners_","dispatchEvent","event","propagate","pendingRemovals","hasListener","opt_type","index","Observable","revision_","changed","EventType","getRevision","on","Array","isArray","len","once","un","ObjectEvent","oldValue","BaseObject","opt_values","values_","setProperties","changeEventTypeCache","getChangeEventType","get","value","getKeys","getProperties","notify","eventType","ObjectEventType","set","opt_silent","unset","Property","CollectionEvent","opt_element","element","Collection","opt_array","opt_options","options","unique_","unique","array_","assertUnique_","updateLength_","assert","assertion","errorCode","getLength","pop","extend","arr","forEach","f","array","getArray","item","insertAt","elem","CollectionEventType","removeAt","n","remove","prev","setAt","j","opt_except","BOTTOM_LEFT","BOTTOM_RIGHT","TOP_LEFT","TOP_RIGHT","UNKNOWN","INTERSECTING","ABOVE","RIGHT","BELOW","LEFT","boundingExtent","coordinates","extent","createEmpty","extendCoordinate","buffer","opt_extent","clone","slice","closestSquaredDistanceXY","x","y","dx","dy","containsCoordinate","coordinate","containsXY","containsExtent","extent1","extent2","coordinateRelationship","minX","minY","maxX","maxY","relationship","Relationship","Infinity","createOrUpdate","createOrUpdateEmpty","createOrUpdateFromCoordinate","createOrUpdateFromCoordinates","extendCoordinates","createOrUpdateFromFlatCoordinates","flatCoordinates","offset","end","stride","extendFlatCoordinates","equals","extendXY","Math","min","max","forEachCorner","callback","val","getBottomLeft","getBottomRight","getTopRight","getTopLeft","getArea","area","getWidth","getHeight","getCenter","getForViewAndSize","center","resolution","rotation","size","cosRotation","cos","sinRotation","sin","xCos","xSin","yCos","ySin","x0","x1","x2","x3","y0","y1","y2","y3","getIntersection","intersection","intersects","scaleFromCenter","deltaX","deltaY","applyTransform","transformFn","xs","ys","apply","transform2D","transform","opt_dest","dest","translate","k","clamp","cosh","exp","squaredSegmentDistance","t","squaredDistance","toDegrees","angleInRadians","PI","toRadians","angleInDegrees","modulo","a","b","r","lerp","POINT","LINE_STRING","LINEAR_RING","POLYGON","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","GEOMETRY_COLLECTION","CIRCLE","DEFAULT_RADIUS","getDistance","c1","c2","opt_radius","radius","lat1","lat2","deltaLatBy2","deltaLonBy2","atan2","sqrt","getLengthInternal","getAreaInternal","Units","DEGREES","FEET","METERS","PIXELS","TILE_PIXELS","USFEET","METERS_PER_UNIT","Projection","code_","units_","extent_","worldExtent_","worldExtent","axisOrientation_","axisOrientation","global_","global","canWrapX_","getPointResolutionFunc_","getPointResolution","defaultTileGrid_","metersPerUnit_","metersPerUnit","canWrapX","getCode","getExtent","getUnits","getMetersPerUnit","getWorldExtent","getAxisOrientation","isGlobal","setGlobal","getDefaultTileGrid","setDefaultTileGrid","tileGrid","setExtent","setWorldExtent","setGetPointResolution","func","getPointResolutionFunc","RADIUS","HALF_SIZE","EXTENT","WORLD_EXTENT","EPSG3857Projection","units","point","PROJECTIONS","fromEPSG4326","input","opt_output","opt_dimension","dimension","halfSize","log","tan","toEPSG4326","atan","EPSG4326Projection","opt_axisOrientation","cache","projections2","forwardTransform","inverseTransform","transforms","add","destination","sourceCode","destinationCode","cloneTransform","identityTransform","addProjection","projection","addTransformFunc","projectionLike","opt_units","pointResolution","getter","getTransformFromProjections","vertices","addEquivalentProjections","projections","createProjection","defaultCode","createTransformFromCoordinateTransform","coordTransform","addCoordinateTransforms","forward","inverse","sourceProj","destProj","equivalent","projection1","projection2","equalUnits","sourceProjection","destinationProjection","transformFunc","getTransformFunc","getTransform","transformExtent","EPSG3857_PROJECTIONS","EPSG4326_PROJECTIONS","tmp_","reset","multiply","transform1","transform2","a1","b1","d1","e1","f1","a2","b2","d2","e2","f2","c","d","setFromArray","rotate","angle","scale","compose","dx1","dy1","sx","sy","dx2","dy2","invert","mat","det","Geometry","extentRevision_","simplifiedGeometryCache","simplifiedGeometryMaxMinSquaredTolerance","simplifiedGeometryRevision","tmpTransform","closestPointXY","closestPoint","minSquaredDistance","getClosestPoint","opt_closestPoint","NaN","intersectsCoordinate","computeExtent","anchor","opt_sy","opt_anchor","simplify","tolerance","getSimplifiedGeometry","squaredTolerance","getType","intersectsExtent","getProjection","inCoordinates","outCoordinates","pixelExtent","projectedExtent","composeTransform","HEX_COLOR_RE_","NAMED_COLOR_RE_","asString","color","toString","cacheSize","fromString","s","g","exec","el","style","body","appendChild","rgb","getComputedStyle","removeChild","fromNamed","hasAlpha","parseInt","substr","normalize","map","Number","fromStringInternal_","asArray","asColorLike","CanvasPattern","CanvasGradient","createCanvasContext2D","opt_width","opt_height","width","height","replaceNode","newNode","oldNode","parent","parentNode","replaceChild","removeNode","node","removeChildren","lastChild","ua","navigator","userAgent","toLowerCase","FIREFOX","SAFARI","WEBKIT","MAC","DEVICE_PIXEL_RATIO","devicePixelRatio","CANVAS_LINE_DASH","has","setLineDash","GEOLOCATION","TOUCH","POINTER","MSPOINTER","WEBGL","IDLE","LOADING","LOADED","ERROR","CLASS_HIDDEN","CLASS_UNSELECTABLE","CLASS_CONTROL","CLASS_COLLAPSED","getFontFamilies","font","family","fontFamily","LRUCache","opt_highWaterMark","highWaterMark","count_","entries_","oldest_","newest_","canExpireCache","getCount","containsKey","entry","value_","key_","newer","older","peekLast","peekLastKey","peekFirstKey","replace","setSize","prune","defaultFont","defaultFillStyle","defaultLineCap","defaultLineDash","defaultLineJoin","defaultStrokeStyle","defaultTextAlign","defaultPadding","labelCache","checkedFonts","measureContext","textHeights","checkFont","interval","referenceWidth","retries","checked","referenceFonts","text","isAvailable","getMeasureContext","available","referenceFont","measureText","check","done","clearInterval","fontSpec","fontFamilies","setInterval","span","heights","measureTextHeight","textContent","margin","padding","position","left","offsetHeight","measureTextWidth","rotateAtOffset","offsetX","offsetY","resetTransform","drawImage","opacity","image","originX","originY","w","h","alpha","globalAlpha","setTransform","ImageStyle","opacity_","rotateWithView_","rotateWithView","rotation_","scale_","snapToPixel_","snapToPixel","getOpacity","getRotateWithView","getRotation","getScale","getSnapToPixel","getAnchor","getImage","pixelRatio","getHitDetectionImage","getImageState","getImageSize","getHitDetectionImageSize","getOrigin","getSize","setOpacity","setRotateWithView","setRotation","setScale","setSnapToPixel","listenImageChange","thisArg","load","unlistenImageChange","RegularShape","checksums_","canvas_","hitDetectionCanvas_","fill_","fill","origin_","points_","points","radius_","radius1","radius2_","radius2","angle_","stroke_","stroke","anchor_","size_","imageSize_","hitDetectionImageSize_","atlasManager_","atlasManager","render_","getFill","getPoints","getRadius","getRadius2","getAngle","getStroke","ImageState","imageSize","strokeStyle","lineCap","lineJoin","miterLimit","lineDash","lineDashOffset","strokeWidth","getColor","getLineDash","getLineDashOffset","getLineJoin","getLineCap","getMiterLimit","renderOptions","draw_","createHitDetectionCanvas_","round","renderHitDetectionCallback","hasCustomHitDetectionImage","drawHitDetectionCanvas_","bind","id","getChecksum","info","hitImage","angle0","radiusC","beginPath","arc","lineTo","fillStyle","lineWidth","closePath","strokeChecksum","fillChecksum","checksum","CircleStyle","setRadius","Fill","color_","checksum_","setColor","Stroke","lineCap_","lineDash_","lineDashOffset_","lineJoin_","miterLimit_","width_","setLineCap","setLineDashOffset","setLineJoin","setMiterLimit","setWidth","Style","geometry_","geometryFunction_","defaultGeometryFunction","geometry","setGeometry","image_","renderer_","renderer","text_","zIndex_","zIndex","getGeometry","getText","getZIndex","getRenderer","setRenderer","getGeometryFunction","setFill","setImage","setStroke","setText","feature","setZIndex","defaultStyles","createDefaultStyle","createEditingStyle","styles","white","blue","GeometryType","concat","Feature","opt_geometryOrProperties","id_","geometryName_","style_","styleFunction_","geometryChangeKey_","handleGeometryChanged_","properties","setGeometryName","getGeometryName","getStyle","setStyle","getId","getStyleFunction","handleGeometryChange_","createStyleFunction","setId","numberSafeCompareFunction","includes","linearFindNearest","direction","reverseSubArray","begin","tmp","data","extension","find","arr1","arr2","len1","stableSort","compareFnc","sort","findIndex","every","idx","XY","XYZ","XYM","XYZM","SimpleGeometry","layout","GeometryLayout","getStrideForLayout","linearRing","twiceArea","linearRings","ends","assignClosest","offset1","offset2","maxSquaredDelta","squaredDelta","squaredDx","arrayMaxSquaredDelta","assignClosestPoint","maxDelta","isRing","opt_tmpPoint","tmpPoint","assignClosestArrayPoint","deflateCoordinate","deflateCoordinates","deflateCoordinatesArray","coordinatess","opt_ends","jj","inflateCoordinates","opt_coordinates","inflateCoordinatesArray","opt_coordinatess","inflateMultiCoordinatesArray","endss","opt_coordinatesss","coordinatesss","douglasPeucker","simplifiedFlatCoordinates","simplifiedOffset","markers","stack","last","first","maxSquaredDistance","snap","quantize","quantizeArray","simplifiedEnds","getCoordinates","getFirstCoordinate","getFlatCoordinates","getLastCoordinate","getLayout","simplifiedGeometry","getSimplifiedGeometryInternal","getStride","setFlatCoordinatesInternal","setCoordinates","opt_layout","setLayout","nesting","anchorX","anchorY","LinearRing","maxDelta_","maxDeltaRevision_","setFlatCoordinates","linearRingArea","simplifiedLinearRing","Point","linearRingContainsExtent","linearRingContainsXY","wn","linearRingsContainsXY","getInteriorPointOfArray","flatCenters","flatCentersOffset","intersections","rr","pointX","maxSegmentLength","segmentLength","abs","isNaN","getInteriorPointsOfMultiArray","interiorPoints","ret","point1","point2","intersectsLineString","coordinatesExtent","forEachSegment","start","startRel","endRel","startX","startY","endX","endY","slope","intersectsSegment","intersectsLinearRingArray","linearRingIsClockwise","edge","linearRingIsOriented","opt_right","right","isClockwise","orientLinearRings","reverseCoordinates","orientLinearRingsArray","Polygon","ends_","flatInteriorPointRevision_","flatInteriorPoint_","orientedRevision_","orientedFlatCoordinates_","circular","opt_n","opt_sphereRadius","distance","bearing","lon1","dByR","lat","asin","polygon","fromExtent","fromCircle","circle","opt_sides","opt_angle","sides","arrayLength","makeRegular","getEnds","startAngle","appendLinearRing","getOrientedFlatCoordinates","linearRingsArea","getFlatInteriorPoint","flatCenter","getInteriorPoint","getLinearRingCount","getLinearRing","getLinearRings","simplifiedPolygon","Geolocation","position_","transform_","watchId_","GeolocationProperty","handleProjectionChanged_","handleTrackingChanged_","setProjection","trackingOptions","setTrackingOptions","setTracking","tracking","padNumber","number","opt_precision","numberString","toFixed","decimal","join","compareVersions","v1","v2","s1","s2","n1","n2","delta","closestOnSegment","segment","along","degreesToStringHDMS","hemispheres","degrees","opt_fractionDigits","normalizedDegrees","dflPrecision","precision","pow","deg","floor","sec","ceil","charAt","format","template","coordinate1","coordinate2","cosAngle","sinAngle","coord1","coord2","squaredDistanceToSegment","toStringXY","interpolatePoint","fraction","pointY","cumulativeLengths","haystack","needle","opt_comparator","mid","cmp","comparator","low","high","found","binarySearch","o","lineStringCoordinateAtM","m","extrapolate","lo","hi","m0","lineStringLength","getTracking","geolocation","watchPosition","positionChange_","positionError_","getTrackingOptions","clearWatch","coords","accuracy","altitude","altitudeAccuracy","heading","longitude","latitude","projectedPosition","speed","circularPolygon","error","getAccuracy","getAccuracyGeometry","getAltitude","getAltitudeAccuracy","getHeading","getPosition","getSpeed","LineString","flatMidpoint_","flatMidpointRevision_","line","interpolate","geoM","fracA","fracB","fracM","geoA","geoB","geoStack","fractionStack","fractions","maxIterations","appendCoordinate","lineString","getCoordinateAtM","opt_extrapolate","getCoordinateAt","getFlatMidpoint","simplifiedLineString","Text","font_","textAlign_","textAlign","textBaseline_","textBaseline","maxAngle_","maxAngle","placement_","placement","TextPlacement","overflow_","overflow","offsetX_","offsetY_","backgroundFill_","backgroundFill","backgroundStroke_","backgroundStroke","padding_","getFont","getPlacement","getMaxAngle","getOverflow","getTextAlign","getTextBaseline","getOffsetX","getOffsetY","getBackgroundFill","getBackgroundStroke","getPadding","setOverflow","setFont","setMaxAngle","setOffsetX","setOffsetY","setPlacement","setTextAlign","setTextBaseline","setBackgroundFill","setBackgroundStroke","setPadding","DEFAULT_STROKE_STYLE","INTERVALS","Graticule","map_","postcomposeListenerKey_","projection_","maxLat_","maxLon_","minLat_","minLon_","maxLatP_","maxLonP_","minLatP_","minLonP_","targetSize_","targetSize","maxLines_","maxLines","meridians_","parallels_","strokeStyle_","fromLonLatTransform_","toLonLatTransform_","projectionCenterLonLat_","meridiansLabels_","parallelsLabels_","showLabels","lonLabelFormatter_","lonLabelFormatter","latLabelFormatter_","latLabelFormatter","lonLabelPosition_","lonLabelPosition","latLabelPosition_","latLabelPosition","lonLabelStyle_","lonLabelStyle","latLabelStyle_","latLabelStyle","setMap","addMeridian_","lon","minLat","maxLat","getMeridian_","textPoint","getMeridianPoint_","geom","clampedBottom","clampedTop","addParallel_","minLon","maxLon","getParallel_","getParallelPoint_","clampedLeft","clampedRight","createGraticule_","getInterval_","cnt","centerLonLat","centerLon","centerLat","validExtent","p1","p2","getMap","frac","getMeridians","lon2","getParallels","handlePostCompose_","l","labelData","vectorContext","frameState","viewState","equivalentProjection","updateProjectionInfo_","setFillStrokeStyle","drawGeometry","setTextStyle","epsg4326Projection","worldExtentP","render","RenderEventType","ImageBase","state","pixelRatio_","getPixelRatio","getResolution","getState","ImageWrapper","src","crossOrigin","imageLoadFunction","src_","Image","imageListenerKeys_","imageLoadFunction_","handleImageError_","unlistenImage_","handleImageLoad_","easeIn","easeOut","inAndOut","linear","Tile","tileCoord","interimTile","transition_","transition","transitionStarts_","getKey","getInterimTile","tile","TileState","refreshInterimChain","getTileCoord","setState","getAlpha","time","inTransition","endTransition","ImageTile","tileLoadFunction","crossOrigin_","tileLoadFunction_","getBlankImage","ctx","fillRect","naturalWidth","naturalHeight","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","initialVelocity_","update","Date","now","lastIndex","firstIndex","duration","MapEvent","opt_frameState","MapBrowserEvent","browserEvent","opt_dragging","originalEvent","pixel","getEventPixel","getCoordinateFromPixel","dragging","SINGLECLICK","CLICK","DBLCLICK","POINTERDRAG","POINTERMOVE","POINTERDOWN","POINTERUP","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","MapBrowserPointerEvent","pointerEvent","EventSource","dispatcher","mapping","mapping_","getEvents","getHandlerForEvent","MouseSource","mousedown","mousemove","mouseup","mouseover","mouseout","pointerMap","lastTouches","prepareEvent","inEvent","cloneEvent","pd","pointerId","isPrimary","pointerType","isEventSimulatedFromTouch_","lts","clientX","clientY","cancel","down","move","p","button","up","cleanupMouse","enterOver","leaveOut","MsSource","MSPointerDown","msPointerDown","MSPointerMove","msPointerMove","MSPointerUp","msPointerUp","MSPointerOut","msPointerOut","MSPointerOver","msPointerOver","MSPointerCancel","msPointerCancel","MSGotPointerCapture","msGotPointerCapture","MSLostPointerCapture","msLostPointerCapture","POINTER_TYPES","prepareEvent_","cleanup","makeEvent","NativeSource","pointerdown","pointerDown","pointermove","pointerMove","pointerup","pointerUp","pointerout","pointerOut","pointerover","pointerOver","pointercancel","pointerCancel","gotpointercapture","gotPointerCapture","lostpointercapture","lostPointerCapture","fireNativeEvent","PointerEvent","opt_eventDict","eventDict","buttons","getButtons_","pressure","getPressure_","bubbles","cancelable","view","detail","screenX","screenY","ctrlKey","altKey","shiftKey","metaKey","relatedTarget","tiltX","tiltY","hwTimestamp","HAS_BUTTONS","which","ev","MouseEvent","TouchSource","mouseSource","touchstart","touchmove","touchend","touchcancel","firstTouchId_","clickCount_","resetId_","dedupTimeout_","isPrimaryTouch_","inTouch","identifier","setPrimaryTouch_","count","cancelResetClickCount_","removePrimaryPointer_","inPointer","resetClickCount_","setTimeout","resetClickCountHandler_","clearTimeout","touchToPointer_","webkitRadiusX","radiusX","webkitRadiusY","radiusY","webkitForce","force","processTouches_","inFunction","touches","changedTouches","pointer","findTouch_","touchList","searchId","vacuumTouches_","out","cancelOut_","dedupSynthMouse_","overDown_","outTarget","over","enter","moveOverOut_","outEvent","upOut_","leave","cleanUpPointer_","lt","PointerEventHandler","element_","eventMap_","eventSourceList_","registerSources","CLONE_PROPS","registerSource","register_","newEvents","handler","eventSource","addEvents_","unregister_","removeEvents_","eventHandler_","events","eventName","eventCopy","fireEvent","PointerEventType","contains_","container","contained","contains","inType","wrapMouseEvent","MapBrowserEventHandler","moveTolerance","clickTimeoutId_","dragging_","dragListenerKeys_","moveTolerance_","down_","getViewport","activePointers_","trackedTouches_","pointerEventHandler_","documentPointerEventHandler_","pointerdownListenerKey_","handlePointerDown_","relayedListenerKey_","relayEvent_","emulateClick_","newEvent","MapBrowserEventType","updateActivePointers_","handlePointerUp_","isMouseActionButton_","handlePointerMove_","isMoving_","PriorityQueue","priorityFunction","keyFunction","priorityFunction_","keyFunction_","elements_","priorities_","queuedElements_","dequeue","elements","priorities","siftUp_","elementKey","enqueue","priority","siftDown_","getLeftChildIndex_","getRightChildIndex_","getParentIndex_","heapify_","isKeyQueued","isQueued","startIndex","lIndex","rIndex","smallerChildIndex","parentIndex","reprioritize","TileQueue","tilePriorityFunction","tileChangeCallback","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","added","handleTileChange","getTilesLoading","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","abortedTiles","DEFAULT_MAX_ZOOM","DEFAULT_TILE_SIZE","none","disable","View","hints_","animations_","updateAnimationKey_","updateAnimations_","applyOptions_","isNoopAnimation","animation","sourceCenter","targetCenter","coordinatesEqual","sourceResolution","targetResolution","sourceRotation","targetRotation","ViewProperty","resolutionConstraintInfo","resolutionConstraint","maxResolution","minResolution","minZoom","maxZoom","zoomFactor","resolutions","z","power","defaultMaxResolution","defaultMinResolution","defaultMaxZoom","opt_maxLevel","oldLevel","newLevel","constraint","createResolutionConstraint","maxResolution_","minResolution_","zoomFactor_","resolutions_","minZoom_","centerConstraint","centerNone","rotationConstraint","enableRotation","constrainRotation","opt_tolerance","rotationNone","theta","createRotationConstraint","constraints_","zoom","constrainResolution","options_","getUpdatedOptions_","newOptions","getZoom","animate","var_args","animationCount","isDef","setCenter","setZoom","series","complete","easing","setHint","ViewHint","getAnimating","getInteracting","cancelAnimations","cancelAnimationFrame","more","seriesComplete","elapsed","progress","calculateCenterZoom","calculateCenterRotate","filter","Boolean","requestAnimationFrame","currentCenter","rotateCoordinate","addCoordinate","currentResolution","getSizeFromViewport_","selector","querySelector","metrics","constrainCenter","opt_delta","opt_direction","getConstraints","getHints","opt_hints","calculateExtent","opt_size","getMaxResolution","getMinResolution","getMaxZoom","getZoomForResolution","setMaxZoom","getMinZoom","setMinZoom","getResolutions","getResolutionForExtent","xResolution","yResolution","getResolutionForValueFunction","opt_power","getValueForResolutionFunction","nearest","getResolutionForZoom","fit","geometryOrExtent","polygonFromExtent","minRotX","minRotY","maxRotX","maxRotY","rotX","rotY","constrainedResolution","centerRotX","centerRotY","setResolution","centerOn","centerX","centerY","hint","BaseLayer","LayerProperty","visible","state_","layer","managed","getLayerState","sourceState","getSourceState","getVisible","getLayersArray","getLayerStatesArray","opt_states","setMaxResolution","setMinResolution","setVisible","zindex","LayerGroup","baseOptions","layers","layersListenerKeys_","listenerKeys_","handleLayersChanged_","setLayers","num","ratio","toSize","handleLayerChange_","getLayers","handleLayersAdd_","handleLayersRemove_","layersArray","collectionEvent","states","pos","ownLayerState","layerState","SourceState","PluggableMap","optionsInternal","keyboardEventTarget","getElementById","controls","interactions","overlays","layerGroup","MapProperty","createOptionsInternal","maxTilesLoading_","maxTilesLoading","loadTilesWhileAnimating_","loadTilesWhileAnimating","loadTilesWhileInteracting_","loadTilesWhileInteracting","animationDelayKey_","animationDelay_","renderFrame_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","className","msTouchAction","touchAction","overlayContainer_","overlayContainerStopEvent_","overlayEvents","mapBrowserEventHandler_","handleMapBrowserEvent","keyboardEventTarget_","keyHandlerKeys_","handleBrowserEvent","overlays_","overlayIdIndex_","createRenderer","handleResize_","focus_","postRenderFunctions_","tileQueue_","getTilePriority","handleTileChange_","skippedFeatureUids_","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","control","interaction","addOverlayInternal_","addControl","getControls","addInteraction","getInteractions","addLayer","getLayerGroup","addOverlay","overlay","getOverlays","setTarget","forEachFeatureAtPixel","hitTolerance","layerFilter","forEachFeatureAtCoordinate","getFeaturesAtPixel","features","forEachLayerAtPixel","opt_layerFilter","opt_this2","thisArg2","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","viewportPosition","getBoundingClientRect","eventPosition","top","getTarget","getTargetElement","pixelToCoordinateTransform","getOverlayById","getPixelFromCoordinate","coordinateToPixelTransform","getView","getOverlayContainer","getOverlayContainerStopEvent","tileSourceKey","tileCenter","tileResolution","wantedTiles","focus","mapBrowserEvent","interactionsArray","getActive","handleEvent","handlePostRender","tileQueue","hints","viewHints","postRenderFunctions","targetElement","updateSize","removeLayerRenderers","handleViewPropertyChanged_","setAttribute","isRendered","renderSync","removeControl","removeInteraction","removeLayer","removeOverlay","previousFrameState","layerStatesArray","layerStates","pixelResolution","skippedFeatureUids","usedTiles","renderFrame","MapEventType","setLayerGroup","setView","skipFeature","featureUid","computedStyle","offsetWidth","parseFloat","unskipFeature","Control","target_","listenerKeys","Layer","mapPrecomposeKey_","mapRenderKey_","sourceChangeKey_","handleSourcePropertyChange_","setSource","visibleAtResolution","getSource","handleSourceChange_","Attribution","ulElement_","collapsed_","collapsed","collapsible_","collapsible","tipLabel","collapseLabel","collapseLabel_","label","label_","activeLabel","title","handleClick_","cssClasses","renderedAttributions_","renderedVisible_","mapEvent","updateElement_","getSourceAttributions_","lookup","visibleAttributions","attributionGetter","getAttributions","attributions","display","innerHTML","handleToggle_","classList","toggle","getCollapsible","setCollapsible","setCollapsed","getCollapsed","Rotate","callResetNorth_","resetNorth","duration_","autoHide_","autoHide","msTransform","webkitTransform","resetNorth_","Zoom","zoomInLabel","zoomOutLabel","zoomInTipLabel","zoomOutTipLabel","inElement","createTextNode","outElement","defaults","zoomOptions","rotateOptions","attribution","attributionOptions","zoomByDelta_","newResolution","Interaction","setActive","opt_duration","rotateWithoutConstraints","currentRotation","zoomWithoutConstraints","zoomByDelta","InteractionProperty","active","DoubleClickZoom","delta_","stopEvent","altKeyOnly","altShiftKeysOnly","always","mouseActionButton","never","singleClick","noModifierKeys","shiftKeyOnly","targetNotEditable","tagName","mouseOnly","primaryAction","handleDragEvent","handleUpEvent","handleDownEvent","handleMoveEvent","PointerInteraction","handleDownEvent_","handleDragEvent_","handleMoveEvent_","handleUpEvent_","handlingDownUpSequence","trackedPointers_","targetPointers","centroid","pointerEvents","updateTrackedPointers_","handledUp","handled","shouldStopEvent","DragPan","kinetic_","kinetic","lastCentroid","lastPointersCount_","condition_","condition","noKinetic_","centroidFromPointers","scaleCoordinate","centerpx","DragRotate","lastAngle_","RenderBox","startPixel_","endPixel_","startPixel","endPixel","setPixels","createOrUpdateGeometry","DragBoxEventType","DragBoxEvent","DragBox","box_","minArea_","minArea","boxEndCondition_","boxEndCondition","defaultBoxEndCondition","onBoxEnd","DragZoom","out_","mapExtent","boxPixelExtent","KeyboardPan","defaultCondition_","pixelDelta_","pixelDelta","keyCode","KeyCode","mapUnitsDelta","pan","KeyboardZoom","charCode","charCodeAt","Mode","MouseWheelZoom","timeout_","timeout","useAnchor_","useAnchor","constrainResolution_","lastAnchor_","startTime_","timeoutId_","mode_","trackpadEventGap_","trackpadTimeoutId_","trackpadDeltaPerZoom_","trackpadZoomBuffer_","wheelEvent","deltaMode","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","wheelDeltaY","decrementInteractingHint_","rebound","timeLeft","handleWheelZoom_","setMouseAnchor","PinchRotate","rotating_","rotationDelta_","threshold_","threshold","rotationDelta","touch0","touch1","PinchZoom","lastDistance_","lastScaleDelta_","scaleDelta","DragAndDropEventType","DragAndDropEvent","file","opt_features","opt_projection","DragAndDrop","formatConstructors_","formatConstructors","dropListenKeys_","source_","handleDrop","files","dataTransfer","reader","FileReader","handleResult_","readAsText","handleStop","dropEffect","result","tryReadFeatures_","featureProjection","addFeatures","registerListeners_","dropArea","unregisterListeners_","readFeatures","DragRotateAndZoom","lastMagnitude_","magnitude","angleDelta","Circle","setCenterAndRadius","getRadiusSquared_","MultiLineString","appendLineString","multiLineString","opt_interpolate","lineStringsCoordinateAtM","getLineString","getLineStrings","lineStrings","getFlatMidpoints","midpoints","douglasPeuckerArray","simplifiedMultiLineString","intersectsLineStringArray","setLineStrings","MultiPoint","linearRingss","appendPoint","multiPoint","getPoint","MultiPolygon","endss_","flatInteriorPointsRevision_","flatInteriorPoints_","appendPolygon","multiPolygon","newEndss","multiArrayMaxSquaredDelta","assignClosestMultiArrayPoint","linearRingssContainsXY","linearRingssArea","getEndss","getFlatInteriorPoints","linearRingssCenter","getInteriorPoints","linearRingsAreOriented","simplifiedEndss","quantizeMultiArray","simplifiedMultiPolygon","getPolygon","prevEnds","getPolygons","polygons","intersectsLinearRingMultiArray","opt_endss","deflateMultiCoordinatesArray","lastEnds","setPolygons","IMAGE","TILE","VECTOR_TILE","VECTOR","VectorLayer","renderBuffer","updateWhileAnimating","updateWhileInteracting","declutter_","declutter","renderBuffer_","updateWhileAnimating_","updateWhileInteracting_","renderMode_","renderMode","VectorRenderType","LayerType","getDeclutter","setDeclutter","getRenderBuffer","getRenderOrder","getUpdateWhileAnimating","getUpdateWhileInteracting","setRenderOrder","renderOrder","styleFunction","getRenderMode","JSON","TEXT","XML","loadFeaturesXhr","url","success","failure","xhr","XMLHttpRequest","open","FormatType","responseType","onload","status","responseText","responseXML","DOMParser","parseFromString","readProjection","getLastExtent","onerror","send","dataProjection","all","Source","attributions_","adaptAttributions_","wrapX_","wrapX","attributionLike","getWrapX","refresh","setAttributions","module","swap","defaultCompare","compare","quickselectStep","sd","newLeft","newRight","factory","rbush","maxEntries","_maxEntries","_minEntries","_initFormat","findItem","items","equalsFn","calcBBox","toBBox","distBBox","children","destNode","createNode","child","leaf","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","multiSelect","quickselect","_all","search","bbox","childBBox","nodesToSearch","collides","insert","_build","_splitRoot","tmpNode","_insert","goingUp","indexes","_condense","compareMinX","compareMinY","toJSON","fromJSON","N","M","right2","right3","N2","N1","_chooseSubtree","level","targetNode","enlargement","minEnlargement","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","bbox1","bbox2","overlap","minOverlap","_allDistMargin","leftBBox","rightBBox","siblings","compareArr","Function","RBush","opt_maxEntries","rbush_","items_","extents","uid","getAll","getInExtent","forEach_","forEachInExtent","VectorSourceEvent","opt_feature","VectorSource","loader_","format_","overlaps_","overlaps","url_","loader","strategy_","strategy","allStrategy","collection","useSpatialIndex","featuresRtree_","loadedExtentsRtree_","nullGeometryFeatures_","idIndex_","undefIdIndex_","featureChangeKeys_","featuresCollection_","addFeaturesInternal","bindFeaturesCollection_","addFeature","addFeatureInternal","featureKey","addToIndex_","setupChangeEvents_","VectorEventType","handleFeatureChange_","valid","newFeatures","geometryFeatures","modifyingCollection","removeFeature","opt_fast","featureId","removeFeatureInternal","clearEvent","forEachFeature","forEachFeatureAtCoordinateDirect","forEachFeatureInExtent","forEachFeatureIntersectingExtent","getFeaturesCollection","getFeatures","getFeaturesAtCoordinate","getFeaturesInExtent","getClosestFeatureToCoordinate","opt_filter","closestFeature","previousMinSquaredDistance","minDistance","getFeatureById","getFormat","getOverlaps","getUrl","sid","removeFromIdIndex_","hasFeature","loadFeatures","loadedExtentsRtree","extentsToLoad","extentToLoad","removeLoadedExtent","removed","setLoader","DrawEventType","DrawEvent","Draw","shouldHandle_","downPx_","downTimeout_","lastDragTime_","freehand_","features_","snapTolerance_","snapTolerance","type_","mode","getMode","stopClick_","stopClick","minPoints_","minPoints","maxPoints_","maxPoints","finishCondition_","finishCondition","geometryFunction","opt_geometry","squaredLength","squaredCoordinateDistance","Constructor","dragVertexDelay_","dragVertexDelay","finishCoordinate_","sketchFeature_","sketchPoint_","sketchCoords_","sketchLine_","sketchLineCoords_","squaredClickTolerance_","clickTolerance","overlay_","geometryName","freehandCondition_","freehand","freehandCondition","updateState_","pass","addToDrawing_","handlePointerEvent","startDrawing_","circleMode","finishDrawing","atFinish_","abortDrawing_","downPx","clickPx","modifyDrawing_","createOrUpdateSketchPoint_","at","potentiallyDone","potentiallyFinishCoordinates","finishCoordinate","finishPixel","updateSketchFeatures_","ring","removeLastPoint","sketchFeature","sketchFeatures","overlaySource","ExtentEventType","ExtentInteractionEvent","ExtentInteraction","pointerHandler_","pixelTolerance_","pixelTolerance","snappedToVertex_","extentFeature_","vertexFeature_","extentOverlay_","boxStyle","vertexOverlay_","pointerStyle","vertex","snapToVertex_","getOpposingPoint","x_","y_","getPointHandler","getEdgeHandler","pixelCoordinate","createOrUpdatePointerFeature_","fixedPoint","fixedP1","fixedP2","segments","closestSegment","vertexPixel","coordinateDistance","pixel1","pixel2","squaredDist1","squaredDist2","dist","createOrUpdateExtentFeature_","extentFeature","vertexFeature","ModifyEventType","ModifyEvent","mapBrowserPointerEvent","Modify","defaultDeleteCondition_","deleteCondition_","deleteCondition","insertVertexCondition_","insertVertexCondition","vertexSegments_","lastPixel_","ignoreNextSingleClick_","modified_","rBush_","changingFeature_","dragSegments_","SEGMENT_WRITERS_","writePointGeometry_","writeLineStringGeometry_","writePolygonGeometry_","writeMultiPointGeometry_","writeMultiLineStringGeometry_","writeMultiPolygonGeometry_","writeCircleGeometry_","GeometryCollection","writeGeometryCollectionGeometry_","handleSourceAdd_","handleSourceRemove_","addFeature_","handleFeatureAdd_","handleFeatureRemove_","lastPointerEvent_","CIRCLE_CENTER_INDEX","CIRCLE_CIRCUMFERENCE_INDEX","compareIndexes","handlePointerAtPixel_","insertVertices","vertexExtent","segmentDataMatches","componentSegments","segmentDataMatch","depth","closestOnSegmentData","willModifyFeatures_","insertVertex_","dragSegment","segmentData","setGeometryCoordinates_","createOrUpdateVertexFeature_","centerSegmentData","featureSegments","circumferenceSegmentData","removePoint","pointDistanceToSegmentDataSquared","pointCoordinates","circleGeometry","distanceToCenterSquared","distanceToCircumference","removeFeature_","removeFeatureSegmentData_","rBush","nodesToRemove","lines","rings","kk","geometries","getGeometriesArray","box","nodes","vertexSegments","rTree","updateSegmentIndices_","newSegmentData","newSegmentData2","removeVertex_","component","newIndex","dragSegments","segmentsByFeature","deleted","SelectEventType","SelectEvent","selected","deselected","Select","addCondition_","addCondition","removeCondition_","removeCondition","toggleCondition_","toggleCondition","multi_","multi","filter_","hitTolerance_","featureOverlay","featureOverlay_","layerFilter_","featureLayerAssociation_","addFeatureLayerAssociation_","removeFeatureLayerAssociation_","getHitTolerance","getLayer","setHitTolerance","currentMap","selectedFeatures","Snap","vertex_","edge_","featuresListenerKeys_","featureChangeListenerKeys_","indexedFeaturesExtents_","pendingFeatures_","pixelCoordinate_","sortByDistance_","deltaA","deltaB","snapTo","snapped","featuresToUpdate","updateFeature_","opt_listen","register","feature_uid","segmentWriter","forEachFeatureAdd_","forEachFeatureRemove_","getFeatures_","opt_unlisten","unregister","isCircle","closestOnCircle","TranslateEventType","TranslateEvent","Translate","lastCoordinate_","lastFeature_","handleActiveChanged_","featuresAtPixel_","newCoordinate","altShiftDragRotate","doubleClickZoom","zoomDelta","zoomDuration","dragPan","pinchRotate","pinchZoom","keyboard","mouseWheelZoom","shiftDragZoom","oldMap","ImageCanvas","opt_loader","error_","getError","handleLoad_","err","RenderEvent","opt_vectorContext","opt_context","opt_glContext","glContext","VectorContext","drawCustom","drawCircle","drawFeature","drawGeometryCollection","geometryCollectionGeometry","drawLineString","lineStringGeometry","drawMultiLineString","multiLineStringGeometry","drawMultiPoint","multiPointGeometry","drawMultiPolygon","multiPolygonGeometry","drawPoint","pointGeometry","drawPolygon","polygonGeometry","drawText","setImageStyle","imageStyle","opt_declutterGroup","textStyle","CanvasImmediateRenderer","viewRotation","context_","viewRotation_","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageSnapToPixel_","imageWidth_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textScale_","textFillState_","textStrokeState_","textState_","pixelCoordinates_","tmpLocalTransform_","drawImages_","pixelCoordinates","localTransform","drawText_","setContextFillState_","setContextStrokeState_","setContextTextState_","strokeText","fillText","moveToLineTo_","close","moveTo","drawRings_","simpleGeometry","transformGeom2D","flatMidpoint","geometryExtent","flatMidpoints","flatInteriorPoint","flatInteriorPoints","fillState","contextFillState","strokeState","contextStrokeState","textState","contextTextState","fillStyleColor","strokeStyleColor","strokeStyleLineCap","strokeStyleLineDash","strokeStyleLineDashOffset","strokeStyleLineJoin","strokeStyleWidth","strokeStyleMiterLimit","imageAnchor","imageImage","imageOrigin","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","textOffsetX","textOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","textTextBaseline","IconImageCache","cache_","cacheSize_","maxCacheSize_","expire","iconImage","maxCacheSize","shared","MapRenderer","layerRenderers_","layerRendererListeners_","layerRendererConstructors_","expireIconCache","iconImageCache","sortByZIndex","state1","state2","registerLayerRenderers","constructors","getLayerRendererConstructors","calculateMatrices2D","invertTransform","transformSetFromArray","removeLayerRendererByKey_","viewResolution","translatedCoordinate","projectionExtent","worldWidth","layerRenderer","getLayerRenderer","layerKey","candidate","handleLayerRendererChange_","getLayerRendererByKey","getLayerRenderers","removeUnusedLayerRenderers_","scheduleExpireIconCache","scheduleRemoveUnusedLayerRenderers","layerRendererConstructors","CanvasMapRenderer","insertBefore","childNodes","dispatchComposeEvent_","composeEvent","clearRect","save","prepareFrame","composeFrame","restore","numLayers","forEachLayerAtCoordinate","ctor","LayerRenderer","layer_","createLoadedTileFinder","tiles","tileRange","forEachLoadedTile","handleImageChange_","renderIfReadyAndVisible","loadImage","imageState","scheduleExpireCache","tileSource","postRenderFunction","expireCache","updateUsedTiles","zKey","manageTilePyramid","currentZ","preload","opt_tileCallback","getTileRangeForExtentAndZ","getTile","getTileCoordCenter","useTile","CanvasLayerRenderer","renderedResolution","clip","topLeft","topRight","bottomRight","bottomLeft","opt_transform","postCompose","preCompose","dispatchRenderEvent","IntermediateCanvasRenderer","coordinateToCanvasPixelTransform","hitCanvasContext_","clipped","imageTransform","getImageTransform","dw","dh","imageData","getImageData","CanvasImageLayerRenderer","imageLayer","imageTransform_","skippedFeatures_","vectorRenderer_","mapRenderer","viewCenter","imageSource","vectorRenderer","renderedExtent","skippedFeatures","imageFrameState","newSkippedFeatures","replayGroupChanged","imageExtent","imageResolution","imagePixelRatio","TileRange","containsTileRange","CanvasTileLayerRenderer","tileLayer","oversampling_","renderedExtent_","renderedRevision","renderedTiles","newTiles_","tmpExtent","tmpTileRange_","zDirection","isDrawableTile_","tileState","useInterimTilesOnError","getUseInterimTilesOnError","getPreload","sourceRevision","getTileGridForProjection","getZForResolution","oversampling","getTileRangeExtent","tilePixelRatio","getTilePixelRatio","tilesToDrawByZ","findLoadedTiles","animatingOrInteracting","tmpTileRange","childTileRange","getTileCoordChildTileRange","covered","forEachTileCoordParentTileRange","tilePixelSize","getTilePixelSize","currentScale","currentTilePixelSize","tileExtent","tileGutter","tilesToDraw","zs","tileCoordKey","getGutter","getTileCoordExtent","drawTileImage","gutter","getOpaque","alphaChanged","ReplayGroup","getReplay","replayType","DEFAULT","drawTextOnPath","measure","startM","previousAngle","reverse","numChars","segmentM","chunk","chunkLength","char","charLength","charM","segmentPos","unshift","Instruction","fillInstruction","strokeInstruction","beginPathInstruction","closePathInstruction","ORDER","ReplayType","TEXT_ALIGN","middle","hanging","alphabetic","ideographic","bottom","CanvasReplay","maxExtent","declutterTree","maxLineWidth","alignFill_","beginGeometryInstruction1_","beginGeometryInstruction2_","bufferedMaxExtent_","instructions","coordinateCache_","renderedTransform_","hitDetectionInstructions","replayTextBackground_","p3","p4","setStrokeStyle_","replayImage_","declutterGroup","fillStroke","boxW","boxH","boxX","boxY","strokePadding","declutterArgs","applyPixelRatio","dashArray","dash","appendFlatCoordinates","closed","skipFirst","myEnd","getBufferedMaxExtent","lastRel","nextRel","lastCoord","nextCoord","skipped","drawCustomCoordinates_","replayEnds","replayEnd","beginGeometry","replayEndss","replayBegin","myEnds","CanvasInstruction","endGeometry","origin","repeatSize","instruction","renderDeclutter_","groupCount","declutterData","replay_","skippedFeaturesHash","featureCallback","opt_hitExtent","dd","prevX","prevY","roundX","roundY","skipFeatures","pendingFill","pendingStroke","lastFillInstruction","lastStrokeInstruction","coordinateCache","batchSize","fn","baseline","fillKey","strokeKey","textKey","pathLength","textLength","textStates","parts","cc","chars","part","replay","replayHitDetection","opt_featureCallback","reverseHitDetectionInstructions","createFill","applyStroke","createStroke","updateFillStyle","currentFillStyle","updateStrokeStyle","currentStrokeStyle","currentLineCap","currentLineDash","currentLineDashOffset","currentLineJoin","currentLineWidth","currentMiterLimit","endGeometryInstruction","finish","CanvasImageReplay","declutterGroup_","hitDetectionImage_","anchorX_","anchorY_","height_","originX_","originY_","drawCoordinates_","myBegin","hitDetectionImage","CanvasLineStringReplay","drawFlatCoordinates_","moveToLineToInstruction","lastStroke","CanvasPolygonReplay","matchingChunk","m12","m23","x12","y12","x23","y23","chunkStart","chunkEnd","chunkM","acos","drawFlatCoordinatess_","numEnds","setFillStrokeStyles_","circleInstruction","CanvasTextReplay","labels_","fillStates","strokeStates","textKey_","fillKey_","strokeKey_","widths_","geometryType","flatEnd","flatOffset","oo","range","drawChars_","drawTextImage_","align","numLines","widths","currentWidth","measureTextWidths","lineHeight","renderWidth","leftRight","BATCH_CONSTRUCTORS","Default","CanvasReplayGroup","opt_renderBuffer","declutterTree_","tolerance_","maxExtent_","resolution_","replaysByZIndex_","hitDetectionContext_","hitDetectionTransform_","circleArrayCache","0","fillCircleArrayRowToMiddle","addDeclutter","group","flatClipCoords","getClipCoords","hasReplays","replays","candidates","replayKey","declutterReplays","hitExtent","contextSize","declutteredFeatures","mask","arraySize","getCircleArray","zIndexKey","getReplays","opt_replayTypes","opt_declutterReplays","replayTypes","SIMPLIFY_TOLERANCE","GEOMETRY_RENDERERS","replayGroup","imageReplay","textReplay","lineStringReplay","polygonReplay","geometryRenderer","circleReplay","defaultOrder","feature1","feature2","getSquaredTolerance","getTolerance","renderFeature","loading","renderGeometry","getGeometries","renderFeatureInternal","CanvasVectorLayerRenderer","vectorLayer","dirty_","renderedRevision_","renderedResolution_","renderedRenderOrder_","replayGroup_","handleFontsChanged_","vectorSource","clipExtent","replayContext","drawOffsetX","drawOffsetY","transparentLayer","hasRenderListeners","drawWidth","drawHeight","drawSize","world","mainContextAlpha","handleStyleImageChange_","animating","interacting","frameStateExtent","vectorLayerRevision","vectorLayerRenderBuffer","vectorLayerRenderOrder","defaultRenderOrder","getRenderTolerance","dirty","getSquaredRenderTolerance","IMAGE_REPLAYS","hybrid","VECTOR_REPLAYS","vector","CanvasVectorTileLayerRenderer","renderedLayerRevision_","tmpTransform_","VectorTileRenderType","createReplayGroup_","renderTileImage_","layerRevision","revision","replayState","getReplayState","renderedRenderOrder","sourceTileGrid","getTileGrid","sourceTile","tileKeys","sourceTileCoord","sourceTileExtent","sharedExtent","bufferedExtent","tileProjection","reproject","setReplayGroup","tt","getReplayGroup","getReplayTransform_","renderResolution","clips","worldOffset","currentClip","zz","replayData","replayDeclutter","renderedTileRevision","wrappedTileCoord","pixelScale","scaleTransform","translateTransform","Map","defaultControls","defaultInteractions","Overlay","insertFirst","autoPan","autoPanAnimation","autoPanMargin","rendered","bottom_","left_","right_","top_","mapPostrenderListenerKey","handleElementChanged","handleMapChanged","handleOffsetChanged","handlePositionChanged","handlePositioningChanged","setElement","setOffset","setPositioning","positioning","OverlayPositioning","setPosition","getElement","getOffset","getPositioning","updatePixelPosition","panIntoView","mapRect","getRect","overlayRect","marginLeft","marginRight","marginTop","marginBottom","offsetLeft","offsetRight","offsetTop","offsetBottom","centerPx","newCenterPx","pageXOffset","pageYOffset","mapSize","updateRenderedPosition","getOptions","VectorTile","consumers","replayGroups_","DEFAULT_EXTENT","onLoad","setFeatures","onError","changeType","getChangeType","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","requestFullscreen","FullScreen","cssClassName_","labelNode_","labelActive","labelActiveNode_","isFullScreen","isFullScreenSupported","keys_","mozFullScreenEnabled","msFullscreenEnabled","fullscreenEnabled","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","requestFullScreen","handleFullScreen_","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","mozRequestFullScreenWithKeys","Element","ALLOW_KEYBOARD_INPUT","handleFullScreenChange_","firstElementChild","OverviewMap","ovmapDiv_","ovmap_","ovmap","boxSizing","boxOverlay_","scope","overlayBox","mousePosition","endMoving","validateExtent_","updateBox_","oldView","unbindView_","handleMapPropertyChange_","bindView_","resetExtent_","newView","handleRotationChanged_","ovmapSize","ovextent","topLeftPixel","bottomRightPixel","boxWidth","boxHeight","ovmapWidth","ovmapHeight","recenter_","ovview","steps","MAX_RATIO","LN2","ovresolution","rotateBottomLeft","calculateCoordinateRotate_","coordinateRotate","getOverviewMap","UNITS_PROP","LEADING_DIGITS","ScaleLine","innerElement_","viewState_","minWidth_","minWidth","renderedWidth_","renderedHTML_","handleUnitsChanged_","setUnits","pointResolutionUnits","ProjUnits","nominalCount","suffix","metersPerDegree","html","Direction","ZoomSlider","currentResolution_","direction_","heightLimit_","widthLimit_","previousX_","previousY_","thumbSize_","sliderInitialized_","thumbElement","containerElement","dragger_","handleDraggerStart_","handleDraggerDrag_","handleDraggerEnd_","handleContainerClick_","initSlider_","res","setThumbPosition_","containerSize","thumb","thumbWidth","thumbHeight","relativePosition","getRelativePosition_","getResolutionForPosition_","getPositionForResolution_","ZoomToExtent","handleZoomToExtent","WebGLShader","isAnimated","WebGLFragment","WebGLVertex","fragment","Locations","program","u_projectionMatrix","getUniformLocation","u_offsetScaleMatrix","u_offsetRotateMatrix","u_lineWidth","u_pixelRatio","u_opacity","u_fillColor","u_strokeColor","u_size","a_position","getAttribLocation","a_instruction","a_radius","fromTransform","mat4","WebGLReplay","projectionMatrix_","offsetRotateMatrix_","offsetScaleMatrix_","tmpMat4_","indices","indicesBuffer","startIndices","startIndicesFeature","verticesBuffer","getDeleteResourcesFunction","setUpProgram","shutDownProgram","locations","drawReplay","hitDetection","drawHitDetectionReplayOneByOne","drawHitDetectionReplay","oneByOne","drawHitDetectionReplayAll","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","tmpStencil","tmpStencilFunc","tmpStencilMaskVal","tmpStencilRef","tmpStencilMask","tmpStencilOpFail","tmpStencilOpPass","tmpStencilOpZFail","getGL","isEnabled","STENCIL_TEST","STENCIL_FUNC","STENCIL_VALUE_MASK","STENCIL_REF","STENCIL_WRITEMASK","STENCIL_FAIL","STENCIL_PASS_DEPTH_PASS","STENCIL_PASS_DEPTH_FAIL","enable","STENCIL_BUFFER_BIT","stencilMask","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","NOTEQUAL","bindBuffer","projectionMatrix","rotateTransform","offsetScaleMatrix","offsetRotateMatrix","uniformMatrix4fv","uniform1f","drawElements","elementType","hasOESElementIndexUint","numItems","offsetInBytes","DEFAULT_FILLSTYLE","DEFAULT_LINEDASH","DEFAULT_STROKESTYLE","EPSILON","triangleIsCounterClockwise","BufferUsage","WebGLBuffer","opt_arr","opt_usage","arr_","usage_","getUsage","WebGLCircleReplay","defaultLocations_","styles_","styleIndices_","fillColor","strokeColor","numVertices","numIndices","lastState","deleteBuffer","getProgram","useProgram","enableVertexAttribArray","vertexAttribPointer","uniform2fv","disableVertexAttribArray","nextStyle","setFillStyle_","drawReplaySkipping_","groupStart","featureIndex","featureStart","uniform4fv","u_image","a_texCoord","a_offsets","a_opacity","a_rotateWithView","WebGLContext","gl_","bufferCache_","shaderCache_","programCache_","currentProgram_","hitDetectionFramebuffer_","hitDetectionTexture_","hitDetectionRenderbuffer_","getExtension","ContextEventType","handleWebGLContextLost","handleWebGLContextRestored","createTextureInternal","opt_wrapS","opt_wrapT","texture","createTexture","bindTexture","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","createEmptyTexture","texImage2D","UNSIGNED_BYTE","buf","bufferKey","String","bufferCacheEntry","arrayBuffer","createBuffer","Float32Array","Uint32Array","Uint16Array","bufferData","isContextLost","deleteProgram","deleteShader","deleteFramebuffer","deleteRenderbuffer","deleteTexture","getCanvas","getHitDetectionFramebuffer","initHitDetectionFramebuffer_","getShader","shaderObject","shaderKey","shader","createShader","shaderSource","compileShader","fragmentShaderObject","vertexShaderObject","programKey","createProgram","attachShader","linkProgram","framebuffer","createFramebuffer","bindFramebuffer","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","WebGLTextureReplay","groupIndices","hitDetectionGroupIndices","imageHeight","imageWidth","defaultLocations","textures","getTextures","drawCoordinates","createTextures","images","texturePerImage","getHitDetectionTextures","drawReplaySkipping","groupEnd","hitDetectionTextures","opt_all","WebGLImageReplay","images_","hitDetectionImages_","textures_","hitDetectionTextures_","lineStringIsClosed","u_miterLimit","u_color","a_lastPos","a_nextPos","a_direction","WebGLLineStringReplay","startCoords","sign","p0","lastSign","addVertices_","product","isValid_","indexCount","drawPolygonCoordinates","holeFlatCoordinates","setPolygonStyle","opt_index","getCurrentIndex","tmpDepthFunc","DEPTH_FUNC","tmpDepthMask","DEPTH_WRITEMASK","DEPTH_TEST","depthMask","depthFunc","LinkedList","opt_circular","first_","last_","head_","circular_","length_","insertItem","next","head","removeItem","firstItem","lastItem","nextItem","getNextItem","prevItem","getPrevItem","getCurrItem","setFirstItem","list","WebGLPolygonReplay","outerRing","rtree","processFlatCoordinates_","maxCoords","getMaxCoords_","holeLists","holeList","classifyPoints_","currList","currItem","getIntersections_","bridgeHole_","triangulate_","clockwise","createPoint_","insertItem_","seg","ccw","s0","pointsReclassified","reflex","removeItem_","hole","holeMaxX","listMaxX","bestPoint","p5","minDist","intersectingSegments","currSeg","calculateIntersection_","pointsInTriangle","getPointsInTriangle_","currPoint","currTheta","p0Bridge","p1Bridge","simple","isSimple_","clipEars_","resolveSelfIntersections_","splitPolygon_","isClockwise_","s3","processedEars","variableCriterion","diagonalIsInside_","opt_touch","resolvedIntersections","breakCond","newPolygon","newRtree","opt_rtree","opt_reflex","segmentsInExtent","denom","ub","p1IsLeftOf","p1IsRightOf","p3IsLeftOf","p3IsRightOf","p1InCone","p3InCone","currIndex","currLineIndex","holes","holeFlatCoords","lineDeleter","nullStrokeStyle","Atlas","space","space_","emptyBlocks_","renderCallback","block","split_","newBlock1","newBlock2","deltaWidth","updateBlocks_","args","AtlasManager","currentSize_","initialSize","maxSize_","maxSize","atlases_","currentHitSize_","hitAtlases_","getInfo","getInfo_","hitInfo","mergeInfos_","atlases","opt_renderHitCallback","add_","renderHitCallback","isHitAtlas","atlas","WebGLTextReplay","measureCanvas_","currAtlas_","currX","currY","charArr","charInfo","glyphAtlas","textSize","getTextSize_","self","textHeight","str","sum","curr","addCharToAtlas_","reduce","mCtx","getAtlas_","params","hash","calculateHash_","HIT_DETECTION_SIZE","WebGLReplayGroup","functions","replayHitDetection_","Uint8Array","readPixels","WebGLImmediateRenderer","center_","imageStyle_","fillStyle_","textStyle_","u_texCoordMatrix","u_texture","WebGLLayerRenderer","arrayBuffer_","framebufferDimension","texCoordMatrix","uniform1i","getTexCoordMatrix","getProjectionMatrix","getTexture","drawArrays","WebGLImageLayerRenderer","hitTransformationMatrix_","createTexture_","imageElement","updateProjectionMatrix_","canvasWidth","canvasHeight","canvasExtentWidth","canvasExtentHeight","getHitTransformationMatrix_","pixelOnFrameBuffer","mapCoordTransform","projectionMatrixInv","multiplyTransform","WebGLMapRenderer","clipTileCanvasWidth_","clipTileCanvasHeight_","clipTileContext_","antialias","preserveDrawingBuffer","stencil","textureCache_","tileTextureQueue_","loadNextTileTexture_","tileSize","bindTileTexture","textureCacheFrameMarkerCount_","initializeGL_","magFilter","minFilter","textureCacheEntry","clipTileCanvas","clipTileContext","expireCache_","getTileTextureQueue","renderers","activeTexture","blendFuncSeparate","isTileTextureLoaded","layerStatesToDraw","clearColor","viewport","u_tileOffset","WebGLTileLayerRenderer","fragmentShader_","vertexShader_","locations_","renderArrayBuffer_","renderedTileRange_","renderedFramebufferExtent_","tmpSize_","loaded","framebufferExtent","getTileSize","tilePixelResolution","tileRangeSize","maxDimension","framebufferExtentDimension","allTilesLoaded","tileTextureQueue","pixelOnMapScaled","pixelOnFrameBufferScaled","WebGLVectorLayerRenderer","layerState_","SCISSOR_TEST","scissor","WebGLMap","PROJECTION","COORDINATE_FORMAT","MousePosition","coordinateFormat","setCoordinateFormat","undefinedHTML_","undefinedHTML","renderOnMouseOut_","mapProjection_","lastMouseMovePixel_","updateHTML_","getCoordinateFormat","handleMouseMove","handleMouseOut","FeatureFormat","defaultFeatureProjection","transformWithOptions","write","transformed","decimals","getReadOptions","adaptOptions","readFeature","readGeometry","writeFeature","writeFeatures","writeGeometry","JSONFeature","getObject","parse","readFeatureFromObject","readFeaturesFromObject","readGeometryFromObject","readProjectionFromObject","stringify","writeFeatureObject","writeFeaturesObject","writeGeometryObject","GEOMETRY_READERS","getGeometryLayout","paths","GEOMETRY_WRITERS","esriJSON","hasZM","getHasZM","hasZ","hasM","EsriJSON","flatRing","outerRings","shift","matched","containsHole","convertRings","geometryReader","geometryWriter","esriJSONFeature","idField","attributes","esriJSONFeatures","objectIdFieldName","esriJSONObject","spatialReference","wkid","objects","DOCUMENT","implementation","createDocument","XML_SCHEMA_INSTANCE_URI","createElementNS","namespaceURI","qualifiedName","getAllTextContent","normalizeWhitespace","getAllTextContent_","accumulator","nodeType","Node","CDATA_SECTION_NODE","TEXT_NODE","nodeValue","firstChild","nextSibling","isDocument","Document","xml","makeArrayExtender","valueReader","objectStack","makeArrayPusher","makeReplacer","makeObjectPropertyPusher","opt_property","localName","makeObjectPropertySetter","makeChildAppender","nodeWriter","makeArraySerializer","serializersNS","nodeFactory","serializers","makeSimpleNodeFactory","serialize","opt_nodeName","opt_namespaceURI","fixedNodeName","nodeName","OBJECT_PROPERTY_NODE_FACTORY","makeSequence","orderedKeys","sequence","makeStructureNS","namespaceURIs","structure","opt_structureNS","structureNS","parseNode","parsersNS","nextElementSibling","parsers","parser","pushParseAndPop","opt_keys","pushSerializeAndPop","XMLFeature","xmlSerializer_","XMLSerializer","readFeatureFromDocument","readFeatureFromNode","doc","readFeaturesFromDocument","readFeaturesFromNode","ELEMENT_NODE","readGeometryFromDocument","readGeometryFromNode","readProjectionFromDocument","readProjectionFromNode","writeFeatureNode","serializeToString","writeFeaturesNode","writeGeometryNode","GMLNS","GMLBase","featureType","featureNS","srsName","schemaLocation","FEATURE_COLLECTION_PARSERS","featureMember","readFeaturesInternal","featureMembers","ONLY_WHITESPACE_RE","readBoolean","readBooleanString","string","readDateTime","dateTime","readDecimal","readDecimalString","readNonNegativeInteger","readNonNegativeIntegerString","readString","trim","writeBooleanTextNode","bool","writeStringTextNode","writeDecimalTextNode","toPrecision","writeNonNegativeIntegerTextNode","nonNegativeInteger","ft","uri","ns","featureTypes","readFeatureElement","readGeometryElement","getAttribute","GEOMETRY_PARSERS_","fid","getAttributeNS","test","readPoint","readFlatCoordinatesFromNode_","readMultiPoint","MULTIPOINT_PARSERS_","readMultiLineString","MULTILINESTRING_PARSERS_","readMultiPolygon","MULTIPOLYGON_PARSERS_","pointMemberParser_","POINTMEMBER_PARSERS_","lineStringMemberParser_","LINESTRINGMEMBER_PARSERS_","polygonMemberParser_","POLYGONMEMBER_PARSERS_","readLineString","readFlatLinearRing_","GEOMETRY_FLAT_COORDINATES_PARSERS_","readLinearRing","readPolygon","flatLinearRings","FLAT_LINEAR_RINGS_PARSERS_","http://www.opengis.net/gml","pointMember","pointMembers","lineStringMember","lineStringMembers","polygonMember","polygonMembers","RING_PARSERS","GML3","surface_","surface","curve_","curve","multiCurve_","multiCurve","multiSurface_","multiSurface","readMultiCurve_","MULTICURVE_PARSERS_","readMultiSurface_","MULTISURFACE_PARSERS_","curveMemberParser_","CURVEMEMBER_PARSERS_","surfaceMemberParser_","SURFACEMEMBER_PARSERS_","readPatch_","PATCHES_PARSERS_","readSegment_","SEGMENTS_PARSERS_","readPolygonPatch_","readLineStringSegment_","interiorParser_","flatLinearRing","exteriorParser_","readSurface_","SURFACE_PARSERS_","readCurve_","CURVE_PARSERS_","readEnvelope_","ENVELOPE_PARSERS_","readFlatPos_","re","containerSrs","readFlatPosList_","contextDimension","dim","posList","interior","exterior","Surface","MultiSurface","Curve","MultiCurve","Envelope","curveMember","curveMembers","surfaceMember","surfaceMembers","patches","lowerCorner","upperCorner","PolygonPatch","LineStringSegment","writePos_","srsDimension","getCoords_","opt_srsName","opt_hasZ","writePosList_","writePoint_","writeEnvelope","ENVELOPE_SERIALIZERS_","writeLinearRing_","RING_NODE_FACTORY_","exteriorWritten","writeSurfaceOrPolygon_","RING_SERIALIZERS_","writeSurfacePatches_","writeCurveOrLineString_","writeCurveSegments_","writeMultiSurfaceOrPolygon_","SURFACEORPOLYGONMEMBER_SERIALIZERS_","MULTIGEOMETRY_MEMBER_NODE_FACTORY_","writeMultiPoint_","POINTMEMBER_SERIALIZERS_","writeMultiCurveOrLineString_","LINESTRINGORCURVEMEMBER_SERIALIZERS_","writeRing_","writeSurfaceOrPolygonMember_","GEOMETRY_NODE_FACTORY_","writePointMember_","writeLineStringOrCurveMember_","writeGeometryElement","GEOMETRY_SERIALIZERS_","writeFeatureElement","writeFeatureMembers_","MULTIGEOMETRY_TO_MEMBER_NODENAME","setAttributeNS","GML","GML2","readFlatCoordinates_","proj","coordsGroups","readBox_","BOX_PARSERS_","innerBoundaryIsParser_","outerBoundaryIsParser_","createCoordinatesNode_","writeCoordinates_","innerBoundaryIs","outerBoundaryIs","Box","GPX","readExtensions_","readExtensions","NAMESPACE_URIS","FEATURE_READER","rte","readRte","trk","readTrk","wpt","readWpt","GPX_PARSERS","LINK_PARSERS","RTE_PARSERS","cmt","desc","link","parseLink","extensions","parseExtensions","rtept","RTEPT_PARSERS","rteValues","layoutOptions","ele","TRK_PARSERS","trkseg","TRKSEG_PARSERS","trkpt","TRKPT_PARSERS","trkValues","WPT_PARSERS","magvar","geoidheight","sym","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid","LINK_SEQUENCE","LINK_SERIALIZERS","RTE_SEQUENCE","RTE_SERIALIZERS","writeLink","writeWptType","RTEPT_TYPE_SEQUENCE","TRK_SEQUENCE","TRK_SERIALIZERS","geometryLayout","TRKSEG_SERIALIZERS","TRKSEG_NODE_FACTORY","WPT_TYPE_SEQUENCE","WPT_TYPE_SERIALIZERS","date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","GEOMETRY_TYPE_TO_NODENAME","GPX_NODE_FACTORY","GPX_SERIALIZERS","applyLayoutOptions","href","handleReadExtensions_","extensionsNode","featureReader","gpx","opt_geometries","geometries_","listenGeometriesChange_","cloneGeometries","clonedGeometries","unlistenGeometriesChange_","geometryCollection","setGeometries","simplifiedGeometries","simplified","simplifiedGeometryCollection","setGeometriesArray","GeoJSON","extractGeometryName_","extractGeometryName","rightHanded","geoJSONFeature","geometry_name","geoJSONFeatures","crs","TextFeature","readFeatureFromText","readFeaturesFromText","readGeometryFromText","readProjectionFromText","writeFeatureText","writeFeaturesText","writeGeometryText","IGCZ","IGC","altitudeMode_","altitudeMode","B_RECORD_RE","H_RECORD_RE","HFDTE_RECORD_RE","NEWLINE_RE","year","month","day","lastDateTime","hour","minute","second","UTC","IconImage","imageState_","tainting_","determineTainting_","dispatchChangeEvent_","replaceColor_","getSrc","imgData","putImageData","DEFAULT_COLOR","Icon","normalizedAnchor_","anchorOrigin_","anchorOrigin","IconOrigin","anchorXUnits_","anchorXUnits","IconAnchorUnits","anchorYUnits_","anchorYUnits","img","imgSize","iconImage_","offset_","offsetOrigin_","offsetOrigin","iconImageSize","DEFAULT_IMAGE_STYLE_ANCHOR","DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS","DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS","DEFAULT_IMAGE_STYLE_SIZE","DEFAULT_IMAGE_STYLE_SRC","DEFAULT_IMAGE_SCALE_MULTIPLIER","DEFAULT_NO_IMAGE_STYLE","DEFAULT_TEXT_STROKE_STYLE","DEFAULT_FILL_STYLE","DEFAULT_IMAGE_STYLE","DEFAULT_TEXT_STYLE","DEFAULT_STYLE","DEFAULT_STYLE_ARRAY","KML","defaultStyle_","defaultStyle","extractStyles_","extractStyles","writeStyles_","writeStyles","sharedStyles_","showPointNames_","showPointNames","GX_NAMESPACE_URIS","ICON_ANCHOR_UNITS_MAP","pixels","insetPixels","createNameStyleFunction","foundStyle","textOffset","imageScale","foundText","createFeatureStyleFunction","styleUrl","sharedStyles","nameStyle","drawName","findStyle","styleValue","readColor","hexColor","readFlatCoordinates","readURI","baseURI","location","URL","readScale","STYLE_MAP_PARSERS","Pair","pairObject","PAIR_PARSERS","readStyleMapValue","ICON_STYLE_PARSERS","iconObject","ICON_PARSERS","hotSpot","xunits","yunits","LABEL_STYLE_PARSERS","LINE_STYLE_PARSERS","POLY_STYLE_PARSERS","outline","FLAT_LINEAR_RING_PARSERS","readFlatLinearRing","GX_MULTITRACK_GEOMETRY_PARSERS","Track","readGxTrack","GX_TRACK_PARSERS","when","whens","coord","gxTrackObject","GEOMETRY_FLAT_COORDINATES_PARSERS","readFlatCoordinatesFromNode","EXTRUDE_AND_ALTITUDE_MODE_PARSERS","extrude","tessellate","MULTI_GEOMETRY_PARSERS","MultiGeometry","readMultiGeometry","multiGeometry","homogeneous","setCommonGeometryProperties","FLAT_LINEAR_RINGS_PARSERS","INNER_BOUNDARY_IS_PARSERS","OUTER_BOUNDARY_IS_PARSERS","STYLE_PARSERS","IconStyle","styleObject","IconObject","drawIcon","LabelStyle","LineStyle","PolyStyle","readStyle","hasExtrude","hasTessellate","hasAltitudeMode","extrudes","tessellates","altitudeModes","DATA_PARSERS","displayName","EXTENDED_DATA_PARSERS","Data","featureObject","SchemaData","SCHEMA_DATA_PARSERS","extendedDataParser","REGION_PARSERS","LatLonAltBox","LAT_LON_ALT_BOX_PARSERS","regionObject","Lod","LOD_PARSERS","lodObject","regionParser","SimpleData","minAltitude","maxAltitude","north","south","east","west","minLodPixels","maxLodPixels","minFadeExtent","maxFadeExtent","NETWORK_LINK_PARSERS","ExtendedData","Region","Link","address","description","phoneNumber","visibility","PLACEMARK_PARSERS","StyleMap","styleMapValue","placemarkObject","MultiTrack","writeColorTextNode","rgba","abgr","hex","readDocumentOrFolder_","Folder","Placemark","readPlacemark_","readSharedStyle_","readSharedStyleMap_","styleUri","fs","readName","readNameFromDocument","readNameFromNode","readNetworkLinks","networkLinks","readNetworkLinksFromDocument","readNetworkLinksFromNode","readRegion","regions","readRegionFromDocument","readRegionFromNode","EXTENDEDDATA_NODE_SERIALIZERS","pair","createCDATASection","DOCUMENT_SERIALIZERS","writePlacemark","DOCUMENT_NODE_FACTORY","DATA_NODE_FACTORY","ICON_SEQUENCE","ICON_SERIALIZERS","GX_NODE_FACTORY","ICON_STYLE_SEQUENCE","ICON_STYLE_SERIALIZERS","icon","vec2","writeScaleTextNode","LABEL_STYLE_SEQUENCE","LABEL_STYLE_SERIALIZERS","LINE_STYLE_SEQUENCE","LINE_STYLE_SERIALIZERS","GEOMETRY_NODE_FACTORY","POINT_NODE_FACTORY","LINE_STRING_NODE_FACTORY","LINEAR_RING_NODE_FACTORY","POLYGON_NODE_FACTORY","MULTI_GEOMETRY_SERIALIZERS","writePrimitiveGeometry","writePolygon","writeMultiGeometry","BOUNDARY_IS_SERIALIZERS","writeBoundaryIs","PLACEMARK_SERIALIZERS","namesAndValues","names","STYLE_SEQUENCE","STYLE_SERIALIZERS","PLACEMARK_SEQUENCE","EXTENDEDDATA_NODE_FACTORY","v","PRIMITIVE_GEOMETRY_SEQUENCE","PRIMITIVE_GEOMETRY_SERIALIZERS","POLYGON_SERIALIZERS","INNER_BOUNDARY_NODE_FACTORY","OUTER_BOUNDARY_NODE_FACTORY","POLY_STYLE_SERIALIZERS","COLOR_NODE_FACTORY","iconProperties","KML_SEQUENCE","KML_SERIALIZERS","kml","xmlnsUri","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","rt","Pbf","ArrayBuffer","isView","Varint","Fixed64","Bytes","Fixed32","SHIFT_LEFT_32","SHIFT_RIGHT_32","readPackedEnd","pbf","readVarint","toNum","isSigned","makeRoomForExtraLength","startPos","extraLen","realloc","writePackedVarint","writeVarint","writePackedSVarint","writeSVarint","writePackedFloat","writeFloat","writePackedDouble","writeDouble","writePackedBoolean","writeBoolean","writePackedFixed32","writeFixed32","writePackedSFixed32","writeSFixed32","writePackedFixed64","writeFixed64","writePackedSFixed64","writeSFixed64","readUInt32","writeInt32","readInt32","destroy","readFields","readField","tag","skip","readMessage","readFixed32","readSFixed32","readFixed64","readSFixed64","readFloat","ieee754","readDouble","readVarintRemainder","readVarint64","readSVarint","b3","b0","bytesPerSequence","fromCharCode","readUtf8","readBytes","subarray","readPackedVarint","readPackedSVarint","readPackedBoolean","readPackedFloat","readPackedDouble","readPackedFixed32","readPackedSFixed32","readPackedFixed64","readPackedSFixed64","writeTag","lsb","writeBigVarintHigh","writeBigVarint","writeString","lead","writeUtf8","writeBytes","writeRawMessage","writeMessage","writeBytesField","writeFixed32Field","writeSFixed32Field","writeFixed64Field","writeSFixed64Field","writeVarintField","writeSVarintField","writeStringField","writeFloatField","writeDoubleField","writeBooleanField","RenderFeature","flatCoordinates_","flatMidpoints_","properties_","midpoint","MVT","featureClass_","featureClass","layerName_","layerName","layers_","layersPBFReader","layerPBFReader","version","featurePBFReader","readRawFeature","readRawGeometry_","cmd","coordsLen","currentEnd","cmdLen","createFeature_","rawFeature","prevEndIndex","PBF","pbfLayers","pbfLayer","OSMXML","WAY_PARSERS","nd","ndrefs","readTag","PARSERS","tags","NODE_PARSERS","way","ways","flipXY","opt_destOffset","destOffset","Polyline","factor_","factor","geometryLayout_","encodeDeltas","numbers","opt_factor","lastNumbers","encodeFloats","decodeDeltas","encoded","decodeFloats","encodeUnsignedInteger","encodeUnsignedIntegers","encodeSignedIntegers","current","decodeUnsignedIntegers","decodeSignedIntegers","TopoJSON","transformVertex","arcs","concatenateArcs","polyArray","ringCoords","readFeaturesFromGeometryCollection","readFeatureFromGeometry","transformArc","topoJSONTopology","transformArcs","topoJSONFeatures","objectName","Filter","tagName_","getTagName","LogicalNary","conditions","And","Bbox","Spatial","Contains","Comparison","propertyName","During","ComparisonBinary","expression","opt_matchCase","matchCase","EqualTo","GreaterThan","GreaterThanOrEqualTo","Intersects","IsBetween","lowerBoundary","upperBoundary","IsLike","pattern","opt_wildCard","opt_singleChar","opt_escapeChar","wildCard","singleChar","escapeChar","IsNull","LessThan","LessThanOrEqualTo","Not","NotEqualTo","Or","Within","and","FEATURE_PREFIX","XMLNS","OGCNS","WFSNS","SCHEMA_LOCATIONS","1.1.0","1.0.0","WFS","featureType_","featureNS_","gmlFormat_","gmlFormat","schemaLocation_","getFeatureType","setFeatureType","readTransactionResponse","readTransactionResponseFromDocument","readTransactionResponseFromNode","readFeatureCollectionMetadata","readFeatureCollectionMetadataFromDocument","readFeatureCollectionMetadataFromNode","boundedBy","TRANSACTION_SUMMARY_PARSERS","http://www.opengis.net/wfs","totalInserted","totalUpdated","totalDeleted","OGC_FID_PARSERS","http://www.opengis.net/ogc","FeatureId","INSERT_RESULTS_PARSERS","TRANSACTION_RESPONSE_PARSERS","TransactionSummary","InsertResults","QUERY_SERIALIZERS","PropertyName","writeOgcFidFilter","getTypeName","featurePrefix","prefix","TRANSACTION_SERIALIZERS","Insert","gmlVersion","Update","typeName","Delete","Native","nativeElement","vendorId","safeToIgnore","GETFEATURE_SERIALIZERS","Query","propertyNames","writeFilterCondition","valueReference","timePeriod","writeTimeInstant","writeLogicalFilter","BBOX","writeOgcPropertyName","PropertyIsEqualTo","writeComparisonFilter","PropertyIsNotEqualTo","PropertyIsLessThan","PropertyIsLessThanOrEqualTo","PropertyIsGreaterThan","PropertyIsGreaterThanOrEqualTo","PropertyIsNull","PropertyIsBetween","writeOgcLiteral","PropertyIsLike","writeOgcExpression","timeInstant","timePosition","writeGetFeature","handle","outputFormat","maxFeatures","resultType","bboxFilter","andFilter","writeTransaction","inserts","updates","deletes","baseObj","gmlOptions","nativeElements","EMPTY","Z","TokenType","Lexer","wkt","index_","isAlpha_","isNumeric_","opt_decimal","isWhiteSpace_","nextChar_","nextToken","token","readNumber_","readText_","scientificNotation","substring","toUpperCase","Parser","lexer","lexer_","token_","layout_","consume_","isTokenType","match","isMatch","parseGeometry_","parseGeometryLayout_","dimToken","dimInfo","parseGeometryCollectionText_","isEmptyGeometry_","formatErrorMessage_","parsePointText_","parsePoint_","parseLineStringText_","parsePointList_","parsePolygonText_","parseLineStringTextList_","parseMultiPointText_","parsePointTextList_","parseMultiLineStringText_","parseMultiPolygonText_","parsePolygonTextList_","dimensions","WKT","splitCollection_","splitCollection","encodePointGeometry","encodeLineStringGeometry","encodePolygonGeometry","GeometryEncoder","components","geoms","encode","enc","geometryEncoder","parse_","GeometryConstructor","LINESTRING","MULTIPOINT","MULTILINESTRING","MULTIPOLYGON","GeometryParser","geomType","NAMESPACE_URI","readHref","read","readFromDocument","readFromNode","WMSCapabilities","Service","SERVICE_PARSERS","Capability","CAPABILITY_PARSERS","Request","REQUEST_PARSERS","Exception","EXCEPTION_PARSERS","LAYER_PARSERS","Name","Title","Abstract","KeywordList","readKeywordList","OnlineResource","ContactInformation","CONTACT_INFORMATION_PARSERS","Fees","AccessConstraints","LayerLimit","MaxWidth","MaxHeight","ContactPersonPrimary","CONTACT_PERSON_PARSERS","ContactPosition","ContactAddress","CONTACT_ADDRESS_PARSERS","ContactVoiceTelephone","ContactFacsimileTelephone","ContactElectronicMailAddress","ContactPerson","ContactOrganization","AddressType","Address","City","StateOrProvince","PostCode","Country","Format","CRS","EX_GeographicBoundingBox","geographicBoundingBox","EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS","westBoundLongitude","southBoundLatitude","eastBoundLongitude","northBoundLatitude","BoundingBox","Dimension","unitSymbol","default","multipleValues","nearestValue","ATTRIBUTION_PARSERS","AuthorityURL","authorityObject","readFormatOnlineresource","Identifier","MetadataURL","metadataObject","DataURL","FeatureListURL","MinScaleDenominator","MaxScaleDenominator","parentLayerObject","layerObject","queryable","cascaded","opaque","noSubsets","fixedWidth","fixedHeight","childValue","parentValue","LogoURL","readSizedFormatOnlineresource","GetCapabilities","readOperationType","GetMap","GetFeatureInfo","OPERATIONTYPE_PARSERS","DCPType","DCPTYPE_PARSERS","HTTP","HTTP_PARSERS","Get","Post","LegendURL","StyleSheetURL","StyleURL","FORMAT_ONLINERESOURCE_PARSERS","KEYWORDLIST_PARSERS","Keyword","formatOnlineresource","wmsCapabilityObject","WMSGetFeatureInfo","readFeatures_","layerFeatures","gmlFeatures","OWS","ServiceIdentification","SERVICE_IDENTIFICATION_PARSERS","ServiceProvider","SERVICE_PROVIDER_PARSERS","OperationsMetadata","OPERATIONS_METADATA_PARSERS","ADDRESS_PARSERS","DeliveryPoint","AdministrativeArea","PostalCode","ElectronicMailAddress","ALLOWED_VALUES_PARSERS","Value","CONSTRAINT_PARSERS","AllowedValues","CONTACT_INFO_PARSERS","Phone","PHONE_PARSERS","DCP_PARSERS","REQUEST_METHOD_PARSERS","OPERATION_PARSERS","DCP","Operation","Voice","Facsimile","Constraint","SERVICE_CONTACT_PARSERS","IndividualName","PositionName","ContactInfo","ServiceTypeVersion","ServiceType","ProviderName","ProviderSite","ServiceContact","owsObject","WMTSCapabilities","owsParser_","OWS_NAMESPACE_URIS","Contents","CONTENTS_PARSERS","TileMatrixSet","TMS_PARSERS","isDefault","TileMatrixSetLink","TMS_LINKS_PARSERS","DIMENSION_PARSERS","ResourceURL","resourceType","resource","WGS84BoundingBox","WGS84_BBOX_READERS","legend","TileMatrixSetLimits","TMS_LIMITS_LIST_PARSERS","TileMatrixLimits","TMS_LIMITS_PARSERS","TileMatrix","MinTileRow","MaxTileRow","MinTileCol","MaxTileCol","LowerCorner","readCoordinates","UpperCorner","WellKnownScaleSet","TM_PARSERS","SupportedCRS","TopLeftCorner","ScaleDenominator","TileWidth","TileHeight","MatrixWidth","MatrixHeight","WMTSCapabilityObject","DEFAULT_GRADIENT","Heatmap","gradient","blur","shadow","weight","gradient_","shadow_","circleImage_","styleCache_","handleGradientChanged_","setGradient","setBlur","handleStyleChanged_","weightFunction","handleRender_","createCircle_","getBlur","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","toDataURL","getGradient","colors","createLinearGradient","step","addColorStop","createGradient","view8","ImageLayer","TileLayer","setPreload","setUseInterimTilesOnError","TileProperty","VectorTileLayer","opt_tileCoord","getKeyZXY","createFromTemplate","zRegEx","xRegEx","yRegEx","dashYRegEx","getFullTileRange","createFromTemplates","templates","tileUrlFunctions","createFromTileUrlFunctions","tileCoordHash","nullTileUrlFunction","expandUrl","urls","startCharCode","stopCharCode","stop","jsonp","opt_errback","opt_callbackParam","script","async","timer","getElementsByTagName","TileCache","calculateSourceResolution","targetProj","targetMetersPerUnit","sourceMetersPerUnit","sourceExtent","compensationFactor","isFinite","enlargeClipPoint","centroidX","centroidY","dX","dY","targetExtent","triangulation","sources","opt_renderEdges","sourceDataExtent","canvasWidthInUnits","canvasHeightInUnits","stitchContext","stitchScale","xPos","yPos","srcWidth","srcHeight","targetTopLeft","getTriangles","triangle","u0","v0","u1","u2","sourceNumericalShiftX","sourceNumericalShiftY","affineCoefs","maxRow","maxEl","absValue","coef","solveLinearSystem","pruneExceptNewestZ","Triangulation","maxSourceExtent","errorThreshold","sourceProj_","targetProj_","transformInvCache","transformInv","transformInv_","maxSourceExtent_","errorThresholdSquared_","triangles_","wrapsXInSource_","canWrapXInSource_","sourceWorldWidth_","targetWorldWidth_","destinationTopLeft","destinationTopRight","destinationBottomRight","destinationBottomLeft","sourceTopLeft","sourceTopRight","sourceBottomRight","sourceBottomLeft","addQuad_","leftBound","newTriangle","addTriangle_","aSrc","bSrc","cSrc","dSrc","maxSubdivision","sourceQuadExtent","sourceCoverageX","sourceWorldWidth","wrapsX","needsSubdivision","centerSrc","bc","bcSrc","da","daSrc","ab","abSrc","cd","cdSrc","calculateSourceExtent","ReprojTile","targetTileGrid","getTileFunction","opt_errorThreshold","renderEdges_","gutter_","sourceTileGrid_","targetTileGrid_","wrappedTileCoord_","sourceTiles_","sourcesListenerKeys_","sourceZ_","maxTargetExtent","limitedTargetExtent","sourceProjExtent","errorThresholdInPixels","triangulation_","sourceRange","srcX","srcY","unlistenSources_","reproject_","renderReprojected","leftToLoad","sourceListenKey","TileGrid","opt_strict","currentVal","origins","origins_","tileSizes_","tileSizes","tileSize_","fullTileRanges_","sizes","calculateTileRanges_","tmpTileCoord","getForProjection","createForProjection","createForExtent","opt_maxZoom","opt_tileSize","opt_corner","corner","Corner","resolutionsFromExtent","createXYZ","extentFromProjection","half","forEachTileCoord","opt_tileRange","tileCoordExtent","createOrUpdateTileRange","getTileCoordForXYAndZ_","getTileCoordForCoordAndResolution","getTileCoordForXYAndResolution_","reverseIntersectionPolicy","adjustX","adjustY","xFromOrigin","yFromOrigin","tileCoordX","tileCoordY","createOrUpdateTileCoord","getTileCoordForCoordAndZ","getTileCoordResolution","fullTileRanges","TileSource","opaque_","tilePixelRatio_","tileCache","tmpSize","tileOptions","getTileCacheForProjection","setKey","thisProj","scaleSize","getTileCoordForTileUrlFunction","worldsAway","withinExtentAndZ","TileSourceEvent","UrlTile","tileUrlFunction","fixedTileUrlFunction","setUrls","setUrl","setTileUrlFunction","tileLoadingKeys_","getTileLoadFunction","getTileUrlFunction","getUrls","TileEventType","setTileLoadFunction","opt_key","TileImage","defaultTileLoadFunction","tileClass","tileCacheForProjection","tileGridForProjection","reprojectionErrorThreshold_","reprojectionErrorThreshold","renderReprojectionEdges_","imageTile","usedTileCache","getGutterInternal","projKey","createTile_","urlTileCoord","tileUrl","newTile","getTileInternal","setRenderReprojectionEdges","setTileGridForProjection","tilegrid","BingMaps","hidpi_","hidpi","culture_","culture","maxZoom_","apiKey_","imagerySet_","imagerySet","requestJSONP","handleImageryMetadataResponse","getApiKey","getImagerySet","response","statusCode","statusDescription","authenticationResultCode","resourceSets","resources","zoomMax","zoomMin","imageUrlSubdomains","subdomain","quadKeyTileCoord","imageUrl","digits","quadKey","imageryProviders","imageryProvider","intersecting","coverageAreas","coverageArea","CartoDB","account_","account","mapId_","config_","config","templateCache_","initializeMap_","getConfig","updateConfig","setConfig","paramHash","applyTemplate_","mapUrl","client","handleInitResponse_","handleInitError_","setRequestHeader","tilesUrl","cdn_url","https","layergroupid","Cluster","cluster","setDistance","mapDistance","clustered","neighbors","neighbor","createCluster","ReprojImage","getImageFunction","targetResolution_","targetExtent_","sourceImage_","sourcePixelRatio_","sourceListenerKey_","unlistenSource_","ImageSourceEventType","ImageSourceEvent","ImageSource","reprojectedImage_","reprojectedRevision_","defaultImageLoadFunction","appendParams","keyParams","encodeURIComponent","qs","findNearestResolution","getImageInternal","handleImageChange","ImageArcGISRest","params_","ratio_","getParams","F","FORMAT","TRANSPARENT","halfWidth","halfHeight","getRequestUrl_","getImageLoadFunction","srid","modifiedUrl","setImageLoadFunction","updateParams","ImageCanvasSource","canvasFunction_","canvasFunction","canvasElement","ImageMapGuide","displayDpi_","displayDpi","useOverlay_","useOverlay","baseUrl","dpi","mcsW","mcsH","devW","devH","mpp","baseParams","OPERATION","VERSION","LOCALE","CLIENTAGENT","CLIP","SETDISPLAYDPI","SETDISPLAYWIDTH","SETDISPLAYHEIGHT","SETVIEWSCALE","SETVIEWCENTERX","SETVIEWCENTERY","Static","targetWidth","DEFAULT_WMS_VERSION","ImageWMS","v13_","updateV13_","serverType_","GETFEATUREINFO_IMAGE_SIZE","getGetFeatureInfoUrl","projectionObj","sourceProjectionObj","SERVICE","REQUEST","QUERY_LAYERS","viewExtent","requestExtent","WMSServerType","ATTRIBUTION","OSM","hasImageData","ImageData","_","newImageData","createImageData","createMinion","operation","workerHasImageData","buffers","meta","imageOps","numBuffers","numBytes","byteLength","Uint8ClampedArray","arrays","createWorker","onMessage","lib","blob","Blob","createObjectURL","worker","Worker","Processor","threads","_imageOps","minion","workers","_onWorkerMessage","postMessage","_workers","_queue","_maxQueueLength","queue","_running","_dataLookup","_job","process","inputs","_enqueue","_dispatch","_destroyed","job","slices","_resolveJob","RasterEventType","RasterOperationType","RasterSourceEvent","RasterSource","worker_","operationType_","operationType","threads_","renderers_","createRenderers","requestedFrameState_","renderedImageCanvas_","setOperation","opt_lib","updateFrameState_","allSourcesReady_","ready","processSources_","imageDatas","onWorkerComplete_","sharedContext","ATTRIBUTIONS","OSM_ATTRIBUTION","LayerConfig","terrain","terrain-background","terrain-labels","terrain-lines","toner-background","toner","toner-hybrid","toner-labels","toner-lines","toner-lite","watercolor","ProviderConfig","Stamen","provider","providerConfig","layerConfig","TileArcGISRest","tmpExtent_","getKeyForParams_","LabeledTile","strokeRect","TileDebug","textTileCoord","TileJSON","tileJSON_","handleTileJSONResponse","handleTileJSONError","onXHRLoad_","onXHRError_","tileJSON","getTileJSON","bounds","minzoom","maxzoom","attributionExtent","TileWMS","transparent","bufferSize","CustomTile","preemptive","preemptive_","grid_","data_","jsonp_","getData","xRelative","yRelative","row","forDataAtCoordinate","opt_request","loadInternal_","handleError_","json","grid","UTFGrid","tileUrlFunction_","template_","getTemplate","forDataAtCoordinateAndResolution","grids","VectorImageTile","sourceTiles","replayState_","sourceRevision_","loadListenerKeys_","sourceTileListenerKeys_","sourceZ","useLoadedOnly","loadCount","sourceTileKey","finishLoading_","defaultLoadFunction","errorSourceTiles","empty","tileGrids_","WMTSTileGrid","matrixIds_","matrixIds","createFromCapabilitiesMatrixSet","matrixSet","opt_matrixLimits","matrixLimits","matrixIdsPropName","identifierPropName","scaleDenominatorPropName","topLeftCornerPropName","switchOriginXY","elt","elt_ml","tileWidth","tileHeight","getMatrixId","getMatrixIds","WMTS","version_","dimensions_","matrixSet_","requestEncoding_","requestEncoding","WMTSRequestEncoding","tilematrixset","Version","createFromWMTSTemplate_","localContext","TileCol","TileRow","getKeyForDimensions_","getDimensions","getMatrixSet","getRequestEncoding","getVersion","updateDimensions","TierSizeCalculation","zoomifyImage_","Zoomify","tierSizeCalculation","tierSizeInTiles","tileSizeForTierSizeCalculation","tileCountUpToTier","tileCoordZ","tileIndex","TileGroup","ZoomifyTileClass","ol","colorlike","featureloader","loadingstrategy","proj4","webgl","sphere","$ol$Collection","$ol$Feature","$ol$Geolocation","$ol$Graticule","$ol$Kinetic","$ol$Map","$ol$Object","$ol$Observable","unByKey","$ol$Overlay","$ol$PluggableMap","$ol$View","$ol$WebGLMap","_ol_color.asArray","_ol_color.asString","_ol_colorlike.asColorLike","$ol$control$Attribution","_ol_control_Attribution.render","$ol$control$Control","$ol$control$FullScreen","$ol$control$MousePosition","_ol_control_MousePosition.render","$ol$control$OverviewMap","_ol_control_OverviewMap.render","$ol$control$Rotate","_ol_control_Rotate.render","$ol$control$ScaleLine","_ol_control_ScaleLine.render","$ol$control$Zoom","$ol$control$ZoomSlider","_ol_control_ZoomSlider.render","$ol$control$ZoomToExtent","_ol_control.defaults","_ol_coordinate.add","createStringXY","_ol_coordinate.format","_ol_coordinate.rotate","toStringHDMS","_ol_coordinate.toStringXY","_ol_easing.easeIn","_ol_easing.easeOut","_ol_easing.inAndOut","_ol_easing.linear","upAndDown","_ol_events_condition.altKeyOnly","_ol_events_condition.altShiftKeysOnly","_ol_events_condition.always","click","doubleClick","activeElement","_ol_events_condition.mouseOnly","_ol_events_condition.never","_ol_events_condition.noModifierKeys","platformModifierKeyOnly","_ol_events_condition.pointerMove","_ol_events_condition.primaryAction","_ol_events_condition.shiftKeyOnly","_ol_events_condition.singleClick","_ol_events_condition.targetNotEditable","_ol_extent.applyTransform","_ol_extent.boundingExtent","_ol_extent.buffer","_ol_extent.containsCoordinate","_ol_extent.containsExtent","_ol_extent.containsXY","_ol_extent.createEmpty","_ol_extent.equals","_ol_extent.extend","_ol_extent.getArea","_ol_extent.getBottomLeft","_ol_extent.getBottomRight","_ol_extent.getCenter","_ol_extent.getHeight","_ol_extent.getIntersection","_ol_extent.getTopLeft","_ol_extent.getTopRight","_ol_extent.getWidth","_ol_extent.intersects","_ol_extent.isEmpty","_ol_featureloader.xhr","$ol$format$EsriJSON","$ol$format$Feature","$ol$format$GML","$ol$format$GML2","$ol$format$GML3","$ol$format$GPX","$ol$format$GeoJSON","$ol$format$IGC","$ol$format$KML","$ol$format$MVT","$ol$format$OSMXML","$ol$format$Polyline","_ol_format_Polyline.decodeDeltas","_ol_format_Polyline.decodeFloats","_ol_format_Polyline.encodeDeltas","_ol_format_Polyline.encodeFloats","$ol$format$TopoJSON","$ol$format$WFS","writeFilter","$ol$format$WKT","$ol$format$WMSCapabilities","$ol$format$WMSGetFeatureInfo","$ol$format$WMTSCapabilities","$ol$format$filter$Bbox","$ol$format$filter$Contains","$ol$format$filter$During","$ol$format$filter$EqualTo","$ol$format$filter$GreaterThan","$ol$format$filter$GreaterThanOrEqualTo","$ol$format$filter$Intersects","$ol$format$filter$IsBetween","$ol$format$filter$IsLike","$ol$format$filter$IsNull","$ol$format$filter$LessThan","$ol$format$filter$LessThanOrEqualTo","$ol$format$filter$Not","$ol$format$filter$NotEqualTo","$ol$format$filter$Or","$ol$format$filter$Within","_ol_format_filter.and","_ol_format_filter.bbox","between","during","equalTo","greaterThan","greaterThanOrEqualTo","isNull","lessThan","lessThanOrEqualTo","like","not","notEqualTo","or","within","$ol$geom$Circle","$ol$geom$Geometry","$ol$geom$GeometryCollection","$ol$geom$LineString","$ol$geom$LinearRing","$ol$geom$MultiLineString","$ol$geom$MultiPoint","$ol$geom$MultiPolygon","$ol$geom$Point","$ol$geom$Polygon","_ol_geom_Polygon.circular","_ol_geom_Polygon.fromCircle","_ol_geom_Polygon.fromExtent","$ol$geom$SimpleGeometry","_ol_has.DEVICE_PIXEL_RATIO","_ol_has.GEOLOCATION","_ol_has.TOUCH","_ol_has.WEBGL","_ol.inherits","$ol$interaction$DoubleClickZoom","$ol$interaction$DragAndDrop","$ol$interaction$DragBox","$ol$interaction$DragPan","$ol$interaction$DragRotate","$ol$interaction$DragRotateAndZoom","$ol$interaction$DragZoom","$ol$interaction$Draw","createBox","createRegularPolygon","_ol_interaction_Draw.handleEvent","Extent","$ol$interaction$Extent","$ol$interaction$Interaction","$ol$interaction$KeyboardPan","$ol$interaction$KeyboardZoom","$ol$interaction$Modify","$ol$interaction$MouseWheelZoom","$ol$interaction$PinchRotate","$ol$interaction$PinchZoom","Pointer","$ol$interaction$Pointer","_ol_interaction_Pointer.handleEvent","$ol$interaction$Select","$ol$interaction$Snap","$ol$interaction$Translate","_ol_interaction.defaults","Base","$ol$layer$Base","Group","$ol$layer$Group","$ol$layer$Heatmap","$ol$layer$Image","$ol$layer$Layer","$ol$layer$Tile","Vector","$ol$layer$Vector","$ol$layer$VectorTile","_ol_loadingstrategy.all","$ol$proj$Projection","_ol_proj_Units.METERS_PER_UNIT","_ol_proj.addCoordinateTransforms","_ol_proj.addEquivalentProjections","_ol_proj.addProjection","_ol_proj.equivalent","fromLonLat","_ol_proj.get","_ol_proj.getPointResolution","_ol_proj.getTransform","projCodes","defs","def","axis","to_meter","code1","proj1","code2","proj2","toLonLat","lonLat","_ol_proj.transform","_ol_proj.transformExtent","$ol$render$VectorContext","_ol_render_canvas.labelCache","toContext","$ol$renderer$canvas$ImageLayer","$ol$renderer$canvas$Map","$ol$renderer$canvas$TileLayer","$ol$renderer$canvas$VectorLayer","$ol$renderer$canvas$VectorTileLayer","$ol$renderer$webgl$ImageLayer","$ol$renderer$webgl$Map","$ol$renderer$webgl$TileLayer","$ol$renderer$webgl$VectorLayer","_ol_size.toSize","$ol$source$BingMaps","$ol$source$CartoDB","$ol$source$Cluster","$ol$source$Image","$ol$source$ImageArcGISRest","$ol$source$ImageCanvas","$ol$source$ImageMapGuide","ImageStatic","$ol$source$ImageStatic","$ol$source$ImageWMS","$ol$source$OSM","_ol_source_OSM.ATTRIBUTION","Raster","$ol$source$Raster","$ol$source$Source","$ol$source$Stamen","$ol$source$Tile","$ol$source$TileArcGISRest","$ol$source$TileDebug","$ol$source$TileImage","$ol$source$TileJSON","$ol$source$TileWMS","$ol$source$UTFGrid","$ol$source$Vector","$ol$source$VectorTile","$ol$source$WMTS","optionsFromCapabilities","wmtsCap","tileMatrixSets","supportedCRS","matrixSetObj","projConfig","wgs84BoundingBox","wgs84ProjectionExtent","gets","encodings","$ol$source$XYZ","$ol$source$Zoomify","_ol_sphere.getDistance","$ol$style$AtlasManager","$ol$style$Circle","$ol$style$Fill","$ol$style$Icon","_ol_style_IconImageCache.shared","$ol$style$Image","$ol$style$RegularShape","$ol$style$Stroke","$ol$style$Style","$ol$style$Text","$ol$tilegrid$TileGrid","$ol$tilegrid$WMTS","_ol_tilegrid_WMTS.createFromCapabilitiesMatrixSet","_ol_tilegrid.createXYZ","_ol_xml.getAllTextContent","_ol_xml.parse"],"mappings":"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"}