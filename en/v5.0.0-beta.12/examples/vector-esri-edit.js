webpackJsonp([33],{579:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(2),e=c(1),f=c(181),g=c(34),h=c(6),i=c(115),j=c(4),k=c(12),l=c(42),m=c(69);const n="https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/PDX_Pedestrian_Districts/FeatureServer/",o="0",p=new f.a,q=new k.b({loader:function(a,b,c){const d=n+o+"/query/?f=json&returnGeometry=true&spatialRel=esriSpatialRelIntersects&geometry="+encodeURIComponent("{\"xmin\":"+a[0]+",\"ymin\":"+a[1]+",\"xmax\":"+a[2]+",\"ymax\":"+a[3]+",\"spatialReference\":{\"wkid\":102100}}")+"&geometryType=esriGeometryEnvelope&inSR=102100&outFields=*&outSR=102100";$.ajax({url:d,dataType:"jsonp",success:function(a){if(a.error)alert(a.error.message+"\n"+a.error.details.join("\n"));else{const b=p.readFeatures(a,{featureProjection:c});0<b.length&&q.addFeatures(b)}}})},strategy:Object(i.c)(Object(m.b)({tileSize:512}))}),r=new h.e({source:q}),s=new h.d({source:new l.a({attributions:"Tiles \xA9 <a href=\"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer\">ArcGIS</a>",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"})}),t=new g.d({source:q,type:"Polygon"}),u=new g.i;u.setActive(!1);const v=u.getFeatures(),w=new g.e({features:v});w.setActive(!1);const x=new d.a({interactions:Object(g.l)().extend([t,u,w]),layers:[s,r],target:document.getElementById("map"),view:new e.a({center:Object(j.g)([-122.619,45.512]),zoom:12})}),y=document.getElementById("type");y.onchange=function(){t.setActive("DRAW"===y.value),u.setActive("MODIFY"===y.value),w.setActive("MODIFY"===y.value)};const z={};v.on("add",function(a){const b=a.element;b.on("change",function(a){z[a.target.getId()]=!0})}),v.on("remove",function(a){const b=a.element,c=b.getId();if(!0===z[c]){const a="["+p.writeFeature(b,{featureProjection:x.getView().getProjection()})+"]";$.post(n+o+"/updateFeatures",{f:"json",features:a}).done(function(a){const b=JSON.parse(a);if(b.updateResults&&0<b.updateResults.length)if(!0!==b.updateResults[0].success){const a=b.updateResults[0].error;alert(a.description+" ("+a.code+")")}else delete z[c]})}}),t.on("drawend",function(a){const b=a.feature,c="["+p.writeFeature(b,{featureProjection:x.getView().getProjection()})+"]";$.post(n+o+"/addFeatures",{f:"json",features:c}).done(function(a){const c=JSON.parse(a);if(c.addResults&&0<c.addResults.length)if(!0===c.addResults[0].success)b.setId(c.addResults[0].objectId),q.clear();else{const a=c.addResults[0].error;alert(a.description+" ("+a.code+")")}})})}},[579]);