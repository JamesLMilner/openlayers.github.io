webpackJsonp([124],{407:function(a,b,c){"use strict";function d(a){return 360*a/(2*l)}function e(a){return 2*(a*l)/360}function f(a){return(a%(2*l)+2*l)%(2*l)}function g(a,b,c,d){var e=Math.abs;const g=a[0],h=a[1],i=A.getCoordinates(),j=i[i.length-1],k=j&&j[2];if(k){let a=b-f(k);if(e(a)>l){const b=0<=a?1:-1;a=-b*(2*l-e(a))}b=k+a}A.appendCoordinate([g,h,b,c]),A.setCoordinates(A.getCoordinates().slice(-20)),z.src=b&&d?"data/geolocation_marker_heading.png":"data/geolocation_marker.png"}function h(a,b,c){const d=w.getSize(),e=d[1];return[a[0]-1*(Math.sin(b)*e*c)/4,a[1]+1*(Math.cos(b)*e*c)/4]}function i(){let a=Date.now()-1.5*B;a=Math.max(a,C),C=a;const b=A.getCoordinateAtM(a,!0);b&&(v.setCenter(h(b,-b[2],v.getResolution())),v.setRotation(-b[2]),x.setPosition(b))}function j(a){const b=a.coords;y.set("accuracy",b.accuracy),y.set("heading",e(b.heading));const c=Object(t.g)([b.longitude,b.latitude]);y.set("position",c),y.set("speed",b.speed),y.changed()}function k(){D.disabled="disabled",G.disabled="disabled"}var l=Math.PI;Object.defineProperty(b,"__esModule",{value:!0});var m=c(189),n=c(2),o=c(81),p=c(1),q=c(14),r=c(28),s=c(5),t=c(4),u=c(7);const v=new p.a({center:Object(t.g)([5.8713,45.6452]),zoom:19}),w=new n.a({layers:[new s.a({source:new u.b})],target:"map",controls:Object(q.h)({attributionOptions:{collapsible:!1}}),view:v}),z=document.getElementById("geolocation_marker"),x=new o.a({positioning:"center-center",element:z,stopEvent:!1});w.addOverlay(x);const A=new r.a([],"XYZM"),y=new m.a({projection:v.getProjection(),trackingOptions:{maximumAge:1e4,enableHighAccuracy:!0,timeout:6e5}});let B=500;y.on("change",function(){var a=Math.round;const b=y.getPosition(),c=y.getAccuracy(),e=y.getHeading()||0,f=y.getSpeed()||0,h=Date.now();g(b,e,h,f);const i=A.getCoordinates(),j=i.length;2<=j&&(B=(i[j-1][3]-i[0][3])/(j-1));const k=["Position: "+b[0].toFixed(2)+", "+b[1].toFixed(2),"Accuracy: "+c,"Heading: "+a(d(e))+"&deg;","Speed: "+(3.6*f).toFixed(1)+" km/h","Delta: "+a(B)+"ms"].join("<br />");document.getElementById("info").innerHTML=k}),y.on("error",function(){alert("geolocation error")});let C=0;const D=document.getElementById("geolocate");D.addEventListener("click",function(){y.setTracking(!0),w.on("postcompose",i),w.render(),k()},!1);let E;const F=new XMLHttpRequest;F.open("GET","data/geolocation-orientation.json"),F.onload=function(){E=JSON.parse(F.responseText).data},F.send();const G=document.getElementById("simulate");G.addEventListener("click",function(){function a(){const c=b.shift();if(!c)return;const e=c.timestamp;j(c),window.setTimeout(function(){d=e,a()},(e-d)/.5)}const b=E,c=b.shift();j(c);let d=c.timestamp;a(),w.on("postcompose",i),w.render(),k()},!1)}},[407]);