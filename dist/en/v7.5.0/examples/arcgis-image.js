"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[694],{8584:function(i,e,t){var s=t(1055),r=t(824),n=t(5117),a=t(2486),o=t(1531),h=t(7419),c=t(3172),g=t(3422),u=t(6117),l=t(850);class _ extends o.ZP{constructor(i){super({attributions:(i=i||{}).attributions,interpolate:i.interpolate,projection:i.projection,resolutions:i.resolutions}),this.context_=(0,l.E4)(1,1),this.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,this.hidpi_=void 0===i.hidpi||i.hidpi,this.url_=i.url,this.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:o.r6,this.params_=i.params||{},this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==i.ratio?i.ratio:1.5}getParams(){return this.params_}getImageInternal(i,e,t,s){if(void 0===this.url_)return null;e=this.findNearestResolution(e),t=this.hidpi_?t:1;const r=this.image_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==t&&(0,u.r4)(r.getExtent(),i))return r;const n={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(n,this.params_);const o=((i=i.slice())[0]+i[2])/2,c=(i[1]+i[3])/2;if(1!=this.ratio_){const e=this.ratio_*(0,u.dz)(i)/2,t=this.ratio_*(0,u.Cr)(i)/2;i[0]=o-e,i[1]=c-t,i[2]=o+e,i[3]=c+t}const g=e/t,l=Math.ceil((0,u.dz)(i)/g),_=Math.ceil((0,u.Cr)(i)/g);i[0]=o-g*l/2,i[2]=o+g*l/2,i[1]=c-g*_/2,i[3]=c+g*_/2,this.imageSize_[0]=l,this.imageSize_[1]=_;const d=this.getRequestUrl_(i,this.imageSize_,t,s,n);return this.image_=new h.Z(i,e,t,d,this.crossOrigin_,this.imageLoadFunction_,this.context_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(a.Z.CHANGE,this.handleImageChange.bind(this)),this.image_}getImageLoadFunction(){return this.imageLoadFunction_}getRequestUrl_(i,e,t,s,r){const n=s.getCode().split(/:(?=\d+$)/).pop();r.SIZE=e[0]+","+e[1],r.BBOX=i.join(","),r.BBOXSR=n,r.IMAGESR=n,r.DPI=Math.round(90*t);const a=this.url_,o=a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return o==a&&(0,g.h)(!1,50),(0,c.B)(o,r)}getUrl(){return this.url_}setImageLoadFunction(i){this.image_=null,this.imageLoadFunction_=i,this.changed()}setUrl(i){i!=this.url_&&(this.url_=i,this.image_=null,this.changed())}updateParams(i){Object.assign(this.params_,i),this.image_=null,this.changed()}}var d=_,m=t(2893),p=t(1802);const v=[new m.Z({source:new n.Z}),new p.Z({source:new d({ratio:1,params:{},url:"https://sampleserver6.arcgisonline.com/ArcGIS/rest/services/USA/MapServer"})})];new s.Z({layers:v,target:"map",view:new r.ZP({center:[-10997148,4569099],zoom:4})})}},function(i){var e;e=8584,i(i.s=e)}]);
//# sourceMappingURL=arcgis-image.js.map