"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4430],{8441:function(e,t,r){var n=r(4050),i=r(1055),s=r(4613),o=r(2065),a=r(824),h=r(2486),l=r(1316),p=r(2925),c=r(3497),d=r(841),_=r(3214),u=r(4669);class m extends d.Z{batch=new _.Z;constructor(e,t,r,n){super(e),this.polygonRenderer_=t,this.lineStringRenderer_=r,this.pointRenderer_=n,this.renderInstructionsTransform_=(0,u.Ue)(),this.setTile(e.tile)}uploadTile(){this.batch.clear();const e=this.tile.getSourceTiles(),t=e.reduce(((e,t)=>e.concat(t.getFeatures())),[]);this.batch.addFeatures(t);const r=e[0].extent[0],n=e[0].extent[1];(0,u.mc)(this.renderInstructionsTransform_),(0,u.Iu)(this.renderInstructionsTransform_,-r,-n);let i=3;const s=()=>{i--,0===i&&this.setReady()};setTimeout((()=>{this.polygonRenderer_.rebuild(this.batch.polygonBatch,this.renderInstructionsTransform_,"Polygon",s)})),setTimeout((()=>{this.lineStringRenderer_.rebuild(this.batch.lineStringBatch,this.renderInstructionsTransform_,"LineString",s)})),setTimeout((()=>{this.pointRenderer_.rebuild(this.batch.pointBatch,this.renderInstructionsTransform_,"Point",s)}))}}var f=m,b=r(3044),g=r(6725),S=r(4704),R=r(1275),T=r(6117),y=r(569);function k(e){return Object.keys(e).map((t=>({name:t,size:"color"===t?2:1,callback:e[t]})))}class w extends b.ZP{constructor(e,t){super(e,t),this.worker_=(0,R.U)(),this.polygonRenderer_=null,this.pointRenderer_=null,this.lineStringRenderer_=null,this.currentFrameStateTransform_=(0,u.Ue)(),this.tmpTransform_=(0,u.Ue)(),this.tmpMat4_=(0,S.U)(),this.applyOptions_(t)}reset(e){super.reset(e),this.applyOptions_(e),this.helper&&this.createRenderers_()}applyOptions_(e){const t={color:function(){return(0,y.zO)("#ddd")},...e.fill&&e.fill.attributes},r={color:function(){return(0,y.zO)("#eee")},width:function(){return 1.5},...e.stroke&&e.stroke.attributes},n={color:function(){return(0,y.zO)("#eee")},...e.point&&e.point.attributes};this.fillVertexShader_=e.fill&&e.fill.vertexShader||g.W7,this.fillFragmentShader_=e.fill&&e.fill.fragmentShader||g.sH,this.fillAttributes_=k(t),this.strokeVertexShader_=e.stroke&&e.stroke.vertexShader||g.mC,this.strokeFragmentShader_=e.stroke&&e.stroke.fragmentShader||g.dr,this.strokeAttributes_=k(r),this.pointVertexShader_=e.point&&e.point.vertexShader||g.br,this.pointFragmentShader_=e.point&&e.point.fragmentShader||g.mz,this.pointAttributes_=k(n)}createRenderers_(){this.polygonRenderer_=new c.Z(this.helper,this.worker_,this.fillVertexShader_,this.fillFragmentShader_,this.fillAttributes_),this.pointRenderer_=new p.Z(this.helper,this.worker_,this.pointVertexShader_,this.pointFragmentShader_,this.pointAttributes_),this.lineStringRenderer_=new l.Z(this.helper,this.worker_,this.strokeVertexShader_,this.strokeFragmentShader_,this.strokeAttributes_)}afterHelperCreated(){this.createRenderers_()}createTileRepresentation(e){const t=new f(e,this.polygonRenderer_,this.lineStringRenderer_,this.pointRenderer_),r=()=>{t.ready&&(this.getLayer().changed(),t.removeEventListener(h.Z.CHANGE,r))};return t.addEventListener(h.Z.CHANGE,r),t}beforeTilesRender(e,t){super.beforeTilesRender(e,!0),this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_)}applyUniforms_(e,t,r){(0,u.lk)(this.tmpTransform_,this.currentFrameStateTransform_),(0,u.Jp)(this.tmpTransform_,r),this.helper.setUniformMatrixValue(b.XE.PROJECTION_MATRIX,(0,S.u)(this.tmpMat4_,this.tmpTransform_)),(0,u.nb)(this.tmpTransform_,this.currentFrameStateTransform_),this.helper.setUniformMatrixValue(b.XE.SCREEN_TO_WORLD_MATRIX,(0,S.u)(this.tmpMat4_,this.tmpTransform_)),this.helper.setUniformFloatValue(b.XE.GLOBAL_ALPHA,e),this.helper.setUniformFloatVec4(b.XE.RENDER_EXTENT,t)}renderTile(e,t,r,n,i,s,o,a,h,l,p){const c=(0,T.Ed)(a,n,a);this.polygonRenderer_.preRender(e.batch.polygonBatch,this.frameState),this.applyUniforms_(p,c,e.batch.polygonBatch.invertVerticesBufferTransform),this.polygonRenderer_.render(e.batch.polygonBatch),this.lineStringRenderer_.preRender(e.batch.lineStringBatch,this.frameState),this.applyUniforms_(p,c,e.batch.lineStringBatch.invertVerticesBufferTransform),this.lineStringRenderer_.render(e.batch.lineStringBatch),this.pointRenderer_.preRender(e.batch.pointBatch,this.frameState),this.applyUniforms_(p,c,e.batch.pointBatch.invertVerticesBufferTransform),this.pointRenderer_.render(e.batch.pointBatch)}renderDeclutter(e){}disposeInternal(){this.worker_.terminate(),super.disposeInternal()}}var x=w,v=r(677),Z=r(5002),B=r(2776),E=r(1652),O=r(1976),V=r(1439);class F extends s.Z{createRenderer(){return new x(this,{fill:{attributes:{color:e=>{const t=this.getStyle()(e,1)[0],r=(0,V._2)(t?.getFill()?.getColor()||"#eee");return(0,y.zO)(r)}}},stroke:{attributes:{color:e=>{const t=this.getStyle()(e,1)[0],r=(0,V._2)(t?.getStroke()?.getColor()||"#eee");return(0,y.zO)(r)},width:e=>{const t=this.getStyle()(e,1)[0];return t?.getStroke()?.getWidth()||0}}},point:{attributes:{color:()=>(0,y.zO)((0,V._2)("#777"))}}})}}new i.Z({layers:[new F({source:new o.Z({attributions:'© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> © <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>',format:new n.Z,url:"https://{a-d}.tiles.mapbox.com/v4/mapbox.mapbox-streets-v6/{z}/{x}/{y}.vector.pbf?access_token=pk.eyJ1IjoiYWhvY2V2YXIiLCJhIjoiY2t0cGdwMHVnMGdlbzMxbDhwazBic2xrNSJ9.WbcTL9uj8JPAsnT9mgb7oQ"}),style:createMapboxStreetsV6Style(v.ZP,Z.Z,B.Z,E.Z,O.Z)})],target:"map",view:new a.ZP({center:[0,0],zoom:2})})}},function(e){var t;t=8441,e(e.s=t)}]);
//# sourceMappingURL=webgl-vector-tiles.js.map