"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[536],{51264:function(e,t,n){var r=n(30536),i=n(19212),o=n(19936),a=n(38788),l=n(38348),s=n(2064),u=n(17256),c=n(88024),h=n(48011),p=n(164),x=n(65732),d=n(84868),_=n(88470);const g="extentchanged";class v extends r.cp{constructor(e){super(g),this.extent=e}}class w extends l.c{constructor(e){super(e=e||{}),this.on,this.once,this.un,this.condition_=e.condition?e.condition:c.eK,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new s.c({source:new u.c({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:E(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new s.c({source:new u.c({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:f(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}snapToVertex_(e,t){const n=t.getCoordinateFromPixelInternal(e),r=function(e,t){return(0,p.YN)(n,e)-(0,p.YN)(n,t)},i=this.getExtentInternal();if(i){const o=function(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(i);o.sort(r);const a=o[0];let l=(0,p.KO)(n,a);const s=t.getPixelFromCoordinateInternal(l);if((0,p.qy)(e,s)<=this.pixelTolerance_){const e=t.getPixelFromCoordinateInternal(a[0]),n=t.getPixelFromCoordinateInternal(a[1]),r=(0,p.W)(s,e),i=(0,p.W)(s,n),o=Math.sqrt(Math.min(r,i));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(l=r>i?a[1]:a[0]),l}}return null}handlePointerMove_(e){const t=e.pixel,n=e.map;let r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(r)}createOrUpdateExtentFeature_(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,d.ER)(e)):t.setGeometry(void 0):(t=e?new i.c((0,d.ER)(e)):new i.c({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}createOrUpdatePointerFeature_(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new i.c(new a.c(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t}handleEvent(e){return!e.originalEvent||!this.condition_(e)||(e.type!=o.c.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),super.handleEvent(e),!1)}handleDownEvent(e){const t=e.pixel,n=e.map,r=this.getExtentInternal();let i=this.snapToVertex_(t,n);const o=function(e){let t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(i&&r){const e=i[0]==r[0]||i[0]==r[2]?i[0]:null,t=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==e&&null!==t?this.pointerHandler_=y(o(i)):null!==e?this.pointerHandler_=F(o([e,r[1]]),o([e,r[3]])):null!==t&&(this.pointerHandler_=F(o([r[0],t]),o([r[2],t])))}else i=n.getCoordinateFromPixelInternal(t),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=y(i);return!0}handleDragEvent(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}}handleUpEvent(e){this.pointerHandler_=null;const t=this.getExtentInternal();return t&&0!==(0,h.kh)(t)||this.setExtent(null),!1}setMap(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),super.setMap(e)}getExtent(){return(0,_.Ir)(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new v(this.extent_))}}function E(){const e=(0,x.gL)();return function(t,n){return e.Polygon}}function f(){const e=(0,x.gL)();return function(t,n){return e.Point}}function y(e){return function(t){return(0,h.cj)([e,t])}}function F(e,t){return e[0]==t[0]?function(n){return(0,h.cj)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,h.cj)([e,[t[0],n[1]]])}:null}var I=w,m=n(68444),P=n(96480),O=n(80372),T=n(86728);const M=new m.c({layers:[new O.c({source:new P.c})],target:"map",view:new T.cp({center:[0,0],zoom:2})}),C=new I({condition:c.gf});M.addInteraction(C)}},function(e){var t;t=51264,e(e.s=t)}]);
//# sourceMappingURL=extent-interaction.js.map